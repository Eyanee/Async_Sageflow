
Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 80

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
 benign loss is  12.418770849704742
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 27.25% 

Test Accuracy: 31.62% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.015029849484562874
 benign empirical indicaor res is  0.015029849484562874
 benign loss is  9.899479269981384
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 73.83% 

Test Accuracy: 73.61% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.015366781502962112
 benign empirical indicaor res is  0.015366781502962112
 benign loss is  8.443237334489822
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 79.65% 

Test Accuracy: 79.17% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.009565019980072975
 benign empirical indicaor res is  0.009565019980072975
 benign loss is  8.423553675413132
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 85.95% 

Test Accuracy: 85.84% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.006606096401810646
 benign empirical indicaor res is  0.006606096401810646
 benign loss is  6.756832003593445
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 90.11% 

Test Accuracy: 90.20% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0027809517923742533
 benign empirical indicaor res is  0.0027809517923742533
 benign loss is  6.9943011701107025
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 93.23% 

Test Accuracy: 92.86% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.010543875396251678
 benign empirical indicaor res is  0.010543875396251678
 benign loss is  5.627110078930855
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 92.19% 

Test Accuracy: 92.37% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.008503827266395092
 benign empirical indicaor res is  0.008503827266395092
 benign loss is  5.809983968734741
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 94.01% 

Test Accuracy: 94.19% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0023465182166546583
 benign empirical indicaor res is  0.0023465182166546583
 benign loss is  5.345400735735893
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 95.01% 

Test Accuracy: 95.25% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.003672597697004676
 benign empirical indicaor res is  0.003672597697004676
 benign loss is  5.413862258195877
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 95.84% 

Test Accuracy: 95.40% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0018801375990733504
 benign empirical indicaor res is  0.0018801375990733504
 benign loss is  4.082523196935654
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 95.15% 

Test Accuracy: 95.41% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.004530184902250767
 benign empirical indicaor res is  0.004530184902250767
 benign loss is  4.333282798528671
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 96.08% 

Test Accuracy: 96.10% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0016271105268970132
 benign empirical indicaor res is  0.0016271105268970132
 benign loss is  3.700769856572151
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 96.48% 

Test Accuracy: 96.34% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.004222233314067125
 benign empirical indicaor res is  0.004222233314067125
 benign loss is  3.6667700558900833
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 96.69% 

Test Accuracy: 96.44% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.003416303778067231
 benign empirical indicaor res is  0.003416303778067231
 benign loss is  3.2977367118000984
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 96.29% 

Test Accuracy: 96.35% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0002389347500866279
 benign empirical indicaor res is  0.0002389347500866279
 benign loss is  4.110043242573738
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 96.47% 

Test Accuracy: 96.49% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0012498231371864676
 benign empirical indicaor res is  0.0012498231371864676
 benign loss is  3.5153717771172523
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 96.63% 

Test Accuracy: 96.62% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0017041730461642146
 benign empirical indicaor res is  0.0017041730461642146
 benign loss is  3.546314798295498
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 96.91% 

Test Accuracy: 96.80% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0013816661667078733
 benign empirical indicaor res is  0.0013816661667078733
 benign loss is  3.5721514150500298
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 96.56% 

Test Accuracy: 96.72% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0015717069618403912
 benign empirical indicaor res is  0.0015717069618403912
 benign loss is  3.267080530524254
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 96.87% 

Test Accuracy: 96.82% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0007773939287289977
 benign empirical indicaor res is  0.0007773939287289977
 benign loss is  2.615332670509815
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 97.05% 

Test Accuracy: 96.89% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0010541144292801619
 benign empirical indicaor res is  0.0010541144292801619
 benign loss is  2.956067733466625
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 97.17% 

Test Accuracy: 96.89% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0012693993048742414
 benign empirical indicaor res is  0.0012693993048742414
 benign loss is  2.4135094732046127
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 97.08% 

Test Accuracy: 96.96% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0015015983954071999
 benign empirical indicaor res is  0.0015015983954071999
 benign loss is  2.945392996072769
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 97.19% 

Test Accuracy: 97.04% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0008209623629227281
 benign empirical indicaor res is  0.0008209623629227281
 benign loss is  2.621703565120697
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 97.08% 

Test Accuracy: 96.91% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0007562458631582558
 benign empirical indicaor res is  0.0007562458631582558
 benign loss is  2.3777348026633263
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 97.19% 

Test Accuracy: 96.98% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0016659636748954654
 benign empirical indicaor res is  0.0016659636748954654
 benign loss is  3.136171095073223
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 97.07% 

Test Accuracy: 97.03% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0010019262554123998
 benign empirical indicaor res is  0.0010019262554123998
 benign loss is  2.9140879660844803
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 97.21% 

Test Accuracy: 97.15% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0007578553049825132
 benign empirical indicaor res is  0.0007578553049825132
 benign loss is  3.1910151541233063
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 97.12% 

Test Accuracy: 97.10% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0010300748981535435
 benign empirical indicaor res is  0.0010300748981535435
 benign loss is  3.0507135838270187
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 97.28% 

Test Accuracy: 97.22% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0008142832084558904
 benign empirical indicaor res is  0.0008142832084558904
 benign loss is  2.949173294007778
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 97.20% 

Test Accuracy: 97.17% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0005653757834807038
 benign empirical indicaor res is  0.0005653757834807038
 benign loss is  2.569404684007168
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 97.22% 

Test Accuracy: 97.25% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.00045859304373152554
 benign empirical indicaor res is  0.00045859304373152554
 benign loss is  2.5231805592775345
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 97.25% 

Test Accuracy: 97.24% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0005748933181166649
 benign empirical indicaor res is  0.0005748933181166649
 benign loss is  2.0471073612570763
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 97.26% 

Test Accuracy: 97.26% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0005788542330265045
 benign empirical indicaor res is  0.0005788542330265045
 benign loss is  2.5720907375216484
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 97.28% 

Test Accuracy: 97.28% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0004760526935569942
 benign empirical indicaor res is  0.0004760526935569942
 benign loss is  2.6329098269343376
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 97.31% 

Test Accuracy: 97.37% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.00047432005521841347
 benign empirical indicaor res is  0.00047432005521841347
 benign loss is  1.9585132524371147
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 97.27% 

Test Accuracy: 97.29% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.000545776856597513
 benign empirical indicaor res is  0.000545776856597513
 benign loss is  2.013560935854912
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 97.34% 

Test Accuracy: 97.26% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0006048533832654357
 benign empirical indicaor res is  0.0006048533832654357
 benign loss is  2.8300726115703583
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 97.30% 

Test Accuracy: 97.29% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0005029301391914487
 benign empirical indicaor res is  0.0005029301391914487
 benign loss is  2.419103778898716
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 97.33% 

Test Accuracy: 97.36% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
poisoned accuracy threshold is  0.8236000001570007
distance ratio is <class 'float'>
len of model dicts is  10
compute distance is  tensor(18.8028, device='cuda:3')
compute distance is  tensor(31.7460, device='cuda:3')
compute distance is  tensor(55.9760, device='cuda:3')
compute distance is  tensor(44.5991, device='cuda:3')
compute distance is  tensor(33.6097, device='cuda:3')
compute distance is  tensor(29.0684, device='cuda:3')
compute distance is  tensor(58.6441, device='cuda:3')
compute distance is  tensor(33.7982, device='cuda:3')
compute distance is  tensor(81.0269, device='cuda:3')
compute distance is  tensor(36.2734, device='cuda:3')
calculated distance threshold is  tensor(80.4046, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.4413166668230082
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.28070000015633917
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.39791666682300786
====================
====================
iteration is  1
round is  0
accuracy is  0.3843166668230075
====================
====================
iteration is  1
round is  1
accuracy is  0.35896666682300726
====================
________________________________
test distance is  tensor(4283.3452, device='cuda:3')
test acc is  0.28070000015633917
test loss is 5.934475584579175
test entropy is  0.28718072922626287
________________________________
diff is  tensor(43.2482, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4355, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.1307, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4784, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.5094, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0567, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3278, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.2482, device='cuda:3')
clipping
cal diff is tensor(0.4355, device='cuda:3')
clipping
cal diff is tensor(574.1307, device='cuda:3')
clipping
cal diff is tensor(0.4784, device='cuda:3')
clipping
cal diff is tensor(3642.5093, device='cuda:3')
clipping
cal diff is tensor(2.0567, device='cuda:3')
clipping
cal diff is tensor(20.3278, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(4242.9536, device='cuda:3')
test acc is  0.28748333348967264
test loss is 5.708851053770672
test entropy is  0.2933887964340924
________________________________
diff is  tensor(42.8403, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4314, device='cuda:3', dtype=torch.float64)
diff is  tensor(568.7165, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4739, device='cuda:3', dtype=torch.float64)
diff is  tensor(3608.1594, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0373, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1361, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.8403, device='cuda:3')
clipping
cal diff is tensor(0.4314, device='cuda:3')
clipping
cal diff is tensor(568.7165, device='cuda:3')
clipping
cal diff is tensor(0.4739, device='cuda:3')
clipping
cal diff is tensor(3608.1594, device='cuda:3')
clipping
cal diff is tensor(2.0373, device='cuda:3')
clipping
cal diff is tensor(20.1361, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(4202.5605, device='cuda:3')
test acc is  0.29423333348967273
test loss is 5.487260006892401
test entropy is  0.29972381559389233
________________________________
diff is  tensor(42.4325, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4273, device='cuda:3', dtype=torch.float64)
diff is  tensor(563.3020, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4694, device='cuda:3', dtype=torch.float64)
diff is  tensor(3573.8079, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0179, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.9444, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.4325, device='cuda:3')
clipping
cal diff is tensor(0.4273, device='cuda:3')
clipping
cal diff is tensor(563.3020, device='cuda:3')
clipping
cal diff is tensor(0.4694, device='cuda:3')
clipping
cal diff is tensor(3573.8079, device='cuda:3')
clipping
cal diff is tensor(2.0179, device='cuda:3')
clipping
cal diff is tensor(19.9444, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(4162.1655, device='cuda:3')
test acc is  0.3010000001563396
test loss is 5.271444671443785
test entropy is  0.30613069689032363
________________________________
diff is  tensor(42.0246, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4231, device='cuda:3', dtype=torch.float64)
diff is  tensor(557.8873, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4649, device='cuda:3', dtype=torch.float64)
diff is  tensor(3539.4551, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9985, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.7527, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0246, device='cuda:3')
clipping
cal diff is tensor(0.4231, device='cuda:3')
clipping
cal diff is tensor(557.8873, device='cuda:3')
clipping
cal diff is tensor(0.4649, device='cuda:3')
clipping
cal diff is tensor(3539.4551, device='cuda:3')
clipping
cal diff is tensor(1.9985, device='cuda:3')
clipping
cal diff is tensor(19.7527, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(4121.7681, device='cuda:3')
test acc is  0.3084000001563397
test loss is 5.061595096516965
test entropy is  0.3125747626683097
________________________________
diff is  tensor(41.6167, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4190, device='cuda:3', dtype=torch.float64)
diff is  tensor(552.4724, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4604, device='cuda:3', dtype=torch.float64)
diff is  tensor(3505.1008, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9791, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.5610, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.6167, device='cuda:3')
clipping
cal diff is tensor(0.4190, device='cuda:3')
clipping
cal diff is tensor(552.4724, device='cuda:3')
clipping
cal diff is tensor(0.4604, device='cuda:3')
clipping
cal diff is tensor(3505.1006, device='cuda:3')
clipping
cal diff is tensor(1.9791, device='cuda:3')
clipping
cal diff is tensor(19.5610, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(4081.3699, device='cuda:3')
test acc is  0.31563333348967315
test loss is 4.853931084370562
test entropy is  0.319070110411278
________________________________
diff is  tensor(41.2088, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4149, device='cuda:3', dtype=torch.float64)
diff is  tensor(547.0572, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4559, device='cuda:3', dtype=torch.float64)
diff is  tensor(3470.7446, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9597, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.3693, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.2088, device='cuda:3')
clipping
cal diff is tensor(0.4149, device='cuda:3')
clipping
cal diff is tensor(547.0573, device='cuda:3')
clipping
cal diff is tensor(0.4559, device='cuda:3')
clipping
cal diff is tensor(3470.7446, device='cuda:3')
clipping
cal diff is tensor(1.9597, device='cuda:3')
clipping
cal diff is tensor(19.3693, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(4040.9690, device='cuda:3')
test acc is  0.32376666682300664
test loss is 4.653537989171075
test entropy is  0.3255928373540134
________________________________
diff is  tensor(40.8008, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4108, device='cuda:3', dtype=torch.float64)
diff is  tensor(541.6418, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4514, device='cuda:3', dtype=torch.float64)
diff is  tensor(3436.3871, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9403, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.1775, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.8008, device='cuda:3')
clipping
cal diff is tensor(0.4108, device='cuda:3')
clipping
cal diff is tensor(541.6418, device='cuda:3')
clipping
cal diff is tensor(0.4514, device='cuda:3')
clipping
cal diff is tensor(3436.3872, device='cuda:3')
clipping
cal diff is tensor(1.9403, device='cuda:3')
clipping
cal diff is tensor(19.1775, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(4000.5662, device='cuda:3')
test acc is  0.33288333348967347
test loss is 4.457876815978906
test entropy is  0.33212143883331496
________________________________
diff is  tensor(40.3929, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4067, device='cuda:3', dtype=torch.float64)
diff is  tensor(536.2261, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4469, device='cuda:3', dtype=torch.float64)
diff is  tensor(3402.0277, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9209, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.9858, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.3929, device='cuda:3')
clipping
cal diff is tensor(0.4067, device='cuda:3')
clipping
cal diff is tensor(536.2261, device='cuda:3')
clipping
cal diff is tensor(0.4469, device='cuda:3')
clipping
cal diff is tensor(3402.0276, device='cuda:3')
clipping
cal diff is tensor(1.9209, device='cuda:3')
clipping
cal diff is tensor(18.9858, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3960.1616, device='cuda:3')
test acc is  0.3412000001563403
test loss is 4.266635271023586
test entropy is  0.3385864624114179
________________________________
diff is  tensor(39.9849, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4026, device='cuda:3', dtype=torch.float64)
diff is  tensor(530.8101, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4423, device='cuda:3', dtype=torch.float64)
diff is  tensor(3367.6667, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9015, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7940, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.9849, device='cuda:3')
clipping
cal diff is tensor(0.4026, device='cuda:3')
clipping
cal diff is tensor(530.8102, device='cuda:3')
clipping
cal diff is tensor(0.4423, device='cuda:3')
clipping
cal diff is tensor(3367.6667, device='cuda:3')
clipping
cal diff is tensor(1.9015, device='cuda:3')
clipping
cal diff is tensor(18.7940, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3919.7544, device='cuda:3')
test acc is  0.35075000015634045
test loss is 4.079124091276482
test entropy is  0.3450447183841073
________________________________
diff is  tensor(39.5769, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3985, device='cuda:3', dtype=torch.float64)
diff is  tensor(525.3939, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4378, device='cuda:3', dtype=torch.float64)
diff is  tensor(3333.3039, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8821, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.6022, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.5769, device='cuda:3')
clipping
cal diff is tensor(0.3985, device='cuda:3')
clipping
cal diff is tensor(525.3939, device='cuda:3')
clipping
cal diff is tensor(0.4378, device='cuda:3')
clipping
cal diff is tensor(3333.3037, device='cuda:3')
clipping
cal diff is tensor(1.8821, device='cuda:3')
clipping
cal diff is tensor(18.6022, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3879.3457, device='cuda:3')
test acc is  0.3603166668230072
test loss is 3.8985200446805974
test entropy is  0.35134520335619385
________________________________
diff is  tensor(39.1689, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3944, device='cuda:3', dtype=torch.float64)
diff is  tensor(519.9773, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4333, device='cuda:3', dtype=torch.float64)
diff is  tensor(3298.9392, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8627, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.4105, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.1689, device='cuda:3')
clipping
cal diff is tensor(0.3944, device='cuda:3')
clipping
cal diff is tensor(519.9774, device='cuda:3')
clipping
cal diff is tensor(0.4333, device='cuda:3')
clipping
cal diff is tensor(3298.9392, device='cuda:3')
clipping
cal diff is tensor(1.8627, device='cuda:3')
clipping
cal diff is tensor(18.4105, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3838.9343, device='cuda:3')
test acc is  0.37026666682300735
test loss is 3.721197551120319
test entropy is  0.3575976346887505
________________________________
diff is  tensor(38.7609, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3903, device='cuda:3', dtype=torch.float64)
diff is  tensor(514.5605, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4288, device='cuda:3', dtype=torch.float64)
diff is  tensor(3264.5727, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8433, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2187, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.7609, device='cuda:3')
clipping
cal diff is tensor(0.3903, device='cuda:3')
clipping
cal diff is tensor(514.5605, device='cuda:3')
clipping
cal diff is tensor(0.4288, device='cuda:3')
clipping
cal diff is tensor(3264.5728, device='cuda:3')
clipping
cal diff is tensor(1.8433, device='cuda:3')
clipping
cal diff is tensor(18.2187, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3798.5210, device='cuda:3')
test acc is  0.38163333348967415
test loss is 3.5479762006415996
test entropy is  0.3636699302840843
________________________________
diff is  tensor(38.3528, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3862, device='cuda:3', dtype=torch.float64)
diff is  tensor(509.1434, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4243, device='cuda:3', dtype=torch.float64)
diff is  tensor(3230.2043, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8239, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.0269, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.3528, device='cuda:3')
clipping
cal diff is tensor(0.3862, device='cuda:3')
clipping
cal diff is tensor(509.1434, device='cuda:3')
clipping
cal diff is tensor(0.4243, device='cuda:3')
clipping
cal diff is tensor(3230.2041, device='cuda:3')
clipping
cal diff is tensor(1.8239, device='cuda:3')
clipping
cal diff is tensor(18.0269, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3758.1052, device='cuda:3')
test acc is  0.3937166668230076
test loss is 3.380129407336717
test entropy is  0.36955860136414387
________________________________
diff is  tensor(37.9447, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3821, device='cuda:3', dtype=torch.float64)
diff is  tensor(503.7260, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4198, device='cuda:3', dtype=torch.float64)
diff is  tensor(3195.8340, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8045, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8351, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.9447, device='cuda:3')
clipping
cal diff is tensor(0.3821, device='cuda:3')
clipping
cal diff is tensor(503.7260, device='cuda:3')
clipping
cal diff is tensor(0.4198, device='cuda:3')
clipping
cal diff is tensor(3195.8340, device='cuda:3')
clipping
cal diff is tensor(1.8045, device='cuda:3')
clipping
cal diff is tensor(17.8351, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3717.6875, device='cuda:3')
test acc is  0.4059500001563411
test loss is 3.216489086400217
test entropy is  0.3752101999737306
________________________________
diff is  tensor(37.5366, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3780, device='cuda:3', dtype=torch.float64)
diff is  tensor(498.3082, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4153, device='cuda:3', dtype=torch.float64)
diff is  tensor(3161.4617, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7851, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6432, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.5366, device='cuda:3')
clipping
cal diff is tensor(0.3780, device='cuda:3')
clipping
cal diff is tensor(498.3082, device='cuda:3')
clipping
cal diff is tensor(0.4153, device='cuda:3')
clipping
cal diff is tensor(3161.4619, device='cuda:3')
clipping
cal diff is tensor(1.7851, device='cuda:3')
clipping
cal diff is tensor(17.6432, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3677.2671, device='cuda:3')
test acc is  0.4191166668230079
test loss is 3.057949428746441
test entropy is  0.38060519042045576
________________________________
diff is  tensor(37.1285, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3738, device='cuda:3', dtype=torch.float64)
diff is  tensor(492.8902, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4107, device='cuda:3', dtype=torch.float64)
diff is  tensor(3127.0875, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7657, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.4514, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.1285, device='cuda:3')
clipping
cal diff is tensor(0.3738, device='cuda:3')
clipping
cal diff is tensor(492.8901, device='cuda:3')
clipping
cal diff is tensor(0.4107, device='cuda:3')
clipping
cal diff is tensor(3127.0874, device='cuda:3')
clipping
cal diff is tensor(1.7657, device='cuda:3')
clipping
cal diff is tensor(17.4514, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3636.8442, device='cuda:3')
test acc is  0.4320666668230081
test loss is 2.9040554681820656
test entropy is  0.38569909756752985
________________________________
diff is  tensor(36.7203, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3697, device='cuda:3', dtype=torch.float64)
diff is  tensor(487.4718, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4062, device='cuda:3', dtype=torch.float64)
diff is  tensor(3092.7112, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7463, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.2596, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.7203, device='cuda:3')
clipping
cal diff is tensor(0.3697, device='cuda:3')
clipping
cal diff is tensor(487.4718, device='cuda:3')
clipping
cal diff is tensor(0.4062, device='cuda:3')
clipping
cal diff is tensor(3092.7109, device='cuda:3')
clipping
cal diff is tensor(1.7463, device='cuda:3')
clipping
cal diff is tensor(17.2596, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3596.4187, device='cuda:3')
test acc is  0.44505000015634155
test loss is 2.7550992927571603
test entropy is  0.3904928405687753
________________________________
diff is  tensor(36.3121, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3656, device='cuda:3', dtype=torch.float64)
diff is  tensor(482.0531, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4017, device='cuda:3', dtype=torch.float64)
diff is  tensor(3058.3327, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7269, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.0677, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.3121, device='cuda:3')
clipping
cal diff is tensor(0.3656, device='cuda:3')
clipping
cal diff is tensor(482.0530, device='cuda:3')
clipping
cal diff is tensor(0.4017, device='cuda:3')
clipping
cal diff is tensor(3058.3325, device='cuda:3')
clipping
cal diff is tensor(1.7269, device='cuda:3')
clipping
cal diff is tensor(17.0677, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3555.9912, device='cuda:3')
test acc is  0.45811666682300833
test loss is 2.6107241640975483
test entropy is  0.39497399298366964
________________________________
diff is  tensor(35.9039, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3615, device='cuda:3', dtype=torch.float64)
diff is  tensor(476.6340, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3972, device='cuda:3', dtype=torch.float64)
diff is  tensor(3023.9519, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7075, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.8758, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.9039, device='cuda:3')
clipping
cal diff is tensor(0.3615, device='cuda:3')
clipping
cal diff is tensor(476.6340, device='cuda:3')
clipping
cal diff is tensor(0.3972, device='cuda:3')
clipping
cal diff is tensor(3023.9519, device='cuda:3')
clipping
cal diff is tensor(1.7075, device='cuda:3')
clipping
cal diff is tensor(16.8758, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
________________________________
test distance is  tensor(3515.5608, device='cuda:3')
test acc is  0.4733833334896751
test loss is 2.4708388907822973
test entropy is  0.39921255732205374
________________________________
diff is  tensor(35.4957, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3574, device='cuda:3', dtype=torch.float64)
diff is  tensor(471.2146, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3927, device='cuda:3', dtype=torch.float64)
diff is  tensor(2989.5692, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6880, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.6840, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1594, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.4957, device='cuda:3')
clipping
cal diff is tensor(0.3574, device='cuda:3')
clipping
cal diff is tensor(471.2146, device='cuda:3')
clipping
cal diff is tensor(0.3927, device='cuda:3')
clipping
cal diff is tensor(2989.5691, device='cuda:3')
clipping
cal diff is tensor(1.6880, device='cuda:3')
clipping
cal diff is tensor(16.6840, device='cuda:3')
clipping
cal diff is tensor(0.1594, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 97.26% 

Test Accuracy: 97.30% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.06201627850532532
attack res is True
len of model dicts is  10
compute distance is  tensor(18.4837, device='cuda:3')
compute distance is  tensor(30.8288, device='cuda:3')
compute distance is  tensor(37.9215, device='cuda:3')
compute distance is  tensor(28.7502, device='cuda:3')
compute distance is  tensor(27.7113, device='cuda:3')
compute distance is  tensor(38.5862, device='cuda:3')
compute distance is  tensor(49.4334, device='cuda:3')
compute distance is  tensor(41.5218, device='cuda:3')
compute distance is  tensor(47.7695, device='cuda:3')
compute distance is  tensor(61.6669, device='cuda:3')
calculated distance threshold is  tensor(65.5102, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.3010833334896729
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4351333334896748
====================
====================
iteration is  0
round is  2
accuracy is  0.38023333348967414
====================
====================
iteration is  1
round is  0
accuracy is  0.3591833334896739
====================
====================
iteration is  1
round is  1
accuracy is  0.2510500001563382
====================
succ_min + 1
________________________________
test distance is  tensor(4281.8457, device='cuda:3')
test acc is  0.2510500001563382
test loss is 7.069649902996478
test entropy is  0.27543934815918714
________________________________
diff is  tensor(44.7948, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2929, device='cuda:3', dtype=torch.float64)
diff is  tensor(570.9380, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5041, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.7832, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0289, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3142, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.7948, device='cuda:3')
clipping
cal diff is tensor(0.2929, device='cuda:3')
clipping
cal diff is tensor(570.9380, device='cuda:3')
clipping
cal diff is tensor(0.5041, device='cuda:3')
clipping
cal diff is tensor(3642.7832, device='cuda:3')
clipping
cal diff is tensor(2.0289, device='cuda:3')
clipping
cal diff is tensor(20.3142, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4248.9658, device='cuda:3')
test acc is  0.2549333334896717
test loss is 6.86402794699679
test entropy is  0.2803984862972678
________________________________
diff is  tensor(44.4508, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2907, device='cuda:3', dtype=torch.float64)
diff is  tensor(566.5536, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5002, device='cuda:3', dtype=torch.float64)
diff is  tensor(3614.8091, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0133, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1582, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.4508, device='cuda:3')
clipping
cal diff is tensor(0.2907, device='cuda:3')
clipping
cal diff is tensor(566.5536, device='cuda:3')
clipping
cal diff is tensor(0.5002, device='cuda:3')
clipping
cal diff is tensor(3614.8091, device='cuda:3')
clipping
cal diff is tensor(2.0133, device='cuda:3')
clipping
cal diff is tensor(20.1582, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4216.0850, device='cuda:3')
test acc is  0.2592000001563385
test loss is 6.663719737707679
test entropy is  0.28536449865237484
________________________________
diff is  tensor(44.1068, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2884, device='cuda:3', dtype=torch.float64)
diff is  tensor(562.1691, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4963, device='cuda:3', dtype=torch.float64)
diff is  tensor(3586.8343, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9977, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.0022, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.1068, device='cuda:3')
clipping
cal diff is tensor(0.2884, device='cuda:3')
clipping
cal diff is tensor(562.1691, device='cuda:3')
clipping
cal diff is tensor(0.4963, device='cuda:3')
clipping
cal diff is tensor(3586.8345, device='cuda:3')
clipping
cal diff is tensor(1.9977, device='cuda:3')
clipping
cal diff is tensor(20.0022, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4183.2031, device='cuda:3')
test acc is  0.2638666668230053
test loss is 6.464644728693118
test entropy is  0.2905670228892806
________________________________
diff is  tensor(43.7628, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2862, device='cuda:3', dtype=torch.float64)
diff is  tensor(557.7845, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4925, device='cuda:3', dtype=torch.float64)
diff is  tensor(3558.8588, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9821, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8462, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.7628, device='cuda:3')
clipping
cal diff is tensor(0.2862, device='cuda:3')
clipping
cal diff is tensor(557.7844, device='cuda:3')
clipping
cal diff is tensor(0.4925, device='cuda:3')
clipping
cal diff is tensor(3558.8589, device='cuda:3')
clipping
cal diff is tensor(1.9821, device='cuda:3')
clipping
cal diff is tensor(19.8462, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4150.3203, device='cuda:3')
test acc is  0.2690333334896721
test loss is 6.267961312458714
test entropy is  0.2958377466749535
________________________________
diff is  tensor(43.4188, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2839, device='cuda:3', dtype=torch.float64)
diff is  tensor(553.3997, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4886, device='cuda:3', dtype=torch.float64)
diff is  tensor(3530.8824, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9666, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6902, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.4188, device='cuda:3')
clipping
cal diff is tensor(0.2839, device='cuda:3')
clipping
cal diff is tensor(553.3997, device='cuda:3')
clipping
cal diff is tensor(0.4886, device='cuda:3')
clipping
cal diff is tensor(3530.8823, device='cuda:3')
clipping
cal diff is tensor(1.9666, device='cuda:3')
clipping
cal diff is tensor(19.6902, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4117.4365, device='cuda:3')
test acc is  0.2739833334896722
test loss is 6.077918799701276
test entropy is  0.3010095146927498
________________________________
diff is  tensor(43.0747, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2817, device='cuda:3', dtype=torch.float64)
diff is  tensor(549.0148, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4847, device='cuda:3', dtype=torch.float64)
diff is  tensor(3502.9052, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9510, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.5341, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.0747, device='cuda:3')
clipping
cal diff is tensor(0.2817, device='cuda:3')
clipping
cal diff is tensor(549.0148, device='cuda:3')
clipping
cal diff is tensor(0.4847, device='cuda:3')
clipping
cal diff is tensor(3502.9050, device='cuda:3')
clipping
cal diff is tensor(1.9510, device='cuda:3')
clipping
cal diff is tensor(19.5341, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4084.5518, device='cuda:3')
test acc is  0.2791833334896724
test loss is 5.887675743875727
test entropy is  0.3064181124255347
________________________________
diff is  tensor(42.7307, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2794, device='cuda:3', dtype=torch.float64)
diff is  tensor(544.6297, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4808, device='cuda:3', dtype=torch.float64)
diff is  tensor(3474.9271, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9354, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.3781, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.7307, device='cuda:3')
clipping
cal diff is tensor(0.2794, device='cuda:3')
clipping
cal diff is tensor(544.6298, device='cuda:3')
clipping
cal diff is tensor(0.4808, device='cuda:3')
clipping
cal diff is tensor(3474.9272, device='cuda:3')
clipping
cal diff is tensor(1.9354, device='cuda:3')
clipping
cal diff is tensor(19.3781, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4051.6663, device='cuda:3')
test acc is  0.28476666682300583
test loss is 5.704337514285594
test entropy is  0.311708104492886
________________________________
diff is  tensor(42.3866, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2772, device='cuda:3', dtype=torch.float64)
diff is  tensor(540.2446, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4770, device='cuda:3', dtype=torch.float64)
diff is  tensor(3446.9482, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9198, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2221, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.3866, device='cuda:3')
clipping
cal diff is tensor(0.2772, device='cuda:3')
clipping
cal diff is tensor(540.2446, device='cuda:3')
clipping
cal diff is tensor(0.4770, device='cuda:3')
clipping
cal diff is tensor(3446.9482, device='cuda:3')
clipping
cal diff is tensor(1.9198, device='cuda:3')
clipping
cal diff is tensor(19.2221, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(4018.7791, device='cuda:3')
test acc is  0.2910833334896727
test loss is 5.522195783759485
test entropy is  0.3171406880751856
________________________________
diff is  tensor(42.0426, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2749, device='cuda:3', dtype=torch.float64)
diff is  tensor(535.8593, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4731, device='cuda:3', dtype=torch.float64)
diff is  tensor(3418.9686, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9042, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0661, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0426, device='cuda:3')
clipping
cal diff is tensor(0.2749, device='cuda:3')
clipping
cal diff is tensor(535.8593, device='cuda:3')
clipping
cal diff is tensor(0.4731, device='cuda:3')
clipping
cal diff is tensor(3418.9685, device='cuda:3')
clipping
cal diff is tensor(1.9042, device='cuda:3')
clipping
cal diff is tensor(19.0661, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3985.8909, device='cuda:3')
test acc is  0.29725000015633946
test loss is 5.342036201247274
test entropy is  0.32264853869356325
________________________________
diff is  tensor(41.6985, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2727, device='cuda:3', dtype=torch.float64)
diff is  tensor(531.4738, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4692, device='cuda:3', dtype=torch.float64)
diff is  tensor(3390.9878, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8886, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.9100, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.6985, device='cuda:3')
clipping
cal diff is tensor(0.2727, device='cuda:3')
clipping
cal diff is tensor(531.4738, device='cuda:3')
clipping
cal diff is tensor(0.4692, device='cuda:3')
clipping
cal diff is tensor(3390.9878, device='cuda:3')
clipping
cal diff is tensor(1.8886, device='cuda:3')
clipping
cal diff is tensor(18.9100, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3953.0015, device='cuda:3')
test acc is  0.30348333348967294
test loss is 5.167045085669073
test entropy is  0.32807884841903184
________________________________
diff is  tensor(41.3544, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2704, device='cuda:3', dtype=torch.float64)
diff is  tensor(527.0882, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4654, device='cuda:3', dtype=torch.float64)
diff is  tensor(3363.0060, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8731, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7540, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.3544, device='cuda:3')
clipping
cal diff is tensor(0.2704, device='cuda:3')
clipping
cal diff is tensor(527.0882, device='cuda:3')
clipping
cal diff is tensor(0.4654, device='cuda:3')
clipping
cal diff is tensor(3363.0059, device='cuda:3')
clipping
cal diff is tensor(1.8731, device='cuda:3')
clipping
cal diff is tensor(18.7540, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3920.1113, device='cuda:3')
test acc is  0.30991666682300645
test loss is 4.995696930742976
test entropy is  0.3334704138227363
________________________________
diff is  tensor(41.0103, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2682, device='cuda:3', dtype=torch.float64)
diff is  tensor(522.7024, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4615, device='cuda:3', dtype=torch.float64)
diff is  tensor(3335.0232, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8575, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5979, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.0103, device='cuda:3')
clipping
cal diff is tensor(0.2682, device='cuda:3')
clipping
cal diff is tensor(522.7024, device='cuda:3')
clipping
cal diff is tensor(0.4615, device='cuda:3')
clipping
cal diff is tensor(3335.0234, device='cuda:3')
clipping
cal diff is tensor(1.8575, device='cuda:3')
clipping
cal diff is tensor(18.5979, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3887.2197, device='cuda:3')
test acc is  0.31663333348967315
test loss is 4.82560836989234
test entropy is  0.3390042906217992
________________________________
diff is  tensor(40.6662, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2659, device='cuda:3', dtype=torch.float64)
diff is  tensor(518.3165, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4576, device='cuda:3', dtype=torch.float64)
diff is  tensor(3307.0395, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8419, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.4419, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.6662, device='cuda:3')
clipping
cal diff is tensor(0.2659, device='cuda:3')
clipping
cal diff is tensor(518.3165, device='cuda:3')
clipping
cal diff is tensor(0.4576, device='cuda:3')
clipping
cal diff is tensor(3307.0396, device='cuda:3')
clipping
cal diff is tensor(1.8419, device='cuda:3')
clipping
cal diff is tensor(18.4419, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3854.3271, device='cuda:3')
test acc is  0.3237833334896733
test loss is 4.659172514862598
test entropy is  0.3444002083878019
________________________________
diff is  tensor(40.3221, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2637, device='cuda:3', dtype=torch.float64)
diff is  tensor(513.9304, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4537, device='cuda:3', dtype=torch.float64)
diff is  tensor(3279.0548, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8263, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2858, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.3221, device='cuda:3')
clipping
cal diff is tensor(0.2637, device='cuda:3')
clipping
cal diff is tensor(513.9304, device='cuda:3')
clipping
cal diff is tensor(0.4537, device='cuda:3')
clipping
cal diff is tensor(3279.0549, device='cuda:3')
clipping
cal diff is tensor(1.8263, device='cuda:3')
clipping
cal diff is tensor(18.2858, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3821.4336, device='cuda:3')
test acc is  0.3308500001563401
test loss is 4.497855549428
test entropy is  0.3497630660690224
________________________________
diff is  tensor(39.9779, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2614, device='cuda:3', dtype=torch.float64)
diff is  tensor(509.5442, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4499, device='cuda:3', dtype=torch.float64)
diff is  tensor(3251.0692, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8107, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.1298, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.9779, device='cuda:3')
clipping
cal diff is tensor(0.2614, device='cuda:3')
clipping
cal diff is tensor(509.5442, device='cuda:3')
clipping
cal diff is tensor(0.4499, device='cuda:3')
clipping
cal diff is tensor(3251.0693, device='cuda:3')
clipping
cal diff is tensor(1.8107, device='cuda:3')
clipping
cal diff is tensor(18.1298, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3788.5383, device='cuda:3')
test acc is  0.3388333334896736
test loss is 4.338614400515932
test entropy is  0.3550953533031793
________________________________
diff is  tensor(39.6338, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2592, device='cuda:3', dtype=torch.float64)
diff is  tensor(505.1578, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4460, device='cuda:3', dtype=torch.float64)
diff is  tensor(3223.0826, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7951, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.9737, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.6338, device='cuda:3')
clipping
cal diff is tensor(0.2592, device='cuda:3')
clipping
cal diff is tensor(505.1578, device='cuda:3')
clipping
cal diff is tensor(0.4460, device='cuda:3')
clipping
cal diff is tensor(3223.0825, device='cuda:3')
clipping
cal diff is tensor(1.7951, device='cuda:3')
clipping
cal diff is tensor(17.9737, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3755.6421, device='cuda:3')
test acc is  0.3468333334896737
test loss is 4.183016697480989
test entropy is  0.36036524216312843
________________________________
diff is  tensor(39.2896, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2569, device='cuda:3', dtype=torch.float64)
diff is  tensor(500.7713, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4421, device='cuda:3', dtype=torch.float64)
diff is  tensor(3195.0948, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7795, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8176, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.2896, device='cuda:3')
clipping
cal diff is tensor(0.2569, device='cuda:3')
clipping
cal diff is tensor(500.7712, device='cuda:3')
clipping
cal diff is tensor(0.4421, device='cuda:3')
clipping
cal diff is tensor(3195.0947, device='cuda:3')
clipping
cal diff is tensor(1.7795, device='cuda:3')
clipping
cal diff is tensor(17.8176, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3722.7446, device='cuda:3')
test acc is  0.35536666682300716
test loss is 4.02964631148747
test entropy is  0.36569467962169444
________________________________
diff is  tensor(38.9455, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2547, device='cuda:3', dtype=torch.float64)
diff is  tensor(496.3845, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4383, device='cuda:3', dtype=torch.float64)
diff is  tensor(3167.1060, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7639, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6615, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.9455, device='cuda:3')
clipping
cal diff is tensor(0.2547, device='cuda:3')
clipping
cal diff is tensor(496.3845, device='cuda:3')
clipping
cal diff is tensor(0.4383, device='cuda:3')
clipping
cal diff is tensor(3167.1057, device='cuda:3')
clipping
cal diff is tensor(1.7639, device='cuda:3')
clipping
cal diff is tensor(17.6615, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3689.8457, device='cuda:3')
test acc is  0.3636666668230073
test loss is 3.8803572131118287
test entropy is  0.3707894960414372
________________________________
diff is  tensor(38.6013, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2524, device='cuda:3', dtype=torch.float64)
diff is  tensor(491.9976, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4344, device='cuda:3', dtype=torch.float64)
diff is  tensor(3139.1161, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7484, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.5054, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.6013, device='cuda:3')
clipping
cal diff is tensor(0.2524, device='cuda:3')
clipping
cal diff is tensor(491.9976, device='cuda:3')
clipping
cal diff is tensor(0.4344, device='cuda:3')
clipping
cal diff is tensor(3139.1160, device='cuda:3')
clipping
cal diff is tensor(1.7484, device='cuda:3')
clipping
cal diff is tensor(17.5054, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
________________________________
test distance is  tensor(3656.9456, device='cuda:3')
test acc is  0.37255000015634077
test loss is 3.7343393128309676
test entropy is  0.37598005888749286
________________________________
diff is  tensor(38.2571, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2502, device='cuda:3', dtype=torch.float64)
diff is  tensor(487.6106, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4305, device='cuda:3', dtype=torch.float64)
diff is  tensor(3111.1250, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7328, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3494, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.2571, device='cuda:3')
clipping
cal diff is tensor(0.2502, device='cuda:3')
clipping
cal diff is tensor(487.6105, device='cuda:3')
clipping
cal diff is tensor(0.4305, device='cuda:3')
clipping
cal diff is tensor(3111.1250, device='cuda:3')
clipping
cal diff is tensor(1.7328, device='cuda:3')
clipping
cal diff is tensor(17.3494, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
reach max round
new distance ratio is 0.99
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 97.25% 

Test Accuracy: 97.26% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.07178281247615814
attack res is True
len of model dicts is  10
compute distance is  tensor(24.4576, device='cuda:3')
compute distance is  tensor(28.2882, device='cuda:3')
compute distance is  tensor(46.7622, device='cuda:3')
compute distance is  tensor(61.1257, device='cuda:3')
compute distance is  tensor(36.4886, device='cuda:3')
compute distance is  tensor(49.6494, device='cuda:3')
compute distance is  tensor(60.1338, device='cuda:3')
compute distance is  tensor(29.2935, device='cuda:3')
compute distance is  tensor(61.6194, device='cuda:3')
compute distance is  tensor(39.7647, device='cuda:3')
calculated distance threshold is  tensor(64.9268, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.4108166668230079
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.33301666682300685
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3786000001563408
====================
====================
iteration is  1
round is  0
accuracy is  0.393200000156341
====================
====================
iteration is  1
round is  1
accuracy is  0.2375166668230044
====================
succ_min + 1
________________________________
test distance is  tensor(4281.7632, device='cuda:3')
test acc is  0.2375166668230044
test loss is 8.868233544485909
test entropy is  0.12861669225209177
________________________________
diff is  tensor(44.1419, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4088, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.1321, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4969, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.0505, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0374, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2842, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2109, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2109, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.1419, device='cuda:3')
clipping
cal diff is tensor(0.4088, device='cuda:3')
clipping
cal diff is tensor(573.1321, device='cuda:3')
clipping
cal diff is tensor(0.4969, device='cuda:3')
clipping
cal diff is tensor(3641.0505, device='cuda:3')
clipping
cal diff is tensor(2.0374, device='cuda:3')
clipping
cal diff is tensor(20.2842, device='cuda:3')
clipping
cal diff is tensor(0.2109, device='cuda:3')
clipping
________________________________
test distance is  tensor(4249.1758, device='cuda:3')
test acc is  0.2415833334896712
test loss is 8.609490551165681
test entropy is  0.13252182091588277
________________________________
diff is  tensor(43.8060, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4057, device='cuda:3', dtype=torch.float64)
diff is  tensor(568.7702, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4931, device='cuda:3', dtype=torch.float64)
diff is  tensor(3613.3396, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0219, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1298, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.8060, device='cuda:3')
clipping
cal diff is tensor(0.4057, device='cuda:3')
clipping
cal diff is tensor(568.7701, device='cuda:3')
clipping
cal diff is tensor(0.4931, device='cuda:3')
clipping
cal diff is tensor(3613.3396, device='cuda:3')
clipping
cal diff is tensor(2.0219, device='cuda:3')
clipping
cal diff is tensor(20.1298, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(4216.5894, device='cuda:3')
test acc is  0.24598333348967139
test loss is 8.355588986675368
test entropy is  0.13661966566194986
________________________________
diff is  tensor(43.4700, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4026, device='cuda:3', dtype=torch.float64)
diff is  tensor(564.4081, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4893, device='cuda:3', dtype=torch.float64)
diff is  tensor(3585.6278, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0064, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.9754, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.4700, device='cuda:3')
clipping
cal diff is tensor(0.4026, device='cuda:3')
clipping
cal diff is tensor(564.4081, device='cuda:3')
clipping
cal diff is tensor(0.4893, device='cuda:3')
clipping
cal diff is tensor(3585.6277, device='cuda:3')
clipping
cal diff is tensor(2.0064, device='cuda:3')
clipping
cal diff is tensor(19.9754, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(4184.0015, device='cuda:3')
test acc is  0.25018333348967153
test loss is 8.109713528964566
test entropy is  0.1407813957886401
________________________________
diff is  tensor(43.1341, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3995, device='cuda:3', dtype=torch.float64)
diff is  tensor(560.0459, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4856, device='cuda:3', dtype=torch.float64)
diff is  tensor(3557.9152, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9909, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8210, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.1341, device='cuda:3')
clipping
cal diff is tensor(0.3995, device='cuda:3')
clipping
cal diff is tensor(560.0459, device='cuda:3')
clipping
cal diff is tensor(0.4856, device='cuda:3')
clipping
cal diff is tensor(3557.9150, device='cuda:3')
clipping
cal diff is tensor(1.9909, device='cuda:3')
clipping
cal diff is tensor(19.8210, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(4151.4131, device='cuda:3')
test acc is  0.25448333348967167
test loss is 7.865099053901396
test entropy is  0.14518193428768023
________________________________
diff is  tensor(42.7981, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3964, device='cuda:3', dtype=torch.float64)
diff is  tensor(555.6835, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4818, device='cuda:3', dtype=torch.float64)
diff is  tensor(3530.2017, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9754, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6666, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.7981, device='cuda:3')
clipping
cal diff is tensor(0.3964, device='cuda:3')
clipping
cal diff is tensor(555.6835, device='cuda:3')
clipping
cal diff is tensor(0.4818, device='cuda:3')
clipping
cal diff is tensor(3530.2017, device='cuda:3')
clipping
cal diff is tensor(1.9754, device='cuda:3')
clipping
cal diff is tensor(19.6666, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(4118.8237, device='cuda:3')
test acc is  0.25911666682300516
test loss is 7.624016605714745
test entropy is  0.14982163288128147
________________________________
diff is  tensor(42.4621, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3933, device='cuda:3', dtype=torch.float64)
diff is  tensor(551.3211, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4780, device='cuda:3', dtype=torch.float64)
diff is  tensor(3502.4874, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9599, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.5122, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.4621, device='cuda:3')
clipping
cal diff is tensor(0.3933, device='cuda:3')
clipping
cal diff is tensor(551.3210, device='cuda:3')
clipping
cal diff is tensor(0.4780, device='cuda:3')
clipping
cal diff is tensor(3502.4875, device='cuda:3')
clipping
cal diff is tensor(1.9599, device='cuda:3')
clipping
cal diff is tensor(19.5122, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(4086.2329, device='cuda:3')
test acc is  0.2635166668230053
test loss is 7.388599816670042
test entropy is  0.15452912482403236
________________________________
diff is  tensor(42.1261, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3902, device='cuda:3', dtype=torch.float64)
diff is  tensor(546.9585, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4742, device='cuda:3', dtype=torch.float64)
diff is  tensor(3474.7723, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9444, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.3578, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.1261, device='cuda:3')
clipping
cal diff is tensor(0.3902, device='cuda:3')
clipping
cal diff is tensor(546.9585, device='cuda:3')
clipping
cal diff is tensor(0.4742, device='cuda:3')
clipping
cal diff is tensor(3474.7725, device='cuda:3')
clipping
cal diff is tensor(1.9444, device='cuda:3')
clipping
cal diff is tensor(19.3578, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(4053.6411, device='cuda:3')
test acc is  0.26843333348967213
test loss is 7.1551880404384915
test entropy is  0.15956141457342898
________________________________
diff is  tensor(41.7901, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3870, device='cuda:3', dtype=torch.float64)
diff is  tensor(542.5958, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4704, device='cuda:3', dtype=torch.float64)
diff is  tensor(3447.0562, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9289, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2034, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.7901, device='cuda:3')
clipping
cal diff is tensor(0.3870, device='cuda:3')
clipping
cal diff is tensor(542.5958, device='cuda:3')
clipping
cal diff is tensor(0.4704, device='cuda:3')
clipping
cal diff is tensor(3447.0562, device='cuda:3')
clipping
cal diff is tensor(1.9289, device='cuda:3')
clipping
cal diff is tensor(19.2034, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(4021.0486, device='cuda:3')
test acc is  0.27403333348967224
test loss is 6.9298567416063
test entropy is  0.1646096007163718
________________________________
diff is  tensor(41.4540, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3839, device='cuda:3', dtype=torch.float64)
diff is  tensor(538.2329, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4666, device='cuda:3', dtype=torch.float64)
diff is  tensor(3419.3392, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9134, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0490, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.4540, device='cuda:3')
clipping
cal diff is tensor(0.3839, device='cuda:3')
clipping
cal diff is tensor(538.2328, device='cuda:3')
clipping
cal diff is tensor(0.4666, device='cuda:3')
clipping
cal diff is tensor(3419.3394, device='cuda:3')
clipping
cal diff is tensor(1.9134, device='cuda:3')
clipping
cal diff is tensor(19.0490, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3988.4548, device='cuda:3')
test acc is  0.2789666668230057
test loss is 6.708709953690389
test entropy is  0.1698332981689017
________________________________
diff is  tensor(41.1180, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3808, device='cuda:3', dtype=torch.float64)
diff is  tensor(533.8698, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4629, device='cuda:3', dtype=torch.float64)
diff is  tensor(3391.6214, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8979, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.8946, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.1180, device='cuda:3')
clipping
cal diff is tensor(0.3808, device='cuda:3')
clipping
cal diff is tensor(533.8699, device='cuda:3')
clipping
cal diff is tensor(0.4629, device='cuda:3')
clipping
cal diff is tensor(3391.6213, device='cuda:3')
clipping
cal diff is tensor(1.8979, device='cuda:3')
clipping
cal diff is tensor(18.8946, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3955.8599, device='cuda:3')
test acc is  0.2838166668230058
test loss is 6.491181381221519
test entropy is  0.17527668440202152
________________________________
diff is  tensor(40.7820, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3777, device='cuda:3', dtype=torch.float64)
diff is  tensor(529.5067, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4591, device='cuda:3', dtype=torch.float64)
diff is  tensor(3363.9026, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8824, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7402, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.7820, device='cuda:3')
clipping
cal diff is tensor(0.3777, device='cuda:3')
clipping
cal diff is tensor(529.5067, device='cuda:3')
clipping
cal diff is tensor(0.4591, device='cuda:3')
clipping
cal diff is tensor(3363.9026, device='cuda:3')
clipping
cal diff is tensor(1.8824, device='cuda:3')
clipping
cal diff is tensor(18.7402, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3923.2639, device='cuda:3')
test acc is  0.2888000001563393
test loss is 6.277258557805629
test entropy is  0.18094504672263476
________________________________
diff is  tensor(40.4459, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3746, device='cuda:3', dtype=torch.float64)
diff is  tensor(525.1433, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4553, device='cuda:3', dtype=torch.float64)
diff is  tensor(3336.1829, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8668, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5858, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.4459, device='cuda:3')
clipping
cal diff is tensor(0.3746, device='cuda:3')
clipping
cal diff is tensor(525.1433, device='cuda:3')
clipping
cal diff is tensor(0.4553, device='cuda:3')
clipping
cal diff is tensor(3336.1829, device='cuda:3')
clipping
cal diff is tensor(1.8668, device='cuda:3')
clipping
cal diff is tensor(18.5858, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3890.6670, device='cuda:3')
test acc is  0.2931833334896727
test loss is 6.068888244852583
test entropy is  0.18680217307704344
________________________________
diff is  tensor(40.1098, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3715, device='cuda:3', dtype=torch.float64)
diff is  tensor(520.7799, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4515, device='cuda:3', dtype=torch.float64)
diff is  tensor(3308.4622, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8513, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.4313, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.1098, device='cuda:3')
clipping
cal diff is tensor(0.3715, device='cuda:3')
clipping
cal diff is tensor(520.7799, device='cuda:3')
clipping
cal diff is tensor(0.4515, device='cuda:3')
clipping
cal diff is tensor(3308.4624, device='cuda:3')
clipping
cal diff is tensor(1.8513, device='cuda:3')
clipping
cal diff is tensor(18.4313, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3858.0691, device='cuda:3')
test acc is  0.29895000015633955
test loss is 5.864952585844597
test entropy is  0.19284762944112707
________________________________
diff is  tensor(39.7738, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3684, device='cuda:3', dtype=torch.float64)
diff is  tensor(516.4163, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4477, device='cuda:3', dtype=torch.float64)
diff is  tensor(3280.7406, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8358, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2769, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.7738, device='cuda:3')
clipping
cal diff is tensor(0.3684, device='cuda:3')
clipping
cal diff is tensor(516.4163, device='cuda:3')
clipping
cal diff is tensor(0.4477, device='cuda:3')
clipping
cal diff is tensor(3280.7407, device='cuda:3')
clipping
cal diff is tensor(1.8358, device='cuda:3')
clipping
cal diff is tensor(18.2769, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3825.4695, device='cuda:3')
test acc is  0.30455000015633965
test loss is 5.663716386630337
test entropy is  0.19919501144939394
________________________________
diff is  tensor(39.4377, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3653, device='cuda:3', dtype=torch.float64)
diff is  tensor(512.0525, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4439, device='cuda:3', dtype=torch.float64)
diff is  tensor(3253.0181, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8203, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.1225, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.4377, device='cuda:3')
clipping
cal diff is tensor(0.3653, device='cuda:3')
clipping
cal diff is tensor(512.0525, device='cuda:3')
clipping
cal diff is tensor(0.4439, device='cuda:3')
clipping
cal diff is tensor(3253.0181, device='cuda:3')
clipping
cal diff is tensor(1.8203, device='cuda:3')
clipping
cal diff is tensor(18.1225, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3792.8689, device='cuda:3')
test acc is  0.3098666668230064
test loss is 5.467268727989848
test entropy is  0.20570850411235397
________________________________
diff is  tensor(39.1016, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3621, device='cuda:3', dtype=torch.float64)
diff is  tensor(507.6886, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4402, device='cuda:3', dtype=torch.float64)
diff is  tensor(3225.2944, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8048, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.9680, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.1016, device='cuda:3')
clipping
cal diff is tensor(0.3621, device='cuda:3')
clipping
cal diff is tensor(507.6886, device='cuda:3')
clipping
cal diff is tensor(0.4402, device='cuda:3')
clipping
cal diff is tensor(3225.2944, device='cuda:3')
clipping
cal diff is tensor(1.8048, device='cuda:3')
clipping
cal diff is tensor(17.9680, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3760.2673, device='cuda:3')
test acc is  0.31518333348967315
test loss is 5.27524251622686
test entropy is  0.21247082771554684
________________________________
diff is  tensor(38.7654, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3590, device='cuda:3', dtype=torch.float64)
diff is  tensor(503.3245, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4364, device='cuda:3', dtype=torch.float64)
diff is  tensor(3197.5698, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7893, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8136, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.7654, device='cuda:3')
clipping
cal diff is tensor(0.3590, device='cuda:3')
clipping
cal diff is tensor(503.3245, device='cuda:3')
clipping
cal diff is tensor(0.4364, device='cuda:3')
clipping
cal diff is tensor(3197.5698, device='cuda:3')
clipping
cal diff is tensor(1.7893, device='cuda:3')
clipping
cal diff is tensor(17.8135, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3727.6646, device='cuda:3')
test acc is  0.3211833334896732
test loss is 5.087878331955054
test entropy is  0.21938977479489882
________________________________
diff is  tensor(38.4293, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3559, device='cuda:3', dtype=torch.float64)
diff is  tensor(498.9602, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4326, device='cuda:3', dtype=torch.float64)
diff is  tensor(3169.8441, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7738, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6591, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.4293, device='cuda:3')
clipping
cal diff is tensor(0.3559, device='cuda:3')
clipping
cal diff is tensor(498.9603, device='cuda:3')
clipping
cal diff is tensor(0.4326, device='cuda:3')
clipping
cal diff is tensor(3169.8442, device='cuda:3')
clipping
cal diff is tensor(1.7738, device='cuda:3')
clipping
cal diff is tensor(17.6591, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3695.0603, device='cuda:3')
test acc is  0.32735000015634
test loss is 4.9034697612973925
test entropy is  0.22656461915005244
________________________________
diff is  tensor(38.0932, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3528, device='cuda:3', dtype=torch.float64)
diff is  tensor(494.5958, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4288, device='cuda:3', dtype=torch.float64)
diff is  tensor(3142.1175, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7582, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.5046, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.0932, device='cuda:3')
clipping
cal diff is tensor(0.3528, device='cuda:3')
clipping
cal diff is tensor(494.5958, device='cuda:3')
clipping
cal diff is tensor(0.4288, device='cuda:3')
clipping
cal diff is tensor(3142.1174, device='cuda:3')
clipping
cal diff is tensor(1.7582, device='cuda:3')
clipping
cal diff is tensor(17.5046, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
________________________________
test distance is  tensor(3662.4548, device='cuda:3')
test acc is  0.33365000015634017
test loss is 4.7242197225342935
test entropy is  0.23391377812287192
________________________________
diff is  tensor(37.7570, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3497, device='cuda:3', dtype=torch.float64)
diff is  tensor(490.2312, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4250, device='cuda:3', dtype=torch.float64)
diff is  tensor(3114.3897, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7427, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3502, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2093, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.7570, device='cuda:3')
clipping
cal diff is tensor(0.3497, device='cuda:3')
clipping
cal diff is tensor(490.2313, device='cuda:3')
clipping
cal diff is tensor(0.4250, device='cuda:3')
clipping
cal diff is tensor(3114.3896, device='cuda:3')
clipping
cal diff is tensor(1.7427, device='cuda:3')
clipping
cal diff is tensor(17.3502, device='cuda:3')
clipping
cal diff is tensor(0.2093, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 97.12% 

Test Accuracy: 97.00% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.10199183970689774
attack res is True
len of model dicts is  10
compute distance is  tensor(23.6279, device='cuda:3')
compute distance is  tensor(29.9353, device='cuda:3')
compute distance is  tensor(88.0208, device='cuda:3')
compute distance is  tensor(25.7951, device='cuda:3')
compute distance is  tensor(36.2029, device='cuda:3')
compute distance is  tensor(34.4768, device='cuda:3')
compute distance is  tensor(45.3683, device='cuda:3')
compute distance is  tensor(44.7547, device='cuda:3')
compute distance is  tensor(64.3486, device='cuda:3')
compute distance is  tensor(76.7666, device='cuda:3')
calculated distance threshold is  tensor(93.7518, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.25738333348967185
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4635000001563418
====================
====================
iteration is  0
round is  2
accuracy is  0.3094166668230064
====================
====================
iteration is  1
round is  0
accuracy is  0.42656666682300803
====================
====================
iteration is  1
round is  1
accuracy is  0.2992166668230062
====================
________________________________
test distance is  tensor(4282.6172, device='cuda:3')
test acc is  0.25738333348967185
test loss is 6.982393658237417
test entropy is  0.19834177742507667
________________________________
diff is  tensor(43.3553, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3872, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.8495, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5272, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.9505, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0349, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3360, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.3553, device='cuda:3')
clipping
cal diff is tensor(0.3872, device='cuda:3')
clipping
cal diff is tensor(573.8494, device='cuda:3')
clipping
cal diff is tensor(0.5272, device='cuda:3')
clipping
cal diff is tensor(3641.9504, device='cuda:3')
clipping
cal diff is tensor(2.0349, device='cuda:3')
clipping
cal diff is tensor(20.3360, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(4235.4844, device='cuda:3')
test acc is  0.2664666668230054
test loss is 6.671700284425129
test entropy is  0.20594587018971505
________________________________
diff is  tensor(42.8781, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3830, device='cuda:3', dtype=torch.float64)
diff is  tensor(567.5335, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5214, device='cuda:3', dtype=torch.float64)
diff is  tensor(3601.8664, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0126, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1121, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.8781, device='cuda:3')
clipping
cal diff is tensor(0.3830, device='cuda:3')
clipping
cal diff is tensor(567.5336, device='cuda:3')
clipping
cal diff is tensor(0.5214, device='cuda:3')
clipping
cal diff is tensor(3601.8665, device='cuda:3')
clipping
cal diff is tensor(2.0126, device='cuda:3')
clipping
cal diff is tensor(20.1121, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(4188.3481, device='cuda:3')
test acc is  0.2754333334896723
test loss is 6.371039831053728
test entropy is  0.21357398787572948
________________________________
diff is  tensor(42.4009, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3787, device='cuda:3', dtype=torch.float64)
diff is  tensor(561.2173, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5156, device='cuda:3', dtype=torch.float64)
diff is  tensor(3561.7801, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9902, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8883, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.4009, device='cuda:3')
clipping
cal diff is tensor(0.3787, device='cuda:3')
clipping
cal diff is tensor(561.2173, device='cuda:3')
clipping
cal diff is tensor(0.5156, device='cuda:3')
clipping
cal diff is tensor(3561.7803, device='cuda:3')
clipping
cal diff is tensor(1.9902, device='cuda:3')
clipping
cal diff is tensor(19.8883, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(4141.2090, device='cuda:3')
test acc is  0.2847500001563392
test loss is 6.08181474229166
test entropy is  0.22121621262448937
________________________________
diff is  tensor(41.9237, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3744, device='cuda:3', dtype=torch.float64)
diff is  tensor(554.9006, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5097, device='cuda:3', dtype=torch.float64)
diff is  tensor(3521.6913, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9678, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6645, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.9237, device='cuda:3')
clipping
cal diff is tensor(0.3744, device='cuda:3')
clipping
cal diff is tensor(554.9006, device='cuda:3')
clipping
cal diff is tensor(0.5097, device='cuda:3')
clipping
cal diff is tensor(3521.6914, device='cuda:3')
clipping
cal diff is tensor(1.9678, device='cuda:3')
clipping
cal diff is tensor(19.6645, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(4094.0667, device='cuda:3')
test acc is  0.29498333348967276
test loss is 5.798995664887337
test entropy is  0.2289409745079495
________________________________
diff is  tensor(41.4464, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3702, device='cuda:3', dtype=torch.float64)
diff is  tensor(548.5836, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5039, device='cuda:3', dtype=torch.float64)
diff is  tensor(3481.5999, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9454, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4406, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.4464, device='cuda:3')
clipping
cal diff is tensor(0.3702, device='cuda:3')
clipping
cal diff is tensor(548.5835, device='cuda:3')
clipping
cal diff is tensor(0.5039, device='cuda:3')
clipping
cal diff is tensor(3481.5996, device='cuda:3')
clipping
cal diff is tensor(1.9454, device='cuda:3')
clipping
cal diff is tensor(19.4406, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(4046.9214, device='cuda:3')
test acc is  0.304833333489673
test loss is 5.524079919115567
test entropy is  0.23683989154441015
________________________________
diff is  tensor(40.9691, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3659, device='cuda:3', dtype=torch.float64)
diff is  tensor(542.2661, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4981, device='cuda:3', dtype=torch.float64)
diff is  tensor(3441.5057, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9229, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2167, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.9691, device='cuda:3')
clipping
cal diff is tensor(0.3659, device='cuda:3')
clipping
cal diff is tensor(542.2661, device='cuda:3')
clipping
cal diff is tensor(0.4981, device='cuda:3')
clipping
cal diff is tensor(3441.5059, device='cuda:3')
clipping
cal diff is tensor(1.9229, device='cuda:3')
clipping
cal diff is tensor(19.2167, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3999.7732, device='cuda:3')
test acc is  0.3151000001563399
test loss is 5.257812804504752
test entropy is  0.2447956715311323
________________________________
diff is  tensor(40.4918, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3616, device='cuda:3', dtype=torch.float64)
diff is  tensor(535.9481, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4923, device='cuda:3', dtype=torch.float64)
diff is  tensor(3401.4089, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9005, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.9928, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.4918, device='cuda:3')
clipping
cal diff is tensor(0.3616, device='cuda:3')
clipping
cal diff is tensor(535.9481, device='cuda:3')
clipping
cal diff is tensor(0.4923, device='cuda:3')
clipping
cal diff is tensor(3401.4089, device='cuda:3')
clipping
cal diff is tensor(1.9005, device='cuda:3')
clipping
cal diff is tensor(18.9928, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3952.6216, device='cuda:3')
test acc is  0.32491666682300674
test loss is 5.002368252668807
test entropy is  0.25270892889387825
________________________________
diff is  tensor(40.0144, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3574, device='cuda:3', dtype=torch.float64)
diff is  tensor(529.6298, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4865, device='cuda:3', dtype=torch.float64)
diff is  tensor(3361.3094, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8781, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7689, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.0144, device='cuda:3')
clipping
cal diff is tensor(0.3574, device='cuda:3')
clipping
cal diff is tensor(529.6298, device='cuda:3')
clipping
cal diff is tensor(0.4865, device='cuda:3')
clipping
cal diff is tensor(3361.3093, device='cuda:3')
clipping
cal diff is tensor(1.8781, device='cuda:3')
clipping
cal diff is tensor(18.7689, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3905.4663, device='cuda:3')
test acc is  0.3359166668230069
test loss is 4.751039845348675
test entropy is  0.2609290782926179
________________________________
diff is  tensor(39.5371, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3531, device='cuda:3', dtype=torch.float64)
diff is  tensor(523.3110, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4807, device='cuda:3', dtype=torch.float64)
diff is  tensor(3321.2070, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8557, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5450, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.5371, device='cuda:3')
clipping
cal diff is tensor(0.3531, device='cuda:3')
clipping
cal diff is tensor(523.3110, device='cuda:3')
clipping
cal diff is tensor(0.4807, device='cuda:3')
clipping
cal diff is tensor(3321.2070, device='cuda:3')
clipping
cal diff is tensor(1.8557, device='cuda:3')
clipping
cal diff is tensor(18.5450, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3858.3076, device='cuda:3')
test acc is  0.3475333334896738
test loss is 4.510377501628038
test entropy is  0.26903833178823183
________________________________
diff is  tensor(39.0596, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3488, device='cuda:3', dtype=torch.float64)
diff is  tensor(516.9917, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4749, device='cuda:3', dtype=torch.float64)
diff is  tensor(3281.1016, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8333, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.3211, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.0596, device='cuda:3')
clipping
cal diff is tensor(0.3488, device='cuda:3')
clipping
cal diff is tensor(516.9918, device='cuda:3')
clipping
cal diff is tensor(0.4749, device='cuda:3')
clipping
cal diff is tensor(3281.1016, device='cuda:3')
clipping
cal diff is tensor(1.8333, device='cuda:3')
clipping
cal diff is tensor(18.3211, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3811.1458, device='cuda:3')
test acc is  0.3591166668230073
test loss is 4.27911379596572
test entropy is  0.27716669848542225
________________________________
diff is  tensor(38.5822, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3446, device='cuda:3', dtype=torch.float64)
diff is  tensor(510.6720, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4691, device='cuda:3', dtype=torch.float64)
diff is  tensor(3240.9932, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8109, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.0971, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.5822, device='cuda:3')
clipping
cal diff is tensor(0.3446, device='cuda:3')
clipping
cal diff is tensor(510.6720, device='cuda:3')
clipping
cal diff is tensor(0.4691, device='cuda:3')
clipping
cal diff is tensor(3240.9932, device='cuda:3')
clipping
cal diff is tensor(1.8109, device='cuda:3')
clipping
cal diff is tensor(18.0971, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3763.9802, device='cuda:3')
test acc is  0.3706166668230074
test loss is 4.0539736651154215
test entropy is  0.28541171687371186
________________________________
diff is  tensor(38.1046, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3403, device='cuda:3', dtype=torch.float64)
diff is  tensor(504.3518, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4633, device='cuda:3', dtype=torch.float64)
diff is  tensor(3200.8818, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7885, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8731, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.1046, device='cuda:3')
clipping
cal diff is tensor(0.3403, device='cuda:3')
clipping
cal diff is tensor(504.3518, device='cuda:3')
clipping
cal diff is tensor(0.4633, device='cuda:3')
clipping
cal diff is tensor(3200.8818, device='cuda:3')
clipping
cal diff is tensor(1.7885, device='cuda:3')
clipping
cal diff is tensor(17.8731, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3716.8108, device='cuda:3')
test acc is  0.38290000015634085
test loss is 3.837839102948398
test entropy is  0.2935535100890375
________________________________
diff is  tensor(37.6271, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3361, device='cuda:3', dtype=torch.float64)
diff is  tensor(498.0311, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4575, device='cuda:3', dtype=torch.float64)
diff is  tensor(3160.7673, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7661, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6491, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.6271, device='cuda:3')
clipping
cal diff is tensor(0.3361, device='cuda:3')
clipping
cal diff is tensor(498.0311, device='cuda:3')
clipping
cal diff is tensor(0.4575, device='cuda:3')
clipping
cal diff is tensor(3160.7671, device='cuda:3')
clipping
cal diff is tensor(1.7661, device='cuda:3')
clipping
cal diff is tensor(17.6491, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3669.6377, device='cuda:3')
test acc is  0.3961333334896744
test loss is 3.6301529689638343
test entropy is  0.30167374180069867
________________________________
diff is  tensor(37.1495, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3318, device='cuda:3', dtype=torch.float64)
diff is  tensor(491.7099, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4517, device='cuda:3', dtype=torch.float64)
diff is  tensor(3120.6495, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7437, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.4251, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.1495, device='cuda:3')
clipping
cal diff is tensor(0.3318, device='cuda:3')
clipping
cal diff is tensor(491.7098, device='cuda:3')
clipping
cal diff is tensor(0.4517, device='cuda:3')
clipping
cal diff is tensor(3120.6494, device='cuda:3')
clipping
cal diff is tensor(1.7437, device='cuda:3')
clipping
cal diff is tensor(17.4251, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3622.4609, device='cuda:3')
test acc is  0.4098666668230079
test loss is 3.428768825302246
test entropy is  0.30981328880100617
________________________________
diff is  tensor(36.6719, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3275, device='cuda:3', dtype=torch.float64)
diff is  tensor(485.3881, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4459, device='cuda:3', dtype=torch.float64)
diff is  tensor(3080.5284, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7213, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.2011, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.6719, device='cuda:3')
clipping
cal diff is tensor(0.3275, device='cuda:3')
clipping
cal diff is tensor(485.3881, device='cuda:3')
clipping
cal diff is tensor(0.4459, device='cuda:3')
clipping
cal diff is tensor(3080.5283, device='cuda:3')
clipping
cal diff is tensor(1.7213, device='cuda:3')
clipping
cal diff is tensor(17.2011, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3575.2800, device='cuda:3')
test acc is  0.4229833334896747
test loss is 3.237196455378014
test entropy is  0.31778376560602617
________________________________
diff is  tensor(36.1943, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3233, device='cuda:3', dtype=torch.float64)
diff is  tensor(479.0659, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4401, device='cuda:3', dtype=torch.float64)
diff is  tensor(3040.4040, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6988, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.9770, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.1943, device='cuda:3')
clipping
cal diff is tensor(0.3233, device='cuda:3')
clipping
cal diff is tensor(479.0659, device='cuda:3')
clipping
cal diff is tensor(0.4401, device='cuda:3')
clipping
cal diff is tensor(3040.4038, device='cuda:3')
clipping
cal diff is tensor(1.6988, device='cuda:3')
clipping
cal diff is tensor(16.9770, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3528.0952, device='cuda:3')
test acc is  0.4363166668230082
test loss is 3.052558005110287
test entropy is  0.3256940922058467
________________________________
diff is  tensor(35.7166, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3190, device='cuda:3', dtype=torch.float64)
diff is  tensor(472.7431, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4343, device='cuda:3', dtype=torch.float64)
diff is  tensor(3000.2761, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6764, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.7530, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.7166, device='cuda:3')
clipping
cal diff is tensor(0.3190, device='cuda:3')
clipping
cal diff is tensor(472.7430, device='cuda:3')
clipping
cal diff is tensor(0.4343, device='cuda:3')
clipping
cal diff is tensor(3000.2761, device='cuda:3')
clipping
cal diff is tensor(1.6764, device='cuda:3')
clipping
cal diff is tensor(16.7530, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3480.9060, device='cuda:3')
test acc is  0.45010000015634166
test loss is 2.8759614628261088
test entropy is  0.33346500732242934
________________________________
diff is  tensor(35.2388, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3147, device='cuda:3', dtype=torch.float64)
diff is  tensor(466.4197, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4285, device='cuda:3', dtype=torch.float64)
diff is  tensor(2960.1447, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6540, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.5289, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.2388, device='cuda:3')
clipping
cal diff is tensor(0.3147, device='cuda:3')
clipping
cal diff is tensor(466.4197, device='cuda:3')
clipping
cal diff is tensor(0.4285, device='cuda:3')
clipping
cal diff is tensor(2960.1448, device='cuda:3')
clipping
cal diff is tensor(1.6540, device='cuda:3')
clipping
cal diff is tensor(16.5289, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3433.7126, device='cuda:3')
test acc is  0.4648333334896751
test loss is 2.7049816343575905
test entropy is  0.3412124011308145
________________________________
diff is  tensor(34.7610, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3105, device='cuda:3', dtype=torch.float64)
diff is  tensor(460.0957, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4227, device='cuda:3', dtype=torch.float64)
diff is  tensor(2920.0096, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6316, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.3048, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.7610, device='cuda:3')
clipping
cal diff is tensor(0.3105, device='cuda:3')
clipping
cal diff is tensor(460.0958, device='cuda:3')
clipping
cal diff is tensor(0.4227, device='cuda:3')
clipping
cal diff is tensor(2920.0095, device='cuda:3')
clipping
cal diff is tensor(1.6316, device='cuda:3')
clipping
cal diff is tensor(16.3048, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
________________________________
test distance is  tensor(3386.5146, device='cuda:3')
test acc is  0.47966666682300857
test loss is 2.5428769285999127
test entropy is  0.3486007630094282
________________________________
diff is  tensor(34.2832, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3062, device='cuda:3', dtype=torch.float64)
diff is  tensor(453.7712, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4168, device='cuda:3', dtype=torch.float64)
diff is  tensor(2879.8708, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6091, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.0807, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.2832, device='cuda:3')
clipping
cal diff is tensor(0.3062, device='cuda:3')
clipping
cal diff is tensor(453.7712, device='cuda:3')
clipping
cal diff is tensor(0.4168, device='cuda:3')
clipping
cal diff is tensor(2879.8708, device='cuda:3')
clipping
cal diff is tensor(1.6091, device='cuda:3')
clipping
cal diff is tensor(16.0807, device='cuda:3')
clipping
cal diff is tensor(0.1768, device='cuda:3')
reach max round
new distance ratio is 0.99
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 97.18% 

Test Accuracy: 97.06% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.11143500357866287
attack res is True
len of model dicts is  10
compute distance is  tensor(18.9484, device='cuda:3')
compute distance is  tensor(46.0911, device='cuda:3')
compute distance is  tensor(56.9809, device='cuda:3')
compute distance is  tensor(30.6352, device='cuda:3')
compute distance is  tensor(27.1510, device='cuda:3')
compute distance is  tensor(36.5887, device='cuda:3')
compute distance is  tensor(114.3627, device='cuda:3')
compute distance is  tensor(35.2755, device='cuda:3')
compute distance is  tensor(72.1812, device='cuda:3')
compute distance is  tensor(56.3173, device='cuda:3')
calculated distance threshold is  tensor(122.8546, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.14693333348966622
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4456833334896749
====================
====================
iteration is  0
round is  2
accuracy is  0.23773333348967116
====================
====================
iteration is  1
round is  0
accuracy is  0.451433333489675
====================
====================
iteration is  1
round is  1
accuracy is  0.45290000015634163
====================
________________________________
test distance is  tensor(4284.0562, device='cuda:3')
test acc is  0.14693333348966622
test loss is 8.815058191702056
test entropy is  0.11129652459357085
________________________________
diff is  tensor(43.9839, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3850, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.4999, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5362, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.0559, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0340, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3441, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.9839, device='cuda:3')
clipping
cal diff is tensor(0.3850, device='cuda:3')
clipping
cal diff is tensor(574.4999, device='cuda:3')
clipping
cal diff is tensor(0.5362, device='cuda:3')
clipping
cal diff is tensor(3642.0557, device='cuda:3')
clipping
cal diff is tensor(2.0340, device='cuda:3')
clipping
cal diff is tensor(20.3441, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(4222.1851, device='cuda:3')
test acc is  0.15636666682300035
test loss is 8.239524612548763
test entropy is  0.12457526717056978
________________________________
diff is  tensor(43.3486, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3794, device='cuda:3', dtype=torch.float64)
diff is  tensor(566.2025, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5285, device='cuda:3', dtype=torch.float64)
diff is  tensor(3589.4544, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0046, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.0503, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.3486, device='cuda:3')
clipping
cal diff is tensor(0.3794, device='cuda:3')
clipping
cal diff is tensor(566.2025, device='cuda:3')
clipping
cal diff is tensor(0.5285, device='cuda:3')
clipping
cal diff is tensor(3589.4543, device='cuda:3')
clipping
cal diff is tensor(2.0046, device='cuda:3')
clipping
cal diff is tensor(20.0503, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(4160.3071, device='cuda:3')
test acc is  0.16688333348966777
test loss is 7.690901532610342
test entropy is  0.138892856218032
________________________________
diff is  tensor(42.7133, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3738, device='cuda:3', dtype=torch.float64)
diff is  tensor(557.9042, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5207, device='cuda:3', dtype=torch.float64)
diff is  tensor(3536.8471, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9752, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.7565, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.7133, device='cuda:3')
clipping
cal diff is tensor(0.3738, device='cuda:3')
clipping
cal diff is tensor(557.9042, device='cuda:3')
clipping
cal diff is tensor(0.5207, device='cuda:3')
clipping
cal diff is tensor(3536.8472, device='cuda:3')
clipping
cal diff is tensor(1.9752, device='cuda:3')
clipping
cal diff is tensor(19.7565, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(4098.4229, device='cuda:3')
test acc is  0.17866666682300192
test loss is 7.1571952468042435
test entropy is  0.15470902236508155
________________________________
diff is  tensor(42.0779, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3683, device='cuda:3', dtype=torch.float64)
diff is  tensor(549.6049, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5130, device='cuda:3', dtype=torch.float64)
diff is  tensor(3484.2338, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9458, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4626, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0779, device='cuda:3')
clipping
cal diff is tensor(0.3683, device='cuda:3')
clipping
cal diff is tensor(549.6049, device='cuda:3')
clipping
cal diff is tensor(0.5130, device='cuda:3')
clipping
cal diff is tensor(3484.2339, device='cuda:3')
clipping
cal diff is tensor(1.9458, device='cuda:3')
clipping
cal diff is tensor(19.4626, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(4036.5317, device='cuda:3')
test acc is  0.19118333348966926
test loss is 6.6520754304776055
test entropy is  0.17148075701553683
________________________________
diff is  tensor(41.4425, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3627, device='cuda:3', dtype=torch.float64)
diff is  tensor(541.3048, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5053, device='cuda:3', dtype=torch.float64)
diff is  tensor(3431.6146, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9164, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.1686, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.4425, device='cuda:3')
clipping
cal diff is tensor(0.3627, device='cuda:3')
clipping
cal diff is tensor(541.3048, device='cuda:3')
clipping
cal diff is tensor(0.5053, device='cuda:3')
clipping
cal diff is tensor(3431.6147, device='cuda:3')
clipping
cal diff is tensor(1.9164, device='cuda:3')
clipping
cal diff is tensor(19.1686, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3974.6333, device='cuda:3')
test acc is  0.20591666682300327
test loss is 6.169093810164852
test entropy is  0.18918669795684978
________________________________
diff is  tensor(40.8069, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3572, device='cuda:3', dtype=torch.float64)
diff is  tensor(533.0037, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4975, device='cuda:3', dtype=torch.float64)
diff is  tensor(3378.9895, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8871, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.8747, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.8069, device='cuda:3')
clipping
cal diff is tensor(0.3572, device='cuda:3')
clipping
cal diff is tensor(533.0037, device='cuda:3')
clipping
cal diff is tensor(0.4975, device='cuda:3')
clipping
cal diff is tensor(3378.9893, device='cuda:3')
clipping
cal diff is tensor(1.8871, device='cuda:3')
clipping
cal diff is tensor(18.8747, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3912.7273, device='cuda:3')
test acc is  0.22251666682300394
test loss is 5.710711235430703
test entropy is  0.207524397789733
________________________________
diff is  tensor(40.1713, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3516, device='cuda:3', dtype=torch.float64)
diff is  tensor(524.7015, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4898, device='cuda:3', dtype=torch.float64)
diff is  tensor(3326.3580, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8577, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5807, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.1713, device='cuda:3')
clipping
cal diff is tensor(0.3516, device='cuda:3')
clipping
cal diff is tensor(524.7015, device='cuda:3')
clipping
cal diff is tensor(0.4898, device='cuda:3')
clipping
cal diff is tensor(3326.3579, device='cuda:3')
clipping
cal diff is tensor(1.8577, device='cuda:3')
clipping
cal diff is tensor(18.5807, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3850.8135, device='cuda:3')
test acc is  0.2407166668230046
test loss is 5.274171652824386
test entropy is  0.2263154139492049
________________________________
diff is  tensor(39.5356, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3460, device='cuda:3', dtype=torch.float64)
diff is  tensor(516.3984, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4820, device='cuda:3', dtype=torch.float64)
diff is  tensor(3273.7199, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8283, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2867, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.5356, device='cuda:3')
clipping
cal diff is tensor(0.3460, device='cuda:3')
clipping
cal diff is tensor(516.3984, device='cuda:3')
clipping
cal diff is tensor(0.4820, device='cuda:3')
clipping
cal diff is tensor(3273.7197, device='cuda:3')
clipping
cal diff is tensor(1.8283, device='cuda:3')
clipping
cal diff is tensor(18.2867, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3788.8918, device='cuda:3')
test acc is  0.2613500001563386
test loss is 4.864186641249829
test entropy is  0.24513453701094015
________________________________
diff is  tensor(38.8998, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3405, device='cuda:3', dtype=torch.float64)
diff is  tensor(508.0941, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4743, device='cuda:3', dtype=torch.float64)
diff is  tensor(3221.0750, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7989, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.9926, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.8998, device='cuda:3')
clipping
cal diff is tensor(0.3405, device='cuda:3')
clipping
cal diff is tensor(508.0941, device='cuda:3')
clipping
cal diff is tensor(0.4743, device='cuda:3')
clipping
cal diff is tensor(3221.0752, device='cuda:3')
clipping
cal diff is tensor(1.7989, device='cuda:3')
clipping
cal diff is tensor(17.9926, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3726.9619, device='cuda:3')
test acc is  0.2818333334896724
test loss is 4.473956776580322
test entropy is  0.26403978851431215
________________________________
diff is  tensor(38.2640, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3349, device='cuda:3', dtype=torch.float64)
diff is  tensor(499.7888, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4665, device='cuda:3', dtype=torch.float64)
diff is  tensor(3168.4232, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7695, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6985, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.2640, device='cuda:3')
clipping
cal diff is tensor(0.3349, device='cuda:3')
clipping
cal diff is tensor(499.7888, device='cuda:3')
clipping
cal diff is tensor(0.4665, device='cuda:3')
clipping
cal diff is tensor(3168.4233, device='cuda:3')
clipping
cal diff is tensor(1.7695, device='cuda:3')
clipping
cal diff is tensor(17.6985, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3665.0234, device='cuda:3')
test acc is  0.3056500001563396
test loss is 4.108024689434433
test entropy is  0.2825581298263342
________________________________
diff is  tensor(37.6280, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3293, device='cuda:3', dtype=torch.float64)
diff is  tensor(491.4823, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4587, device='cuda:3', dtype=torch.float64)
diff is  tensor(3115.7641, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7401, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.4043, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.6280, device='cuda:3')
clipping
cal diff is tensor(0.3293, device='cuda:3')
clipping
cal diff is tensor(491.4823, device='cuda:3')
clipping
cal diff is tensor(0.4587, device='cuda:3')
clipping
cal diff is tensor(3115.7642, device='cuda:3')
clipping
cal diff is tensor(1.7401, device='cuda:3')
clipping
cal diff is tensor(17.4043, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3603.0762, device='cuda:3')
test acc is  0.3288166668230067
test loss is 3.765035681378867
test entropy is  0.30059862907316637
________________________________
diff is  tensor(36.9920, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3238, device='cuda:3', dtype=torch.float64)
diff is  tensor(483.1747, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4510, device='cuda:3', dtype=torch.float64)
diff is  tensor(3063.0975, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7106, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.1101, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.9920, device='cuda:3')
clipping
cal diff is tensor(0.3238, device='cuda:3')
clipping
cal diff is tensor(483.1747, device='cuda:3')
clipping
cal diff is tensor(0.4510, device='cuda:3')
clipping
cal diff is tensor(3063.0974, device='cuda:3')
clipping
cal diff is tensor(1.7106, device='cuda:3')
clipping
cal diff is tensor(17.1101, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3541.1201, device='cuda:3')
test acc is  0.35180000015634044
test loss is 3.4438291910106438
test entropy is  0.31803918814163473
________________________________
diff is  tensor(36.3559, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3182, device='cuda:3', dtype=torch.float64)
diff is  tensor(474.8658, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4432, device='cuda:3', dtype=torch.float64)
diff is  tensor(3010.4231, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6812, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.8159, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.3559, device='cuda:3')
clipping
cal diff is tensor(0.3182, device='cuda:3')
clipping
cal diff is tensor(474.8658, device='cuda:3')
clipping
cal diff is tensor(0.4432, device='cuda:3')
clipping
cal diff is tensor(3010.4231, device='cuda:3')
clipping
cal diff is tensor(1.6812, device='cuda:3')
clipping
cal diff is tensor(16.8159, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3479.1545, device='cuda:3')
test acc is  0.37758333348967416
test loss is 3.1451265848775916
test entropy is  0.33469623462287096
________________________________
diff is  tensor(35.7196, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3126, device='cuda:3', dtype=torch.float64)
diff is  tensor(466.5557, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4355, device='cuda:3', dtype=torch.float64)
diff is  tensor(2957.7409, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6518, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.5216, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.7196, device='cuda:3')
clipping
cal diff is tensor(0.3126, device='cuda:3')
clipping
cal diff is tensor(466.5557, device='cuda:3')
clipping
cal diff is tensor(0.4355, device='cuda:3')
clipping
cal diff is tensor(2957.7410, device='cuda:3')
clipping
cal diff is tensor(1.6518, device='cuda:3')
clipping
cal diff is tensor(16.5216, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3417.1787, device='cuda:3')
test acc is  0.40378333348967443
test loss is 2.8659157725031186
test entropy is  0.35048735793084224
________________________________
diff is  tensor(35.0833, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3071, device='cuda:3', dtype=torch.float64)
diff is  tensor(458.2442, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4277, device='cuda:3', dtype=torch.float64)
diff is  tensor(2905.0503, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6224, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.2273, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.0833, device='cuda:3')
clipping
cal diff is tensor(0.3071, device='cuda:3')
clipping
cal diff is tensor(458.2442, device='cuda:3')
clipping
cal diff is tensor(0.4277, device='cuda:3')
clipping
cal diff is tensor(2905.0503, device='cuda:3')
clipping
cal diff is tensor(1.6224, device='cuda:3')
clipping
cal diff is tensor(16.2273, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3355.1934, device='cuda:3')
test acc is  0.4292166668230081
test loss is 2.608216020344163
test entropy is  0.3649725183082034
________________________________
diff is  tensor(34.4469, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3015, device='cuda:3', dtype=torch.float64)
diff is  tensor(449.9314, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4200, device='cuda:3', dtype=torch.float64)
diff is  tensor(2852.3510, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5929, device='cuda:3', dtype=torch.float64)
diff is  tensor(15.9329, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.4469, device='cuda:3')
clipping
cal diff is tensor(0.3015, device='cuda:3')
clipping
cal diff is tensor(449.9314, device='cuda:3')
clipping
cal diff is tensor(0.4200, device='cuda:3')
clipping
cal diff is tensor(2852.3508, device='cuda:3')
clipping
cal diff is tensor(1.5929, device='cuda:3')
clipping
cal diff is tensor(15.9329, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3293.1973, device='cuda:3')
test acc is  0.45538333348967497
test loss is 2.36938123929221
test entropy is  0.37808732049805777
________________________________
diff is  tensor(33.8104, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2959, device='cuda:3', dtype=torch.float64)
diff is  tensor(441.6172, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4122, device='cuda:3', dtype=torch.float64)
diff is  tensor(2799.6429, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5635, device='cuda:3', dtype=torch.float64)
diff is  tensor(15.6385, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(33.8104, device='cuda:3')
clipping
cal diff is tensor(0.2959, device='cuda:3')
clipping
cal diff is tensor(441.6172, device='cuda:3')
clipping
cal diff is tensor(0.4122, device='cuda:3')
clipping
cal diff is tensor(2799.6431, device='cuda:3')
clipping
cal diff is tensor(1.5635, device='cuda:3')
clipping
cal diff is tensor(15.6385, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3231.1902, device='cuda:3')
test acc is  0.48215000015634196
test loss is 2.1486671964751123
test entropy is  0.3897719456792386
________________________________
diff is  tensor(33.1737, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2904, device='cuda:3', dtype=torch.float64)
diff is  tensor(433.3015, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4044, device='cuda:3', dtype=torch.float64)
diff is  tensor(2746.9255, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5341, device='cuda:3', dtype=torch.float64)
diff is  tensor(15.3440, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(33.1737, device='cuda:3')
clipping
cal diff is tensor(0.2904, device='cuda:3')
clipping
cal diff is tensor(433.3015, device='cuda:3')
clipping
cal diff is tensor(0.4044, device='cuda:3')
clipping
cal diff is tensor(2746.9255, device='cuda:3')
clipping
cal diff is tensor(1.5341, device='cuda:3')
clipping
cal diff is tensor(15.3440, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3169.1716, device='cuda:3')
test acc is  0.5084000001563421
test loss is 1.9468011374412568
test entropy is  0.39977037590513353
________________________________
diff is  tensor(32.5369, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2848, device='cuda:3', dtype=torch.float64)
diff is  tensor(424.9843, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3967, device='cuda:3', dtype=torch.float64)
diff is  tensor(2694.1984, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5046, device='cuda:3', dtype=torch.float64)
diff is  tensor(15.0495, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(32.5369, device='cuda:3')
clipping
cal diff is tensor(0.2848, device='cuda:3')
clipping
cal diff is tensor(424.9843, device='cuda:3')
clipping
cal diff is tensor(0.3967, device='cuda:3')
clipping
cal diff is tensor(2694.1982, device='cuda:3')
clipping
cal diff is tensor(1.5046, device='cuda:3')
clipping
cal diff is tensor(15.0495, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
________________________________
test distance is  tensor(3107.1414, device='cuda:3')
test acc is  0.5356333334896757
test loss is 1.7605504654109605
test entropy is  0.4083286606903269
________________________________
diff is  tensor(31.9000, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2792, device='cuda:3', dtype=torch.float64)
diff is  tensor(416.6655, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3889, device='cuda:3', dtype=torch.float64)
diff is  tensor(2641.4612, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.4752, device='cuda:3', dtype=torch.float64)
diff is  tensor(14.7549, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
cal diff is tensor(31.9000, device='cuda:3')
clipping
cal diff is tensor(0.2792, device='cuda:3')
clipping
cal diff is tensor(416.6656, device='cuda:3')
clipping
cal diff is tensor(0.3889, device='cuda:3')
clipping
cal diff is tensor(2641.4612, device='cuda:3')
clipping
cal diff is tensor(1.4752, device='cuda:3')
clipping
cal diff is tensor(14.7549, device='cuda:3')
clipping
cal diff is tensor(0.2166, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 97.12% 

Test Accuracy: 97.02% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.1356411725282669
attack res is True
len of model dicts is  10
compute distance is  tensor(29.4318, device='cuda:3')
compute distance is  tensor(34.2658, device='cuda:3')
compute distance is  tensor(53.6052, device='cuda:3')
compute distance is  tensor(34.9292, device='cuda:3')
compute distance is  tensor(33.2508, device='cuda:3')
compute distance is  tensor(30.9722, device='cuda:3')
compute distance is  tensor(90.3653, device='cuda:3')
compute distance is  tensor(36.9017, device='cuda:3')
compute distance is  tensor(67.0701, device='cuda:3')
compute distance is  tensor(72.1655, device='cuda:3')
calculated distance threshold is  tensor(95.7884, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.2950666668230061
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3504500001563404
====================
====================
iteration is  0
round is  2
accuracy is  0.548500000156342
====================
====================
iteration is  1
round is  0
accuracy is  0.29148333348967265
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4075000001563412
====================
________________________________
test distance is  tensor(4283.6494, device='cuda:3')
test acc is  0.29148333348967265
test loss is 5.256853702225919
test entropy is  0.33207665895348165
________________________________
diff is  tensor(44.3641, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3594, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.9882, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4893, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.8291, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0394, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3790, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2005, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2005, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.3641, device='cuda:3')
clipping
cal diff is tensor(0.3594, device='cuda:3')
clipping
cal diff is tensor(573.9882, device='cuda:3')
clipping
cal diff is tensor(0.4893, device='cuda:3')
clipping
cal diff is tensor(3641.8291, device='cuda:3')
clipping
cal diff is tensor(2.0394, device='cuda:3')
clipping
cal diff is tensor(20.3790, device='cuda:3')
clipping
cal diff is tensor(0.2005, device='cuda:3')
clipping
________________________________
test distance is  tensor(4235.4844, device='cuda:3')
test acc is  0.30250000015633954
test loss is 4.968047760951239
test entropy is  0.3439679852267827
________________________________
diff is  tensor(43.8653, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3554, device='cuda:3', dtype=torch.float64)
diff is  tensor(567.5344, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4838, device='cuda:3', dtype=torch.float64)
diff is  tensor(3600.8807, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0165, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1498, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.8653, device='cuda:3')
clipping
cal diff is tensor(0.3554, device='cuda:3')
clipping
cal diff is tensor(567.5344, device='cuda:3')
clipping
cal diff is tensor(0.4838, device='cuda:3')
clipping
cal diff is tensor(3600.8809, device='cuda:3')
clipping
cal diff is tensor(2.0165, device='cuda:3')
clipping
cal diff is tensor(20.1498, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(4187.3188, device='cuda:3')
test acc is  0.31401666682300644
test loss is 4.689660530100499
test entropy is  0.35585605508006457
________________________________
diff is  tensor(43.3664, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3514, device='cuda:3', dtype=torch.float64)
diff is  tensor(561.0801, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4783, device='cuda:3', dtype=torch.float64)
diff is  tensor(3559.9297, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9936, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.9207, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.3664, device='cuda:3')
clipping
cal diff is tensor(0.3514, device='cuda:3')
clipping
cal diff is tensor(561.0801, device='cuda:3')
clipping
cal diff is tensor(0.4783, device='cuda:3')
clipping
cal diff is tensor(3559.9297, device='cuda:3')
clipping
cal diff is tensor(1.9936, device='cuda:3')
clipping
cal diff is tensor(19.9207, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(4139.1494, device='cuda:3')
test acc is  0.32738333348967336
test loss is 4.422421700918853
test entropy is  0.36748909478439196
________________________________
diff is  tensor(42.8675, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3473, device='cuda:3', dtype=torch.float64)
diff is  tensor(554.6254, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4728, device='cuda:3', dtype=torch.float64)
diff is  tensor(3518.9762, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9706, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6915, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.8675, device='cuda:3')
clipping
cal diff is tensor(0.3473, device='cuda:3')
clipping
cal diff is tensor(554.6254, device='cuda:3')
clipping
cal diff is tensor(0.4728, device='cuda:3')
clipping
cal diff is tensor(3518.9761, device='cuda:3')
clipping
cal diff is tensor(1.9706, device='cuda:3')
clipping
cal diff is tensor(19.6915, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(4090.9775, device='cuda:3')
test acc is  0.34078333348967355
test loss is 4.163435884884426
test entropy is  0.37902846149226493
________________________________
diff is  tensor(42.3686, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3433, device='cuda:3', dtype=torch.float64)
diff is  tensor(548.1702, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4673, device='cuda:3', dtype=torch.float64)
diff is  tensor(3478.0196, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9477, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4623, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.3686, device='cuda:3')
clipping
cal diff is tensor(0.3433, device='cuda:3')
clipping
cal diff is tensor(548.1703, device='cuda:3')
clipping
cal diff is tensor(0.4673, device='cuda:3')
clipping
cal diff is tensor(3478.0195, device='cuda:3')
clipping
cal diff is tensor(1.9477, device='cuda:3')
clipping
cal diff is tensor(19.4623, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(4042.8020, device='cuda:3')
test acc is  0.35540000015634043
test loss is 3.9156811696125753
test entropy is  0.3901846133061309
________________________________
diff is  tensor(41.8696, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3392, device='cuda:3', dtype=torch.float64)
diff is  tensor(541.7147, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4618, device='cuda:3', dtype=torch.float64)
diff is  tensor(3437.0604, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9248, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2331, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.8696, device='cuda:3')
clipping
cal diff is tensor(0.3392, device='cuda:3')
clipping
cal diff is tensor(541.7147, device='cuda:3')
clipping
cal diff is tensor(0.4618, device='cuda:3')
clipping
cal diff is tensor(3437.0605, device='cuda:3')
clipping
cal diff is tensor(1.9248, device='cuda:3')
clipping
cal diff is tensor(19.2331, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3994.6230, device='cuda:3')
test acc is  0.37086666682300734
test loss is 3.6785999669957516
test entropy is  0.4007339074508722
________________________________
diff is  tensor(41.3706, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3352, device='cuda:3', dtype=torch.float64)
diff is  tensor(535.2586, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4563, device='cuda:3', dtype=torch.float64)
diff is  tensor(3396.0983, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9018, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0039, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.3706, device='cuda:3')
clipping
cal diff is tensor(0.3352, device='cuda:3')
clipping
cal diff is tensor(535.2586, device='cuda:3')
clipping
cal diff is tensor(0.4563, device='cuda:3')
clipping
cal diff is tensor(3396.0981, device='cuda:3')
clipping
cal diff is tensor(1.9018, device='cuda:3')
clipping
cal diff is tensor(19.0039, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3946.4407, device='cuda:3')
test acc is  0.38726666682300753
test loss is 3.450786332840096
test entropy is  0.4107169972649261
________________________________
diff is  tensor(40.8716, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3311, device='cuda:3', dtype=torch.float64)
diff is  tensor(528.8021, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4508, device='cuda:3', dtype=torch.float64)
diff is  tensor(3355.1331, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8789, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7747, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.8716, device='cuda:3')
clipping
cal diff is tensor(0.3311, device='cuda:3')
clipping
cal diff is tensor(528.8021, device='cuda:3')
clipping
cal diff is tensor(0.4508, device='cuda:3')
clipping
cal diff is tensor(3355.1333, device='cuda:3')
clipping
cal diff is tensor(1.8789, device='cuda:3')
clipping
cal diff is tensor(18.7747, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3898.2549, device='cuda:3')
test acc is  0.40498333348967447
test loss is 3.2338175197908363
test entropy is  0.41985813610907047
________________________________
diff is  tensor(40.3725, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3271, device='cuda:3', dtype=torch.float64)
diff is  tensor(522.3451, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4453, device='cuda:3', dtype=torch.float64)
diff is  tensor(3314.1650, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8559, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5454, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.3726, device='cuda:3')
clipping
cal diff is tensor(0.3271, device='cuda:3')
clipping
cal diff is tensor(522.3452, device='cuda:3')
clipping
cal diff is tensor(0.4453, device='cuda:3')
clipping
cal diff is tensor(3314.1650, device='cuda:3')
clipping
cal diff is tensor(1.8559, device='cuda:3')
clipping
cal diff is tensor(18.5454, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3850.0652, device='cuda:3')
test acc is  0.42318333348967463
test loss is 3.0268058958592445
test entropy is  0.4282242095133643
________________________________
diff is  tensor(39.8734, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3231, device='cuda:3', dtype=torch.float64)
diff is  tensor(515.8877, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4398, device='cuda:3', dtype=torch.float64)
diff is  tensor(3273.1938, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8330, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.3162, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.8734, device='cuda:3')
clipping
cal diff is tensor(0.3231, device='cuda:3')
clipping
cal diff is tensor(515.8877, device='cuda:3')
clipping
cal diff is tensor(0.4398, device='cuda:3')
clipping
cal diff is tensor(3273.1938, device='cuda:3')
clipping
cal diff is tensor(1.8330, device='cuda:3')
clipping
cal diff is tensor(18.3162, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3801.8718, device='cuda:3')
test acc is  0.4415833334896748
test loss is 2.830543080372597
test entropy is  0.4356529457705107
________________________________
diff is  tensor(39.3743, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3190, device='cuda:3', dtype=torch.float64)
diff is  tensor(509.4297, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4343, device='cuda:3', dtype=torch.float64)
diff is  tensor(3232.2194, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8101, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.0869, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.3743, device='cuda:3')
clipping
cal diff is tensor(0.3190, device='cuda:3')
clipping
cal diff is tensor(509.4297, device='cuda:3')
clipping
cal diff is tensor(0.4343, device='cuda:3')
clipping
cal diff is tensor(3232.2195, device='cuda:3')
clipping
cal diff is tensor(1.8101, device='cuda:3')
clipping
cal diff is tensor(18.0869, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3753.6748, device='cuda:3')
test acc is  0.45956666682300834
test loss is 2.6448862754714004
test entropy is  0.4421956415877922
________________________________
diff is  tensor(38.8751, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3150, device='cuda:3', dtype=torch.float64)
diff is  tensor(502.9712, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4288, device='cuda:3', dtype=torch.float64)
diff is  tensor(3191.2416, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7871, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8576, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.8751, device='cuda:3')
clipping
cal diff is tensor(0.3150, device='cuda:3')
clipping
cal diff is tensor(502.9712, device='cuda:3')
clipping
cal diff is tensor(0.4288, device='cuda:3')
clipping
cal diff is tensor(3191.2417, device='cuda:3')
clipping
cal diff is tensor(1.7871, device='cuda:3')
clipping
cal diff is tensor(17.8576, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3705.4736, device='cuda:3')
test acc is  0.4793166668230085
test loss is 2.4686695796721527
test entropy is  0.4477139266569223
________________________________
diff is  tensor(38.3759, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3109, device='cuda:3', dtype=torch.float64)
diff is  tensor(496.5122, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4233, device='cuda:3', dtype=torch.float64)
diff is  tensor(3150.2606, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7642, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6282, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.3759, device='cuda:3')
clipping
cal diff is tensor(0.3109, device='cuda:3')
clipping
cal diff is tensor(496.5122, device='cuda:3')
clipping
cal diff is tensor(0.4233, device='cuda:3')
clipping
cal diff is tensor(3150.2607, device='cuda:3')
clipping
cal diff is tensor(1.7642, device='cuda:3')
clipping
cal diff is tensor(17.6282, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3657.2686, device='cuda:3')
test acc is  0.49883333348967535
test loss is 2.3028408822728625
test entropy is  0.4522602991508777
________________________________
diff is  tensor(37.8766, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3069, device='cuda:3', dtype=torch.float64)
diff is  tensor(490.0526, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4178, device='cuda:3', dtype=torch.float64)
diff is  tensor(3109.2762, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7412, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3989, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.8766, device='cuda:3')
clipping
cal diff is tensor(0.3069, device='cuda:3')
clipping
cal diff is tensor(490.0526, device='cuda:3')
clipping
cal diff is tensor(0.4178, device='cuda:3')
clipping
cal diff is tensor(3109.2761, device='cuda:3')
clipping
cal diff is tensor(1.7412, device='cuda:3')
clipping
cal diff is tensor(17.3989, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3609.0591, device='cuda:3')
test acc is  0.5180666668230088
test loss is 2.1466154670918676
test entropy is  0.4556551747548301
________________________________
diff is  tensor(37.3773, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3028, device='cuda:3', dtype=torch.float64)
diff is  tensor(483.5925, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4123, device='cuda:3', dtype=torch.float64)
diff is  tensor(3068.2882, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7183, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.1695, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.3773, device='cuda:3')
clipping
cal diff is tensor(0.3028, device='cuda:3')
clipping
cal diff is tensor(483.5925, device='cuda:3')
clipping
cal diff is tensor(0.4123, device='cuda:3')
clipping
cal diff is tensor(3068.2881, device='cuda:3')
clipping
cal diff is tensor(1.7183, device='cuda:3')
clipping
cal diff is tensor(17.1695, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3560.8455, device='cuda:3')
test acc is  0.5375333334896756
test loss is 1.9994508897317753
test entropy is  0.4581140166978592
________________________________
diff is  tensor(36.8780, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2988, device='cuda:3', dtype=torch.float64)
diff is  tensor(477.1318, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4068, device='cuda:3', dtype=torch.float64)
diff is  tensor(3027.2965, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6953, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.9402, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.8780, device='cuda:3')
clipping
cal diff is tensor(0.2988, device='cuda:3')
clipping
cal diff is tensor(477.1318, device='cuda:3')
clipping
cal diff is tensor(0.4068, device='cuda:3')
clipping
cal diff is tensor(3027.2966, device='cuda:3')
clipping
cal diff is tensor(1.6953, device='cuda:3')
clipping
cal diff is tensor(16.9402, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3512.6272, device='cuda:3')
test acc is  0.5567666668230079
test loss is 1.860747432530816
test entropy is  0.4593855229331486
________________________________
diff is  tensor(36.3786, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2947, device='cuda:3', dtype=torch.float64)
diff is  tensor(470.6705, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4012, device='cuda:3', dtype=torch.float64)
diff is  tensor(2986.3011, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6723, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.7108, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.3786, device='cuda:3')
clipping
cal diff is tensor(0.2947, device='cuda:3')
clipping
cal diff is tensor(470.6705, device='cuda:3')
clipping
cal diff is tensor(0.4012, device='cuda:3')
clipping
cal diff is tensor(2986.3010, device='cuda:3')
clipping
cal diff is tensor(1.6723, device='cuda:3')
clipping
cal diff is tensor(16.7108, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3464.4053, device='cuda:3')
test acc is  0.5774333334896729
test loss is 1.7314261431887206
test entropy is  0.45960476235158915
________________________________
diff is  tensor(35.8791, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2907, device='cuda:3', dtype=torch.float64)
diff is  tensor(464.2086, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3957, device='cuda:3', dtype=torch.float64)
diff is  tensor(2945.3017, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6494, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.4813, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.8791, device='cuda:3')
clipping
cal diff is tensor(0.2907, device='cuda:3')
clipping
cal diff is tensor(464.2086, device='cuda:3')
clipping
cal diff is tensor(0.3957, device='cuda:3')
clipping
cal diff is tensor(2945.3018, device='cuda:3')
clipping
cal diff is tensor(1.6494, device='cuda:3')
clipping
cal diff is tensor(16.4813, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3416.1780, device='cuda:3')
test acc is  0.5977000001563378
test loss is 1.6099706586998408
test entropy is  0.4587760203873425
________________________________
diff is  tensor(35.3796, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2866, device='cuda:3', dtype=torch.float64)
diff is  tensor(457.7461, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3902, device='cuda:3', dtype=torch.float64)
diff is  tensor(2904.2987, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6264, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.2519, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.3796, device='cuda:3')
clipping
cal diff is tensor(0.2866, device='cuda:3')
clipping
cal diff is tensor(457.7462, device='cuda:3')
clipping
cal diff is tensor(0.3902, device='cuda:3')
clipping
cal diff is tensor(2904.2988, device='cuda:3')
clipping
cal diff is tensor(1.6264, device='cuda:3')
clipping
cal diff is tensor(16.2519, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
________________________________
test distance is  tensor(3367.9463, device='cuda:3')
test acc is  0.6176833334896698
test loss is 1.4972831381282319
test entropy is  0.4568200420214932
________________________________
diff is  tensor(34.8801, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2826, device='cuda:3', dtype=torch.float64)
diff is  tensor(451.2830, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3847, device='cuda:3', dtype=torch.float64)
diff is  tensor(2863.2915, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6035, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.0224, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1983, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.8801, device='cuda:3')
clipping
cal diff is tensor(0.2826, device='cuda:3')
clipping
cal diff is tensor(451.2830, device='cuda:3')
clipping
cal diff is tensor(0.3847, device='cuda:3')
clipping
cal diff is tensor(2863.2915, device='cuda:3')
clipping
cal diff is tensor(1.6035, device='cuda:3')
clipping
cal diff is tensor(16.0224, device='cuda:3')
clipping
cal diff is tensor(0.1983, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 97.24% 

Test Accuracy: 97.01% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.14518453180789948
attack res is True
len of model dicts is  10
compute distance is  tensor(21.2116, device='cuda:3')
compute distance is  tensor(33.1971, device='cuda:3')
compute distance is  tensor(51.6559, device='cuda:3')
compute distance is  tensor(34.6752, device='cuda:3')
compute distance is  tensor(35.8463, device='cuda:3')
compute distance is  tensor(47.1936, device='cuda:3')
compute distance is  tensor(59.1138, device='cuda:3')
compute distance is  tensor(39.5540, device='cuda:3')
compute distance is  tensor(45.6377, device='cuda:3')
compute distance is  tensor(83.1745, device='cuda:3')
calculated distance threshold is  tensor(88.6892, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.4024333334896744
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2880666668230059
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.35348333348967376
====================
====================
iteration is  1
round is  0
accuracy is  0.4047000001563411
====================
====================
iteration is  1
round is  1
accuracy is  0.3013833334896729
====================
________________________________
test distance is  tensor(4283.1128, device='cuda:3')
test acc is  0.2880666668230059
test loss is 6.969201968931186
test entropy is  0.2043270113895824
________________________________
diff is  tensor(43.8952, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3543, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.0347, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5404, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.7530, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0597, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3048, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1707, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1707, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.8952, device='cuda:3')
clipping
cal diff is tensor(0.3543, device='cuda:3')
clipping
cal diff is tensor(574.0347, device='cuda:3')
clipping
cal diff is tensor(0.5404, device='cuda:3')
clipping
cal diff is tensor(3641.7532, device='cuda:3')
clipping
cal diff is tensor(2.0597, device='cuda:3')
clipping
cal diff is tensor(20.3048, device='cuda:3')
clipping
cal diff is tensor(0.1707, device='cuda:3')
clipping
________________________________
test distance is  tensor(4238.5361, device='cuda:3')
test acc is  0.2956333334896727
test loss is 6.646666242623889
test entropy is  0.21044871670160212
________________________________
diff is  tensor(43.4384, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3506, device='cuda:3', dtype=torch.float64)
diff is  tensor(568.0604, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5348, device='cuda:3', dtype=torch.float64)
diff is  tensor(3603.8515, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0383, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.0935, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1690, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1690, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.4384, device='cuda:3')
clipping
cal diff is tensor(0.3506, device='cuda:3')
clipping
cal diff is tensor(568.0604, device='cuda:3')
clipping
cal diff is tensor(0.5348, device='cuda:3')
clipping
cal diff is tensor(3603.8516, device='cuda:3')
clipping
cal diff is tensor(2.0383, device='cuda:3')
clipping
cal diff is tensor(20.0935, device='cuda:3')
clipping
cal diff is tensor(0.1690, device='cuda:3')
clipping
________________________________
test distance is  tensor(4193.9570, device='cuda:3')
test acc is  0.30318333348967286
test loss is 6.336935129246986
test entropy is  0.21663379205315353
________________________________
diff is  tensor(42.9815, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3469, device='cuda:3', dtype=torch.float64)
diff is  tensor(562.0858, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5292, device='cuda:3', dtype=torch.float64)
diff is  tensor(3565.9478, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0168, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8822, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1672, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1672, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.9815, device='cuda:3')
clipping
cal diff is tensor(0.3469, device='cuda:3')
clipping
cal diff is tensor(562.0858, device='cuda:3')
clipping
cal diff is tensor(0.5292, device='cuda:3')
clipping
cal diff is tensor(3565.9478, device='cuda:3')
clipping
cal diff is tensor(2.0168, device='cuda:3')
clipping
cal diff is tensor(19.8822, device='cuda:3')
clipping
cal diff is tensor(0.1672, device='cuda:3')
clipping
________________________________
test distance is  tensor(4149.3765, device='cuda:3')
test acc is  0.311333333489673
test loss is 6.032968186112101
test entropy is  0.2230950191632898
________________________________
diff is  tensor(42.5246, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3432, device='cuda:3', dtype=torch.float64)
diff is  tensor(556.1109, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5235, device='cuda:3', dtype=torch.float64)
diff is  tensor(3528.0419, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9954, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6708, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1654, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1654, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.5246, device='cuda:3')
clipping
cal diff is tensor(0.3432, device='cuda:3')
clipping
cal diff is tensor(556.1109, device='cuda:3')
clipping
cal diff is tensor(0.5235, device='cuda:3')
clipping
cal diff is tensor(3528.0420, device='cuda:3')
clipping
cal diff is tensor(1.9954, device='cuda:3')
clipping
cal diff is tensor(19.6708, device='cuda:3')
clipping
cal diff is tensor(0.1654, device='cuda:3')
clipping
________________________________
test distance is  tensor(4104.7920, device='cuda:3')
test acc is  0.32018333348967315
test loss is 5.738741343209484
test entropy is  0.2296146547981798
________________________________
diff is  tensor(42.0677, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3395, device='cuda:3', dtype=torch.float64)
diff is  tensor(550.1356, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5179, device='cuda:3', dtype=torch.float64)
diff is  tensor(3490.1342, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9739, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4595, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0677, device='cuda:3')
clipping
cal diff is tensor(0.3395, device='cuda:3')
clipping
cal diff is tensor(550.1356, device='cuda:3')
clipping
cal diff is tensor(0.5179, device='cuda:3')
clipping
cal diff is tensor(3490.1343, device='cuda:3')
clipping
cal diff is tensor(1.9739, device='cuda:3')
clipping
cal diff is tensor(19.4595, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(4060.2068, device='cuda:3')
test acc is  0.3295333334896733
test loss is 5.454937559709366
test entropy is  0.23625180675689852
________________________________
diff is  tensor(41.6107, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3358, device='cuda:3', dtype=torch.float64)
diff is  tensor(544.1600, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5123, device='cuda:3', dtype=torch.float64)
diff is  tensor(3452.2239, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9525, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2481, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.6107, device='cuda:3')
clipping
cal diff is tensor(0.3358, device='cuda:3')
clipping
cal diff is tensor(544.1599, device='cuda:3')
clipping
cal diff is tensor(0.5123, device='cuda:3')
clipping
cal diff is tensor(3452.2239, device='cuda:3')
clipping
cal diff is tensor(1.9525, device='cuda:3')
clipping
cal diff is tensor(19.2481, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(4015.6191, device='cuda:3')
test acc is  0.3390666668230068
test loss is 5.178349650490767
test entropy is  0.24302096309056923
________________________________
diff is  tensor(41.1538, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3321, device='cuda:3', dtype=torch.float64)
diff is  tensor(538.1840, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5067, device='cuda:3', dtype=torch.float64)
diff is  tensor(3414.3113, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9311, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0367, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.1538, device='cuda:3')
clipping
cal diff is tensor(0.3321, device='cuda:3')
clipping
cal diff is tensor(538.1840, device='cuda:3')
clipping
cal diff is tensor(0.5067, device='cuda:3')
clipping
cal diff is tensor(3414.3113, device='cuda:3')
clipping
cal diff is tensor(1.9311, device='cuda:3')
clipping
cal diff is tensor(19.0367, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3971.0288, device='cuda:3')
test acc is  0.34843333348967365
test loss is 4.910191059620904
test entropy is  0.2499072513680087
________________________________
diff is  tensor(40.6968, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3285, device='cuda:3', dtype=torch.float64)
diff is  tensor(532.2076, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5010, device='cuda:3', dtype=torch.float64)
diff is  tensor(3376.3964, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9096, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.8253, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.6968, device='cuda:3')
clipping
cal diff is tensor(0.3285, device='cuda:3')
clipping
cal diff is tensor(532.2076, device='cuda:3')
clipping
cal diff is tensor(0.5010, device='cuda:3')
clipping
cal diff is tensor(3376.3962, device='cuda:3')
clipping
cal diff is tensor(1.9096, device='cuda:3')
clipping
cal diff is tensor(18.8253, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3926.4358, device='cuda:3')
test acc is  0.3586000001563404
test loss is 4.652335073393799
test entropy is  0.2568102156810923
________________________________
diff is  tensor(40.2397, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3248, device='cuda:3', dtype=torch.float64)
diff is  tensor(526.2309, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4954, device='cuda:3', dtype=torch.float64)
diff is  tensor(3338.4792, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8882, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.6139, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.2397, device='cuda:3')
clipping
cal diff is tensor(0.3248, device='cuda:3')
clipping
cal diff is tensor(526.2308, device='cuda:3')
clipping
cal diff is tensor(0.4954, device='cuda:3')
clipping
cal diff is tensor(3338.4790, device='cuda:3')
clipping
cal diff is tensor(1.8882, device='cuda:3')
clipping
cal diff is tensor(18.6139, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3881.8398, device='cuda:3')
test acc is  0.36973333348967397
test loss is 4.405292330266062
test entropy is  0.2637809949166485
________________________________
diff is  tensor(39.7827, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3211, device='cuda:3', dtype=torch.float64)
diff is  tensor(520.2537, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4898, device='cuda:3', dtype=torch.float64)
diff is  tensor(3300.5596, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8667, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.4025, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.7827, device='cuda:3')
clipping
cal diff is tensor(0.3211, device='cuda:3')
clipping
cal diff is tensor(520.2538, device='cuda:3')
clipping
cal diff is tensor(0.4898, device='cuda:3')
clipping
cal diff is tensor(3300.5596, device='cuda:3')
clipping
cal diff is tensor(1.8667, device='cuda:3')
clipping
cal diff is tensor(18.4025, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3837.2407, device='cuda:3')
test acc is  0.3808333334896741
test loss is 4.166503799495413
test entropy is  0.2707002050936349
________________________________
diff is  tensor(39.3256, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3174, device='cuda:3', dtype=torch.float64)
diff is  tensor(514.2762, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4842, device='cuda:3', dtype=torch.float64)
diff is  tensor(3262.6375, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8453, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.1910, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.3256, device='cuda:3')
clipping
cal diff is tensor(0.3174, device='cuda:3')
clipping
cal diff is tensor(514.2762, device='cuda:3')
clipping
cal diff is tensor(0.4842, device='cuda:3')
clipping
cal diff is tensor(3262.6377, device='cuda:3')
clipping
cal diff is tensor(1.8453, device='cuda:3')
clipping
cal diff is tensor(18.1910, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3792.6387, device='cuda:3')
test acc is  0.3924333334896742
test loss is 3.9332550705623017
test entropy is  0.2776992034746894
________________________________
diff is  tensor(38.8685, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3137, device='cuda:3', dtype=torch.float64)
diff is  tensor(508.2983, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4785, device='cuda:3', dtype=torch.float64)
diff is  tensor(3224.7128, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8238, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.9796, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.8685, device='cuda:3')
clipping
cal diff is tensor(0.3137, device='cuda:3')
clipping
cal diff is tensor(508.2983, device='cuda:3')
clipping
cal diff is tensor(0.4785, device='cuda:3')
clipping
cal diff is tensor(3224.7129, device='cuda:3')
clipping
cal diff is tensor(1.8238, device='cuda:3')
clipping
cal diff is tensor(17.9796, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3748.0337, device='cuda:3')
test acc is  0.40490000015634103
test loss is 3.7111340090155855
test entropy is  0.2844712257639431
________________________________
diff is  tensor(38.4113, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3100, device='cuda:3', dtype=torch.float64)
diff is  tensor(502.3200, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4729, device='cuda:3', dtype=torch.float64)
diff is  tensor(3186.7854, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8024, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.7681, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.4113, device='cuda:3')
clipping
cal diff is tensor(0.3100, device='cuda:3')
clipping
cal diff is tensor(502.3200, device='cuda:3')
clipping
cal diff is tensor(0.4729, device='cuda:3')
clipping
cal diff is tensor(3186.7856, device='cuda:3')
clipping
cal diff is tensor(1.8024, device='cuda:3')
clipping
cal diff is tensor(17.7681, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3703.4258, device='cuda:3')
test acc is  0.4180666668230079
test loss is 3.4976819156329513
test entropy is  0.2910115911698799
________________________________
diff is  tensor(37.9541, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3063, device='cuda:3', dtype=torch.float64)
diff is  tensor(496.3412, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4673, device='cuda:3', dtype=torch.float64)
diff is  tensor(3148.8554, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7809, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.5566, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.9541, device='cuda:3')
clipping
cal diff is tensor(0.3063, device='cuda:3')
clipping
cal diff is tensor(496.3412, device='cuda:3')
clipping
cal diff is tensor(0.4673, device='cuda:3')
clipping
cal diff is tensor(3148.8555, device='cuda:3')
clipping
cal diff is tensor(1.7809, device='cuda:3')
clipping
cal diff is tensor(17.5566, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3658.8142, device='cuda:3')
test acc is  0.430766666823008
test loss is 3.2936261996531537
test entropy is  0.29718003422021866
________________________________
diff is  tensor(37.4969, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3026, device='cuda:3', dtype=torch.float64)
diff is  tensor(490.3621, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4617, device='cuda:3', dtype=torch.float64)
diff is  tensor(3110.9228, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7595, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3451, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.4969, device='cuda:3')
clipping
cal diff is tensor(0.3026, device='cuda:3')
clipping
cal diff is tensor(490.3621, device='cuda:3')
clipping
cal diff is tensor(0.4617, device='cuda:3')
clipping
cal diff is tensor(3110.9229, device='cuda:3')
clipping
cal diff is tensor(1.7595, device='cuda:3')
clipping
cal diff is tensor(17.3451, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3614.1997, device='cuda:3')
test acc is  0.44525000015634153
test loss is 3.097194403600591
test entropy is  0.3030372570509087
________________________________
diff is  tensor(37.0397, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2989, device='cuda:3', dtype=torch.float64)
diff is  tensor(484.3824, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4560, device='cuda:3', dtype=torch.float64)
diff is  tensor(3072.9873, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7380, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.1336, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.0397, device='cuda:3')
clipping
cal diff is tensor(0.2989, device='cuda:3')
clipping
cal diff is tensor(484.3824, device='cuda:3')
clipping
cal diff is tensor(0.4560, device='cuda:3')
clipping
cal diff is tensor(3072.9873, device='cuda:3')
clipping
cal diff is tensor(1.7380, device='cuda:3')
clipping
cal diff is tensor(17.1336, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3569.5815, device='cuda:3')
test acc is  0.459283333489675
test loss is 2.9107538595128415
test entropy is  0.30847041510633316
________________________________
diff is  tensor(36.5824, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2952, device='cuda:3', dtype=torch.float64)
diff is  tensor(478.4024, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4504, device='cuda:3', dtype=torch.float64)
diff is  tensor(3035.0489, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7166, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.9221, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.5824, device='cuda:3')
clipping
cal diff is tensor(0.2952, device='cuda:3')
clipping
cal diff is tensor(478.4024, device='cuda:3')
clipping
cal diff is tensor(0.4504, device='cuda:3')
clipping
cal diff is tensor(3035.0488, device='cuda:3')
clipping
cal diff is tensor(1.7166, device='cuda:3')
clipping
cal diff is tensor(16.9221, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3524.9600, device='cuda:3')
test acc is  0.4731333334896751
test loss is 2.7314001555635987
test entropy is  0.3136028220722162
________________________________
diff is  tensor(36.1251, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2916, device='cuda:3', dtype=torch.float64)
diff is  tensor(472.4218, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4448, device='cuda:3', dtype=torch.float64)
diff is  tensor(2997.1076, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6951, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.7106, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.1251, device='cuda:3')
clipping
cal diff is tensor(0.2916, device='cuda:3')
clipping
cal diff is tensor(472.4218, device='cuda:3')
clipping
cal diff is tensor(0.4448, device='cuda:3')
clipping
cal diff is tensor(2997.1074, device='cuda:3')
clipping
cal diff is tensor(1.6951, device='cuda:3')
clipping
cal diff is tensor(16.7106, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3480.3350, device='cuda:3')
test acc is  0.4870666668230086
test loss is 2.562079485926801
test entropy is  0.3183340670298666
________________________________
diff is  tensor(35.6677, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2879, device='cuda:3', dtype=torch.float64)
diff is  tensor(466.4408, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4391, device='cuda:3', dtype=torch.float64)
diff is  tensor(2959.1632, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6736, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.4990, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.6677, device='cuda:3')
clipping
cal diff is tensor(0.2879, device='cuda:3')
clipping
cal diff is tensor(466.4408, device='cuda:3')
clipping
cal diff is tensor(0.4391, device='cuda:3')
clipping
cal diff is tensor(2959.1631, device='cuda:3')
clipping
cal diff is tensor(1.6736, device='cuda:3')
clipping
cal diff is tensor(16.4990, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
________________________________
test distance is  tensor(3435.7063, device='cuda:3')
test acc is  0.5011166668230087
test loss is 2.3995664183264855
test entropy is  0.3227173092840577
________________________________
diff is  tensor(35.2103, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2842, device='cuda:3', dtype=torch.float64)
diff is  tensor(460.4593, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4335, device='cuda:3', dtype=torch.float64)
diff is  tensor(2921.2158, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6522, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.2874, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1636, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.2103, device='cuda:3')
clipping
cal diff is tensor(0.2842, device='cuda:3')
clipping
cal diff is tensor(460.4593, device='cuda:3')
clipping
cal diff is tensor(0.4335, device='cuda:3')
clipping
cal diff is tensor(2921.2158, device='cuda:3')
clipping
cal diff is tensor(1.6522, device='cuda:3')
clipping
cal diff is tensor(16.2874, device='cuda:3')
clipping
cal diff is tensor(0.1636, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 97.14% 

Test Accuracy: 96.88% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.15928508341312408
attack res is True
len of model dicts is  10
compute distance is  tensor(17.4754, device='cuda:3')
compute distance is  tensor(43.7774, device='cuda:3')
compute distance is  tensor(37.9917, device='cuda:3')
compute distance is  tensor(52.8185, device='cuda:3')
compute distance is  tensor(36.5245, device='cuda:3')
compute distance is  tensor(47.4761, device='cuda:3')
compute distance is  tensor(97.0460, device='cuda:3')
compute distance is  tensor(40.7454, device='cuda:3')
compute distance is  tensor(72.3523, device='cuda:3')
compute distance is  tensor(102.5521, device='cuda:3')
calculated distance threshold is  tensor(110.1239, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.5257500001563422
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.31535000015633985
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.33718333348967355
====================
====================
iteration is  1
round is  0
accuracy is  0.3670166668230074
====================
====================
iteration is  1
round is  1
accuracy is  0.3429333334896736
====================
________________________________
test distance is  tensor(4280.4082, device='cuda:3')
test acc is  0.31535000015633985
test loss is 5.703955974406017
test entropy is  0.3081367506401371
________________________________
diff is  tensor(44.3457, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3458, device='cuda:3', dtype=torch.float64)
diff is  tensor(571.8583, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5557, device='cuda:3', dtype=torch.float64)
diff is  tensor(3640.8941, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0201, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2073, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.3457, device='cuda:3')
clipping
cal diff is tensor(0.3458, device='cuda:3')
clipping
cal diff is tensor(571.8583, device='cuda:3')
clipping
cal diff is tensor(0.5557, device='cuda:3')
clipping
cal diff is tensor(3640.8940, device='cuda:3')
clipping
cal diff is tensor(2.0201, device='cuda:3')
clipping
cal diff is tensor(20.2073, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(4224.9902, device='cuda:3')
test acc is  0.32433333348967336
test loss is 5.3769567910033755
test entropy is  0.3172792233288415
________________________________
diff is  tensor(43.7715, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3413, device='cuda:3', dtype=torch.float64)
diff is  tensor(564.4541, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5485, device='cuda:3', dtype=torch.float64)
diff is  tensor(3593.7534, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9940, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.9457, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.7715, device='cuda:3')
clipping
cal diff is tensor(0.3413, device='cuda:3')
clipping
cal diff is tensor(564.4541, device='cuda:3')
clipping
cal diff is tensor(0.5485, device='cuda:3')
clipping
cal diff is tensor(3593.7534, device='cuda:3')
clipping
cal diff is tensor(1.9940, device='cuda:3')
clipping
cal diff is tensor(19.9457, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(4169.5669, device='cuda:3')
test acc is  0.3345500001563402
test loss is 5.062275249566605
test entropy is  0.3265988241507809
________________________________
diff is  tensor(43.1973, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3368, device='cuda:3', dtype=torch.float64)
diff is  tensor(557.0493, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5413, device='cuda:3', dtype=torch.float64)
diff is  tensor(3546.6090, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9678, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6840, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.1973, device='cuda:3')
clipping
cal diff is tensor(0.3368, device='cuda:3')
clipping
cal diff is tensor(557.0493, device='cuda:3')
clipping
cal diff is tensor(0.5413, device='cuda:3')
clipping
cal diff is tensor(3546.6089, device='cuda:3')
clipping
cal diff is tensor(1.9678, device='cuda:3')
clipping
cal diff is tensor(19.6840, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(4114.1387, device='cuda:3')
test acc is  0.34548333348967364
test loss is 4.758061140839225
test entropy is  0.336196717216389
________________________________
diff is  tensor(42.6231, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3324, device='cuda:3', dtype=torch.float64)
diff is  tensor(549.6439, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5341, device='cuda:3', dtype=torch.float64)
diff is  tensor(3499.4602, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9417, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4223, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.6231, device='cuda:3')
clipping
cal diff is tensor(0.3324, device='cuda:3')
clipping
cal diff is tensor(549.6439, device='cuda:3')
clipping
cal diff is tensor(0.5341, device='cuda:3')
clipping
cal diff is tensor(3499.4604, device='cuda:3')
clipping
cal diff is tensor(1.9417, device='cuda:3')
clipping
cal diff is tensor(19.4223, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(4058.7056, device='cuda:3')
test acc is  0.3578833334896738
test loss is 4.464255418604625
test entropy is  0.34599110096502406
________________________________
diff is  tensor(42.0487, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3279, device='cuda:3', dtype=torch.float64)
diff is  tensor(542.2378, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5269, device='cuda:3', dtype=torch.float64)
diff is  tensor(3452.3070, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9155, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.1606, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0487, device='cuda:3')
clipping
cal diff is tensor(0.3279, device='cuda:3')
clipping
cal diff is tensor(542.2378, device='cuda:3')
clipping
cal diff is tensor(0.5269, device='cuda:3')
clipping
cal diff is tensor(3452.3069, device='cuda:3')
clipping
cal diff is tensor(1.9155, device='cuda:3')
clipping
cal diff is tensor(19.1606, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(4003.2673, device='cuda:3')
test acc is  0.37041666682300733
test loss is 4.182559616784297
test entropy is  0.3559896860486155
________________________________
diff is  tensor(41.4744, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3234, device='cuda:3', dtype=torch.float64)
diff is  tensor(534.8310, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5197, device='cuda:3', dtype=torch.float64)
diff is  tensor(3405.1495, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8893, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.8989, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.4744, device='cuda:3')
clipping
cal diff is tensor(0.3234, device='cuda:3')
clipping
cal diff is tensor(534.8310, device='cuda:3')
clipping
cal diff is tensor(0.5197, device='cuda:3')
clipping
cal diff is tensor(3405.1494, device='cuda:3')
clipping
cal diff is tensor(1.8893, device='cuda:3')
clipping
cal diff is tensor(18.8989, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3947.8237, device='cuda:3')
test acc is  0.3840000001563409
test loss is 3.9104456243230334
test entropy is  0.3660537051493679
________________________________
diff is  tensor(40.8999, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3189, device='cuda:3', dtype=torch.float64)
diff is  tensor(527.4235, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5125, device='cuda:3', dtype=torch.float64)
diff is  tensor(3357.9876, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8632, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.6371, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.8999, device='cuda:3')
clipping
cal diff is tensor(0.3189, device='cuda:3')
clipping
cal diff is tensor(527.4235, device='cuda:3')
clipping
cal diff is tensor(0.5125, device='cuda:3')
clipping
cal diff is tensor(3357.9873, device='cuda:3')
clipping
cal diff is tensor(1.8632, device='cuda:3')
clipping
cal diff is tensor(18.6371, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3892.3748, device='cuda:3')
test acc is  0.39783333348967437
test loss is 3.6506908478767377
test entropy is  0.37605270026906973
________________________________
diff is  tensor(40.3255, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3144, device='cuda:3', dtype=torch.float64)
diff is  tensor(520.0152, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5053, device='cuda:3', dtype=torch.float64)
diff is  tensor(3310.8209, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8370, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.3754, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.3255, device='cuda:3')
clipping
cal diff is tensor(0.3144, device='cuda:3')
clipping
cal diff is tensor(520.0152, device='cuda:3')
clipping
cal diff is tensor(0.5053, device='cuda:3')
clipping
cal diff is tensor(3310.8208, device='cuda:3')
clipping
cal diff is tensor(1.8370, device='cuda:3')
clipping
cal diff is tensor(18.3754, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3836.9202, device='cuda:3')
test acc is  0.4130166668230079
test loss is 3.400396693489953
test entropy is  0.3861170467823299
________________________________
diff is  tensor(39.7509, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3100, device='cuda:3', dtype=torch.float64)
diff is  tensor(512.6062, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4981, device='cuda:3', dtype=torch.float64)
diff is  tensor(3263.6495, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8108, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.1135, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.7509, device='cuda:3')
clipping
cal diff is tensor(0.3100, device='cuda:3')
clipping
cal diff is tensor(512.6062, device='cuda:3')
clipping
cal diff is tensor(0.4981, device='cuda:3')
clipping
cal diff is tensor(3263.6497, device='cuda:3')
clipping
cal diff is tensor(1.8108, device='cuda:3')
clipping
cal diff is tensor(18.1136, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3781.4600, device='cuda:3')
test acc is  0.42736666682300806
test loss is 3.162273880134005
test entropy is  0.39590311703333725
________________________________
diff is  tensor(39.1763, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3055, device='cuda:3', dtype=torch.float64)
diff is  tensor(505.1965, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4909, device='cuda:3', dtype=torch.float64)
diff is  tensor(3216.4732, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7847, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8517, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.1763, device='cuda:3')
clipping
cal diff is tensor(0.3055, device='cuda:3')
clipping
cal diff is tensor(505.1965, device='cuda:3')
clipping
cal diff is tensor(0.4909, device='cuda:3')
clipping
cal diff is tensor(3216.4731, device='cuda:3')
clipping
cal diff is tensor(1.7847, device='cuda:3')
clipping
cal diff is tensor(17.8517, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3725.9939, device='cuda:3')
test acc is  0.44398333348967495
test loss is 2.9336529784619425
test entropy is  0.40549291279524374
________________________________
diff is  tensor(38.6016, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3010, device='cuda:3', dtype=torch.float64)
diff is  tensor(497.7859, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4837, device='cuda:3', dtype=torch.float64)
diff is  tensor(3169.2920, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7585, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.5899, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.6016, device='cuda:3')
clipping
cal diff is tensor(0.3010, device='cuda:3')
clipping
cal diff is tensor(497.7859, device='cuda:3')
clipping
cal diff is tensor(0.4837, device='cuda:3')
clipping
cal diff is tensor(3169.2920, device='cuda:3')
clipping
cal diff is tensor(1.7585, device='cuda:3')
clipping
cal diff is tensor(17.5899, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3670.5212, device='cuda:3')
test acc is  0.4608000001563417
test loss is 2.7166976813060133
test entropy is  0.41461945749295037
________________________________
diff is  tensor(38.0269, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2965, device='cuda:3', dtype=torch.float64)
diff is  tensor(490.3746, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4765, device='cuda:3', dtype=torch.float64)
diff is  tensor(3122.1056, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7323, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3280, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.0269, device='cuda:3')
clipping
cal diff is tensor(0.2965, device='cuda:3')
clipping
cal diff is tensor(490.3746, device='cuda:3')
clipping
cal diff is tensor(0.4765, device='cuda:3')
clipping
cal diff is tensor(3122.1055, device='cuda:3')
clipping
cal diff is tensor(1.7323, device='cuda:3')
clipping
cal diff is tensor(17.3280, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3615.0427, device='cuda:3')
test acc is  0.47853333348967525
test loss is 2.5109996024225314
test entropy is  0.42334477927511943
________________________________
diff is  tensor(37.4521, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2920, device='cuda:3', dtype=torch.float64)
diff is  tensor(482.9624, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4693, device='cuda:3', dtype=torch.float64)
diff is  tensor(3074.9136, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7061, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.0660, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.4521, device='cuda:3')
clipping
cal diff is tensor(0.2920, device='cuda:3')
clipping
cal diff is tensor(482.9623, device='cuda:3')
clipping
cal diff is tensor(0.4693, device='cuda:3')
clipping
cal diff is tensor(3074.9136, device='cuda:3')
clipping
cal diff is tensor(1.7061, device='cuda:3')
clipping
cal diff is tensor(17.0660, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3559.5576, device='cuda:3')
test acc is  0.49658333348967537
test loss is 2.3164075098312233
test entropy is  0.43151519439622027
________________________________
diff is  tensor(36.8773, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2875, device='cuda:3', dtype=torch.float64)
diff is  tensor(475.5493, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4621, device='cuda:3', dtype=torch.float64)
diff is  tensor(3027.7162, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6799, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.8041, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.8773, device='cuda:3')
clipping
cal diff is tensor(0.2875, device='cuda:3')
clipping
cal diff is tensor(475.5493, device='cuda:3')
clipping
cal diff is tensor(0.4621, device='cuda:3')
clipping
cal diff is tensor(3027.7163, device='cuda:3')
clipping
cal diff is tensor(1.6799, device='cuda:3')
clipping
cal diff is tensor(16.8041, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3504.0662, device='cuda:3')
test acc is  0.5157666668230088
test loss is 2.132088137715102
test entropy is  0.4391915888738022
________________________________
diff is  tensor(36.3023, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2831, device='cuda:3', dtype=torch.float64)
diff is  tensor(468.1353, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4549, device='cuda:3', dtype=torch.float64)
diff is  tensor(2980.5132, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6537, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.5421, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.3023, device='cuda:3')
clipping
cal diff is tensor(0.2831, device='cuda:3')
clipping
cal diff is tensor(468.1353, device='cuda:3')
clipping
cal diff is tensor(0.4549, device='cuda:3')
clipping
cal diff is tensor(2980.5132, device='cuda:3')
clipping
cal diff is tensor(1.6537, device='cuda:3')
clipping
cal diff is tensor(16.5421, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3448.5671, device='cuda:3')
test acc is  0.5338333334896755
test loss is 1.9586586174426048
test entropy is  0.4463375057620026
________________________________
diff is  tensor(35.7273, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2786, device='cuda:3', dtype=torch.float64)
diff is  tensor(460.7205, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4477, device='cuda:3', dtype=torch.float64)
diff is  tensor(2933.3044, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6275, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.2801, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.7273, device='cuda:3')
clipping
cal diff is tensor(0.2786, device='cuda:3')
clipping
cal diff is tensor(460.7205, device='cuda:3')
clipping
cal diff is tensor(0.4477, device='cuda:3')
clipping
cal diff is tensor(2933.3044, device='cuda:3')
clipping
cal diff is tensor(1.6275, device='cuda:3')
clipping
cal diff is tensor(16.2801, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3393.0613, device='cuda:3')
test acc is  0.5529166668230083
test loss is 1.7960873476859094
test entropy is  0.4526590943844842
________________________________
diff is  tensor(35.1523, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2741, device='cuda:3', dtype=torch.float64)
diff is  tensor(453.3046, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4405, device='cuda:3', dtype=torch.float64)
diff is  tensor(2886.0893, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6013, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.0181, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.1523, device='cuda:3')
clipping
cal diff is tensor(0.2741, device='cuda:3')
clipping
cal diff is tensor(453.3046, device='cuda:3')
clipping
cal diff is tensor(0.4405, device='cuda:3')
clipping
cal diff is tensor(2886.0894, device='cuda:3')
clipping
cal diff is tensor(1.6013, device='cuda:3')
clipping
cal diff is tensor(16.0181, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3337.5479, device='cuda:3')
test acc is  0.5725166668230066
test loss is 1.6444628465531477
test entropy is  0.4581864044419738
________________________________
diff is  tensor(34.5771, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2696, device='cuda:3', dtype=torch.float64)
diff is  tensor(445.8878, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4333, device='cuda:3', dtype=torch.float64)
diff is  tensor(2838.8680, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5751, device='cuda:3', dtype=torch.float64)
diff is  tensor(15.7560, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.5771, device='cuda:3')
clipping
cal diff is tensor(0.2696, device='cuda:3')
clipping
cal diff is tensor(445.8878, device='cuda:3')
clipping
cal diff is tensor(0.4333, device='cuda:3')
clipping
cal diff is tensor(2838.8682, device='cuda:3')
clipping
cal diff is tensor(1.5751, device='cuda:3')
clipping
cal diff is tensor(15.7560, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3282.0271, device='cuda:3')
test acc is  0.5923500001563382
test loss is 1.5030933474935193
test entropy is  0.4626849730576533
________________________________
diff is  tensor(34.0019, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2651, device='cuda:3', dtype=torch.float64)
diff is  tensor(438.4699, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4261, device='cuda:3', dtype=torch.float64)
diff is  tensor(2791.6401, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5489, device='cuda:3', dtype=torch.float64)
diff is  tensor(15.4939, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.0019, device='cuda:3')
clipping
cal diff is tensor(0.2651, device='cuda:3')
clipping
cal diff is tensor(438.4699, device='cuda:3')
clipping
cal diff is tensor(0.4261, device='cuda:3')
clipping
cal diff is tensor(2791.6401, device='cuda:3')
clipping
cal diff is tensor(1.5489, device='cuda:3')
clipping
cal diff is tensor(15.4939, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
________________________________
test distance is  tensor(3226.4985, device='cuda:3')
test acc is  0.6146833334896699
test loss is 1.3719423266489115
test entropy is  0.4658844103055722
________________________________
diff is  tensor(33.4266, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2606, device='cuda:3', dtype=torch.float64)
diff is  tensor(431.0510, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4189, device='cuda:3', dtype=torch.float64)
diff is  tensor(2744.4056, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5227, device='cuda:3', dtype=torch.float64)
diff is  tensor(15.2317, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
cal diff is tensor(33.4266, device='cuda:3')
clipping
cal diff is tensor(0.2606, device='cuda:3')
clipping
cal diff is tensor(431.0510, device='cuda:3')
clipping
cal diff is tensor(0.4189, device='cuda:3')
clipping
cal diff is tensor(2744.4058, device='cuda:3')
clipping
cal diff is tensor(1.5227, device='cuda:3')
clipping
cal diff is tensor(15.2317, device='cuda:3')
clipping
cal diff is tensor(0.1812, device='cuda:3')
reach max round
new distance ratio is 0.99
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 97.15% 

Test Accuracy: 96.93% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.16415905952453613
attack res is True
len of model dicts is  10
compute distance is  tensor(19.3485, device='cuda:3')
compute distance is  tensor(34.4055, device='cuda:3')
compute distance is  tensor(74.9982, device='cuda:3')
compute distance is  tensor(44.0858, device='cuda:3')
compute distance is  tensor(36.8871, device='cuda:3')
compute distance is  tensor(32.2962, device='cuda:3')
compute distance is  tensor(43.5240, device='cuda:3')
compute distance is  tensor(49.7473, device='cuda:3')
compute distance is  tensor(37.6548, device='cuda:3')
compute distance is  tensor(41.0743, device='cuda:3')
calculated distance threshold is  tensor(79.9510, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.3995000001563411
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.20281666682300312
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5162333334896755
====================
====================
iteration is  1
round is  0
accuracy is  0.5431833334896757
====================
====================
iteration is  1
round is  1
accuracy is  0.38690000015634096
====================
________________________________
test distance is  tensor(4283.1401, device='cuda:3')
test acc is  0.20281666682300312
test loss is 11.361850672947572
test entropy is  0.1916713656059333
________________________________
diff is  tensor(42.6063, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4002, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.8458, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4836, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.3844, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0114, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2196, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.6063, device='cuda:3')
clipping
cal diff is tensor(0.4002, device='cuda:3')
clipping
cal diff is tensor(574.8458, device='cuda:3')
clipping
cal diff is tensor(0.4836, device='cuda:3')
clipping
cal diff is tensor(3642.3845, device='cuda:3')
clipping
cal diff is tensor(2.0114, device='cuda:3')
clipping
cal diff is tensor(20.2196, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(4242.9780, device='cuda:3')
test acc is  0.2064500001563366
test loss is 10.97439616473753
test entropy is  0.1954917167581475
________________________________
diff is  tensor(42.2068, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3964, device='cuda:3', dtype=torch.float64)
diff is  tensor(569.4553, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4791, device='cuda:3', dtype=torch.float64)
diff is  tensor(3608.2290, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9926, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.0300, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.2068, device='cuda:3')
clipping
cal diff is tensor(0.3964, device='cuda:3')
clipping
cal diff is tensor(569.4554, device='cuda:3')
clipping
cal diff is tensor(0.4791, device='cuda:3')
clipping
cal diff is tensor(3608.2290, device='cuda:3')
clipping
cal diff is tensor(1.9926, device='cuda:3')
clipping
cal diff is tensor(20.0300, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(4202.8145, device='cuda:3')
test acc is  0.20953333348967007
test loss is 10.595680757880466
test entropy is  0.19940142957036938
________________________________
diff is  tensor(41.8072, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3927, device='cuda:3', dtype=torch.float64)
diff is  tensor(564.0646, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4746, device='cuda:3', dtype=torch.float64)
diff is  tensor(3574.0721, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9737, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8404, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.8072, device='cuda:3')
clipping
cal diff is tensor(0.3927, device='cuda:3')
clipping
cal diff is tensor(564.0647, device='cuda:3')
clipping
cal diff is tensor(0.4746, device='cuda:3')
clipping
cal diff is tensor(3574.0720, device='cuda:3')
clipping
cal diff is tensor(1.9737, device='cuda:3')
clipping
cal diff is tensor(19.8404, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(4162.6489, device='cuda:3')
test acc is  0.21318333348967022
test loss is 10.224562025273533
test entropy is  0.20336676145127333
________________________________
diff is  tensor(41.4077, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3889, device='cuda:3', dtype=torch.float64)
diff is  tensor(558.6737, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4700, device='cuda:3', dtype=torch.float64)
diff is  tensor(3539.9138, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9548, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6508, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.4077, device='cuda:3')
clipping
cal diff is tensor(0.3889, device='cuda:3')
clipping
cal diff is tensor(558.6737, device='cuda:3')
clipping
cal diff is tensor(0.4700, device='cuda:3')
clipping
cal diff is tensor(3539.9138, device='cuda:3')
clipping
cal diff is tensor(1.9548, device='cuda:3')
clipping
cal diff is tensor(19.6508, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(4122.4814, device='cuda:3')
test acc is  0.2166166668230037
test loss is 9.859707790142945
test entropy is  0.2074796023891806
________________________________
diff is  tensor(41.0081, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3852, device='cuda:3', dtype=torch.float64)
diff is  tensor(553.2826, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4655, device='cuda:3', dtype=torch.float64)
diff is  tensor(3505.7540, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9360, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4611, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.0081, device='cuda:3')
clipping
cal diff is tensor(0.3852, device='cuda:3')
clipping
cal diff is tensor(553.2826, device='cuda:3')
clipping
cal diff is tensor(0.4655, device='cuda:3')
clipping
cal diff is tensor(3505.7542, device='cuda:3')
clipping
cal diff is tensor(1.9360, device='cuda:3')
clipping
cal diff is tensor(19.4611, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(4082.3115, device='cuda:3')
test acc is  0.22031666682300388
test loss is 9.505509254012281
test entropy is  0.2116341337656924
________________________________
diff is  tensor(40.6085, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3814, device='cuda:3', dtype=torch.float64)
diff is  tensor(547.8912, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4610, device='cuda:3', dtype=torch.float64)
diff is  tensor(3471.5925, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9171, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2715, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.6085, device='cuda:3')
clipping
cal diff is tensor(0.3814, device='cuda:3')
clipping
cal diff is tensor(547.8912, device='cuda:3')
clipping
cal diff is tensor(0.4610, device='cuda:3')
clipping
cal diff is tensor(3471.5923, device='cuda:3')
clipping
cal diff is tensor(1.9171, device='cuda:3')
clipping
cal diff is tensor(19.2715, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(4042.1404, device='cuda:3')
test acc is  0.22460000015633738
test loss is 9.156152356662222
test entropy is  0.21589836843613622
________________________________
diff is  tensor(40.2089, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3777, device='cuda:3', dtype=torch.float64)
diff is  tensor(542.4995, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4564, device='cuda:3', dtype=torch.float64)
diff is  tensor(3437.4291, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8982, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0819, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.2089, device='cuda:3')
clipping
cal diff is tensor(0.3777, device='cuda:3')
clipping
cal diff is tensor(542.4995, device='cuda:3')
clipping
cal diff is tensor(0.4564, device='cuda:3')
clipping
cal diff is tensor(3437.4290, device='cuda:3')
clipping
cal diff is tensor(1.8982, device='cuda:3')
clipping
cal diff is tensor(19.0819, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(4001.9670, device='cuda:3')
test acc is  0.22883333348967086
test loss is 8.81496479465509
test entropy is  0.22022371477028455
________________________________
diff is  tensor(39.8092, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3739, device='cuda:3', dtype=torch.float64)
diff is  tensor(537.1075, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4519, device='cuda:3', dtype=torch.float64)
diff is  tensor(3403.2642, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8794, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.8922, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.8092, device='cuda:3')
clipping
cal diff is tensor(0.3739, device='cuda:3')
clipping
cal diff is tensor(537.1075, device='cuda:3')
clipping
cal diff is tensor(0.4519, device='cuda:3')
clipping
cal diff is tensor(3403.2642, device='cuda:3')
clipping
cal diff is tensor(1.8794, device='cuda:3')
clipping
cal diff is tensor(18.8922, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3961.7917, device='cuda:3')
test acc is  0.23335000015633772
test loss is 8.481165398412676
test entropy is  0.22460841257244285
________________________________
diff is  tensor(39.4096, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3702, device='cuda:3', dtype=torch.float64)
diff is  tensor(531.7153, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4473, device='cuda:3', dtype=torch.float64)
diff is  tensor(3369.0976, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8605, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7025, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.4096, device='cuda:3')
clipping
cal diff is tensor(0.3702, device='cuda:3')
clipping
cal diff is tensor(531.7153, device='cuda:3')
clipping
cal diff is tensor(0.4473, device='cuda:3')
clipping
cal diff is tensor(3369.0977, device='cuda:3')
clipping
cal diff is tensor(1.8605, device='cuda:3')
clipping
cal diff is tensor(18.7025, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3921.6145, device='cuda:3')
test acc is  0.23785000015633787
test loss is 8.156054543025459
test entropy is  0.22907025735579065
________________________________
diff is  tensor(39.0099, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3664, device='cuda:3', dtype=torch.float64)
diff is  tensor(526.3228, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4428, device='cuda:3', dtype=torch.float64)
diff is  tensor(3334.9293, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8416, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5129, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.0099, device='cuda:3')
clipping
cal diff is tensor(0.3664, device='cuda:3')
clipping
cal diff is tensor(526.3228, device='cuda:3')
clipping
cal diff is tensor(0.4428, device='cuda:3')
clipping
cal diff is tensor(3334.9292, device='cuda:3')
clipping
cal diff is tensor(1.8416, device='cuda:3')
clipping
cal diff is tensor(18.5129, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3881.4353, device='cuda:3')
test acc is  0.24283333348967137
test loss is 7.838372234596626
test entropy is  0.23358450780735848
________________________________
diff is  tensor(38.6102, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3627, device='cuda:3', dtype=torch.float64)
diff is  tensor(520.9301, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4383, device='cuda:3', dtype=torch.float64)
diff is  tensor(3300.7592, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8228, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.3232, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.6102, device='cuda:3')
clipping
cal diff is tensor(0.3627, device='cuda:3')
clipping
cal diff is tensor(520.9301, device='cuda:3')
clipping
cal diff is tensor(0.4383, device='cuda:3')
clipping
cal diff is tensor(3300.7593, device='cuda:3')
clipping
cal diff is tensor(1.8228, device='cuda:3')
clipping
cal diff is tensor(18.3232, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3841.2537, device='cuda:3')
test acc is  0.24763333348967154
test loss is 7.52836744261703
test entropy is  0.23814000236962649
________________________________
diff is  tensor(38.2105, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3589, device='cuda:3', dtype=torch.float64)
diff is  tensor(515.5370, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4337, device='cuda:3', dtype=torch.float64)
diff is  tensor(3266.5874, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8039, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.1335, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.2105, device='cuda:3')
clipping
cal diff is tensor(0.3589, device='cuda:3')
clipping
cal diff is tensor(515.5370, device='cuda:3')
clipping
cal diff is tensor(0.4337, device='cuda:3')
clipping
cal diff is tensor(3266.5874, device='cuda:3')
clipping
cal diff is tensor(1.8039, device='cuda:3')
clipping
cal diff is tensor(18.1335, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3801.0701, device='cuda:3')
test acc is  0.25321666682300503
test loss is 7.224012098332712
test entropy is  0.2427635064034828
________________________________
diff is  tensor(37.8107, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3551, device='cuda:3', dtype=torch.float64)
diff is  tensor(510.1437, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4292, device='cuda:3', dtype=torch.float64)
diff is  tensor(3232.4136, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7850, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.9438, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.8107, device='cuda:3')
clipping
cal diff is tensor(0.3551, device='cuda:3')
clipping
cal diff is tensor(510.1437, device='cuda:3')
clipping
cal diff is tensor(0.4292, device='cuda:3')
clipping
cal diff is tensor(3232.4136, device='cuda:3')
clipping
cal diff is tensor(1.7850, device='cuda:3')
clipping
cal diff is tensor(17.9438, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3760.8840, device='cuda:3')
test acc is  0.25878333348967186
test loss is 6.92819184280916
test entropy is  0.24746886941034402
________________________________
diff is  tensor(37.4110, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3514, device='cuda:3', dtype=torch.float64)
diff is  tensor(504.7500, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4247, device='cuda:3', dtype=torch.float64)
diff is  tensor(3198.2380, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7662, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.7541, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.4110, device='cuda:3')
clipping
cal diff is tensor(0.3514, device='cuda:3')
clipping
cal diff is tensor(504.7501, device='cuda:3')
clipping
cal diff is tensor(0.4247, device='cuda:3')
clipping
cal diff is tensor(3198.2378, device='cuda:3')
clipping
cal diff is tensor(1.7662, device='cuda:3')
clipping
cal diff is tensor(17.7541, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3720.6958, device='cuda:3')
test acc is  0.2642000001563387
test loss is 6.640071707239537
test entropy is  0.25218570756632636
________________________________
diff is  tensor(37.0112, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3476, device='cuda:3', dtype=torch.float64)
diff is  tensor(499.3561, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4201, device='cuda:3', dtype=torch.float64)
diff is  tensor(3164.0604, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7473, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.5643, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.0112, device='cuda:3')
clipping
cal diff is tensor(0.3476, device='cuda:3')
clipping
cal diff is tensor(499.3561, device='cuda:3')
clipping
cal diff is tensor(0.4201, device='cuda:3')
clipping
cal diff is tensor(3164.0605, device='cuda:3')
clipping
cal diff is tensor(1.7473, device='cuda:3')
clipping
cal diff is tensor(17.5643, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3680.5054, device='cuda:3')
test acc is  0.2701166668230055
test loss is 6.358247016538689
test entropy is  0.2570392327712797
________________________________
diff is  tensor(36.6114, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3439, device='cuda:3', dtype=torch.float64)
diff is  tensor(493.9618, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4156, device='cuda:3', dtype=torch.float64)
diff is  tensor(3129.8809, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7284, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3746, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.6114, device='cuda:3')
clipping
cal diff is tensor(0.3439, device='cuda:3')
clipping
cal diff is tensor(493.9618, device='cuda:3')
clipping
cal diff is tensor(0.4156, device='cuda:3')
clipping
cal diff is tensor(3129.8809, device='cuda:3')
clipping
cal diff is tensor(1.7284, device='cuda:3')
clipping
cal diff is tensor(17.3746, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3640.3123, device='cuda:3')
test acc is  0.27568333348967233
test loss is 6.085392330755303
test entropy is  0.26198951099345935
________________________________
diff is  tensor(36.2115, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3401, device='cuda:3', dtype=torch.float64)
diff is  tensor(488.5672, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4110, device='cuda:3', dtype=torch.float64)
diff is  tensor(3095.6993, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7095, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.1849, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.2115, device='cuda:3')
clipping
cal diff is tensor(0.3401, device='cuda:3')
clipping
cal diff is tensor(488.5673, device='cuda:3')
clipping
cal diff is tensor(0.4110, device='cuda:3')
clipping
cal diff is tensor(3095.6992, device='cuda:3')
clipping
cal diff is tensor(1.7095, device='cuda:3')
clipping
cal diff is tensor(17.1849, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3600.1169, device='cuda:3')
test acc is  0.2819833334896724
test loss is 5.81673642338466
test entropy is  0.26715512562598753
________________________________
diff is  tensor(35.8117, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3364, device='cuda:3', dtype=torch.float64)
diff is  tensor(483.1723, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4065, device='cuda:3', dtype=torch.float64)
diff is  tensor(3061.5156, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6907, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.9951, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.8117, device='cuda:3')
clipping
cal diff is tensor(0.3364, device='cuda:3')
clipping
cal diff is tensor(483.1723, device='cuda:3')
clipping
cal diff is tensor(0.4065, device='cuda:3')
clipping
cal diff is tensor(3061.5156, device='cuda:3')
clipping
cal diff is tensor(1.6907, device='cuda:3')
clipping
cal diff is tensor(16.9951, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3559.9194, device='cuda:3')
test acc is  0.2882666668230059
test loss is 5.556691921850257
test entropy is  0.27242168974774733
________________________________
diff is  tensor(35.4118, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3326, device='cuda:3', dtype=torch.float64)
diff is  tensor(477.7771, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4020, device='cuda:3', dtype=torch.float64)
diff is  tensor(3027.3298, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6718, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.8053, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.4118, device='cuda:3')
clipping
cal diff is tensor(0.3326, device='cuda:3')
clipping
cal diff is tensor(477.7771, device='cuda:3')
clipping
cal diff is tensor(0.4020, device='cuda:3')
clipping
cal diff is tensor(3027.3298, device='cuda:3')
clipping
cal diff is tensor(1.6718, device='cuda:3')
clipping
cal diff is tensor(16.8053, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
________________________________
test distance is  tensor(3519.7188, device='cuda:3')
test acc is  0.2945333334896727
test loss is 5.3032284878464395
test entropy is  0.27794203740447315
________________________________
diff is  tensor(35.0119, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3289, device='cuda:3', dtype=torch.float64)
diff is  tensor(472.3815, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3974, device='cuda:3', dtype=torch.float64)
diff is  tensor(2993.1420, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6529, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.6155, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.0119, device='cuda:3')
clipping
cal diff is tensor(0.3289, device='cuda:3')
clipping
cal diff is tensor(472.3815, device='cuda:3')
clipping
cal diff is tensor(0.3974, device='cuda:3')
clipping
cal diff is tensor(2993.1421, device='cuda:3')
clipping
cal diff is tensor(1.6529, device='cuda:3')
clipping
cal diff is tensor(16.6155, device='cuda:3')
clipping
cal diff is tensor(0.1888, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 96.97% 

Test Accuracy: 96.78% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.17029446363449097
attack res is True
len of model dicts is  10
compute distance is  tensor(20.4287, device='cuda:3')
compute distance is  tensor(40.3317, device='cuda:3')
compute distance is  tensor(51.9571, device='cuda:3')
compute distance is  tensor(40.2851, device='cuda:3')
compute distance is  tensor(42.5556, device='cuda:3')
compute distance is  tensor(30.6285, device='cuda:3')
compute distance is  tensor(46.9335, device='cuda:3')
compute distance is  tensor(25.3841, device='cuda:3')
compute distance is  tensor(86.2539, device='cuda:3')
compute distance is  tensor(44.7008, device='cuda:3')
calculated distance threshold is  tensor(92.1124, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.3968000001563411
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.31955000015633983
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3009833334896729
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.36745000015634066
====================
====================
iteration is  1
round is  1
accuracy is  0.2943500001563395
====================
succ_min + 1
________________________________
test distance is  tensor(4283.1558, device='cuda:3')
test acc is  0.2943500001563395
test loss is 5.229206749625297
test entropy is  0.37283989769627035
________________________________
diff is  tensor(43.0145, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3346, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.5915, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4368, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.2417, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9898, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3040, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2427, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2427, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.0145, device='cuda:3')
clipping
cal diff is tensor(0.3346, device='cuda:3')
clipping
cal diff is tensor(574.5915, device='cuda:3')
clipping
cal diff is tensor(0.4368, device='cuda:3')
clipping
cal diff is tensor(3642.2417, device='cuda:3')
clipping
cal diff is tensor(1.9898, device='cuda:3')
clipping
cal diff is tensor(20.3040, device='cuda:3')
clipping
cal diff is tensor(0.2427, device='cuda:3')
clipping
________________________________
test distance is  tensor(4236.8491, device='cuda:3')
test acc is  0.30621666682300636
test loss is 4.9741038564425795
test entropy is  0.3801541050741159
________________________________
diff is  tensor(42.5495, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3310, device='cuda:3', dtype=torch.float64)
diff is  tensor(568.3794, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4321, device='cuda:3', dtype=torch.float64)
diff is  tensor(3602.8644, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9683, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.0845, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2401, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2401, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.5495, device='cuda:3')
clipping
cal diff is tensor(0.3310, device='cuda:3')
clipping
cal diff is tensor(568.3795, device='cuda:3')
clipping
cal diff is tensor(0.4321, device='cuda:3')
clipping
cal diff is tensor(3602.8645, device='cuda:3')
clipping
cal diff is tensor(1.9683, device='cuda:3')
clipping
cal diff is tensor(20.0845, device='cuda:3')
clipping
cal diff is tensor(0.2401, device='cuda:3')
clipping
________________________________
test distance is  tensor(4190.5400, device='cuda:3')
test acc is  0.3177000001563399
test loss is 4.728037509074343
test entropy is  0.38727302118532186
________________________________
diff is  tensor(42.0844, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3273, device='cuda:3', dtype=torch.float64)
diff is  tensor(562.1670, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4273, device='cuda:3', dtype=torch.float64)
diff is  tensor(3563.4847, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9467, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8650, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2374, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2374, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0844, device='cuda:3')
clipping
cal diff is tensor(0.3273, device='cuda:3')
clipping
cal diff is tensor(562.1670, device='cuda:3')
clipping
cal diff is tensor(0.4273, device='cuda:3')
clipping
cal diff is tensor(3563.4849, device='cuda:3')
clipping
cal diff is tensor(1.9467, device='cuda:3')
clipping
cal diff is tensor(19.8650, device='cuda:3')
clipping
cal diff is tensor(0.2374, device='cuda:3')
clipping
________________________________
test distance is  tensor(4144.2280, device='cuda:3')
test acc is  0.3293666668230068
test loss is 4.489254619521119
test entropy is  0.39429806805114503
________________________________
diff is  tensor(41.6193, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3237, device='cuda:3', dtype=torch.float64)
diff is  tensor(555.9542, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4226, device='cuda:3', dtype=torch.float64)
diff is  tensor(3524.1026, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9252, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6454, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2348, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2348, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.6193, device='cuda:3')
clipping
cal diff is tensor(0.3237, device='cuda:3')
clipping
cal diff is tensor(555.9542, device='cuda:3')
clipping
cal diff is tensor(0.4226, device='cuda:3')
clipping
cal diff is tensor(3524.1025, device='cuda:3')
clipping
cal diff is tensor(1.9252, device='cuda:3')
clipping
cal diff is tensor(19.6454, device='cuda:3')
clipping
cal diff is tensor(0.2348, device='cuda:3')
clipping
________________________________
test distance is  tensor(4097.9131, device='cuda:3')
test acc is  0.34188333348967365
test loss is 4.260368742159943
test entropy is  0.40099129875077366
________________________________
diff is  tensor(41.1542, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3201, device='cuda:3', dtype=torch.float64)
diff is  tensor(549.7410, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4179, device='cuda:3', dtype=torch.float64)
diff is  tensor(3484.7181, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9037, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4259, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.1542, device='cuda:3')
clipping
cal diff is tensor(0.3201, device='cuda:3')
clipping
cal diff is tensor(549.7410, device='cuda:3')
clipping
cal diff is tensor(0.4179, device='cuda:3')
clipping
cal diff is tensor(3484.7180, device='cuda:3')
clipping
cal diff is tensor(1.9037, device='cuda:3')
clipping
cal diff is tensor(19.4259, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(4051.5977, device='cuda:3')
test acc is  0.35518333348967385
test loss is 4.037228905061669
test entropy is  0.4075181161099151
________________________________
diff is  tensor(40.6890, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3165, device='cuda:3', dtype=torch.float64)
diff is  tensor(543.5273, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4132, device='cuda:3', dtype=torch.float64)
diff is  tensor(3445.3310, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8822, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2063, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.6890, device='cuda:3')
clipping
cal diff is tensor(0.3165, device='cuda:3')
clipping
cal diff is tensor(543.5273, device='cuda:3')
clipping
cal diff is tensor(0.4132, device='cuda:3')
clipping
cal diff is tensor(3445.3311, device='cuda:3')
clipping
cal diff is tensor(1.8822, device='cuda:3')
clipping
cal diff is tensor(19.2063, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(4005.2795, device='cuda:3')
test acc is  0.3681166668230074
test loss is 3.8241798127892177
test entropy is  0.4137088137903193
________________________________
diff is  tensor(40.2238, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3129, device='cuda:3', dtype=torch.float64)
diff is  tensor(537.3133, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4085, device='cuda:3', dtype=torch.float64)
diff is  tensor(3405.9413, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8607, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.9867, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.2238, device='cuda:3')
clipping
cal diff is tensor(0.3129, device='cuda:3')
clipping
cal diff is tensor(537.3133, device='cuda:3')
clipping
cal diff is tensor(0.4085, device='cuda:3')
clipping
cal diff is tensor(3405.9414, device='cuda:3')
clipping
cal diff is tensor(1.8607, device='cuda:3')
clipping
cal diff is tensor(18.9867, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3958.9580, device='cuda:3')
test acc is  0.3818333334896742
test loss is 3.6184249104721458
test entropy is  0.4196745440332112
________________________________
diff is  tensor(39.7586, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3092, device='cuda:3', dtype=torch.float64)
diff is  tensor(531.0989, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4037, device='cuda:3', dtype=torch.float64)
diff is  tensor(3366.5491, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8392, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7672, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.7586, device='cuda:3')
clipping
cal diff is tensor(0.3092, device='cuda:3')
clipping
cal diff is tensor(531.0989, device='cuda:3')
clipping
cal diff is tensor(0.4037, device='cuda:3')
clipping
cal diff is tensor(3366.5493, device='cuda:3')
clipping
cal diff is tensor(1.8392, device='cuda:3')
clipping
cal diff is tensor(18.7672, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3912.6338, device='cuda:3')
test acc is  0.39525000015634104
test loss is 3.4203773043048917
test entropy is  0.4253956757501753
________________________________
diff is  tensor(39.2934, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3056, device='cuda:3', dtype=torch.float64)
diff is  tensor(524.8840, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3990, device='cuda:3', dtype=torch.float64)
diff is  tensor(3327.1542, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8176, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5475, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.2934, device='cuda:3')
clipping
cal diff is tensor(0.3056, device='cuda:3')
clipping
cal diff is tensor(524.8840, device='cuda:3')
clipping
cal diff is tensor(0.3990, device='cuda:3')
clipping
cal diff is tensor(3327.1543, device='cuda:3')
clipping
cal diff is tensor(1.8176, device='cuda:3')
clipping
cal diff is tensor(18.5475, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3866.3059, device='cuda:3')
test acc is  0.40878333348967455
test loss is 3.2298129517386465
test entropy is  0.43081850493386353
________________________________
diff is  tensor(38.8281, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3020, device='cuda:3', dtype=torch.float64)
diff is  tensor(518.6688, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3943, device='cuda:3', dtype=torch.float64)
diff is  tensor(3287.7566, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7961, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.3279, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.8281, device='cuda:3')
clipping
cal diff is tensor(0.3020, device='cuda:3')
clipping
cal diff is tensor(518.6688, device='cuda:3')
clipping
cal diff is tensor(0.3943, device='cuda:3')
clipping
cal diff is tensor(3287.7566, device='cuda:3')
clipping
cal diff is tensor(1.7961, device='cuda:3')
clipping
cal diff is tensor(18.3279, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3819.9749, device='cuda:3')
test acc is  0.4221333334896747
test loss is 3.0473444797336926
test entropy is  0.4359548010551599
________________________________
diff is  tensor(38.3628, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2984, device='cuda:3', dtype=torch.float64)
diff is  tensor(512.4530, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3896, device='cuda:3', dtype=torch.float64)
diff is  tensor(3248.3561, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7746, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.1083, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.3628, device='cuda:3')
clipping
cal diff is tensor(0.2984, device='cuda:3')
clipping
cal diff is tensor(512.4531, device='cuda:3')
clipping
cal diff is tensor(0.3896, device='cuda:3')
clipping
cal diff is tensor(3248.3562, device='cuda:3')
clipping
cal diff is tensor(1.7746, device='cuda:3')
clipping
cal diff is tensor(18.1083, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3773.6406, device='cuda:3')
test acc is  0.43605000015634154
test loss is 2.8723302408576266
test entropy is  0.4408843654877087
________________________________
diff is  tensor(37.8974, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2948, device='cuda:3', dtype=torch.float64)
diff is  tensor(506.2369, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3848, device='cuda:3', dtype=torch.float64)
diff is  tensor(3208.9528, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7531, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8886, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.8974, device='cuda:3')
clipping
cal diff is tensor(0.2948, device='cuda:3')
clipping
cal diff is tensor(506.2368, device='cuda:3')
clipping
cal diff is tensor(0.3848, device='cuda:3')
clipping
cal diff is tensor(3208.9526, device='cuda:3')
clipping
cal diff is tensor(1.7531, device='cuda:3')
clipping
cal diff is tensor(17.8886, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3727.3025, device='cuda:3')
test acc is  0.449733333489675
test loss is 2.704084626520112
test entropy is  0.4456964857669782
________________________________
diff is  tensor(37.4320, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2912, device='cuda:3', dtype=torch.float64)
diff is  tensor(500.0202, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3801, device='cuda:3', dtype=torch.float64)
diff is  tensor(3169.5465, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7315, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6689, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.4320, device='cuda:3')
clipping
cal diff is tensor(0.2912, device='cuda:3')
clipping
cal diff is tensor(500.0202, device='cuda:3')
clipping
cal diff is tensor(0.3801, device='cuda:3')
clipping
cal diff is tensor(3169.5466, device='cuda:3')
clipping
cal diff is tensor(1.7315, device='cuda:3')
clipping
cal diff is tensor(17.6689, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3680.9612, device='cuda:3')
test acc is  0.4636166668230084
test loss is 2.5440430650070534
test entropy is  0.450212531506634
________________________________
diff is  tensor(36.9666, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2875, device='cuda:3', dtype=torch.float64)
diff is  tensor(493.8031, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3754, device='cuda:3', dtype=torch.float64)
diff is  tensor(3130.1372, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7100, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.4493, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.9666, device='cuda:3')
clipping
cal diff is tensor(0.2875, device='cuda:3')
clipping
cal diff is tensor(493.8031, device='cuda:3')
clipping
cal diff is tensor(0.3754, device='cuda:3')
clipping
cal diff is tensor(3130.1372, device='cuda:3')
clipping
cal diff is tensor(1.7100, device='cuda:3')
clipping
cal diff is tensor(17.4493, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3634.6162, device='cuda:3')
test acc is  0.4775166668230086
test loss is 2.3901522327333624
test entropy is  0.45457823968518263
________________________________
diff is  tensor(36.5012, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2839, device='cuda:3', dtype=torch.float64)
diff is  tensor(487.5855, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3706, device='cuda:3', dtype=torch.float64)
diff is  tensor(3090.7248, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6885, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.2295, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.5012, device='cuda:3')
clipping
cal diff is tensor(0.2839, device='cuda:3')
clipping
cal diff is tensor(487.5855, device='cuda:3')
clipping
cal diff is tensor(0.3706, device='cuda:3')
clipping
cal diff is tensor(3090.7249, device='cuda:3')
clipping
cal diff is tensor(1.6885, device='cuda:3')
clipping
cal diff is tensor(17.2295, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3588.2673, device='cuda:3')
test acc is  0.49250000015634204
test loss is 2.2431835304699472
test entropy is  0.4585957816605375
________________________________
diff is  tensor(36.0357, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2803, device='cuda:3', dtype=torch.float64)
diff is  tensor(481.3674, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3659, device='cuda:3', dtype=torch.float64)
diff is  tensor(3051.3092, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6669, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.0098, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.0357, device='cuda:3')
clipping
cal diff is tensor(0.2803, device='cuda:3')
clipping
cal diff is tensor(481.3674, device='cuda:3')
clipping
cal diff is tensor(0.3659, device='cuda:3')
clipping
cal diff is tensor(3051.3093, device='cuda:3')
clipping
cal diff is tensor(1.6669, device='cuda:3')
clipping
cal diff is tensor(17.0098, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3541.9148, device='cuda:3')
test acc is  0.5074000001563421
test loss is 2.1039948074548227
test entropy is  0.4622295160791767
________________________________
diff is  tensor(35.5701, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2767, device='cuda:3', dtype=torch.float64)
diff is  tensor(475.1488, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3612, device='cuda:3', dtype=torch.float64)
diff is  tensor(3011.8904, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6454, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.7901, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.5701, device='cuda:3')
clipping
cal diff is tensor(0.2767, device='cuda:3')
clipping
cal diff is tensor(475.1488, device='cuda:3')
clipping
cal diff is tensor(0.3612, device='cuda:3')
clipping
cal diff is tensor(3011.8904, device='cuda:3')
clipping
cal diff is tensor(1.6454, device='cuda:3')
clipping
cal diff is tensor(16.7901, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3495.5583, device='cuda:3')
test acc is  0.5224500001563422
test loss is 1.9704352838398298
test entropy is  0.4654478745928197
________________________________
diff is  tensor(35.1046, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2730, device='cuda:3', dtype=torch.float64)
diff is  tensor(468.9296, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3565, device='cuda:3', dtype=torch.float64)
diff is  tensor(2972.4682, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6239, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.5703, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.1046, device='cuda:3')
clipping
cal diff is tensor(0.2730, device='cuda:3')
clipping
cal diff is tensor(468.9296, device='cuda:3')
clipping
cal diff is tensor(0.3565, device='cuda:3')
clipping
cal diff is tensor(2972.4683, device='cuda:3')
clipping
cal diff is tensor(1.6239, device='cuda:3')
clipping
cal diff is tensor(16.5703, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3449.1978, device='cuda:3')
test acc is  0.5378000001563423
test loss is 1.8441077034864852
test entropy is  0.46805525591759795
________________________________
diff is  tensor(34.6389, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2694, device='cuda:3', dtype=torch.float64)
diff is  tensor(462.7099, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3517, device='cuda:3', dtype=torch.float64)
diff is  tensor(2933.0427, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6023, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.3505, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.6389, device='cuda:3')
clipping
cal diff is tensor(0.2694, device='cuda:3')
clipping
cal diff is tensor(462.7100, device='cuda:3')
clipping
cal diff is tensor(0.3517, device='cuda:3')
clipping
cal diff is tensor(2933.0425, device='cuda:3')
clipping
cal diff is tensor(1.6023, device='cuda:3')
clipping
cal diff is tensor(16.3505, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
________________________________
test distance is  tensor(3402.8333, device='cuda:3')
test acc is  0.5537000001563417
test loss is 1.7244187921984617
test entropy is  0.4700949389034751
________________________________
diff is  tensor(34.1733, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2658, device='cuda:3', dtype=torch.float64)
diff is  tensor(456.4897, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3470, device='cuda:3', dtype=torch.float64)
diff is  tensor(2893.6136, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5808, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.1307, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2322, device='cuda:3', dtype=torch.float64)
cal diff is tensor(34.1733, device='cuda:3')
clipping
cal diff is tensor(0.2658, device='cuda:3')
clipping
cal diff is tensor(456.4897, device='cuda:3')
clipping
cal diff is tensor(0.3470, device='cuda:3')
clipping
cal diff is tensor(2893.6135, device='cuda:3')
clipping
cal diff is tensor(1.5808, device='cuda:3')
clipping
cal diff is tensor(16.1307, device='cuda:3')
clipping
cal diff is tensor(0.2322, device='cuda:3')
reach max round
new distance ratio is 0.99
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 97.06% 

Test Accuracy: 96.84% 


 | Global Training Round : 51 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.17667512595653534
attack res is True
len of model dicts is  10
compute distance is  tensor(25.1675, device='cuda:3')
compute distance is  tensor(28.5821, device='cuda:3')
compute distance is  tensor(44.1813, device='cuda:3')
compute distance is  tensor(29.7823, device='cuda:3')
compute distance is  tensor(31.0838, device='cuda:3')
compute distance is  tensor(32.5111, device='cuda:3')
compute distance is  tensor(62.3704, device='cuda:3')
compute distance is  tensor(39.1466, device='cuda:3')
compute distance is  tensor(67.9452, device='cuda:3')
compute distance is  tensor(47.4562, device='cuda:3')
calculated distance threshold is  tensor(71.7524, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.40558333348967446
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3420166668230069
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.42625000015634135
====================
====================
iteration is  1
round is  0
accuracy is  0.3518833334896738
====================
====================
iteration is  1
round is  1
accuracy is  0.4304333334896747
====================
________________________________
test distance is  tensor(4285.6641, device='cuda:3')
test acc is  0.3420166668230069
test loss is 4.694574489013981
test entropy is  0.4023535971893176
________________________________
diff is  tensor(45.0994, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4183, device='cuda:3', dtype=torch.float64)
diff is  tensor(575.0499, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4845, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.9161, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0329, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.4714, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1917, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1917, device='cuda:3', dtype=torch.float64)
cal diff is tensor(45.0994, device='cuda:3')
clipping
cal diff is tensor(0.4183, device='cuda:3')
clipping
cal diff is tensor(575.0499, device='cuda:3')
clipping
cal diff is tensor(0.4845, device='cuda:3')
clipping
cal diff is tensor(3641.9160, device='cuda:3')
clipping
cal diff is tensor(2.0329, device='cuda:3')
clipping
cal diff is tensor(20.4714, device='cuda:3')
clipping
cal diff is tensor(0.1917, device='cuda:3')
clipping
________________________________
test distance is  tensor(4249.6362, device='cuda:3')
test acc is  0.350566666823007
test loss is 4.500790425455138
test entropy is  0.4097077718167417
________________________________
diff is  tensor(44.7202, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4147, device='cuda:3', dtype=torch.float64)
diff is  tensor(570.2157, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4804, device='cuda:3', dtype=torch.float64)
diff is  tensor(3611.3001, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0158, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2993, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.7202, device='cuda:3')
clipping
cal diff is tensor(0.4147, device='cuda:3')
clipping
cal diff is tensor(570.2158, device='cuda:3')
clipping
cal diff is tensor(0.4804, device='cuda:3')
clipping
cal diff is tensor(3611.3003, device='cuda:3')
clipping
cal diff is tensor(2.0158, device='cuda:3')
clipping
cal diff is tensor(20.2993, device='cuda:3')
clipping
cal diff is tensor(0.1901, device='cuda:3')
clipping
________________________________
test distance is  tensor(4213.6074, device='cuda:3')
test acc is  0.3592666668230072
test loss is 4.31043428601995
test entropy is  0.4171481478188846
________________________________
diff is  tensor(44.3411, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4112, device='cuda:3', dtype=torch.float64)
diff is  tensor(565.3813, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4763, device='cuda:3', dtype=torch.float64)
diff is  tensor(3580.6830, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9987, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1272, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.3411, device='cuda:3')
clipping
cal diff is tensor(0.4112, device='cuda:3')
clipping
cal diff is tensor(565.3813, device='cuda:3')
clipping
cal diff is tensor(0.4763, device='cuda:3')
clipping
cal diff is tensor(3580.6831, device='cuda:3')
clipping
cal diff is tensor(1.9987, device='cuda:3')
clipping
cal diff is tensor(20.1272, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(4177.5786, device='cuda:3')
test acc is  0.3684500001563406
test loss is 4.126898572134819
test entropy is  0.42441142126441256
________________________________
diff is  tensor(43.9619, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4077, device='cuda:3', dtype=torch.float64)
diff is  tensor(560.5468, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4723, device='cuda:3', dtype=torch.float64)
diff is  tensor(3550.0648, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9816, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.9551, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.9619, device='cuda:3')
clipping
cal diff is tensor(0.4077, device='cuda:3')
clipping
cal diff is tensor(560.5468, device='cuda:3')
clipping
cal diff is tensor(0.4723, device='cuda:3')
clipping
cal diff is tensor(3550.0649, device='cuda:3')
clipping
cal diff is tensor(1.9816, device='cuda:3')
clipping
cal diff is tensor(19.9551, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(4141.5488, device='cuda:3')
test acc is  0.37688333348967407
test loss is 3.9491497458679587
test entropy is  0.43170571301791716
________________________________
diff is  tensor(43.5828, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4042, device='cuda:3', dtype=torch.float64)
diff is  tensor(555.7121, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4682, device='cuda:3', dtype=torch.float64)
diff is  tensor(3519.4455, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9645, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.7830, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.5828, device='cuda:3')
clipping
cal diff is tensor(0.4042, device='cuda:3')
clipping
cal diff is tensor(555.7120, device='cuda:3')
clipping
cal diff is tensor(0.4682, device='cuda:3')
clipping
cal diff is tensor(3519.4456, device='cuda:3')
clipping
cal diff is tensor(1.9645, device='cuda:3')
clipping
cal diff is tensor(19.7830, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(4105.5176, device='cuda:3')
test acc is  0.3871000001563409
test loss is 3.777164284354334
test entropy is  0.43873281236777684
________________________________
diff is  tensor(43.2036, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4007, device='cuda:3', dtype=torch.float64)
diff is  tensor(550.8772, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4641, device='cuda:3', dtype=torch.float64)
diff is  tensor(3488.8251, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9474, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6109, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.2036, device='cuda:3')
clipping
cal diff is tensor(0.4007, device='cuda:3')
clipping
cal diff is tensor(550.8772, device='cuda:3')
clipping
cal diff is tensor(0.4641, device='cuda:3')
clipping
cal diff is tensor(3488.8252, device='cuda:3')
clipping
cal diff is tensor(1.9474, device='cuda:3')
clipping
cal diff is tensor(19.6109, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(4069.4849, device='cuda:3')
test acc is  0.3968166668230077
test loss is 3.609413999230114
test entropy is  0.4457290764492966
________________________________
diff is  tensor(42.8244, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3972, device='cuda:3', dtype=torch.float64)
diff is  tensor(546.0421, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4600, device='cuda:3', dtype=torch.float64)
diff is  tensor(3458.2035, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9303, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4388, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.8244, device='cuda:3')
clipping
cal diff is tensor(0.3972, device='cuda:3')
clipping
cal diff is tensor(546.0421, device='cuda:3')
clipping
cal diff is tensor(0.4600, device='cuda:3')
clipping
cal diff is tensor(3458.2036, device='cuda:3')
clipping
cal diff is tensor(1.9303, device='cuda:3')
clipping
cal diff is tensor(19.4388, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(4033.4509, device='cuda:3')
test acc is  0.40681666682300777
test loss is 3.44637230184795
test entropy is  0.45273799549287824
________________________________
diff is  tensor(42.4452, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3936, device='cuda:3', dtype=torch.float64)
diff is  tensor(541.2069, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4560, device='cuda:3', dtype=torch.float64)
diff is  tensor(3427.5807, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9132, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2666, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.4452, device='cuda:3')
clipping
cal diff is tensor(0.3936, device='cuda:3')
clipping
cal diff is tensor(541.2068, device='cuda:3')
clipping
cal diff is tensor(0.4560, device='cuda:3')
clipping
cal diff is tensor(3427.5808, device='cuda:3')
clipping
cal diff is tensor(1.9132, device='cuda:3')
clipping
cal diff is tensor(19.2666, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3997.4155, device='cuda:3')
test acc is  0.41723333348967456
test loss is 3.2907551671904542
test entropy is  0.45934101157605267
________________________________
diff is  tensor(42.0659, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3901, device='cuda:3', dtype=torch.float64)
diff is  tensor(536.3714, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4519, device='cuda:3', dtype=torch.float64)
diff is  tensor(3396.9568, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8961, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0945, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0659, device='cuda:3')
clipping
cal diff is tensor(0.3901, device='cuda:3')
clipping
cal diff is tensor(536.3714, device='cuda:3')
clipping
cal diff is tensor(0.4519, device='cuda:3')
clipping
cal diff is tensor(3396.9568, device='cuda:3')
clipping
cal diff is tensor(1.8961, device='cuda:3')
clipping
cal diff is tensor(19.0945, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3961.3782, device='cuda:3')
test acc is  0.4274500001563413
test loss is 3.1389660666238015
test entropy is  0.46591459831068005
________________________________
diff is  tensor(41.6867, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3866, device='cuda:3', dtype=torch.float64)
diff is  tensor(531.5358, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4478, device='cuda:3', dtype=torch.float64)
diff is  tensor(3366.3317, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8790, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.9224, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.6867, device='cuda:3')
clipping
cal diff is tensor(0.3866, device='cuda:3')
clipping
cal diff is tensor(531.5358, device='cuda:3')
clipping
cal diff is tensor(0.4478, device='cuda:3')
clipping
cal diff is tensor(3366.3315, device='cuda:3')
clipping
cal diff is tensor(1.8790, device='cuda:3')
clipping
cal diff is tensor(18.9224, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3925.3398, device='cuda:3')
test acc is  0.4383333334896748
test loss is 2.992885999842239
test entropy is  0.4722024631589206
________________________________
diff is  tensor(41.3074, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3831, device='cuda:3', dtype=torch.float64)
diff is  tensor(526.6999, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4437, device='cuda:3', dtype=torch.float64)
diff is  tensor(3335.7050, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8619, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7502, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.3074, device='cuda:3')
clipping
cal diff is tensor(0.3831, device='cuda:3')
clipping
cal diff is tensor(526.6999, device='cuda:3')
clipping
cal diff is tensor(0.4437, device='cuda:3')
clipping
cal diff is tensor(3335.7051, device='cuda:3')
clipping
cal diff is tensor(1.8619, device='cuda:3')
clipping
cal diff is tensor(18.7502, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3889.3003, device='cuda:3')
test acc is  0.44825000015634153
test loss is 2.8519428380008445
test entropy is  0.47820214558638996
________________________________
diff is  tensor(40.9282, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3796, device='cuda:3', dtype=torch.float64)
diff is  tensor(521.8639, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4397, device='cuda:3', dtype=torch.float64)
diff is  tensor(3305.0773, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8448, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5780, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.9282, device='cuda:3')
clipping
cal diff is tensor(0.3796, device='cuda:3')
clipping
cal diff is tensor(521.8639, device='cuda:3')
clipping
cal diff is tensor(0.4397, device='cuda:3')
clipping
cal diff is tensor(3305.0771, device='cuda:3')
clipping
cal diff is tensor(1.8448, device='cuda:3')
clipping
cal diff is tensor(18.5780, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3853.2583, device='cuda:3')
test acc is  0.4597166668230083
test loss is 2.716194022438928
test entropy is  0.4839418506952745
________________________________
diff is  tensor(40.5489, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3761, device='cuda:3', dtype=torch.float64)
diff is  tensor(517.0276, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4356, device='cuda:3', dtype=torch.float64)
diff is  tensor(3274.4484, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8278, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.4059, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.5489, device='cuda:3')
clipping
cal diff is tensor(0.3761, device='cuda:3')
clipping
cal diff is tensor(517.0276, device='cuda:3')
clipping
cal diff is tensor(0.4356, device='cuda:3')
clipping
cal diff is tensor(3274.4482, device='cuda:3')
clipping
cal diff is tensor(1.8278, device='cuda:3')
clipping
cal diff is tensor(18.4059, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3817.2151, device='cuda:3')
test acc is  0.4697666668230084
test loss is 2.5861228555758626
test entropy is  0.4893078308052091
________________________________
diff is  tensor(40.1696, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3725, device='cuda:3', dtype=torch.float64)
diff is  tensor(512.1911, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4315, device='cuda:3', dtype=torch.float64)
diff is  tensor(3243.8178, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8107, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2337, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.1696, device='cuda:3')
clipping
cal diff is tensor(0.3725, device='cuda:3')
clipping
cal diff is tensor(512.1912, device='cuda:3')
clipping
cal diff is tensor(0.4315, device='cuda:3')
clipping
cal diff is tensor(3243.8179, device='cuda:3')
clipping
cal diff is tensor(1.8107, device='cuda:3')
clipping
cal diff is tensor(18.2337, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3781.1704, device='cuda:3')
test acc is  0.48105000015634186
test loss is 2.4593012594719177
test entropy is  0.49439342964940997
________________________________
diff is  tensor(39.7902, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3690, device='cuda:3', dtype=torch.float64)
diff is  tensor(507.3544, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4274, device='cuda:3', dtype=torch.float64)
diff is  tensor(3213.1859, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7936, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.0615, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.7902, device='cuda:3')
clipping
cal diff is tensor(0.3690, device='cuda:3')
clipping
cal diff is tensor(507.3544, device='cuda:3')
clipping
cal diff is tensor(0.4274, device='cuda:3')
clipping
cal diff is tensor(3213.1860, device='cuda:3')
clipping
cal diff is tensor(1.7936, device='cuda:3')
clipping
cal diff is tensor(18.0615, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3745.1240, device='cuda:3')
test acc is  0.4932833334896753
test loss is 2.3377464802534598
test entropy is  0.49915671659939326
________________________________
diff is  tensor(39.4109, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3655, device='cuda:3', dtype=torch.float64)
diff is  tensor(502.5175, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4234, device='cuda:3', dtype=torch.float64)
diff is  tensor(3182.5527, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7765, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8893, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.4109, device='cuda:3')
clipping
cal diff is tensor(0.3655, device='cuda:3')
clipping
cal diff is tensor(502.5176, device='cuda:3')
clipping
cal diff is tensor(0.4234, device='cuda:3')
clipping
cal diff is tensor(3182.5527, device='cuda:3')
clipping
cal diff is tensor(1.7765, device='cuda:3')
clipping
cal diff is tensor(17.8893, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3709.0759, device='cuda:3')
test acc is  0.5055333334896754
test loss is 2.221749945235913
test entropy is  0.5033292100627793
________________________________
diff is  tensor(39.0315, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3620, device='cuda:3', dtype=torch.float64)
diff is  tensor(497.6804, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4193, device='cuda:3', dtype=torch.float64)
diff is  tensor(3151.9181, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7594, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.7171, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.0315, device='cuda:3')
clipping
cal diff is tensor(0.3620, device='cuda:3')
clipping
cal diff is tensor(497.6804, device='cuda:3')
clipping
cal diff is tensor(0.4193, device='cuda:3')
clipping
cal diff is tensor(3151.9180, device='cuda:3')
clipping
cal diff is tensor(1.7594, device='cuda:3')
clipping
cal diff is tensor(17.7171, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3673.0264, device='cuda:3')
test acc is  0.5166500001563421
test loss is 2.110098472282068
test entropy is  0.5071752535572438
________________________________
diff is  tensor(38.6521, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3585, device='cuda:3', dtype=torch.float64)
diff is  tensor(492.8430, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4152, device='cuda:3', dtype=torch.float64)
diff is  tensor(3121.2820, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7423, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.5449, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.6521, device='cuda:3')
clipping
cal diff is tensor(0.3585, device='cuda:3')
clipping
cal diff is tensor(492.8430, device='cuda:3')
clipping
cal diff is tensor(0.4152, device='cuda:3')
clipping
cal diff is tensor(3121.2822, device='cuda:3')
clipping
cal diff is tensor(1.7423, device='cuda:3')
clipping
cal diff is tensor(17.5449, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3636.9749, device='cuda:3')
test acc is  0.5292333334896756
test loss is 2.003319547120442
test entropy is  0.5104999637235202
________________________________
diff is  tensor(38.2728, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3550, device='cuda:3', dtype=torch.float64)
diff is  tensor(488.0054, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4111, device='cuda:3', dtype=torch.float64)
diff is  tensor(3090.6445, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7252, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3727, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.2728, device='cuda:3')
clipping
cal diff is tensor(0.3550, device='cuda:3')
clipping
cal diff is tensor(488.0054, device='cuda:3')
clipping
cal diff is tensor(0.4111, device='cuda:3')
clipping
cal diff is tensor(3090.6445, device='cuda:3')
clipping
cal diff is tensor(1.7252, device='cuda:3')
clipping
cal diff is tensor(17.3727, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
________________________________
test distance is  tensor(3600.9216, device='cuda:3')
test acc is  0.541866666823009
test loss is 1.900283426618271
test entropy is  0.5134108356956734
________________________________
diff is  tensor(37.8933, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3514, device='cuda:3', dtype=torch.float64)
diff is  tensor(483.1676, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4071, device='cuda:3', dtype=torch.float64)
diff is  tensor(3060.0055, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7081, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.2005, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1885, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.8933, device='cuda:3')
clipping
cal diff is tensor(0.3514, device='cuda:3')
clipping
cal diff is tensor(483.1676, device='cuda:3')
clipping
cal diff is tensor(0.4071, device='cuda:3')
clipping
cal diff is tensor(3060.0054, device='cuda:3')
clipping
cal diff is tensor(1.7081, device='cuda:3')
clipping
cal diff is tensor(17.2005, device='cuda:3')
clipping
cal diff is tensor(0.1885, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 51 global rounds:
Train Accuracy: 97.07% 

Test Accuracy: 96.87% 


 | Global Training Round : 52 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.18766821920871735
attack res is True
len of model dicts is  10
compute distance is  tensor(20.9329, device='cuda:3')
compute distance is  tensor(37.6123, device='cuda:3')
compute distance is  tensor(38.3479, device='cuda:3')
compute distance is  tensor(78.4030, device='cuda:3')
compute distance is  tensor(37.9749, device='cuda:3')
compute distance is  tensor(36.8740, device='cuda:3')
compute distance is  tensor(47.3772, device='cuda:3')
compute distance is  tensor(32.6364, device='cuda:3')
compute distance is  tensor(88.8389, device='cuda:3')
compute distance is  tensor(55.9164, device='cuda:3')
calculated distance threshold is  tensor(94.8826, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.45738333348967497
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24856666682300482
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.37853333348967416
====================
====================
iteration is  1
round is  0
accuracy is  0.3353000001563402
====================
====================
iteration is  1
round is  1
accuracy is  0.45626666682300837
====================
________________________________
test distance is  tensor(4285.0928, device='cuda:3')
test acc is  0.24856666682300482
test loss is 7.116858853968476
test entropy is  0.2265732982821429
________________________________
diff is  tensor(45.1262, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3766, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.4088, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5194, device='cuda:3', dtype=torch.float64)
diff is  tensor(3643.1071, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9843, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3341, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2363, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2363, device='cuda:3', dtype=torch.float64)
cal diff is tensor(45.1262, device='cuda:3')
clipping
cal diff is tensor(0.3766, device='cuda:3')
clipping
cal diff is tensor(573.4088, device='cuda:3')
clipping
cal diff is tensor(0.5194, device='cuda:3')
clipping
cal diff is tensor(3643.1069, device='cuda:3')
clipping
cal diff is tensor(1.9843, device='cuda:3')
clipping
cal diff is tensor(20.3341, device='cuda:3')
clipping
cal diff is tensor(0.2363, device='cuda:3')
clipping
________________________________
test distance is  tensor(4237.3862, device='cuda:3')
test acc is  0.25590000015633835
test loss is 6.79076157068647
test entropy is  0.23434114576116807
________________________________
diff is  tensor(44.6238, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3724, device='cuda:3', dtype=torch.float64)
diff is  tensor(567.0249, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5137, device='cuda:3', dtype=torch.float64)
diff is  tensor(3602.5475, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9622, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1077, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2337, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2337, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.6238, device='cuda:3')
clipping
cal diff is tensor(0.3724, device='cuda:3')
clipping
cal diff is tensor(567.0249, device='cuda:3')
clipping
cal diff is tensor(0.5137, device='cuda:3')
clipping
cal diff is tensor(3602.5474, device='cuda:3')
clipping
cal diff is tensor(1.9622, device='cuda:3')
clipping
cal diff is tensor(20.1077, device='cuda:3')
clipping
cal diff is tensor(0.2337, device='cuda:3')
clipping
________________________________
test distance is  tensor(4189.6763, device='cuda:3')
test acc is  0.2637166668230052
test loss is 6.473899874097503
test entropy is  0.24226639362604124
________________________________
diff is  tensor(44.1214, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3682, device='cuda:3', dtype=torch.float64)
diff is  tensor(560.6406, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5079, device='cuda:3', dtype=torch.float64)
diff is  tensor(3561.9855, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9401, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8813, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.1214, device='cuda:3')
clipping
cal diff is tensor(0.3682, device='cuda:3')
clipping
cal diff is tensor(560.6406, device='cuda:3')
clipping
cal diff is tensor(0.5079, device='cuda:3')
clipping
cal diff is tensor(3561.9854, device='cuda:3')
clipping
cal diff is tensor(1.9401, device='cuda:3')
clipping
cal diff is tensor(19.8813, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(4141.9658, device='cuda:3')
test acc is  0.27255000015633885
test loss is 6.1661661296511
test entropy is  0.2503165061960914
________________________________
diff is  tensor(43.6189, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3640, device='cuda:3', dtype=torch.float64)
diff is  tensor(554.2559, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5021, device='cuda:3', dtype=torch.float64)
diff is  tensor(3521.4209, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9180, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6549, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.6189, device='cuda:3')
clipping
cal diff is tensor(0.3640, device='cuda:3')
clipping
cal diff is tensor(554.2559, device='cuda:3')
clipping
cal diff is tensor(0.5021, device='cuda:3')
clipping
cal diff is tensor(3521.4209, device='cuda:3')
clipping
cal diff is tensor(1.9180, device='cuda:3')
clipping
cal diff is tensor(19.6549, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(4094.2527, device='cuda:3')
test acc is  0.28210000015633907
test loss is 5.867704385633408
test entropy is  0.25847431990319986
________________________________
diff is  tensor(43.1164, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3599, device='cuda:3', dtype=torch.float64)
diff is  tensor(547.8708, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4963, device='cuda:3', dtype=torch.float64)
diff is  tensor(3480.8536, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8959, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4284, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.1164, device='cuda:3')
clipping
cal diff is tensor(0.3599, device='cuda:3')
clipping
cal diff is tensor(547.8708, device='cuda:3')
clipping
cal diff is tensor(0.4963, device='cuda:3')
clipping
cal diff is tensor(3480.8535, device='cuda:3')
clipping
cal diff is tensor(1.8959, device='cuda:3')
clipping
cal diff is tensor(19.4284, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(4046.5359, device='cuda:3')
test acc is  0.29148333348967265
test loss is 5.580556882469893
test entropy is  0.2665997066382152
________________________________
diff is  tensor(42.6139, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3557, device='cuda:3', dtype=torch.float64)
diff is  tensor(541.4853, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4905, device='cuda:3', dtype=torch.float64)
diff is  tensor(3440.2836, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8738, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2020, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.6139, device='cuda:3')
clipping
cal diff is tensor(0.3557, device='cuda:3')
clipping
cal diff is tensor(541.4853, device='cuda:3')
clipping
cal diff is tensor(0.4905, device='cuda:3')
clipping
cal diff is tensor(3440.2837, device='cuda:3')
clipping
cal diff is tensor(1.8738, device='cuda:3')
clipping
cal diff is tensor(19.2020, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3998.8162, device='cuda:3')
test acc is  0.30150000015633954
test loss is 5.301847147280728
test entropy is  0.2747067977894725
________________________________
diff is  tensor(42.1113, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3515, device='cuda:3', dtype=torch.float64)
diff is  tensor(535.0993, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4847, device='cuda:3', dtype=torch.float64)
diff is  tensor(3399.7108, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8517, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.9755, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.1113, device='cuda:3')
clipping
cal diff is tensor(0.3515, device='cuda:3')
clipping
cal diff is tensor(535.0992, device='cuda:3')
clipping
cal diff is tensor(0.4847, device='cuda:3')
clipping
cal diff is tensor(3399.7109, device='cuda:3')
clipping
cal diff is tensor(1.8517, device='cuda:3')
clipping
cal diff is tensor(18.9755, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3951.0928, device='cuda:3')
test acc is  0.3118666668230064
test loss is 5.032398322497858
test entropy is  0.28275548372822784
________________________________
diff is  tensor(41.6087, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3473, device='cuda:3', dtype=torch.float64)
diff is  tensor(528.7129, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4790, device='cuda:3', dtype=torch.float64)
diff is  tensor(3359.1352, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8296, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.7491, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.6087, device='cuda:3')
clipping
cal diff is tensor(0.3473, device='cuda:3')
clipping
cal diff is tensor(528.7129, device='cuda:3')
clipping
cal diff is tensor(0.4790, device='cuda:3')
clipping
cal diff is tensor(3359.1353, device='cuda:3')
clipping
cal diff is tensor(1.8296, device='cuda:3')
clipping
cal diff is tensor(18.7491, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3903.3660, device='cuda:3')
test acc is  0.32415000015633993
test loss is 4.771317250438845
test entropy is  0.2907189873140504
________________________________
diff is  tensor(41.1061, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3431, device='cuda:3', dtype=torch.float64)
diff is  tensor(522.3260, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4732, device='cuda:3', dtype=torch.float64)
diff is  tensor(3318.5565, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8075, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.5226, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.1061, device='cuda:3')
clipping
cal diff is tensor(0.3431, device='cuda:3')
clipping
cal diff is tensor(522.3260, device='cuda:3')
clipping
cal diff is tensor(0.4732, device='cuda:3')
clipping
cal diff is tensor(3318.5566, device='cuda:3')
clipping
cal diff is tensor(1.8075, device='cuda:3')
clipping
cal diff is tensor(18.5226, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3855.6357, device='cuda:3')
test acc is  0.3349500001563401
test loss is 4.522886874833341
test entropy is  0.29840958448075283
________________________________
diff is  tensor(40.6034, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3389, device='cuda:3', dtype=torch.float64)
diff is  tensor(515.9386, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4674, device='cuda:3', dtype=torch.float64)
diff is  tensor(3277.9749, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7854, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2961, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.6034, device='cuda:3')
clipping
cal diff is tensor(0.3389, device='cuda:3')
clipping
cal diff is tensor(515.9386, device='cuda:3')
clipping
cal diff is tensor(0.4674, device='cuda:3')
clipping
cal diff is tensor(3277.9749, device='cuda:3')
clipping
cal diff is tensor(1.7854, device='cuda:3')
clipping
cal diff is tensor(18.2961, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3807.9016, device='cuda:3')
test acc is  0.3468833334896736
test loss is 4.280719532387089
test entropy is  0.30599496076737387
________________________________
diff is  tensor(40.1007, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3347, device='cuda:3', dtype=torch.float64)
diff is  tensor(509.5507, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4616, device='cuda:3', dtype=torch.float64)
diff is  tensor(3237.3901, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7633, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.0696, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.1007, device='cuda:3')
clipping
cal diff is tensor(0.3347, device='cuda:3')
clipping
cal diff is tensor(509.5508, device='cuda:3')
clipping
cal diff is tensor(0.4616, device='cuda:3')
clipping
cal diff is tensor(3237.3901, device='cuda:3')
clipping
cal diff is tensor(1.7633, device='cuda:3')
clipping
cal diff is tensor(18.0696, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3760.1643, device='cuda:3')
test acc is  0.3591000001563405
test loss is 4.0476345562223175
test entropy is  0.3133785787389985
________________________________
diff is  tensor(39.5979, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3305, device='cuda:3', dtype=torch.float64)
diff is  tensor(503.1624, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4558, device='cuda:3', dtype=torch.float64)
diff is  tensor(3196.8022, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7412, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8430, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.5979, device='cuda:3')
clipping
cal diff is tensor(0.3305, device='cuda:3')
clipping
cal diff is tensor(503.1624, device='cuda:3')
clipping
cal diff is tensor(0.4558, device='cuda:3')
clipping
cal diff is tensor(3196.8022, device='cuda:3')
clipping
cal diff is tensor(1.7412, device='cuda:3')
clipping
cal diff is tensor(17.8430, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3712.4224, device='cuda:3')
test acc is  0.371983333489674
test loss is 3.8250632453828985
test entropy is  0.3204614049526674
________________________________
diff is  tensor(39.0951, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3263, device='cuda:3', dtype=torch.float64)
diff is  tensor(496.7735, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4500, device='cuda:3', dtype=torch.float64)
diff is  tensor(3156.2111, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7191, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6165, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.0951, device='cuda:3')
clipping
cal diff is tensor(0.3263, device='cuda:3')
clipping
cal diff is tensor(496.7735, device='cuda:3')
clipping
cal diff is tensor(0.4500, device='cuda:3')
clipping
cal diff is tensor(3156.2109, device='cuda:3')
clipping
cal diff is tensor(1.7191, device='cuda:3')
clipping
cal diff is tensor(17.6165, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3664.6772, device='cuda:3')
test acc is  0.3856500001563409
test loss is 3.609479624706545
test entropy is  0.32740652944042736
________________________________
diff is  tensor(38.5923, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3221, device='cuda:3', dtype=torch.float64)
diff is  tensor(490.3841, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4442, device='cuda:3', dtype=torch.float64)
diff is  tensor(3115.6165, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6970, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3899, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.5923, device='cuda:3')
clipping
cal diff is tensor(0.3221, device='cuda:3')
clipping
cal diff is tensor(490.3841, device='cuda:3')
clipping
cal diff is tensor(0.4442, device='cuda:3')
clipping
cal diff is tensor(3115.6167, device='cuda:3')
clipping
cal diff is tensor(1.6970, device='cuda:3')
clipping
cal diff is tensor(17.3899, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3616.9277, device='cuda:3')
test acc is  0.3992666668230077
test loss is 3.4027479030430188
test entropy is  0.3340482163721564
________________________________
diff is  tensor(38.0894, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3179, device='cuda:3', dtype=torch.float64)
diff is  tensor(483.9942, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4384, device='cuda:3', dtype=torch.float64)
diff is  tensor(3075.0187, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6748, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.1633, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.0894, device='cuda:3')
clipping
cal diff is tensor(0.3179, device='cuda:3')
clipping
cal diff is tensor(483.9942, device='cuda:3')
clipping
cal diff is tensor(0.4384, device='cuda:3')
clipping
cal diff is tensor(3075.0186, device='cuda:3')
clipping
cal diff is tensor(1.6748, device='cuda:3')
clipping
cal diff is tensor(17.1633, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3569.1746, device='cuda:3')
test acc is  0.4131666668230079
test loss is 3.204657346963374
test entropy is  0.34045504095521306
________________________________
diff is  tensor(37.5865, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3137, device='cuda:3', dtype=torch.float64)
diff is  tensor(477.6037, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4327, device='cuda:3', dtype=torch.float64)
diff is  tensor(3034.4172, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6527, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.9367, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.5865, device='cuda:3')
clipping
cal diff is tensor(0.3137, device='cuda:3')
clipping
cal diff is tensor(477.6037, device='cuda:3')
clipping
cal diff is tensor(0.4327, device='cuda:3')
clipping
cal diff is tensor(3034.4172, device='cuda:3')
clipping
cal diff is tensor(1.6527, device='cuda:3')
clipping
cal diff is tensor(16.9367, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3521.4167, device='cuda:3')
test acc is  0.42590000015634133
test loss is 3.015168077401769
test entropy is  0.3465787073664828
________________________________
diff is  tensor(37.0836, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3095, device='cuda:3', dtype=torch.float64)
diff is  tensor(471.2127, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4269, device='cuda:3', dtype=torch.float64)
diff is  tensor(2993.8124, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6306, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.7100, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.0836, device='cuda:3')
clipping
cal diff is tensor(0.3095, device='cuda:3')
clipping
cal diff is tensor(471.2126, device='cuda:3')
clipping
cal diff is tensor(0.4269, device='cuda:3')
clipping
cal diff is tensor(2993.8123, device='cuda:3')
clipping
cal diff is tensor(1.6306, device='cuda:3')
clipping
cal diff is tensor(16.7100, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3473.6545, device='cuda:3')
test acc is  0.43940000015634145
test loss is 2.833905531780552
test entropy is  0.35250134534164784
________________________________
diff is  tensor(36.5805, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3053, device='cuda:3', dtype=torch.float64)
diff is  tensor(464.8211, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4211, device='cuda:3', dtype=torch.float64)
diff is  tensor(2953.2037, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6085, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.4834, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.5805, device='cuda:3')
clipping
cal diff is tensor(0.3053, device='cuda:3')
clipping
cal diff is tensor(464.8210, device='cuda:3')
clipping
cal diff is tensor(0.4211, device='cuda:3')
clipping
cal diff is tensor(2953.2036, device='cuda:3')
clipping
cal diff is tensor(1.6085, device='cuda:3')
clipping
cal diff is tensor(16.4834, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3425.8882, device='cuda:3')
test acc is  0.4530000001563416
test loss is 2.6596729178418483
test entropy is  0.3581971062112973
________________________________
diff is  tensor(36.0775, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3011, device='cuda:3', dtype=torch.float64)
diff is  tensor(458.4288, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4153, device='cuda:3', dtype=torch.float64)
diff is  tensor(2912.5912, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5864, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.2567, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.0775, device='cuda:3')
clipping
cal diff is tensor(0.3011, device='cuda:3')
clipping
cal diff is tensor(458.4288, device='cuda:3')
clipping
cal diff is tensor(0.4153, device='cuda:3')
clipping
cal diff is tensor(2912.5913, device='cuda:3')
clipping
cal diff is tensor(1.5864, device='cuda:3')
clipping
cal diff is tensor(16.2567, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
________________________________
test distance is  tensor(3378.1169, device='cuda:3')
test acc is  0.4675000001563417
test loss is 2.4935433296506595
test entropy is  0.36365959208720783
________________________________
diff is  tensor(35.5744, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2969, device='cuda:3', dtype=torch.float64)
diff is  tensor(452.0360, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4095, device='cuda:3', dtype=torch.float64)
diff is  tensor(2871.9748, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.5643, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.0300, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2311, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.5744, device='cuda:3')
clipping
cal diff is tensor(0.2969, device='cuda:3')
clipping
cal diff is tensor(452.0360, device='cuda:3')
clipping
cal diff is tensor(0.4095, device='cuda:3')
clipping
cal diff is tensor(2871.9749, device='cuda:3')
clipping
cal diff is tensor(1.5643, device='cuda:3')
clipping
cal diff is tensor(16.0300, device='cuda:3')
clipping
cal diff is tensor(0.2311, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 52 global rounds:
Train Accuracy: 97.11% 

Test Accuracy: 96.88% 


 | Global Training Round : 53 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.19144275784492493
attack res is True
len of model dicts is  10
compute distance is  tensor(24.8545, device='cuda:3')
compute distance is  tensor(34.7778, device='cuda:3')
compute distance is  tensor(38.0447, device='cuda:3')
compute distance is  tensor(29.4049, device='cuda:3')
compute distance is  tensor(34.4306, device='cuda:3')
compute distance is  tensor(43.9200, device='cuda:3')
compute distance is  tensor(46.1787, device='cuda:3')
compute distance is  tensor(39.9277, device='cuda:3')
compute distance is  tensor(75.4820, device='cuda:3')
compute distance is  tensor(48.3206, device='cuda:3')
calculated distance threshold is  tensor(79.9879, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.37770000015634086
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24838333348967148
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4351000001563415
====================
====================
iteration is  1
round is  0
accuracy is  0.24318333348967142
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3654166668230072
====================
________________________________
test distance is  tensor(4279.6279, device='cuda:3')
test acc is  0.24318333348967142
test loss is 6.897079002628448
test entropy is  0.26439931474006506
________________________________
diff is  tensor(43.5481, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2858, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.2527, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5135, device='cuda:3', dtype=torch.float64)
diff is  tensor(3639.5092, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9945, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3602, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1637, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1637, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.5481, device='cuda:3')
clipping
cal diff is tensor(0.2858, device='cuda:3')
clipping
cal diff is tensor(573.2527, device='cuda:3')
clipping
cal diff is tensor(0.5135, device='cuda:3')
clipping
cal diff is tensor(3639.5093, device='cuda:3')
clipping
cal diff is tensor(1.9945, device='cuda:3')
clipping
cal diff is tensor(20.3602, device='cuda:3')
clipping
cal diff is tensor(0.1637, device='cuda:3')
clipping
________________________________
test distance is  tensor(4239.4448, device='cuda:3')
test acc is  0.24733333348967154
test loss is 6.672004475014042
test entropy is  0.2678532044548216
________________________________
diff is  tensor(43.1392, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2831, device='cuda:3', dtype=torch.float64)
diff is  tensor(567.8703, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5087, device='cuda:3', dtype=torch.float64)
diff is  tensor(3605.3370, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9758, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.1690, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.1392, device='cuda:3')
clipping
cal diff is tensor(0.2831, device='cuda:3')
clipping
cal diff is tensor(567.8703, device='cuda:3')
clipping
cal diff is tensor(0.5087, device='cuda:3')
clipping
cal diff is tensor(3605.3369, device='cuda:3')
clipping
cal diff is tensor(1.9758, device='cuda:3')
clipping
cal diff is tensor(20.1690, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(4199.2627, device='cuda:3')
test acc is  0.252816666823005
test loss is 6.448805485707102
test entropy is  0.2715233142600893
________________________________
diff is  tensor(42.7303, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2805, device='cuda:3', dtype=torch.float64)
diff is  tensor(562.4876, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5039, device='cuda:3', dtype=torch.float64)
diff is  tensor(3571.1629, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9571, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.9778, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.7303, device='cuda:3')
clipping
cal diff is tensor(0.2805, device='cuda:3')
clipping
cal diff is tensor(562.4875, device='cuda:3')
clipping
cal diff is tensor(0.5039, device='cuda:3')
clipping
cal diff is tensor(3571.1628, device='cuda:3')
clipping
cal diff is tensor(1.9571, device='cuda:3')
clipping
cal diff is tensor(19.9778, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(4159.0781, device='cuda:3')
test acc is  0.2573000001563385
test loss is 6.2314819890553
test entropy is  0.2752614250537683
________________________________
diff is  tensor(42.3214, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2778, device='cuda:3', dtype=torch.float64)
diff is  tensor(557.1047, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4991, device='cuda:3', dtype=torch.float64)
diff is  tensor(3536.9877, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9383, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.7866, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.3214, device='cuda:3')
clipping
cal diff is tensor(0.2778, device='cuda:3')
clipping
cal diff is tensor(557.1047, device='cuda:3')
clipping
cal diff is tensor(0.4991, device='cuda:3')
clipping
cal diff is tensor(3536.9878, device='cuda:3')
clipping
cal diff is tensor(1.9383, device='cuda:3')
clipping
cal diff is tensor(19.7866, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(4118.8911, device='cuda:3')
test acc is  0.262283333489672
test loss is 6.017936949282567
test entropy is  0.279072865065354
________________________________
diff is  tensor(41.9125, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2751, device='cuda:3', dtype=torch.float64)
diff is  tensor(551.7216, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4943, device='cuda:3', dtype=torch.float64)
diff is  tensor(3502.8108, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9196, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.5954, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.9125, device='cuda:3')
clipping
cal diff is tensor(0.2751, device='cuda:3')
clipping
cal diff is tensor(551.7216, device='cuda:3')
clipping
cal diff is tensor(0.4943, device='cuda:3')
clipping
cal diff is tensor(3502.8110, device='cuda:3')
clipping
cal diff is tensor(1.9196, device='cuda:3')
clipping
cal diff is tensor(19.5954, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(4078.7029, device='cuda:3')
test acc is  0.2674000001563388
test loss is 5.809522859069076
test entropy is  0.2829290489429858
________________________________
diff is  tensor(41.5035, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2724, device='cuda:3', dtype=torch.float64)
diff is  tensor(546.3381, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4894, device='cuda:3', dtype=torch.float64)
diff is  tensor(3468.6321, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9009, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4042, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.5035, device='cuda:3')
clipping
cal diff is tensor(0.2724, device='cuda:3')
clipping
cal diff is tensor(546.3381, device='cuda:3')
clipping
cal diff is tensor(0.4894, device='cuda:3')
clipping
cal diff is tensor(3468.6321, device='cuda:3')
clipping
cal diff is tensor(1.9009, device='cuda:3')
clipping
cal diff is tensor(19.4042, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(4038.5127, device='cuda:3')
test acc is  0.2729500001563389
test loss is 5.603480355826014
test entropy is  0.28698563869637467
________________________________
diff is  tensor(41.0945, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2697, device='cuda:3', dtype=torch.float64)
diff is  tensor(540.9545, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4846, device='cuda:3', dtype=torch.float64)
diff is  tensor(3434.4519, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8821, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2130, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.0945, device='cuda:3')
clipping
cal diff is tensor(0.2697, device='cuda:3')
clipping
cal diff is tensor(540.9545, device='cuda:3')
clipping
cal diff is tensor(0.4846, device='cuda:3')
clipping
cal diff is tensor(3434.4517, device='cuda:3')
clipping
cal diff is tensor(1.8821, device='cuda:3')
clipping
cal diff is tensor(19.2130, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3998.3203, device='cuda:3')
test acc is  0.27911666682300573
test loss is 5.402105650159596
test entropy is  0.29115527051725365
________________________________
diff is  tensor(40.6855, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2670, device='cuda:3', dtype=torch.float64)
diff is  tensor(535.5706, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4798, device='cuda:3', dtype=torch.float64)
diff is  tensor(3400.2700, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8634, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0218, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.6855, device='cuda:3')
clipping
cal diff is tensor(0.2670, device='cuda:3')
clipping
cal diff is tensor(535.5706, device='cuda:3')
clipping
cal diff is tensor(0.4798, device='cuda:3')
clipping
cal diff is tensor(3400.2700, device='cuda:3')
clipping
cal diff is tensor(1.8634, device='cuda:3')
clipping
cal diff is tensor(19.0218, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3958.1260, device='cuda:3')
test acc is  0.2846833334896725
test loss is 5.206657394925669
test entropy is  0.2953503129165818
________________________________
diff is  tensor(40.2765, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2644, device='cuda:3', dtype=torch.float64)
diff is  tensor(530.1864, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4750, device='cuda:3', dtype=torch.float64)
diff is  tensor(3366.0864, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8447, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.8306, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.2765, device='cuda:3')
clipping
cal diff is tensor(0.2644, device='cuda:3')
clipping
cal diff is tensor(530.1863, device='cuda:3')
clipping
cal diff is tensor(0.4750, device='cuda:3')
clipping
cal diff is tensor(3366.0864, device='cuda:3')
clipping
cal diff is tensor(1.8447, device='cuda:3')
clipping
cal diff is tensor(18.8306, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3917.9294, device='cuda:3')
test acc is  0.291316666823006
test loss is 5.015768657106834
test entropy is  0.2996404459163832
________________________________
diff is  tensor(39.8675, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2617, device='cuda:3', dtype=torch.float64)
diff is  tensor(524.8019, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4701, device='cuda:3', dtype=torch.float64)
diff is  tensor(3331.9010, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8259, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.6393, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.8675, device='cuda:3')
clipping
cal diff is tensor(0.2617, device='cuda:3')
clipping
cal diff is tensor(524.8019, device='cuda:3')
clipping
cal diff is tensor(0.4701, device='cuda:3')
clipping
cal diff is tensor(3331.9009, device='cuda:3')
clipping
cal diff is tensor(1.8259, device='cuda:3')
clipping
cal diff is tensor(18.6393, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3877.7310, device='cuda:3')
test acc is  0.2976000001563395
test loss is 4.826595148043846
test entropy is  0.3042661340029509
________________________________
diff is  tensor(39.4584, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2590, device='cuda:3', dtype=torch.float64)
diff is  tensor(519.4171, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4653, device='cuda:3', dtype=torch.float64)
diff is  tensor(3297.7138, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8072, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.4481, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.4584, device='cuda:3')
clipping
cal diff is tensor(0.2590, device='cuda:3')
clipping
cal diff is tensor(519.4171, device='cuda:3')
clipping
cal diff is tensor(0.4653, device='cuda:3')
clipping
cal diff is tensor(3297.7136, device='cuda:3')
clipping
cal diff is tensor(1.8072, device='cuda:3')
clipping
cal diff is tensor(18.4481, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3837.5308, device='cuda:3')
test acc is  0.304583333489673
test loss is 4.641291577932932
test entropy is  0.3089644991989329
________________________________
diff is  tensor(39.0493, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2563, device='cuda:3', dtype=torch.float64)
diff is  tensor(514.0320, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4605, device='cuda:3', dtype=torch.float64)
diff is  tensor(3263.5247, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7885, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2568, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.0493, device='cuda:3')
clipping
cal diff is tensor(0.2563, device='cuda:3')
clipping
cal diff is tensor(514.0320, device='cuda:3')
clipping
cal diff is tensor(0.4605, device='cuda:3')
clipping
cal diff is tensor(3263.5247, device='cuda:3')
clipping
cal diff is tensor(1.7885, device='cuda:3')
clipping
cal diff is tensor(18.2568, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3797.3276, device='cuda:3')
test acc is  0.31051666682300644
test loss is 4.460973970671453
test entropy is  0.3139313564244618
________________________________
diff is  tensor(38.6402, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2536, device='cuda:3', dtype=torch.float64)
diff is  tensor(508.6467, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4557, device='cuda:3', dtype=torch.float64)
diff is  tensor(3229.3341, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7697, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.0656, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.6402, device='cuda:3')
clipping
cal diff is tensor(0.2536, device='cuda:3')
clipping
cal diff is tensor(508.6467, device='cuda:3')
clipping
cal diff is tensor(0.4557, device='cuda:3')
clipping
cal diff is tensor(3229.3340, device='cuda:3')
clipping
cal diff is tensor(1.7697, device='cuda:3')
clipping
cal diff is tensor(18.0656, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3757.1228, device='cuda:3')
test acc is  0.3171166668230065
test loss is 4.2842981388319785
test entropy is  0.3191470121428656
________________________________
diff is  tensor(38.2311, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2509, device='cuda:3', dtype=torch.float64)
diff is  tensor(503.2611, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4508, device='cuda:3', dtype=torch.float64)
diff is  tensor(3195.1412, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7510, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8743, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.2311, device='cuda:3')
clipping
cal diff is tensor(0.2509, device='cuda:3')
clipping
cal diff is tensor(503.2611, device='cuda:3')
clipping
cal diff is tensor(0.4508, device='cuda:3')
clipping
cal diff is tensor(3195.1414, device='cuda:3')
clipping
cal diff is tensor(1.7510, device='cuda:3')
clipping
cal diff is tensor(17.8743, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3716.9155, device='cuda:3')
test acc is  0.3229833334896733
test loss is 4.111213793632572
test entropy is  0.324654091221056
________________________________
diff is  tensor(37.8219, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2482, device='cuda:3', dtype=torch.float64)
diff is  tensor(497.8752, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4460, device='cuda:3', dtype=torch.float64)
diff is  tensor(3160.9466, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7323, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6830, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.8219, device='cuda:3')
clipping
cal diff is tensor(0.2482, device='cuda:3')
clipping
cal diff is tensor(497.8751, device='cuda:3')
clipping
cal diff is tensor(0.4460, device='cuda:3')
clipping
cal diff is tensor(3160.9465, device='cuda:3')
clipping
cal diff is tensor(1.7323, device='cuda:3')
clipping
cal diff is tensor(17.6830, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3676.7061, device='cuda:3')
test acc is  0.3303333334896734
test loss is 3.9417205278807357
test entropy is  0.3304168985469509
________________________________
diff is  tensor(37.4128, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2456, device='cuda:3', dtype=torch.float64)
diff is  tensor(492.4889, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4412, device='cuda:3', dtype=torch.float64)
diff is  tensor(3126.7500, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7135, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.4917, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.4128, device='cuda:3')
clipping
cal diff is tensor(0.2456, device='cuda:3')
clipping
cal diff is tensor(492.4889, device='cuda:3')
clipping
cal diff is tensor(0.4412, device='cuda:3')
clipping
cal diff is tensor(3126.7500, device='cuda:3')
clipping
cal diff is tensor(1.7135, device='cuda:3')
clipping
cal diff is tensor(17.4917, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3636.4937, device='cuda:3')
test acc is  0.33761666682300684
test loss is 3.7757160236586387
test entropy is  0.33653449422832743
________________________________
diff is  tensor(37.0036, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2429, device='cuda:3', dtype=torch.float64)
diff is  tensor(487.1023, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4364, device='cuda:3', dtype=torch.float64)
diff is  tensor(3092.5514, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6948, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.3004, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.0036, device='cuda:3')
clipping
cal diff is tensor(0.2429, device='cuda:3')
clipping
cal diff is tensor(487.1024, device='cuda:3')
clipping
cal diff is tensor(0.4364, device='cuda:3')
clipping
cal diff is tensor(3092.5513, device='cuda:3')
clipping
cal diff is tensor(1.6948, device='cuda:3')
clipping
cal diff is tensor(17.3004, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3596.2793, device='cuda:3')
test acc is  0.345166666823007
test loss is 3.615039302596151
test entropy is  0.34279733209976
________________________________
diff is  tensor(36.5943, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2402, device='cuda:3', dtype=torch.float64)
diff is  tensor(481.7154, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4315, device='cuda:3', dtype=torch.float64)
diff is  tensor(3058.3505, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6760, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.1090, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.5943, device='cuda:3')
clipping
cal diff is tensor(0.2402, device='cuda:3')
clipping
cal diff is tensor(481.7154, device='cuda:3')
clipping
cal diff is tensor(0.4315, device='cuda:3')
clipping
cal diff is tensor(3058.3506, device='cuda:3')
clipping
cal diff is tensor(1.6760, device='cuda:3')
clipping
cal diff is tensor(17.1090, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3556.0625, device='cuda:3')
test acc is  0.3522666668230071
test loss is 3.458167859486171
test entropy is  0.34934000210213
________________________________
diff is  tensor(36.1851, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2375, device='cuda:3', dtype=torch.float64)
diff is  tensor(476.3282, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4267, device='cuda:3', dtype=torch.float64)
diff is  tensor(3024.1476, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6573, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.9177, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.1851, device='cuda:3')
clipping
cal diff is tensor(0.2375, device='cuda:3')
clipping
cal diff is tensor(476.3282, device='cuda:3')
clipping
cal diff is tensor(0.4267, device='cuda:3')
clipping
cal diff is tensor(3024.1477, device='cuda:3')
clipping
cal diff is tensor(1.6573, device='cuda:3')
clipping
cal diff is tensor(16.9177, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
________________________________
test distance is  tensor(3515.8428, device='cuda:3')
test acc is  0.36026666682300723
test loss is 3.304389301393586
test entropy is  0.35611812331910325
________________________________
diff is  tensor(35.7758, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2348, device='cuda:3', dtype=torch.float64)
diff is  tensor(470.9406, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4219, device='cuda:3', dtype=torch.float64)
diff is  tensor(2989.9427, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6385, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.7264, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.1622, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.7758, device='cuda:3')
clipping
cal diff is tensor(0.2348, device='cuda:3')
clipping
cal diff is tensor(470.9406, device='cuda:3')
clipping
cal diff is tensor(0.4219, device='cuda:3')
clipping
cal diff is tensor(2989.9429, device='cuda:3')
clipping
cal diff is tensor(1.6385, device='cuda:3')
clipping
cal diff is tensor(16.7264, device='cuda:3')
clipping
cal diff is tensor(0.1622, device='cuda:3')
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 53 global rounds:
Train Accuracy: 97.08% 

Test Accuracy: 96.85% 


 | Global Training Round : 54 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.1996052861213684
attack res is True
len of model dicts is  10
compute distance is  tensor(22.9338, device='cuda:3')
compute distance is  tensor(39.6543, device='cuda:3')
compute distance is  tensor(42.5739, device='cuda:3')
compute distance is  tensor(29.1532, device='cuda:3')
compute distance is  tensor(38.5743, device='cuda:3')
compute distance is  tensor(33.2443, device='cuda:3')
compute distance is  tensor(52.0730, device='cuda:3')
compute distance is  tensor(32.3582, device='cuda:3')
compute distance is  tensor(77.1589, device='cuda:3')
compute distance is  tensor(78.9370, device='cuda:3')
calculated distance threshold is  tensor(83.9212, device='cuda:3')
pinned_accuracy threshold is  0.8236000001570007
====================
iteration is  0
round is  0
accuracy is  0.36130000015634056
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34776666682300705
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.2335000001563377
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.35048333348967364
====================
====================
iteration is  1
round is  1
accuracy is  0.4268500001563414
====================
________________________________
test distance is  tensor(4277.8853, device='cuda:3')
test acc is  0.2335000001563377
test loss is 5.301308456006081
test entropy is  0.32766113590711216
________________________________
diff is  tensor(43.2941, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3360, device='cuda:3', dtype=torch.float64)
diff is  tensor(570.2337, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5128, device='cuda:3', dtype=torch.float64)
diff is  tensor(3640.9483, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0329, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2998, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.2941, device='cuda:3')
clipping
cal diff is tensor(0.3360, device='cuda:3')
clipping
cal diff is tensor(570.2336, device='cuda:3')
clipping
cal diff is tensor(0.5128, device='cuda:3')
clipping
cal diff is tensor(3640.9482, device='cuda:3')
clipping
cal diff is tensor(2.0329, device='cuda:3')
clipping
cal diff is tensor(20.2998, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(4235.7188, device='cuda:3')
test acc is  0.242550000156338
test loss is 5.070168745543149
test entropy is  0.3358842923379402
________________________________
diff is  tensor(42.8673, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3326, device='cuda:3', dtype=torch.float64)
diff is  tensor(564.6126, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5077, device='cuda:3', dtype=torch.float64)
diff is  tensor(3605.0579, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0129, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.0997, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.8673, device='cuda:3')
clipping
cal diff is tensor(0.3326, device='cuda:3')
clipping
cal diff is tensor(564.6126, device='cuda:3')
clipping
cal diff is tensor(0.5077, device='cuda:3')
clipping
cal diff is tensor(3605.0579, device='cuda:3')
clipping
cal diff is tensor(2.0129, device='cuda:3')
clipping
cal diff is tensor(20.0997, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(4193.5498, device='cuda:3')
test acc is  0.2532000001563383
test loss is 4.844421042053939
test entropy is  0.3443147442075235
________________________________
diff is  tensor(42.4405, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3293, device='cuda:3', dtype=torch.float64)
diff is  tensor(558.9913, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5027, device='cuda:3', dtype=torch.float64)
diff is  tensor(3569.1658, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9928, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.8996, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.4405, device='cuda:3')
clipping
cal diff is tensor(0.3293, device='cuda:3')
clipping
cal diff is tensor(558.9913, device='cuda:3')
clipping
cal diff is tensor(0.5027, device='cuda:3')
clipping
cal diff is tensor(3569.1658, device='cuda:3')
clipping
cal diff is tensor(1.9928, device='cuda:3')
clipping
cal diff is tensor(19.8996, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(4151.3789, device='cuda:3')
test acc is  0.262783333489672
test loss is 4.626413643233049
test entropy is  0.3526245011672028
________________________________
diff is  tensor(42.0137, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3260, device='cuda:3', dtype=torch.float64)
diff is  tensor(553.3697, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4976, device='cuda:3', dtype=torch.float64)
diff is  tensor(3533.2718, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9728, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.6995, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.0137, device='cuda:3')
clipping
cal diff is tensor(0.3260, device='cuda:3')
clipping
cal diff is tensor(553.3697, device='cuda:3')
clipping
cal diff is tensor(0.4976, device='cuda:3')
clipping
cal diff is tensor(3533.2717, device='cuda:3')
clipping
cal diff is tensor(1.9728, device='cuda:3')
clipping
cal diff is tensor(19.6995, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(4109.2065, device='cuda:3')
test acc is  0.27328333348967226
test loss is 4.4145304264544425
test entropy is  0.36110570208667947
________________________________
diff is  tensor(41.5869, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3227, device='cuda:3', dtype=torch.float64)
diff is  tensor(547.7478, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4925, device='cuda:3', dtype=torch.float64)
diff is  tensor(3497.3761, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9527, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.4993, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.5869, device='cuda:3')
clipping
cal diff is tensor(0.3227, device='cuda:3')
clipping
cal diff is tensor(547.7478, device='cuda:3')
clipping
cal diff is tensor(0.4925, device='cuda:3')
clipping
cal diff is tensor(3497.3760, device='cuda:3')
clipping
cal diff is tensor(1.9527, device='cuda:3')
clipping
cal diff is tensor(19.4993, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(4067.0317, device='cuda:3')
test acc is  0.28426666682300583
test loss is 4.213280724309909
test entropy is  0.3692083988330766
________________________________
diff is  tensor(41.1600, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3194, device='cuda:3', dtype=torch.float64)
diff is  tensor(542.1257, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4875, device='cuda:3', dtype=torch.float64)
diff is  tensor(3461.4788, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9327, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.2992, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(41.1600, device='cuda:3')
clipping
cal diff is tensor(0.3194, device='cuda:3')
clipping
cal diff is tensor(542.1257, device='cuda:3')
clipping
cal diff is tensor(0.4875, device='cuda:3')
clipping
cal diff is tensor(3461.4790, device='cuda:3')
clipping
cal diff is tensor(1.9327, device='cuda:3')
clipping
cal diff is tensor(19.2992, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(4024.8547, device='cuda:3')
test acc is  0.2953333334896727
test loss is 4.014674889253401
test entropy is  0.3775757430458882
________________________________
diff is  tensor(40.7331, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3161, device='cuda:3', dtype=torch.float64)
diff is  tensor(536.5033, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4824, device='cuda:3', dtype=torch.float64)
diff is  tensor(3425.5796, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9127, device='cuda:3', dtype=torch.float64)
diff is  tensor(19.0990, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.7331, device='cuda:3')
clipping
cal diff is tensor(0.3161, device='cuda:3')
clipping
cal diff is tensor(536.5033, device='cuda:3')
clipping
cal diff is tensor(0.4824, device='cuda:3')
clipping
cal diff is tensor(3425.5796, device='cuda:3')
clipping
cal diff is tensor(1.9127, device='cuda:3')
clipping
cal diff is tensor(19.0990, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3982.6755, device='cuda:3')
test acc is  0.307833333489673
test loss is 3.824612277657238
test entropy is  0.38555610762920967
________________________________
diff is  tensor(40.3062, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3128, device='cuda:3', dtype=torch.float64)
diff is  tensor(530.8806, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4774, device='cuda:3', dtype=torch.float64)
diff is  tensor(3389.6784, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8926, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.8989, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(40.3062, device='cuda:3')
clipping
cal diff is tensor(0.3128, device='cuda:3')
clipping
cal diff is tensor(530.8806, device='cuda:3')
clipping
cal diff is tensor(0.4774, device='cuda:3')
clipping
cal diff is tensor(3389.6785, device='cuda:3')
clipping
cal diff is tensor(1.8926, device='cuda:3')
clipping
cal diff is tensor(18.8989, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3940.4939, device='cuda:3')
test acc is  0.32121666682300654
test loss is 3.640755416996189
test entropy is  0.3933908475646332
________________________________
diff is  tensor(39.8793, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3095, device='cuda:3', dtype=torch.float64)
diff is  tensor(525.2576, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4723, device='cuda:3', dtype=torch.float64)
diff is  tensor(3353.7754, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8726, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.6987, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.8793, device='cuda:3')
clipping
cal diff is tensor(0.3095, device='cuda:3')
clipping
cal diff is tensor(525.2576, device='cuda:3')
clipping
cal diff is tensor(0.4723, device='cuda:3')
clipping
cal diff is tensor(3353.7754, device='cuda:3')
clipping
cal diff is tensor(1.8726, device='cuda:3')
clipping
cal diff is tensor(18.6987, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3898.3101, device='cuda:3')
test acc is  0.33406666682300673
test loss is 3.4650879300225266
test entropy is  0.40078469529462013
________________________________
diff is  tensor(39.4524, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3061, device='cuda:3', dtype=torch.float64)
diff is  tensor(519.6342, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4673, device='cuda:3', dtype=torch.float64)
diff is  tensor(3317.8702, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8525, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.4985, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.4524, device='cuda:3')
clipping
cal diff is tensor(0.3061, device='cuda:3')
clipping
cal diff is tensor(519.6342, device='cuda:3')
clipping
cal diff is tensor(0.4673, device='cuda:3')
clipping
cal diff is tensor(3317.8701, device='cuda:3')
clipping
cal diff is tensor(1.8525, device='cuda:3')
clipping
cal diff is tensor(18.4985, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3856.1235, device='cuda:3')
test acc is  0.34723333348967367
test loss is 3.295451297180485
test entropy is  0.4078567651416193
________________________________
diff is  tensor(39.0254, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3028, device='cuda:3', dtype=torch.float64)
diff is  tensor(514.0106, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4622, device='cuda:3', dtype=torch.float64)
diff is  tensor(3281.9631, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8325, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.2983, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(39.0254, device='cuda:3')
clipping
cal diff is tensor(0.3028, device='cuda:3')
clipping
cal diff is tensor(514.0106, device='cuda:3')
clipping
cal diff is tensor(0.4622, device='cuda:3')
clipping
cal diff is tensor(3281.9631, device='cuda:3')
clipping
cal diff is tensor(1.8325, device='cuda:3')
clipping
cal diff is tensor(18.2983, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3813.9346, device='cuda:3')
test acc is  0.3612666668230072
test loss is 3.1313105501345735
test entropy is  0.4147386287988376
________________________________
diff is  tensor(38.5984, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2995, device='cuda:3', dtype=torch.float64)
diff is  tensor(508.3866, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4572, device='cuda:3', dtype=torch.float64)
diff is  tensor(3246.0538, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.8124, device='cuda:3', dtype=torch.float64)
diff is  tensor(18.0981, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.5984, device='cuda:3')
clipping
cal diff is tensor(0.2995, device='cuda:3')
clipping
cal diff is tensor(508.3866, device='cuda:3')
clipping
cal diff is tensor(0.4572, device='cuda:3')
clipping
cal diff is tensor(3246.0537, device='cuda:3')
clipping
cal diff is tensor(1.8124, device='cuda:3')
clipping
cal diff is tensor(18.0981, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3771.7432, device='cuda:3')
test acc is  0.3754500001563407
test loss is 2.974697724461301
test entropy is  0.42111377322724636
________________________________
diff is  tensor(38.1714, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2962, device='cuda:3', dtype=torch.float64)
diff is  tensor(502.7622, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4521, device='cuda:3', dtype=torch.float64)
diff is  tensor(3210.1423, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7924, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.8979, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(38.1714, device='cuda:3')
clipping
cal diff is tensor(0.2962, device='cuda:3')
clipping
cal diff is tensor(502.7622, device='cuda:3')
clipping
cal diff is tensor(0.4521, device='cuda:3')
clipping
cal diff is tensor(3210.1423, device='cuda:3')
clipping
cal diff is tensor(1.7924, device='cuda:3')
clipping
cal diff is tensor(17.8979, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3729.5488, device='cuda:3')
test acc is  0.39005000015634095
test loss is 2.823554691094071
test entropy is  0.4271195939481894
________________________________
diff is  tensor(37.7444, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2929, device='cuda:3', dtype=torch.float64)
diff is  tensor(497.1375, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4470, device='cuda:3', dtype=torch.float64)
diff is  tensor(3174.2286, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7723, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.6976, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.7444, device='cuda:3')
clipping
cal diff is tensor(0.2929, device='cuda:3')
clipping
cal diff is tensor(497.1375, device='cuda:3')
clipping
cal diff is tensor(0.4470, device='cuda:3')
clipping
cal diff is tensor(3174.2288, device='cuda:3')
clipping
cal diff is tensor(1.7723, device='cuda:3')
clipping
cal diff is tensor(17.6976, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3687.3518, device='cuda:3')
test acc is  0.40481666682300776
test loss is 2.678903600935743
test entropy is  0.4328125404523634
________________________________
diff is  tensor(37.3173, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2896, device='cuda:3', dtype=torch.float64)
diff is  tensor(491.5125, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4420, device='cuda:3', dtype=torch.float64)
diff is  tensor(3138.3125, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7523, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.4974, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(37.3173, device='cuda:3')
clipping
cal diff is tensor(0.2896, device='cuda:3')
clipping
cal diff is tensor(491.5125, device='cuda:3')
clipping
cal diff is tensor(0.4420, device='cuda:3')
clipping
cal diff is tensor(3138.3125, device='cuda:3')
clipping
cal diff is tensor(1.7523, device='cuda:3')
clipping
cal diff is tensor(17.4974, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3645.1523, device='cuda:3')
test acc is  0.41865000015634124
test loss is 2.5397937713401406
test entropy is  0.43812905560170157
________________________________
diff is  tensor(36.8902, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2863, device='cuda:3', dtype=torch.float64)
diff is  tensor(485.8870, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4369, device='cuda:3', dtype=torch.float64)
diff is  tensor(3102.3941, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7322, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.2971, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.8902, device='cuda:3')
clipping
cal diff is tensor(0.2863, device='cuda:3')
clipping
cal diff is tensor(485.8870, device='cuda:3')
clipping
cal diff is tensor(0.4369, device='cuda:3')
clipping
cal diff is tensor(3102.3940, device='cuda:3')
clipping
cal diff is tensor(1.7322, device='cuda:3')
clipping
cal diff is tensor(17.2971, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3602.9502, device='cuda:3')
test acc is  0.4335166668230081
test loss is 2.4071213919470815
test entropy is  0.44296904476975074
________________________________
diff is  tensor(36.4631, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2829, device='cuda:3', dtype=torch.float64)
diff is  tensor(480.2612, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4319, device='cuda:3', dtype=torch.float64)
diff is  tensor(3066.4733, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.7122, device='cuda:3', dtype=torch.float64)
diff is  tensor(17.0969, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.4631, device='cuda:3')
clipping
cal diff is tensor(0.2829, device='cuda:3')
clipping
cal diff is tensor(480.2612, device='cuda:3')
clipping
cal diff is tensor(0.4319, device='cuda:3')
clipping
cal diff is tensor(3066.4734, device='cuda:3')
clipping
cal diff is tensor(1.7122, device='cuda:3')
clipping
cal diff is tensor(17.0969, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3560.7449, device='cuda:3')
test acc is  0.4479333334896749
test loss is 2.2800591399928907
test entropy is  0.44754907997178117
________________________________
diff is  tensor(36.0359, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2796, device='cuda:3', dtype=torch.float64)
diff is  tensor(474.6351, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4268, device='cuda:3', dtype=torch.float64)
diff is  tensor(3030.5502, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6921, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.8966, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(36.0359, device='cuda:3')
clipping
cal diff is tensor(0.2796, device='cuda:3')
clipping
cal diff is tensor(474.6351, device='cuda:3')
clipping
cal diff is tensor(0.4268, device='cuda:3')
clipping
cal diff is tensor(3030.5503, device='cuda:3')
clipping
cal diff is tensor(1.6921, device='cuda:3')
clipping
cal diff is tensor(16.8966, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3518.5369, device='cuda:3')
test acc is  0.46331666682300837
test loss is 2.158746684792199
test entropy is  0.45166628018243987
________________________________
diff is  tensor(35.6087, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2763, device='cuda:3', dtype=torch.float64)
diff is  tensor(469.0085, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4217, device='cuda:3', dtype=torch.float64)
diff is  tensor(2994.6246, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6720, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.6963, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
cal diff is tensor(35.6087, device='cuda:3')
clipping
cal diff is tensor(0.2763, device='cuda:3')
clipping
cal diff is tensor(469.0085, device='cuda:3')
clipping
cal diff is tensor(0.4217, device='cuda:3')
clipping
cal diff is tensor(2994.6245, device='cuda:3')
clipping
cal diff is tensor(1.6720, device='cuda:3')
clipping
cal diff is tensor(16.6963, device='cuda:3')
clipping
cal diff is tensor(0.2288, device='cuda:3')
________________________________
test distance is  tensor(3476.3254, device='cuda:3')
test acc is  0.4781666668230085
test loss is 2.0418026908628466
test entropy is  0.45548467045780944
________________________________
diff is  tensor(35.1815, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2730, device='cuda:3', dtype=torch.float64)
diff is  tensor(463.3816, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4167, device='cuda:3', dtype=torch.float64)
diff is  tensor(2958.6964, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.6520, device='cuda:3', dtype=torch.float64)
diff is  tensor(16.4960, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2288, device='cuda:3', dtype=torch.float64)
threshold is  tensor(0.2288, device='cuda:3', dtype=torch.float64)