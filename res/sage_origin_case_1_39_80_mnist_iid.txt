
Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 80

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 80

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3

Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 80

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
 benign loss is  0.32441362405293866
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 96.33% 

Test Accuracy: 96.63% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.12609468400478363
 benign empirical indicaor res is  0.12609468400478363
 benign loss is  0.18737351168927394
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 97.38% 

Test Accuracy: 97.69% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.030494142323732376
 benign empirical indicaor res is  0.030494142323732376
 benign loss is  0.1249630082594721
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 97.81% 

Test Accuracy: 97.98% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.008278383873403072
 benign empirical indicaor res is  0.008278383873403072
 benign loss is  0.1064890334872823
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 98.00% 

Test Accuracy: 98.14% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.00809679739177227
 benign empirical indicaor res is  0.00809679739177227
 benign loss is  0.11629932850452238
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 98.10% 

Test Accuracy: 98.27% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.004944548010826111
 benign empirical indicaor res is  0.004944548010826111
 benign loss is  0.12929318639400758
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 98.32% 

Test Accuracy: 98.46% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.013167097233235836
 benign empirical indicaor res is  0.013167097233235836
 benign loss is  0.10370686464011669
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 98.39% 

Test Accuracy: 98.68% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.011727316305041313
 benign empirical indicaor res is  0.011727316305041313
 benign loss is  0.08538627239728444
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 98.54% 

Test Accuracy: 98.75% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.004867568612098694
 benign empirical indicaor res is  0.004867568612098694
 benign loss is  0.06603338696846836
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 98.57% 

Test Accuracy: 98.77% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.005644914228469133
 benign empirical indicaor res is  0.005644914228469133
 benign loss is  0.05088837991474735
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 98.63% 

Test Accuracy: 98.80% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.003989723511040211
 benign empirical indicaor res is  0.003989723511040211
 benign loss is  0.05982314002406048
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 98.67% 

Test Accuracy: 98.89% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.007236822508275509
 benign empirical indicaor res is  0.007236822508275509
 benign loss is  0.05679750270945461
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 98.69% 

Test Accuracy: 98.91% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0023158248513936996
 benign empirical indicaor res is  0.0023158248513936996
 benign loss is  0.0664612385689428
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 98.67% 

Test Accuracy: 98.96% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.006157420109957457
 benign empirical indicaor res is  0.006157420109957457
 benign loss is  0.03619076318940834
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 98.77% 

Test Accuracy: 98.93% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.004838764667510986
 benign empirical indicaor res is  0.004838764667510986
 benign loss is  0.03958153808611984
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 98.76% 

Test Accuracy: 99.00% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0014026559656485915
 benign empirical indicaor res is  0.0014026559656485915
 benign loss is  0.05989776423053914
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 98.77% 

Test Accuracy: 99.04% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0018168550450354815
 benign empirical indicaor res is  0.0018168550450354815
 benign loss is  0.05470823639954783
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 98.81% 

Test Accuracy: 99.05% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0023410425055772066
 benign empirical indicaor res is  0.0023410425055772066
 benign loss is  0.056662937307632284
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 98.81% 

Test Accuracy: 99.04% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0020967230666428804
 benign empirical indicaor res is  0.0020967230666428804
 benign loss is  0.05826683742557898
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 98.82% 

Test Accuracy: 99.10% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0023305860813707113
 benign empirical indicaor res is  0.0023305860813707113
 benign loss is  0.06004155327345392
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 98.84% 

Test Accuracy: 99.06% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.001549195614643395
 benign empirical indicaor res is  0.001549195614643395
 benign loss is  0.03840145750253118
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 98.84% 

Test Accuracy: 99.11% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.001753750373609364
 benign empirical indicaor res is  0.001753750373609364
 benign loss is  0.02804294812621696
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 98.84% 

Test Accuracy: 99.12% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0020061524119228125
 benign empirical indicaor res is  0.0020061524119228125
 benign loss is  0.04546051223664299
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 98.87% 

Test Accuracy: 99.14% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0019167102873325348
 benign empirical indicaor res is  0.0019167102873325348
 benign loss is  0.037189634169886916
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 98.85% 

Test Accuracy: 99.17% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0012967116199433804
 benign empirical indicaor res is  0.0012967116199433804
 benign loss is  0.042491729262493255
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 98.85% 

Test Accuracy: 99.18% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0011775955790653825
 benign empirical indicaor res is  0.0011775955790653825
 benign loss is  0.042228838157729785
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 98.87% 

Test Accuracy: 99.12% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0020679417066276073
 benign empirical indicaor res is  0.0020679417066276073
 benign loss is  0.02883925992615619
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 98.87% 

Test Accuracy: 99.15% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0013547984417527914
 benign empirical indicaor res is  0.0013547984417527914
 benign loss is  0.03306659656089706
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 98.92% 

Test Accuracy: 99.14% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0013876130105927587
 benign empirical indicaor res is  0.0013876130105927587
 benign loss is  0.04272023944251582
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 98.88% 

Test Accuracy: 99.17% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0013552024029195309
 benign empirical indicaor res is  0.0013552024029195309
 benign loss is  0.03140968303935216
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 98.92% 

Test Accuracy: 99.19% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0011159054702147841
 benign empirical indicaor res is  0.0011159054702147841
 benign loss is  0.03463473333517628
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 98.92% 

Test Accuracy: 99.20% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0007021907949820161
 benign empirical indicaor res is  0.0007021907949820161
 benign loss is  0.03308386143793254
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 98.93% 

Test Accuracy: 99.18% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0008239628514274955
 benign empirical indicaor res is  0.0008239628514274955
 benign loss is  0.04470298653407218
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 98.92% 

Test Accuracy: 99.18% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0006852379883639514
 benign empirical indicaor res is  0.0006852379883639514
 benign loss is  0.028537826353146414
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 98.93% 

Test Accuracy: 99.18% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0007624291465617716
 benign empirical indicaor res is  0.0007624291465617716
 benign loss is  0.03750743167965036
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 98.95% 

Test Accuracy: 99.19% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.000569840194657445
 benign empirical indicaor res is  0.000569840194657445
 benign loss is  0.031123074247022344
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 98.95% 

Test Accuracy: 99.22% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0007670965860597789
 benign empirical indicaor res is  0.0007670965860597789
 benign loss is  0.03132739985870246
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 98.96% 

Test Accuracy: 99.22% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.000570772506762296
 benign empirical indicaor res is  0.000570772506762296
 benign loss is  0.024914183699844505
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 98.95% 

Test Accuracy: 99.22% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0006838394328951836
 benign empirical indicaor res is  0.0006838394328951836
 benign loss is  0.025428838472036756
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 98.96% 

Test Accuracy: 99.21% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0005904518184252083
 benign empirical indicaor res is  0.0005904518184252083
 benign loss is  0.030644824048259148
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.21% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
poisoned accuracy threshold is  0.8421000001570009
distance ratio is <class 'float'>
len of model dicts is  10
compute distance is  tensor(13.2175, device='cuda:2')
compute distance is  tensor(61.4999, device='cuda:2')
compute distance is  tensor(44.4569, device='cuda:2')
compute distance is  tensor(77.4796, device='cuda:2')
compute distance is  tensor(26.1459, device='cuda:2')
compute distance is  tensor(68.9716, device='cuda:2')
compute distance is  tensor(48.9134, device='cuda:2')
compute distance is  tensor(38.2351, device='cuda:2')
compute distance is  tensor(51.6460, device='cuda:2')
compute distance is  tensor(30.1176, device='cuda:2')
calculated distance threshold is  tensor(76.8370, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.85096666682299
====================
====================
iteration is  0
round is  1
accuracy is  0.9021166668229881
====================
====================
iteration is  0
round is  2
accuracy is  0.857150000156323
====================
====================
iteration is  1
round is  0
accuracy is  0.8196500001563246
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7065166668229972
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.8201000001563246
====================
====================
iteration is  2
round is  0
accuracy is  0.751850000156328
====================
====================
iteration is  2
round is  1
accuracy is  0.7759666668229932
====================
________________________________
test distance is  tensor(4711.3770, device='cuda:2')
test acc is  0.7065166668229972
test loss is 1.735458302472446
test entropy is  0.1928147002736897
________________________________
diff is  tensor(49.9783, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3924, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.7672, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5531, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.9539, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2395, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2966, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1962, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4634.5400, device='cuda:2')
sum is tensor(0.1962, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5886, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1417, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3813, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6778, device='cuda:2', dtype=torch.float64)
sum is tensor(75.6561, device='cuda:2', dtype=torch.float64)
sum is tensor(705.4233, device='cuda:2', dtype=torch.float64)
sum is tensor(4711.3772, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0192, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.9539, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.9783, device='cuda:2')
discard
cal diff is tensor(0.3924, device='cuda:2')
discard
cal diff is tensor(629.7672, device='cuda:2')
discard
cal diff is tensor(0.5531, device='cuda:2')
discard
cal diff is tensor(4005.9539, device='cuda:2')
discard
cal diff is tensor(2.2395, device='cuda:2')
discard
cal diff is tensor(22.2966, device='cuda:2')
discard
cal diff is tensor(0.1962, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9930833334896517
test loss is 0.02525480045114556
test entropy is  0.011970692714636837
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011970692714636837
avg test loss is  0.02525480045114556
avg accuracy is  0.9930833334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1829388645141999
avg test loss is  0.9758482273858684
avg accuracy is  0.7821500001563265
compute_distance is  tensor(93.6730, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.6730, device='cuda:2')
test acc is  0.7821500001563265
test loss is 0.9758482273858684
test entropy is  0.1829388645141999
________________________________
diff is  tensor(0.8415, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(11.8656, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(80.2896, device='cuda:2')
diff is  tensor(0.0531, device='cuda:2')
diff is  tensor(0.6099, device='cuda:2')
diff is  tensor(0.0053, device='cuda:2')
threshold is  tensor(16.8360, device='cuda:2')
sum is tensor(0.0053, device='cuda:2')
sum is tensor(0.0122, device='cuda:2')
sum is tensor(0.0248, device='cuda:2')
sum is tensor(0.0779, device='cuda:2')
sum is tensor(0.6878, device='cuda:2')
sum is tensor(1.5293, device='cuda:2')
sum is tensor(13.3949, device='cuda:2')
sum is tensor(93.6845, device='cuda:2')
ratio is tensor(0.9571, device='cuda:2')
threshold is tensor(80.2896, device='cuda:2')
cal diff is tensor(0.8415, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(11.8656, device='cuda:2')
discard
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(80.2896, device='cuda:2')
clipping
cal diff is tensor(0.0531, device='cuda:2')
discard
cal diff is tensor(0.6099, device='cuda:2')
discard
cal diff is tensor(0.0053, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8493, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10526189065954054
test entropy is  0.06223284656657025
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8487, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0123, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8589, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2')
threshold is tensor(76.8487, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8487, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.8472, device='cuda:2')
test acc is  0.9681166668229858
test loss is 0.10524998626989206
test entropy is  0.062227007175268516
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(76.8466, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(76.8569, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(76.8466, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(76.8466, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.99
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.20% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00010760305303847417
attack res is False
len of model dicts is  10
compute distance is  tensor(11.6587, device='cuda:2')
compute distance is  tensor(54.8848, device='cuda:2')
compute distance is  tensor(64.9037, device='cuda:2')
compute distance is  tensor(109.2825, device='cuda:2')
compute distance is  tensor(27.3992, device='cuda:2')
compute distance is  tensor(56.0754, device='cuda:2')
compute distance is  tensor(61.2709, device='cuda:2')
compute distance is  tensor(42.7257, device='cuda:2')
compute distance is  tensor(82.0046, device='cuda:2')
compute distance is  tensor(27.5245, device='cuda:2')
calculated distance threshold is  tensor(99.5201, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7895666668229927
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8392666668229904
====================
====================
iteration is  0
round is  2
accuracy is  0.9140166668229875
====================
====================
iteration is  1
round is  0
accuracy is  0.7917666668229926
====================
====================
iteration is  1
round is  1
accuracy is  0.7265333334896625
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7644500001563272
====================
________________________________
test distance is  tensor(4711.5063, device='cuda:2')
test acc is  0.7265333334896625
test loss is 1.8020814647361922
test entropy is  0.16293457111141194
________________________________
diff is  tensor(49.4584, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4063, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.7967, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5539, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.6182, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.1935, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3601, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1195, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4611.9863, device='cuda:2')
sum is tensor(0.1195, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5258, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0797, device='cuda:2', dtype=torch.float64)
sum is tensor(3.2732, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6333, device='cuda:2', dtype=torch.float64)
sum is tensor(75.0917, device='cuda:2', dtype=torch.float64)
sum is tensor(705.8884, device='cuda:2', dtype=torch.float64)
sum is tensor(4711.5066, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0248, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.6182, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.4584, device='cuda:2')
discard
cal diff is tensor(0.4063, device='cuda:2')
discard
cal diff is tensor(630.7968, device='cuda:2')
discard
cal diff is tensor(0.5539, device='cuda:2')
discard
cal diff is tensor(4005.6179, device='cuda:2')
discard
cal diff is tensor(2.1935, device='cuda:2')
discard
cal diff is tensor(22.3601, device='cuda:2')
discard
cal diff is tensor(0.1195, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9929333334896517
test loss is 0.024926641601726487
test entropy is  0.012059035541125567
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012059035541125567
avg test loss is  0.024926641601726487
avg accuracy is  0.9929333334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18616249604520005
avg test loss is  1.0059103781480525
avg accuracy is  0.7766166668229934
compute_distance is  tensor(91.9890, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.9890, device='cuda:2')
test acc is  0.7766166668229934
test loss is 1.0059103781480525
test entropy is  0.18616249604520005
________________________________
new distance ratio is 0.8999999999999999
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.17% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0004962855600751936
attack res is False
len of model dicts is  10
compute distance is  tensor(13.2655, device='cuda:2')
compute distance is  tensor(24.4015, device='cuda:2')
compute distance is  tensor(64.4567, device='cuda:2')
compute distance is  tensor(85.9780, device='cuda:2')
compute distance is  tensor(28.0367, device='cuda:2')
compute distance is  tensor(51.7879, device='cuda:2')
compute distance is  tensor(48.7285, device='cuda:2')
compute distance is  tensor(50.9922, device='cuda:2')
compute distance is  tensor(59.5453, device='cuda:2')
compute distance is  tensor(25.4823, device='cuda:2')
calculated distance threshold is  tensor(72.7575, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8752000001563224
====================
====================
iteration is  0
round is  1
accuracy is  0.8222333334896578
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.9120166668229875
====================
====================
iteration is  1
round is  0
accuracy is  0.7426000001563284
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6069833334896706
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.77718333348966
====================
====================
iteration is  2
round is  0
accuracy is  0.5712500001563402
====================
succ_min + 1
________________________________
test distance is  tensor(4710.2900, device='cuda:2')
test acc is  0.5712500001563402
test loss is 4.717187035820886
test entropy is  0.11347805455462066
________________________________
diff is  tensor(48.7788, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4152, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.6221, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5049, device='cuda:2', dtype=torch.float64)
diff is  tensor(4006.0749, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.1515, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.4741, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2685, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4637.5327, device='cuda:2')
sum is tensor(0.2685, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6837, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1886, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3400, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8142, device='cuda:2', dtype=torch.float64)
sum is tensor(74.5930, device='cuda:2', dtype=torch.float64)
sum is tensor(704.2151, device='cuda:2', dtype=torch.float64)
sum is tensor(4710.2901, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0182, device='cuda:2', dtype=torch.float64)
threshold is tensor(4006.0749, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.7788, device='cuda:2')
discard
cal diff is tensor(0.4152, device='cuda:2')
discard
cal diff is tensor(629.6221, device='cuda:2')
discard
cal diff is tensor(0.5049, device='cuda:2')
discard
cal diff is tensor(4006.0752, device='cuda:2')
clipping
cal diff is tensor(2.1515, device='cuda:2')
discard
cal diff is tensor(22.4741, device='cuda:2')
discard
cal diff is tensor(0.2685, device='cuda:2')
discard
________________________________
test distance is  tensor(72.7676, device='cuda:2')
test acc is  0.9930666668229851
test loss is 0.024788991529232175
test entropy is  0.011940234504748105
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(72.7574, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0101, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0139, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(72.7574, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(1.0255, device='cuda:2')
test acc is  0.9931333334896517
test loss is 0.024770119872427353
test entropy is  0.011914735337828308
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011914735337828308
avg test loss is  0.024770119872427353
avg accuracy is  0.9931333334896517
compute_distance is  tensor(1.0255, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10261983142446862
avg test loss is  3.5432221623880267
avg accuracy is  0.5866000001563388
compute_distance is  tensor(92.8091, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.8091, device='cuda:2')
test acc is  0.5866000001563388
test loss is 3.5432221623880267
test entropy is  0.10261983142446862
________________________________
diff is  tensor(0.9213, device='cuda:2')
diff is  tensor(0.0084, device='cuda:2')
diff is  tensor(12.3093, device='cuda:2')
diff is  tensor(0.0138, device='cuda:2')
diff is  tensor(78.9475, device='cuda:2')
diff is  tensor(0.0523, device='cuda:2')
diff is  tensor(0.5500, device='cuda:2')
diff is  tensor(0.0047, device='cuda:2')
threshold is  tensor(20.0516, device='cuda:2')
sum is tensor(0.0047, device='cuda:2')
sum is tensor(0.0131, device='cuda:2')
sum is tensor(0.0269, device='cuda:2')
sum is tensor(0.0793, device='cuda:2')
sum is tensor(0.6293, device='cuda:2')
sum is tensor(1.5506, device='cuda:2')
sum is tensor(13.8599, device='cuda:2')
sum is tensor(92.8074, device='cuda:2')
ratio is tensor(0.9216, device='cuda:2')
threshold is tensor(78.9475, device='cuda:2')
cal diff is tensor(0.9213, device='cuda:2')
discard
cal diff is tensor(0.0084, device='cuda:2')
discard
cal diff is tensor(12.3093, device='cuda:2')
discard
cal diff is tensor(0.0138, device='cuda:2')
discard
cal diff is tensor(78.9475, device='cuda:2')
clipping
cal diff is tensor(0.0523, device='cuda:2')
discard
cal diff is tensor(0.5500, device='cuda:2')
discard
cal diff is tensor(0.0047, device='cuda:2')
discard
________________________________
test distance is  tensor(72.7667, device='cuda:2')
test acc is  0.9129166668229877
test loss is 0.35558984999550874
test entropy is  0.09183545106811437
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(72.7558, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0091, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1210, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(72.7558, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(8.8131, device='cuda:2')
test acc is  0.9927000001563183
test loss is 0.025354759132417443
test entropy is  0.012157248731200176
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012157248731200176
avg test loss is  0.025354759132417443
avg accuracy is  0.9927000001563183
compute_distance is  tensor(8.8131, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10479774995089404
avg test loss is  3.5673759747415716
avg accuracy is  0.5850333334896723
compute_distance is  tensor(96.9289, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(96.9289, device='cuda:2')
test acc is  0.5850333334896723
test loss is 3.5673759747415716
test entropy is  0.10479774995089404
________________________________
diff is  tensor(0.8766, device='cuda:2')
diff is  tensor(0.0080, device='cuda:2')
diff is  tensor(12.2055, device='cuda:2')
diff is  tensor(0.0141, device='cuda:2')
diff is  tensor(83.2597, device='cuda:2')
diff is  tensor(0.0470, device='cuda:2')
diff is  tensor(0.5098, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(24.1714, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0123, device='cuda:2')
sum is tensor(0.0263, device='cuda:2')
sum is tensor(0.0734, device='cuda:2')
sum is tensor(0.5832, device='cuda:2')
sum is tensor(1.4599, device='cuda:2')
sum is tensor(13.6653, device='cuda:2')
sum is tensor(96.9251, device='cuda:2')
ratio is tensor(0.8738, device='cuda:2')
threshold is tensor(83.2597, device='cuda:2')
cal diff is tensor(0.8766, device='cuda:2')
discard
cal diff is tensor(0.0080, device='cuda:2')
discard
cal diff is tensor(12.2055, device='cuda:2')
discard
cal diff is tensor(0.0141, device='cuda:2')
discard
cal diff is tensor(83.2597, device='cuda:2')
clipping
cal diff is tensor(0.0470, device='cuda:2')
discard
cal diff is tensor(0.5098, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(72.7651, device='cuda:2')
test acc is  0.9297333334896538
test loss is 0.2832140642633316
test entropy is  0.07884049888696275
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(72.7536, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0075, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2955, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(72.7536, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(21.5078, device='cuda:2')
test acc is  0.9916000001563183
test loss is 0.029837889373414334
test entropy is  0.014004256184648754
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.014004256184648754
avg test loss is  0.029837889373414334
avg accuracy is  0.9916000001563183
compute_distance is  tensor(21.5078, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10744944831201517
avg test loss is  3.602059304714203
avg accuracy is  0.5827000001563392
compute_distance is  tensor(103.5647, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(103.5647, device='cuda:2')
test acc is  0.5827000001563392
test loss is 3.602059304714203
test entropy is  0.10744944831201517
________________________________
diff is  tensor(0.8342, device='cuda:2')
diff is  tensor(0.0077, device='cuda:2')
diff is  tensor(11.9677, device='cuda:2')
diff is  tensor(0.0138, device='cuda:2')
diff is  tensor(90.2248, device='cuda:2')
diff is  tensor(0.0410, device='cuda:2')
diff is  tensor(0.4645, device='cuda:2')
diff is  tensor(0.0038, device='cuda:2')
threshold is  tensor(30.8071, device='cuda:2')
sum is tensor(0.0038, device='cuda:2')
sum is tensor(0.0115, device='cuda:2')
sum is tensor(0.0253, device='cuda:2')
sum is tensor(0.0663, device='cuda:2')
sum is tensor(0.5308, device='cuda:2')
sum is tensor(1.3651, device='cuda:2')
sum is tensor(13.3327, device='cuda:2')
sum is tensor(103.5576, device='cuda:2')
ratio is tensor(0.8063, device='cuda:2')
threshold is tensor(90.2248, device='cuda:2')
cal diff is tensor(0.8342, device='cuda:2')
discard
cal diff is tensor(0.0077, device='cuda:2')
discard
cal diff is tensor(11.9677, device='cuda:2')
discard
cal diff is tensor(0.0138, device='cuda:2')
discard
cal diff is tensor(90.2248, device='cuda:2')
clipping
cal diff is tensor(0.0410, device='cuda:2')
discard
cal diff is tensor(0.4645, device='cuda:2')
discard
cal diff is tensor(0.0038, device='cuda:2')
discard
________________________________
test distance is  tensor(72.7626, device='cuda:2')
test acc is  0.9443166668229867
test loss is 0.22235726026379055
test entropy is  0.06630241906325986
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(72.7502, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0051, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5652, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(72.7502, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(41.1313, device='cuda:2')
test acc is  0.985983333489652
test loss is 0.04995786601661232
test entropy is  0.020783082903540598
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.020783082903540598
avg test loss is  0.04995786601661232
avg accuracy is  0.985983333489652
compute_distance is  tensor(41.1313, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11045610676728078
avg test loss is  3.651481701366937
avg accuracy is  0.580166666823006
compute_distance is  tensor(114.7273, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(114.7273, device='cuda:2')
test acc is  0.580166666823006
test loss is 3.651481701366937
test entropy is  0.11045610676728078
________________________________
diff is  tensor(0.7807, device='cuda:2')
diff is  tensor(0.0073, device='cuda:2')
diff is  tensor(11.3523, device='cuda:2')
diff is  tensor(0.0125, device='cuda:2')
diff is  tensor(102.1149, device='cuda:2')
diff is  tensor(0.0337, device='cuda:2')
diff is  tensor(0.4111, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(41.9698, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0229, device='cuda:2')
sum is tensor(0.0566, device='cuda:2')
sum is tensor(0.4678, device='cuda:2')
sum is tensor(1.2485, device='cuda:2')
sum is tensor(12.6007, device='cuda:2')
sum is tensor(114.7156, device='cuda:2')
ratio is tensor(0.7124, device='cuda:2')
threshold is tensor(102.1149, device='cuda:2')
cal diff is tensor(0.7807, device='cuda:2')
discard
cal diff is tensor(0.0073, device='cuda:2')
discard
cal diff is tensor(11.3523, device='cuda:2')
discard
cal diff is tensor(0.0125, device='cuda:2')
discard
cal diff is tensor(102.1149, device='cuda:2')
clipping
cal diff is tensor(0.0337, device='cuda:2')
discard
cal diff is tensor(0.4111, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(72.7592, device='cuda:2')
test acc is  0.9564000001563194
test loss is 0.16718182412763266
test entropy is  0.053866548509622955
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(72.7453, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0016, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.9504, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(72.7453, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1534, device='cuda:2')
test acc is  0.9633333334896527
test loss is 0.1401497400034318
test entropy is  0.04672813531222827
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04672813531222827
avg test loss is  0.1401497400034318
avg accuracy is  0.9633333334896527
compute_distance is  tensor(69.1534, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11309370537326216
avg test loss is  3.7243149230983468
avg accuracy is  0.577433333489673
compute_distance is  tensor(131.7309, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(131.7309, device='cuda:2')
test acc is  0.577433333489673
test loss is 3.7243149230983468
test entropy is  0.11309370537326216
________________________________
diff is  tensor(0.7409, device='cuda:2')
diff is  tensor(0.0060, device='cuda:2')
diff is  tensor(10.1819, device='cuda:2')
diff is  tensor(0.0106, device='cuda:2')
diff is  tensor(120.3885, device='cuda:2')
diff is  tensor(0.0259, device='cuda:2')
diff is  tensor(0.3571, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(58.9733, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0191, device='cuda:2')
sum is tensor(0.0450, device='cuda:2')
sum is tensor(0.4021, device='cuda:2')
sum is tensor(1.1430, device='cuda:2')
sum is tensor(11.3249, device='cuda:2')
sum is tensor(131.7135, device='cuda:2')
ratio is tensor(0.6042, device='cuda:2')
threshold is tensor(120.3885, device='cuda:2')
cal diff is tensor(0.7409, device='cuda:2')
discard
cal diff is tensor(0.0060, device='cuda:2')
discard
cal diff is tensor(10.1819, device='cuda:2')
discard
cal diff is tensor(0.0106, device='cuda:2')
discard
cal diff is tensor(120.3885, device='cuda:2')
clipping
cal diff is tensor(0.0259, device='cuda:2')
discard
cal diff is tensor(0.3571, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(72.7549, device='cuda:2')
test acc is  0.9674333334896524
test loss is 0.1231666730370883
test entropy is  0.042755005616463344
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.042755005616463344
avg test loss is  0.1231666730370883
avg accuracy is  0.9674333334896524
compute_distance is  tensor(72.7549, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11314590921057567
avg test loss is  3.7435122059860717
avg accuracy is  0.5771333334896729
compute_distance is  tensor(136.0605, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.0605, device='cuda:2')
test acc is  0.5771333334896729
test loss is 3.7435122059860717
test entropy is  0.11314590921057567
________________________________
diff is  tensor(0.7510, device='cuda:2')
diff is  tensor(0.0062, device='cuda:2')
diff is  tensor(10.4149, device='cuda:2')
diff is  tensor(0.0110, device='cuda:2')
diff is  tensor(124.4802, device='cuda:2')
diff is  tensor(0.0262, device='cuda:2')
diff is  tensor(0.3495, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(63.3029, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0087, device='cuda:2')
sum is tensor(0.0197, device='cuda:2')
sum is tensor(0.0459, device='cuda:2')
sum is tensor(0.3954, device='cuda:2')
sum is tensor(1.1464, device='cuda:2')
sum is tensor(11.5613, device='cuda:2')
sum is tensor(136.0415, device='cuda:2')
ratio is tensor(0.5843, device='cuda:2')
threshold is tensor(124.4802, device='cuda:2')
cal diff is tensor(0.7510, device='cuda:2')
discard
cal diff is tensor(0.0062, device='cuda:2')
discard
cal diff is tensor(10.4149, device='cuda:2')
discard
cal diff is tensor(0.0110, device='cuda:2')
discard
cal diff is tensor(124.4802, device='cuda:2')
clipping
cal diff is tensor(0.0262, device='cuda:2')
discard
cal diff is tensor(0.3495, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(72.7542, device='cuda:2')
test acc is  0.9708333334896523
test loss is 0.10926472849602231
test entropy is  0.038895849804411325
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.038895849804411325
avg test loss is  0.10926472849602231
avg accuracy is  0.9708333334896523
compute_distance is  tensor(72.7542, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11303969236340985
avg test loss is  3.746434903856534
avg accuracy is  0.5771000001563396
compute_distance is  tensor(136.9073, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.9073, device='cuda:2')
test acc is  0.5771000001563396
test loss is 3.746434903856534
test entropy is  0.11303969236340985
________________________________
diff is  tensor(0.7564, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(10.6324, device='cuda:2')
diff is  tensor(0.0113, device='cuda:2')
diff is  tensor(125.1006, device='cuda:2')
diff is  tensor(0.0270, device='cuda:2')
diff is  tensor(0.3510, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(64.1498, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0202, device='cuda:2')
sum is tensor(0.0472, device='cuda:2')
sum is tensor(0.3982, device='cuda:2')
sum is tensor(1.1545, device='cuda:2')
sum is tensor(11.7869, device='cuda:2')
sum is tensor(136.8876, device='cuda:2')
ratio is tensor(0.5814, device='cuda:2')
threshold is tensor(125.1006, device='cuda:2')
cal diff is tensor(0.7564, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(10.6324, device='cuda:2')
discard
cal diff is tensor(0.0113, device='cuda:2')
discard
cal diff is tensor(125.1006, device='cuda:2')
clipping
cal diff is tensor(0.0270, device='cuda:2')
discard
cal diff is tensor(0.3510, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.18% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00038560244138352573
attack res is False
len of model dicts is  10
compute distance is  tensor(14.1530, device='cuda:2')
compute distance is  tensor(32.3335, device='cuda:2')
compute distance is  tensor(64.7680, device='cuda:2')
compute distance is  tensor(60.8393, device='cuda:2')
compute distance is  tensor(28.3982, device='cuda:2')
compute distance is  tensor(54.0849, device='cuda:2')
compute distance is  tensor(50.0135, device='cuda:2')
compute distance is  tensor(65.0313, device='cuda:2')
compute distance is  tensor(62.7940, device='cuda:2')
compute distance is  tensor(51.4636, device='cuda:2')
calculated distance threshold is  tensor(55.7807, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7638166668229939
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.707166666822997
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8338333334896573
====================
====================
iteration is  1
round is  0
accuracy is  0.7566666668229942
====================
====================
iteration is  1
round is  1
accuracy is  0.7789500001563265
====================
________________________________
test distance is  tensor(4278.1660, device='cuda:2')
test acc is  0.707166666822997
test loss is 1.9457461332906283
test entropy is  0.14742645185226316
________________________________
diff is  tensor(41.8685, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3575, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.6331, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5321, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.2687, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0052, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2825, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2183, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4222.3853, device='cuda:2')
sum is tensor(0.2183, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5758, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1079, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1132, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3957, device='cuda:2', dtype=torch.float64)
sum is tensor(65.2642, device='cuda:2', dtype=torch.float64)
sum is tensor(636.8972, device='cuda:2', dtype=torch.float64)
sum is tensor(4278.1660, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0153, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.2687, device='cuda:2', dtype=torch.float64)
cal diff is tensor(41.8685, device='cuda:2')
discard
cal diff is tensor(0.3575, device='cuda:2')
discard
cal diff is tensor(571.6331, device='cuda:2')
discard
cal diff is tensor(0.5321, device='cuda:2')
discard
cal diff is tensor(3641.2686, device='cuda:2')
discard
cal diff is tensor(2.0052, device='cuda:2')
discard
cal diff is tensor(20.2825, device='cuda:2')
discard
cal diff is tensor(0.2183, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9929666668229851
test loss is 0.02489032253174731
test entropy is  0.01179086460527904
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01179086460527904
avg test loss is  0.02489032253174731
avg accuracy is  0.9929666668229851
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15027729699066453
avg test loss is  1.4139238810424866
avg accuracy is  0.7319666668229957
compute_distance is  tensor(85.7908, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.7908, device='cuda:2')
test acc is  0.7319666668229957
test loss is 1.4139238810424866
test entropy is  0.15027729699066453
________________________________
diff is  tensor(0.6815, device='cuda:2')
diff is  tensor(0.0051, device='cuda:2')
diff is  tensor(11.3226, device='cuda:2')
diff is  tensor(0.0123, device='cuda:2')
diff is  tensor(73.1673, device='cuda:2')
diff is  tensor(0.0449, device='cuda:2')
diff is  tensor(0.5529, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(30.0100, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0095, device='cuda:2')
sum is tensor(0.0218, device='cuda:2')
sum is tensor(0.0668, device='cuda:2')
sum is tensor(0.6196, device='cuda:2')
sum is tensor(1.3011, device='cuda:2')
sum is tensor(12.6238, device='cuda:2')
sum is tensor(85.7910, device='cuda:2')
ratio is tensor(0.7624, device='cuda:2')
threshold is tensor(73.1673, device='cuda:2')
cal diff is tensor(0.6815, device='cuda:2')
discard
cal diff is tensor(0.0051, device='cuda:2')
discard
cal diff is tensor(11.3226, device='cuda:2')
discard
cal diff is tensor(0.0123, device='cuda:2')
discard
cal diff is tensor(73.1673, device='cuda:2')
clipping
cal diff is tensor(0.0449, device='cuda:2')
discard
cal diff is tensor(0.5529, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(55.7886, device='cuda:2')
test acc is  0.9732333334896524
test loss is 0.1020077401802626
test entropy is  0.0389753936036333
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(55.7814, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0078, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2630, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(55.7814, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(14.6800, device='cuda:2')
test acc is  0.9923000001563184
test loss is 0.027843367331533732
test entropy is  0.012992218069694243
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012992218069694243
avg test loss is  0.027843367331533732
avg accuracy is  0.9923000001563184
compute_distance is  tensor(14.6800, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15087892036479927
avg test loss is  1.4460065799799047
avg accuracy is  0.7303333334896625
compute_distance is  tensor(93.6320, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.6320, device='cuda:2')
test acc is  0.7303333334896625
test loss is 1.4460065799799047
test entropy is  0.15087892036479927
________________________________
diff is  tensor(0.6241, device='cuda:2')
diff is  tensor(0.0052, device='cuda:2')
diff is  tensor(11.0397, device='cuda:2')
diff is  tensor(0.0121, device='cuda:2')
diff is  tensor(81.4059, device='cuda:2')
diff is  tensor(0.0381, device='cuda:2')
diff is  tensor(0.4993, device='cuda:2')
diff is  tensor(0.0037, device='cuda:2')
threshold is  tensor(37.8512, device='cuda:2')
sum is tensor(0.0037, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0210, device='cuda:2')
sum is tensor(0.0591, device='cuda:2')
sum is tensor(0.5584, device='cuda:2')
sum is tensor(1.1825, device='cuda:2')
sum is tensor(12.2222, device='cuda:2')
sum is tensor(93.6282, device='cuda:2')
ratio is tensor(0.6852, device='cuda:2')
threshold is tensor(81.4059, device='cuda:2')
cal diff is tensor(0.6241, device='cuda:2')
discard
cal diff is tensor(0.0052, device='cuda:2')
discard
cal diff is tensor(11.0397, device='cuda:2')
discard
cal diff is tensor(0.0121, device='cuda:2')
discard
cal diff is tensor(81.4059, device='cuda:2')
clipping
cal diff is tensor(0.0381, device='cuda:2')
discard
cal diff is tensor(0.4993, device='cuda:2')
discard
cal diff is tensor(0.0037, device='cuda:2')
discard
________________________________
test distance is  tensor(55.7859, device='cuda:2')
test acc is  0.9783833334896522
test loss is 0.08196128923486432
test entropy is  0.03348376325339447
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(55.7772, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0051, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5639, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(55.7772, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(31.4645, device='cuda:2')
test acc is  0.990366666822985
test loss is 0.03671844682207424
test entropy is  0.016776467966268964
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.016776467966268964
avg test loss is  0.03671844682207424
avg accuracy is  0.990366666822985
compute_distance is  tensor(31.4645, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1513083640660749
avg test loss is  1.4795545241090535
avg accuracy is  0.728566666822996
compute_distance is  tensor(103.5667, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(103.5667, device='cuda:2')
test acc is  0.728566666822996
test loss is 1.4795545241090535
test entropy is  0.1513083640660749
________________________________
diff is  tensor(0.5908, device='cuda:2')
diff is  tensor(0.0056, device='cuda:2')
diff is  tensor(10.6831, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(91.7799, device='cuda:2')
diff is  tensor(0.0323, device='cuda:2')
diff is  tensor(0.4523, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(47.7860, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0202, device='cuda:2')
sum is tensor(0.0526, device='cuda:2')
sum is tensor(0.5048, device='cuda:2')
sum is tensor(1.0957, device='cuda:2')
sum is tensor(11.7787, device='cuda:2')
sum is tensor(103.5586, device='cuda:2')
ratio is tensor(0.6077, device='cuda:2')
threshold is tensor(91.7799, device='cuda:2')
cal diff is tensor(0.5908, device='cuda:2')
discard
cal diff is tensor(0.0056, device='cuda:2')
discard
cal diff is tensor(10.6831, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(91.7799, device='cuda:2')
clipping
cal diff is tensor(0.0323, device='cuda:2')
discard
cal diff is tensor(0.4523, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(55.7830, device='cuda:2')
test acc is  0.9816333334896521
test loss is 0.06782827585177001
test entropy is  0.029357676496480724
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(55.7726, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0023, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8788, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(55.7726, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(49.0225, device='cuda:2')
test acc is  0.9853000001563186
test loss is 0.05405147826750224
test entropy is  0.024145257886874476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.024145257886874476
avg test loss is  0.05405147826750224
avg accuracy is  0.9853000001563186
compute_distance is  tensor(49.0225, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15170097565735136
avg test loss is  1.5101526755132655
avg accuracy is  0.7264166668229961
compute_distance is  tensor(114.5454, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(114.5454, device='cuda:2')
test acc is  0.7264166668229961
test loss is 1.5101526755132655
test entropy is  0.15170097565735136
________________________________
diff is  tensor(0.5581, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.1618, device='cuda:2')
diff is  tensor(0.0105, device='cuda:2')
diff is  tensor(103.3550, device='cuda:2')
diff is  tensor(0.0275, device='cuda:2')
diff is  tensor(0.4121, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(58.7646, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0189, device='cuda:2')
sum is tensor(0.0464, device='cuda:2')
sum is tensor(0.4585, device='cuda:2')
sum is tensor(1.0165, device='cuda:2')
sum is tensor(11.1783, device='cuda:2')
sum is tensor(114.5333, device='cuda:2')
ratio is tensor(0.5396, device='cuda:2')
threshold is tensor(103.3550, device='cuda:2')
cal diff is tensor(0.5581, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.1618, device='cuda:2')
discard
cal diff is tensor(0.0105, device='cuda:2')
discard
cal diff is tensor(103.3550, device='cuda:2')
clipping
cal diff is tensor(0.0275, device='cuda:2')
discard
cal diff is tensor(0.4121, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(55.7806, device='cuda:2')
test acc is  0.983983333489652
test loss is 0.057766278835870426
test entropy is  0.026173686160479357
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.026173686160479357
avg test loss is  0.057766278835870426
avg accuracy is  0.983983333489652
compute_distance is  tensor(55.7806, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15190237217834954
avg test loss is  1.5212089781567995
avg accuracy is  0.7257666668229961
compute_distance is  tensor(119.8379, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(119.8379, device='cuda:2')
test acc is  0.7257666668229961
test loss is 1.5212089781567995
test entropy is  0.15190237217834954
________________________________
diff is  tensor(0.5567, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.1049, device='cuda:2')
diff is  tensor(0.0103, device='cuda:2')
diff is  tensor(108.7210, device='cuda:2')
diff is  tensor(0.0264, device='cuda:2')
diff is  tensor(0.3964, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(64.0572, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0083, device='cuda:2')
sum is tensor(0.0186, device='cuda:2')
sum is tensor(0.0450, device='cuda:2')
sum is tensor(0.4414, device='cuda:2')
sum is tensor(0.9981, device='cuda:2')
sum is tensor(11.1029, device='cuda:2')
sum is tensor(119.8239, device='cuda:2')
ratio is tensor(0.5129, device='cuda:2')
threshold is tensor(108.7210, device='cuda:2')
cal diff is tensor(0.5567, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.1049, device='cuda:2')
discard
cal diff is tensor(0.0103, device='cuda:2')
discard
cal diff is tensor(108.7210, device='cuda:2')
clipping
cal diff is tensor(0.0264, device='cuda:2')
discard
cal diff is tensor(0.3964, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(55.7795, device='cuda:2')
test acc is  0.9853166668229852
test loss is 0.053361275581537554
test entropy is  0.024634108677163778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.024634108677163778
avg test loss is  0.053361275581537554
avg accuracy is  0.9853166668229852
compute_distance is  tensor(55.7795, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.151985665449678
avg test loss is  1.520972791701746
avg accuracy is  0.7256500001563294
compute_distance is  tensor(120.5177, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(120.5177, device='cuda:2')
test acc is  0.7256500001563294
test loss is 1.520972791701746
test entropy is  0.151985665449678
________________________________
diff is  tensor(0.5616, device='cuda:2')
diff is  tensor(0.0058, device='cuda:2')
diff is  tensor(10.2628, device='cuda:2')
diff is  tensor(0.0106, device='cuda:2')
diff is  tensor(109.2369, device='cuda:2')
diff is  tensor(0.0269, device='cuda:2')
diff is  tensor(0.3958, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(64.7369, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0190, device='cuda:2')
sum is tensor(0.0459, device='cuda:2')
sum is tensor(0.4417, device='cuda:2')
sum is tensor(1.0033, device='cuda:2')
sum is tensor(11.2661, device='cuda:2')
sum is tensor(120.5030, device='cuda:2')
ratio is tensor(0.5105, device='cuda:2')
threshold is tensor(109.2369, device='cuda:2')
cal diff is tensor(0.5616, device='cuda:2')
discard
cal diff is tensor(0.0058, device='cuda:2')
discard
cal diff is tensor(10.2628, device='cuda:2')
discard
cal diff is tensor(0.0106, device='cuda:2')
discard
cal diff is tensor(109.2369, device='cuda:2')
clipping
cal diff is tensor(0.0269, device='cuda:2')
discard
cal diff is tensor(0.3958, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(55.7794, device='cuda:2')
test acc is  0.9856166668229853
test loss is 0.05227151326871274
test entropy is  0.024204030618971542
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.024204030618971542
avg test loss is  0.05227151326871274
avg accuracy is  0.9856166668229853
compute_distance is  tensor(55.7794, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15199411809960725
avg test loss is  1.5211664810935572
avg accuracy is  0.7256000001563294
compute_distance is  tensor(120.7721, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(120.7721, device='cuda:2')
test acc is  0.7256000001563294
test loss is 1.5211664810935572
test entropy is  0.15199411809960725
________________________________
diff is  tensor(0.5628, device='cuda:2')
diff is  tensor(0.0058, device='cuda:2')
diff is  tensor(10.3181, device='cuda:2')
diff is  tensor(0.0106, device='cuda:2')
diff is  tensor(109.4344, device='cuda:2')
diff is  tensor(0.0272, device='cuda:2')
diff is  tensor(0.3957, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(64.9914, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0191, device='cuda:2')
sum is tensor(0.0462, device='cuda:2')
sum is tensor(0.4419, device='cuda:2')
sum is tensor(1.0048, device='cuda:2')
sum is tensor(11.3228, device='cuda:2')
sum is tensor(120.7572, device='cuda:2')
ratio is tensor(0.5096, device='cuda:2')
threshold is tensor(109.4344, device='cuda:2')
cal diff is tensor(0.5628, device='cuda:2')
discard
cal diff is tensor(0.0058, device='cuda:2')
discard
cal diff is tensor(10.3181, device='cuda:2')
discard
cal diff is tensor(0.0106, device='cuda:2')
discard
cal diff is tensor(109.4344, device='cuda:2')
clipping
cal diff is tensor(0.0272, device='cuda:2')
discard
cal diff is tensor(0.3957, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(55.7793, device='cuda:2')
test acc is  0.9857000001563186
test loss is 0.05187235918591804
test entropy is  0.0240373584584769
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0240373584584769
avg test loss is  0.05187235918591804
avg accuracy is  0.9857000001563186
compute_distance is  tensor(55.7793, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1519934206164436
avg test loss is  1.5216252285915652
avg accuracy is  0.7255166668229961
compute_distance is  tensor(120.8652, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(120.8652, device='cuda:2')
test acc is  0.7255166668229961
test loss is 1.5216252285915652
test entropy is  0.1519934206164436
________________________________
diff is  tensor(0.5630, device='cuda:2')
diff is  tensor(0.0058, device='cuda:2')
diff is  tensor(10.3419, device='cuda:2')
diff is  tensor(0.0107, device='cuda:2')
diff is  tensor(109.5032, device='cuda:2')
diff is  tensor(0.0272, device='cuda:2')
diff is  tensor(0.3955, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(65.0844, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0191, device='cuda:2')
sum is tensor(0.0464, device='cuda:2')
sum is tensor(0.4419, device='cuda:2')
sum is tensor(1.0049, device='cuda:2')
sum is tensor(11.3468, device='cuda:2')
sum is tensor(120.8500, device='cuda:2')
ratio is tensor(0.5093, device='cuda:2')
threshold is tensor(109.5032, device='cuda:2')
cal diff is tensor(0.5630, device='cuda:2')
discard
cal diff is tensor(0.0058, device='cuda:2')
discard
cal diff is tensor(10.3419, device='cuda:2')
discard
cal diff is tensor(0.0107, device='cuda:2')
discard
cal diff is tensor(109.5032, device='cuda:2')
clipping
cal diff is tensor(0.0272, device='cuda:2')
discard
cal diff is tensor(0.3955, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.15% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0005485470755957067
attack res is False
len of model dicts is  10
compute distance is  tensor(12.6463, device='cuda:2')
compute distance is  tensor(52.4534, device='cuda:2')
compute distance is  tensor(72.8494, device='cuda:2')
compute distance is  tensor(85.0588, device='cuda:2')
compute distance is  tensor(27.9642, device='cuda:2')
compute distance is  tensor(54.9192, device='cuda:2')
compute distance is  tensor(53.3909, device='cuda:2')
compute distance is  tensor(46.3776, device='cuda:2')
compute distance is  tensor(63.1825, device='cuda:2')
compute distance is  tensor(28.8929, device='cuda:2')
calculated distance threshold is  tensor(71.8929, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8917500001563218
====================
====================
iteration is  0
round is  1
accuracy is  0.8126500001563249
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8364666668229905
====================
====================
iteration is  1
round is  0
accuracy is  0.7326000001563289
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6791833334896654
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7998500001563256
====================
________________________________
test distance is  tensor(4709.6992, device='cuda:2')
test acc is  0.6791833334896654
test loss is 2.7010791424367984
test entropy is  0.1507742758602031
________________________________
diff is  tensor(50.0827, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3752, device='cuda:2', dtype=torch.float64)
diff is  tensor(627.5493, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5462, device='cuda:2', dtype=torch.float64)
diff is  tensor(4006.3431, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2450, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3615, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1961, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4637.8062, device='cuda:2')
sum is tensor(0.1961, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5713, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1174, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3624, device='cuda:2', dtype=torch.float64)
sum is tensor(25.7239, device='cuda:2', dtype=torch.float64)
sum is tensor(75.8066, device='cuda:2', dtype=torch.float64)
sum is tensor(703.3559, device='cuda:2', dtype=torch.float64)
sum is tensor(4709.6991, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0179, device='cuda:2', dtype=torch.float64)
threshold is tensor(4006.3431, device='cuda:2', dtype=torch.float64)
cal diff is tensor(50.0827, device='cuda:2')
discard
cal diff is tensor(0.3752, device='cuda:2')
discard
cal diff is tensor(627.5493, device='cuda:2')
discard
cal diff is tensor(0.5462, device='cuda:2')
discard
cal diff is tensor(4006.3430, device='cuda:2')
discard
cal diff is tensor(2.2450, device='cuda:2')
discard
cal diff is tensor(22.3615, device='cuda:2')
discard
cal diff is tensor(0.1961, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9931500001563184
test loss is 0.024634760676476002
test entropy is  0.011986597827940667
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011986597827940667
avg test loss is  0.024634760676476002
avg accuracy is  0.9931500001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15086593769633694
avg test loss is  1.744988965867425
avg accuracy is  0.7197333334896628
compute_distance is  tensor(91.6413, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.6413, device='cuda:2')
test acc is  0.7197333334896628
test loss is 1.744988965867425
test entropy is  0.15086593769633694
________________________________
diff is  tensor(0.9682, device='cuda:2')
diff is  tensor(0.0079, device='cuda:2')
diff is  tensor(12.6949, device='cuda:2')
diff is  tensor(0.0132, device='cuda:2')
diff is  tensor(77.3384, device='cuda:2')
diff is  tensor(0.0455, device='cuda:2')
diff is  tensor(0.5683, device='cuda:2')
diff is  tensor(0.0046, device='cuda:2')
threshold is  tensor(19.7484, device='cuda:2')
sum is tensor(0.0046, device='cuda:2')
sum is tensor(0.0125, device='cuda:2')
sum is tensor(0.0257, device='cuda:2')
sum is tensor(0.0713, device='cuda:2')
sum is tensor(0.6395, device='cuda:2')
sum is tensor(1.6077, device='cuda:2')
sum is tensor(14.3026, device='cuda:2')
sum is tensor(91.6409, device='cuda:2')
ratio is tensor(0.9296, device='cuda:2')
threshold is tensor(77.3384, device='cuda:2')
cal diff is tensor(0.9682, device='cuda:2')
discard
cal diff is tensor(0.0079, device='cuda:2')
discard
cal diff is tensor(12.6949, device='cuda:2')
discard
cal diff is tensor(0.0132, device='cuda:2')
discard
cal diff is tensor(77.3384, device='cuda:2')
clipping
cal diff is tensor(0.0455, device='cuda:2')
discard
cal diff is tensor(0.5683, device='cuda:2')
discard
cal diff is tensor(0.0046, device='cuda:2')
discard
________________________________
test distance is  tensor(71.9002, device='cuda:2')
test acc is  0.9538000001563196
test loss is 0.1672919966403764
test entropy is  0.06327720894378973
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(71.8926, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0073, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3216, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(71.8926, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(23.1295, device='cuda:2')
test acc is  0.9917333334896518
test loss is 0.02922428180069103
test entropy is  0.01464353605284469
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01464353605284469
avg test loss is  0.02922428180069103
avg accuracy is  0.9917333334896518
compute_distance is  tensor(23.1295, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15355261387839628
avg test loss is  1.838335274474453
avg accuracy is  0.7142666668229966
compute_distance is  tensor(104.1520, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(104.1520, device='cuda:2')
test acc is  0.7142666668229966
test loss is 1.838335274474453
test entropy is  0.15355261387839628
________________________________
diff is  tensor(0.9095, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(12.5602, device='cuda:2')
diff is  tensor(0.0135, device='cuda:2')
diff is  tensor(90.1271, device='cuda:2')
diff is  tensor(0.0358, device='cuda:2')
diff is  tensor(0.4885, device='cuda:2')
diff is  tensor(0.0035, device='cuda:2')
threshold is  tensor(32.2590, device='cuda:2')
sum is tensor(0.0035, device='cuda:2')
sum is tensor(0.0105, device='cuda:2')
sum is tensor(0.0240, device='cuda:2')
sum is tensor(0.0597, device='cuda:2')
sum is tensor(0.5482, device='cuda:2')
sum is tensor(1.4577, device='cuda:2')
sum is tensor(14.0179, device='cuda:2')
sum is tensor(104.1450, device='cuda:2')
ratio is tensor(0.7976, device='cuda:2')
threshold is tensor(90.1271, device='cuda:2')
cal diff is tensor(0.9095, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(12.5602, device='cuda:2')
discard
cal diff is tensor(0.0135, device='cuda:2')
discard
cal diff is tensor(90.1271, device='cuda:2')
clipping
cal diff is tensor(0.0358, device='cuda:2')
discard
cal diff is tensor(0.4885, device='cuda:2')
discard
cal diff is tensor(0.0035, device='cuda:2')
discard
________________________________
test distance is  tensor(71.8962, device='cuda:2')
test acc is  0.9680666668229858
test loss is 0.1155976852002022
test entropy is  0.04951704598502564
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(71.8860, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0033, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7684, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(71.8860, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(55.2445, device='cuda:2')
test acc is  0.9828333334896521
test loss is 0.05938865960774917
test entropy is  0.028658854489250773
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.028658854489250773
avg test loss is  0.05938865960774917
avg accuracy is  0.9828333334896521
compute_distance is  tensor(55.2445, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15562441002633146
avg test loss is  1.948132974919734
avg accuracy is  0.7087500001563302
compute_distance is  tensor(122.8248, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(122.8248, device='cuda:2')
test acc is  0.7087500001563302
test loss is 1.948132974919734
test entropy is  0.15562441002633146
________________________________
diff is  tensor(0.8083, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.6676, device='cuda:2')
diff is  tensor(0.0119, device='cuda:2')
diff is  tensor(109.8736, device='cuda:2')
diff is  tensor(0.0266, device='cuda:2')
diff is  tensor(0.4140, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(50.9319, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0210, device='cuda:2')
sum is tensor(0.0477, device='cuda:2')
sum is tensor(0.4616, device='cuda:2')
sum is tensor(1.2699, device='cuda:2')
sum is tensor(12.9375, device='cuda:2')
sum is tensor(122.8111, device='cuda:2')
ratio is tensor(0.6542, device='cuda:2')
threshold is tensor(109.8736, device='cuda:2')
cal diff is tensor(0.8083, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.6676, device='cuda:2')
discard
cal diff is tensor(0.0119, device='cuda:2')
discard
cal diff is tensor(109.8736, device='cuda:2')
clipping
cal diff is tensor(0.0266, device='cuda:2')
discard
cal diff is tensor(0.4140, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(71.8922, device='cuda:2')
test acc is  0.9761333334896521
test loss is 0.08424524215028648
test entropy is  0.03861708755144226
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03861708755144226
avg test loss is  0.08424524215028648
avg accuracy is  0.9761333334896521
compute_distance is  tensor(71.8922, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15607510544439115
avg test loss is  1.9988054330033789
avg accuracy is  0.706116666822997
compute_distance is  tensor(134.5078, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(134.5078, device='cuda:2')
test acc is  0.706116666822997
test loss is 1.9988054330033789
test entropy is  0.15607510544439115
________________________________
diff is  tensor(0.7684, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.2376, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(122.0641, device='cuda:2')
diff is  tensor(0.0234, device='cuda:2')
diff is  tensor(0.3770, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(62.6149, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0086, device='cuda:2')
sum is tensor(0.0198, device='cuda:2')
sum is tensor(0.0432, device='cuda:2')
sum is tensor(0.4202, device='cuda:2')
sum is tensor(1.1886, device='cuda:2')
sum is tensor(12.4262, device='cuda:2')
sum is tensor(134.4903, device='cuda:2')
ratio is tensor(0.5888, device='cuda:2')
threshold is tensor(122.0641, device='cuda:2')
cal diff is tensor(0.7684, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.2376, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(122.0641, device='cuda:2')
clipping
cal diff is tensor(0.0234, device='cuda:2')
discard
cal diff is tensor(0.3770, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(71.8902, device='cuda:2')
test acc is  0.9796000001563188
test loss is 0.0705196716466286
test entropy is  0.0332635240768629
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0332635240768629
avg test loss is  0.0705196716466286
avg accuracy is  0.9796000001563188
compute_distance is  tensor(71.8902, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15619849705937575
avg test loss is  2.0020055767061358
avg accuracy is  0.7055500001563304
compute_distance is  tensor(136.1487, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.1487, device='cuda:2')
test acc is  0.7055500001563304
test loss is 2.0020055767061358
test entropy is  0.15619849705937575
________________________________
diff is  tensor(0.7751, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.5389, device='cuda:2')
diff is  tensor(0.0117, device='cuda:2')
diff is  tensor(123.3980, device='cuda:2')
diff is  tensor(0.0245, device='cuda:2')
diff is  tensor(0.3732, device='cuda:2')
diff is  tensor(0.0023, device='cuda:2')
threshold is  tensor(64.2558, device='cuda:2')
sum is tensor(0.0023, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0205, device='cuda:2')
sum is tensor(0.0450, device='cuda:2')
sum is tensor(0.4182, device='cuda:2')
sum is tensor(1.1933, device='cuda:2')
sum is tensor(12.7322, device='cuda:2')
sum is tensor(136.1302, device='cuda:2')
ratio is tensor(0.5825, device='cuda:2')
threshold is tensor(123.3980, device='cuda:2')
cal diff is tensor(0.7751, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.5389, device='cuda:2')
discard
cal diff is tensor(0.0117, device='cuda:2')
discard
cal diff is tensor(123.3980, device='cuda:2')
clipping
cal diff is tensor(0.0245, device='cuda:2')
discard
cal diff is tensor(0.3732, device='cuda:2')
discard
cal diff is tensor(0.0023, device='cuda:2')
discard
________________________________
test distance is  tensor(71.8901, device='cuda:2')
test acc is  0.9805500001563188
test loss is 0.06657978661013636
test entropy is  0.03169792806133635
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03169792806133635
avg test loss is  0.06657978661013636
avg accuracy is  0.9805500001563188
compute_distance is  tensor(71.8901, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15625083126794936
avg test loss is  2.0037705772467005
avg accuracy is  0.7053166668229971
compute_distance is  tensor(136.7799, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.7799, device='cuda:2')
test acc is  0.7053166668229971
test loss is 2.0037705772467005
test entropy is  0.15625083126794936
________________________________
diff is  tensor(0.7786, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.6736, device='cuda:2')
diff is  tensor(0.0119, device='cuda:2')
diff is  tensor(123.8900, device='cuda:2')
diff is  tensor(0.0249, device='cuda:2')
diff is  tensor(0.3727, device='cuda:2')
diff is  tensor(0.0023, device='cuda:2')
threshold is  tensor(64.8870, device='cuda:2')
sum is tensor(0.0023, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0208, device='cuda:2')
sum is tensor(0.0457, device='cuda:2')
sum is tensor(0.4184, device='cuda:2')
sum is tensor(1.1971, device='cuda:2')
sum is tensor(12.8707, device='cuda:2')
sum is tensor(136.7607, device='cuda:2')
ratio is tensor(0.5801, device='cuda:2')
threshold is tensor(123.8900, device='cuda:2')
cal diff is tensor(0.7786, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.6736, device='cuda:2')
discard
cal diff is tensor(0.0119, device='cuda:2')
discard
cal diff is tensor(123.8900, device='cuda:2')
clipping
cal diff is tensor(0.0249, device='cuda:2')
discard
cal diff is tensor(0.3727, device='cuda:2')
discard
cal diff is tensor(0.0023, device='cuda:2')
discard
________________________________
test distance is  tensor(71.8900, device='cuda:2')
test acc is  0.9809500001563187
test loss is 0.06508770871096882
test entropy is  0.031091716603361946
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.031091716603361946
avg test loss is  0.06508770871096882
avg accuracy is  0.9809500001563187
compute_distance is  tensor(71.8900, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15632596102429988
avg test loss is  2.005131553612284
avg accuracy is  0.705116666822997
compute_distance is  tensor(137.0345, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(137.0345, device='cuda:2')
test acc is  0.705116666822997
test loss is 2.005131553612284
test entropy is  0.15632596102429988
________________________________
diff is  tensor(0.7799, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.7325, device='cuda:2')
diff is  tensor(0.0120, device='cuda:2')
diff is  tensor(124.0845, device='cuda:2')
diff is  tensor(0.0252, device='cuda:2')
diff is  tensor(0.3719, device='cuda:2')
diff is  tensor(0.0023, device='cuda:2')
threshold is  tensor(65.1416, device='cuda:2')
sum is tensor(0.0023, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0209, device='cuda:2')
sum is tensor(0.0460, device='cuda:2')
sum is tensor(0.4180, device='cuda:2')
sum is tensor(1.1979, device='cuda:2')
sum is tensor(12.9304, device='cuda:2')
sum is tensor(137.0149, device='cuda:2')
ratio is tensor(0.5792, device='cuda:2')
threshold is tensor(124.0845, device='cuda:2')
cal diff is tensor(0.7799, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.7325, device='cuda:2')
discard
cal diff is tensor(0.0120, device='cuda:2')
discard
cal diff is tensor(124.0845, device='cuda:2')
clipping
cal diff is tensor(0.0252, device='cuda:2')
discard
cal diff is tensor(0.3719, device='cuda:2')
discard
cal diff is tensor(0.0023, device='cuda:2')
discard
________________________________
test distance is  tensor(71.8899, device='cuda:2')
test acc is  0.981183333489652
test loss is 0.0644259880657583
test entropy is  0.030814145298372245
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.030814145298372245
avg test loss is  0.0644259880657583
avg accuracy is  0.981183333489652
compute_distance is  tensor(71.8899, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15635215332195448
avg test loss is  2.006013132361715
avg accuracy is  0.705116666822997
compute_distance is  tensor(137.1561, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(137.1561, device='cuda:2')
test acc is  0.705116666822997
test loss is 2.006013132361715
test entropy is  0.15635215332195448
________________________________
diff is  tensor(0.7800, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.7583, device='cuda:2')
diff is  tensor(0.0120, device='cuda:2')
diff is  tensor(124.1804, device='cuda:2')
diff is  tensor(0.0253, device='cuda:2')
diff is  tensor(0.3713, device='cuda:2')
diff is  tensor(0.0023, device='cuda:2')
threshold is  tensor(65.2632, device='cuda:2')
sum is tensor(0.0023, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0209, device='cuda:2')
sum is tensor(0.0462, device='cuda:2')
sum is tensor(0.4175, device='cuda:2')
sum is tensor(1.1975, device='cuda:2')
sum is tensor(12.9558, device='cuda:2')
sum is tensor(137.1362, device='cuda:2')
ratio is tensor(0.5788, device='cuda:2')
threshold is tensor(124.1804, device='cuda:2')
cal diff is tensor(0.7800, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.7583, device='cuda:2')
discard
cal diff is tensor(0.0120, device='cuda:2')
discard
cal diff is tensor(124.1804, device='cuda:2')
clipping
cal diff is tensor(0.0253, device='cuda:2')
discard
cal diff is tensor(0.3713, device='cuda:2')
discard
cal diff is tensor(0.0023, device='cuda:2')
discard
________________________________
test distance is  tensor(71.8899, device='cuda:2')
test acc is  0.9812166668229854
test loss is 0.06406428160822865
test entropy is  0.030656646964505926
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.030656646964505926
avg test loss is  0.06406428160822865
avg accuracy is  0.9812166668229854
compute_distance is  tensor(71.8899, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15637356047230616
avg test loss is  2.006986251200186
avg accuracy is  0.7052000001563303
compute_distance is  tensor(137.2135, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.16% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0012332125334069133
attack res is False
len of model dicts is  10
compute distance is  tensor(16.6173, device='cuda:2')
compute distance is  tensor(61.0885, device='cuda:2')
compute distance is  tensor(39.9638, device='cuda:2')
compute distance is  tensor(78.7120, device='cuda:2')
compute distance is  tensor(41.7643, device='cuda:2')
compute distance is  tensor(55.7288, device='cuda:2')
compute distance is  tensor(42.8498, device='cuda:2')
compute distance is  tensor(57.3209, device='cuda:2')
compute distance is  tensor(53.8609, device='cuda:2')
compute distance is  tensor(43.8411, device='cuda:2')
calculated distance threshold is  tensor(67.4221, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7246666668229961
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8596833334896563
====================
====================
iteration is  0
round is  2
accuracy is  0.9065333334896545
====================
====================
iteration is  1
round is  0
accuracy is  0.7658166668229938
====================
====================
iteration is  1
round is  1
accuracy is  0.817283333489658
====================
====================
iteration is  1
round is  2
accuracy is  0.7672166668229937
====================
====================
iteration is  2
round is  0
accuracy is  0.837250000156324
====================
________________________________
test distance is  tensor(4281.5591, device='cuda:2')
test acc is  0.7246666668229961
test loss is 1.8869964785413194
test entropy is  0.1424038781206618
________________________________
diff is  tensor(44.5575, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3014, device='cuda:2', dtype=torch.float64)
diff is  tensor(572.7956, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5236, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.9501, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0270, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2294, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1745, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4214.1372, device='cuda:2')
sum is tensor(0.1745, device='cuda:2', dtype=torch.float64)
sum is tensor(0.4759, device='cuda:2', dtype=torch.float64)
sum is tensor(0.9995, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0265, device='cuda:2', dtype=torch.float64)
sum is tensor(23.2559, device='cuda:2', dtype=torch.float64)
sum is tensor(67.8133, device='cuda:2', dtype=torch.float64)
sum is tensor(640.6089, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.5591, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0185, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.9501, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.5575, device='cuda:2')
discard
cal diff is tensor(0.3014, device='cuda:2')
discard
cal diff is tensor(572.7956, device='cuda:2')
discard
cal diff is tensor(0.5236, device='cuda:2')
discard
cal diff is tensor(3640.9502, device='cuda:2')
clipping
cal diff is tensor(2.0270, device='cuda:2')
discard
cal diff is tensor(20.2294, device='cuda:2')
discard
cal diff is tensor(0.1745, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4321, device='cuda:2')
test acc is  0.9932500001563184
test loss is 0.024390965218581456
test entropy is  0.011928167621573093
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4219, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0100, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0215, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4219, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(1.4622, device='cuda:2')
test acc is  0.993216666822985
test loss is 0.02438616736769022
test entropy is  0.01191804657512416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01191804657512416
avg test loss is  0.02438616736769022
avg accuracy is  0.993216666822985
compute_distance is  tensor(1.4622, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1436744878080481
avg test loss is  1.3128384768263872
avg accuracy is  0.7600333334896608
compute_distance is  tensor(86.2598, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(86.2598, device='cuda:2')
test acc is  0.7600333334896608
test loss is 1.3128384768263872
test entropy is  0.1436744878080481
________________________________
diff is  tensor(0.7106, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(10.7536, device='cuda:2')
diff is  tensor(0.0120, device='cuda:2')
diff is  tensor(74.1445, device='cuda:2')
diff is  tensor(0.0445, device='cuda:2')
diff is  tensor(0.5860, device='cuda:2')
diff is  tensor(0.0049, device='cuda:2')
threshold is  tensor(18.8377, device='cuda:2')
sum is tensor(0.0049, device='cuda:2')
sum is tensor(0.0117, device='cuda:2')
sum is tensor(0.0237, device='cuda:2')
sum is tensor(0.0682, device='cuda:2')
sum is tensor(0.6542, device='cuda:2')
sum is tensor(1.3648, device='cuda:2')
sum is tensor(12.1183, device='cuda:2')
sum is tensor(86.2628, device='cuda:2')
ratio is tensor(0.9094, device='cuda:2')
threshold is tensor(74.1445, device='cuda:2')
cal diff is tensor(0.7106, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(10.7536, device='cuda:2')
discard
cal diff is tensor(0.0120, device='cuda:2')
discard
cal diff is tensor(74.1445, device='cuda:2')
clipping
cal diff is tensor(0.0445, device='cuda:2')
discard
cal diff is tensor(0.5860, device='cuda:2')
discard
cal diff is tensor(0.0049, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4326, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.1925031906081317
test entropy is  0.054589035516696124
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4253, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0105, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4355, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2')
threshold is tensor(67.4253, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4253, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(67.4323, device='cuda:2')
test acc is  0.950733333489653
test loss is 0.19250053995337807
test entropy is  0.05458860867408547
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.4250, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.4352, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(67.4250, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.4250, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.15% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0014233808033168316
attack res is False
len of model dicts is  10
compute distance is  tensor(16.6207, device='cuda:2')
compute distance is  tensor(46.3370, device='cuda:2')
compute distance is  tensor(55.8717, device='cuda:2')
compute distance is  tensor(97.3488, device='cuda:2')
compute distance is  tensor(39.6884, device='cuda:2')
compute distance is  tensor(59.5991, device='cuda:2')
compute distance is  tensor(62.5322, device='cuda:2')
compute distance is  tensor(50.0520, device='cuda:2')
compute distance is  tensor(70.3933, device='cuda:2')
compute distance is  tensor(41.3878, device='cuda:2')
calculated distance threshold is  tensor(82.6709, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8655666668229894
====================
====================
iteration is  0
round is  1
accuracy is  0.8849666668229886
====================
====================
iteration is  0
round is  2
accuracy is  0.6804333334896653
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.7099833334896636
====================
====================
iteration is  1
round is  1
accuracy is  0.7567000001563279
====================
====================
iteration is  1
round is  2
accuracy is  0.7354666668229953
====================
====================
iteration is  2
round is  0
accuracy is  0.8016166668229922
====================
________________________________
test distance is  tensor(4279.7373, device='cuda:2')
test acc is  0.6804333334896653
test loss is 2.2116071190407025
test entropy is  0.14797338999426568
________________________________
diff is  tensor(44.1497, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3305, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.5892, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4917, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.4654, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0428, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4346, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2335, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4197.0664, device='cuda:2')
sum is tensor(0.2335, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5640, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0557, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0985, device='cuda:2', dtype=torch.float64)
sum is tensor(23.5330, device='cuda:2', dtype=torch.float64)
sum is tensor(67.6827, device='cuda:2', dtype=torch.float64)
sum is tensor(639.2719, device='cuda:2', dtype=torch.float64)
sum is tensor(4279.7373, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0227, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.4654, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.1497, device='cuda:2')
discard
cal diff is tensor(0.3305, device='cuda:2')
discard
cal diff is tensor(571.5892, device='cuda:2')
discard
cal diff is tensor(0.4917, device='cuda:2')
discard
cal diff is tensor(3640.4653, device='cuda:2')
discard
cal diff is tensor(2.0428, device='cuda:2')
discard
cal diff is tensor(20.4346, device='cuda:2')
discard
cal diff is tensor(0.2335, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9931833334896517
test loss is 0.024375197176133956
test entropy is  0.011881758582341858
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011881758582341858
avg test loss is  0.024375197176133956
avg accuracy is  0.9931833334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16080230228237505
avg test loss is  1.6869460593726335
avg accuracy is  0.7104000001563301
compute_distance is  tensor(85.9793, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.9793, device='cuda:2')
test acc is  0.7104000001563301
test loss is 1.6869460593726335
test entropy is  0.16080230228237505
________________________________
diff is  tensor(0.7933, device='cuda:2')
diff is  tensor(0.0061, device='cuda:2')
diff is  tensor(10.6192, device='cuda:2')
diff is  tensor(0.0102, device='cuda:2')
diff is  tensor(73.9429, device='cuda:2')
diff is  tensor(0.0452, device='cuda:2')
diff is  tensor(0.5612, device='cuda:2')
diff is  tensor(0.0046, device='cuda:2')
threshold is  tensor(3.3084, device='cuda:2')
sum is tensor(0.0046, device='cuda:2')
sum is tensor(0.0107, device='cuda:2')
sum is tensor(0.0209, device='cuda:2')
sum is tensor(0.0661, device='cuda:2')
sum is tensor(0.6273, device='cuda:2')
sum is tensor(1.4206, device='cuda:2')
sum is tensor(12.0398, device='cuda:2')
ratio is tensor(0.8222, device='cuda:2')
threshold is tensor(10.6192, device='cuda:2')
cal diff is tensor(0.7933, device='cuda:2')
discard
cal diff is tensor(0.0061, device='cuda:2')
discard
cal diff is tensor(10.6192, device='cuda:2')
clipping
cal diff is tensor(0.0102, device='cuda:2')
discard
cal diff is tensor(73.9429, device='cuda:2')
clipping
cal diff is tensor(0.0452, device='cuda:2')
discard
cal diff is tensor(0.5612, device='cuda:2')
discard
cal diff is tensor(0.0046, device='cuda:2')
discard
________________________________
test distance is  tensor(69.5277, device='cuda:2')
test acc is  0.9030666668229881
test loss is 0.3860418220037726
test entropy is  0.08892911317339267
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08892911317339267
avg test loss is  0.3860418220037726
avg accuracy is  0.9030666668229881
compute_distance is  tensor(69.5277, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15767339897006433
avg test loss is  1.735182171627911
avg accuracy is  0.7063333334896638
compute_distance is  tensor(118.4760, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(118.4760, device='cuda:2')
test acc is  0.7063333334896638
test loss is 1.735182171627911
test entropy is  0.15767339897006433
________________________________
diff is  tensor(0.6305, device='cuda:2')
diff is  tensor(0.0042, device='cuda:2')
diff is  tensor(14.5227, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(102.8894, device='cuda:2')
diff is  tensor(0.0174, device='cuda:2')
diff is  tensor(0.3926, device='cuda:2')
diff is  tensor(0.0015, device='cuda:2')
threshold is  tensor(35.8051, device='cuda:2')
sum is tensor(0.0015, device='cuda:2')
sum is tensor(0.0057, device='cuda:2')
sum is tensor(0.0127, device='cuda:2')
sum is tensor(0.0301, device='cuda:2')
sum is tensor(0.4227, device='cuda:2')
sum is tensor(1.0532, device='cuda:2')
sum is tensor(15.5759, device='cuda:2')
sum is tensor(118.4653, device='cuda:2')
ratio is tensor(0.8034, device='cuda:2')
threshold is tensor(102.8894, device='cuda:2')
cal diff is tensor(0.6305, device='cuda:2')
discard
cal diff is tensor(0.0042, device='cuda:2')
discard
cal diff is tensor(14.5227, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(102.8894, device='cuda:2')
clipping
cal diff is tensor(0.0174, device='cuda:2')
discard
cal diff is tensor(0.3926, device='cuda:2')
discard
cal diff is tensor(0.0015, device='cuda:2')
discard
________________________________
test distance is  tensor(82.6744, device='cuda:2')
test acc is  0.9668333334896524
test loss is 0.11305392765630587
test entropy is  0.04524426804494305
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(82.6598, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0035, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7439, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(82.6598, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(61.5060, device='cuda:2')
test acc is  0.984733333489652
test loss is 0.05257614518955255
test entropy is  0.025366832956413937
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.025366832956413937
avg test loss is  0.05257614518955255
avg accuracy is  0.984733333489652
compute_distance is  tensor(61.5060, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15969643450336163
avg test loss is  1.7551234007072347
avg accuracy is  0.7036333334896638
compute_distance is  tensor(121.9183, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(121.9183, device='cuda:2')
test acc is  0.7036333334896638
test loss is 1.7551234007072347
test entropy is  0.15969643450336163
________________________________
diff is  tensor(0.6904, device='cuda:2')
diff is  tensor(0.0061, device='cuda:2')
diff is  tensor(9.8129, device='cuda:2')
diff is  tensor(0.0102, device='cuda:2')
diff is  tensor(110.9728, device='cuda:2')
diff is  tensor(0.0247, device='cuda:2')
diff is  tensor(0.3858, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(39.2474, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0086, device='cuda:2')
sum is tensor(0.0188, device='cuda:2')
sum is tensor(0.0435, device='cuda:2')
sum is tensor(0.4293, device='cuda:2')
sum is tensor(1.1197, device='cuda:2')
sum is tensor(10.9326, device='cuda:2')
sum is tensor(121.9054, device='cuda:2')
ratio is tensor(0.7448, device='cuda:2')
threshold is tensor(110.9728, device='cuda:2')
cal diff is tensor(0.6904, device='cuda:2')
discard
cal diff is tensor(0.0061, device='cuda:2')
discard
cal diff is tensor(9.8129, device='cuda:2')
discard
cal diff is tensor(0.0102, device='cuda:2')
discard
cal diff is tensor(110.9728, device='cuda:2')
clipping
cal diff is tensor(0.0247, device='cuda:2')
discard
cal diff is tensor(0.3858, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(82.6720, device='cuda:2')
test acc is  0.9632000001563193
test loss is 0.12480280860855894
test entropy is  0.04971205058402376
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(82.6575, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0011, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.1068, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(82.6575, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(8.8411, device='cuda:2')
test acc is  0.9929666668229851
test loss is 0.02429006522140262
test entropy is  0.012127062456248963
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012127062456248963
avg test loss is  0.02429006522140262
avg accuracy is  0.9929666668229851
compute_distance is  tensor(8.8411, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16108994178775785
avg test loss is  1.697167543777779
avg accuracy is  0.7088833334896635
compute_distance is  tensor(91.0050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.0050, device='cuda:2')
test acc is  0.7088833334896635
test loss is 1.697167543777779
test entropy is  0.16108994178775785
________________________________
diff is  tensor(0.7711, device='cuda:2')
diff is  tensor(0.0060, device='cuda:2')
diff is  tensor(10.6895, device='cuda:2')
diff is  tensor(0.0109, device='cuda:2')
diff is  tensor(78.9509, device='cuda:2')
diff is  tensor(0.0415, device='cuda:2')
diff is  tensor(0.5303, device='cuda:2')
diff is  tensor(0.0042, device='cuda:2')
threshold is  tensor(8.3341, device='cuda:2')
sum is tensor(0.0042, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(0.0211, device='cuda:2')
sum is tensor(0.0625, device='cuda:2')
sum is tensor(0.5928, device='cuda:2')
sum is tensor(1.3639, device='cuda:2')
sum is tensor(12.0534, device='cuda:2')
ratio is tensor(0.3479, device='cuda:2')
threshold is tensor(10.6895, device='cuda:2')
cal diff is tensor(0.7711, device='cuda:2')
discard
cal diff is tensor(0.0060, device='cuda:2')
discard
cal diff is tensor(10.6895, device='cuda:2')
clipping
cal diff is tensor(0.0109, device='cuda:2')
discard
cal diff is tensor(78.9509, device='cuda:2')
clipping
cal diff is tensor(0.0415, device='cuda:2')
discard
cal diff is tensor(0.5303, device='cuda:2')
discard
cal diff is tensor(0.0042, device='cuda:2')
discard
________________________________
test distance is  tensor(31.1915, device='cuda:2')
test acc is  0.9905500001563183
test loss is 0.032648502101900394
test entropy is  0.016769198702627896
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.016769198702627896
avg test loss is  0.032648502101900394
avg accuracy is  0.9905500001563183
compute_distance is  tensor(31.1915, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16076626173500566
avg test loss is  1.725080293982522
avg accuracy is  0.7060333334896637
compute_distance is  tensor(100.4583, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(100.4583, device='cuda:2')
test acc is  0.7060333334896637
test loss is 1.725080293982522
test entropy is  0.16076626173500566
________________________________
diff is  tensor(0.6888, device='cuda:2')
diff is  tensor(0.0060, device='cuda:2')
diff is  tensor(13.1967, device='cuda:2')
diff is  tensor(0.0103, device='cuda:2')
diff is  tensor(86.0696, device='cuda:2')
diff is  tensor(0.0292, device='cuda:2')
diff is  tensor(0.4494, device='cuda:2')
diff is  tensor(0.0031, device='cuda:2')
threshold is  tensor(17.7873, device='cuda:2')
sum is tensor(0.0031, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0194, device='cuda:2')
sum is tensor(0.0486, device='cuda:2')
sum is tensor(0.4980, device='cuda:2')
sum is tensor(1.1868, device='cuda:2')
sum is tensor(14.3835, device='cuda:2')
sum is tensor(100.4531, device='cuda:2')
ratio is tensor(0.9605, device='cuda:2')
threshold is tensor(86.0696, device='cuda:2')
cal diff is tensor(0.6888, device='cuda:2')
discard
cal diff is tensor(0.0060, device='cuda:2')
discard
cal diff is tensor(13.1967, device='cuda:2')
discard
cal diff is tensor(0.0103, device='cuda:2')
discard
cal diff is tensor(86.0696, device='cuda:2')
clipping
cal diff is tensor(0.0292, device='cuda:2')
discard
cal diff is tensor(0.4494, device='cuda:2')
discard
cal diff is tensor(0.0031, device='cuda:2')
discard
________________________________
test distance is  tensor(82.6763, device='cuda:2')
test acc is  0.9370333334896536
test loss is 0.230647590269073
test entropy is  0.06914341359732867
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(82.6657, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0054, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5374, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(82.6657, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(44.4347, device='cuda:2')
test acc is  0.9880500001563185
test loss is 0.04132991960309221
test entropy is  0.02076772161780721
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02076772161780721
avg test loss is  0.04132991960309221
avg accuracy is  0.9880500001563185
compute_distance is  tensor(44.4347, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16093545679503413
avg test loss is  1.7356352502031367
avg accuracy is  0.7054666668229971
compute_distance is  tensor(111.0626, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(111.0626, device='cuda:2')
test acc is  0.7054666668229971
test loss is 1.7356352502031367
test entropy is  0.16093545679503413
________________________________
diff is  tensor(0.7053, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(10.1764, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(99.7005, device='cuda:2')
diff is  tensor(0.0275, device='cuda:2')
diff is  tensor(0.4236, device='cuda:2')
diff is  tensor(0.0028, device='cuda:2')
threshold is  tensor(28.3917, device='cuda:2')
sum is tensor(0.0028, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0200, device='cuda:2')
sum is tensor(0.0475, device='cuda:2')
sum is tensor(0.4712, device='cuda:2')
sum is tensor(1.1764, device='cuda:2')
sum is tensor(11.3528, device='cuda:2')
sum is tensor(111.0533, device='cuda:2')
ratio is tensor(0.8291, device='cuda:2')
threshold is tensor(99.7005, device='cuda:2')
cal diff is tensor(0.7053, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(10.1764, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(99.7005, device='cuda:2')
clipping
cal diff is tensor(0.0275, device='cuda:2')
discard
cal diff is tensor(0.4236, device='cuda:2')
discard
cal diff is tensor(0.0028, device='cuda:2')
discard
________________________________
test distance is  tensor(82.6735, device='cuda:2')
test acc is  0.9490333334896531
test loss is 0.17933517432821144
test entropy is  0.06181261261879429
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(82.6615, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0025, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8510, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(82.6615, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(70.3542, device='cuda:2')
test acc is  0.971100000156319
test loss is 0.09756014081988691
test entropy is  0.04147779190164955
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04147779190164955
avg test loss is  0.09756014081988691
avg accuracy is  0.971100000156319
compute_distance is  tensor(70.3542, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15965829374217022
avg test loss is  1.7570397646696583
avg accuracy is  0.7037833334896638
compute_distance is  tensor(127.0413, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(127.0413, device='cuda:2')
test acc is  0.7037833334896638
test loss is 1.7570397646696583
test entropy is  0.15965829374217022
________________________________
diff is  tensor(0.6834, device='cuda:2')
diff is  tensor(0.0053, device='cuda:2')
diff is  tensor(9.1557, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(116.7771, device='cuda:2')
diff is  tensor(0.0208, device='cuda:2')
diff is  tensor(0.3733, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(44.3704, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0074, device='cuda:2')
sum is tensor(0.0165, device='cuda:2')
sum is tensor(0.0373, device='cuda:2')
sum is tensor(0.4106, device='cuda:2')
sum is tensor(1.0940, device='cuda:2')
sum is tensor(10.2497, device='cuda:2')
sum is tensor(127.0268, device='cuda:2')
ratio is tensor(0.7078, device='cuda:2')
threshold is tensor(116.7771, device='cuda:2')
cal diff is tensor(0.6834, device='cuda:2')
discard
cal diff is tensor(0.0053, device='cuda:2')
discard
cal diff is tensor(9.1557, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(116.7771, device='cuda:2')
clipping
cal diff is tensor(0.0208, device='cuda:2')
discard
cal diff is tensor(0.3733, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(82.6704, device='cuda:2')
test acc is  0.9654333334896525
test loss is 0.11755921048459908
test entropy is  0.04809184456509707
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04809184456509707
avg test loss is  0.11755921048459908
avg accuracy is  0.9654333334896525
compute_distance is  tensor(82.6704, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15879330754295976
avg test loss is  1.7722033013794214
avg accuracy is  0.7024666668229973
compute_distance is  tensor(136.4181, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.15% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00162497500423342
attack res is False
len of model dicts is  10
compute distance is  tensor(15.6515, device='cuda:2')
compute distance is  tensor(100.5358, device='cuda:2')
compute distance is  tensor(58.4293, device='cuda:2')
compute distance is  tensor(90.1249, device='cuda:2')
compute distance is  tensor(35.4833, device='cuda:2')
compute distance is  tensor(53.3215, device='cuda:2')
compute distance is  tensor(31.5899, device='cuda:2')
compute distance is  tensor(38.6258, device='cuda:2')
compute distance is  tensor(73.5463, device='cuda:2')
compute distance is  tensor(30.8977, device='cuda:2')
calculated distance threshold is  tensor(85.1023, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8468833334896568
====================
====================
iteration is  0
round is  1
accuracy is  0.8776833334896555
====================
====================
iteration is  0
round is  2
accuracy is  0.8867333334896553
====================
====================
iteration is  1
round is  0
accuracy is  0.5701500001563402
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7360000001563288
====================
====================
iteration is  1
round is  2
accuracy is  0.7511000001563278
====================
====================
iteration is  2
round is  0
accuracy is  0.7263000001563293
====================
====================
iteration is  2
round is  1
accuracy is  0.8394000001563239
====================
________________________________
test distance is  tensor(4708.0244, device='cuda:2')
test acc is  0.5701500001563402
test loss is 4.515442657826552
test entropy is  0.13665251805584058
________________________________
diff is  tensor(46.8736, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4176, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.5791, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5668, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.9859, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2786, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.1151, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2075, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4622.9219, device='cuda:2')
sum is tensor(0.2075, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6251, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1919, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4705, device='cuda:2', dtype=torch.float64)
sum is tensor(25.5856, device='cuda:2', dtype=torch.float64)
sum is tensor(72.4593, device='cuda:2', dtype=torch.float64)
sum is tensor(702.0384, device='cuda:2', dtype=torch.float64)
sum is tensor(4708.0243, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0212, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.9859, device='cuda:2', dtype=torch.float64)
cal diff is tensor(46.8736, device='cuda:2')
discard
cal diff is tensor(0.4176, device='cuda:2')
discard
cal diff is tensor(629.5791, device='cuda:2')
discard
cal diff is tensor(0.5668, device='cuda:2')
discard
cal diff is tensor(4005.9858, device='cuda:2')
discard
cal diff is tensor(2.2786, device='cuda:2')
discard
cal diff is tensor(22.1151, device='cuda:2')
discard
cal diff is tensor(0.2075, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9931833334896517
test loss is 0.024440266990705558
test entropy is  0.011740193632519465
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011740193632519465
avg test loss is  0.024440266990705558
avg accuracy is  0.9931833334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13989024296371158
avg test loss is  3.445981176677289
avg accuracy is  0.593166666823005
compute_distance is  tensor(93.8296, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.8296, device='cuda:2')
test acc is  0.593166666823005
test loss is 3.445981176677289
test entropy is  0.13989024296371158
________________________________
diff is  tensor(0.7581, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(13.2093, device='cuda:2')
diff is  tensor(0.0139, device='cuda:2')
diff is  tensor(79.1588, device='cuda:2')
diff is  tensor(0.0493, device='cuda:2')
diff is  tensor(0.6312, device='cuda:2')
diff is  tensor(0.0049, device='cuda:2')
threshold is  tensor(8.7273, device='cuda:2')
sum is tensor(0.0049, device='cuda:2')
sum is tensor(0.0113, device='cuda:2')
sum is tensor(0.0252, device='cuda:2')
sum is tensor(0.0745, device='cuda:2')
sum is tensor(0.7057, device='cuda:2')
sum is tensor(1.4638, device='cuda:2')
sum is tensor(14.6731, device='cuda:2')
ratio is tensor(0.4501, device='cuda:2')
threshold is tensor(13.2093, device='cuda:2')
cal diff is tensor(0.7581, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(13.2093, device='cuda:2')
clipping
cal diff is tensor(0.0139, device='cuda:2')
discard
cal diff is tensor(79.1588, device='cuda:2')
clipping
cal diff is tensor(0.0493, device='cuda:2')
discard
cal diff is tensor(0.6312, device='cuda:2')
discard
cal diff is tensor(0.0049, device='cuda:2')
discard
________________________________
test distance is  tensor(41.5765, device='cuda:2')
test acc is  0.9841833334896519
test loss is 0.055545412791420536
test entropy is  0.02600237759205809
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02600237759205809
avg test loss is  0.055545412791420536
avg accuracy is  0.9841833334896519
compute_distance is  tensor(41.5765, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1391757227369209
avg test loss is  3.5718480306647735
avg accuracy is  0.5863166668230055
compute_distance is  tensor(110.8850, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(110.8850, device='cuda:2')
test acc is  0.5863166668230055
test loss is 3.5718480306647735
test entropy is  0.1391757227369209
________________________________
diff is  tensor(0.6618, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(15.9707, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(93.7177, device='cuda:2')
diff is  tensor(0.0294, device='cuda:2')
diff is  tensor(0.4785, device='cuda:2')
diff is  tensor(0.0031, device='cuda:2')
threshold is  tensor(25.7827, device='cuda:2')
sum is tensor(0.0031, device='cuda:2')
sum is tensor(0.0099, device='cuda:2')
sum is tensor(0.0207, device='cuda:2')
sum is tensor(0.0501, device='cuda:2')
sum is tensor(0.5286, device='cuda:2')
sum is tensor(1.1904, device='cuda:2')
sum is tensor(17.1611, device='cuda:2')
sum is tensor(110.8788, device='cuda:2')
ratio is tensor(0.9080, device='cuda:2')
threshold is tensor(93.7177, device='cuda:2')
cal diff is tensor(0.6618, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(15.9707, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(93.7177, device='cuda:2')
clipping
cal diff is tensor(0.0294, device='cuda:2')
discard
cal diff is tensor(0.4785, device='cuda:2')
discard
cal diff is tensor(0.0031, device='cuda:2')
discard
________________________________
test distance is  tensor(85.1051, device='cuda:2')
test acc is  0.9387500001563199
test loss is 0.22062186166288644
test entropy is  0.0821110767804817
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(85.0961, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0028, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8215, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(85.0961, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.9126, device='cuda:2')
test acc is  0.9717333334896523
test loss is 0.10258934314049699
test entropy is  0.04591354918080384
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04591354918080384
avg test loss is  0.10258934314049699
avg accuracy is  0.9717333334896523
compute_distance is  tensor(69.9126, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13938176010781006
avg test loss is  3.61647449093841
avg accuracy is  0.5854333334896722
compute_distance is  tensor(132.8551, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(132.8551, device='cuda:2')
test acc is  0.5854333334896722
test loss is 3.61647449093841
test entropy is  0.13938176010781006
________________________________
diff is  tensor(0.7460, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(10.8822, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(120.7412, device='cuda:2')
diff is  tensor(0.0267, device='cuda:2')
diff is  tensor(0.4261, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(47.7528, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0468, device='cuda:2')
sum is tensor(0.4729, device='cuda:2')
sum is tensor(1.2189, device='cuda:2')
sum is tensor(12.1011, device='cuda:2')
sum is tensor(132.8423, device='cuda:2')
ratio is tensor(0.7047, device='cuda:2')
threshold is tensor(120.7412, device='cuda:2')
cal diff is tensor(0.7460, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(10.8822, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(120.7412, device='cuda:2')
clipping
cal diff is tensor(0.0267, device='cuda:2')
discard
cal diff is tensor(0.4261, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(85.1004, device='cuda:2')
test acc is  0.9549000001563195
test loss is 0.16142507935730196
test entropy is  0.06876604493929823
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.06876604493929823
avg test loss is  0.16142507935730196
avg accuracy is  0.9549000001563195
compute_distance is  tensor(85.1004, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13990028265283813
avg test loss is  3.634773838113366
avg accuracy is  0.5851333334896723
compute_distance is  tensor(144.2192, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(144.2192, device='cuda:2')
test acc is  0.5851333334896723
test loss is 3.634773838113366
test entropy is  0.13990028265283813
________________________________
diff is  tensor(0.7896, device='cuda:2')
diff is  tensor(0.0062, device='cuda:2')
diff is  tensor(10.3533, device='cuda:2')
diff is  tensor(0.0105, device='cuda:2')
diff is  tensor(132.6224, device='cuda:2')
diff is  tensor(0.0237, device='cuda:2')
diff is  tensor(0.3947, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(59.1169, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0086, device='cuda:2')
sum is tensor(0.0191, device='cuda:2')
sum is tensor(0.0428, device='cuda:2')
sum is tensor(0.4375, device='cuda:2')
sum is tensor(1.2271, device='cuda:2')
sum is tensor(11.5803, device='cuda:2')
sum is tensor(144.2027, device='cuda:2')
ratio is tensor(0.6416, device='cuda:2')
threshold is tensor(132.6224, device='cuda:2')
cal diff is tensor(0.7896, device='cuda:2')
discard
cal diff is tensor(0.0062, device='cuda:2')
discard
cal diff is tensor(10.3533, device='cuda:2')
discard
cal diff is tensor(0.0105, device='cuda:2')
discard
cal diff is tensor(132.6224, device='cuda:2')
clipping
cal diff is tensor(0.0237, device='cuda:2')
discard
cal diff is tensor(0.3947, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(85.0986, device='cuda:2')
test acc is  0.9647166668229858
test loss is 0.12486450470361446
test entropy is  0.05683104325629977
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05683104325629977
avg test loss is  0.12486450470361446
avg accuracy is  0.9647166668229858
compute_distance is  tensor(85.0986, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1399852911482996
avg test loss is  3.640011730224593
avg accuracy is  0.5850833334896723
compute_distance is  tensor(145.9870, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.9870, device='cuda:2')
test acc is  0.5850833334896723
test loss is 3.640011730224593
test entropy is  0.1399852911482996
________________________________
diff is  tensor(0.7927, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(10.6755, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(134.0637, device='cuda:2')
diff is  tensor(0.0245, device='cuda:2')
diff is  tensor(0.3934, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(60.8847, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0197, device='cuda:2')
sum is tensor(0.0442, device='cuda:2')
sum is tensor(0.4376, device='cuda:2')
sum is tensor(1.2303, device='cuda:2')
sum is tensor(11.9058, device='cuda:2')
sum is tensor(145.9695, device='cuda:2')
ratio is tensor(0.6347, device='cuda:2')
threshold is tensor(134.0637, device='cuda:2')
cal diff is tensor(0.7927, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(10.6755, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(134.0637, device='cuda:2')
clipping
cal diff is tensor(0.0245, device='cuda:2')
discard
cal diff is tensor(0.3934, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(85.0985, device='cuda:2')
test acc is  0.9679333334896524
test loss is 0.11443352984813805
test entropy is  0.0529186473891282
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0529186473891282
avg test loss is  0.11443352984813805
avg accuracy is  0.9679333334896524
compute_distance is  tensor(85.0985, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13996796571671455
avg test loss is  3.643783961786136
avg accuracy is  0.5849166668230057
compute_distance is  tensor(146.6121, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.6121, device='cuda:2')
test acc is  0.5849166668230057
test loss is 3.643783961786136
test entropy is  0.13996796571671455
________________________________
diff is  tensor(0.7936, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(10.8234, device='cuda:2')
diff is  tensor(0.0110, device='cuda:2')
diff is  tensor(134.5379, device='cuda:2')
diff is  tensor(0.0249, device='cuda:2')
diff is  tensor(0.3942, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.5098, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0199, device='cuda:2')
sum is tensor(0.0449, device='cuda:2')
sum is tensor(0.4391, device='cuda:2')
sum is tensor(1.2326, device='cuda:2')
sum is tensor(12.0560, device='cuda:2')
sum is tensor(146.5939, device='cuda:2')
ratio is tensor(0.6324, device='cuda:2')
threshold is tensor(134.5379, device='cuda:2')
cal diff is tensor(0.7936, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(10.8234, device='cuda:2')
discard
cal diff is tensor(0.0110, device='cuda:2')
discard
cal diff is tensor(134.5379, device='cuda:2')
clipping
cal diff is tensor(0.0249, device='cuda:2')
discard
cal diff is tensor(0.3942, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(85.0984, device='cuda:2')
test acc is  0.9690666668229856
test loss is 0.11068838730677595
test entropy is  0.05141412194392312
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05141412194392312
avg test loss is  0.11068838730677595
avg accuracy is  0.9690666668229856
compute_distance is  tensor(85.0984, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13993861183111092
avg test loss is  3.645572895561454
avg accuracy is  0.584900000156339
compute_distance is  tensor(146.9615, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.9615, device='cuda:2')
test acc is  0.584900000156339
test loss is 3.645572895561454
test entropy is  0.13993861183111092
________________________________
diff is  tensor(0.7939, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(10.8894, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(134.8200, device='cuda:2')
diff is  tensor(0.0251, device='cuda:2')
diff is  tensor(0.3944, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.8592, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0451, device='cuda:2')
sum is tensor(0.4396, device='cuda:2')
sum is tensor(1.2334, device='cuda:2')
sum is tensor(12.1228, device='cuda:2')
sum is tensor(146.9428, device='cuda:2')
ratio is tensor(0.6311, device='cuda:2')
threshold is tensor(134.8200, device='cuda:2')
cal diff is tensor(0.7939, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(10.8894, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(134.8200, device='cuda:2')
clipping
cal diff is tensor(0.0251, device='cuda:2')
discard
cal diff is tensor(0.3944, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(85.0983, device='cuda:2')
test acc is  0.969750000156319
test loss is 0.1088515079254086
test entropy is  0.05064162109091854
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05064162109091854
avg test loss is  0.1088515079254086
avg accuracy is  0.969750000156319
compute_distance is  tensor(85.0983, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13992714881102666
avg test loss is  3.6465603214845475
avg accuracy is  0.5848333334896724
compute_distance is  tensor(147.0900, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.0900, device='cuda:2')
test acc is  0.5848333334896724
test loss is 3.6465603214845475
test entropy is  0.13992714881102666
________________________________
diff is  tensor(0.7936, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(10.9245, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(134.9133, device='cuda:2')
diff is  tensor(0.0252, device='cuda:2')
diff is  tensor(0.3943, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.9877, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0453, device='cuda:2')
sum is tensor(0.4396, device='cuda:2')
sum is tensor(1.2332, device='cuda:2')
sum is tensor(12.1577, device='cuda:2')
sum is tensor(147.0710, device='cuda:2')
ratio is tensor(0.6307, device='cuda:2')
threshold is tensor(134.9133, device='cuda:2')
cal diff is tensor(0.7936, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(10.9245, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(134.9133, device='cuda:2')
clipping
cal diff is tensor(0.0252, device='cuda:2')
discard
cal diff is tensor(0.3943, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(85.0983, device='cuda:2')
test acc is  0.9699833334896523
test loss is 0.10796660104688174
test entropy is  0.05024723479224405
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05024723479224405
avg test loss is  0.10796660104688174
avg accuracy is  0.9699833334896523
compute_distance is  tensor(85.0983, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13993311478400916
avg test loss is  3.646510445868283
avg accuracy is  0.584800000156339
compute_distance is  tensor(147.1999, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.1999, device='cuda:2')
test acc is  0.584800000156339
test loss is 3.646510445868283
test entropy is  0.13993311478400916
________________________________
diff is  tensor(0.7932, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(10.9413, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(135.0067, device='cuda:2')
diff is  tensor(0.0253, device='cuda:2')
diff is  tensor(0.3942, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(62.0976, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0454, device='cuda:2')
sum is tensor(0.4395, device='cuda:2')
sum is tensor(1.2327, device='cuda:2')
sum is tensor(12.1740, device='cuda:2')
sum is tensor(147.1807, device='cuda:2')
ratio is tensor(0.6302, device='cuda:2')
threshold is tensor(135.0067, device='cuda:2')
cal diff is tensor(0.7932, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(10.9413, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(135.0067, device='cuda:2')
clipping
cal diff is tensor(0.0253, device='cuda:2')
discard
cal diff is tensor(0.3942, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 99.01% 

Test Accuracy: 99.14% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0017398310592398047
attack res is False
len of model dicts is  10
compute distance is  tensor(17.6555, device='cuda:2')
compute distance is  tensor(60.3626, device='cuda:2')
compute distance is  tensor(86.0670, device='cuda:2')
compute distance is  tensor(105.6797, device='cuda:2')
compute distance is  tensor(37.7489, device='cuda:2')
compute distance is  tensor(48.2774, device='cuda:2')
compute distance is  tensor(33.9871, device='cuda:2')
compute distance is  tensor(54.5437, device='cuda:2')
compute distance is  tensor(86.4498, device='cuda:2')
compute distance is  tensor(39.9332, device='cuda:2')
calculated distance threshold is  tensor(89.6753, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.727300000156329
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8135000001563248
====================
====================
iteration is  0
round is  2
accuracy is  0.8667333334896561
====================
====================
iteration is  1
round is  0
accuracy is  0.5836166668230056
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7294000001563291
====================
====================
iteration is  1
round is  2
accuracy is  0.37736666682300746
====================
succ_min + 1
________________________________
test distance is  tensor(4710.6719, device='cuda:2')
test acc is  0.37736666682300746
test loss is 5.4297553697374585
test entropy is  0.17085237941666961
________________________________
diff is  tensor(48.9367, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4187, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.7376, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5782, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.1634, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2178, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3901, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2296, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4620.9966, device='cuda:2')
sum is tensor(0.2296, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6483, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2265, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4443, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8344, device='cuda:2', dtype=torch.float64)
sum is tensor(74.7711, device='cuda:2', dtype=torch.float64)
sum is tensor(705.5087, device='cuda:2', dtype=torch.float64)
sum is tensor(4710.6721, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0224, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.1634, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.9367, device='cuda:2')
discard
cal diff is tensor(0.4187, device='cuda:2')
discard
cal diff is tensor(630.7376, device='cuda:2')
discard
cal diff is tensor(0.5782, device='cuda:2')
discard
cal diff is tensor(4005.1633, device='cuda:2')
discard
cal diff is tensor(2.2178, device='cuda:2')
discard
cal diff is tensor(22.3901, device='cuda:2')
discard
cal diff is tensor(0.2296, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.993316666822985
test loss is 0.02428707593525836
test entropy is  0.011776767773538874
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011776767773538874
avg test loss is  0.02428707593525836
avg accuracy is  0.993316666822985
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20698176129762805
avg test loss is  4.326353509543039
avg accuracy is  0.36821666682300735
compute_distance is  tensor(90.5224, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(90.5224, device='cuda:2')
test acc is  0.36821666682300735
test loss is 4.326353509543039
test entropy is  0.20698176129762805
________________________________
diff is  tensor(0.8823, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(12.2402, device='cuda:2')
diff is  tensor(0.0125, device='cuda:2')
diff is  tensor(76.7624, device='cuda:2')
diff is  tensor(0.0488, device='cuda:2')
diff is  tensor(0.5737, device='cuda:2')
diff is  tensor(0.0053, device='cuda:2')
threshold is  tensor(0.8471, device='cuda:2')
sum is tensor(0.0053, device='cuda:2')
sum is tensor(0.0129, device='cuda:2')
sum is tensor(0.0254, device='cuda:2')
sum is tensor(0.0742, device='cuda:2')
sum is tensor(0.6479, device='cuda:2')
sum is tensor(1.5302, device='cuda:2')
ratio is tensor(0.7743, device='cuda:2')
threshold is tensor(0.8823, device='cuda:2')
cal diff is tensor(0.8823, device='cuda:2')
clipping
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(12.2402, device='cuda:2')
clipping
cal diff is tensor(0.0125, device='cuda:2')
discard
cal diff is tensor(76.7624, device='cuda:2')
clipping
cal diff is tensor(0.0488, device='cuda:2')
discard
cal diff is tensor(0.5737, device='cuda:2')
discard
cal diff is tensor(0.0053, device='cuda:2')
discard
________________________________
test distance is  tensor(69.5858, device='cuda:2')
test acc is  0.8502000001563234
test loss is 0.6164559839821574
test entropy is  0.14152168225187228
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14152168225187228
avg test loss is  0.6164559839821574
avg accuracy is  0.8502000001563234
compute_distance is  tensor(69.5858, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2027604702883946
avg test loss is  4.397243588972193
avg accuracy is  0.37065000015634075
compute_distance is  tensor(118.6753, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(118.6753, device='cuda:2')
test acc is  0.37065000015634075
test loss is 4.397243588972193
test entropy is  0.2027604702883946
________________________________
diff is  tensor(1.0118, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
diff is  tensor(14.2198, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(102.9989, device='cuda:2')
diff is  tensor(0.0191, device='cuda:2')
diff is  tensor(0.4061, device='cuda:2')
diff is  tensor(0.0019, device='cuda:2')
threshold is  tensor(29.0000, device='cuda:2')
sum is tensor(0.0019, device='cuda:2')
sum is tensor(0.0061, device='cuda:2')
sum is tensor(0.0129, device='cuda:2')
sum is tensor(0.0321, device='cuda:2')
sum is tensor(0.4382, device='cuda:2')
sum is tensor(1.4499, device='cuda:2')
sum is tensor(15.6698, device='cuda:2')
sum is tensor(118.6687, device='cuda:2')
ratio is tensor(0.8706, device='cuda:2')
threshold is tensor(102.9989, device='cuda:2')
cal diff is tensor(1.0118, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
cal diff is tensor(14.2198, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(102.9989, device='cuda:2')
clipping
cal diff is tensor(0.0191, device='cuda:2')
discard
cal diff is tensor(0.4061, device='cuda:2')
discard
cal diff is tensor(0.0019, device='cuda:2')
discard
________________________________
test distance is  tensor(89.6780, device='cuda:2')
test acc is  0.9274333334896537
test loss is 0.2804005285303023
test entropy is  0.08374242589020653
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(89.6688, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0027, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8307, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(89.6688, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.5006, device='cuda:2')
test acc is  0.9624666668229859
test loss is 0.13410352616612342
test entropy is  0.050260738159881344
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.050260738159881344
avg test loss is  0.13410352616612342
avg accuracy is  0.9624666668229859
compute_distance is  tensor(74.5006, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20232108910518415
avg test loss is  4.39594019730208
avg accuracy is  0.3694500001563407
compute_distance is  tensor(131.8745, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(131.8745, device='cuda:2')
test acc is  0.3694500001563407
test loss is 4.39594019730208
test entropy is  0.20232108910518415
________________________________
diff is  tensor(0.6561, device='cuda:2')
diff is  tensor(0.0055, device='cuda:2')
diff is  tensor(9.1239, device='cuda:2')
diff is  tensor(0.0094, device='cuda:2')
diff is  tensor(121.6711, device='cuda:2')
diff is  tensor(0.0246, device='cuda:2')
diff is  tensor(0.3698, device='cuda:2')
diff is  tensor(0.0028, device='cuda:2')
threshold is  tensor(42.1992, device='cuda:2')
sum is tensor(0.0028, device='cuda:2')
sum is tensor(0.0082, device='cuda:2')
sum is tensor(0.0176, device='cuda:2')
sum is tensor(0.0422, device='cuda:2')
sum is tensor(0.4120, device='cuda:2')
sum is tensor(1.0682, device='cuda:2')
sum is tensor(10.1921, device='cuda:2')
sum is tensor(131.8632, device='cuda:2')
ratio is tensor(0.7369, device='cuda:2')
threshold is tensor(121.6711, device='cuda:2')
cal diff is tensor(0.6561, device='cuda:2')
discard
cal diff is tensor(0.0055, device='cuda:2')
discard
cal diff is tensor(9.1239, device='cuda:2')
discard
cal diff is tensor(0.0094, device='cuda:2')
discard
cal diff is tensor(121.6711, device='cuda:2')
clipping
cal diff is tensor(0.0246, device='cuda:2')
discard
cal diff is tensor(0.3698, device='cuda:2')
discard
cal diff is tensor(0.0028, device='cuda:2')
discard
________________________________
test distance is  tensor(89.6741, device='cuda:2')
test acc is  0.9301333334896537
test loss is 0.2631371633203299
test entropy is  0.08443798161923949
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08443798161923949
avg test loss is  0.2631371633203299
avg accuracy is  0.9301333334896537
compute_distance is  tensor(89.6741, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2005870359093904
avg test loss is  4.4191790598033585
avg accuracy is  0.3705333334896741
compute_distance is  tensor(142.9966, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(142.9966, device='cuda:2')
test acc is  0.3705333334896741
test loss is 4.4191790598033585
test entropy is  0.2005870359093904
________________________________
diff is  tensor(0.6206, device='cuda:2')
diff is  tensor(0.0046, device='cuda:2')
diff is  tensor(8.3255, device='cuda:2')
diff is  tensor(0.0083, device='cuda:2')
diff is  tensor(133.6494, device='cuda:2')
diff is  tensor(0.0208, device='cuda:2')
diff is  tensor(0.3499, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(53.3213, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0070, device='cuda:2')
sum is tensor(0.0153, device='cuda:2')
sum is tensor(0.0361, device='cuda:2')
sum is tensor(0.3860, device='cuda:2')
sum is tensor(1.0066, device='cuda:2')
sum is tensor(9.3322, device='cuda:2')
sum is tensor(142.9815, device='cuda:2')
ratio is tensor(0.6709, device='cuda:2')
threshold is tensor(133.6494, device='cuda:2')
cal diff is tensor(0.6206, device='cuda:2')
discard
cal diff is tensor(0.0046, device='cuda:2')
discard
cal diff is tensor(8.3255, device='cuda:2')
discard
cal diff is tensor(0.0083, device='cuda:2')
discard
cal diff is tensor(133.6494, device='cuda:2')
clipping
cal diff is tensor(0.0208, device='cuda:2')
discard
cal diff is tensor(0.3499, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(89.6722, device='cuda:2')
test acc is  0.9430333334896531
test loss is 0.2065141075342866
test entropy is  0.07215406542528731
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07215406542528731
avg test loss is  0.2065141075342866
avg accuracy is  0.9430333334896531
compute_distance is  tensor(89.6722, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20048340777757326
avg test loss is  4.4232571658803455
avg accuracy is  0.3704166668230074
compute_distance is  tensor(144.6783, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(144.6783, device='cuda:2')
test acc is  0.3704166668230074
test loss is 4.4232571658803455
test entropy is  0.20048340777757326
________________________________
diff is  tensor(0.6342, device='cuda:2')
diff is  tensor(0.0049, device='cuda:2')
diff is  tensor(8.6390, device='cuda:2')
diff is  tensor(0.0088, device='cuda:2')
diff is  tensor(135.0031, device='cuda:2')
diff is  tensor(0.0217, device='cuda:2')
diff is  tensor(0.3480, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(55.0030, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0074, device='cuda:2')
sum is tensor(0.0162, device='cuda:2')
sum is tensor(0.0378, device='cuda:2')
sum is tensor(0.3859, device='cuda:2')
sum is tensor(1.0201, device='cuda:2')
sum is tensor(9.6591, device='cuda:2')
sum is tensor(144.6623, device='cuda:2')
ratio is tensor(0.6641, device='cuda:2')
threshold is tensor(135.0031, device='cuda:2')
cal diff is tensor(0.6342, device='cuda:2')
discard
cal diff is tensor(0.0049, device='cuda:2')
discard
cal diff is tensor(8.6390, device='cuda:2')
discard
cal diff is tensor(0.0088, device='cuda:2')
discard
cal diff is tensor(135.0031, device='cuda:2')
clipping
cal diff is tensor(0.0217, device='cuda:2')
discard
cal diff is tensor(0.3480, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(89.6721, device='cuda:2')
test acc is  0.9477833334896532
test loss is 0.18816536830575353
test entropy is  0.06774941907981152
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.06774941907981152
avg test loss is  0.18816536830575353
avg accuracy is  0.9477833334896532
compute_distance is  tensor(89.6721, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2005204337317425
avg test loss is  4.424327939558131
avg accuracy is  0.36993333348967405
compute_distance is  tensor(145.3772, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.3772, device='cuda:2')
test acc is  0.36993333348967405
test loss is 4.424327939558131
test entropy is  0.2005204337317425
________________________________
diff is  tensor(0.6399, device='cuda:2')
diff is  tensor(0.0050, device='cuda:2')
diff is  tensor(8.7990, device='cuda:2')
diff is  tensor(0.0090, device='cuda:2')
diff is  tensor(135.5342, device='cuda:2')
diff is  tensor(0.0221, device='cuda:2')
diff is  tensor(0.3488, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(55.7019, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0075, device='cuda:2')
sum is tensor(0.0165, device='cuda:2')
sum is tensor(0.0386, device='cuda:2')
sum is tensor(0.3875, device='cuda:2')
sum is tensor(1.0274, device='cuda:2')
sum is tensor(9.8264, device='cuda:2')
sum is tensor(145.3606, device='cuda:2')
ratio is tensor(0.6615, device='cuda:2')
threshold is tensor(135.5342, device='cuda:2')
cal diff is tensor(0.6399, device='cuda:2')
discard
cal diff is tensor(0.0050, device='cuda:2')
discard
cal diff is tensor(8.7990, device='cuda:2')
discard
cal diff is tensor(0.0090, device='cuda:2')
discard
cal diff is tensor(135.5342, device='cuda:2')
clipping
cal diff is tensor(0.0221, device='cuda:2')
discard
cal diff is tensor(0.3488, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(89.6721, device='cuda:2')
test acc is  0.9499166668229864
test loss is 0.18058861585146288
test entropy is  0.06585307615493406
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.06585307615493406
avg test loss is  0.18058861585146288
avg accuracy is  0.9499166668229864
compute_distance is  tensor(89.6721, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20049658834711828
avg test loss is  4.425245552174826
avg accuracy is  0.3695833334896741
compute_distance is  tensor(145.7171, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.7171, device='cuda:2')
test acc is  0.3695833334896741
test loss is 4.425245552174826
test entropy is  0.20049658834711828
________________________________
diff is  tensor(0.6418, device='cuda:2')
diff is  tensor(0.0051, device='cuda:2')
diff is  tensor(8.8778, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(135.7916, device='cuda:2')
diff is  tensor(0.0223, device='cuda:2')
diff is  tensor(0.3498, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(56.0418, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0076, device='cuda:2')
sum is tensor(0.0167, device='cuda:2')
sum is tensor(0.0390, device='cuda:2')
sum is tensor(0.3888, device='cuda:2')
sum is tensor(1.0306, device='cuda:2')
sum is tensor(9.9085, device='cuda:2')
sum is tensor(145.7001, device='cuda:2')
ratio is tensor(0.6603, device='cuda:2')
threshold is tensor(135.7916, device='cuda:2')
cal diff is tensor(0.6418, device='cuda:2')
discard
cal diff is tensor(0.0051, device='cuda:2')
discard
cal diff is tensor(8.8778, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(135.7916, device='cuda:2')
clipping
cal diff is tensor(0.0223, device='cuda:2')
discard
cal diff is tensor(0.3498, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(89.6720, device='cuda:2')
test acc is  0.950783333489653
test loss is 0.17691819594134447
test entropy is  0.0649173260072687
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0649173260072687
avg test loss is  0.17691819594134447
avg accuracy is  0.950783333489653
compute_distance is  tensor(89.6720, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20043545165486426
avg test loss is  4.426552486063829
avg accuracy is  0.3696166668230074
compute_distance is  tensor(145.9187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.9187, device='cuda:2')
test acc is  0.3696166668230074
test loss is 4.426552486063829
test entropy is  0.20043545165486426
________________________________
diff is  tensor(0.6424, device='cuda:2')
diff is  tensor(0.0051, device='cuda:2')
diff is  tensor(8.9158, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(135.9539, device='cuda:2')
diff is  tensor(0.0225, device='cuda:2')
diff is  tensor(0.3500, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(56.2434, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0076, device='cuda:2')
sum is tensor(0.0168, device='cuda:2')
sum is tensor(0.0393, device='cuda:2')
sum is tensor(0.3893, device='cuda:2')
sum is tensor(1.0317, device='cuda:2')
sum is tensor(9.9475, device='cuda:2')
sum is tensor(145.9014, device='cuda:2')
ratio is tensor(0.6595, device='cuda:2')
threshold is tensor(135.9539, device='cuda:2')
cal diff is tensor(0.6424, device='cuda:2')
discard
cal diff is tensor(0.0051, device='cuda:2')
discard
cal diff is tensor(8.9158, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(135.9539, device='cuda:2')
clipping
cal diff is tensor(0.0225, device='cuda:2')
discard
cal diff is tensor(0.3500, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(89.6720, device='cuda:2')
test acc is  0.9514166668229862
test loss is 0.17480302410786536
test entropy is  0.06436029347037074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.06436029347037074
avg test loss is  0.17480302410786536
avg accuracy is  0.9514166668229862
compute_distance is  tensor(89.6720, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20042284792547288
avg test loss is  4.427150003945649
avg accuracy is  0.36955000015634076
compute_distance is  tensor(146.0125, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.0125, device='cuda:2')
test acc is  0.36955000015634076
test loss is 4.427150003945649
test entropy is  0.20042284792547288
________________________________
diff is  tensor(0.6422, device='cuda:2')
diff is  tensor(0.0051, device='cuda:2')
diff is  tensor(8.9352, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(136.0284, device='cuda:2')
diff is  tensor(0.0226, device='cuda:2')
diff is  tensor(0.3498, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(56.3372, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0076, device='cuda:2')
sum is tensor(0.0168, device='cuda:2')
sum is tensor(0.0394, device='cuda:2')
sum is tensor(0.3892, device='cuda:2')
sum is tensor(1.0315, device='cuda:2')
sum is tensor(9.9666, device='cuda:2')
sum is tensor(145.9950, device='cuda:2')
ratio is tensor(0.6591, device='cuda:2')
threshold is tensor(136.0284, device='cuda:2')
cal diff is tensor(0.6422, device='cuda:2')
discard
cal diff is tensor(0.0051, device='cuda:2')
discard
cal diff is tensor(8.9352, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(136.0284, device='cuda:2')
clipping
cal diff is tensor(0.0226, device='cuda:2')
discard
cal diff is tensor(0.3498, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.15% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0017067453591153026
attack res is False
len of model dicts is  10
compute distance is  tensor(14.9782, device='cuda:2')
compute distance is  tensor(78.1670, device='cuda:2')
compute distance is  tensor(61.8873, device='cuda:2')
compute distance is  tensor(92.4553, device='cuda:2')
compute distance is  tensor(35.9660, device='cuda:2')
compute distance is  tensor(49.9333, device='cuda:2')
compute distance is  tensor(83.9658, device='cuda:2')
compute distance is  tensor(47.2968, device='cuda:2')
compute distance is  tensor(66.0433, device='cuda:2')
compute distance is  tensor(38.7951, device='cuda:2')
calculated distance threshold is  tensor(78.3686, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8541500001563233
====================
====================
iteration is  0
round is  1
accuracy is  0.8968666668229883
====================
====================
iteration is  0
round is  2
accuracy is  0.8992833334896548
====================
====================
iteration is  1
round is  0
accuracy is  0.8471833334896568
====================
====================
iteration is  1
round is  1
accuracy is  0.731950000156329
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7486833334896614
====================
====================
iteration is  2
round is  0
accuracy is  0.5863333334896721
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5612666668230077
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6934333334896645
====================
________________________________
test distance is  tensor(5177.9478, device='cuda:2')
test acc is  0.5612666668230077
test loss is 4.416312796474774
test entropy is  0.20462313728101217
________________________________
diff is  tensor(53.3110, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3794, device='cuda:2', dtype=torch.float64)
diff is  tensor(690.4301, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5631, device='cuda:2', dtype=torch.float64)
diff is  tensor(4405.8901, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.5336, device='cuda:2', dtype=torch.float64)
diff is  tensor(24.6166, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2235, device='cuda:2', dtype=torch.float64)
threshold is  tensor(5099.5791, device='cuda:2')
sum is tensor(0.2235, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6028, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1659, device='cuda:2', dtype=torch.float64)
sum is tensor(3.6995, device='cuda:2', dtype=torch.float64)
sum is tensor(28.3161, device='cuda:2', dtype=torch.float64)
sum is tensor(81.6271, device='cuda:2', dtype=torch.float64)
sum is tensor(772.0572, device='cuda:2', dtype=torch.float64)
sum is tensor(5177.9474, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0178, device='cuda:2', dtype=torch.float64)
threshold is tensor(4405.8901, device='cuda:2', dtype=torch.float64)
cal diff is tensor(53.3110, device='cuda:2')
discard
cal diff is tensor(0.3794, device='cuda:2')
discard
cal diff is tensor(690.4301, device='cuda:2')
discard
cal diff is tensor(0.5631, device='cuda:2')
discard
cal diff is tensor(4405.8901, device='cuda:2')
clipping
cal diff is tensor(2.5336, device='cuda:2')
discard
cal diff is tensor(24.6166, device='cuda:2')
discard
cal diff is tensor(0.2235, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3784, device='cuda:2')
test acc is  0.993116666822985
test loss is 0.024314531819993917
test entropy is  0.011796949892453246
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3683, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0099, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0367, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3683, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(2.8862, device='cuda:2')
test acc is  0.9932333334896517
test loss is 0.024238840146099026
test entropy is  0.011784319327944104
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011784319327944104
avg test loss is  0.024238840146099026
avg accuracy is  0.9932333334896517
compute_distance is  tensor(2.8862, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2545371318994555
avg test loss is  2.6253300733657787
avg accuracy is  0.61333333348967
compute_distance is  tensor(98.9240, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(98.9240, device='cuda:2')
test acc is  0.61333333348967
test loss is 2.6253300733657787
test entropy is  0.2545371318994555
________________________________
diff is  tensor(0.9673, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(13.8606, device='cuda:2')
diff is  tensor(0.0153, device='cuda:2')
diff is  tensor(83.4043, device='cuda:2')
diff is  tensor(0.0551, device='cuda:2')
diff is  tensor(0.6182, device='cuda:2')
diff is  tensor(0.0053, device='cuda:2')
threshold is  tensor(20.5555, device='cuda:2')
sum is tensor(0.0053, device='cuda:2')
sum is tensor(0.0144, device='cuda:2')
sum is tensor(0.0296, device='cuda:2')
sum is tensor(0.0847, device='cuda:2')
sum is tensor(0.7030, device='cuda:2')
sum is tensor(1.6702, device='cuda:2')
sum is tensor(15.5308, device='cuda:2')
sum is tensor(98.9351, device='cuda:2')
ratio is tensor(0.9398, device='cuda:2')
threshold is tensor(83.4043, device='cuda:2')
cal diff is tensor(0.9673, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(13.8606, device='cuda:2')
discard
cal diff is tensor(0.0153, device='cuda:2')
discard
cal diff is tensor(83.4043, device='cuda:2')
clipping
cal diff is tensor(0.0551, device='cuda:2')
discard
cal diff is tensor(0.6182, device='cuda:2')
discard
cal diff is tensor(0.0053, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3792, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956555222034024
test entropy is  0.09602645074904982
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3799, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0107, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3902, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2')
threshold is tensor(78.3799, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3799, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956074276780174
test entropy is  0.09602444508333387
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.3788, device='cuda:2')
test acc is  0.9459666668229865
test loss is 0.18956068102746948
test entropy is  0.09602442561293334
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(78.3795, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(78.3897, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(78.3795, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(78.3795, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.16% 


 | Global Training Round : 51 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0019251309568062425
attack res is False
len of model dicts is  10
compute distance is  tensor(17.9124, device='cuda:2')
compute distance is  tensor(39.1558, device='cuda:2')
compute distance is  tensor(73.9271, device='cuda:2')
compute distance is  tensor(76.4797, device='cuda:2')
compute distance is  tensor(40.0545, device='cuda:2')
compute distance is  tensor(72.3210, device='cuda:2')
compute distance is  tensor(63.5878, device='cuda:2')
compute distance is  tensor(26.3327, device='cuda:2')
compute distance is  tensor(51.6124, device='cuda:2')
compute distance is  tensor(40.6007, device='cuda:2')
calculated distance threshold is  tensor(65.8311, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.802566666822992
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.9291666668229871
====================
====================
iteration is  0
round is  2
accuracy is  0.8654666668229896
====================
====================
iteration is  1
round is  0
accuracy is  0.7726833334896602
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.868833333489656
====================
====================
iteration is  1
round is  2
accuracy is  0.8331500001563241
====================
====================
iteration is  2
round is  0
accuracy is  0.5282000001563423
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6422666668230014
====================
________________________________
test distance is  tensor(5181.4946, device='cuda:2')
test acc is  0.5282000001563423
test loss is 4.106535356054937
test entropy is  0.18536365534196783
________________________________
diff is  tensor(55.2355, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4600, device='cuda:2', dtype=torch.float64)
diff is  tensor(691.6006, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5906, device='cuda:2', dtype=torch.float64)
diff is  tensor(4406.2217, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.5529, device='cuda:2', dtype=torch.float64)
diff is  tensor(24.5646, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2690, device='cuda:2', dtype=torch.float64)
threshold is  tensor(5115.6636, device='cuda:2')
sum is tensor(0.2690, device='cuda:2', dtype=torch.float64)
sum is tensor(0.7290, device='cuda:2', dtype=torch.float64)
sum is tensor(1.3196, device='cuda:2', dtype=torch.float64)
sum is tensor(3.8725, device='cuda:2', dtype=torch.float64)
sum is tensor(28.4371, device='cuda:2', dtype=torch.float64)
sum is tensor(83.6725, device='cuda:2', dtype=torch.float64)
sum is tensor(775.2731, device='cuda:2', dtype=torch.float64)
sum is tensor(5181.4948, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0149, device='cuda:2', dtype=torch.float64)
threshold is tensor(4406.2217, device='cuda:2', dtype=torch.float64)
cal diff is tensor(55.2355, device='cuda:2')
discard
cal diff is tensor(0.4600, device='cuda:2')
discard
cal diff is tensor(691.6006, device='cuda:2')
discard
cal diff is tensor(0.5906, device='cuda:2')
discard
cal diff is tensor(4406.2217, device='cuda:2')
discard
cal diff is tensor(2.5529, device='cuda:2')
discard
cal diff is tensor(24.5646, device='cuda:2')
discard
cal diff is tensor(0.2690, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9932500001563184
test loss is 0.02411281390424538
test entropy is  0.011752415680427857
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011752415680427857
avg test loss is  0.02411281390424538
avg accuracy is  0.9932500001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20577733478407617
avg test loss is  2.7111501318178197
avg accuracy is  0.5643333334896742
compute_distance is  tensor(92.0984, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.0984, device='cuda:2')
test acc is  0.5643333334896742
test loss is 2.7111501318178197
test entropy is  0.20577733478407617
________________________________
diff is  tensor(0.9092, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(12.7938, device='cuda:2')
diff is  tensor(0.0128, device='cuda:2')
diff is  tensor(77.7418, device='cuda:2')
diff is  tensor(0.0488, device='cuda:2')
diff is  tensor(0.5912, device='cuda:2')
diff is  tensor(0.0048, device='cuda:2')
threshold is  tensor(26.2673, device='cuda:2')
sum is tensor(0.0048, device='cuda:2')
sum is tensor(0.0117, device='cuda:2')
sum is tensor(0.0245, device='cuda:2')
sum is tensor(0.0733, device='cuda:2')
sum is tensor(0.6644, device='cuda:2')
sum is tensor(1.5737, device='cuda:2')
sum is tensor(14.3675, device='cuda:2')
sum is tensor(92.1093, device='cuda:2')
ratio is tensor(0.8469, device='cuda:2')
threshold is tensor(77.7418, device='cuda:2')
cal diff is tensor(0.9092, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(12.7938, device='cuda:2')
discard
cal diff is tensor(0.0128, device='cuda:2')
discard
cal diff is tensor(77.7418, device='cuda:2')
clipping
cal diff is tensor(0.0488, device='cuda:2')
discard
cal diff is tensor(0.5912, device='cuda:2')
discard
cal diff is tensor(0.0048, device='cuda:2')
discard
________________________________
test distance is  tensor(65.8402, device='cuda:2')
test acc is  0.9579000001563194
test loss is 0.15458365609950778
test entropy is  0.05447248802035064
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(65.8430, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0091, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1235, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(65.8430, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(8.1356, device='cuda:2')
test acc is  0.993166666822985
test loss is 0.02413836772600806
test entropy is  0.012381629665272688
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012381629665272688
avg test loss is  0.02413836772600806
avg accuracy is  0.993166666822985
compute_distance is  tensor(8.1356, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20525649139907823
avg test loss is  2.7440526245245294
avg accuracy is  0.5618166668230077
compute_distance is  tensor(96.1411, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(96.1411, device='cuda:2')
test acc is  0.5618166668230077
test loss is 2.7440526245245294
test entropy is  0.20525649139907823
________________________________
diff is  tensor(0.8603, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(12.6490, device='cuda:2')
diff is  tensor(0.0131, device='cuda:2')
diff is  tensor(82.0100, device='cuda:2')
diff is  tensor(0.0444, device='cuda:2')
diff is  tensor(0.5616, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(30.3099, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0109, device='cuda:2')
sum is tensor(0.0240, device='cuda:2')
sum is tensor(0.0684, device='cuda:2')
sum is tensor(0.6301, device='cuda:2')
sum is tensor(1.4904, device='cuda:2')
sum is tensor(14.1394, device='cuda:2')
sum is tensor(96.1494, device='cuda:2')
ratio is tensor(0.8028, device='cuda:2')
threshold is tensor(82.0100, device='cuda:2')
cal diff is tensor(0.8603, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(12.6490, device='cuda:2')
discard
cal diff is tensor(0.0131, device='cuda:2')
discard
cal diff is tensor(82.0100, device='cuda:2')
clipping
cal diff is tensor(0.0444, device='cuda:2')
discard
cal diff is tensor(0.5616, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(65.8392, device='cuda:2')
test acc is  0.9642500001563192
test loss is 0.12907327710677344
test entropy is  0.049410951771348445
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(65.8406, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0081, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2356, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(65.8406, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(15.5168, device='cuda:2')
test acc is  0.9927333334896518
test loss is 0.025146372641051323
test entropy is  0.013361460522752005
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.013361460522752005
avg test loss is  0.025146372641051323
avg accuracy is  0.9927333334896518
compute_distance is  tensor(15.5168, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2051114526384675
avg test loss is  2.7693347460679663
avg accuracy is  0.5593000001563412
compute_distance is  tensor(100.2868, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(100.2868, device='cuda:2')
test acc is  0.5593000001563412
test loss is 2.7693347460679663
test entropy is  0.2051114526384675
________________________________
diff is  tensor(0.8283, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(12.4960, device='cuda:2')
diff is  tensor(0.0132, device='cuda:2')
diff is  tensor(86.3635, device='cuda:2')
diff is  tensor(0.0413, device='cuda:2')
diff is  tensor(0.5402, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
threshold is  tensor(34.4557, device='cuda:2')
sum is tensor(0.0041, device='cuda:2')
sum is tensor(0.0105, device='cuda:2')
sum is tensor(0.0237, device='cuda:2')
sum is tensor(0.0649, device='cuda:2')
sum is tensor(0.6051, device='cuda:2')
sum is tensor(1.4334, device='cuda:2')
sum is tensor(13.9294, device='cuda:2')
sum is tensor(100.2929, device='cuda:2')
ratio is tensor(0.7623, device='cuda:2')
threshold is tensor(86.3635, device='cuda:2')
cal diff is tensor(0.8283, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(12.4960, device='cuda:2')
discard
cal diff is tensor(0.0132, device='cuda:2')
discard
cal diff is tensor(86.3635, device='cuda:2')
clipping
cal diff is tensor(0.0413, device='cuda:2')
discard
cal diff is tensor(0.5402, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
________________________________
test distance is  tensor(65.8383, device='cuda:2')
test acc is  0.9683000001563191
test loss is 0.112347141384258
test entropy is  0.04576141544533814
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(65.8384, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0072, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3376, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(65.8384, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(22.2317, device='cuda:2')
test acc is  0.9922000001563184
test loss is 0.026848320778761744
test entropy is  0.014575587024353959
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.014575587024353959
avg test loss is  0.026848320778761744
avg accuracy is  0.9922000001563184
compute_distance is  tensor(22.2317, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20509027628533877
avg test loss is  2.791703429811799
avg accuracy is  0.5567000001563414
compute_distance is  tensor(104.3078, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(104.3078, device='cuda:2')
test acc is  0.5567000001563414
test loss is 2.791703429811799
test entropy is  0.20509027628533877
________________________________
diff is  tensor(0.8073, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(12.3320, device='cuda:2')
diff is  tensor(0.0131, device='cuda:2')
diff is  tensor(90.5869, device='cuda:2')
diff is  tensor(0.0388, device='cuda:2')
diff is  tensor(0.5234, device='cuda:2')
diff is  tensor(0.0039, device='cuda:2')
threshold is  tensor(38.4767, device='cuda:2')
sum is tensor(0.0039, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(0.0233, device='cuda:2')
sum is tensor(0.0622, device='cuda:2')
sum is tensor(0.5856, device='cuda:2')
sum is tensor(1.3929, device='cuda:2')
sum is tensor(13.7249, device='cuda:2')
sum is tensor(104.3119, device='cuda:2')
ratio is tensor(0.7268, device='cuda:2')
threshold is tensor(90.5869, device='cuda:2')
cal diff is tensor(0.8073, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(12.3320, device='cuda:2')
discard
cal diff is tensor(0.0131, device='cuda:2')
discard
cal diff is tensor(90.5869, device='cuda:2')
clipping
cal diff is tensor(0.0388, device='cuda:2')
discard
cal diff is tensor(0.5234, device='cuda:2')
discard
cal diff is tensor(0.0039, device='cuda:2')
discard
________________________________
test distance is  tensor(65.8374, device='cuda:2')
test acc is  0.9713333334896523
test loss is 0.10057363971897926
test entropy is  0.04296254928175758
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(65.8364, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0063, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.4371, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(65.8364, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(28.7798, device='cuda:2')
test acc is  0.9912500001563184
test loss is 0.029306520868528554
test entropy is  0.016129651804742125
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.016129651804742125
avg test loss is  0.029306520868528554
avg accuracy is  0.9912500001563184
compute_distance is  tensor(28.7798, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20517157464584054
avg test loss is  2.8099042287132123
avg accuracy is  0.5555833334896748
compute_distance is  tensor(108.3653, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(108.3653, device='cuda:2')
test acc is  0.5555833334896748
test loss is 2.8099042287132123
test entropy is  0.20517157464584054
________________________________
diff is  tensor(0.7907, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(12.1361, device='cuda:2')
diff is  tensor(0.0129, device='cuda:2')
diff is  tensor(94.8724, device='cuda:2')
diff is  tensor(0.0368, device='cuda:2')
diff is  tensor(0.5084, device='cuda:2')
diff is  tensor(0.0037, device='cuda:2')
threshold is  tensor(42.5342, device='cuda:2')
sum is tensor(0.0037, device='cuda:2')
sum is tensor(0.0101, device='cuda:2')
sum is tensor(0.0230, device='cuda:2')
sum is tensor(0.0597, device='cuda:2')
sum is tensor(0.5681, device='cuda:2')
sum is tensor(1.3588, device='cuda:2')
sum is tensor(13.4949, device='cuda:2')
sum is tensor(108.3673, device='cuda:2')
ratio is tensor(0.6939, device='cuda:2')
threshold is tensor(94.8724, device='cuda:2')
cal diff is tensor(0.7907, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(12.1361, device='cuda:2')
discard
cal diff is tensor(0.0129, device='cuda:2')
discard
cal diff is tensor(94.8724, device='cuda:2')
clipping
cal diff is tensor(0.0368, device='cuda:2')
discard
cal diff is tensor(0.5084, device='cuda:2')
discard
cal diff is tensor(0.0037, device='cuda:2')
discard
________________________________
test distance is  tensor(65.8365, device='cuda:2')
test acc is  0.9737833334896522
test loss is 0.09149199355889073
test entropy is  0.040660676280643966
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(65.8344, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0054, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5315, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(65.8344, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(34.9947, device='cuda:2')
test acc is  0.9904833334896517
test loss is 0.032437889360431994
test entropy is  0.01796989163225539
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01796989163225539
avg test loss is  0.032437889360431994
avg accuracy is  0.9904833334896517
compute_distance is  tensor(34.9947, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20533084618384395
avg test loss is  2.8265475022004867
avg accuracy is  0.5534000001563416
compute_distance is  tensor(112.4009, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(112.4009, device='cuda:2')
test acc is  0.5534000001563416
test loss is 2.8265475022004867
test entropy is  0.20533084618384395
________________________________
diff is  tensor(0.7751, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.9417, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(99.1310, device='cuda:2')
diff is  tensor(0.0350, device='cuda:2')
diff is  tensor(0.4954, device='cuda:2')
diff is  tensor(0.0036, device='cuda:2')
threshold is  tensor(46.5698, device='cuda:2')
sum is tensor(0.0036, device='cuda:2')
sum is tensor(0.0101, device='cuda:2')
sum is tensor(0.0227, device='cuda:2')
sum is tensor(0.0577, device='cuda:2')
sum is tensor(0.5531, device='cuda:2')
sum is tensor(1.3282, device='cuda:2')
sum is tensor(13.2699, device='cuda:2')
sum is tensor(112.4010, device='cuda:2')
ratio is tensor(0.6641, device='cuda:2')
threshold is tensor(99.1310, device='cuda:2')
cal diff is tensor(0.7751, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.9417, device='cuda:2')
discard
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(99.1310, device='cuda:2')
clipping
cal diff is tensor(0.0350, device='cuda:2')
discard
cal diff is tensor(0.4954, device='cuda:2')
discard
cal diff is tensor(0.0036, device='cuda:2')
discard
________________________________
test distance is  tensor(65.8356, device='cuda:2')
test acc is  0.9756000001563189
test loss is 0.08417506144691063
test entropy is  0.03868955590438643
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(65.8323, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0045, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6318, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(65.8323, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(41.5978, device='cuda:2')
test acc is  0.9890833334896518
test loss is 0.036857349477188994
test entropy is  0.020379300456935336
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.020379300456935336
avg test loss is  0.036857349477188994
avg accuracy is  0.9890833334896518
compute_distance is  tensor(41.5978, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20550581402997217
avg test loss is  2.8421994208781194
avg accuracy is  0.5522333334896751
compute_distance is  tensor(116.7615, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 51 global rounds:
Train Accuracy: 99.01% 

Test Accuracy: 99.16% 


 | Global Training Round : 52 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.002212867373600602
attack res is False
len of model dicts is  10
compute distance is  tensor(15.9258, device='cuda:2')
compute distance is  tensor(42.4786, device='cuda:2')
compute distance is  tensor(52.4239, device='cuda:2')
compute distance is  tensor(87.1042, device='cuda:2')
compute distance is  tensor(39.6049, device='cuda:2')
compute distance is  tensor(61.5690, device='cuda:2')
compute distance is  tensor(28.1023, device='cuda:2')
compute distance is  tensor(35.0472, device='cuda:2')
compute distance is  tensor(50.3567, device='cuda:2')
compute distance is  tensor(71.8624, device='cuda:2')
calculated distance threshold is  tensor(74.1627, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8344000001563241
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8797166668229889
====================
====================
iteration is  0
round is  2
accuracy is  0.8930166668229883
====================
====================
iteration is  1
round is  0
accuracy is  0.7157166668229965
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7568333334896612
====================
====================
iteration is  1
round is  2
accuracy is  0.606416666823004
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.7519333334896612
====================
________________________________
test distance is  tensor(4711.8193, device='cuda:2')
test acc is  0.606416666823004
test loss is 2.6539271515823883
test entropy is  0.20829897381063464
________________________________
diff is  tensor(49.4470, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4270, device='cuda:2', dtype=torch.float64)
diff is  tensor(631.4221, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5641, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.1632, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2470, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2900, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2590, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4637.6567, device='cuda:2')
sum is tensor(0.2590, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6861, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2502, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4972, device='cuda:2', dtype=torch.float64)
sum is tensor(25.7871, device='cuda:2', dtype=torch.float64)
sum is tensor(75.2342, device='cuda:2', dtype=torch.float64)
sum is tensor(706.6562, device='cuda:2', dtype=torch.float64)
sum is tensor(4711.8194, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0185, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.1632, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.4470, device='cuda:2')
discard
cal diff is tensor(0.4270, device='cuda:2')
discard
cal diff is tensor(631.4221, device='cuda:2')
discard
cal diff is tensor(0.5641, device='cuda:2')
discard
cal diff is tensor(4005.1631, device='cuda:2')
discard
cal diff is tensor(2.2470, device='cuda:2')
discard
cal diff is tensor(22.2900, device='cuda:2')
discard
cal diff is tensor(0.2590, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.993316666822985
test loss is 0.02405275814905261
test entropy is  0.011721744998484957
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011721744998484957
avg test loss is  0.02405275814905261
avg accuracy is  0.993316666822985
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20780937130580832
avg test loss is  1.787506452247278
avg accuracy is  0.6591333334896669
compute_distance is  tensor(92.2839, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.2839, device='cuda:2')
test acc is  0.6591333334896669
test loss is 1.787506452247278
test entropy is  0.20780937130580832
________________________________
diff is  tensor(0.8379, device='cuda:2')
diff is  tensor(0.0085, device='cuda:2')
diff is  tensor(12.5103, device='cuda:2')
diff is  tensor(0.0137, device='cuda:2')
diff is  tensor(78.2935, device='cuda:2')
diff is  tensor(0.0486, device='cuda:2')
diff is  tensor(0.5756, device='cuda:2')
diff is  tensor(0.0050, device='cuda:2')
threshold is  tensor(18.1212, device='cuda:2')
sum is tensor(0.0050, device='cuda:2')
sum is tensor(0.0135, device='cuda:2')
sum is tensor(0.0273, device='cuda:2')
sum is tensor(0.0759, device='cuda:2')
sum is tensor(0.6515, device='cuda:2')
sum is tensor(1.4893, device='cuda:2')
sum is tensor(13.9996, device='cuda:2')
sum is tensor(92.2932, device='cuda:2')
ratio is tensor(0.9474, device='cuda:2')
threshold is tensor(78.2935, device='cuda:2')
cal diff is tensor(0.8379, device='cuda:2')
discard
cal diff is tensor(0.0085, device='cuda:2')
discard
cal diff is tensor(12.5103, device='cuda:2')
discard
cal diff is tensor(0.0137, device='cuda:2')
discard
cal diff is tensor(78.2935, device='cuda:2')
clipping
cal diff is tensor(0.0486, device='cuda:2')
discard
cal diff is tensor(0.5756, device='cuda:2')
discard
cal diff is tensor(0.0050, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1737, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.16312944040285485
test entropy is  0.07104369463758475
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1722, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0110, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1824, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2')
threshold is tensor(74.1722, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1722, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1729, device='cuda:2')
test acc is  0.9530666668229862
test loss is 0.163122632919981
test entropy is  0.07104135721252719
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.1714, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.1816, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(74.1714, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.1714, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 52 global rounds:
Train Accuracy: 99.00% 

Test Accuracy: 99.16% 


 | Global Training Round : 53 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0024222112260758877
attack res is False
len of model dicts is  10
compute distance is  tensor(16.6135, device='cuda:2')
compute distance is  tensor(52.7229, device='cuda:2')
compute distance is  tensor(77.1225, device='cuda:2')
compute distance is  tensor(86.7500, device='cuda:2')
compute distance is  tensor(46.6420, device='cuda:2')
compute distance is  tensor(46.3148, device='cuda:2')
compute distance is  tensor(44.8392, device='cuda:2')
compute distance is  tensor(41.9629, device='cuda:2')
compute distance is  tensor(49.7568, device='cuda:2')
compute distance is  tensor(29.0442, device='cuda:2')
calculated distance threshold is  tensor(73.9979, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8129166668229916
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8422166668229903
====================
====================
iteration is  0
round is  2
accuracy is  0.8514000001563232
====================
====================
iteration is  1
round is  0
accuracy is  0.7509833334896613
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5655166668230074
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7295166668229955
====================
====================
iteration is  2
round is  0
accuracy is  0.7666500001563271
====================
________________________________
test distance is  tensor(4709.4946, device='cuda:2')
test acc is  0.5655166668230074
test loss is 4.134802934203321
test entropy is  0.16768086678596703
________________________________
diff is  tensor(48.1081, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3530, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.5848, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5464, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.0449, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2161, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.4337, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2080, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4635.4966, device='cuda:2')
sum is tensor(0.2080, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5610, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1074, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3235, device='cuda:2', dtype=torch.float64)
sum is tensor(25.7571, device='cuda:2', dtype=torch.float64)
sum is tensor(73.8652, device='cuda:2', dtype=torch.float64)
sum is tensor(704.4500, device='cuda:2', dtype=torch.float64)
sum is tensor(4709.4949, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0185, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.0449, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.1081, device='cuda:2')
discard
cal diff is tensor(0.3530, device='cuda:2')
discard
cal diff is tensor(630.5848, device='cuda:2')
discard
cal diff is tensor(0.5464, device='cuda:2')
discard
cal diff is tensor(4005.0449, device='cuda:2')
clipping
cal diff is tensor(2.2161, device='cuda:2')
discard
cal diff is tensor(22.4337, device='cuda:2')
discard
cal diff is tensor(0.2080, device='cuda:2')
discard
________________________________
test distance is  tensor(74.0085, device='cuda:2')
test acc is  0.9933333334896517
test loss is 0.023930891391385257
test entropy is  0.011725466515488187
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.9984, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0106, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.0086, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(73.9984, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.9984, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.0081, device='cuda:2')
test acc is  0.9933333334896517
test loss is 0.02393085394037532
test entropy is  0.011725479005932349
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.9980, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(74.0082, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(73.9980, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.9980, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.993366666822985
test loss is 0.02387485486301734
test entropy is  0.01171587313509198
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01171587313509198
avg test loss is  0.02387485486301734
avg accuracy is  0.993366666822985
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20027916779968022
avg test loss is  3.0963432685906955
avg accuracy is  0.5633166668230075
compute_distance is  tensor(96.4692, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(96.4692, device='cuda:2')
test acc is  0.5633166668230075
test loss is 3.0963432685906955
test entropy is  0.20027916779968022
________________________________
diff is  tensor(0.8066, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(12.8178, device='cuda:2')
diff is  tensor(0.0144, device='cuda:2')
diff is  tensor(82.1266, device='cuda:2')
diff is  tensor(0.0527, device='cuda:2')
diff is  tensor(0.6424, device='cuda:2')
diff is  tensor(0.0053, device='cuda:2')
threshold is  tensor(22.4712, device='cuda:2')
sum is tensor(0.0053, device='cuda:2')
sum is tensor(0.0128, device='cuda:2')
sum is tensor(0.0272, device='cuda:2')
sum is tensor(0.0799, device='cuda:2')
sum is tensor(0.7224, device='cuda:2')
sum is tensor(1.5290, device='cuda:2')
sum is tensor(14.3467, device='cuda:2')
sum is tensor(96.4734, device='cuda:2')
ratio is tensor(0.9011, device='cuda:2')
threshold is tensor(82.1266, device='cuda:2')
cal diff is tensor(0.8066, device='cuda:2')
discard
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(12.8178, device='cuda:2')
discard
cal diff is tensor(0.0144, device='cuda:2')
discard
cal diff is tensor(82.1266, device='cuda:2')
clipping
cal diff is tensor(0.0527, device='cuda:2')
discard
cal diff is tensor(0.6424, device='cuda:2')
discard
cal diff is tensor(0.0053, device='cuda:2')
discard
________________________________
test distance is  tensor(74.0067, device='cuda:2')
test acc is  0.9410833334896532
test loss is 0.2140178625034526
test entropy is  0.07506871899800387
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.0024, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0087, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1631, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.0024, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(12.0790, device='cuda:2')
test acc is  0.9927500001563184
test loss is 0.025201967323988873
test entropy is  0.012666002969024757
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012666002969024757
avg test loss is  0.025201967323988873
avg accuracy is  0.9927500001563184
compute_distance is  tensor(12.0790, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19757554288516674
avg test loss is  3.132792434077273
avg accuracy is  0.5650333334896739
compute_distance is  tensor(102.5529, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(102.5529, device='cuda:2')
test acc is  0.5650333334896739
test loss is 3.132792434077273
test entropy is  0.19757554288516674
________________________________
diff is  tensor(0.7708, device='cuda:2')
diff is  tensor(0.0075, device='cuda:2')
diff is  tensor(12.9161, device='cuda:2')
diff is  tensor(0.0145, device='cuda:2')
diff is  tensor(88.2115, device='cuda:2')
diff is  tensor(0.0465, device='cuda:2')
diff is  tensor(0.5819, device='cuda:2')
diff is  tensor(0.0047, device='cuda:2')
threshold is  tensor(28.5549, device='cuda:2')
sum is tensor(0.0047, device='cuda:2')
sum is tensor(0.0122, device='cuda:2')
sum is tensor(0.0267, device='cuda:2')
sum is tensor(0.0732, device='cuda:2')
sum is tensor(0.6552, device='cuda:2')
sum is tensor(1.4260, device='cuda:2')
sum is tensor(14.3420, device='cuda:2')
sum is tensor(102.5536, device='cuda:2')
ratio is tensor(0.8389, device='cuda:2')
threshold is tensor(88.2115, device='cuda:2')
cal diff is tensor(0.7708, device='cuda:2')
discard
cal diff is tensor(0.0075, device='cuda:2')
discard
cal diff is tensor(12.9161, device='cuda:2')
discard
cal diff is tensor(0.0145, device='cuda:2')
discard
cal diff is tensor(88.2115, device='cuda:2')
clipping
cal diff is tensor(0.0465, device='cuda:2')
discard
cal diff is tensor(0.5819, device='cuda:2')
discard
cal diff is tensor(0.0047, device='cuda:2')
discard
________________________________
test distance is  tensor(74.0046, device='cuda:2')
test acc is  0.9523500001563197
test loss is 0.170821122586606
test entropy is  0.06468311379274437
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.9990, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0067, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3916, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.9990, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(28.9827, device='cuda:2')
test acc is  0.9911333334896517
test loss is 0.03152523420262713
test entropy is  0.016197653686030884
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.016197653686030884
avg test loss is  0.03152523420262713
avg accuracy is  0.9911333334896517
compute_distance is  tensor(28.9827, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19497204522715447
avg test loss is  3.172535219045082
avg accuracy is  0.5660666668230072
compute_distance is  tensor(111.6565, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(111.6565, device='cuda:2')
test acc is  0.5660666668230072
test loss is 3.172535219045082
test entropy is  0.19497204522715447
________________________________
diff is  tensor(0.7594, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(12.7521, device='cuda:2')
diff is  tensor(0.0143, device='cuda:2')
diff is  tensor(97.5596, device='cuda:2')
diff is  tensor(0.0399, device='cuda:2')
diff is  tensor(0.5158, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
threshold is  tensor(37.6586, device='cuda:2')
sum is tensor(0.0041, device='cuda:2')
sum is tensor(0.0116, device='cuda:2')
sum is tensor(0.0259, device='cuda:2')
sum is tensor(0.0659, device='cuda:2')
sum is tensor(0.5817, device='cuda:2')
sum is tensor(1.3411, device='cuda:2')
sum is tensor(14.0933, device='cuda:2')
sum is tensor(111.6529, device='cuda:2')
ratio is tensor(0.7585, device='cuda:2')
threshold is tensor(97.5596, device='cuda:2')
cal diff is tensor(0.7594, device='cuda:2')
discard
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(12.7521, device='cuda:2')
discard
cal diff is tensor(0.0143, device='cuda:2')
discard
cal diff is tensor(97.5596, device='cuda:2')
clipping
cal diff is tensor(0.0399, device='cuda:2')
discard
cal diff is tensor(0.5158, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
________________________________
test distance is  tensor(74.0021, device='cuda:2')
test acc is  0.9612000001563193
test loss is 0.13724873676758456
test entropy is  0.055551445125532686
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.9947, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0042, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6681, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.9947, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(49.4401, device='cuda:2')
test acc is  0.9853166668229852
test loss is 0.05109640100821366
test entropy is  0.025707157620158766
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.025707157620158766
avg test loss is  0.05109640100821366
avg accuracy is  0.9853166668229852
compute_distance is  tensor(49.4401, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19300331219808378
avg test loss is  3.2116680767998766
avg accuracy is  0.5675333334896738
compute_distance is  tensor(123.4732, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(123.4732, device='cuda:2')
test acc is  0.5675333334896738
test loss is 3.2116680767998766
test entropy is  0.19300331219808378
________________________________
diff is  tensor(0.7670, device='cuda:2')
diff is  tensor(0.0078, device='cuda:2')
diff is  tensor(12.0377, device='cuda:2')
diff is  tensor(0.0132, device='cuda:2')
diff is  tensor(110.1459, device='cuda:2')
diff is  tensor(0.0337, device='cuda:2')
diff is  tensor(0.4560, device='cuda:2')
diff is  tensor(0.0035, device='cuda:2')
threshold is  tensor(49.4753, device='cuda:2')
sum is tensor(0.0035, device='cuda:2')
sum is tensor(0.0113, device='cuda:2')
sum is tensor(0.0244, device='cuda:2')
sum is tensor(0.0581, device='cuda:2')
sum is tensor(0.5141, device='cuda:2')
sum is tensor(1.2810, device='cuda:2')
sum is tensor(13.3188, device='cuda:2')
sum is tensor(123.4647, device='cuda:2')
ratio is tensor(0.6717, device='cuda:2')
threshold is tensor(110.1459, device='cuda:2')
cal diff is tensor(0.7670, device='cuda:2')
discard
cal diff is tensor(0.0078, device='cuda:2')
discard
cal diff is tensor(12.0377, device='cuda:2')
discard
cal diff is tensor(0.0132, device='cuda:2')
discard
cal diff is tensor(110.1459, device='cuda:2')
clipping
cal diff is tensor(0.0337, device='cuda:2')
discard
cal diff is tensor(0.4560, device='cuda:2')
discard
cal diff is tensor(0.0035, device='cuda:2')
discard
________________________________
test distance is  tensor(73.9991, device='cuda:2')
test acc is  0.9684833334896524
test loss is 0.11083554776203854
test entropy is  0.04757480245063216
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.9895, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0012, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.9968, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.9895, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.7621, device='cuda:2')
test acc is  0.9687000001563191
test loss is 0.10976082584523289
test entropy is  0.047226550302461784
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.047226550302461784
avg test loss is  0.10976082584523289
avg accuracy is  0.9687000001563191
compute_distance is  tensor(73.7621, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1916974736318024
avg test loss is  3.250469208272027
avg accuracy is  0.5684833334896736
compute_distance is  tensor(138.6844, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(138.6844, device='cuda:2')
test acc is  0.5684833334896736
test loss is 3.250469208272027
test entropy is  0.1916974736318024
________________________________
diff is  tensor(0.7866, device='cuda:2')
diff is  tensor(0.0071, device='cuda:2')
diff is  tensor(11.0311, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(126.3997, device='cuda:2')
diff is  tensor(0.0279, device='cuda:2')
diff is  tensor(0.4037, device='cuda:2')
diff is  tensor(0.0030, device='cuda:2')
threshold is  tensor(64.6864, device='cuda:2')
sum is tensor(0.0030, device='cuda:2')
sum is tensor(0.0101, device='cuda:2')
sum is tensor(0.0215, device='cuda:2')
sum is tensor(0.0494, device='cuda:2')
sum is tensor(0.4531, device='cuda:2')
sum is tensor(1.2397, device='cuda:2')
sum is tensor(12.2708, device='cuda:2')
sum is tensor(138.6706, device='cuda:2')
ratio is tensor(0.5853, device='cuda:2')
threshold is tensor(126.3997, device='cuda:2')
cal diff is tensor(0.7866, device='cuda:2')
discard
cal diff is tensor(0.0071, device='cuda:2')
discard
cal diff is tensor(11.0311, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(126.3997, device='cuda:2')
clipping
cal diff is tensor(0.0279, device='cuda:2')
discard
cal diff is tensor(0.4037, device='cuda:2')
discard
cal diff is tensor(0.0030, device='cuda:2')
discard
________________________________
test distance is  tensor(73.9960, device='cuda:2')
test acc is  0.9741166668229855
test loss is 0.09004714268925074
test entropy is  0.04057915872786996
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04057915872786996
avg test loss is  0.09004714268925074
avg accuracy is  0.9741166668229855
compute_distance is  tensor(73.9960, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19188931589124045
avg test loss is  3.252248643812086
avg accuracy is  0.5686000001563403
compute_distance is  tensor(140.6234, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(140.6234, device='cuda:2')
test acc is  0.5686000001563403
test loss is 3.252248643812086
test entropy is  0.19188931589124045
________________________________
diff is  tensor(0.7875, device='cuda:2')
diff is  tensor(0.0073, device='cuda:2')
diff is  tensor(11.2772, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(128.0898, device='cuda:2')
diff is  tensor(0.0288, device='cuda:2')
diff is  tensor(0.4031, device='cuda:2')
diff is  tensor(0.0030, device='cuda:2')
threshold is  tensor(66.6255, device='cuda:2')
sum is tensor(0.0030, device='cuda:2')
sum is tensor(0.0103, device='cuda:2')
sum is tensor(0.0222, device='cuda:2')
sum is tensor(0.0509, device='cuda:2')
sum is tensor(0.4540, device='cuda:2')
sum is tensor(1.2415, device='cuda:2')
sum is tensor(12.5187, device='cuda:2')
sum is tensor(140.6085, device='cuda:2')
ratio is tensor(0.5776, device='cuda:2')
threshold is tensor(128.0898, device='cuda:2')
cal diff is tensor(0.7875, device='cuda:2')
discard
cal diff is tensor(0.0073, device='cuda:2')
discard
cal diff is tensor(11.2772, device='cuda:2')
discard
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(128.0898, device='cuda:2')
clipping
cal diff is tensor(0.0288, device='cuda:2')
discard
cal diff is tensor(0.4031, device='cuda:2')
discard
cal diff is tensor(0.0030, device='cuda:2')
discard
________________________________
test distance is  tensor(73.9958, device='cuda:2')
test acc is  0.9758166668229855
test loss is 0.08362262242954728
test entropy is  0.03833650227114588
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03833650227114588
avg test loss is  0.08362262242954728
avg accuracy is  0.9758166668229855
compute_distance is  tensor(73.9958, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19192973670484162
avg test loss is  3.252456584973122
avg accuracy is  0.5686500001563404
compute_distance is  tensor(141.1965, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 53 global rounds:
Train Accuracy: 99.00% 

Test Accuracy: 99.16% 


 | Global Training Round : 54 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0026194339152425528
attack res is False
len of model dicts is  10
compute distance is  tensor(13.5116, device='cuda:2')
compute distance is  tensor(70.0654, device='cuda:2')
compute distance is  tensor(67.2242, device='cuda:2')
compute distance is  tensor(102.6808, device='cuda:2')
compute distance is  tensor(34.7093, device='cuda:2')
compute distance is  tensor(89.3024, device='cuda:2')
compute distance is  tensor(34.6241, device='cuda:2')
compute distance is  tensor(49.6591, device='cuda:2')
compute distance is  tensor(48.6606, device='cuda:2')
compute distance is  tensor(48.1023, device='cuda:2')
calculated distance threshold is  tensor(86.4682, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8061500001563252
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8956000001563217
====================
====================
iteration is  0
round is  2
accuracy is  0.7402666668229951
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.7003000001563309
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7391000001563286
====================
====================
iteration is  1
round is  2
accuracy is  0.7566166668229943
====================
________________________________
test distance is  tensor(4711.9272, device='cuda:2')
test acc is  0.7003000001563309
test loss is 2.033916898500691
test entropy is  0.1667760976199021
________________________________
diff is  tensor(49.6192, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3812, device='cuda:2', dtype=torch.float64)
diff is  tensor(631.5900, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5407, device='cuda:2', dtype=torch.float64)
diff is  tensor(4004.9527, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2107, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.4139, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2191, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4625.4590, device='cuda:2')
sum is tensor(0.2191, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6003, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1410, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3517, device='cuda:2', dtype=torch.float64)
sum is tensor(25.7656, device='cuda:2', dtype=torch.float64)
sum is tensor(75.3848, device='cuda:2', dtype=torch.float64)
sum is tensor(706.9748, device='cuda:2', dtype=torch.float64)
sum is tensor(4711.9275, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0216, device='cuda:2', dtype=torch.float64)
threshold is tensor(4004.9527, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.6192, device='cuda:2')
discard
cal diff is tensor(0.3812, device='cuda:2')
discard
cal diff is tensor(631.5900, device='cuda:2')
discard
cal diff is tensor(0.5407, device='cuda:2')
discard
cal diff is tensor(4004.9526, device='cuda:2')
discard
cal diff is tensor(2.2107, device='cuda:2')
discard
cal diff is tensor(22.4139, device='cuda:2')
discard
cal diff is tensor(0.2191, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9933000001563184
test loss is 0.023956534700344645
test entropy is  0.011598731505577435
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011598731505577435
avg test loss is  0.023956534700344645
avg accuracy is  0.9933000001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1880511519258846
avg test loss is  1.1105299526567398
avg accuracy is  0.7558666668229943
compute_distance is  tensor(92.3647, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.3647, device='cuda:2')
test acc is  0.7558666668229943
test loss is 1.1105299526567398
test entropy is  0.1880511519258846
________________________________
diff is  tensor(0.9223, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(12.4016, device='cuda:2')
diff is  tensor(0.0127, device='cuda:2')
diff is  tensor(78.4115, device='cuda:2')
diff is  tensor(0.0472, device='cuda:2')
diff is  tensor(0.5605, device='cuda:2')
diff is  tensor(0.0046, device='cuda:2')
threshold is  tensor(5.8965, device='cuda:2')
sum is tensor(0.0046, device='cuda:2')
sum is tensor(0.0115, device='cuda:2')
sum is tensor(0.0242, device='cuda:2')
sum is tensor(0.0714, device='cuda:2')
sum is tensor(0.6319, device='cuda:2')
sum is tensor(1.5543, device='cuda:2')
sum is tensor(13.9559, device='cuda:2')
ratio is tensor(0.6499, device='cuda:2')
threshold is tensor(12.4016, device='cuda:2')
cal diff is tensor(0.9223, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(12.4016, device='cuda:2')
clipping
cal diff is tensor(0.0127, device='cuda:2')
discard
cal diff is tensor(78.4115, device='cuda:2')
clipping
cal diff is tensor(0.0472, device='cuda:2')
discard
cal diff is tensor(0.5605, device='cuda:2')
discard
cal diff is tensor(0.0046, device='cuda:2')
discard
________________________________
test distance is  tensor(59.0151, device='cuda:2')
test acc is  0.9738666668229856
test loss is 0.08831239218737914
test entropy is  0.044562087110705424
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.044562087110705424
avg test loss is  0.08831239218737914
avg accuracy is  0.9738666668229856
compute_distance is  tensor(59.0151, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17753522750188802
avg test loss is  1.3724435665396486
avg accuracy is  0.7405500001563284
compute_distance is  tensor(120.3030, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(120.3030, device='cuda:2')
test acc is  0.7405500001563284
test loss is 1.3724435665396486
test entropy is  0.17753522750188802
________________________________
diff is  tensor(0.6529, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(16.6016, device='cuda:2')
diff is  tensor(0.0103, device='cuda:2')
diff is  tensor(102.5990, device='cuda:2')
diff is  tensor(0.0240, device='cuda:2')
diff is  tensor(0.3973, device='cuda:2')
diff is  tensor(0.0018, device='cuda:2')
threshold is  tensor(33.8348, device='cuda:2')
sum is tensor(0.0018, device='cuda:2')
sum is tensor(0.0082, device='cuda:2')
sum is tensor(0.0185, device='cuda:2')
sum is tensor(0.0425, device='cuda:2')
sum is tensor(0.4398, device='cuda:2')
sum is tensor(1.0926, device='cuda:2')
sum is tensor(17.6943, device='cuda:2')
sum is tensor(120.2933, device='cuda:2')
ratio is tensor(0.8427, device='cuda:2')
threshold is tensor(102.5990, device='cuda:2')
cal diff is tensor(0.6529, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(16.6016, device='cuda:2')
discard
cal diff is tensor(0.0103, device='cuda:2')
discard
cal diff is tensor(102.5990, device='cuda:2')
clipping
cal diff is tensor(0.0240, device='cuda:2')
discard
cal diff is tensor(0.3973, device='cuda:2')
discard
cal diff is tensor(0.0018, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4707, device='cuda:2')
test acc is  0.9708166668229856
test loss is 0.1010154282767214
test entropy is  0.04976321297160574
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(86.4583, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0025, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8484, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(86.4583, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.3669, device='cuda:2')
test acc is  0.9807500001563187
test loss is 0.06507161948566272
test entropy is  0.03367440230779668
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03367440230779668
avg test loss is  0.06507161948566272
avg accuracy is  0.9807500001563187
compute_distance is  tensor(73.3669, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17665055023232248
avg test loss is  1.4233102082951998
avg accuracy is  0.7369833334896619
compute_distance is  tensor(135.6466, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(135.6466, device='cuda:2')
test acc is  0.7369833334896619
test loss is 1.4233102082951998
test entropy is  0.17665055023232248
________________________________
diff is  tensor(0.7091, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.5123, device='cuda:2')
diff is  tensor(0.0117, device='cuda:2')
diff is  tensor(123.0085, device='cuda:2')
diff is  tensor(0.0257, device='cuda:2')
diff is  tensor(0.3551, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(49.1784, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0087, device='cuda:2')
sum is tensor(0.0205, device='cuda:2')
sum is tensor(0.0462, device='cuda:2')
sum is tensor(0.4013, device='cuda:2')
sum is tensor(1.1103, device='cuda:2')
sum is tensor(12.6226, device='cuda:2')
sum is tensor(135.6311, device='cuda:2')
ratio is tensor(0.7028, device='cuda:2')
threshold is tensor(123.0085, device='cuda:2')
cal diff is tensor(0.7091, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.5123, device='cuda:2')
discard
cal diff is tensor(0.0117, device='cuda:2')
discard
cal diff is tensor(123.0085, device='cuda:2')
clipping
cal diff is tensor(0.0257, device='cuda:2')
discard
cal diff is tensor(0.3551, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4661, device='cuda:2')
test acc is  0.9738333334896522
test loss is 0.09013962227150582
test entropy is  0.04627960067870878
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04627960067870878
avg test loss is  0.09013962227150582
avg accuracy is  0.9738333334896522
compute_distance is  tensor(86.4661, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17568244686576603
avg test loss is  1.4691564373370172
avg accuracy is  0.7346000001563288
compute_distance is  tensor(145.2432, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.2432, device='cuda:2')
test acc is  0.7346000001563288
test loss is 1.4691564373370172
test entropy is  0.17568244686576603
________________________________
diff is  tensor(0.6831, device='cuda:2')
diff is  tensor(0.0061, device='cuda:2')
diff is  tensor(11.3241, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(132.8460, device='cuda:2')
diff is  tensor(0.0223, device='cuda:2')
diff is  tensor(0.3295, device='cuda:2')
diff is  tensor(0.0018, device='cuda:2')
threshold is  tensor(58.7750, device='cuda:2')
sum is tensor(0.0018, device='cuda:2')
sum is tensor(0.0079, device='cuda:2')
sum is tensor(0.0193, device='cuda:2')
sum is tensor(0.0416, device='cuda:2')
sum is tensor(0.3711, device='cuda:2')
sum is tensor(1.0542, device='cuda:2')
sum is tensor(12.3782, device='cuda:2')
sum is tensor(145.2242, device='cuda:2')
ratio is tensor(0.6507, device='cuda:2')
threshold is tensor(132.8460, device='cuda:2')
cal diff is tensor(0.6831, device='cuda:2')
discard
cal diff is tensor(0.0061, device='cuda:2')
discard
cal diff is tensor(11.3241, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(132.8460, device='cuda:2')
clipping
cal diff is tensor(0.0223, device='cuda:2')
discard
cal diff is tensor(0.3295, device='cuda:2')
discard
cal diff is tensor(0.0018, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4641, device='cuda:2')
test acc is  0.9771000001563188
test loss is 0.07802459866691748
test entropy is  0.04092125329498037
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04092125329498037
avg test loss is  0.07802459866691748
avg accuracy is  0.9771000001563188
compute_distance is  tensor(86.4641, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1756936403702317
avg test loss is  1.4733229004053165
avg accuracy is  0.7338500001563288
compute_distance is  tensor(146.8022, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.8022, device='cuda:2')
test acc is  0.7338500001563288
test loss is 1.4733229004053165
test entropy is  0.1756936403702317
________________________________
diff is  tensor(0.6965, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.6284, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(134.0857, device='cuda:2')
diff is  tensor(0.0229, device='cuda:2')
diff is  tensor(0.3285, device='cuda:2')
diff is  tensor(0.0019, device='cuda:2')
threshold is  tensor(60.3340, device='cuda:2')
sum is tensor(0.0019, device='cuda:2')
sum is tensor(0.0083, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0430, device='cuda:2')
sum is tensor(0.3715, device='cuda:2')
sum is tensor(1.0680, device='cuda:2')
sum is tensor(12.6964, device='cuda:2')
sum is tensor(146.7821, device='cuda:2')
ratio is tensor(0.6447, device='cuda:2')
threshold is tensor(134.0857, device='cuda:2')
cal diff is tensor(0.6965, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.6284, device='cuda:2')
discard
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(134.0857, device='cuda:2')
clipping
cal diff is tensor(0.0229, device='cuda:2')
discard
cal diff is tensor(0.3285, device='cuda:2')
discard
cal diff is tensor(0.0019, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4639, device='cuda:2')
test acc is  0.9781500001563187
test loss is 0.07389988721800447
test entropy is  0.03905947026534146
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03905947026534146
avg test loss is  0.07389988721800447
avg accuracy is  0.9781500001563187
compute_distance is  tensor(86.4639, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17567141518505144
avg test loss is  1.47519982995382
avg accuracy is  0.7333500001563288
compute_distance is  tensor(147.4561, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.4561, device='cuda:2')
test acc is  0.7333500001563288
test loss is 1.47519982995382
test entropy is  0.17567141518505144
________________________________
diff is  tensor(0.7022, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.7771, device='cuda:2')
diff is  tensor(0.0120, device='cuda:2')
diff is  tensor(134.5838, device='cuda:2')
diff is  tensor(0.0233, device='cuda:2')
diff is  tensor(0.3285, device='cuda:2')
diff is  tensor(0.0019, device='cuda:2')
threshold is  tensor(60.9879, device='cuda:2')
sum is tensor(0.0019, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0204, device='cuda:2')
sum is tensor(0.0437, device='cuda:2')
sum is tensor(0.3723, device='cuda:2')
sum is tensor(1.0744, device='cuda:2')
sum is tensor(12.8516, device='cuda:2')
sum is tensor(147.4354, device='cuda:2')
ratio is tensor(0.6423, device='cuda:2')
threshold is tensor(134.5838, device='cuda:2')
cal diff is tensor(0.7022, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.7771, device='cuda:2')
discard
cal diff is tensor(0.0120, device='cuda:2')
discard
cal diff is tensor(134.5838, device='cuda:2')
clipping
cal diff is tensor(0.0233, device='cuda:2')
discard
cal diff is tensor(0.3285, device='cuda:2')
discard
cal diff is tensor(0.0019, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4637, device='cuda:2')
test acc is  0.9785166668229855
test loss is 0.0721339065124284
test entropy is  0.038238678473049896
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.038238678473049896
avg test loss is  0.0721339065124284
avg accuracy is  0.9785166668229855
compute_distance is  tensor(86.4637, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17567208678578772
avg test loss is  1.4763543218819064
avg accuracy is  0.7332333334896621
compute_distance is  tensor(147.7847, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.7847, device='cuda:2')
test acc is  0.7332333334896621
test loss is 1.4763543218819064
test entropy is  0.17567208678578772
________________________________
diff is  tensor(0.7043, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.8544, device='cuda:2')
diff is  tensor(0.0121, device='cuda:2')
diff is  tensor(134.8324, device='cuda:2')
diff is  tensor(0.0235, device='cuda:2')
diff is  tensor(0.3282, device='cuda:2')
diff is  tensor(0.0019, device='cuda:2')
threshold is  tensor(61.3165, device='cuda:2')
sum is tensor(0.0019, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0206, device='cuda:2')
sum is tensor(0.0441, device='cuda:2')
sum is tensor(0.3723, device='cuda:2')
sum is tensor(1.0766, device='cuda:2')
sum is tensor(12.9310, device='cuda:2')
sum is tensor(147.7634, device='cuda:2')
ratio is tensor(0.6411, device='cuda:2')
threshold is tensor(134.8324, device='cuda:2')
cal diff is tensor(0.7043, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.8544, device='cuda:2')
discard
cal diff is tensor(0.0121, device='cuda:2')
discard
cal diff is tensor(134.8324, device='cuda:2')
clipping
cal diff is tensor(0.0235, device='cuda:2')
discard
cal diff is tensor(0.3282, device='cuda:2')
discard
cal diff is tensor(0.0019, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4637, device='cuda:2')
test acc is  0.9786833334896522
test loss is 0.07122231584765655
test entropy is  0.03780452895698312
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03780452895698312
avg test loss is  0.07122231584765655
avg accuracy is  0.9786833334896522
compute_distance is  tensor(86.4637, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17570061435990497
avg test loss is  1.4777504584428345
avg accuracy is  0.7332166668229955
compute_distance is  tensor(147.9769, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.9769, device='cuda:2')
test acc is  0.7332166668229955
test loss is 1.4777504584428345
test entropy is  0.17570061435990497
________________________________
diff is  tensor(0.7052, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.9002, device='cuda:2')
diff is  tensor(0.0122, device='cuda:2')
diff is  tensor(134.9783, device='cuda:2')
diff is  tensor(0.0236, device='cuda:2')
diff is  tensor(0.3272, device='cuda:2')
diff is  tensor(0.0020, device='cuda:2')
threshold is  tensor(61.5087, device='cuda:2')
sum is tensor(0.0020, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0207, device='cuda:2')
sum is tensor(0.0443, device='cuda:2')
sum is tensor(0.3715, device='cuda:2')
sum is tensor(1.0768, device='cuda:2')
sum is tensor(12.9770, device='cuda:2')
sum is tensor(147.9553, device='cuda:2')
ratio is tensor(0.6404, device='cuda:2')
threshold is tensor(134.9783, device='cuda:2')
cal diff is tensor(0.7052, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.9002, device='cuda:2')
discard
cal diff is tensor(0.0122, device='cuda:2')
discard
cal diff is tensor(134.9783, device='cuda:2')
clipping
cal diff is tensor(0.0236, device='cuda:2')
discard
cal diff is tensor(0.3272, device='cuda:2')
discard
cal diff is tensor(0.0020, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4636, device='cuda:2')
test acc is  0.9789500001563187
test loss is 0.07066759224971296
test entropy is  0.03752030768438673
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03752030768438673
avg test loss is  0.07066759224971296
avg accuracy is  0.9789500001563187
compute_distance is  tensor(86.4636, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17575715734823935
avg test loss is  1.4788617293145865
avg accuracy is  0.7330666668229955
compute_distance is  tensor(148.0558, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(148.0558, device='cuda:2')
test acc is  0.7330666668229955
test loss is 1.4788617293145865
test entropy is  0.17575715734823935
________________________________
diff is  tensor(0.7053, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.9248, device='cuda:2')
diff is  tensor(0.0122, device='cuda:2')
diff is  tensor(135.0328, device='cuda:2')
diff is  tensor(0.0237, device='cuda:2')
diff is  tensor(0.3266, device='cuda:2')
diff is  tensor(0.0020, device='cuda:2')
threshold is  tensor(61.5876, device='cuda:2')
sum is tensor(0.0020, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0207, device='cuda:2')
sum is tensor(0.0444, device='cuda:2')
sum is tensor(0.3710, device='cuda:2')
sum is tensor(1.0763, device='cuda:2')
sum is tensor(13.0011, device='cuda:2')
sum is tensor(148.0339, device='cuda:2')
ratio is tensor(0.6402, device='cuda:2')
threshold is tensor(135.0328, device='cuda:2')
cal diff is tensor(0.7053, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.9248, device='cuda:2')
discard
cal diff is tensor(0.0122, device='cuda:2')
discard
cal diff is tensor(135.0328, device='cuda:2')
clipping
cal diff is tensor(0.0237, device='cuda:2')
discard
cal diff is tensor(0.3266, device='cuda:2')
discard
cal diff is tensor(0.0020, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 54 global rounds:
Train Accuracy: 99.01% 

Test Accuracy: 99.17% 


 | Global Training Round : 55 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.002643080661073327
attack res is False
len of model dicts is  10
compute distance is  tensor(13.7019, device='cuda:2')
compute distance is  tensor(38.7878, device='cuda:2')
compute distance is  tensor(54.5976, device='cuda:2')
compute distance is  tensor(82.0539, device='cuda:2')
compute distance is  tensor(29.9220, device='cuda:2')
compute distance is  tensor(53.9592, device='cuda:2')
compute distance is  tensor(53.1461, device='cuda:2')
compute distance is  tensor(71.5005, device='cuda:2')
compute distance is  tensor(64.5796, device='cuda:2')
compute distance is  tensor(66.7517, device='cuda:2')
calculated distance threshold is  tensor(69.6263, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8224500001563245
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8741833334896558
====================
====================
iteration is  0
round is  2
accuracy is  0.8742000001563225
====================
====================
iteration is  1
round is  0
accuracy is  0.857400000156323
====================
====================
iteration is  1
round is  1
accuracy is  0.7412000001563284
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7431500001563283
====================
====================
iteration is  2
round is  0
accuracy is  0.6759333334896656
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5690500001563401
====================
succ_min + 1
________________________________
test distance is  tensor(5185.3096, device='cuda:2')
test acc is  0.5690500001563401
test loss is 3.3249909042803716
test entropy is  0.21984563958543196
________________________________
diff is  tensor(55.3007, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4172, device='cuda:2', dtype=torch.float64)
diff is  tensor(693.2649, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5666, device='cuda:2', dtype=torch.float64)
diff is  tensor(4408.3802, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.4472, device='cuda:2', dtype=torch.float64)
diff is  tensor(24.6962, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2369, device='cuda:2', dtype=torch.float64)
threshold is  tensor(5115.6831, device='cuda:2')
sum is tensor(0.2369, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6541, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2207, device='cuda:2', dtype=torch.float64)
sum is tensor(3.6679, device='cuda:2', dtype=torch.float64)
sum is tensor(28.3641, device='cuda:2', dtype=torch.float64)
sum is tensor(83.6648, device='cuda:2', dtype=torch.float64)
sum is tensor(776.9297, device='cuda:2', dtype=torch.float64)
sum is tensor(5185.3099, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0158, device='cuda:2', dtype=torch.float64)
threshold is tensor(4408.3802, device='cuda:2', dtype=torch.float64)
cal diff is tensor(55.3007, device='cuda:2')
discard
cal diff is tensor(0.4172, device='cuda:2')
discard
cal diff is tensor(693.2649, device='cuda:2')
discard
cal diff is tensor(0.5666, device='cuda:2')
discard
cal diff is tensor(4408.3799, device='cuda:2')
discard
cal diff is tensor(2.4472, device='cuda:2')
discard
cal diff is tensor(24.6962, device='cuda:2')
discard
cal diff is tensor(0.2369, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.993316666822985
test loss is 0.023808072835992188
test entropy is  0.011644524909389147
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011644524909389147
avg test loss is  0.023808072835992188
avg accuracy is  0.993316666822985
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.27404581515519605
avg test loss is  1.9199249904547164
avg accuracy is  0.6355333334896682
compute_distance is  tensor(94.1239, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(94.1239, device='cuda:2')
test acc is  0.6355333334896682
test loss is 1.9199249904547164
test entropy is  0.27404581515519605
________________________________
diff is  tensor(0.8837, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(12.8531, device='cuda:2')
diff is  tensor(0.0136, device='cuda:2')
diff is  tensor(79.7566, device='cuda:2')
diff is  tensor(0.0508, device='cuda:2')
diff is  tensor(0.5732, device='cuda:2')
diff is  tensor(0.0048, device='cuda:2')
threshold is  tensor(24.4976, device='cuda:2')
sum is tensor(0.0048, device='cuda:2')
sum is tensor(0.0124, device='cuda:2')
sum is tensor(0.0260, device='cuda:2')
sum is tensor(0.0768, device='cuda:2')
sum is tensor(0.6499, device='cuda:2')
sum is tensor(1.5336, device='cuda:2')
sum is tensor(14.3868, device='cuda:2')
sum is tensor(94.1434, device='cuda:2')
ratio is tensor(0.8732, device='cuda:2')
threshold is tensor(79.7566, device='cuda:2')
cal diff is tensor(0.8837, device='cuda:2')
discard
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(12.8531, device='cuda:2')
discard
cal diff is tensor(0.0136, device='cuda:2')
discard
cal diff is tensor(79.7566, device='cuda:2')
clipping
cal diff is tensor(0.0508, device='cuda:2')
discard
cal diff is tensor(0.5732, device='cuda:2')
discard
cal diff is tensor(0.0048, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6391, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10100756937983944
test entropy is  0.05918032653393474
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6469, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0128, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6572, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2')
threshold is tensor(69.6469, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6469, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(69.6365, device='cuda:2')
test acc is  0.9694500001563191
test loss is 0.10099546120928125
test entropy is  0.05917441889098577
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.6444, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(69.6546, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(69.6444, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.6444, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 55 global rounds:
Train Accuracy: 99.01% 

Test Accuracy: 99.17% 


 | Global Training Round : 56 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0026973295025527477
attack res is False
len of model dicts is  10
compute distance is  tensor(13.7190, device='cuda:2')
compute distance is  tensor(71.9614, device='cuda:2')
compute distance is  tensor(51.5383, device='cuda:2')
compute distance is  tensor(102.5650, device='cuda:2')
compute distance is  tensor(35.2435, device='cuda:2')
compute distance is  tensor(71.3097, device='cuda:2')
compute distance is  tensor(53.5542, device='cuda:2')
compute distance is  tensor(57.8742, device='cuda:2')
compute distance is  tensor(65.8078, device='cuda:2')
compute distance is  tensor(64.2216, device='cuda:2')
calculated distance threshold is  tensor(86.4112, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8960500001563215
====================
====================
iteration is  0
round is  1
accuracy is  0.866333333489656
====================
====================
iteration is  0
round is  2
accuracy is  0.8405166668229902
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.6353166668230017
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6951666668229977
====================
====================
iteration is  1
round is  2
accuracy is  0.8195833334896581
====================
====================
iteration is  2
round is  0
accuracy is  0.8396166668229904
====================
________________________________
test distance is  tensor(4706.2085, device='cuda:2')
test acc is  0.6353166668230017
test loss is 4.17392352420384
test entropy is  0.10628619922726139
________________________________
diff is  tensor(46.5848, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4265, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.1813, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5029, device='cuda:2', dtype=torch.float64)
diff is  tensor(4004.8166, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2627, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2512, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1832, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4619.7974, device='cuda:2')
sum is tensor(0.1832, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6097, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1126, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3753, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6265, device='cuda:2', dtype=torch.float64)
sum is tensor(72.2113, device='cuda:2', dtype=torch.float64)
sum is tensor(701.3925, device='cuda:2', dtype=torch.float64)
sum is tensor(4706.2091, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0216, device='cuda:2', dtype=torch.float64)
threshold is tensor(4004.8166, device='cuda:2', dtype=torch.float64)
cal diff is tensor(46.5848, device='cuda:2')
discard
cal diff is tensor(0.4265, device='cuda:2')
discard
cal diff is tensor(629.1813, device='cuda:2')
discard
cal diff is tensor(0.5029, device='cuda:2')
discard
cal diff is tensor(4004.8164, device='cuda:2')
discard
cal diff is tensor(2.2627, device='cuda:2')
discard
cal diff is tensor(22.2512, device='cuda:2')
discard
cal diff is tensor(0.1832, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9933500001563184
test loss is 0.023618134096242676
test entropy is  0.011686878651857297
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011686878651857297
avg test loss is  0.023618134096242676
avg accuracy is  0.9933500001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.09270026282603934
avg test loss is  3.2637764726366316
avg accuracy is  0.6511166668230005
compute_distance is  tensor(94.1002, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(94.1002, device='cuda:2')
test acc is  0.6511166668230005
test loss is 3.2637764726366316
test entropy is  0.09270026282603934
________________________________
diff is  tensor(0.8715, device='cuda:2')
diff is  tensor(0.0079, device='cuda:2')
diff is  tensor(13.0747, device='cuda:2')
diff is  tensor(0.0141, device='cuda:2')
diff is  tensor(79.4673, device='cuda:2')
diff is  tensor(0.0492, device='cuda:2')
diff is  tensor(0.6044, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(7.6890, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0124, device='cuda:2')
sum is tensor(0.0265, device='cuda:2')
sum is tensor(0.0757, device='cuda:2')
sum is tensor(0.6801, device='cuda:2')
sum is tensor(1.5516, device='cuda:2')
sum is tensor(14.6264, device='cuda:2')
ratio is tensor(0.5306, device='cuda:2')
threshold is tensor(13.0747, device='cuda:2')
cal diff is tensor(0.8715, device='cuda:2')
discard
cal diff is tensor(0.0079, device='cuda:2')
discard
cal diff is tensor(13.0747, device='cuda:2')
clipping
cal diff is tensor(0.0141, device='cuda:2')
discard
cal diff is tensor(79.4673, device='cuda:2')
clipping
cal diff is tensor(0.0492, device='cuda:2')
discard
cal diff is tensor(0.6044, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(49.1080, device='cuda:2')
test acc is  0.9757333334896522
test loss is 0.08790177506299617
test entropy is  0.03223726485053443
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03223726485053443
avg test loss is  0.08790177506299617
avg accuracy is  0.9757333334896522
compute_distance is  tensor(49.1080, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.09898347764420928
avg test loss is  3.360753590110014
avg accuracy is  0.6488333334896673
compute_distance is  tensor(114.3001, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(114.3001, device='cuda:2')
test acc is  0.6488333334896673
test loss is 3.360753590110014
test entropy is  0.09898347764420928
________________________________
diff is  tensor(0.6602, device='cuda:2')
diff is  tensor(0.0060, device='cuda:2')
diff is  tensor(16.0536, device='cuda:2')
diff is  tensor(0.0104, device='cuda:2')
diff is  tensor(97.0777, device='cuda:2')
diff is  tensor(0.0274, device='cuda:2')
diff is  tensor(0.4471, device='cuda:2')
diff is  tensor(0.0029, device='cuda:2')
threshold is  tensor(27.8889, device='cuda:2')
sum is tensor(0.0029, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0193, device='cuda:2')
sum is tensor(0.0467, device='cuda:2')
sum is tensor(0.4938, device='cuda:2')
sum is tensor(1.1541, device='cuda:2')
sum is tensor(17.2076, device='cuda:2')
sum is tensor(114.2853, device='cuda:2')
ratio is tensor(0.8900, device='cuda:2')
threshold is tensor(97.0777, device='cuda:2')
cal diff is tensor(0.6602, device='cuda:2')
discard
cal diff is tensor(0.0060, device='cuda:2')
discard
cal diff is tensor(16.0536, device='cuda:2')
discard
cal diff is tensor(0.0104, device='cuda:2')
discard
cal diff is tensor(97.0777, device='cuda:2')
clipping
cal diff is tensor(0.0274, device='cuda:2')
discard
cal diff is tensor(0.4471, device='cuda:2')
discard
cal diff is tensor(0.0029, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4131, device='cuda:2')
test acc is  0.947183333489653
test loss is 0.20397968471169656
test entropy is  0.05949083382838658
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(86.3960, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0020, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.9108, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(86.3960, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(78.7078, device='cuda:2')
test acc is  0.961966666822986
test loss is 0.14337706762590915
test entropy is  0.04676017583385587
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04676017583385587
avg test loss is  0.14337706762590915
avg accuracy is  0.961966666822986
compute_distance is  tensor(78.7078, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10146502285663571
avg test loss is  3.4250700664418594
avg accuracy is  0.6482333334896674
compute_distance is  tensor(138.0291, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(138.0291, device='cuda:2')
test acc is  0.6482333334896674
test loss is 3.4250700664418594
test entropy is  0.10146502285663571
________________________________
diff is  tensor(0.7371, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.3954, device='cuda:2')
diff is  tensor(0.0104, device='cuda:2')
diff is  tensor(126.4299, device='cuda:2')
diff is  tensor(0.0258, device='cuda:2')
diff is  tensor(0.4000, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(51.6179, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0188, device='cuda:2')
sum is tensor(0.0445, device='cuda:2')
sum is tensor(0.4445, device='cuda:2')
sum is tensor(1.1816, device='cuda:2')
sum is tensor(11.5770, device='cuda:2')
sum is tensor(138.0069, device='cuda:2')
ratio is tensor(0.6833, device='cuda:2')
threshold is tensor(126.4299, device='cuda:2')
cal diff is tensor(0.7371, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.3954, device='cuda:2')
discard
cal diff is tensor(0.0104, device='cuda:2')
discard
cal diff is tensor(126.4299, device='cuda:2')
clipping
cal diff is tensor(0.0258, device='cuda:2')
discard
cal diff is tensor(0.4000, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4070, device='cuda:2')
test acc is  0.955533333489653
test loss is 0.16874740094953983
test entropy is  0.05281695418570167
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05281695418570167
avg test loss is  0.16874740094953983
avg accuracy is  0.955533333489653
compute_distance is  tensor(86.4070, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10229091992430976
avg test loss is  3.453400642251663
avg accuracy is  0.6479833334896673
compute_distance is  tensor(144.8783, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(144.8783, device='cuda:2')
test acc is  0.6479833334896673
test loss is 3.453400642251663
test entropy is  0.10229091992430976
________________________________
diff is  tensor(0.7517, device='cuda:2')
diff is  tensor(0.0054, device='cuda:2')
diff is  tensor(10.2689, device='cuda:2')
diff is  tensor(0.0103, device='cuda:2')
diff is  tensor(133.4090, device='cuda:2')
diff is  tensor(0.0241, device='cuda:2')
diff is  tensor(0.3816, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(58.4672, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0080, device='cuda:2')
sum is tensor(0.0183, device='cuda:2')
sum is tensor(0.0424, device='cuda:2')
sum is tensor(0.4240, device='cuda:2')
sum is tensor(1.1757, device='cuda:2')
sum is tensor(11.4447, device='cuda:2')
sum is tensor(144.8537, device='cuda:2')
ratio is tensor(0.6475, device='cuda:2')
threshold is tensor(133.4090, device='cuda:2')
cal diff is tensor(0.7517, device='cuda:2')
discard
cal diff is tensor(0.0054, device='cuda:2')
discard
cal diff is tensor(10.2689, device='cuda:2')
discard
cal diff is tensor(0.0103, device='cuda:2')
discard
cal diff is tensor(133.4090, device='cuda:2')
clipping
cal diff is tensor(0.0241, device='cuda:2')
discard
cal diff is tensor(0.3816, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4056, device='cuda:2')
test acc is  0.9614500001563193
test loss is 0.14510674937397056
test entropy is  0.04766310016867389
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04766310016867389
avg test loss is  0.14510674937397056
avg accuracy is  0.9614500001563193
compute_distance is  tensor(86.4056, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10234290125892996
avg test loss is  3.45862173576599
avg accuracy is  0.6478833334896674
compute_distance is  tensor(146.1933, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.1933, device='cuda:2')
test acc is  0.6478833334896674
test loss is 3.45862173576599
test entropy is  0.10234290125892996
________________________________
diff is  tensor(0.7548, device='cuda:2')
diff is  tensor(0.0056, device='cuda:2')
diff is  tensor(10.5260, device='cuda:2')
diff is  tensor(0.0106, device='cuda:2')
diff is  tensor(134.4614, device='cuda:2')
diff is  tensor(0.0247, device='cuda:2')
diff is  tensor(0.3821, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(59.7822, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0082, device='cuda:2')
sum is tensor(0.0189, device='cuda:2')
sum is tensor(0.0436, device='cuda:2')
sum is tensor(0.4257, device='cuda:2')
sum is tensor(1.1805, device='cuda:2')
sum is tensor(11.7065, device='cuda:2')
sum is tensor(146.1679, device='cuda:2')
ratio is tensor(0.6425, device='cuda:2')
threshold is tensor(134.4614, device='cuda:2')
cal diff is tensor(0.7548, device='cuda:2')
discard
cal diff is tensor(0.0056, device='cuda:2')
discard
cal diff is tensor(10.5260, device='cuda:2')
discard
cal diff is tensor(0.0106, device='cuda:2')
discard
cal diff is tensor(134.4614, device='cuda:2')
clipping
cal diff is tensor(0.0247, device='cuda:2')
discard
cal diff is tensor(0.3821, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4055, device='cuda:2')
test acc is  0.9636333334896525
test loss is 0.1362627968626486
test entropy is  0.04566636915498131
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04566636915498131
avg test loss is  0.1362627968626486
avg accuracy is  0.9636333334896525
compute_distance is  tensor(86.4055, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10235949168239893
avg test loss is  3.4598331079045845
avg accuracy is  0.6479333334896674
compute_distance is  tensor(146.7745, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.7745, device='cuda:2')
test acc is  0.6479333334896674
test loss is 3.4598331079045845
test entropy is  0.10235949168239893
________________________________
diff is  tensor(0.7556, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.6561, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(134.9096, device='cuda:2')
diff is  tensor(0.0251, device='cuda:2')
diff is  tensor(0.3831, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(60.3633, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0083, device='cuda:2')
sum is tensor(0.0191, device='cuda:2')
sum is tensor(0.0442, device='cuda:2')
sum is tensor(0.4273, device='cuda:2')
sum is tensor(1.1829, device='cuda:2')
sum is tensor(11.8390, device='cuda:2')
sum is tensor(146.7486, device='cuda:2')
ratio is tensor(0.6403, device='cuda:2')
threshold is tensor(134.9096, device='cuda:2')
cal diff is tensor(0.7556, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.6561, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(134.9096, device='cuda:2')
clipping
cal diff is tensor(0.0251, device='cuda:2')
discard
cal diff is tensor(0.3831, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4055, device='cuda:2')
test acc is  0.9647500001563192
test loss is 0.13228179534463536
test entropy is  0.04473722336959265
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04473722336959265
avg test loss is  0.13228179534463536
avg accuracy is  0.9647500001563192
compute_distance is  tensor(86.4055, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10237278133185941
avg test loss is  3.461024331894002
avg accuracy is  0.6479333334896674
compute_distance is  tensor(147.0820, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.0820, device='cuda:2')
test acc is  0.6479333334896674
test loss is 3.461024331894002
test entropy is  0.10237278133185941
________________________________
diff is  tensor(0.7556, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.7281, device='cuda:2')
diff is  tensor(0.0109, device='cuda:2')
diff is  tensor(135.1441, device='cuda:2')
diff is  tensor(0.0252, device='cuda:2')
diff is  tensor(0.3835, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(60.6709, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0083, device='cuda:2')
sum is tensor(0.0192, device='cuda:2')
sum is tensor(0.0445, device='cuda:2')
sum is tensor(0.4279, device='cuda:2')
sum is tensor(1.1836, device='cuda:2')
sum is tensor(11.9117, device='cuda:2')
sum is tensor(147.0557, device='cuda:2')
ratio is tensor(0.6392, device='cuda:2')
threshold is tensor(135.1441, device='cuda:2')
cal diff is tensor(0.7556, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.7281, device='cuda:2')
discard
cal diff is tensor(0.0109, device='cuda:2')
discard
cal diff is tensor(135.1441, device='cuda:2')
clipping
cal diff is tensor(0.0252, device='cuda:2')
discard
cal diff is tensor(0.3835, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4054, device='cuda:2')
test acc is  0.9653833334896526
test loss is 0.13011907878473125
test entropy is  0.044225487044980395
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.044225487044980395
avg test loss is  0.13011907878473125
avg accuracy is  0.9653833334896526
compute_distance is  tensor(86.4054, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1023982759497599
avg test loss is  3.462103538294591
avg accuracy is  0.6479166668230008
compute_distance is  tensor(147.2486, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.2486, device='cuda:2')
test acc is  0.6479166668230008
test loss is 3.462103538294591
test entropy is  0.1023982759497599
________________________________
diff is  tensor(0.7553, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.7654, device='cuda:2')
diff is  tensor(0.0109, device='cuda:2')
diff is  tensor(135.2734, device='cuda:2')
diff is  tensor(0.0253, device='cuda:2')
diff is  tensor(0.3832, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(60.8374, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0193, device='cuda:2')
sum is tensor(0.0446, device='cuda:2')
sum is tensor(0.4279, device='cuda:2')
sum is tensor(1.1832, device='cuda:2')
sum is tensor(11.9486, device='cuda:2')
sum is tensor(147.2220, device='cuda:2')
ratio is tensor(0.6386, device='cuda:2')
threshold is tensor(135.2734, device='cuda:2')
cal diff is tensor(0.7553, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.7654, device='cuda:2')
discard
cal diff is tensor(0.0109, device='cuda:2')
discard
cal diff is tensor(135.2734, device='cuda:2')
clipping
cal diff is tensor(0.0253, device='cuda:2')
discard
cal diff is tensor(0.3832, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(86.4054, device='cuda:2')
test acc is  0.9657666668229858
test loss is 0.12885989457969343
test entropy is  0.04392191146648472
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04392191146648472
avg test loss is  0.12885989457969343
avg accuracy is  0.9657666668229858
compute_distance is  tensor(86.4054, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10242961424349277
avg test loss is  3.4633328788824427
avg accuracy is  0.6478666668230008
compute_distance is  tensor(147.3419, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.3419, device='cuda:2')
test acc is  0.6478666668230008
test loss is 3.4633328788824427
test entropy is  0.10242961424349277
________________________________
diff is  tensor(0.7551, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.7891, device='cuda:2')
diff is  tensor(0.0110, device='cuda:2')
diff is  tensor(135.3431, device='cuda:2')
diff is  tensor(0.0254, device='cuda:2')
diff is  tensor(0.3830, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(60.9307, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0193, device='cuda:2')
sum is tensor(0.0448, device='cuda:2')
sum is tensor(0.4277, device='cuda:2')
sum is tensor(1.1828, device='cuda:2')
sum is tensor(11.9720, device='cuda:2')
sum is tensor(147.3150, device='cuda:2')
ratio is tensor(0.6383, device='cuda:2')
threshold is tensor(135.3431, device='cuda:2')
cal diff is tensor(0.7551, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.7891, device='cuda:2')
discard
cal diff is tensor(0.0110, device='cuda:2')
discard
cal diff is tensor(135.3431, device='cuda:2')
clipping
cal diff is tensor(0.0254, device='cuda:2')
discard
cal diff is tensor(0.3830, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 56 global rounds:
Train Accuracy: 99.00% 

Test Accuracy: 99.18% 


 | Global Training Round : 57 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0027965866029262543
attack res is False
len of model dicts is  10
compute distance is  tensor(13.0363, device='cuda:2')
compute distance is  tensor(56.2428, device='cuda:2')
compute distance is  tensor(74.5411, device='cuda:2')
compute distance is  tensor(86.8346, device='cuda:2')
compute distance is  tensor(32.2624, device='cuda:2')
compute distance is  tensor(83.7324, device='cuda:2')
compute distance is  tensor(47.7595, device='cuda:2')
compute distance is  tensor(70.3433, device='cuda:2')
compute distance is  tensor(63.4122, device='cuda:2')
compute distance is  tensor(47.7321, device='cuda:2')
calculated distance threshold is  tensor(73.4168, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.6269000001563357
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8524333334896566
====================
====================
iteration is  0
round is  2
accuracy is  0.7249000001563293
====================
====================
iteration is  1
round is  0
accuracy is  0.6761333334896656
====================
====================
iteration is  1
round is  1
accuracy is  0.8150833334896581
====================
====================
iteration is  1
round is  2
accuracy is  0.6913666668229979
====================
________________________________
test distance is  tensor(4280.8613, device='cuda:2')
test acc is  0.6269000001563357
test loss is 2.232743352143241
test entropy is  0.1688269577157904
________________________________
diff is  tensor(44.2796, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3343, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.7672, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5515, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.3931, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0229, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3048, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2081, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4207.4443, device='cuda:2')
sum is tensor(0.2081, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5424, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0938, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1167, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4215, device='cuda:2', dtype=torch.float64)
sum is tensor(67.7011, device='cuda:2', dtype=torch.float64)
sum is tensor(639.4682, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.8614, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0202, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.3931, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.2796, device='cuda:2')
discard
cal diff is tensor(0.3343, device='cuda:2')
discard
cal diff is tensor(571.7672, device='cuda:2')
discard
cal diff is tensor(0.5515, device='cuda:2')
discard
cal diff is tensor(3641.3931, device='cuda:2')
discard
cal diff is tensor(2.0229, device='cuda:2')
discard
cal diff is tensor(20.3048, device='cuda:2')
discard
cal diff is tensor(0.2081, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9933833334896517
test loss is 0.023553423651788634
test entropy is  0.011644547801874988
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011644547801874988
avg test loss is  0.023553423651788634
avg accuracy is  0.9933833334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19131982748283508
avg test loss is  1.7103963368800656
avg accuracy is  0.6533666668230007
compute_distance is  tensor(84.7697, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.7697, device='cuda:2')
test acc is  0.6533666668230007
test loss is 1.7103963368800656
test entropy is  0.19131982748283508
________________________________
diff is  tensor(0.8120, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(11.0137, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(72.3645, device='cuda:2')
diff is  tensor(0.0456, device='cuda:2')
diff is  tensor(0.5243, device='cuda:2')
diff is  tensor(0.0049, device='cuda:2')
threshold is  tensor(11.3529, device='cuda:2')
sum is tensor(0.0049, device='cuda:2')
sum is tensor(0.0116, device='cuda:2')
sum is tensor(0.0234, device='cuda:2')
sum is tensor(0.0690, device='cuda:2')
sum is tensor(0.5934, device='cuda:2')
sum is tensor(1.4054, device='cuda:2')
sum is tensor(12.4191, device='cuda:2')
ratio is tensor(0.0968, device='cuda:2')
threshold is tensor(11.0137, device='cuda:2')
cal diff is tensor(0.8120, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(11.0137, device='cuda:2')
clipping
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(72.3645, device='cuda:2')
clipping
cal diff is tensor(0.0456, device='cuda:2')
discard
cal diff is tensor(0.5243, device='cuda:2')
discard
cal diff is tensor(0.0049, device='cuda:2')
discard
________________________________
test distance is  tensor(8.0649, device='cuda:2')
test acc is  0.9930166668229851
test loss is 0.02396145808004874
test entropy is  0.012335235140218467
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012335235140218467
avg test loss is  0.02396145808004874
avg accuracy is  0.9930166668229851
compute_distance is  tensor(8.0649, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1911709186698455
avg test loss is  1.7189698444881927
avg accuracy is  0.653250000156334
compute_distance is  tensor(88.4091, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(88.4091, device='cuda:2')
test acc is  0.653250000156334
test loss is 1.7189698444881927
test entropy is  0.1911709186698455
________________________________
diff is  tensor(0.7570, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(11.7377, device='cuda:2')
diff is  tensor(0.0116, device='cuda:2')
diff is  tensor(75.3713, device='cuda:2')
diff is  tensor(0.0410, device='cuda:2')
diff is  tensor(0.4910, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(14.9924, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0108, device='cuda:2')
sum is tensor(0.0224, device='cuda:2')
sum is tensor(0.0634, device='cuda:2')
sum is tensor(0.5544, device='cuda:2')
sum is tensor(1.3114, device='cuda:2')
sum is tensor(13.0491, device='cuda:2')
sum is tensor(88.4204, device='cuda:2')
ratio is tensor(0.9742, device='cuda:2')
threshold is tensor(75.3713, device='cuda:2')
cal diff is tensor(0.7570, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(11.7377, device='cuda:2')
discard
cal diff is tensor(0.0116, device='cuda:2')
discard
cal diff is tensor(75.3713, device='cuda:2')
clipping
cal diff is tensor(0.0410, device='cuda:2')
discard
cal diff is tensor(0.4910, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4282, device='cuda:2')
test acc is  0.9245500001563207
test loss is 0.2762013170506377
test entropy is  0.08581109465991478
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4282, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0114, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4384, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2')
threshold is tensor(73.4282, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4282, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.4270, device='cuda:2')
test acc is  0.9245666668229874
test loss is 0.27618277152746556
test entropy is  0.08580738038464046
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(73.4270, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(73.4372, device='cuda:2')
ratio is tensor(1., device='cuda:2')
threshold is tensor(73.4270, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(73.4270, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 57 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.19% 


 | Global Training Round : 58 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0029802967328578234
attack res is False
len of model dicts is  10
compute distance is  tensor(12.6556, device='cuda:2')
compute distance is  tensor(54.6188, device='cuda:2')
compute distance is  tensor(63.5779, device='cuda:2')
compute distance is  tensor(102.2990, device='cuda:2')
compute distance is  tensor(43.1729, device='cuda:2')
compute distance is  tensor(64.8674, device='cuda:2')
compute distance is  tensor(51.1866, device='cuda:2')
compute distance is  tensor(32.1801, device='cuda:2')
compute distance is  tensor(47.6536, device='cuda:2')
compute distance is  tensor(30.4729, device='cuda:2')
calculated distance threshold is  tensor(86.0002, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8711000001563225
====================
====================
iteration is  0
round is  1
accuracy is  0.903966666822988
====================
====================
iteration is  0
round is  2
accuracy is  0.8641666668229895
====================
====================
iteration is  1
round is  0
accuracy is  0.8208333334896579
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.922033333489654
====================
====================
iteration is  1
round is  2
accuracy is  0.8727166668229892
====================
====================
iteration is  2
round is  0
accuracy is  0.6980666668229977
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5389333334896756
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.632566666823002
====================
====================
iteration is  3
round is  0
accuracy is  0.5437000001563423
====================
________________________________
test distance is  tensor(5180.6025, device='cuda:2')
test acc is  0.5389333334896756
test loss is 3.6374031351065077
test entropy is  0.20578960935348894
________________________________
diff is  tensor(54.3100, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4334, device='cuda:2', dtype=torch.float64)
diff is  tensor(690.9759, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5837, device='cuda:2', dtype=torch.float64)
diff is  tensor(4406.9086, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.4491, device='cuda:2', dtype=torch.float64)
diff is  tensor(24.6767, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2645, device='cuda:2', dtype=torch.float64)
threshold is  tensor(5094.6025, device='cuda:2')
sum is tensor(0.2645, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6979, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2817, device='cuda:2', dtype=torch.float64)
sum is tensor(3.7307, device='cuda:2', dtype=torch.float64)
sum is tensor(28.4075, device='cuda:2', dtype=torch.float64)
sum is tensor(82.7174, device='cuda:2', dtype=torch.float64)
sum is tensor(773.6933, device='cuda:2', dtype=torch.float64)
sum is tensor(5180.6019, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0195, device='cuda:2', dtype=torch.float64)
threshold is tensor(4406.9086, device='cuda:2', dtype=torch.float64)
cal diff is tensor(54.3100, device='cuda:2')
discard
cal diff is tensor(0.4334, device='cuda:2')
discard
cal diff is tensor(690.9759, device='cuda:2')
discard
cal diff is tensor(0.5837, device='cuda:2')
discard
cal diff is tensor(4406.9082, device='cuda:2')
discard
cal diff is tensor(2.4491, device='cuda:2')
discard
cal diff is tensor(24.6767, device='cuda:2')
discard
cal diff is tensor(0.2645, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9933500001563184
test loss is 0.023559994110723764
test entropy is  0.011586389556310021
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011586389556310021
avg test loss is  0.023559994110723764
avg accuracy is  0.9933500001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2971412141535328
avg test loss is  1.7704701581235125
avg accuracy is  0.6031500001563376
compute_distance is  tensor(94.5314, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(94.5314, device='cuda:2')
test acc is  0.6031500001563376
test loss is 1.7704701581235125
test entropy is  0.2971412141535328
________________________________
diff is  tensor(0.8746, device='cuda:2')
diff is  tensor(0.0083, device='cuda:2')
diff is  tensor(13.2939, device='cuda:2')
diff is  tensor(0.0150, device='cuda:2')
diff is  tensor(79.6982, device='cuda:2')
diff is  tensor(0.0485, device='cuda:2')
diff is  tensor(0.5980, device='cuda:2')
diff is  tensor(0.0052, device='cuda:2')
threshold is  tensor(8.5313, device='cuda:2')
sum is tensor(0.0052, device='cuda:2')
sum is tensor(0.0136, device='cuda:2')
sum is tensor(0.0286, device='cuda:2')
sum is tensor(0.0771, device='cuda:2')
sum is tensor(0.6751, device='cuda:2')
sum is tensor(1.5497, device='cuda:2')
sum is tensor(14.8436, device='cuda:2')
ratio is tensor(0.4748, device='cuda:2')
threshold is tensor(13.2939, device='cuda:2')
cal diff is tensor(0.8746, device='cuda:2')
discard
cal diff is tensor(0.0083, device='cuda:2')
discard
cal diff is tensor(13.2939, device='cuda:2')
clipping
cal diff is tensor(0.0150, device='cuda:2')
discard
cal diff is tensor(79.6982, device='cuda:2')
clipping
cal diff is tensor(0.0485, device='cuda:2')
discard
cal diff is tensor(0.5980, device='cuda:2')
discard
cal diff is tensor(0.0052, device='cuda:2')
discard
________________________________
test distance is  tensor(44.1485, device='cuda:2')
test acc is  0.9859166668229853
test loss is 0.04867688312018361
test entropy is  0.02729223858175262
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02729223858175262
avg test loss is  0.04867688312018361
avg accuracy is  0.9859166668229853
compute_distance is  tensor(44.1485, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.27457987923802596
avg test loss is  2.002661321907918
avg accuracy is  0.5920500001563384
compute_distance is  tensor(114.9836, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(114.9836, device='cuda:2')
test acc is  0.5920500001563384
test loss is 2.002661321907918
test entropy is  0.27457987923802596
________________________________
diff is  tensor(0.8038, device='cuda:2')
diff is  tensor(0.0071, device='cuda:2')
diff is  tensor(16.7255, device='cuda:2')
diff is  tensor(0.0122, device='cuda:2')
diff is  tensor(96.9677, device='cuda:2')
diff is  tensor(0.0290, device='cuda:2')
diff is  tensor(0.4338, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(28.9834, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0103, device='cuda:2')
sum is tensor(0.0225, device='cuda:2')
sum is tensor(0.0515, device='cuda:2')
sum is tensor(0.4853, device='cuda:2')
sum is tensor(1.2891, device='cuda:2')
sum is tensor(18.0146, device='cuda:2')
sum is tensor(114.9823, device='cuda:2')
ratio is tensor(0.8869, device='cuda:2')
threshold is tensor(96.9677, device='cuda:2')
cal diff is tensor(0.8038, device='cuda:2')
discard
cal diff is tensor(0.0071, device='cuda:2')
discard
cal diff is tensor(16.7255, device='cuda:2')
discard
cal diff is tensor(0.0122, device='cuda:2')
discard
cal diff is tensor(96.9677, device='cuda:2')
clipping
cal diff is tensor(0.0290, device='cuda:2')
discard
cal diff is tensor(0.4338, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(86.0042, device='cuda:2')
test acc is  0.9651000001563192
test loss is 0.11952442833890968
test entropy is  0.06000482497229449
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(85.9992, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0040, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6832, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(85.9992, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(58.7625, device='cuda:2')
test acc is  0.9858000001563186
test loss is 0.04873293060954563
test entropy is  0.027243163384555995
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.027243163384555995
avg test loss is  0.04873293060954563
avg accuracy is  0.9858000001563186
compute_distance is  tensor(58.7625, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2683939734485739
avg test loss is  2.0872058999945104
avg accuracy is  0.5856000001563388
compute_distance is  tensor(130.1482, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(130.1482, device='cuda:2')
test acc is  0.5856000001563388
test loss is 2.0872058999945104
test entropy is  0.2683939734485739
________________________________
diff is  tensor(0.8408, device='cuda:2')
diff is  tensor(0.0080, device='cuda:2')
diff is  tensor(12.6000, device='cuda:2')
diff is  tensor(0.0136, device='cuda:2')
diff is  tensor(116.2383, device='cuda:2')
diff is  tensor(0.0302, device='cuda:2')
diff is  tensor(0.4076, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(44.1481, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0112, device='cuda:2')
sum is tensor(0.0247, device='cuda:2')
sum is tensor(0.0550, device='cuda:2')
sum is tensor(0.4626, device='cuda:2')
sum is tensor(1.3034, device='cuda:2')
sum is tensor(13.9034, device='cuda:2')
sum is tensor(130.1417, device='cuda:2')
ratio is tensor(0.7398, device='cuda:2')
threshold is tensor(116.2383, device='cuda:2')
cal diff is tensor(0.8408, device='cuda:2')
discard
cal diff is tensor(0.0080, device='cuda:2')
discard
cal diff is tensor(12.6000, device='cuda:2')
discard
cal diff is tensor(0.0136, device='cuda:2')
discard
cal diff is tensor(116.2383, device='cuda:2')
clipping
cal diff is tensor(0.0302, device='cuda:2')
discard
cal diff is tensor(0.4076, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(86.0007, device='cuda:2')
test acc is  0.9690000001563192
test loss is 0.1059176246605519
test entropy is  0.05662594556667979
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(85.9941, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0006, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.7648, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(85.9941, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(65.7789, device='cuda:2')
test acc is  0.9839666668229853
test loss is 0.05498365651371109
test entropy is  0.03150863386752672
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03150863386752672
avg test loss is  0.05498365651371109
avg accuracy is  0.9839666668229853
compute_distance is  tensor(65.7789, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.26542303024896424
avg test loss is  2.1273476938321902
avg accuracy is  0.5832833334896724
compute_distance is  tensor(136.0135, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.0135, device='cuda:2')
test acc is  0.5832833334896724
test loss is 2.1273476938321902
test entropy is  0.26542303024896424
________________________________
diff is  tensor(0.8495, device='cuda:2')
diff is  tensor(0.0080, device='cuda:2')
diff is  tensor(12.5980, device='cuda:2')
diff is  tensor(0.0134, device='cuda:2')
diff is  tensor(122.1154, device='cuda:2')
diff is  tensor(0.0285, device='cuda:2')
diff is  tensor(0.3888, device='cuda:2')
diff is  tensor(0.0030, device='cuda:2')
threshold is  tensor(50.0134, device='cuda:2')
sum is tensor(0.0030, device='cuda:2')
sum is tensor(0.0110, device='cuda:2')
sum is tensor(0.0243, device='cuda:2')
sum is tensor(0.0528, device='cuda:2')
sum is tensor(0.4416, device='cuda:2')
sum is tensor(1.2912, device='cuda:2')
sum is tensor(13.8892, device='cuda:2')
sum is tensor(136.0045, device='cuda:2')
ratio is tensor(0.7042, device='cuda:2')
threshold is tensor(122.1154, device='cuda:2')
cal diff is tensor(0.8495, device='cuda:2')
discard
cal diff is tensor(0.0080, device='cuda:2')
discard
cal diff is tensor(12.5980, device='cuda:2')
discard
cal diff is tensor(0.0134, device='cuda:2')
discard
cal diff is tensor(122.1154, device='cuda:2')
clipping
cal diff is tensor(0.0285, device='cuda:2')
discard
cal diff is tensor(0.3888, device='cuda:2')
discard
cal diff is tensor(0.0030, device='cuda:2')
discard
________________________________
test distance is  tensor(85.9995, device='cuda:2')
test acc is  0.9721833334896524
test loss is 0.09486463613832853
test entropy is  0.052089907606737984
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.052089907606737984
avg test loss is  0.09486463613832853
avg accuracy is  0.9721833334896524
compute_distance is  tensor(85.9995, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2591680052565105
avg test loss is  2.20924798537419
avg accuracy is  0.5793833334896726
compute_distance is  tensor(149.2395, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(149.2395, device='cuda:2')
test acc is  0.5793833334896726
test loss is 2.20924798537419
test entropy is  0.2591680052565105
________________________________
diff is  tensor(0.8606, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(12.0988, device='cuda:2')
diff is  tensor(0.0121, device='cuda:2')
diff is  tensor(135.8729, device='cuda:2')
diff is  tensor(0.0240, device='cuda:2')
diff is  tensor(0.3485, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(63.2393, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0099, device='cuda:2')
sum is tensor(0.0220, device='cuda:2')
sum is tensor(0.0461, device='cuda:2')
sum is tensor(0.3945, device='cuda:2')
sum is tensor(1.2551, device='cuda:2')
sum is tensor(13.3539, device='cuda:2')
sum is tensor(149.2268, device='cuda:2')
ratio is tensor(0.6329, device='cuda:2')
threshold is tensor(135.8729, device='cuda:2')
cal diff is tensor(0.8606, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(12.0988, device='cuda:2')
discard
cal diff is tensor(0.0121, device='cuda:2')
discard
cal diff is tensor(135.8729, device='cuda:2')
clipping
cal diff is tensor(0.0240, device='cuda:2')
discard
cal diff is tensor(0.3485, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(85.9975, device='cuda:2')
test acc is  0.9762833334896522
test loss is 0.08024924241523076
test entropy is  0.045518180858696314
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.045518180858696314
avg test loss is  0.08024924241523076
avg accuracy is  0.9762833334896522
compute_distance is  tensor(85.9975, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2589293688154424
avg test loss is  2.2143195518044267
avg accuracy is  0.5790166668230061
compute_distance is  tensor(150.8195, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(150.8195, device='cuda:2')
test acc is  0.5790166668230061
test loss is 2.2143195518044267
test entropy is  0.2589293688154424
________________________________
diff is  tensor(0.8680, device='cuda:2')
diff is  tensor(0.0077, device='cuda:2')
diff is  tensor(12.3536, device='cuda:2')
diff is  tensor(0.0125, device='cuda:2')
diff is  tensor(137.1883, device='cuda:2')
diff is  tensor(0.0249, device='cuda:2')
diff is  tensor(0.3484, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(64.8193, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(0.0228, device='cuda:2')
sum is tensor(0.0477, device='cuda:2')
sum is tensor(0.3961, device='cuda:2')
sum is tensor(1.2641, device='cuda:2')
sum is tensor(13.6176, device='cuda:2')
sum is tensor(150.8059, device='cuda:2')
ratio is tensor(0.6268, device='cuda:2')
threshold is tensor(137.1883, device='cuda:2')
cal diff is tensor(0.8680, device='cuda:2')
discard
cal diff is tensor(0.0077, device='cuda:2')
discard
cal diff is tensor(12.3536, device='cuda:2')
discard
cal diff is tensor(0.0125, device='cuda:2')
discard
cal diff is tensor(137.1883, device='cuda:2')
clipping
cal diff is tensor(0.0249, device='cuda:2')
discard
cal diff is tensor(0.3484, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(85.9973, device='cuda:2')
test acc is  0.9776000001563189
test loss is 0.0758711460006305
test entropy is  0.04333599813714145
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04333599813714145
avg test loss is  0.0758711460006305
avg accuracy is  0.9776000001563189
compute_distance is  tensor(85.9973, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.25887855011294647
avg test loss is  2.215939477181384
avg accuracy is  0.5789333334896728
compute_distance is  tensor(151.4187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(151.4187, device='cuda:2')
test acc is  0.5789333334896728
test loss is 2.215939477181384
test entropy is  0.25887855011294647
________________________________
diff is  tensor(0.8696, device='cuda:2')
diff is  tensor(0.0078, device='cuda:2')
diff is  tensor(12.4731, device='cuda:2')
diff is  tensor(0.0127, device='cuda:2')
diff is  tensor(137.6640, device='cuda:2')
diff is  tensor(0.0254, device='cuda:2')
diff is  tensor(0.3493, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(65.4185, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0231, device='cuda:2')
sum is tensor(0.0485, device='cuda:2')
sum is tensor(0.3977, device='cuda:2')
sum is tensor(1.2673, device='cuda:2')
sum is tensor(13.7404, device='cuda:2')
sum is tensor(151.4045, device='cuda:2')
ratio is tensor(0.6246, device='cuda:2')
threshold is tensor(137.6640, device='cuda:2')
cal diff is tensor(0.8696, device='cuda:2')
discard
cal diff is tensor(0.0078, device='cuda:2')
discard
cal diff is tensor(12.4731, device='cuda:2')
discard
cal diff is tensor(0.0127, device='cuda:2')
discard
cal diff is tensor(137.6640, device='cuda:2')
clipping
cal diff is tensor(0.0254, device='cuda:2')
discard
cal diff is tensor(0.3493, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(85.9973, device='cuda:2')
test acc is  0.9781666668229855
test loss is 0.07415297529643256
test entropy is  0.0424251039463432
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0424251039463432
avg test loss is  0.07415297529643256
avg accuracy is  0.9781666668229855
compute_distance is  tensor(85.9973, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2588939865006567
avg test loss is  2.2168521889364285
avg accuracy is  0.5790000001563395
compute_distance is  tensor(151.6824, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(151.6824, device='cuda:2')
test acc is  0.5790000001563395
test loss is 2.2168521889364285
test entropy is  0.2588939865006567
________________________________
diff is  tensor(0.8703, device='cuda:2')
diff is  tensor(0.0078, device='cuda:2')
diff is  tensor(12.5326, device='cuda:2')
diff is  tensor(0.0128, device='cuda:2')
diff is  tensor(137.8667, device='cuda:2')
diff is  tensor(0.0256, device='cuda:2')
diff is  tensor(0.3493, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(65.6822, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0232, device='cuda:2')
sum is tensor(0.0488, device='cuda:2')
sum is tensor(0.3982, device='cuda:2')
sum is tensor(1.2685, device='cuda:2')
sum is tensor(13.8011, device='cuda:2')
sum is tensor(151.6678, device='cuda:2')
ratio is tensor(0.6237, device='cuda:2')
threshold is tensor(137.8667, device='cuda:2')
cal diff is tensor(0.8703, device='cuda:2')
discard
cal diff is tensor(0.0078, device='cuda:2')
discard
cal diff is tensor(12.5326, device='cuda:2')
discard
cal diff is tensor(0.0128, device='cuda:2')
discard
cal diff is tensor(137.8667, device='cuda:2')
clipping
cal diff is tensor(0.0256, device='cuda:2')
discard
cal diff is tensor(0.3493, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(85.9972, device='cuda:2')
test acc is  0.9783333334896522
test loss is 0.07334080414799626
test entropy is  0.0419833064816499
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0419833064816499
avg test loss is  0.07334080414799626
avg accuracy is  0.9783333334896522
compute_distance is  tensor(85.9972, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2589002400636673
avg test loss is  2.218248870136387
avg accuracy is  0.5790500001563395
compute_distance is  tensor(151.8063, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 58 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.21% 


 | Global Training Round : 59 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0032117972150444984
attack res is False
len of model dicts is  10
compute distance is  tensor(13.5458, device='cuda:2')
compute distance is  tensor(66.2333, device='cuda:2')
compute distance is  tensor(103.8227, device='cuda:2')
compute distance is  tensor(81.6330, device='cuda:2')
compute distance is  tensor(34.1543, device='cuda:2')
compute distance is  tensor(63.2816, device='cuda:2')
compute distance is  tensor(75.6854, device='cuda:2')
compute distance is  tensor(67.6250, device='cuda:2')
compute distance is  tensor(87.8269, device='cuda:2')
compute distance is  tensor(31.9055, device='cuda:2')
calculated distance threshold is  tensor(87.4087, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8244166668229911
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8237666668229913
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8648000001563227
====================
====================
iteration is  1
round is  0
accuracy is  0.743266666822995
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8194333334896579
====================
====================
iteration is  1
round is  2
accuracy is  0.7813666668229929
====================
________________________________
test distance is  tensor(4712.6299, device='cuda:2')
test acc is  0.743266666822995
test loss is 2.2438121511102485
test entropy is  0.12477071059029748
________________________________
diff is  tensor(48.9501, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4242, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.6337, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5497, device='cuda:2', dtype=torch.float64)
diff is  tensor(4007.1969, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2735, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.4020, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2001, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4625.2212, device='cuda:2')
sum is tensor(0.2001, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6243, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1739, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4474, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8494, device='cuda:2', dtype=torch.float64)
sum is tensor(74.7995, device='cuda:2', dtype=torch.float64)
sum is tensor(705.4332, device='cuda:2', dtype=torch.float64)
sum is tensor(4712.6301, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0218, device='cuda:2', dtype=torch.float64)
threshold is tensor(4007.1969, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.9501, device='cuda:2')
discard
cal diff is tensor(0.4242, device='cuda:2')
discard
cal diff is tensor(630.6337, device='cuda:2')
discard
cal diff is tensor(0.5497, device='cuda:2')
discard
cal diff is tensor(4007.1968, device='cuda:2')
discard
cal diff is tensor(2.2735, device='cuda:2')
discard
cal diff is tensor(22.4020, device='cuda:2')
discard
cal diff is tensor(0.2001, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9933333334896517
test loss is 0.023564203509727544
test entropy is  0.011508295532792695
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011508295532792695
avg test loss is  0.023564203509727544
avg accuracy is  0.9933333334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11904257554203462
avg test loss is  1.475975383478187
avg accuracy is  0.7886333334896594
compute_distance is  tensor(90.2637, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(90.2637, device='cuda:2')
test acc is  0.7886333334896594
test loss is 1.475975383478187
test entropy is  0.11904257554203462
________________________________
diff is  tensor(0.8032, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(12.5907, device='cuda:2')
diff is  tensor(0.0145, device='cuda:2')
diff is  tensor(76.2172, device='cuda:2')
diff is  tensor(0.0459, device='cuda:2')
diff is  tensor(0.5752, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(2.8550, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0117, device='cuda:2')
sum is tensor(0.0262, device='cuda:2')
sum is tensor(0.0721, device='cuda:2')
sum is tensor(0.6472, device='cuda:2')
sum is tensor(1.4504, device='cuda:2')
sum is tensor(14.0412, device='cuda:2')
ratio is tensor(0.8884, device='cuda:2')
threshold is tensor(12.5907, device='cuda:2')
cal diff is tensor(0.8032, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(12.5907, device='cuda:2')
clipping
cal diff is tensor(0.0145, device='cuda:2')
discard
cal diff is tensor(76.2172, device='cuda:2')
clipping
cal diff is tensor(0.0459, device='cuda:2')
discard
cal diff is tensor(0.5752, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(78.9071, device='cuda:2')
test acc is  0.8697833334896559
test loss is 0.5690676088192697
test entropy is  0.10115684378248796
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10115684378248796
avg test loss is  0.5690676088192697
avg accuracy is  0.8697833334896559
compute_distance is  tensor(78.9071, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12571025774605685
avg test loss is  1.6396819389959387
avg accuracy is  0.7736166668229935
compute_distance is  tensor(126.9563, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(126.9563, device='cuda:2')
test acc is  0.7736166668229935
test loss is 1.6396819389959387
test entropy is  0.12571025774605685
________________________________
diff is  tensor(0.6228, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(18.0372, device='cuda:2')
diff is  tensor(0.0103, device='cuda:2')
diff is  tensor(107.8777, device='cuda:2')
diff is  tensor(0.0178, device='cuda:2')
diff is  tensor(0.3658, device='cuda:2')
diff is  tensor(0.0014, device='cuda:2')
threshold is  tensor(39.5476, device='cuda:2')
sum is tensor(0.0014, device='cuda:2')
sum is tensor(0.0080, device='cuda:2')
sum is tensor(0.0183, device='cuda:2')
sum is tensor(0.0361, device='cuda:2')
sum is tensor(0.4018, device='cuda:2')
sum is tensor(1.0246, device='cuda:2')
sum is tensor(19.0618, device='cuda:2')
sum is tensor(126.9395, device='cuda:2')
ratio is tensor(0.8101, device='cuda:2')
threshold is tensor(107.8777, device='cuda:2')
cal diff is tensor(0.6228, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(18.0372, device='cuda:2')
discard
cal diff is tensor(0.0103, device='cuda:2')
discard
cal diff is tensor(107.8777, device='cuda:2')
clipping
cal diff is tensor(0.0178, device='cuda:2')
discard
cal diff is tensor(0.3658, device='cuda:2')
discard
cal diff is tensor(0.0014, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4087, device='cuda:2')
test acc is  0.9776000001563189
test loss is 0.07864501259079253
test entropy is  0.03550124279254286
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03550124279254286
avg test loss is  0.07864501259079253
avg accuracy is  0.9776000001563189
compute_distance is  tensor(87.4087, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12631044470305955
avg test loss is  1.6679942905267418
avg accuracy is  0.7710833334896603
compute_distance is  tensor(142.4903, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(142.4903, device='cuda:2')
test acc is  0.7710833334896603
test loss is 1.6679942905267418
test entropy is  0.12631044470305955
________________________________
diff is  tensor(0.7289, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(11.1486, device='cuda:2')
diff is  tensor(0.0120, device='cuda:2')
diff is  tensor(130.2158, device='cuda:2')
diff is  tensor(0.0232, device='cuda:2')
diff is  tensor(0.3313, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(55.0816, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0212, device='cuda:2')
sum is tensor(0.0444, device='cuda:2')
sum is tensor(0.3756, device='cuda:2')
sum is tensor(1.1046, device='cuda:2')
sum is tensor(12.2532, device='cuda:2')
sum is tensor(142.4690, device='cuda:2')
ratio is tensor(0.6711, device='cuda:2')
threshold is tensor(130.2158, device='cuda:2')
cal diff is tensor(0.7289, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(11.1486, device='cuda:2')
discard
cal diff is tensor(0.0120, device='cuda:2')
discard
cal diff is tensor(130.2158, device='cuda:2')
clipping
cal diff is tensor(0.0232, device='cuda:2')
discard
cal diff is tensor(0.3313, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4047, device='cuda:2')
test acc is  0.9750833334896521
test loss is 0.08589392292874815
test entropy is  0.03905116287601202
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03905116287601202
avg test loss is  0.08589392292874815
avg accuracy is  0.9750833334896521
compute_distance is  tensor(87.4047, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1264658896510662
avg test loss is  1.669363709559827
avg accuracy is  0.7709833334896603
compute_distance is  tensor(144.6294, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(144.6294, device='cuda:2')
test acc is  0.7709833334896603
test loss is 1.669363709559827
test entropy is  0.1264658896510662
________________________________
diff is  tensor(0.7398, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(11.2758, device='cuda:2')
diff is  tensor(0.0121, device='cuda:2')
diff is  tensor(132.2184, device='cuda:2')
diff is  tensor(0.0222, device='cuda:2')
diff is  tensor(0.3290, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(57.2207, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0210, device='cuda:2')
sum is tensor(0.0433, device='cuda:2')
sum is tensor(0.3723, device='cuda:2')
sum is tensor(1.1122, device='cuda:2')
sum is tensor(12.3880, device='cuda:2')
sum is tensor(144.6064, device='cuda:2')
ratio is tensor(0.6609, device='cuda:2')
threshold is tensor(132.2184, device='cuda:2')
cal diff is tensor(0.7398, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(11.2758, device='cuda:2')
discard
cal diff is tensor(0.0121, device='cuda:2')
discard
cal diff is tensor(132.2184, device='cuda:2')
clipping
cal diff is tensor(0.0222, device='cuda:2')
discard
cal diff is tensor(0.3290, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4039, device='cuda:2')
test acc is  0.9760333334896522
test loss is 0.0825055767546068
test entropy is  0.03812428592155173
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03812428592155173
avg test loss is  0.0825055767546068
avg accuracy is  0.9760333334896522
compute_distance is  tensor(87.4039, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12648333528879355
avg test loss is  1.6698284016997575
avg accuracy is  0.770900000156327
compute_distance is  tensor(145.5089, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.5089, device='cuda:2')
test acc is  0.770900000156327
test loss is 1.6698284016997575
test entropy is  0.12648333528879355
________________________________
diff is  tensor(0.7452, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(11.4133, device='cuda:2')
diff is  tensor(0.0123, device='cuda:2')
diff is  tensor(132.9542, device='cuda:2')
diff is  tensor(0.0224, device='cuda:2')
diff is  tensor(0.3287, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(58.1002, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0212, device='cuda:2')
sum is tensor(0.0436, device='cuda:2')
sum is tensor(0.3723, device='cuda:2')
sum is tensor(1.1175, device='cuda:2')
sum is tensor(12.5308, device='cuda:2')
sum is tensor(145.4850, device='cuda:2')
ratio is tensor(0.6573, device='cuda:2')
threshold is tensor(132.9542, device='cuda:2')
cal diff is tensor(0.7452, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(11.4133, device='cuda:2')
discard
cal diff is tensor(0.0123, device='cuda:2')
discard
cal diff is tensor(132.9542, device='cuda:2')
clipping
cal diff is tensor(0.0224, device='cuda:2')
discard
cal diff is tensor(0.3287, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4036, device='cuda:2')
test acc is  0.9767333334896522
test loss is 0.08021496127436269
test entropy is  0.03738714187137429
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03738714187137429
avg test loss is  0.08021496127436269
avg accuracy is  0.9767333334896522
compute_distance is  tensor(87.4036, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12651131090038875
avg test loss is  1.6706386736905905
avg accuracy is  0.770750000156327
compute_distance is  tensor(145.9714, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.9714, device='cuda:2')
test acc is  0.770750000156327
test loss is 1.6706386736905905
test entropy is  0.12651131090038875
________________________________
diff is  tensor(0.7473, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(11.5044, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(133.3226, device='cuda:2')
diff is  tensor(0.0225, device='cuda:2')
diff is  tensor(0.3288, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(58.5627, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0214, device='cuda:2')
sum is tensor(0.0439, device='cuda:2')
sum is tensor(0.3727, device='cuda:2')
sum is tensor(1.1200, device='cuda:2')
sum is tensor(12.6243, device='cuda:2')
sum is tensor(145.9469, device='cuda:2')
ratio is tensor(0.6554, device='cuda:2')
threshold is tensor(133.3226, device='cuda:2')
cal diff is tensor(0.7473, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(11.5044, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(133.3226, device='cuda:2')
clipping
cal diff is tensor(0.0225, device='cuda:2')
discard
cal diff is tensor(0.3288, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4035, device='cuda:2')
test acc is  0.9771166668229855
test loss is 0.07891212838899797
test entropy is  0.0369425294204066
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0369425294204066
avg test loss is  0.07891212838899797
avg accuracy is  0.9771166668229855
compute_distance is  tensor(87.4035, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12653394869522755
avg test loss is  1.6716722497807892
avg accuracy is  0.7706333334896603
compute_distance is  tensor(146.2326, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.2326, device='cuda:2')
test acc is  0.7706333334896603
test loss is 1.6716722497807892
test entropy is  0.12653394869522755
________________________________
diff is  tensor(0.7484, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(11.5607, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(133.5258, device='cuda:2')
diff is  tensor(0.0226, device='cuda:2')
diff is  tensor(0.3287, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(58.8239, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0215, device='cuda:2')
sum is tensor(0.0441, device='cuda:2')
sum is tensor(0.3728, device='cuda:2')
sum is tensor(1.1212, device='cuda:2')
sum is tensor(12.6819, device='cuda:2')
sum is tensor(146.2077, device='cuda:2')
ratio is tensor(0.6544, device='cuda:2')
threshold is tensor(133.5258, device='cuda:2')
cal diff is tensor(0.7484, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(11.5607, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(133.5258, device='cuda:2')
clipping
cal diff is tensor(0.0226, device='cuda:2')
discard
cal diff is tensor(0.3287, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4034, device='cuda:2')
test acc is  0.9773500001563189
test loss is 0.0781553999841058
test entropy is  0.036665881705867036
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.036665881705867036
avg test loss is  0.0781553999841058
avg accuracy is  0.9773500001563189
compute_distance is  tensor(87.4034, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1265812942803875
avg test loss is  1.6718536431728395
avg accuracy is  0.770700000156327
compute_distance is  tensor(146.3804, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.3804, device='cuda:2')
test acc is  0.770700000156327
test loss is 1.6718536431728395
test entropy is  0.1265812942803875
________________________________
diff is  tensor(0.7485, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(11.5979, device='cuda:2')
diff is  tensor(0.0125, device='cuda:2')
diff is  tensor(133.6361, device='cuda:2')
diff is  tensor(0.0227, device='cuda:2')
diff is  tensor(0.3284, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(58.9717, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0216, device='cuda:2')
sum is tensor(0.0443, device='cuda:2')
sum is tensor(0.3727, device='cuda:2')
sum is tensor(1.1211, device='cuda:2')
sum is tensor(12.7190, device='cuda:2')
sum is tensor(146.3552, device='cuda:2')
ratio is tensor(0.6539, device='cuda:2')
threshold is tensor(133.6361, device='cuda:2')
cal diff is tensor(0.7485, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(11.5979, device='cuda:2')
discard
cal diff is tensor(0.0125, device='cuda:2')
discard
cal diff is tensor(133.6361, device='cuda:2')
clipping
cal diff is tensor(0.0227, device='cuda:2')
discard
cal diff is tensor(0.3284, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4033, device='cuda:2')
test acc is  0.9774500001563189
test loss is 0.07767944304948901
test entropy is  0.03648315998378085
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03648315998378085
avg test loss is  0.07767944304948901
avg accuracy is  0.9774500001563189
compute_distance is  tensor(87.4033, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1265994377021215
avg test loss is  1.6726353150377395
avg accuracy is  0.7704666668229937
compute_distance is  tensor(146.4646, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.4646, device='cuda:2')
test acc is  0.7704666668229937
test loss is 1.6726353150377395
test entropy is  0.1265994377021215
________________________________
diff is  tensor(0.7483, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(11.6184, device='cuda:2')
diff is  tensor(0.0125, device='cuda:2')
diff is  tensor(133.7001, device='cuda:2')
diff is  tensor(0.0228, device='cuda:2')
diff is  tensor(0.3280, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(59.0558, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0216, device='cuda:2')
sum is tensor(0.0444, device='cuda:2')
sum is tensor(0.3723, device='cuda:2')
sum is tensor(1.1206, device='cuda:2')
sum is tensor(12.7390, device='cuda:2')
sum is tensor(146.4391, device='cuda:2')
ratio is tensor(0.6536, device='cuda:2')
threshold is tensor(133.7001, device='cuda:2')
cal diff is tensor(0.7483, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(11.6184, device='cuda:2')
discard
cal diff is tensor(0.0125, device='cuda:2')
discard
cal diff is tensor(133.7001, device='cuda:2')
clipping
cal diff is tensor(0.0228, device='cuda:2')
discard
cal diff is tensor(0.3280, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(87.4033, device='cuda:2')
test acc is  0.9775000001563189
test loss is 0.07739323954344471
test entropy is  0.03636574687727634
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03636574687727634
avg test loss is  0.07739323954344471
avg accuracy is  0.9775000001563189
compute_distance is  tensor(87.4033, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1266264169663588
avg test loss is  1.6734399968055265
avg accuracy is  0.7703833334896603
compute_distance is  tensor(146.5149, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.8999999999999999
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 59 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.20% 


 | Global Training Round : 60 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0033681842032819986
attack res is False
len of model dicts is  10
compute distance is  tensor(13.8500, device='cuda:2')
compute distance is  tensor(79.2998, device='cuda:2')
compute distance is  tensor(56.6298, device='cuda:2')
compute distance is  tensor(91.6061, device='cuda:2')
compute distance is  tensor(41.5627, device='cuda:2')
compute distance is  tensor(60.2695, device='cuda:2')
compute distance is  tensor(49.2139, device='cuda:2')
compute distance is  tensor(58.4329, device='cuda:2')
compute distance is  tensor(77.6621, device='cuda:2')
compute distance is  tensor(35.4753, device='cuda:2')
calculated distance threshold is  tensor(77.4686, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8481333334896568
====================
====================
iteration is  0
round is  1
accuracy is  0.8689833334896558
====================
====================
iteration is  0
round is  2
accuracy is  0.8841333334896552
====================
====================
iteration is  1
round is  0
accuracy is  0.6692833334896662
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7144000001563299
====================
====================
iteration is  1
round is  2
accuracy is  0.8030666668229921
====================
====================
iteration is  2
round is  0
accuracy is  0.733450000156329
====================
====================
iteration is  2
round is  1
accuracy is  0.6975333334896643
====================
________________________________
test distance is  tensor(4708.2842, device='cuda:2')
test acc is  0.6692833334896662
test loss is 2.8005340790062316
test entropy is  0.1693668421159294
________________________________
diff is  tensor(47.4514, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4140, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.1709, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5943, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.0267, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.1925, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2709, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1629, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4630.8154, device='cuda:2')
sum is tensor(0.1629, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5769, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1712, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3637, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6346, device='cuda:2', dtype=torch.float64)
sum is tensor(73.0859, device='cuda:2', dtype=torch.float64)
sum is tensor(703.2568, device='cuda:2', dtype=torch.float64)
sum is tensor(4708.2835, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0193, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.0267, device='cuda:2', dtype=torch.float64)
cal diff is tensor(47.4514, device='cuda:2')
discard
cal diff is tensor(0.4140, device='cuda:2')
discard
cal diff is tensor(630.1709, device='cuda:2')
discard
cal diff is tensor(0.5943, device='cuda:2')
discard
cal diff is tensor(4005.0269, device='cuda:2')
clipping
cal diff is tensor(2.1925, device='cuda:2')
discard
cal diff is tensor(22.2709, device='cuda:2')
discard
cal diff is tensor(0.1629, device='cuda:2')
discard
________________________________
test distance is  tensor(77.4783, device='cuda:2')
test acc is  0.993316666822985
test loss is 0.023736941564586896
test entropy is  0.011380655600844164
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.4680, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0097, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0569, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.4680, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(4.4202, device='cuda:2')
test acc is  0.993316666822985
test loss is 0.023693501741104645
test entropy is  0.011357790923571972
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011357790923571972
avg test loss is  0.023693501741104645
avg accuracy is  0.993316666822985
compute_distance is  tensor(4.4202, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14624676730698233
avg test loss is  1.9344749836398085
avg accuracy is  0.7431833334896617
compute_distance is  tensor(97.3587, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(97.3587, device='cuda:2')
test acc is  0.7431833334896617
test loss is 1.9344749836398085
test entropy is  0.14624676730698233
________________________________
diff is  tensor(0.8220, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(13.3644, device='cuda:2')
diff is  tensor(0.0141, device='cuda:2')
diff is  tensor(82.4943, device='cuda:2')
diff is  tensor(0.0487, device='cuda:2')
diff is  tensor(0.6158, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(19.8901, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0118, device='cuda:2')
sum is tensor(0.0258, device='cuda:2')
sum is tensor(0.0746, device='cuda:2')
sum is tensor(0.6904, device='cuda:2')
sum is tensor(1.5124, device='cuda:2')
sum is tensor(14.8768, device='cuda:2')
sum is tensor(97.3710, device='cuda:2')
ratio is tensor(0.9392, device='cuda:2')
threshold is tensor(82.4943, device='cuda:2')
cal diff is tensor(0.8220, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(13.3644, device='cuda:2')
discard
cal diff is tensor(0.0141, device='cuda:2')
discard
cal diff is tensor(82.4943, device='cuda:2')
clipping
cal diff is tensor(0.0487, device='cuda:2')
discard
cal diff is tensor(0.6158, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(77.4787, device='cuda:2')
test acc is  0.9300333334896537
test loss is 0.26025310583775796
test entropy is  0.07517122011333863
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.4813, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0101, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0122, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.4813, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.9540, device='cuda:2')
test acc is  0.993266666822985
test loss is 0.023654528740430347
test entropy is  0.011407875046807662
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011407875046807662
avg test loss is  0.023654528740430347
avg accuracy is  0.993266666822985
compute_distance is  tensor(0.9540, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14676609745364327
avg test loss is  1.937570294782297
avg accuracy is  0.7426333334896617
compute_distance is  tensor(97.7845, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(97.7845, device='cuda:2')
test acc is  0.7426333334896617
test loss is 1.937570294782297
test entropy is  0.14676609745364327
________________________________
diff is  tensor(0.8154, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(13.3903, device='cuda:2')
diff is  tensor(0.0142, device='cuda:2')
diff is  tensor(82.9049, device='cuda:2')
diff is  tensor(0.0483, device='cuda:2')
diff is  tensor(0.6118, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(20.3159, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0117, device='cuda:2')
sum is tensor(0.0259, device='cuda:2')
sum is tensor(0.0742, device='cuda:2')
sum is tensor(0.6859, device='cuda:2')
sum is tensor(1.5013, device='cuda:2')
sum is tensor(14.8916, device='cuda:2')
sum is tensor(97.7965, device='cuda:2')
ratio is tensor(0.9346, device='cuda:2')
threshold is tensor(82.9049, device='cuda:2')
cal diff is tensor(0.8154, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(13.3903, device='cuda:2')
discard
cal diff is tensor(0.0142, device='cuda:2')
discard
cal diff is tensor(82.9049, device='cuda:2')
clipping
cal diff is tensor(0.0483, device='cuda:2')
discard
cal diff is tensor(0.6118, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(77.4785, device='cuda:2')
test acc is  0.9313833334896536
test loss is 0.25156505659720535
test entropy is  0.0744521761996183
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.4810, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0099, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0308, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.4810, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(2.3899, device='cuda:2')
test acc is  0.993266666822985
test loss is 0.023613555476994667
test entropy is  0.011492461095054616
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011492461095054616
avg test loss is  0.023613555476994667
avg accuracy is  0.993266666822985
compute_distance is  tensor(2.3899, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14750440898480446
avg test loss is  1.9417621229630289
avg accuracy is  0.7417500001563283
compute_distance is  tensor(98.6220, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(98.6220, device='cuda:2')
test acc is  0.7417500001563283
test loss is 1.9417621229630289
test entropy is  0.14750440898480446
________________________________
diff is  tensor(0.8064, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(13.4300, device='cuda:2')
diff is  tensor(0.0143, device='cuda:2')
diff is  tensor(83.7175, device='cuda:2')
diff is  tensor(0.0477, device='cuda:2')
diff is  tensor(0.6059, device='cuda:2')
diff is  tensor(0.0042, device='cuda:2')
threshold is  tensor(21.1534, device='cuda:2')
sum is tensor(0.0042, device='cuda:2')
sum is tensor(0.0116, device='cuda:2')
sum is tensor(0.0259, device='cuda:2')
sum is tensor(0.0736, device='cuda:2')
sum is tensor(0.6795, device='cuda:2')
sum is tensor(1.4858, device='cuda:2')
sum is tensor(14.9159, device='cuda:2')
sum is tensor(98.6334, device='cuda:2')
ratio is tensor(0.9255, device='cuda:2')
threshold is tensor(83.7175, device='cuda:2')
cal diff is tensor(0.8064, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(13.4300, device='cuda:2')
discard
cal diff is tensor(0.0143, device='cuda:2')
discard
cal diff is tensor(83.7175, device='cuda:2')
clipping
cal diff is tensor(0.0477, device='cuda:2')
discard
cal diff is tensor(0.6059, device='cuda:2')
discard
cal diff is tensor(0.0042, device='cuda:2')
discard
________________________________
test distance is  tensor(77.4783, device='cuda:2')
test acc is  0.9343000001563202
test loss is 0.23696811705269713
test entropy is  0.07312667276660628
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.4805, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0097, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0569, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.4805, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(4.4143, device='cuda:2')
test acc is  0.9932833334896517
test loss is 0.023589958962405528
test entropy is  0.011627298487894799
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011627298487894799
avg test loss is  0.023589958962405528
avg accuracy is  0.9932833334896517
compute_distance is  tensor(4.4143, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14855186271070164
avg test loss is  1.9474190242890357
avg accuracy is  0.7403500001563285
compute_distance is  tensor(99.7743, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(99.7743, device='cuda:2')
test acc is  0.7403500001563285
test loss is 1.9474190242890357
test entropy is  0.14855186271070164
________________________________
diff is  tensor(0.7948, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(13.4908, device='cuda:2')
diff is  tensor(0.0145, device='cuda:2')
diff is  tensor(84.8292, device='cuda:2')
diff is  tensor(0.0468, device='cuda:2')
diff is  tensor(0.5974, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
threshold is  tensor(22.3057, device='cuda:2')
sum is tensor(0.0041, device='cuda:2')
sum is tensor(0.0114, device='cuda:2')
sum is tensor(0.0260, device='cuda:2')
sum is tensor(0.0728, device='cuda:2')
sum is tensor(0.6702, device='cuda:2')
sum is tensor(1.4650, device='cuda:2')
sum is tensor(14.9557, device='cuda:2')
sum is tensor(99.7849, device='cuda:2')
ratio is tensor(0.9134, device='cuda:2')
threshold is tensor(84.8292, device='cuda:2')
cal diff is tensor(0.7948, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(13.4908, device='cuda:2')
discard
cal diff is tensor(0.0145, device='cuda:2')
discard
cal diff is tensor(84.8292, device='cuda:2')
clipping
cal diff is tensor(0.0468, device='cuda:2')
discard
cal diff is tensor(0.5974, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
________________________________
test distance is  tensor(77.4780, device='cuda:2')
test acc is  0.9383500001563201
test loss is 0.21955481526984977
test entropy is  0.07142063989582013
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.4798, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0093, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0965, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.4798, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(7.4837, device='cuda:2')
test acc is  0.9932000001563184
test loss is 0.0236279379706141
test entropy is  0.011871307324160774
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011871307324160774
avg test loss is  0.0236279379706141
avg accuracy is  0.9932000001563184
compute_distance is  tensor(7.4837, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1500468610772001
avg test loss is  1.9559276980886073
avg accuracy is  0.7387333334896617
compute_distance is  tensor(101.5960, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(101.5960, device='cuda:2')
test acc is  0.7387333334896617
test loss is 1.9559276980886073
test entropy is  0.1500468610772001
________________________________
diff is  tensor(0.7804, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(13.5990, device='cuda:2')
diff is  tensor(0.0148, device='cuda:2')
diff is  tensor(86.5692, device='cuda:2')
diff is  tensor(0.0456, device='cuda:2')
diff is  tensor(0.5851, device='cuda:2')
diff is  tensor(0.0039, device='cuda:2')
threshold is  tensor(24.1273, device='cuda:2')
sum is tensor(0.0039, device='cuda:2')
sum is tensor(0.0113, device='cuda:2')
sum is tensor(0.0261, device='cuda:2')
sum is tensor(0.0717, device='cuda:2')
sum is tensor(0.6567, device='cuda:2')
sum is tensor(1.4372, device='cuda:2')
sum is tensor(15.0362, device='cuda:2')
sum is tensor(101.6054, device='cuda:2')
ratio is tensor(0.8950, device='cuda:2')
threshold is tensor(86.5692, device='cuda:2')
cal diff is tensor(0.7804, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(13.5990, device='cuda:2')
discard
cal diff is tensor(0.0148, device='cuda:2')
discard
cal diff is tensor(86.5692, device='cuda:2')
clipping
cal diff is tensor(0.0456, device='cuda:2')
discard
cal diff is tensor(0.5851, device='cuda:2')
discard
cal diff is tensor(0.0039, device='cuda:2')
discard
________________________________
test distance is  tensor(77.4774, device='cuda:2')
test acc is  0.9431500001563198
test loss is 0.19699979083802327
test entropy is  0.06898055101028963
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.4787, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0088, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1530, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.4787, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(11.8592, device='cuda:2')
test acc is  0.993116666822985
test loss is 0.02383513473555202
test entropy is  0.012306385250828958
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012306385250828958
avg test loss is  0.02383513473555202
avg accuracy is  0.993116666822985
compute_distance is  tensor(11.8592, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15202220053926332
avg test loss is  1.9658232874580537
avg accuracy is  0.7362333334896619
compute_distance is  tensor(104.1608, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(104.1608, device='cuda:2')
test acc is  0.7362333334896619
test loss is 1.9658232874580537
test entropy is  0.15202220053926332
________________________________
diff is  tensor(0.7631, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(13.7227, device='cuda:2')
diff is  tensor(0.0152, device='cuda:2')
diff is  tensor(89.0443, device='cuda:2')
diff is  tensor(0.0440, device='cuda:2')
diff is  tensor(0.5683, device='cuda:2')
diff is  tensor(0.0037, device='cuda:2')
threshold is  tensor(26.6922, device='cuda:2')
sum is tensor(0.0037, device='cuda:2')
sum is tensor(0.0111, device='cuda:2')
sum is tensor(0.0263, device='cuda:2')
sum is tensor(0.0703, device='cuda:2')
sum is tensor(0.6386, device='cuda:2')
sum is tensor(1.4017, device='cuda:2')
sum is tensor(15.1244, device='cuda:2')
sum is tensor(104.1687, device='cuda:2')
ratio is tensor(0.8701, device='cuda:2')
threshold is tensor(89.0443, device='cuda:2')
cal diff is tensor(0.7631, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(13.7227, device='cuda:2')
discard
cal diff is tensor(0.0152, device='cuda:2')
discard
cal diff is tensor(89.0443, device='cuda:2')
clipping
cal diff is tensor(0.0440, device='cuda:2')
discard
cal diff is tensor(0.5683, device='cuda:2')
discard
cal diff is tensor(0.0037, device='cuda:2')
discard
________________________________
test distance is  tensor(77.4768, device='cuda:2')
test acc is  0.9494833334896531
test loss is 0.1716940718882187
test entropy is  0.06582139065262796
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.4772, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0081, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2289, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.4772, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.8999999999999999
num2 of attacker is  0
the length of epoch_weights is  4
 
Avg Training Stats after 60 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.22% 


 | Global Training Round : 61 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.003584085963666439
attack res is False
len of model dicts is  10
compute distance is  tensor(13.2758, device='cuda:2')
compute distance is  tensor(82.5541, device='cuda:2')
compute distance is  tensor(62.1287, device='cuda:2')
compute distance is  tensor(111.0152, device='cuda:2')
compute distance is  tensor(45.4125, device='cuda:2')
compute distance is  tensor(56.5362, device='cuda:2')
compute distance is  tensor(38.0576, device='cuda:2')
compute distance is  tensor(59.0733, device='cuda:2')
compute distance is  tensor(57.9887, device='cuda:2')
compute distance is  tensor(33.2073, device='cuda:2')
calculated distance threshold is  tensor(93.2444, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8145666668229915
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.894483333489655
====================
====================
iteration is  0
round is  2
accuracy is  0.8113000001563251
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.7583500001563276
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7476500001563282
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6847000001563317
====================
succ_min + 1
________________________________
test distance is  tensor(4707.9243, device='cuda:2')
test acc is  0.6847000001563317
test loss is 2.288668932754602
test entropy is  0.18644103665214612
________________________________
diff is  tensor(49.1019, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3883, device='cuda:2', dtype=torch.float64)
diff is  tensor(628.9554, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5274, device='cuda:2', dtype=torch.float64)
diff is  tensor(4004.3786, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.1927, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.1822, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1977, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4614.6802, device='cuda:2')
sum is tensor(0.1977, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5860, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1134, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3061, device='cuda:2', dtype=torch.float64)
sum is tensor(25.4883, device='cuda:2', dtype=torch.float64)
sum is tensor(74.5902, device='cuda:2', dtype=torch.float64)
sum is tensor(703.5456, device='cuda:2', dtype=torch.float64)
sum is tensor(4707.9242, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0233, device='cuda:2', dtype=torch.float64)
threshold is tensor(4004.3786, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.1019, device='cuda:2')
discard
cal diff is tensor(0.3883, device='cuda:2')
discard
cal diff is tensor(628.9554, device='cuda:2')
discard
cal diff is tensor(0.5274, device='cuda:2')
discard
cal diff is tensor(4004.3784, device='cuda:2')
discard
cal diff is tensor(2.1927, device='cuda:2')
discard
cal diff is tensor(22.1822, device='cuda:2')
discard
cal diff is tensor(0.1977, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934000001563184
test loss is 0.023444689230266966
test entropy is  0.01140760917243547
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01140760917243547
avg test loss is  0.023444689230266966
avg accuracy is  0.9934000001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19620155738487935
avg test loss is  1.3435823583463107
avg accuracy is  0.743416666822995
compute_distance is  tensor(90.9639, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(90.9639, device='cuda:2')
test acc is  0.743416666822995
test loss is 1.3435823583463107
test entropy is  0.19620155738487935
________________________________
new distance ratio is 0.818181818181818
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 61 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.21% 


 | Global Training Round : 62 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.003671916900202632
attack res is False
len of model dicts is  10
compute distance is  tensor(13.9828, device='cuda:2')
compute distance is  tensor(54.2981, device='cuda:2')
compute distance is  tensor(64.0083, device='cuda:2')
compute distance is  tensor(83.7173, device='cuda:2')
compute distance is  tensor(40.7970, device='cuda:2')
compute distance is  tensor(51.7212, device='cuda:2')
compute distance is  tensor(62.2970, device='cuda:2')
compute distance is  tensor(57.3500, device='cuda:2')
compute distance is  tensor(97.2438, device='cuda:2')
compute distance is  tensor(60.7548, device='cuda:2')
calculated distance threshold is  tensor(75.9125, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7318500001563291
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.858500000156323
====================
====================
iteration is  0
round is  2
accuracy is  0.9178500001563207
====================
====================
iteration is  1
round is  0
accuracy is  0.7874666668229928
====================
====================
iteration is  1
round is  1
accuracy is  0.6196000001563362
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6963500001563311
====================
====================
iteration is  2
round is  0
accuracy is  0.7248833334896626
====================
________________________________
test distance is  tensor(4710.6240, device='cuda:2')
test acc is  0.6196000001563362
test loss is 2.960717033475701
test entropy is  0.19866793195226554
________________________________
diff is  tensor(48.1883, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3671, device='cuda:2', dtype=torch.float64)
diff is  tensor(631.4403, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5443, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.1436, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2193, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.4644, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2571, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4634.7114, device='cuda:2')
sum is tensor(0.2571, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6241, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1684, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3877, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8521, device='cuda:2', dtype=torch.float64)
sum is tensor(74.0403, device='cuda:2', dtype=torch.float64)
sum is tensor(705.4806, device='cuda:2', dtype=torch.float64)
sum is tensor(4710.6242, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0190, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.1436, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.1883, device='cuda:2')
discard
cal diff is tensor(0.3671, device='cuda:2')
discard
cal diff is tensor(631.4402, device='cuda:2')
discard
cal diff is tensor(0.5443, device='cuda:2')
discard
cal diff is tensor(4005.1436, device='cuda:2')
discard
cal diff is tensor(2.2193, device='cuda:2')
discard
cal diff is tensor(22.4644, device='cuda:2')
discard
cal diff is tensor(0.2571, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934000001563184
test loss is 0.02350355574584044
test entropy is  0.011352679512968498
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011352679512968498
avg test loss is  0.02350355574584044
avg accuracy is  0.9934000001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24270926121233113
avg test loss is  1.944418136244898
avg accuracy is  0.6526166668230006
compute_distance is  tensor(93.1563, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.1563, device='cuda:2')
test acc is  0.6526166668230006
test loss is 1.944418136244898
test entropy is  0.24270926121233113
________________________________
diff is  tensor(0.8294, device='cuda:2')
diff is  tensor(0.0078, device='cuda:2')
diff is  tensor(13.3739, device='cuda:2')
diff is  tensor(0.0144, device='cuda:2')
diff is  tensor(78.3298, device='cuda:2')
diff is  tensor(0.0500, device='cuda:2')
diff is  tensor(0.5553, device='cuda:2')
diff is  tensor(0.0048, device='cuda:2')
threshold is  tensor(17.2438, device='cuda:2')
sum is tensor(0.0048, device='cuda:2')
sum is tensor(0.0126, device='cuda:2')
sum is tensor(0.0270, device='cuda:2')
sum is tensor(0.0770, device='cuda:2')
sum is tensor(0.6323, device='cuda:2')
sum is tensor(1.4617, device='cuda:2')
sum is tensor(14.8356, device='cuda:2')
sum is tensor(93.1655, device='cuda:2')
ratio is tensor(0.9693, device='cuda:2')
threshold is tensor(78.3298, device='cuda:2')
cal diff is tensor(0.8294, device='cuda:2')
discard
cal diff is tensor(0.0078, device='cuda:2')
discard
cal diff is tensor(13.3739, device='cuda:2')
discard
cal diff is tensor(0.0144, device='cuda:2')
discard
cal diff is tensor(78.3298, device='cuda:2')
clipping
cal diff is tensor(0.0500, device='cuda:2')
discard
cal diff is tensor(0.5553, device='cuda:2')
discard
cal diff is tensor(0.0048, device='cuda:2')
discard
________________________________
test distance is  tensor(75.9217, device='cuda:2')
test acc is  0.9570500001563195
test loss is 0.15741795377982315
test entropy is  0.06864184620373173
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.9218, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0092, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1142, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.9218, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(8.6780, device='cuda:2')
test acc is  0.993266666822985
test loss is 0.02386982878854068
test entropy is  0.011941694641277508
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011941694641277508
avg test loss is  0.02386982878854068
avg accuracy is  0.993266666822985
compute_distance is  tensor(8.6780, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23929711227922806
avg test loss is  1.9706909610772692
avg accuracy is  0.6531166668230004
compute_distance is  tensor(97.4652, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(97.4652, device='cuda:2')
test acc is  0.6531166668230004
test loss is 1.9706909610772692
test entropy is  0.23929711227922806
________________________________
diff is  tensor(0.7944, device='cuda:2')
diff is  tensor(0.0075, device='cuda:2')
diff is  tensor(13.2088, device='cuda:2')
diff is  tensor(0.0147, device='cuda:2')
diff is  tensor(82.8802, device='cuda:2')
diff is  tensor(0.0454, device='cuda:2')
diff is  tensor(0.5165, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(21.5527, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0119, device='cuda:2')
sum is tensor(0.0266, device='cuda:2')
sum is tensor(0.0719, device='cuda:2')
sum is tensor(0.5884, device='cuda:2')
sum is tensor(1.3828, device='cuda:2')
sum is tensor(14.5916, device='cuda:2')
sum is tensor(97.4718, device='cuda:2')
ratio is tensor(0.9160, device='cuda:2')
threshold is tensor(82.8802, device='cuda:2')
cal diff is tensor(0.7944, device='cuda:2')
discard
cal diff is tensor(0.0075, device='cuda:2')
discard
cal diff is tensor(13.2088, device='cuda:2')
discard
cal diff is tensor(0.0147, device='cuda:2')
discard
cal diff is tensor(82.8802, device='cuda:2')
clipping
cal diff is tensor(0.0454, device='cuda:2')
discard
cal diff is tensor(0.5165, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(75.9204, device='cuda:2')
test acc is  0.961866666822986
test loss is 0.13781531904377903
test entropy is  0.06194926422885629
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.9194, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0079, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2575, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.9194, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(19.5568, device='cuda:2')
test acc is  0.9927000001563183
test loss is 0.025786329100682882
test entropy is  0.01333315370382708
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01333315370382708
avg test loss is  0.025786329100682882
avg accuracy is  0.9927000001563183
compute_distance is  tensor(19.5568, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23562928244693956
avg test loss is  2.0014130140799704
avg accuracy is  0.6532000001563337
compute_distance is  tensor(103.2507, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(103.2507, device='cuda:2')
test acc is  0.6532000001563337
test loss is 2.0014130140799704
test entropy is  0.23562928244693956
________________________________
diff is  tensor(0.7757, device='cuda:2')
diff is  tensor(0.0073, device='cuda:2')
diff is  tensor(12.9391, device='cuda:2')
diff is  tensor(0.0145, device='cuda:2')
diff is  tensor(88.9957, device='cuda:2')
diff is  tensor(0.0407, device='cuda:2')
diff is  tensor(0.4771, device='cuda:2')
diff is  tensor(0.0040, device='cuda:2')
threshold is  tensor(27.3383, device='cuda:2')
sum is tensor(0.0040, device='cuda:2')
sum is tensor(0.0113, device='cuda:2')
sum is tensor(0.0258, device='cuda:2')
sum is tensor(0.0665, device='cuda:2')
sum is tensor(0.5436, device='cuda:2')
sum is tensor(1.3193, device='cuda:2')
sum is tensor(14.2584, device='cuda:2')
sum is tensor(103.2541, device='cuda:2')
ratio is tensor(0.8530, device='cuda:2')
threshold is tensor(88.9957, device='cuda:2')
cal diff is tensor(0.7757, device='cuda:2')
discard
cal diff is tensor(0.0073, device='cuda:2')
discard
cal diff is tensor(12.9391, device='cuda:2')
discard
cal diff is tensor(0.0145, device='cuda:2')
discard
cal diff is tensor(88.9957, device='cuda:2')
clipping
cal diff is tensor(0.0407, device='cuda:2')
discard
cal diff is tensor(0.4771, device='cuda:2')
discard
cal diff is tensor(0.0040, device='cuda:2')
discard
________________________________
test distance is  tensor(75.9188, device='cuda:2')
test acc is  0.9663833334896526
test loss is 0.12089501014065572
test entropy is  0.05597006948155933
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.9164, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0063, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.4329, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.9164, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(32.8667, device='cuda:2')
test acc is  0.9913000001563184
test loss is 0.030715436262179485
test entropy is  0.016435488151764224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.016435488151764224
avg test loss is  0.030715436262179485
avg accuracy is  0.9913000001563184
compute_distance is  tensor(32.8667, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23202565649170864
avg test loss is  2.0351011593585837
avg accuracy is  0.6524333334896673
compute_distance is  tensor(110.6510, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(110.6510, device='cuda:2')
test acc is  0.6524333334896673
test loss is 2.0351011593585837
test entropy is  0.23202565649170864
________________________________
diff is  tensor(0.7640, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(12.4546, device='cuda:2')
diff is  tensor(0.0137, device='cuda:2')
diff is  tensor(96.9329, device='cuda:2')
diff is  tensor(0.0361, device='cuda:2')
diff is  tensor(0.4384, device='cuda:2')
diff is  tensor(0.0036, device='cuda:2')
threshold is  tensor(34.7386, device='cuda:2')
sum is tensor(0.0036, device='cuda:2')
sum is tensor(0.0110, device='cuda:2')
sum is tensor(0.0246, device='cuda:2')
sum is tensor(0.0607, device='cuda:2')
sum is tensor(0.4991, device='cuda:2')
sum is tensor(1.2631, device='cuda:2')
sum is tensor(13.7177, device='cuda:2')
sum is tensor(110.6507, device='cuda:2')
ratio is tensor(0.7831, device='cuda:2')
threshold is tensor(96.9329, device='cuda:2')
cal diff is tensor(0.7640, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(12.4546, device='cuda:2')
discard
cal diff is tensor(0.0137, device='cuda:2')
discard
cal diff is tensor(96.9329, device='cuda:2')
clipping
cal diff is tensor(0.0361, device='cuda:2')
discard
cal diff is tensor(0.4384, device='cuda:2')
discard
cal diff is tensor(0.0036, device='cuda:2')
discard
________________________________
test distance is  tensor(75.9168, device='cuda:2')
test acc is  0.9704166668229858
test loss is 0.10591711594660116
test entropy is  0.05044700110257704
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.9128, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0044, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6470, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.9128, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(49.1190, device='cuda:2')
test acc is  0.9879333334896518
test loss is 0.04254642067685663
test entropy is  0.022982862343665117
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.022982862343665117
avg test loss is  0.04254642067685663
avg accuracy is  0.9879333334896518
compute_distance is  tensor(49.1190, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22827473197823395
avg test loss is  2.0741026165770062
avg accuracy is  0.6516166668230007
compute_distance is  tensor(120.5058, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(120.5058, device='cuda:2')
test acc is  0.6516166668230007
test loss is 2.0741026165770062
test entropy is  0.22827473197823395
________________________________
diff is  tensor(0.7590, device='cuda:2')
diff is  tensor(0.0075, device='cuda:2')
diff is  tensor(11.7497, device='cuda:2')
diff is  tensor(0.0125, device='cuda:2')
diff is  tensor(107.5363, device='cuda:2')
diff is  tensor(0.0316, device='cuda:2')
diff is  tensor(0.4015, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(44.5933, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0107, device='cuda:2')
sum is tensor(0.0231, device='cuda:2')
sum is tensor(0.0547, device='cuda:2')
sum is tensor(0.4562, device='cuda:2')
sum is tensor(1.2152, device='cuda:2')
sum is tensor(12.9649, device='cuda:2')
sum is tensor(120.5012, device='cuda:2')
ratio is tensor(0.7059, device='cuda:2')
threshold is tensor(107.5363, device='cuda:2')
cal diff is tensor(0.7590, device='cuda:2')
discard
cal diff is tensor(0.0075, device='cuda:2')
discard
cal diff is tensor(11.7497, device='cuda:2')
discard
cal diff is tensor(0.0125, device='cuda:2')
discard
cal diff is tensor(107.5363, device='cuda:2')
clipping
cal diff is tensor(0.0316, device='cuda:2')
discard
cal diff is tensor(0.4015, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(75.9146, device='cuda:2')
test acc is  0.9741333334896524
test loss is 0.09179357910483914
test entropy is  0.04495316678618413
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.9084, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0021, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8965, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.9084, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(68.0573, device='cuda:2')
test acc is  0.9798500001563187
test loss is 0.06955820513517957
test entropy is  0.035496209128810685
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.035496209128810685
avg test loss is  0.06955820513517957
avg accuracy is  0.9798500001563187
compute_distance is  tensor(68.0573, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2248403918720893
avg test loss is  2.1122749637184874
avg accuracy is  0.6505833334896673
compute_distance is  tensor(132.6087, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(132.6087, device='cuda:2')
test acc is  0.6505833334896673
test loss is 2.1122749637184874
test entropy is  0.2248403918720893
________________________________
diff is  tensor(0.7477, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(10.9421, device='cuda:2')
diff is  tensor(0.0113, device='cuda:2')
diff is  tensor(120.4942, device='cuda:2')
diff is  tensor(0.0272, device='cuda:2')
diff is  tensor(0.3675, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(56.6963, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0098, device='cuda:2')
sum is tensor(0.0211, device='cuda:2')
sum is tensor(0.0483, device='cuda:2')
sum is tensor(0.4158, device='cuda:2')
sum is tensor(1.1634, device='cuda:2')
sum is tensor(12.1055, device='cuda:2')
sum is tensor(132.5997, device='cuda:2')
ratio is tensor(0.6299, device='cuda:2')
threshold is tensor(120.4942, device='cuda:2')
cal diff is tensor(0.7477, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(10.9421, device='cuda:2')
discard
cal diff is tensor(0.0113, device='cuda:2')
discard
cal diff is tensor(120.4942, device='cuda:2')
clipping
cal diff is tensor(0.0272, device='cuda:2')
discard
cal diff is tensor(0.3675, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(75.9122, device='cuda:2')
test acc is  0.9777166668229855
test loss is 0.07893942211047766
test entropy is  0.039724378239625054
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.039724378239625054
avg test loss is  0.07893942211047766
avg accuracy is  0.9777166668229855
compute_distance is  tensor(75.9122, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22344229039130434
avg test loss is  2.1311868426642184
avg accuracy is  0.649900000156334
compute_distance is  tensor(138.8826, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(138.8826, device='cuda:2')
test acc is  0.649900000156334
test loss is 2.1311868426642184
test entropy is  0.22344229039130434
________________________________
diff is  tensor(0.7459, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(10.8057, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(126.9187, device='cuda:2')
diff is  tensor(0.0260, device='cuda:2')
diff is  tensor(0.3544, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(62.9702, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0095, device='cuda:2')
sum is tensor(0.0206, device='cuda:2')
sum is tensor(0.0466, device='cuda:2')
sum is tensor(0.4010, device='cuda:2')
sum is tensor(1.1469, device='cuda:2')
sum is tensor(11.9527, device='cuda:2')
sum is tensor(138.8714, device='cuda:2')
ratio is tensor(0.5980, device='cuda:2')
threshold is tensor(126.9187, device='cuda:2')
cal diff is tensor(0.7459, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(10.8057, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(126.9187, device='cuda:2')
clipping
cal diff is tensor(0.0260, device='cuda:2')
discard
cal diff is tensor(0.3544, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
reach max round
new distance ratio is 0.818181818181818
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 62 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.20% 


 | Global Training Round : 63 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0036695324815809727
attack res is False
len of model dicts is  10
compute distance is  tensor(15.4492, device='cuda:2')
compute distance is  tensor(44.9869, device='cuda:2')
compute distance is  tensor(70.2719, device='cuda:2')
compute distance is  tensor(109.3296, device='cuda:2')
compute distance is  tensor(64.5776, device='cuda:2')
compute distance is  tensor(72.7389, device='cuda:2')
compute distance is  tensor(92.5265, device='cuda:2')
compute distance is  tensor(42.6937, device='cuda:2')
compute distance is  tensor(51.8534, device='cuda:2')
compute distance is  tensor(33.8223, device='cuda:2')
calculated distance threshold is  tensor(85.2776, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8316500001563242
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.84856666682299
====================
====================
iteration is  0
round is  2
accuracy is  0.7400000001563284
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.8221500001563246
====================
====================
iteration is  1
round is  1
accuracy is  0.7662000001563273
====================
====================
iteration is  1
round is  2
accuracy is  0.8619833334896563
====================
====================
iteration is  2
round is  0
accuracy is  0.5844500001563389
====================
succ_min + 1
________________________________
test distance is  tensor(5178.3032, device='cuda:2')
test acc is  0.5844500001563389
test loss is 4.888992527781773
test entropy is  0.16002093083155688
________________________________
diff is  tensor(52.9439, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4716, device='cuda:2', dtype=torch.float64)
diff is  tensor(692.2133, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5565, device='cuda:2', dtype=torch.float64)
diff is  tensor(4404.9209, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.4643, device='cuda:2', dtype=torch.float64)
diff is  tensor(24.4660, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2667, device='cuda:2', dtype=torch.float64)
threshold is  tensor(5093.0254, device='cuda:2')
sum is tensor(0.2667, device='cuda:2', dtype=torch.float64)
sum is tensor(0.7383, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2948, device='cuda:2', dtype=torch.float64)
sum is tensor(3.7592, device='cuda:2', dtype=torch.float64)
sum is tensor(28.2252, device='cuda:2', dtype=torch.float64)
sum is tensor(81.1691, device='cuda:2', dtype=torch.float64)
sum is tensor(773.3825, device='cuda:2', dtype=torch.float64)
sum is tensor(5178.3034, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0194, device='cuda:2', dtype=torch.float64)
threshold is tensor(4404.9209, device='cuda:2', dtype=torch.float64)
cal diff is tensor(52.9439, device='cuda:2')
discard
cal diff is tensor(0.4716, device='cuda:2')
discard
cal diff is tensor(692.2133, device='cuda:2')
discard
cal diff is tensor(0.5565, device='cuda:2')
discard
cal diff is tensor(4404.9209, device='cuda:2')
discard
cal diff is tensor(2.4643, device='cuda:2')
discard
cal diff is tensor(24.4660, device='cuda:2')
discard
cal diff is tensor(0.2667, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934000001563184
test loss is 0.023472722630560057
test entropy is  0.011379412830487426
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011379412830487426
avg test loss is  0.023472722630560057
avg accuracy is  0.9934000001563184
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17863194733413298
avg test loss is  3.0716429610750566
avg accuracy is  0.6624166668229996
compute_distance is  tensor(98.7287, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(98.7287, device='cuda:2')
test acc is  0.6624166668229996
test loss is 3.0716429610750566
test entropy is  0.17863194733413298
________________________________
diff is  tensor(0.8430, device='cuda:2')
diff is  tensor(0.0075, device='cuda:2')
diff is  tensor(14.0705, device='cuda:2')
diff is  tensor(0.0140, device='cuda:2')
diff is  tensor(83.1282, device='cuda:2')
diff is  tensor(0.0496, device='cuda:2')
diff is  tensor(0.6213, device='cuda:2')
diff is  tensor(0.0052, device='cuda:2')
threshold is  tensor(13.4511, device='cuda:2')
sum is tensor(0.0052, device='cuda:2')
sum is tensor(0.0127, device='cuda:2')
sum is tensor(0.0267, device='cuda:2')
sum is tensor(0.0763, device='cuda:2')
sum is tensor(0.6976, device='cuda:2')
sum is tensor(1.5406, device='cuda:2')
sum is tensor(15.6111, device='cuda:2')
ratio is tensor(0.1535, device='cuda:2')
threshold is tensor(14.0705, device='cuda:2')
cal diff is tensor(0.8430, device='cuda:2')
discard
cal diff is tensor(0.0075, device='cuda:2')
discard
cal diff is tensor(14.0705, device='cuda:2')
clipping
cal diff is tensor(0.0140, device='cuda:2')
discard
cal diff is tensor(83.1282, device='cuda:2')
clipping
cal diff is tensor(0.0496, device='cuda:2')
discard
cal diff is tensor(0.6213, device='cuda:2')
discard
cal diff is tensor(0.0052, device='cuda:2')
discard
________________________________
test distance is  tensor(14.9164, device='cuda:2')
test acc is  0.9930500001563184
test loss is 0.023939902283769115
test entropy is  0.012855817457653148
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012855817457653148
avg test loss is  0.023939902283769115
avg accuracy is  0.9930500001563184
compute_distance is  tensor(14.9164, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18013916445820571
avg test loss is  3.200874032242212
avg accuracy is  0.6533000001563336
compute_distance is  tensor(105.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(105.5146, device='cuda:2')
test acc is  0.6533000001563336
test loss is 3.200874032242212
test entropy is  0.18013916445820571
________________________________
diff is  tensor(0.7819, device='cuda:2')
diff is  tensor(0.0079, device='cuda:2')
diff is  tensor(15.7365, device='cuda:2')
diff is  tensor(0.0141, device='cuda:2')
diff is  tensor(88.3785, device='cuda:2')
diff is  tensor(0.0424, device='cuda:2')
diff is  tensor(0.5548, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(20.2370, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0123, device='cuda:2')
sum is tensor(0.0263, device='cuda:2')
sum is tensor(0.0687, device='cuda:2')
sum is tensor(0.6235, device='cuda:2')
sum is tensor(1.4054, device='cuda:2')
sum is tensor(17.1418, device='cuda:2')
sum is tensor(105.5203, device='cuda:2')
ratio is tensor(0.9650, device='cuda:2')
threshold is tensor(88.3785, device='cuda:2')
cal diff is tensor(0.7819, device='cuda:2')
discard
cal diff is tensor(0.0079, device='cuda:2')
discard
cal diff is tensor(15.7365, device='cuda:2')
discard
cal diff is tensor(0.0141, device='cuda:2')
discard
cal diff is tensor(88.3785, device='cuda:2')
clipping
cal diff is tensor(0.0424, device='cuda:2')
discard
cal diff is tensor(0.5548, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(85.2857, device='cuda:2')
test acc is  0.9172333334896541
test loss is 0.3641882282269717
test entropy is  0.08275436554084233
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(85.2835, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0081, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2348, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(85.2835, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(20.0283, device='cuda:2')
test acc is  0.9926833334896517
test loss is 0.024828539185594006
test entropy is  0.013489588997809424
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.013489588997809424
avg test loss is  0.024828539185594006
avg accuracy is  0.9926833334896517
compute_distance is  tensor(20.0283, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18057179814780444
avg test loss is  3.2603170570534177
avg accuracy is  0.650200000156334
compute_distance is  tensor(110.4387, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(110.4387, device='cuda:2')
test acc is  0.650200000156334
test loss is 3.2603170570534177
test entropy is  0.18057179814780444
________________________________
diff is  tensor(0.8024, device='cuda:2')
diff is  tensor(0.0080, device='cuda:2')
diff is  tensor(14.1803, device='cuda:2')
diff is  tensor(0.0151, device='cuda:2')
diff is  tensor(94.8484, device='cuda:2')
diff is  tensor(0.0422, device='cuda:2')
diff is  tensor(0.5411, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(25.1611, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0123, device='cuda:2')
sum is tensor(0.0274, device='cuda:2')
sum is tensor(0.0696, device='cuda:2')
sum is tensor(0.6106, device='cuda:2')
sum is tensor(1.4130, device='cuda:2')
sum is tensor(15.5934, device='cuda:2')
sum is tensor(110.4417, device='cuda:2')
ratio is tensor(0.8991, device='cuda:2')
threshold is tensor(94.8484, device='cuda:2')
cal diff is tensor(0.8024, device='cuda:2')
discard
cal diff is tensor(0.0080, device='cuda:2')
discard
cal diff is tensor(14.1803, device='cuda:2')
discard
cal diff is tensor(0.0151, device='cuda:2')
discard
cal diff is tensor(94.8484, device='cuda:2')
clipping
cal diff is tensor(0.0422, device='cuda:2')
discard
cal diff is tensor(0.5411, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(85.2842, device='cuda:2')
test acc is  0.9232333334896539
test loss is 0.3268042572631018
test entropy is  0.08046954718908902
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(85.2810, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0066, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.4017, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(85.2810, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(34.2612, device='cuda:2')
test acc is  0.9909666668229851
test loss is 0.029775255804253643
test entropy is  0.017376107259850594
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.017376107259850594
avg test loss is  0.029775255804253643
avg accuracy is  0.9909666668229851
compute_distance is  tensor(34.2612, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18126974123786252
avg test loss is  3.35008741886631
avg accuracy is  0.6440833334896676
compute_distance is  tensor(118.6312, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(118.6312, device='cuda:2')
test acc is  0.6440833334896676
test loss is 3.35008741886631
test entropy is  0.18126974123786252
________________________________
diff is  tensor(0.8079, device='cuda:2')
diff is  tensor(0.0087, device='cuda:2')
diff is  tensor(13.9973, device='cuda:2')
diff is  tensor(0.0152, device='cuda:2')
diff is  tensor(103.2639, device='cuda:2')
diff is  tensor(0.0377, device='cuda:2')
diff is  tensor(0.4952, device='cuda:2')
diff is  tensor(0.0039, device='cuda:2')
threshold is  tensor(33.3536, device='cuda:2')
sum is tensor(0.0039, device='cuda:2')
sum is tensor(0.0126, device='cuda:2')
sum is tensor(0.0278, device='cuda:2')
sum is tensor(0.0655, device='cuda:2')
sum is tensor(0.5607, device='cuda:2')
sum is tensor(1.3686, device='cuda:2')
sum is tensor(15.3658, device='cuda:2')
sum is tensor(118.6297, device='cuda:2')
ratio is tensor(0.8258, device='cuda:2')
threshold is tensor(103.2639, device='cuda:2')
cal diff is tensor(0.8079, device='cuda:2')
discard
cal diff is tensor(0.0087, device='cuda:2')
discard
cal diff is tensor(13.9973, device='cuda:2')
discard
cal diff is tensor(0.0152, device='cuda:2')
discard
cal diff is tensor(103.2639, device='cuda:2')
clipping
cal diff is tensor(0.0377, device='cuda:2')
discard
cal diff is tensor(0.4952, device='cuda:2')
discard
cal diff is tensor(0.0039, device='cuda:2')
discard
________________________________
test distance is  tensor(85.2816, device='cuda:2')
test acc is  0.9362666668229869
test loss is 0.2548056098341849
test entropy is  0.07285719772409607
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(85.2766, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0040, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6832, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(85.2766, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(58.2689, device='cuda:2')
test acc is  0.9817166668229854
test loss is 0.059761584453146714
test entropy is  0.03220583878270512
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03220583878270512
avg test loss is  0.059761584453146714
avg accuracy is  0.9817166668229854
compute_distance is  tensor(58.2689, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18213179751213934
avg test loss is  3.4657595036888935
avg accuracy is  0.6367666668230014
compute_distance is  tensor(132.8459, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(132.8459, device='cuda:2')
test acc is  0.6367666668230014
test loss is 3.4657595036888935
test entropy is  0.18213179751213934
________________________________
diff is  tensor(0.8309, device='cuda:2')
diff is  tensor(0.0088, device='cuda:2')
diff is  tensor(13.3456, device='cuda:2')
diff is  tensor(0.0144, device='cuda:2')
diff is  tensor(118.1741, device='cuda:2')
diff is  tensor(0.0314, device='cuda:2')
diff is  tensor(0.4297, device='cuda:2')
diff is  tensor(0.0033, device='cuda:2')
threshold is  tensor(47.5683, device='cuda:2')
sum is tensor(0.0033, device='cuda:2')
sum is tensor(0.0121, device='cuda:2')
sum is tensor(0.0265, device='cuda:2')
sum is tensor(0.0579, device='cuda:2')
sum is tensor(0.4877, device='cuda:2')
sum is tensor(1.3185, device='cuda:2')
sum is tensor(14.6642, device='cuda:2')
sum is tensor(132.8383, device='cuda:2')
ratio is tensor(0.7216, device='cuda:2')
threshold is tensor(118.1741, device='cuda:2')
cal diff is tensor(0.8309, device='cuda:2')
discard
cal diff is tensor(0.0088, device='cuda:2')
discard
cal diff is tensor(13.3456, device='cuda:2')
discard
cal diff is tensor(0.0144, device='cuda:2')
discard
cal diff is tensor(118.1741, device='cuda:2')
clipping
cal diff is tensor(0.0314, device='cuda:2')
discard
cal diff is tensor(0.4297, device='cuda:2')
discard
cal diff is tensor(0.0033, device='cuda:2')
discard
________________________________
test distance is  tensor(85.2780, device='cuda:2')
test acc is  0.9502500001563197
test loss is 0.18276407255930505
test entropy is  0.0635194174447921
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(85.2704, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0004, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.9746, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(85.2704, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(83.1164, device='cuda:2')
test acc is  0.9547166668229863
test loss is 0.16329007791480604
test entropy is  0.059903410090598214
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.059903410090598214
avg test loss is  0.16329007791480604
avg accuracy is  0.9547166668229863
compute_distance is  tensor(83.1164, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18237836590644393
avg test loss is  3.5715459483518783
avg accuracy is  0.6301833334896686
compute_distance is  tensor(148.2829, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(148.2829, device='cuda:2')
test acc is  0.6301833334896686
test loss is 3.5715459483518783
test entropy is  0.18237836590644393
________________________________
diff is  tensor(0.8625, device='cuda:2')
diff is  tensor(0.0077, device='cuda:2')
diff is  tensor(12.5366, device='cuda:2')
diff is  tensor(0.0132, device='cuda:2')
diff is  tensor(134.4489, device='cuda:2')
diff is  tensor(0.0257, device='cuda:2')
diff is  tensor(0.3728, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(63.0053, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0236, device='cuda:2')
sum is tensor(0.0493, device='cuda:2')
sum is tensor(0.4221, device='cuda:2')
sum is tensor(1.2846, device='cuda:2')
sum is tensor(13.8212, device='cuda:2')
sum is tensor(148.2701, device='cuda:2')
ratio is tensor(0.6342, device='cuda:2')
threshold is tensor(134.4489, device='cuda:2')
cal diff is tensor(0.8625, device='cuda:2')
discard
cal diff is tensor(0.0077, device='cuda:2')
discard
cal diff is tensor(12.5366, device='cuda:2')
discard
cal diff is tensor(0.0132, device='cuda:2')
discard
cal diff is tensor(134.4489, device='cuda:2')
clipping
cal diff is tensor(0.0257, device='cuda:2')
discard
cal diff is tensor(0.3728, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(85.2750, device='cuda:2')
test acc is  0.9610500001563194
test loss is 0.1347768284058339
test entropy is  0.055077459734516034
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.055077459734516034
avg test loss is  0.1347768284058339
avg accuracy is  0.9610500001563194
compute_distance is  tensor(85.2750, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18225962814015112
avg test loss is  3.5821048145863545
avg accuracy is  0.6294000001563353
compute_distance is  tensor(151.5326, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(151.5326, device='cuda:2')
test acc is  0.6294000001563353
test loss is 3.5821048145863545
test entropy is  0.18225962814015112
________________________________
diff is  tensor(0.8705, device='cuda:2')
diff is  tensor(0.0079, device='cuda:2')
diff is  tensor(12.7629, device='cuda:2')
diff is  tensor(0.0135, device='cuda:2')
diff is  tensor(137.4661, device='cuda:2')
diff is  tensor(0.0260, device='cuda:2')
diff is  tensor(0.3687, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(66.2550, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0106, device='cuda:2')
sum is tensor(0.0241, device='cuda:2')
sum is tensor(0.0501, device='cuda:2')
sum is tensor(0.4187, device='cuda:2')
sum is tensor(1.2892, device='cuda:2')
sum is tensor(14.0521, device='cuda:2')
sum is tensor(151.5182, device='cuda:2')
ratio is tensor(0.6202, device='cuda:2')
threshold is tensor(137.4661, device='cuda:2')
cal diff is tensor(0.8705, device='cuda:2')
discard
cal diff is tensor(0.0079, device='cuda:2')
discard
cal diff is tensor(12.7629, device='cuda:2')
discard
cal diff is tensor(0.0135, device='cuda:2')
discard
cal diff is tensor(137.4661, device='cuda:2')
clipping
cal diff is tensor(0.0260, device='cuda:2')
discard
cal diff is tensor(0.3687, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(85.2747, device='cuda:2')
test acc is  0.9650666668229859
test loss is 0.1191765104494732
test entropy is  0.051607044929115255
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.051607044929115255
avg test loss is  0.1191765104494732
avg accuracy is  0.9650666668229859
compute_distance is  tensor(85.2747, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18227234520097532
avg test loss is  3.581155466753791
avg accuracy is  0.6293333334896687
compute_distance is  tensor(152.3689, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.818181818181818
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 63 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.20% 


 | Global Training Round : 64 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0037836930714547634
attack res is False
len of model dicts is  10
compute distance is  tensor(14.4529, device='cuda:2')
compute distance is  tensor(50.2069, device='cuda:2')
compute distance is  tensor(77.6937, device='cuda:2')
compute distance is  tensor(129.6794, device='cuda:2')
compute distance is  tensor(33.4396, device='cuda:2')
compute distance is  tensor(57.0592, device='cuda:2')
compute distance is  tensor(47.7143, device='cuda:2')
compute distance is  tensor(33.6774, device='cuda:2')
compute distance is  tensor(71.2497, device='cuda:2')
compute distance is  tensor(31.3026, device='cuda:2')
calculated distance threshold is  tensor(100.1585, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8948166668229882
====================
====================
iteration is  0
round is  1
accuracy is  0.9148333334896542
====================
====================
iteration is  0
round is  2
accuracy is  0.8327666668229908
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.631616666823002
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8090500001563251
====================
====================
iteration is  1
round is  2
accuracy is  0.7463333334896616
====================
====================
iteration is  2
round is  0
accuracy is  0.7761000001563267
====================
________________________________
test distance is  tensor(4710.8618, device='cuda:2')
test acc is  0.631616666823002
test loss is 3.3981266782990396
test entropy is  0.15437051922734232
________________________________
diff is  tensor(49.5481, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4097, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.6236, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5248, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.9490, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2399, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3431, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2237, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4610.7031, device='cuda:2')
sum is tensor(0.2237, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6333, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1581, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3980, device='cuda:2', dtype=torch.float64)
sum is tensor(25.7411, device='cuda:2', dtype=torch.float64)
sum is tensor(75.2892, device='cuda:2', dtype=torch.float64)
sum is tensor(704.9128, device='cuda:2', dtype=torch.float64)
sum is tensor(4710.8618, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0250, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.9490, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.5481, device='cuda:2')
discard
cal diff is tensor(0.4097, device='cuda:2')
discard
cal diff is tensor(629.6237, device='cuda:2')
discard
cal diff is tensor(0.5248, device='cuda:2')
discard
cal diff is tensor(4005.9490, device='cuda:2')
discard
cal diff is tensor(2.2399, device='cuda:2')
discard
cal diff is tensor(22.3431, device='cuda:2')
discard
cal diff is tensor(0.2237, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934500001563183
test loss is 0.02346311499950465
test entropy is  0.011341144044423162
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011341144044423162
avg test loss is  0.02346311499950465
avg accuracy is  0.9934500001563183
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17910285346480068
avg test loss is  2.291526882569673
avg accuracy is  0.6586333334896668
compute_distance is  tensor(89.1622, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(89.1622, device='cuda:2')
test acc is  0.6586333334896668
test loss is 2.291526882569673
test entropy is  0.17910285346480068
________________________________
new distance ratio is 0.7438016528925617
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 64 global rounds:
Train Accuracy: 98.97% 

Test Accuracy: 99.21% 


 | Global Training Round : 65 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00393084017559886
attack res is False
len of model dicts is  10
compute distance is  tensor(15.8705, device='cuda:2')
compute distance is  tensor(56.9093, device='cuda:2')
compute distance is  tensor(74.0889, device='cuda:2')
compute distance is  tensor(76.1820, device='cuda:2')
compute distance is  tensor(40.5798, device='cuda:2')
compute distance is  tensor(63.1624, device='cuda:2')
compute distance is  tensor(66.3376, device='cuda:2')
compute distance is  tensor(50.5924, device='cuda:2')
compute distance is  tensor(67.1858, device='cuda:2')
compute distance is  tensor(76.8724, device='cuda:2')
calculated distance threshold is  tensor(57.1190, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8355833334896573
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8515833334896565
====================
====================
iteration is  0
round is  2
accuracy is  0.8087666668229918
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.7435333334896617
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7418000001563285
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7185000001563298
====================
succ_min + 1
________________________________
test distance is  tensor(4709.8848, device='cuda:2')
test acc is  0.7185000001563298
test loss is 1.8956252937949796
test entropy is  0.15665211542439994
________________________________
diff is  tensor(48.8507, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4304, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.7862, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5617, device='cuda:2', dtype=torch.float64)
diff is  tensor(4004.4011, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2559, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3213, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2774, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4652.7656, device='cuda:2')
sum is tensor(0.2774, device='cuda:2', dtype=torch.float64)
sum is tensor(0.7078, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2695, device='cuda:2', dtype=torch.float64)
sum is tensor(3.5254, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8467, device='cuda:2', dtype=torch.float64)
sum is tensor(74.6974, device='cuda:2', dtype=torch.float64)
sum is tensor(705.4836, device='cuda:2', dtype=torch.float64)
sum is tensor(4709.8847, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0143, device='cuda:2', dtype=torch.float64)
threshold is tensor(4004.4011, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.8507, device='cuda:2')
discard
cal diff is tensor(0.4304, device='cuda:2')
discard
cal diff is tensor(630.7862, device='cuda:2')
discard
cal diff is tensor(0.5617, device='cuda:2')
discard
cal diff is tensor(4004.4009, device='cuda:2')
discard
cal diff is tensor(2.2559, device='cuda:2')
discard
cal diff is tensor(22.3213, device='cuda:2')
discard
cal diff is tensor(0.2774, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.023433671798231283
test entropy is  0.01131125467503204
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01131125467503204
avg test loss is  0.023433671798231283
avg accuracy is  0.993466666822985
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17820953528509972
avg test loss is  1.0599040609560033
avg accuracy is  0.77798333348966
compute_distance is  tensor(89.3089, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(89.3089, device='cuda:2')
test acc is  0.77798333348966
test loss is 1.0599040609560033
test entropy is  0.17820953528509972
________________________________
diff is  tensor(0.7282, device='cuda:2')
diff is  tensor(0.0061, device='cuda:2')
diff is  tensor(12.2309, device='cuda:2')
diff is  tensor(0.0137, device='cuda:2')
diff is  tensor(75.7383, device='cuda:2')
diff is  tensor(0.0446, device='cuda:2')
diff is  tensor(0.5385, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(32.1899, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0105, device='cuda:2')
sum is tensor(0.0242, device='cuda:2')
sum is tensor(0.0688, device='cuda:2')
sum is tensor(0.6073, device='cuda:2')
sum is tensor(1.3355, device='cuda:2')
sum is tensor(13.5663, device='cuda:2')
sum is tensor(89.3046, device='cuda:2')
ratio is tensor(0.7541, device='cuda:2')
threshold is tensor(75.7383, device='cuda:2')
cal diff is tensor(0.7282, device='cuda:2')
discard
cal diff is tensor(0.0061, device='cuda:2')
discard
cal diff is tensor(12.2309, device='cuda:2')
discard
cal diff is tensor(0.0137, device='cuda:2')
discard
cal diff is tensor(75.7383, device='cuda:2')
clipping
cal diff is tensor(0.0446, device='cuda:2')
discard
cal diff is tensor(0.5385, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1258, device='cuda:2')
test acc is  0.9788166668229855
test loss is 0.07722943988425959
test entropy is  0.032386357398689544
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(57.1146, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0068, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3751, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(57.1146, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(21.4364, device='cuda:2')
test acc is  0.992416666822985
test loss is 0.027130391078391377
test entropy is  0.01366530950315361
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01366530950315361
avg test loss is  0.027130391078391377
avg accuracy is  0.992416666822985
compute_distance is  tensor(21.4364, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1767975821344456
avg test loss is  1.1438434552123298
avg accuracy is  0.7683166668229938
compute_distance is  tensor(100.4202, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(100.4202, device='cuda:2')
test acc is  0.7683166668229938
test loss is 1.1438434552123298
test entropy is  0.1767975821344456
________________________________
diff is  tensor(0.7098, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(12.0555, device='cuda:2')
diff is  tensor(0.0135, device='cuda:2')
diff is  tensor(87.1300, device='cuda:2')
diff is  tensor(0.0364, device='cuda:2')
diff is  tensor(0.4555, device='cuda:2')
diff is  tensor(0.0035, device='cuda:2')
threshold is  tensor(43.3012, device='cuda:2')
sum is tensor(0.0035, device='cuda:2')
sum is tensor(0.0098, device='cuda:2')
sum is tensor(0.0233, device='cuda:2')
sum is tensor(0.0596, device='cuda:2')
sum is tensor(0.5151, device='cuda:2')
sum is tensor(1.2249, device='cuda:2')
sum is tensor(13.2804, device='cuda:2')
sum is tensor(100.4104, device='cuda:2')
ratio is tensor(0.6554, device='cuda:2')
threshold is tensor(87.1300, device='cuda:2')
cal diff is tensor(0.7098, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(12.0555, device='cuda:2')
discard
cal diff is tensor(0.0135, device='cuda:2')
discard
cal diff is tensor(87.1300, device='cuda:2')
clipping
cal diff is tensor(0.0364, device='cuda:2')
discard
cal diff is tensor(0.4555, device='cuda:2')
discard
cal diff is tensor(0.0035, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1219, device='cuda:2')
test acc is  0.9826000001563187
test loss is 0.06279485635948379
test entropy is  0.028185095293817224
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(57.1086, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0029, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8067, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(57.1086, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(46.0833, device='cuda:2')
test acc is  0.9873666668229851
test loss is 0.043968693746114645
test entropy is  0.021087749450422723
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.021087749450422723
avg test loss is  0.043968693746114645
avg accuracy is  0.9873666668229851
compute_distance is  tensor(46.0833, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1752048252678629
avg test loss is  1.2225304346507802
avg accuracy is  0.7601000001563276
compute_distance is  tensor(114.4052, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(114.4052, device='cuda:2')
test acc is  0.7601000001563276
test loss is 1.2225304346507802
test entropy is  0.1752048252678629
________________________________
diff is  tensor(0.7049, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(11.4549, device='cuda:2')
diff is  tensor(0.0127, device='cuda:2')
diff is  tensor(101.7965, device='cuda:2')
diff is  tensor(0.0290, device='cuda:2')
diff is  tensor(0.3829, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(57.2863, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0220, device='cuda:2')
sum is tensor(0.0510, device='cuda:2')
sum is tensor(0.4340, device='cuda:2')
sum is tensor(1.1388, device='cuda:2')
sum is tensor(12.5937, device='cuda:2')
sum is tensor(114.3902, device='cuda:2')
ratio is tensor(0.5610, device='cuda:2')
threshold is tensor(101.7965, device='cuda:2')
cal diff is tensor(0.7049, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(11.4549, device='cuda:2')
discard
cal diff is tensor(0.0127, device='cuda:2')
discard
cal diff is tensor(101.7965, device='cuda:2')
clipping
cal diff is tensor(0.0290, device='cuda:2')
discard
cal diff is tensor(0.3829, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1182, device='cuda:2')
test acc is  0.9850333334896519
test loss is 0.05288095578903548
test entropy is  0.024986777474146474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.024986777474146474
avg test loss is  0.05288095578903548
avg accuracy is  0.9850333334896519
compute_distance is  tensor(57.1182, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1744383194330913
avg test loss is  1.256340817093595
avg accuracy is  0.7569000001563277
compute_distance is  tensor(122.1148, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(122.1148, device='cuda:2')
test acc is  0.7569000001563277
test loss is 1.256340817093595
test entropy is  0.1744383194330913
________________________________
diff is  tensor(0.7149, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.2814, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(109.6957, device='cuda:2')
diff is  tensor(0.0266, device='cuda:2')
diff is  tensor(0.3569, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(64.9959, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0214, device='cuda:2')
sum is tensor(0.0479, device='cuda:2')
sum is tensor(0.4048, device='cuda:2')
sum is tensor(1.1198, device='cuda:2')
sum is tensor(12.4012, device='cuda:2')
sum is tensor(122.0969, device='cuda:2')
ratio is tensor(0.5205, device='cuda:2')
threshold is tensor(109.6957, device='cuda:2')
cal diff is tensor(0.7149, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.2814, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(109.6957, device='cuda:2')
clipping
cal diff is tensor(0.0266, device='cuda:2')
discard
cal diff is tensor(0.3569, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1164, device='cuda:2')
test acc is  0.9863500001563185
test loss is 0.04818022257093419
test entropy is  0.023301888726696224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.023301888726696224
avg test loss is  0.04818022257093419
avg accuracy is  0.9863500001563185
compute_distance is  tensor(57.1164, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1743150801975717
avg test loss is  1.2596560691846714
avg accuracy is  0.756733333489661
compute_distance is  tensor(123.2692, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(123.2692, device='cuda:2')
test acc is  0.756733333489661
test loss is 1.2596560691846714
test entropy is  0.1743150801975717
________________________________
diff is  tensor(0.7217, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(11.4985, device='cuda:2')
diff is  tensor(0.0127, device='cuda:2')
diff is  tensor(110.6230, device='cuda:2')
diff is  tensor(0.0273, device='cuda:2')
diff is  tensor(0.3580, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(66.1503, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0219, device='cuda:2')
sum is tensor(0.0492, device='cuda:2')
sum is tensor(0.4072, device='cuda:2')
sum is tensor(1.1289, device='cuda:2')
sum is tensor(12.6274, device='cuda:2')
sum is tensor(123.2505, device='cuda:2')
ratio is tensor(0.5162, device='cuda:2')
threshold is tensor(110.6230, device='cuda:2')
cal diff is tensor(0.7217, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(11.4985, device='cuda:2')
discard
cal diff is tensor(0.0127, device='cuda:2')
discard
cal diff is tensor(110.6230, device='cuda:2')
clipping
cal diff is tensor(0.0273, device='cuda:2')
discard
cal diff is tensor(0.3580, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1162, device='cuda:2')
test acc is  0.9866666668229852
test loss is 0.046814690530228
test entropy is  0.022770826408634523
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.022770826408634523
avg test loss is  0.046814690530228
avg accuracy is  0.9866666668229852
compute_distance is  tensor(57.1162, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17426999007016103
avg test loss is  1.2614052713330366
avg accuracy is  0.7567166668229943
compute_distance is  tensor(123.6248, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(123.6248, device='cuda:2')
test acc is  0.7567166668229943
test loss is 1.2614052713330366
test entropy is  0.17426999007016103
________________________________
diff is  tensor(0.7234, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(11.5823, device='cuda:2')
diff is  tensor(0.0128, device='cuda:2')
diff is  tensor(110.8919, device='cuda:2')
diff is  tensor(0.0276, device='cuda:2')
diff is  tensor(0.3583, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(66.5059, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0221, device='cuda:2')
sum is tensor(0.0497, device='cuda:2')
sum is tensor(0.4080, device='cuda:2')
sum is tensor(1.1314, device='cuda:2')
sum is tensor(12.7137, device='cuda:2')
sum is tensor(123.6056, device='cuda:2')
ratio is tensor(0.5149, device='cuda:2')
threshold is tensor(110.8919, device='cuda:2')
cal diff is tensor(0.7234, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(11.5823, device='cuda:2')
discard
cal diff is tensor(0.0128, device='cuda:2')
discard
cal diff is tensor(110.8919, device='cuda:2')
clipping
cal diff is tensor(0.0276, device='cuda:2')
discard
cal diff is tensor(0.3583, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1161, device='cuda:2')
test acc is  0.9868500001563185
test loss is 0.04633502554833991
test entropy is  0.022574407581250736
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.022574407581250736
avg test loss is  0.04633502554833991
avg accuracy is  0.9868500001563185
compute_distance is  tensor(57.1161, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1742553511249231
avg test loss is  1.2625694129067953
avg accuracy is  0.756683333489661
compute_distance is  tensor(123.7465, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(123.7465, device='cuda:2')
test acc is  0.756683333489661
test loss is 1.2625694129067953
test entropy is  0.1742553511249231
________________________________
diff is  tensor(0.7240, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(11.6165, device='cuda:2')
diff is  tensor(0.0129, device='cuda:2')
diff is  tensor(110.9786, device='cuda:2')
diff is  tensor(0.0277, device='cuda:2')
diff is  tensor(0.3579, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(66.6275, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0222, device='cuda:2')
sum is tensor(0.0499, device='cuda:2')
sum is tensor(0.4078, device='cuda:2')
sum is tensor(1.1318, device='cuda:2')
sum is tensor(12.7483, device='cuda:2')
sum is tensor(123.7270, device='cuda:2')
ratio is tensor(0.5145, device='cuda:2')
threshold is tensor(110.9786, device='cuda:2')
cal diff is tensor(0.7240, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(11.6165, device='cuda:2')
discard
cal diff is tensor(0.0129, device='cuda:2')
discard
cal diff is tensor(110.9786, device='cuda:2')
clipping
cal diff is tensor(0.0277, device='cuda:2')
discard
cal diff is tensor(0.3579, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1161, device='cuda:2')
test acc is  0.9869500001563185
test loss is 0.04611559052675442
test entropy is  0.02248485799952402
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02248485799952402
avg test loss is  0.04611559052675442
avg accuracy is  0.9869500001563185
compute_distance is  tensor(57.1161, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1742434218398798
avg test loss is  1.2634501034961834
avg accuracy is  0.756433333489661
compute_distance is  tensor(123.7993, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(123.7993, device='cuda:2')
test acc is  0.756433333489661
test loss is 1.2634501034961834
test entropy is  0.1742434218398798
________________________________
diff is  tensor(0.7242, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(11.6288, device='cuda:2')
diff is  tensor(0.0129, device='cuda:2')
diff is  tensor(111.0190, device='cuda:2')
diff is  tensor(0.0277, device='cuda:2')
diff is  tensor(0.3576, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(66.6803, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0222, device='cuda:2')
sum is tensor(0.0500, device='cuda:2')
sum is tensor(0.4076, device='cuda:2')
sum is tensor(1.1318, device='cuda:2')
sum is tensor(12.7606, device='cuda:2')
sum is tensor(123.7796, device='cuda:2')
ratio is tensor(0.5143, device='cuda:2')
threshold is tensor(111.0190, device='cuda:2')
cal diff is tensor(0.7242, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(11.6288, device='cuda:2')
discard
cal diff is tensor(0.0129, device='cuda:2')
discard
cal diff is tensor(111.0190, device='cuda:2')
clipping
cal diff is tensor(0.0277, device='cuda:2')
discard
cal diff is tensor(0.3576, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1160, device='cuda:2')
test acc is  0.9869333334896518
test loss is 0.04599055267245508
test entropy is  0.022432640818018924
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.022432640818018924
avg test loss is  0.04599055267245508
avg accuracy is  0.9869333334896518
compute_distance is  tensor(57.1160, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17421373242000018
avg test loss is  1.2641432303418991
avg accuracy is  0.7564166668229944
compute_distance is  tensor(123.8240, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 65 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.19% 


 | Global Training Round : 66 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004025228787213564
attack res is False
len of model dicts is  10
compute distance is  tensor(16.1535, device='cuda:2')
compute distance is  tensor(53.7059, device='cuda:2')
compute distance is  tensor(101.4488, device='cuda:2')
compute distance is  tensor(112.8261, device='cuda:2')
compute distance is  tensor(49.7047, device='cuda:2')
compute distance is  tensor(48.7334, device='cuda:2')
compute distance is  tensor(53.6100, device='cuda:2')
compute distance is  tensor(35.5071, device='cuda:2')
compute distance is  tensor(113.0610, device='cuda:2')
compute distance is  tensor(41.2436, device='cuda:2')
calculated distance threshold is  tensor(81.6807, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7741000001563269
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8192500001563247
====================
====================
iteration is  0
round is  2
accuracy is  0.8583833334896563
====================
====================
iteration is  1
round is  0
accuracy is  0.7464833334896614
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6285666668230023
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7691666668229937
====================
________________________________
test distance is  tensor(4711.0225, device='cuda:2')
test acc is  0.6285666668230023
test loss is 3.4108640917582806
test entropy is  0.16228377714213024
________________________________
diff is  tensor(48.6777, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3869, device='cuda:2', dtype=torch.float64)
diff is  tensor(632.2648, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5616, device='cuda:2', dtype=torch.float64)
diff is  tensor(4004.3980, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2257, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3470, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1608, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4629.3418, device='cuda:2')
sum is tensor(0.1608, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5477, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1093, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3350, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6820, device='cuda:2', dtype=torch.float64)
sum is tensor(74.3597, device='cuda:2', dtype=torch.float64)
sum is tensor(706.6245, device='cuda:2', dtype=torch.float64)
sum is tensor(4711.0225, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0204, device='cuda:2', dtype=torch.float64)
threshold is tensor(4004.3980, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.6777, device='cuda:2')
discard
cal diff is tensor(0.3869, device='cuda:2')
discard
cal diff is tensor(632.2648, device='cuda:2')
discard
cal diff is tensor(0.5616, device='cuda:2')
discard
cal diff is tensor(4004.3979, device='cuda:2')
discard
cal diff is tensor(2.2257, device='cuda:2')
discard
cal diff is tensor(22.3470, device='cuda:2')
discard
cal diff is tensor(0.1608, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9935000001563183
test loss is 0.023429316655329963
test entropy is  0.011272395923795505
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011272395923795505
avg test loss is  0.023429316655329963
avg accuracy is  0.9935000001563183
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1496834875400196
avg test loss is  2.4217507919904264
avg accuracy is  0.6846333334896652
compute_distance is  tensor(89.6251, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(89.6251, device='cuda:2')
test acc is  0.6846333334896652
test loss is 2.4217507919904264
test entropy is  0.1496834875400196
________________________________
diff is  tensor(0.8275, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(12.2412, device='cuda:2')
diff is  tensor(0.0141, device='cuda:2')
diff is  tensor(75.9193, device='cuda:2')
diff is  tensor(0.0462, device='cuda:2')
diff is  tensor(0.5759, device='cuda:2')
diff is  tensor(0.0048, device='cuda:2')
threshold is  tensor(7.9444, device='cuda:2')
sum is tensor(0.0048, device='cuda:2')
sum is tensor(0.0124, device='cuda:2')
sum is tensor(0.0264, device='cuda:2')
sum is tensor(0.0726, device='cuda:2')
sum is tensor(0.6486, device='cuda:2')
sum is tensor(1.4761, device='cuda:2')
sum is tensor(13.7173, device='cuda:2')
ratio is tensor(0.4716, device='cuda:2')
threshold is tensor(12.2412, device='cuda:2')
cal diff is tensor(0.8275, device='cuda:2')
discard
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(12.2412, device='cuda:2')
clipping
cal diff is tensor(0.0141, device='cuda:2')
discard
cal diff is tensor(75.9193, device='cuda:2')
clipping
cal diff is tensor(0.0462, device='cuda:2')
discard
cal diff is tensor(0.5759, device='cuda:2')
discard
cal diff is tensor(0.0048, device='cuda:2')
discard
________________________________
test distance is  tensor(41.5687, device='cuda:2')
test acc is  0.9843500001563186
test loss is 0.05412532487739137
test entropy is  0.02701617459619372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02701617459619372
avg test loss is  0.05412532487739137
avg accuracy is  0.9843500001563186
compute_distance is  tensor(41.5687, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15615864208480443
avg test loss is  2.5637692357304256
avg accuracy is  0.6706000001563327
compute_distance is  tensor(109.9526, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(109.9526, device='cuda:2')
test acc is  0.6706000001563327
test loss is 2.5637692357304256
test entropy is  0.15615864208480443
________________________________
diff is  tensor(0.6563, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(15.2222, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(93.5701, device='cuda:2')
diff is  tensor(0.0292, device='cuda:2')
diff is  tensor(0.4548, device='cuda:2')
diff is  tensor(0.0029, device='cuda:2')
threshold is  tensor(28.2719, device='cuda:2')
sum is tensor(0.0029, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0204, device='cuda:2')
sum is tensor(0.0496, device='cuda:2')
sum is tensor(0.5044, device='cuda:2')
sum is tensor(1.1606, device='cuda:2')
sum is tensor(16.3828, device='cuda:2')
sum is tensor(109.9529, device='cuda:2')
ratio is tensor(0.8729, device='cuda:2')
threshold is tensor(93.5701, device='cuda:2')
cal diff is tensor(0.6563, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(15.2222, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(93.5701, device='cuda:2')
clipping
cal diff is tensor(0.0292, device='cuda:2')
discard
cal diff is tensor(0.4548, device='cuda:2')
discard
cal diff is tensor(0.0029, device='cuda:2')
discard
________________________________
test distance is  tensor(81.6860, device='cuda:2')
test acc is  0.9470833334896531
test loss is 0.19312211122663656
test entropy is  0.06651036522568646
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(81.6814, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0053, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5441, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(81.6814, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(44.4520, device='cuda:2')
test acc is  0.9884000001563185
test loss is 0.04023057116885358
test entropy is  0.021244807226793047
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.021244807226793047
avg test loss is  0.04023057116885358
avg accuracy is  0.9884000001563185
compute_distance is  tensor(44.4520, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15728760352616372
avg test loss is  2.584510804112278
avg accuracy is  0.6691666668229995
compute_distance is  tensor(117.0573, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(117.0573, device='cuda:2')
test acc is  0.6691666668229995
test loss is 2.584510804112278
test entropy is  0.15728760352616372
________________________________
diff is  tensor(0.7070, device='cuda:2')
diff is  tensor(0.0072, device='cuda:2')
diff is  tensor(11.9564, device='cuda:2')
diff is  tensor(0.0131, device='cuda:2')
diff is  tensor(103.8868, device='cuda:2')
diff is  tensor(0.0324, device='cuda:2')
diff is  tensor(0.4485, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(35.3766, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0236, device='cuda:2')
sum is tensor(0.0560, device='cuda:2')
sum is tensor(0.5045, device='cuda:2')
sum is tensor(1.2116, device='cuda:2')
sum is tensor(13.1679, device='cuda:2')
sum is tensor(117.0547, device='cuda:2')
ratio is tensor(0.7862, device='cuda:2')
threshold is tensor(103.8868, device='cuda:2')
cal diff is tensor(0.7070, device='cuda:2')
discard
cal diff is tensor(0.0072, device='cuda:2')
discard
cal diff is tensor(11.9564, device='cuda:2')
discard
cal diff is tensor(0.0131, device='cuda:2')
discard
cal diff is tensor(103.8868, device='cuda:2')
clipping
cal diff is tensor(0.0324, device='cuda:2')
discard
cal diff is tensor(0.4485, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(81.6838, device='cuda:2')
test acc is  0.9495166668229864
test loss is 0.18206072354217373
test entropy is  0.06665913310787602
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(81.6787, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0031, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7911, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(81.6787, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(64.6233, device='cuda:2')
test acc is  0.9763666668229856
test loss is 0.08067046085651877
test entropy is  0.03767810787675209
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03767810787675209
avg test loss is  0.08067046085651877
avg accuracy is  0.9763666668229856
compute_distance is  tensor(64.6233, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1590123216687108
avg test loss is  2.6563412991286848
avg accuracy is  0.6629333334896667
compute_distance is  tensor(130.0810, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(130.0810, device='cuda:2')
test acc is  0.6629333334896667
test loss is 2.6563412991286848
test entropy is  0.1590123216687108
________________________________
diff is  tensor(0.6711, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.2714, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(117.6790, device='cuda:2')
diff is  tensor(0.0273, device='cuda:2')
diff is  tensor(0.4038, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(48.4002, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0211, device='cuda:2')
sum is tensor(0.0483, device='cuda:2')
sum is tensor(0.4521, device='cuda:2')
sum is tensor(1.1232, device='cuda:2')
sum is tensor(12.3946, device='cuda:2')
sum is tensor(130.0735, device='cuda:2')
ratio is tensor(0.6940, device='cuda:2')
threshold is tensor(117.6790, device='cuda:2')
cal diff is tensor(0.6711, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.2714, device='cuda:2')
discard
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(117.6790, device='cuda:2')
clipping
cal diff is tensor(0.0273, device='cuda:2')
discard
cal diff is tensor(0.4038, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(81.6812, device='cuda:2')
test acc is  0.961266666822986
test loss is 0.13622794540852545
test entropy is  0.056486653169862296
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(81.6737, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0005, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.8984, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(81.6737, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(73.3797, device='cuda:2')
test acc is  0.972600000156319
test loss is 0.09451629146784779
test entropy is  0.043366423620414714
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.043366423620414714
avg test loss is  0.09451629146784779
avg accuracy is  0.972600000156319
compute_distance is  tensor(73.3797, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15962457798246635
avg test loss is  2.692720517802086
avg accuracy is  0.6603500001563334
compute_distance is  tensor(136.9015, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.9015, device='cuda:2')
test acc is  0.6603500001563334
test loss is 2.692720517802086
test entropy is  0.15962457798246635
________________________________
diff is  tensor(0.6769, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.1477, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(124.6364, device='cuda:2')
diff is  tensor(0.0258, device='cuda:2')
diff is  tensor(0.3843, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(55.2208, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0203, device='cuda:2')
sum is tensor(0.0461, device='cuda:2')
sum is tensor(0.4304, device='cuda:2')
sum is tensor(1.1073, device='cuda:2')
sum is tensor(12.2550, device='cuda:2')
sum is tensor(136.8914, device='cuda:2')
ratio is tensor(0.6553, device='cuda:2')
threshold is tensor(124.6364, device='cuda:2')
cal diff is tensor(0.6769, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.1477, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(124.6364, device='cuda:2')
clipping
cal diff is tensor(0.0258, device='cuda:2')
discard
cal diff is tensor(0.3843, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(81.6800, device='cuda:2')
test acc is  0.9667000001563192
test loss is 0.11550376910959799
test entropy is  0.050625796949462114
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.050625796949462114
avg test loss is  0.11550376910959799
avg accuracy is  0.9667000001563192
compute_distance is  tensor(81.6800, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1599799008178177
avg test loss is  2.7284851630867673
avg accuracy is  0.6576000001563337
compute_distance is  tensor(143.0075, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(143.0075, device='cuda:2')
test acc is  0.6576000001563337
test loss is 2.7284851630867673
test entropy is  0.1599799008178177
________________________________
diff is  tensor(0.6865, device='cuda:2')
diff is  tensor(0.0062, device='cuda:2')
diff is  tensor(10.9906, device='cuda:2')
diff is  tensor(0.0110, device='cuda:2')
diff is  tensor(130.9069, device='cuda:2')
diff is  tensor(0.0245, device='cuda:2')
diff is  tensor(0.3672, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(61.3268, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0195, device='cuda:2')
sum is tensor(0.0440, device='cuda:2')
sum is tensor(0.4112, device='cuda:2')
sum is tensor(1.0977, device='cuda:2')
sum is tensor(12.0882, device='cuda:2')
sum is tensor(142.9951, device='cuda:2')
ratio is tensor(0.6239, device='cuda:2')
threshold is tensor(130.9069, device='cuda:2')
cal diff is tensor(0.6865, device='cuda:2')
discard
cal diff is tensor(0.0062, device='cuda:2')
discard
cal diff is tensor(10.9906, device='cuda:2')
discard
cal diff is tensor(0.0110, device='cuda:2')
discard
cal diff is tensor(130.9069, device='cuda:2')
clipping
cal diff is tensor(0.0245, device='cuda:2')
discard
cal diff is tensor(0.3672, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(81.6791, device='cuda:2')
test acc is  0.9702500001563191
test loss is 0.1023349322162901
test entropy is  0.046545914013627794
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.046545914013627794
avg test loss is  0.1023349322162901
avg accuracy is  0.9702500001563191
compute_distance is  tensor(81.6791, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16003588701028432
avg test loss is  2.73185147748573
avg accuracy is  0.6574000001563336
compute_distance is  tensor(143.8011, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(143.8011, device='cuda:2')
test acc is  0.6574000001563336
test loss is 2.73185147748573
test entropy is  0.16003588701028432
________________________________
diff is  tensor(0.6866, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(11.1413, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(131.5491, device='cuda:2')
diff is  tensor(0.0250, device='cuda:2')
diff is  tensor(0.3660, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(62.1204, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0087, device='cuda:2')
sum is tensor(0.0200, device='cuda:2')
sum is tensor(0.0450, device='cuda:2')
sum is tensor(0.4109, device='cuda:2')
sum is tensor(1.0975, device='cuda:2')
sum is tensor(12.2389, device='cuda:2')
sum is tensor(143.7880, device='cuda:2')
ratio is tensor(0.6208, device='cuda:2')
threshold is tensor(131.5491, device='cuda:2')
cal diff is tensor(0.6866, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(11.1413, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(131.5491, device='cuda:2')
clipping
cal diff is tensor(0.0250, device='cuda:2')
discard
cal diff is tensor(0.3660, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(81.6790, device='cuda:2')
test acc is  0.971350000156319
test loss is 0.09849726936017508
test entropy is  0.04523815066241639
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04523815066241639
avg test loss is  0.09849726936017508
avg accuracy is  0.971350000156319
compute_distance is  tensor(81.6790, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16006080146982218
avg test loss is  2.734081930443168
avg accuracy is  0.6572833334896669
compute_distance is  tensor(144.0888, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(144.0888, device='cuda:2')
test acc is  0.6572833334896669
test loss is 2.734081930443168
test entropy is  0.16006080146982218
________________________________
diff is  tensor(0.6868, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.2098, device='cuda:2')
diff is  tensor(0.0113, device='cuda:2')
diff is  tensor(131.7676, device='cuda:2')
diff is  tensor(0.0253, device='cuda:2')
diff is  tensor(0.3655, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(62.4081, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0454, device='cuda:2')
sum is tensor(0.4109, device='cuda:2')
sum is tensor(1.0978, device='cuda:2')
sum is tensor(12.3076, device='cuda:2')
sum is tensor(144.0752, device='cuda:2')
ratio is tensor(0.6198, device='cuda:2')
threshold is tensor(131.7676, device='cuda:2')
cal diff is tensor(0.6868, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.2098, device='cuda:2')
discard
cal diff is tensor(0.0113, device='cuda:2')
discard
cal diff is tensor(131.7676, device='cuda:2')
clipping
cal diff is tensor(0.0253, device='cuda:2')
discard
cal diff is tensor(0.3655, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 66 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.19% 


 | Global Training Round : 67 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004085041116923094
attack res is False
len of model dicts is  10
compute distance is  tensor(17.2216, device='cuda:2')
compute distance is  tensor(60.3945, device='cuda:2')
compute distance is  tensor(68.8021, device='cuda:2')
compute distance is  tensor(91.6847, device='cuda:2')
compute distance is  tensor(38.1297, device='cuda:2')
compute distance is  tensor(61.5080, device='cuda:2')
compute distance is  tensor(79.4039, device='cuda:2')
compute distance is  tensor(25.6660, device='cuda:2')
compute distance is  tensor(103.9035, device='cuda:2')
compute distance is  tensor(59.0893, device='cuda:2')
calculated distance threshold is  tensor(75.8345, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8326500001563241
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8440000001563236
====================
====================
iteration is  0
round is  2
accuracy is  0.8882333334896553
====================
====================
iteration is  1
round is  0
accuracy is  0.726766666822996
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7558666668229944
====================
====================
iteration is  1
round is  2
accuracy is  0.5884500001563386
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.7804666668229931
====================
________________________________
test distance is  tensor(4708.8457, device='cuda:2')
test acc is  0.5884500001563386
test loss is 4.339448481988805
test entropy is  0.15477583671747241
________________________________
diff is  tensor(47.0849, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3699, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.3392, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.6045, device='cuda:2', dtype=torch.float64)
diff is  tensor(4006.7243, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2162, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2902, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2165, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4633.0112, device='cuda:2')
sum is tensor(0.2165, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5864, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1909, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4071, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6973, device='cuda:2', dtype=torch.float64)
sum is tensor(72.7822, device='cuda:2', dtype=torch.float64)
sum is tensor(702.1213, device='cuda:2', dtype=torch.float64)
sum is tensor(4708.8456, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0189, device='cuda:2', dtype=torch.float64)
threshold is tensor(4006.7243, device='cuda:2', dtype=torch.float64)
cal diff is tensor(47.0849, device='cuda:2')
discard
cal diff is tensor(0.3699, device='cuda:2')
discard
cal diff is tensor(629.3391, device='cuda:2')
discard
cal diff is tensor(0.6045, device='cuda:2')
discard
cal diff is tensor(4006.7244, device='cuda:2')
clipping
cal diff is tensor(2.2162, device='cuda:2')
discard
cal diff is tensor(22.2902, device='cuda:2')
discard
cal diff is tensor(0.2165, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8447, device='cuda:2')
test acc is  0.9934833334896517
test loss is 0.023375749706632715
test entropy is  0.011284758044352005
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.8344, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0030, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.8344, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.2429, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.02337538802707717
test entropy is  0.011280851001771392
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011280851001771392
avg test loss is  0.02337538802707717
avg accuracy is  0.993466666822985
compute_distance is  tensor(0.2429, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14977266235566977
avg test loss is  3.2051139860265034
avg accuracy is  0.6202333334896692
compute_distance is  tensor(93.9305, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.9305, device='cuda:2')
test acc is  0.6202333334896692
test loss is 3.2051139860265034
test entropy is  0.14977266235566977
________________________________
diff is  tensor(0.8183, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(12.4592, device='cuda:2')
diff is  tensor(0.0134, device='cuda:2')
diff is  tensor(79.9736, device='cuda:2')
diff is  tensor(0.0503, device='cuda:2')
diff is  tensor(0.6032, device='cuda:2')
diff is  tensor(0.0050, device='cuda:2')
threshold is  tensor(18.0960, device='cuda:2')
sum is tensor(0.0050, device='cuda:2')
sum is tensor(0.0119, device='cuda:2')
sum is tensor(0.0253, device='cuda:2')
sum is tensor(0.0756, device='cuda:2')
sum is tensor(0.6788, device='cuda:2')
sum is tensor(1.4971, device='cuda:2')
sum is tensor(13.9563, device='cuda:2')
sum is tensor(93.9299, device='cuda:2')
ratio is tensor(0.9482, device='cuda:2')
threshold is tensor(79.9736, device='cuda:2')
cal diff is tensor(0.8183, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(12.4592, device='cuda:2')
discard
cal diff is tensor(0.0134, device='cuda:2')
discard
cal diff is tensor(79.9736, device='cuda:2')
clipping
cal diff is tensor(0.0503, device='cuda:2')
discard
cal diff is tensor(0.6032, device='cuda:2')
discard
cal diff is tensor(0.0050, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8427, device='cuda:2')
test acc is  0.9148333334896541
test loss is 0.3336681958381285
test entropy is  0.08939474461071972
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.8339, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0082, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2230, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.8339, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(16.9189, device='cuda:2')
test acc is  0.9925000001563183
test loss is 0.026221974962737038
test entropy is  0.012895173717690441
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012895173717690441
avg test loss is  0.026221974962737038
avg accuracy is  0.9925000001563183
compute_distance is  tensor(16.9189, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15174329850369933
avg test loss is  3.236922707766104
avg accuracy is  0.6183500001563362
compute_distance is  tensor(102.5583, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(102.5583, device='cuda:2')
test acc is  0.6183500001563362
test loss is 3.236922707766104
test entropy is  0.15174329850369933
________________________________
diff is  tensor(0.7891, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(12.5458, device='cuda:2')
diff is  tensor(0.0141, device='cuda:2')
diff is  tensor(88.6275, device='cuda:2')
diff is  tensor(0.0421, device='cuda:2')
diff is  tensor(0.5233, device='cuda:2')
diff is  tensor(0.0042, device='cuda:2')
threshold is  tensor(26.7238, device='cuda:2')
sum is tensor(0.0042, device='cuda:2')
sum is tensor(0.0112, device='cuda:2')
sum is tensor(0.0253, device='cuda:2')
sum is tensor(0.0675, device='cuda:2')
sum is tensor(0.5907, device='cuda:2')
sum is tensor(1.3799, device='cuda:2')
sum is tensor(13.9257, device='cuda:2')
sum is tensor(102.5532, device='cuda:2')
ratio is tensor(0.8556, device='cuda:2')
threshold is tensor(88.6275, device='cuda:2')
cal diff is tensor(0.7891, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(12.5458, device='cuda:2')
discard
cal diff is tensor(0.0141, device='cuda:2')
discard
cal diff is tensor(88.6275, device='cuda:2')
clipping
cal diff is tensor(0.0421, device='cuda:2')
discard
cal diff is tensor(0.5233, device='cuda:2')
discard
cal diff is tensor(0.0042, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8392, device='cuda:2')
test acc is  0.93690000015632
test loss is 0.23599972618658885
test entropy is  0.07434660199233321
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(75.8294, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0048, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6040, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(75.8294, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(45.8099, device='cuda:2')
test acc is  0.9841000001563186
test loss is 0.05444746042702251
test entropy is  0.02492344889181897
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02492344889181897
avg test loss is  0.05444746042702251
avg accuracy is  0.9841000001563186
compute_distance is  tensor(45.8099, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15462027696658298
avg test loss is  3.279914941360701
avg accuracy is  0.6169333334896696
compute_distance is  tensor(118.2003, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(118.2003, device='cuda:2')
test acc is  0.6169333334896696
test loss is 3.279914941360701
test entropy is  0.15462027696658298
________________________________
diff is  tensor(0.7494, device='cuda:2')
diff is  tensor(0.0077, device='cuda:2')
diff is  tensor(11.8438, device='cuda:2')
diff is  tensor(0.0131, device='cuda:2')
diff is  tensor(105.1075, device='cuda:2')
diff is  tensor(0.0323, device='cuda:2')
diff is  tensor(0.4317, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(42.3658, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0109, device='cuda:2')
sum is tensor(0.0240, device='cuda:2')
sum is tensor(0.0563, device='cuda:2')
sum is tensor(0.4880, device='cuda:2')
sum is tensor(1.2375, device='cuda:2')
sum is tensor(13.0813, device='cuda:2')
sum is tensor(118.1888, device='cuda:2')
ratio is tensor(0.7214, device='cuda:2')
threshold is tensor(105.1075, device='cuda:2')
cal diff is tensor(0.7494, device='cuda:2')
discard
cal diff is tensor(0.0077, device='cuda:2')
discard
cal diff is tensor(11.8438, device='cuda:2')
discard
cal diff is tensor(0.0131, device='cuda:2')
discard
cal diff is tensor(105.1075, device='cuda:2')
clipping
cal diff is tensor(0.0323, device='cuda:2')
discard
cal diff is tensor(0.4317, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8344, device='cuda:2')
test acc is  0.9552333334896529
test loss is 0.1629666341888184
test entropy is  0.058650327727758585
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.058650327727758585
avg test loss is  0.1629666341888184
avg accuracy is  0.9552333334896529
compute_distance is  tensor(75.8344, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15669871239996414
avg test loss is  3.326500257195186
avg accuracy is  0.6151166668230031
compute_distance is  tensor(136.7921, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.7921, device='cuda:2')
test acc is  0.6151166668230031
test loss is 3.326500257195186
test entropy is  0.15669871239996414
________________________________
diff is  tensor(0.7447, device='cuda:2')
diff is  tensor(0.0062, device='cuda:2')
diff is  tensor(10.6082, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(125.0054, device='cuda:2')
diff is  tensor(0.0250, device='cuda:2')
diff is  tensor(0.3717, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(60.9576, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0087, device='cuda:2')
sum is tensor(0.0195, device='cuda:2')
sum is tensor(0.0445, device='cuda:2')
sum is tensor(0.4162, device='cuda:2')
sum is tensor(1.1608, device='cuda:2')
sum is tensor(11.7690, device='cuda:2')
sum is tensor(136.7744, device='cuda:2')
ratio is tensor(0.6065, device='cuda:2')
threshold is tensor(125.0054, device='cuda:2')
cal diff is tensor(0.7447, device='cuda:2')
discard
cal diff is tensor(0.0062, device='cuda:2')
discard
cal diff is tensor(10.6082, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(125.0054, device='cuda:2')
clipping
cal diff is tensor(0.0250, device='cuda:2')
discard
cal diff is tensor(0.3717, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8304, device='cuda:2')
test acc is  0.9668500001563191
test loss is 0.11961571713983042
test entropy is  0.046329675001034666
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.046329675001034666
avg test loss is  0.11961571713983042
avg accuracy is  0.9668500001563191
compute_distance is  tensor(75.8304, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1569320281256618
avg test loss is  3.344572113139797
avg accuracy is  0.6146166668230031
compute_distance is  tensor(139.2638, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(139.2638, device='cuda:2')
test acc is  0.6146166668230031
test loss is 3.344572113139797
test entropy is  0.1569320281256618
________________________________
diff is  tensor(0.7518, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.0380, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(127.0384, device='cuda:2')
diff is  tensor(0.0261, device='cuda:2')
diff is  tensor(0.3702, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(63.4294, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0205, device='cuda:2')
sum is tensor(0.0466, device='cuda:2')
sum is tensor(0.4168, device='cuda:2')
sum is tensor(1.1686, device='cuda:2')
sum is tensor(12.2066, device='cuda:2')
sum is tensor(139.2450, device='cuda:2')
ratio is tensor(0.5968, device='cuda:2')
threshold is tensor(127.0384, device='cuda:2')
cal diff is tensor(0.7518, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.0380, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(127.0384, device='cuda:2')
clipping
cal diff is tensor(0.0261, device='cuda:2')
discard
cal diff is tensor(0.3702, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8304, device='cuda:2')
test acc is  0.9697500001563191
test loss is 0.10819032415167427
test entropy is  0.04291530036416375
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04291530036416375
avg test loss is  0.10819032415167427
avg accuracy is  0.9697500001563191
compute_distance is  tensor(75.8304, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15696272926369328
avg test loss is  3.3504297475316633
avg accuracy is  0.6143000001563366
compute_distance is  tensor(140.0956, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(140.0956, device='cuda:2')
test acc is  0.6143000001563366
test loss is 3.3504297475316633
test entropy is  0.15696272926369328
________________________________
diff is  tensor(0.7516, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.2252, device='cuda:2')
diff is  tensor(0.0117, device='cuda:2')
diff is  tensor(127.6798, device='cuda:2')
diff is  tensor(0.0267, device='cuda:2')
diff is  tensor(0.3719, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(64.2611, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0210, device='cuda:2')
sum is tensor(0.0477, device='cuda:2')
sum is tensor(0.4196, device='cuda:2')
sum is tensor(1.1711, device='cuda:2')
sum is tensor(12.3964, device='cuda:2')
sum is tensor(140.0762, device='cuda:2')
ratio is tensor(0.5938, device='cuda:2')
threshold is tensor(127.6798, device='cuda:2')
cal diff is tensor(0.7516, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.2252, device='cuda:2')
discard
cal diff is tensor(0.0117, device='cuda:2')
discard
cal diff is tensor(127.6798, device='cuda:2')
clipping
cal diff is tensor(0.0267, device='cuda:2')
discard
cal diff is tensor(0.3719, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8303, device='cuda:2')
test acc is  0.9706166668229856
test loss is 0.10418687661193521
test entropy is  0.04170125206307655
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04170125206307655
avg test loss is  0.10418687661193521
avg accuracy is  0.9706166668229856
compute_distance is  tensor(75.8303, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15700762245510178
avg test loss is  3.3519694862335223
avg accuracy is  0.6141833334896699
compute_distance is  tensor(140.4267, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(140.4267, device='cuda:2')
test acc is  0.6141833334896699
test loss is 3.3519694862335223
test entropy is  0.15700762245510178
________________________________
diff is  tensor(0.7515, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(11.3005, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(127.9340, device='cuda:2')
diff is  tensor(0.0270, device='cuda:2')
diff is  tensor(0.3727, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(64.5922, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0094, device='cuda:2')
sum is tensor(0.0211, device='cuda:2')
sum is tensor(0.0481, device='cuda:2')
sum is tensor(0.4208, device='cuda:2')
sum is tensor(1.1724, device='cuda:2')
sum is tensor(12.4729, device='cuda:2')
sum is tensor(140.4069, device='cuda:2')
ratio is tensor(0.5926, device='cuda:2')
threshold is tensor(127.9340, device='cuda:2')
cal diff is tensor(0.7515, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(11.3005, device='cuda:2')
discard
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(127.9340, device='cuda:2')
clipping
cal diff is tensor(0.0270, device='cuda:2')
discard
cal diff is tensor(0.3727, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
________________________________
test distance is  tensor(75.8303, device='cuda:2')
test acc is  0.9708666668229856
test loss is 0.1024968291994364
test entropy is  0.04117879943681636
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04117879943681636
avg test loss is  0.1024968291994364
avg accuracy is  0.9708666668229856
compute_distance is  tensor(75.8303, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15701788500634464
avg test loss is  3.3537332432102294
avg accuracy is  0.6139500001563366
compute_distance is  tensor(140.5912, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(140.5912, device='cuda:2')
test acc is  0.6139500001563366
test loss is 3.3537332432102294
test entropy is  0.15701788500634464
________________________________
diff is  tensor(0.7509, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(11.3390, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(128.0601, device='cuda:2')
diff is  tensor(0.0271, device='cuda:2')
diff is  tensor(0.3728, device='cuda:2')
diff is  tensor(0.0027, device='cuda:2')
threshold is  tensor(64.7567, device='cuda:2')
sum is tensor(0.0027, device='cuda:2')
sum is tensor(0.0094, device='cuda:2')
sum is tensor(0.0212, device='cuda:2')
sum is tensor(0.0483, device='cuda:2')
sum is tensor(0.4211, device='cuda:2')
sum is tensor(1.1720, device='cuda:2')
sum is tensor(12.5110, device='cuda:2')
sum is tensor(140.5711, device='cuda:2')
ratio is tensor(0.5920, device='cuda:2')
threshold is tensor(128.0601, device='cuda:2')
cal diff is tensor(0.7509, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(11.3390, device='cuda:2')
discard
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(128.0601, device='cuda:2')
clipping
cal diff is tensor(0.0271, device='cuda:2')
discard
cal diff is tensor(0.3728, device='cuda:2')
discard
cal diff is tensor(0.0027, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 67 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.18% 


 | Global Training Round : 68 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004034568089991808
attack res is False
len of model dicts is  10
compute distance is  tensor(17.0075, device='cuda:2')
compute distance is  tensor(54.9023, device='cuda:2')
compute distance is  tensor(98.6657, device='cuda:2')
compute distance is  tensor(119.5120, device='cuda:2')
compute distance is  tensor(37.7216, device='cuda:2')
compute distance is  tensor(61.7335, device='cuda:2')
compute distance is  tensor(58.1922, device='cuda:2')
compute distance is  tensor(37.7169, device='cuda:2')
compute distance is  tensor(57.9087, device='cuda:2')
compute distance is  tensor(58.6136, device='cuda:2')
calculated distance threshold is  tensor(86.3194, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7555333334896612
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.892933333489655
====================
====================
iteration is  0
round is  2
accuracy is  0.8477833334896566
====================
====================
iteration is  1
round is  0
accuracy is  0.7871833334896595
====================
====================
iteration is  1
round is  1
accuracy is  0.7298500001563291
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6973166668229976
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.7319333334896623
====================
________________________________
test distance is  tensor(4712.9736, device='cuda:2')
test acc is  0.6973166668229976
test loss is 3.418708915522358
test entropy is  0.1393561440506088
________________________________
diff is  tensor(50.3641, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3934, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.1406, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5413, device='cuda:2', dtype=torch.float64)
diff is  tensor(4006.7809, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2854, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2659, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2020, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4626.6543, device='cuda:2')
sum is tensor(0.2020, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5955, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1368, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4222, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6881, device='cuda:2', dtype=torch.float64)
sum is tensor(76.0522, device='cuda:2', dtype=torch.float64)
sum is tensor(706.1928, device='cuda:2', dtype=torch.float64)
sum is tensor(4712.9737, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0215, device='cuda:2', dtype=torch.float64)
threshold is tensor(4006.7809, device='cuda:2', dtype=torch.float64)
cal diff is tensor(50.3641, device='cuda:2')
discard
cal diff is tensor(0.3934, device='cuda:2')
discard
cal diff is tensor(630.1406, device='cuda:2')
discard
cal diff is tensor(0.5413, device='cuda:2')
discard
cal diff is tensor(4006.7808, device='cuda:2')
discard
cal diff is tensor(2.2854, device='cuda:2')
discard
cal diff is tensor(22.2659, device='cuda:2')
discard
cal diff is tensor(0.2020, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9933833334896517
test loss is 0.02341289080272416
test entropy is  0.011269037212226402
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011269037212226402
avg test loss is  0.02341289080272416
avg accuracy is  0.9933833334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14937392035241065
avg test loss is  2.321464884319285
avg accuracy is  0.7599666668229942
compute_distance is  tensor(92.7488, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.7488, device='cuda:2')
test acc is  0.7599666668229942
test loss is 2.321464884319285
test entropy is  0.14937392035241065
________________________________
diff is  tensor(0.8554, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(12.9311, device='cuda:2')
diff is  tensor(0.0146, device='cuda:2')
diff is  tensor(78.2971, device='cuda:2')
diff is  tensor(0.0467, device='cuda:2')
diff is  tensor(0.5918, device='cuda:2')
diff is  tensor(0.0050, device='cuda:2')
threshold is  tensor(6.4294, device='cuda:2')
sum is tensor(0.0050, device='cuda:2')
sum is tensor(0.0126, device='cuda:2')
sum is tensor(0.0272, device='cuda:2')
sum is tensor(0.0739, device='cuda:2')
sum is tensor(0.6657, device='cuda:2')
sum is tensor(1.5211, device='cuda:2')
sum is tensor(14.4522, device='cuda:2')
ratio is tensor(0.6204, device='cuda:2')
threshold is tensor(12.9311, device='cuda:2')
cal diff is tensor(0.8554, device='cuda:2')
discard
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(12.9311, device='cuda:2')
clipping
cal diff is tensor(0.0146, device='cuda:2')
discard
cal diff is tensor(78.2971, device='cuda:2')
clipping
cal diff is tensor(0.0467, device='cuda:2')
discard
cal diff is tensor(0.5918, device='cuda:2')
discard
cal diff is tensor(0.0050, device='cuda:2')
discard
________________________________
test distance is  tensor(56.6009, device='cuda:2')
test acc is  0.9613000001563193
test loss is 0.13503792678220208
test entropy is  0.05585104416607063
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05585104416607063
avg test loss is  0.13503792678220208
avg accuracy is  0.9613000001563193
compute_distance is  tensor(56.6009, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14841400240180588
avg test loss is  2.643109514578573
avg accuracy is  0.7459833334896615
compute_distance is  tensor(117.9414, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(117.9414, device='cuda:2')
test acc is  0.7459833334896615
test loss is 2.643109514578573
test entropy is  0.14841400240180588
________________________________
diff is  tensor(0.7134, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(17.0779, device='cuda:2')
diff is  tensor(0.0113, device='cuda:2')
diff is  tensor(99.6957, device='cuda:2')
diff is  tensor(0.0238, device='cuda:2')
diff is  tensor(0.3994, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(31.6220, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0090, device='cuda:2')
sum is tensor(0.0203, device='cuda:2')
sum is tensor(0.0441, device='cuda:2')
sum is tensor(0.4435, device='cuda:2')
sum is tensor(1.1569, device='cuda:2')
sum is tensor(18.2348, device='cuda:2')
sum is tensor(117.9306, device='cuda:2')
ratio is tensor(0.8657, device='cuda:2')
threshold is tensor(99.6957, device='cuda:2')
cal diff is tensor(0.7134, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(17.0779, device='cuda:2')
discard
cal diff is tensor(0.0113, device='cuda:2')
discard
cal diff is tensor(99.6957, device='cuda:2')
clipping
cal diff is tensor(0.0238, device='cuda:2')
discard
cal diff is tensor(0.3994, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(86.3216, device='cuda:2')
test acc is  0.9479166668229864
test loss is 0.18387923988926688
test entropy is  0.06706089502387146
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(86.3083, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0022, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8855, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(86.3083, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(76.4416, device='cuda:2')
test acc is  0.9678333334896524
test loss is 0.1107162157631368
test entropy is  0.048604559999004975
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.048604559999004975
avg test loss is  0.1107162157631368
avg accuracy is  0.9678333334896524
compute_distance is  tensor(76.4416, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14790600011232438
avg test loss is  2.721866551746946
avg accuracy is  0.7412500001563286
compute_distance is  tensor(137.6992, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(137.6992, device='cuda:2')
test acc is  0.7412500001563286
test loss is 2.721866551746946
test entropy is  0.14790600011232438
________________________________
diff is  tensor(0.7827, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(11.9585, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(124.5255, device='cuda:2')
diff is  tensor(0.0253, device='cuda:2')
diff is  tensor(0.3682, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(51.3799, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0094, device='cuda:2')
sum is tensor(0.0220, device='cuda:2')
sum is tensor(0.0473, device='cuda:2')
sum is tensor(0.4155, device='cuda:2')
sum is tensor(1.1982, device='cuda:2')
sum is tensor(13.1567, device='cuda:2')
sum is tensor(137.6822, device='cuda:2')
ratio is tensor(0.6930, device='cuda:2')
threshold is tensor(124.5255, device='cuda:2')
cal diff is tensor(0.7827, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(11.9585, device='cuda:2')
discard
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(124.5255, device='cuda:2')
clipping
cal diff is tensor(0.0253, device='cuda:2')
discard
cal diff is tensor(0.3682, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(86.3166, device='cuda:2')
test acc is  0.9551333334896529
test loss is 0.15732986805613028
test entropy is  0.0631966555564563
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0631966555564563
avg test loss is  0.15732986805613028
avg accuracy is  0.9551333334896529
compute_distance is  tensor(86.3166, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14753737100866685
avg test loss is  2.7602744903137433
avg accuracy is  0.7389500001563287
compute_distance is  tensor(145.6181, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(145.6181, device='cuda:2')
test acc is  0.7389500001563287
test loss is 2.7602744903137433
test entropy is  0.14753737100866685
________________________________
diff is  tensor(0.8267, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.7864, device='cuda:2')
diff is  tensor(0.0123, device='cuda:2')
diff is  tensor(132.5953, device='cuda:2')
diff is  tensor(0.0228, device='cuda:2')
diff is  tensor(0.3458, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(59.2987, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0211, device='cuda:2')
sum is tensor(0.0438, device='cuda:2')
sum is tensor(0.3896, device='cuda:2')
sum is tensor(1.2163, device='cuda:2')
sum is tensor(13.0027, device='cuda:2')
sum is tensor(145.5980, device='cuda:2')
ratio is tensor(0.6508, device='cuda:2')
threshold is tensor(132.5953, device='cuda:2')
cal diff is tensor(0.8267, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.7864, device='cuda:2')
discard
cal diff is tensor(0.0123, device='cuda:2')
discard
cal diff is tensor(132.5953, device='cuda:2')
clipping
cal diff is tensor(0.0228, device='cuda:2')
discard
cal diff is tensor(0.3458, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(86.3150, device='cuda:2')
test acc is  0.9627000001563192
test loss is 0.1296271978106016
test entropy is  0.05600338210331907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05600338210331907
avg test loss is  0.1296271978106016
avg accuracy is  0.9627000001563192
compute_distance is  tensor(86.3150, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1475731832529309
avg test loss is  2.762146604658444
avg accuracy is  0.7384166668229953
compute_distance is  tensor(146.9947, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(146.9947, device='cuda:2')
test acc is  0.7384166668229953
test loss is 2.762146604658444
test entropy is  0.1475731832529309
________________________________
diff is  tensor(0.8350, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(12.0114, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(133.7359, device='cuda:2')
diff is  tensor(0.0233, device='cuda:2')
diff is  tensor(0.3462, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(60.6753, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0217, device='cuda:2')
sum is tensor(0.0450, device='cuda:2')
sum is tensor(0.3912, device='cuda:2')
sum is tensor(1.2262, device='cuda:2')
sum is tensor(13.2377, device='cuda:2')
sum is tensor(146.9736, device='cuda:2')
ratio is tensor(0.6453, device='cuda:2')
threshold is tensor(133.7359, device='cuda:2')
cal diff is tensor(0.8350, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(12.0114, device='cuda:2')
discard
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(133.7359, device='cuda:2')
clipping
cal diff is tensor(0.0233, device='cuda:2')
discard
cal diff is tensor(0.3462, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(86.3148, device='cuda:2')
test acc is  0.9654333334896525
test loss is 0.12035551790200394
test entropy is  0.05311185982786238
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05311185982786238
avg test loss is  0.12035551790200394
avg accuracy is  0.9654333334896525
compute_distance is  tensor(86.3148, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14756659577999795
avg test loss is  2.7634459919512655
avg accuracy is  0.7384166668229953
compute_distance is  tensor(147.5824, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.5824, device='cuda:2')
test acc is  0.7384166668229953
test loss is 2.7634459919512655
test entropy is  0.14756659577999795
________________________________
diff is  tensor(0.8374, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(12.1245, device='cuda:2')
diff is  tensor(0.0127, device='cuda:2')
diff is  tensor(134.2060, device='cuda:2')
diff is  tensor(0.0236, device='cuda:2')
diff is  tensor(0.3471, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.2630, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0219, device='cuda:2')
sum is tensor(0.0455, device='cuda:2')
sum is tensor(0.3927, device='cuda:2')
sum is tensor(1.2301, device='cuda:2')
sum is tensor(13.3546, device='cuda:2')
sum is tensor(147.5606, device='cuda:2')
ratio is tensor(0.6430, device='cuda:2')
threshold is tensor(134.2060, device='cuda:2')
cal diff is tensor(0.8374, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(12.1245, device='cuda:2')
discard
cal diff is tensor(0.0127, device='cuda:2')
discard
cal diff is tensor(134.2060, device='cuda:2')
clipping
cal diff is tensor(0.0236, device='cuda:2')
discard
cal diff is tensor(0.3471, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(86.3147, device='cuda:2')
test acc is  0.9665666668229858
test loss is 0.11645918695708744
test entropy is  0.05180357632610494
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05180357632610494
avg test loss is  0.11645918695708744
avg accuracy is  0.9665666668229858
compute_distance is  tensor(86.3147, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14761684133188685
avg test loss is  2.766107486191589
avg accuracy is  0.7382500001563287
compute_distance is  tensor(147.8550, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.8550, device='cuda:2')
test acc is  0.7382500001563287
test loss is 2.766107486191589
test entropy is  0.14761684133188685
________________________________
diff is  tensor(0.8383, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(12.1836, device='cuda:2')
diff is  tensor(0.0128, device='cuda:2')
diff is  tensor(134.4175, device='cuda:2')
diff is  tensor(0.0238, device='cuda:2')
diff is  tensor(0.3475, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.5356, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0221, device='cuda:2')
sum is tensor(0.0458, device='cuda:2')
sum is tensor(0.3933, device='cuda:2')
sum is tensor(1.2316, device='cuda:2')
sum is tensor(13.4152, device='cuda:2')
sum is tensor(147.8327, device='cuda:2')
ratio is tensor(0.6420, device='cuda:2')
threshold is tensor(134.4175, device='cuda:2')
cal diff is tensor(0.8383, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(12.1836, device='cuda:2')
discard
cal diff is tensor(0.0128, device='cuda:2')
discard
cal diff is tensor(134.4175, device='cuda:2')
clipping
cal diff is tensor(0.0238, device='cuda:2')
discard
cal diff is tensor(0.3475, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(86.3146, device='cuda:2')
test acc is  0.9670666668229858
test loss is 0.11451200130040637
test entropy is  0.05111803742014428
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05111803742014428
avg test loss is  0.11451200130040637
avg accuracy is  0.9670666668229858
compute_distance is  tensor(86.3146, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14763664572573165
avg test loss is  2.7683454063147117
avg accuracy is  0.7381500001563287
compute_distance is  tensor(147.9988, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(147.9988, device='cuda:2')
test acc is  0.7381500001563287
test loss is 2.7683454063147117
test entropy is  0.14763664572573165
________________________________
diff is  tensor(0.8385, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(12.2149, device='cuda:2')
diff is  tensor(0.0128, device='cuda:2')
diff is  tensor(134.5293, device='cuda:2')
diff is  tensor(0.0238, device='cuda:2')
diff is  tensor(0.3476, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.6795, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0221, device='cuda:2')
sum is tensor(0.0460, device='cuda:2')
sum is tensor(0.3936, device='cuda:2')
sum is tensor(1.2320, device='cuda:2')
sum is tensor(13.4469, device='cuda:2')
sum is tensor(147.9763, device='cuda:2')
ratio is tensor(0.6415, device='cuda:2')
threshold is tensor(134.5293, device='cuda:2')
cal diff is tensor(0.8385, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(12.2149, device='cuda:2')
discard
cal diff is tensor(0.0128, device='cuda:2')
discard
cal diff is tensor(134.5293, device='cuda:2')
clipping
cal diff is tensor(0.0238, device='cuda:2')
discard
cal diff is tensor(0.3476, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(86.3146, device='cuda:2')
test acc is  0.9672333334896525
test loss is 0.11341367638834354
test entropy is  0.05071055068463675
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05071055068463675
avg test loss is  0.11341367638834354
avg accuracy is  0.9672333334896525
compute_distance is  tensor(86.3146, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14765033873318356
avg test loss is  2.7708010281454016
avg accuracy is  0.7381666668229954
compute_distance is  tensor(148.0846, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(148.0846, device='cuda:2')
test acc is  0.7381666668229954
test loss is 2.7708010281454016
test entropy is  0.14765033873318356
________________________________
diff is  tensor(0.8383, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(12.2329, device='cuda:2')
diff is  tensor(0.0128, device='cuda:2')
diff is  tensor(134.5970, device='cuda:2')
diff is  tensor(0.0239, device='cuda:2')
diff is  tensor(0.3474, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.7653, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0222, device='cuda:2')
sum is tensor(0.0461, device='cuda:2')
sum is tensor(0.3935, device='cuda:2')
sum is tensor(1.2318, device='cuda:2')
sum is tensor(13.4647, device='cuda:2')
sum is tensor(148.0617, device='cuda:2')
ratio is tensor(0.6411, device='cuda:2')
threshold is tensor(134.5970, device='cuda:2')
cal diff is tensor(0.8383, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(12.2329, device='cuda:2')
discard
cal diff is tensor(0.0128, device='cuda:2')
discard
cal diff is tensor(134.5970, device='cuda:2')
clipping
cal diff is tensor(0.0239, device='cuda:2')
discard
cal diff is tensor(0.3474, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 68 global rounds:
Train Accuracy: 99.00% 

Test Accuracy: 99.18% 


 | Global Training Round : 69 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004082060419023037
attack res is False
len of model dicts is  10
compute distance is  tensor(13.6205, device='cuda:2')
compute distance is  tensor(83.6156, device='cuda:2')
compute distance is  tensor(76.2806, device='cuda:2')
compute distance is  tensor(93.6781, device='cuda:2')
compute distance is  tensor(49.0968, device='cuda:2')
compute distance is  tensor(50.6959, device='cuda:2')
compute distance is  tensor(41.1056, device='cuda:2')
compute distance is  tensor(40.9915, device='cuda:2')
compute distance is  tensor(98.1689, device='cuda:2')
compute distance is  tensor(33.9354, device='cuda:2')
calculated distance threshold is  tensor(70.7907, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8208000001563247
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8778166668229889
====================
====================
iteration is  0
round is  2
accuracy is  0.8318333334896574
====================
====================
iteration is  1
round is  0
accuracy is  0.8088666668229918
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.826316666822991
====================
====================
iteration is  1
round is  2
accuracy is  0.7197833334896631
====================
succ_min + 1
________________________________
test distance is  tensor(4711.5176, device='cuda:2')
test acc is  0.7197833334896631
test loss is 1.7931833694071404
test entropy is  0.17500408457667588
________________________________
diff is  tensor(48.4164, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3887, device='cuda:2', dtype=torch.float64)
diff is  tensor(628.1362, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5122, device='cuda:2', dtype=torch.float64)
diff is  tensor(4009.0207, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2504, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.5342, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2587, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4640.7271, device='cuda:2')
sum is tensor(0.2587, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6473, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1595, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4099, device='cuda:2', dtype=torch.float64)
sum is tensor(25.9441, device='cuda:2', dtype=torch.float64)
sum is tensor(74.3605, device='cuda:2', dtype=torch.float64)
sum is tensor(702.4968, device='cuda:2', dtype=torch.float64)
sum is tensor(4711.5175, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0177, device='cuda:2', dtype=torch.float64)
threshold is tensor(4009.0207, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.4164, device='cuda:2')
discard
cal diff is tensor(0.3887, device='cuda:2')
discard
cal diff is tensor(628.1362, device='cuda:2')
discard
cal diff is tensor(0.5122, device='cuda:2')
discard
cal diff is tensor(4009.0205, device='cuda:2')
discard
cal diff is tensor(2.2504, device='cuda:2')
discard
cal diff is tensor(22.5342, device='cuda:2')
discard
cal diff is tensor(0.2587, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934333334896517
test loss is 0.023350988736628664
test entropy is  0.011269120293984188
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011269120293984188
avg test loss is  0.023350988736628664
avg accuracy is  0.9934333334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19332978326374534
avg test loss is  0.9829995862122919
avg accuracy is  0.7857500001563263
compute_distance is  tensor(89.2677, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(89.2677, device='cuda:2')
test acc is  0.7857500001563263
test loss is 0.9829995862122919
test entropy is  0.19332978326374534
________________________________
diff is  tensor(0.7845, device='cuda:2')
diff is  tensor(0.0078, device='cuda:2')
diff is  tensor(12.6175, device='cuda:2')
diff is  tensor(0.0137, device='cuda:2')
diff is  tensor(75.2258, device='cuda:2')
diff is  tensor(0.0458, device='cuda:2')
diff is  tensor(0.5745, device='cuda:2')
diff is  tensor(0.0048, device='cuda:2')
threshold is  tensor(18.4770, device='cuda:2')
sum is tensor(0.0048, device='cuda:2')
sum is tensor(0.0127, device='cuda:2')
sum is tensor(0.0264, device='cuda:2')
sum is tensor(0.0722, device='cuda:2')
sum is tensor(0.6467, device='cuda:2')
sum is tensor(1.4312, device='cuda:2')
sum is tensor(14.0487, device='cuda:2')
sum is tensor(89.2745, device='cuda:2')
ratio is tensor(0.9411, device='cuda:2')
threshold is tensor(75.2258, device='cuda:2')
cal diff is tensor(0.7845, device='cuda:2')
discard
cal diff is tensor(0.0078, device='cuda:2')
discard
cal diff is tensor(12.6175, device='cuda:2')
discard
cal diff is tensor(0.0137, device='cuda:2')
discard
cal diff is tensor(75.2258, device='cuda:2')
clipping
cal diff is tensor(0.0458, device='cuda:2')
discard
cal diff is tensor(0.5745, device='cuda:2')
discard
cal diff is tensor(0.0048, device='cuda:2')
discard
________________________________
test distance is  tensor(70.7996, device='cuda:2')
test acc is  0.9671500001563191
test loss is 0.11439069128291501
test entropy is  0.04993718858078015
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.7978, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0089, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1480, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.7978, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(10.4807, device='cuda:2')
test acc is  0.9931333334896517
test loss is 0.023699859502494734
test entropy is  0.011991006779296936
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011991006779296936
avg test loss is  0.023699859502494734
avg accuracy is  0.9931333334896517
compute_distance is  tensor(10.4807, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1929480287589943
avg test loss is  1.0256353465399382
avg accuracy is  0.7806333334896599
compute_distance is  tensor(95.1421, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(95.1421, device='cuda:2')
test acc is  0.7806333334896599
test loss is 1.0256353465399382
test entropy is  0.1929480287589943
________________________________
diff is  tensor(0.7376, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(12.6263, device='cuda:2')
diff is  tensor(0.0141, device='cuda:2')
diff is  tensor(81.1840, device='cuda:2')
diff is  tensor(0.0414, device='cuda:2')
diff is  tensor(0.5305, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(24.3514, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0117, device='cuda:2')
sum is tensor(0.0259, device='cuda:2')
sum is tensor(0.0672, device='cuda:2')
sum is tensor(0.5977, device='cuda:2')
sum is tensor(1.3353, device='cuda:2')
sum is tensor(13.9617, device='cuda:2')
sum is tensor(95.1457, device='cuda:2')
ratio is tensor(0.8720, device='cuda:2')
threshold is tensor(81.1840, device='cuda:2')
cal diff is tensor(0.7376, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(12.6263, device='cuda:2')
discard
cal diff is tensor(0.0141, device='cuda:2')
discard
cal diff is tensor(81.1840, device='cuda:2')
clipping
cal diff is tensor(0.0414, device='cuda:2')
discard
cal diff is tensor(0.5305, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(70.7978, device='cuda:2')
test acc is  0.9711333334896524
test loss is 0.09752645145965137
test entropy is  0.04480211350603649
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.7948, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0070, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3503, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.7948, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(24.8022, device='cuda:2')
test acc is  0.9923833334896517
test loss is 0.026573792453177945
test entropy is  0.014143553517304657
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.014143553517304657
avg test loss is  0.026573792453177945
avg accuracy is  0.9923833334896517
compute_distance is  tensor(24.8022, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1917419328388057
avg test loss is  1.075330966150265
avg accuracy is  0.774500000156327
compute_distance is  tensor(103.4460, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(103.4460, device='cuda:2')
test acc is  0.774500000156327
test loss is 1.075330966150265
test entropy is  0.1917419328388057
________________________________
diff is  tensor(0.6933, device='cuda:2')
diff is  tensor(0.0072, device='cuda:2')
diff is  tensor(12.4878, device='cuda:2')
diff is  tensor(0.0139, device='cuda:2')
diff is  tensor(89.7242, device='cuda:2')
diff is  tensor(0.0364, device='cuda:2')
diff is  tensor(0.4790, device='cuda:2')
diff is  tensor(0.0037, device='cuda:2')
threshold is  tensor(32.6553, device='cuda:2')
sum is tensor(0.0037, device='cuda:2')
sum is tensor(0.0109, device='cuda:2')
sum is tensor(0.0249, device='cuda:2')
sum is tensor(0.0613, device='cuda:2')
sum is tensor(0.5402, device='cuda:2')
sum is tensor(1.2335, device='cuda:2')
sum is tensor(13.7214, device='cuda:2')
sum is tensor(103.4455, device='cuda:2')
ratio is tensor(0.7890, device='cuda:2')
threshold is tensor(89.7242, device='cuda:2')
cal diff is tensor(0.6933, device='cuda:2')
discard
cal diff is tensor(0.0072, device='cuda:2')
discard
cal diff is tensor(12.4878, device='cuda:2')
discard
cal diff is tensor(0.0139, device='cuda:2')
discard
cal diff is tensor(89.7242, device='cuda:2')
clipping
cal diff is tensor(0.0364, device='cuda:2')
discard
cal diff is tensor(0.4790, device='cuda:2')
discard
cal diff is tensor(0.0037, device='cuda:2')
discard
________________________________
test distance is  tensor(70.7954, device='cuda:2')
test acc is  0.9752333334896522
test loss is 0.08224160076964127
test entropy is  0.03997534501580655
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.7909, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0047, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6133, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.7909, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(43.4189, device='cuda:2')
test acc is  0.9894833334896518
test loss is 0.0355432822684298
test entropy is  0.019555639119944453
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.019555639119944453
avg test loss is  0.0355432822684298
avg accuracy is  0.9894833334896518
compute_distance is  tensor(43.4189, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18982507538662027
avg test loss is  1.1329010967046087
avg accuracy is  0.767866666822994
compute_distance is  tensor(114.9451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(114.9451, device='cuda:2')
test acc is  0.767866666822994
test loss is 1.1329010967046087
test entropy is  0.18982507538662027
________________________________
diff is  tensor(0.6592, device='cuda:2')
diff is  tensor(0.0073, device='cuda:2')
diff is  tensor(12.1407, device='cuda:2')
diff is  tensor(0.0132, device='cuda:2')
diff is  tensor(101.6608, device='cuda:2')
diff is  tensor(0.0310, device='cuda:2')
diff is  tensor(0.4247, device='cuda:2')
diff is  tensor(0.0031, device='cuda:2')
threshold is  tensor(44.1543, device='cuda:2')
sum is tensor(0.0031, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0236, device='cuda:2')
sum is tensor(0.0546, device='cuda:2')
sum is tensor(0.4794, device='cuda:2')
sum is tensor(1.1386, device='cuda:2')
sum is tensor(13.2792, device='cuda:2')
sum is tensor(114.9400, device='cuda:2')
ratio is tensor(0.6963, device='cuda:2')
threshold is tensor(101.6608, device='cuda:2')
cal diff is tensor(0.6592, device='cuda:2')
discard
cal diff is tensor(0.0073, device='cuda:2')
discard
cal diff is tensor(12.1407, device='cuda:2')
discard
cal diff is tensor(0.0132, device='cuda:2')
discard
cal diff is tensor(101.6608, device='cuda:2')
clipping
cal diff is tensor(0.0310, device='cuda:2')
discard
cal diff is tensor(0.4247, device='cuda:2')
discard
cal diff is tensor(0.0031, device='cuda:2')
discard
________________________________
test distance is  tensor(70.7927, device='cuda:2')
test acc is  0.9791333334896521
test loss is 0.068842180624417
test entropy is  0.035433285469449294
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.7862, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0020, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.9108, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.7862, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(64.4799, device='cuda:2')
test acc is  0.9828500001563186
test loss is 0.05629009270822897
test entropy is  0.03000925567960724
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03000925567960724
avg test loss is  0.05629009270822897
avg accuracy is  0.9828500001563186
compute_distance is  tensor(64.4799, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1874241342009512
avg test loss is  1.189769314455071
avg accuracy is  0.7629833334896609
compute_distance is  tensor(128.4754, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(128.4754, device='cuda:2')
test acc is  0.7629833334896609
test loss is 1.189769314455071
test entropy is  0.1874241342009512
________________________________
diff is  tensor(0.6492, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(11.6041, device='cuda:2')
diff is  tensor(0.0123, device='cuda:2')
diff is  tensor(115.7895, device='cuda:2')
diff is  tensor(0.0260, device='cuda:2')
diff is  tensor(0.3753, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(57.6847, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0095, device='cuda:2')
sum is tensor(0.0218, device='cuda:2')
sum is tensor(0.0478, device='cuda:2')
sum is tensor(0.4230, device='cuda:2')
sum is tensor(1.0722, device='cuda:2')
sum is tensor(12.6763, device='cuda:2')
sum is tensor(128.4658, device='cuda:2')
ratio is tensor(0.6113, device='cuda:2')
threshold is tensor(115.7895, device='cuda:2')
cal diff is tensor(0.6492, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(11.6041, device='cuda:2')
discard
cal diff is tensor(0.0123, device='cuda:2')
discard
cal diff is tensor(115.7895, device='cuda:2')
clipping
cal diff is tensor(0.0260, device='cuda:2')
discard
cal diff is tensor(0.3753, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(70.7902, device='cuda:2')
test acc is  0.9824166668229855
test loss is 0.058475416528936765
test entropy is  0.031432005291475655
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.031432005291475655
avg test loss is  0.058475416528936765
avg accuracy is  0.9824166668229855
compute_distance is  tensor(70.7902, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1864777284660446
avg test loss is  1.209493964418038
avg accuracy is  0.7613833334896609
compute_distance is  tensor(133.9410, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(133.9410, device='cuda:2')
test acc is  0.7613833334896609
test loss is 1.209493964418038
test entropy is  0.1864777284660446
________________________________
diff is  tensor(0.6604, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(11.6434, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(121.2160, device='cuda:2')
diff is  tensor(0.0252, device='cuda:2')
diff is  tensor(0.3627, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(63.1503, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0094, device='cuda:2')
sum is tensor(0.0217, device='cuda:2')
sum is tensor(0.0470, device='cuda:2')
sum is tensor(0.4097, device='cuda:2')
sum is tensor(1.0700, device='cuda:2')
sum is tensor(12.7134, device='cuda:2')
sum is tensor(133.9294, device='cuda:2')
ratio is tensor(0.5839, device='cuda:2')
threshold is tensor(121.2160, device='cuda:2')
cal diff is tensor(0.6604, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(11.6434, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(121.2160, device='cuda:2')
clipping
cal diff is tensor(0.0252, device='cuda:2')
discard
cal diff is tensor(0.3627, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(70.7895, device='cuda:2')
test acc is  0.983883333489652
test loss is 0.054023840289601006
test entropy is  0.02947611699356537
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02947611699356537
avg test loss is  0.054023840289601006
avg accuracy is  0.983883333489652
compute_distance is  tensor(70.7895, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18637915319407672
avg test loss is  1.2116905514841902
avg accuracy is  0.7615000001563276
compute_distance is  tensor(134.7917, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(134.7917, device='cuda:2')
test acc is  0.7615000001563276
test loss is 1.2116905514841902
test entropy is  0.18637915319407672
________________________________
diff is  tensor(0.6647, device='cuda:2')
diff is  tensor(0.0071, device='cuda:2')
diff is  tensor(11.8180, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(121.8843, device='cuda:2')
diff is  tensor(0.0259, device='cuda:2')
diff is  tensor(0.3642, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(64.0009, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0095, device='cuda:2')
sum is tensor(0.0222, device='cuda:2')
sum is tensor(0.0481, device='cuda:2')
sum is tensor(0.4123, device='cuda:2')
sum is tensor(1.0771, device='cuda:2')
sum is tensor(12.8950, device='cuda:2')
sum is tensor(134.7793, device='cuda:2')
ratio is tensor(0.5807, device='cuda:2')
threshold is tensor(121.8843, device='cuda:2')
cal diff is tensor(0.6647, device='cuda:2')
discard
cal diff is tensor(0.0071, device='cuda:2')
discard
cal diff is tensor(11.8180, device='cuda:2')
discard
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(121.8843, device='cuda:2')
clipping
cal diff is tensor(0.0259, device='cuda:2')
discard
cal diff is tensor(0.3642, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(70.7893, device='cuda:2')
test acc is  0.9843000001563186
test loss is 0.05264544938247296
test entropy is  0.02881981765040691
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02881981765040691
avg test loss is  0.05264544938247296
avg accuracy is  0.9843000001563186
compute_distance is  tensor(70.7893, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18635135620578266
avg test loss is  1.2129101688419577
avg accuracy is  0.7614500001563276
compute_distance is  tensor(135.1245, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 69 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.18% 


 | Global Training Round : 70 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004177641589194536
attack res is False
len of model dicts is  10
compute distance is  tensor(13.2309, device='cuda:2')
compute distance is  tensor(58.4170, device='cuda:2')
compute distance is  tensor(62.6013, device='cuda:2')
compute distance is  tensor(91.6555, device='cuda:2')
compute distance is  tensor(36.4551, device='cuda:2')
compute distance is  tensor(48.6067, device='cuda:2')
compute distance is  tensor(42.7631, device='cuda:2')
compute distance is  tensor(59.7339, device='cuda:2')
compute distance is  tensor(60.4236, device='cuda:2')
compute distance is  tensor(54.8182, device='cuda:2')
calculated distance threshold is  tensor(66.2603, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.9190500001563207
====================
====================
iteration is  0
round is  1
accuracy is  0.5712833334896734
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.85126666682299
====================
====================
iteration is  1
round is  0
accuracy is  0.7289333334896625
====================
====================
iteration is  1
round is  1
accuracy is  0.7996000001563255
====================
====================
iteration is  1
round is  2
accuracy is  0.7845000001563263
====================
====================
iteration is  2
round is  0
accuracy is  0.6112166668230035
====================
________________________________
test distance is  tensor(4283.5415, device='cuda:2')
test acc is  0.5712833334896734
test loss is 2.686947785079606
test entropy is  0.22467075723574867
________________________________
diff is  tensor(43.8952, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3540, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.3366, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4810, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.8785, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0527, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2971, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2460, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4217.2812, device='cuda:2')
sum is tensor(0.2460, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6001, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0811, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1337, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4308, device='cuda:2', dtype=torch.float64)
sum is tensor(67.3261, device='cuda:2', dtype=torch.float64)
sum is tensor(640.6626, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.5411, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0182, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.8785, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.8952, device='cuda:2')
discard
cal diff is tensor(0.3540, device='cuda:2')
discard
cal diff is tensor(573.3365, device='cuda:2')
discard
cal diff is tensor(0.4810, device='cuda:2')
discard
cal diff is tensor(3642.8787, device='cuda:2')
clipping
cal diff is tensor(2.0527, device='cuda:2')
discard
cal diff is tensor(20.2971, device='cuda:2')
discard
cal diff is tensor(0.2460, device='cuda:2')
discard
________________________________
test distance is  tensor(66.2701, device='cuda:2')
test acc is  0.9934833334896517
test loss is 0.023329775584342897
test entropy is  0.011237211000174543
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.2599, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0098, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0426, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.2599, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(2.8329, device='cuda:2')
test acc is  0.9934333334896517
test loss is 0.02333676363209158
test entropy is  0.011231300237903818
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011231300237903818
avg test loss is  0.02333676363209158
avg accuracy is  0.9934333334896517
compute_distance is  tensor(2.8329, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.26293264920396336
avg test loss is  1.9350014132922138
avg accuracy is  0.6005833334896711
compute_distance is  tensor(89.2297, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(89.2297, device='cuda:2')
test acc is  0.6005833334896711
test loss is 1.9350014132922138
test entropy is  0.26293264920396336
________________________________
diff is  tensor(0.7590, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(12.2298, device='cuda:2')
diff is  tensor(0.0132, device='cuda:2')
diff is  tensor(75.5457, device='cuda:2')
diff is  tensor(0.0489, device='cuda:2')
diff is  tensor(0.6298, device='cuda:2')
diff is  tensor(0.0052, device='cuda:2')
threshold is  tensor(22.9694, device='cuda:2')
sum is tensor(0.0052, device='cuda:2')
sum is tensor(0.0119, device='cuda:2')
sum is tensor(0.0251, device='cuda:2')
sum is tensor(0.0740, device='cuda:2')
sum is tensor(0.7038, device='cuda:2')
sum is tensor(1.4629, device='cuda:2')
sum is tensor(13.6926, device='cuda:2')
sum is tensor(89.2383, device='cuda:2')
ratio is tensor(0.8772, device='cuda:2')
threshold is tensor(75.5457, device='cuda:2')
cal diff is tensor(0.7590, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(12.2298, device='cuda:2')
discard
cal diff is tensor(0.0132, device='cuda:2')
discard
cal diff is tensor(75.5457, device='cuda:2')
clipping
cal diff is tensor(0.0489, device='cuda:2')
discard
cal diff is tensor(0.6298, device='cuda:2')
discard
cal diff is tensor(0.0052, device='cuda:2')
discard
________________________________
test distance is  tensor(66.2691, device='cuda:2')
test acc is  0.9597333334896527
test loss is 0.14584188073897908
test entropy is  0.051423845292656804
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.2696, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0088, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1614, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.2696, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(10.7030, device='cuda:2')
test acc is  0.9931833334896517
test loss is 0.02432179698005879
test entropy is  0.012071006818938192
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012071006818938192
avg test loss is  0.02432179698005879
avg accuracy is  0.9931833334896517
compute_distance is  tensor(10.7030, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.25973068398516824
avg test loss is  1.966093337357934
avg accuracy is  0.5999666668230045
compute_distance is  tensor(94.8331, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(94.8331, device='cuda:2')
test acc is  0.5999666668230045
test loss is 1.966093337357934
test entropy is  0.25973068398516824
________________________________
diff is  tensor(0.7132, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(12.1766, device='cuda:2')
diff is  tensor(0.0135, device='cuda:2')
diff is  tensor(81.3042, device='cuda:2')
diff is  tensor(0.0433, device='cuda:2')
diff is  tensor(0.5764, device='cuda:2')
diff is  tensor(0.0046, device='cuda:2')
threshold is  tensor(28.5728, device='cuda:2')
sum is tensor(0.0046, device='cuda:2')
sum is tensor(0.0111, device='cuda:2')
sum is tensor(0.0247, device='cuda:2')
sum is tensor(0.0680, device='cuda:2')
sum is tensor(0.6444, device='cuda:2')
sum is tensor(1.3575, device='cuda:2')
sum is tensor(13.5342, device='cuda:2')
sum is tensor(94.8384, device='cuda:2')
ratio is tensor(0.8150, device='cuda:2')
threshold is tensor(81.3042, device='cuda:2')
cal diff is tensor(0.7132, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(12.1766, device='cuda:2')
discard
cal diff is tensor(0.0135, device='cuda:2')
discard
cal diff is tensor(81.3042, device='cuda:2')
clipping
cal diff is tensor(0.0433, device='cuda:2')
discard
cal diff is tensor(0.5764, device='cuda:2')
discard
cal diff is tensor(0.0046, device='cuda:2')
discard
________________________________
test distance is  tensor(66.2673, device='cuda:2')
test acc is  0.9657833334896525
test loss is 0.12148458513411921
test entropy is  0.04599915603631244
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.2665, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0070, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3511, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.2665, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(23.2706, device='cuda:2')
test acc is  0.9921833334896517
test loss is 0.028039490147295454
test entropy is  0.014195579517508295
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.014195579517508295
avg test loss is  0.028039490147295454
avg accuracy is  0.9921833334896517
compute_distance is  tensor(23.2706, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.25668996151512874
avg test loss is  2.0011705780969753
avg accuracy is  0.5986666668230045
compute_distance is  tensor(102.1151, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(102.1151, device='cuda:2')
test acc is  0.5986666668230045
test loss is 2.0011705780969753
test entropy is  0.25668996151512874
________________________________
diff is  tensor(0.6849, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.9871, device='cuda:2')
diff is  tensor(0.0131, device='cuda:2')
diff is  tensor(88.8571, device='cuda:2')
diff is  tensor(0.0381, device='cuda:2')
diff is  tensor(0.5260, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
threshold is  tensor(35.8548, device='cuda:2')
sum is tensor(0.0041, device='cuda:2')
sum is tensor(0.0105, device='cuda:2')
sum is tensor(0.0237, device='cuda:2')
sum is tensor(0.0618, device='cuda:2')
sum is tensor(0.5877, device='cuda:2')
sum is tensor(1.2727, device='cuda:2')
sum is tensor(13.2597, device='cuda:2')
sum is tensor(102.1168, device='cuda:2')
ratio is tensor(0.7457, device='cuda:2')
threshold is tensor(88.8571, device='cuda:2')
cal diff is tensor(0.6849, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.9871, device='cuda:2')
discard
cal diff is tensor(0.0131, device='cuda:2')
discard
cal diff is tensor(88.8571, device='cuda:2')
clipping
cal diff is tensor(0.0381, device='cuda:2')
discard
cal diff is tensor(0.5260, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
________________________________
test distance is  tensor(66.2656, device='cuda:2')
test acc is  0.9713833334896523
test loss is 0.10158887874994821
test entropy is  0.041242056199368576
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.2630, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0053, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5433, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.2630, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(36.0048, device='cuda:2')
test acc is  0.990116666822985
test loss is 0.03510534600078029
test entropy is  0.017879075947364126
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.017879075947364126
avg test loss is  0.03510534600078029
avg accuracy is  0.990116666822985
compute_distance is  tensor(36.0048, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.25429462692313104
avg test loss is  2.0319337569065947
avg accuracy is  0.5967833334896715
compute_distance is  tensor(109.8523, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(109.8523, device='cuda:2')
test acc is  0.5967833334896715
test loss is 2.0319337569065947
test entropy is  0.25429462692313104
________________________________
diff is  tensor(0.6560, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.6214, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(97.0322, device='cuda:2')
diff is  tensor(0.0340, device='cuda:2')
diff is  tensor(0.4843, device='cuda:2')
diff is  tensor(0.0037, device='cuda:2')
threshold is  tensor(43.5920, device='cuda:2')
sum is tensor(0.0037, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(0.0227, device='cuda:2')
sum is tensor(0.0567, device='cuda:2')
sum is tensor(0.5409, device='cuda:2')
sum is tensor(1.1970, device='cuda:2')
sum is tensor(12.8183, device='cuda:2')
sum is tensor(109.8505, device='cuda:2')
ratio is tensor(0.6829, device='cuda:2')
threshold is tensor(97.0322, device='cuda:2')
cal diff is tensor(0.6560, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.6214, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(97.0322, device='cuda:2')
clipping
cal diff is tensor(0.0340, device='cuda:2')
discard
cal diff is tensor(0.4843, device='cuda:2')
discard
cal diff is tensor(0.0037, device='cuda:2')
discard
________________________________
test distance is  tensor(66.2638, device='cuda:2')
test acc is  0.9750333334896522
test loss is 0.08711327474941082
test entropy is  0.03744548118842923
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.2595, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0035, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7414, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.2595, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(49.1290, device='cuda:2')
test acc is  0.9862833334896518
test loss is 0.047282146141753974
test entropy is  0.023478720350983005
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.023478720350983005
avg test loss is  0.047282146141753974
avg accuracy is  0.9862833334896518
compute_distance is  tensor(49.1290, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2523918886905286
avg test loss is  2.059550557563554
avg accuracy is  0.5956000001563382
compute_distance is  tensor(118.1666, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(118.1666, device='cuda:2')
test acc is  0.5956000001563382
test loss is 2.059550557563554
test entropy is  0.2523918886905286
________________________________
diff is  tensor(0.6287, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.1133, device='cuda:2')
diff is  tensor(0.0117, device='cuda:2')
diff is  tensor(105.9186, device='cuda:2')
diff is  tensor(0.0305, device='cuda:2')
diff is  tensor(0.4487, device='cuda:2')
diff is  tensor(0.0034, device='cuda:2')
threshold is  tensor(51.9063, device='cuda:2')
sum is tensor(0.0034, device='cuda:2')
sum is tensor(0.0100, device='cuda:2')
sum is tensor(0.0217, device='cuda:2')
sum is tensor(0.0522, device='cuda:2')
sum is tensor(0.5009, device='cuda:2')
sum is tensor(1.1296, device='cuda:2')
sum is tensor(12.2429, device='cuda:2')
sum is tensor(118.1615, device='cuda:2')
ratio is tensor(0.6255, device='cuda:2')
threshold is tensor(105.9186, device='cuda:2')
cal diff is tensor(0.6287, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.1133, device='cuda:2')
discard
cal diff is tensor(0.0117, device='cuda:2')
discard
cal diff is tensor(105.9186, device='cuda:2')
clipping
cal diff is tensor(0.0305, device='cuda:2')
discard
cal diff is tensor(0.4487, device='cuda:2')
discard
cal diff is tensor(0.0034, device='cuda:2')
discard
________________________________
test distance is  tensor(66.2621, device='cuda:2')
test acc is  0.9778833334896522
test loss is 0.07589551038927214
test entropy is  0.03422689996734222
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.2559, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0018, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.9336, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.2559, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(61.8612, device='cuda:2')
test acc is  0.9810166668229854
test loss is 0.06496294470827885
test entropy is  0.030413648583179118
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.030413648583179118
avg test loss is  0.06496294470827885
avg accuracy is  0.9810166668229854
compute_distance is  tensor(61.8612, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.25096846775396037
avg test loss is  2.0829434137481617
avg accuracy is  0.5938833334896716
compute_distance is  tensor(126.5274, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(126.5274, device='cuda:2')
test acc is  0.5938833334896716
test loss is 2.0829434137481617
test entropy is  0.25096846775396037
________________________________
diff is  tensor(0.6118, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(10.5835, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(114.8554, device='cuda:2')
diff is  tensor(0.0275, device='cuda:2')
diff is  tensor(0.4203, device='cuda:2')
diff is  tensor(0.0031, device='cuda:2')
threshold is  tensor(60.2671, device='cuda:2')
sum is tensor(0.0031, device='cuda:2')
sum is tensor(0.0096, device='cuda:2')
sum is tensor(0.0206, device='cuda:2')
sum is tensor(0.0482, device='cuda:2')
sum is tensor(0.4685, device='cuda:2')
sum is tensor(1.0802, device='cuda:2')
sum is tensor(11.6637, device='cuda:2')
sum is tensor(126.5191, device='cuda:2')
ratio is tensor(0.5768, device='cuda:2')
threshold is tensor(114.8554, device='cuda:2')
cal diff is tensor(0.6118, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(10.5835, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(114.8554, device='cuda:2')
clipping
cal diff is tensor(0.0275, device='cuda:2')
discard
cal diff is tensor(0.4203, device='cuda:2')
discard
cal diff is tensor(0.0031, device='cuda:2')
discard
________________________________
test distance is  tensor(66.2605, device='cuda:2')
test acc is  0.9802500001563187
test loss is 0.06736712384451488
test entropy is  0.031573793282119886
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.2525, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0002, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
ratio is tensor(0.6519, device='cuda:2')
threshold is tensor(0.0003, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.2525, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
clipping
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 70 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.19% 


 | Global Training Round : 71 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004177641589194536
attack res is False
len of model dicts is  10
compute distance is  tensor(14.4237, device='cuda:2')
compute distance is  tensor(73.8344, device='cuda:2')
compute distance is  tensor(69.7402, device='cuda:2')
compute distance is  tensor(85.8804, device='cuda:2')
compute distance is  tensor(62.9874, device='cuda:2')
compute distance is  tensor(84.6166, device='cuda:2')
compute distance is  tensor(52.2487, device='cuda:2')
compute distance is  tensor(48.5839, device='cuda:2')
compute distance is  tensor(95.3235, device='cuda:2')
compute distance is  tensor(60.4365, device='cuda:2')
calculated distance threshold is  tensor(69.1268, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8800000001563222
====================
====================
iteration is  0
round is  1
accuracy is  0.8644333334896562
====================
====================
iteration is  0
round is  2
accuracy is  0.8518500001563232
====================
====================
iteration is  1
round is  0
accuracy is  0.7611333334896607
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8313000001563242
====================
====================
iteration is  1
round is  2
accuracy is  0.5906833334896717
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.8376833334896571
====================
====================
iteration is  2
round is  1
accuracy is  0.7126833334896635
====================
________________________________
test distance is  tensor(4710.8638, device='cuda:2')
test acc is  0.5906833334896717
test loss is 3.905740633066783
test entropy is  0.14582674730338777
________________________________
diff is  tensor(47.4043, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3923, device='cuda:2', dtype=torch.float64)
diff is  tensor(631.3734, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4976, device='cuda:2', dtype=torch.float64)
diff is  tensor(4006.3348, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2890, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3355, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2362, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4641.7368, device='cuda:2')
sum is tensor(0.2362, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6285, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1262, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4151, device='cuda:2', dtype=torch.float64)
sum is tensor(25.7506, device='cuda:2', dtype=torch.float64)
sum is tensor(73.1550, device='cuda:2', dtype=torch.float64)
sum is tensor(704.5284, device='cuda:2', dtype=torch.float64)
sum is tensor(4710.8632, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0173, device='cuda:2', dtype=torch.float64)
threshold is tensor(4006.3348, device='cuda:2', dtype=torch.float64)
cal diff is tensor(47.4043, device='cuda:2')
discard
cal diff is tensor(0.3923, device='cuda:2')
discard
cal diff is tensor(631.3734, device='cuda:2')
discard
cal diff is tensor(0.4976, device='cuda:2')
discard
cal diff is tensor(4006.3347, device='cuda:2')
discard
cal diff is tensor(2.2890, device='cuda:2')
discard
cal diff is tensor(22.3355, device='cuda:2')
discard
cal diff is tensor(0.2362, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934500001563183
test loss is 0.023277147215189073
test entropy is  0.011261121265361697
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011261121265361697
avg test loss is  0.023277147215189073
avg accuracy is  0.9934500001563183
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16340065060425668
avg test loss is  2.6389823021537966
avg accuracy is  0.6375666668230017
compute_distance is  tensor(87.6521, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(87.6521, device='cuda:2')
test acc is  0.6375666668230017
test loss is 2.6389823021537966
test entropy is  0.16340065060425668
________________________________
diff is  tensor(0.9074, device='cuda:2')
diff is  tensor(0.0082, device='cuda:2')
diff is  tensor(12.4924, device='cuda:2')
diff is  tensor(0.0140, device='cuda:2')
diff is  tensor(73.6056, device='cuda:2')
diff is  tensor(0.0444, device='cuda:2')
diff is  tensor(0.5769, device='cuda:2')
diff is  tensor(0.0046, device='cuda:2')
threshold is  tensor(18.5253, device='cuda:2')
sum is tensor(0.0046, device='cuda:2')
sum is tensor(0.0127, device='cuda:2')
sum is tensor(0.0267, device='cuda:2')
sum is tensor(0.0711, device='cuda:2')
sum is tensor(0.6480, device='cuda:2')
sum is tensor(1.5554, device='cuda:2')
sum is tensor(14.0477, device='cuda:2')
sum is tensor(87.6533, device='cuda:2')
ratio is tensor(0.9392, device='cuda:2')
threshold is tensor(73.6056, device='cuda:2')
cal diff is tensor(0.9074, device='cuda:2')
discard
cal diff is tensor(0.0082, device='cuda:2')
discard
cal diff is tensor(12.4924, device='cuda:2')
discard
cal diff is tensor(0.0140, device='cuda:2')
discard
cal diff is tensor(73.6056, device='cuda:2')
clipping
cal diff is tensor(0.0444, device='cuda:2')
discard
cal diff is tensor(0.5769, device='cuda:2')
discard
cal diff is tensor(0.0046, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1333, device='cuda:2')
test acc is  0.9262500001563205
test loss is 0.2995528428001639
test entropy is  0.07267700616163073
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.1282, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0064, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.4169, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.1282, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(28.8231, device='cuda:2')
test acc is  0.9898166668229851
test loss is 0.03678839893826019
test entropy is  0.017361897360889247
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.017361897360889247
avg test loss is  0.03678839893826019
avg accuracy is  0.9898166668229851
compute_distance is  tensor(28.8231, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16286934946359857
avg test loss is  2.7710050981182026
avg accuracy is  0.6304000001563355
compute_distance is  tensor(103.1080, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(103.1080, device='cuda:2')
test acc is  0.6304000001563355
test loss is 2.7710050981182026
test entropy is  0.16286934946359857
________________________________
diff is  tensor(0.8595, device='cuda:2')
diff is  tensor(0.0077, device='cuda:2')
diff is  tensor(12.0419, device='cuda:2')
diff is  tensor(0.0133, device='cuda:2')
diff is  tensor(89.6673, device='cuda:2')
diff is  tensor(0.0328, device='cuda:2')
diff is  tensor(0.4752, device='cuda:2')
diff is  tensor(0.0035, device='cuda:2')
threshold is  tensor(33.9812, device='cuda:2')
sum is tensor(0.0035, device='cuda:2')
sum is tensor(0.0112, device='cuda:2')
sum is tensor(0.0245, device='cuda:2')
sum is tensor(0.0574, device='cuda:2')
sum is tensor(0.5326, device='cuda:2')
sum is tensor(1.3921, device='cuda:2')
sum is tensor(13.4340, device='cuda:2')
sum is tensor(103.1013, device='cuda:2')
ratio is tensor(0.7709, device='cuda:2')
threshold is tensor(89.6673, device='cuda:2')
cal diff is tensor(0.8595, device='cuda:2')
discard
cal diff is tensor(0.0077, device='cuda:2')
discard
cal diff is tensor(12.0419, device='cuda:2')
discard
cal diff is tensor(0.0133, device='cuda:2')
discard
cal diff is tensor(89.6673, device='cuda:2')
clipping
cal diff is tensor(0.0328, device='cuda:2')
discard
cal diff is tensor(0.4752, device='cuda:2')
discard
cal diff is tensor(0.0035, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1291, device='cuda:2')
test acc is  0.9522500001563197
test loss is 0.18453659221809457
test entropy is  0.05468508289014396
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(69.1203, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0022, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8813, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(69.1203, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(60.9255, device='cuda:2')
test acc is  0.9676333334896524
test loss is 0.12130770935263518
test entropy is  0.041053848486409326
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.041053848486409326
avg test loss is  0.12130770935263518
avg accuracy is  0.9676333334896524
compute_distance is  tensor(60.9255, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1615512537946706
avg test loss is  2.8926612392290316
avg accuracy is  0.623400000156336
compute_distance is  tensor(122.7074, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(122.7074, device='cuda:2')
test acc is  0.623400000156336
test loss is 2.8926612392290316
test entropy is  0.1615512537946706
________________________________
diff is  tensor(0.8208, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(10.8394, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(110.5952, device='cuda:2')
diff is  tensor(0.0243, device='cuda:2')
diff is  tensor(0.3935, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(53.5806, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0203, device='cuda:2')
sum is tensor(0.0446, device='cuda:2')
sum is tensor(0.4381, device='cuda:2')
sum is tensor(1.2589, device='cuda:2')
sum is tensor(12.0983, device='cuda:2')
sum is tensor(122.6935, device='cuda:2')
ratio is tensor(0.6249, device='cuda:2')
threshold is tensor(110.5952, device='cuda:2')
cal diff is tensor(0.8208, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(10.8394, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(110.5952, device='cuda:2')
clipping
cal diff is tensor(0.0243, device='cuda:2')
discard
cal diff is tensor(0.3935, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1250, device='cuda:2')
test acc is  0.9664500001563192
test loss is 0.1255154139733753
test entropy is  0.04257451369266298
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04257451369266298
avg test loss is  0.1255154139733753
avg accuracy is  0.9664500001563192
compute_distance is  tensor(69.1250, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16098447194867044
avg test loss is  2.9342545903186554
avg accuracy is  0.6209500001563361
compute_distance is  tensor(129.9391, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(129.9391, device='cuda:2')
test acc is  0.6209500001563361
test loss is 2.9342545903186554
test entropy is  0.16098447194867044
________________________________
diff is  tensor(0.8159, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(10.8263, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(117.8624, device='cuda:2')
diff is  tensor(0.0232, device='cuda:2')
diff is  tensor(0.3748, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(60.8123, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0200, device='cuda:2')
sum is tensor(0.0432, device='cuda:2')
sum is tensor(0.4181, device='cuda:2')
sum is tensor(1.2340, device='cuda:2')
sum is tensor(12.0603, device='cuda:2')
sum is tensor(129.9227, device='cuda:2')
ratio is tensor(0.5864, device='cuda:2')
threshold is tensor(117.8624, device='cuda:2')
cal diff is tensor(0.8159, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(10.8263, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(117.8624, device='cuda:2')
clipping
cal diff is tensor(0.0232, device='cuda:2')
discard
cal diff is tensor(0.3748, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1241, device='cuda:2')
test acc is  0.971550000156319
test loss is 0.10507218826495267
test entropy is  0.03784774829445383
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03784774829445383
avg test loss is  0.10507218826495267
avg accuracy is  0.971550000156319
compute_distance is  tensor(69.1241, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1609933307763737
avg test loss is  2.938403391571187
avg accuracy is  0.6203333334896696
compute_distance is  tensor(131.0922, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(131.0922, device='cuda:2')
test acc is  0.6203333334896696
test loss is 2.938403391571187
test entropy is  0.1609933307763737
________________________________
diff is  tensor(0.8210, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.0662, device='cuda:2')
diff is  tensor(0.0116, device='cuda:2')
diff is  tensor(118.7656, device='cuda:2')
diff is  tensor(0.0241, device='cuda:2')
diff is  tensor(0.3774, device='cuda:2')
diff is  tensor(0.0025, device='cuda:2')
threshold is  tensor(61.9654, device='cuda:2')
sum is tensor(0.0025, device='cuda:2')
sum is tensor(0.0091, device='cuda:2')
sum is tensor(0.0206, device='cuda:2')
sum is tensor(0.0447, device='cuda:2')
sum is tensor(0.4221, device='cuda:2')
sum is tensor(1.2431, device='cuda:2')
sum is tensor(12.3092, device='cuda:2')
sum is tensor(131.0748, device='cuda:2')
ratio is tensor(0.5819, device='cuda:2')
threshold is tensor(118.7656, device='cuda:2')
cal diff is tensor(0.8210, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.0662, device='cuda:2')
discard
cal diff is tensor(0.0116, device='cuda:2')
discard
cal diff is tensor(118.7656, device='cuda:2')
clipping
cal diff is tensor(0.0241, device='cuda:2')
discard
cal diff is tensor(0.3774, device='cuda:2')
discard
cal diff is tensor(0.0025, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1240, device='cuda:2')
test acc is  0.9727833334896523
test loss is 0.09920307552827169
test entropy is  0.03639427218666257
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03639427218666257
avg test loss is  0.09920307552827169
avg accuracy is  0.9727833334896523
compute_distance is  tensor(69.1240, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16099798597538395
avg test loss is  2.938489239925006
avg accuracy is  0.6202000001563363
compute_distance is  tensor(131.5148, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(131.5148, device='cuda:2')
test acc is  0.6202000001563363
test loss is 2.938489239925006
test entropy is  0.16099798597538395
________________________________
diff is  tensor(0.8221, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.1624, device='cuda:2')
diff is  tensor(0.0117, device='cuda:2')
diff is  tensor(119.0891, device='cuda:2')
diff is  tensor(0.0245, device='cuda:2')
diff is  tensor(0.3781, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(62.3880, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0209, device='cuda:2')
sum is tensor(0.0453, device='cuda:2')
sum is tensor(0.4234, device='cuda:2')
sum is tensor(1.2455, device='cuda:2')
sum is tensor(12.4079, device='cuda:2')
sum is tensor(131.4970, device='cuda:2')
ratio is tensor(0.5803, device='cuda:2')
threshold is tensor(119.0891, device='cuda:2')
cal diff is tensor(0.8221, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.1624, device='cuda:2')
discard
cal diff is tensor(0.0117, device='cuda:2')
discard
cal diff is tensor(119.0891, device='cuda:2')
clipping
cal diff is tensor(0.0245, device='cuda:2')
discard
cal diff is tensor(0.3781, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1240, device='cuda:2')
test acc is  0.973450000156319
test loss is 0.09703556366408668
test entropy is  0.035829635537099475
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.035829635537099475
avg test loss is  0.09703556366408668
avg accuracy is  0.973450000156319
compute_distance is  tensor(69.1240, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16101513655661648
avg test loss is  2.937501322803721
avg accuracy is  0.6201500001563361
compute_distance is  tensor(131.6944, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(131.6944, device='cuda:2')
test acc is  0.6201500001563361
test loss is 2.937501322803721
test entropy is  0.16101513655661648
________________________________
diff is  tensor(0.8221, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.2046, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(119.2256, device='cuda:2')
diff is  tensor(0.0247, device='cuda:2')
diff is  tensor(0.3781, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(62.5675, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0210, device='cuda:2')
sum is tensor(0.0456, device='cuda:2')
sum is tensor(0.4237, device='cuda:2')
sum is tensor(1.2458, device='cuda:2')
sum is tensor(12.4505, device='cuda:2')
sum is tensor(131.6761, device='cuda:2')
ratio is tensor(0.5796, device='cuda:2')
threshold is tensor(119.2256, device='cuda:2')
cal diff is tensor(0.8221, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.2046, device='cuda:2')
discard
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(119.2256, device='cuda:2')
clipping
cal diff is tensor(0.0247, device='cuda:2')
discard
cal diff is tensor(0.3781, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1239, device='cuda:2')
test acc is  0.9737666668229856
test loss is 0.09602057446087349
test entropy is  0.03555799068788489
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03555799068788489
avg test loss is  0.09602057446087349
avg accuracy is  0.9737666668229856
compute_distance is  tensor(69.1239, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1610197137270782
avg test loss is  2.9373543998961256
avg accuracy is  0.6201333334896695
compute_distance is  tensor(131.7937, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(131.7937, device='cuda:2')
test acc is  0.6201333334896695
test loss is 2.9373543998961256
test entropy is  0.1610197137270782
________________________________
diff is  tensor(0.8219, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.2263, device='cuda:2')
diff is  tensor(0.0118, device='cuda:2')
diff is  tensor(119.3034, device='cuda:2')
diff is  tensor(0.0247, device='cuda:2')
diff is  tensor(0.3779, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(62.6669, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0210, device='cuda:2')
sum is tensor(0.0457, device='cuda:2')
sum is tensor(0.4236, device='cuda:2')
sum is tensor(1.2455, device='cuda:2')
sum is tensor(12.4718, device='cuda:2')
sum is tensor(131.7752, device='cuda:2')
ratio is tensor(0.5793, device='cuda:2')
threshold is tensor(119.3034, device='cuda:2')
cal diff is tensor(0.8219, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.2263, device='cuda:2')
discard
cal diff is tensor(0.0118, device='cuda:2')
discard
cal diff is tensor(119.3034, device='cuda:2')
clipping
cal diff is tensor(0.0247, device='cuda:2')
discard
cal diff is tensor(0.3779, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(69.1238, device='cuda:2')
test acc is  0.9739500001563188
test loss is 0.09545189975143584
test entropy is  0.035401611424038255
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.035401611424038255
avg test loss is  0.09545189975143584
avg accuracy is  0.9739500001563188
compute_distance is  tensor(69.1238, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16099522542804162
avg test loss is  2.9377640916594565
avg accuracy is  0.6200000001563362
compute_distance is  tensor(131.8580, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 71 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.17% 


 | Global Training Round : 72 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004263584967702627
attack res is False
len of model dicts is  10
compute distance is  tensor(16.8466, device='cuda:2')
compute distance is  tensor(55.7797, device='cuda:2')
compute distance is  tensor(85.1740, device='cuda:2')
compute distance is  tensor(101.8193, device='cuda:2')
compute distance is  tensor(39.8547, device='cuda:2')
compute distance is  tensor(48.3134, device='cuda:2')
compute distance is  tensor(55.7112, device='cuda:2')
compute distance is  tensor(49.6341, device='cuda:2')
compute distance is  tensor(49.2605, device='cuda:2')
compute distance is  tensor(35.7424, device='cuda:2')
calculated distance threshold is  tensor(74.3037, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8553666668229898
====================
====================
iteration is  0
round is  1
accuracy is  0.8304000001563242
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.77783333348966
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.6843333334896652
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7812500001563264
====================
====================
iteration is  1
round is  2
accuracy is  0.7407500001563285
====================
________________________________
test distance is  tensor(4713.4263, device='cuda:2')
test acc is  0.6843333334896652
test loss is 2.6332539215779254
test entropy is  0.12546698374749182
________________________________
diff is  tensor(49.1661, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3949, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.5068, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5505, device='cuda:2', dtype=torch.float64)
diff is  tensor(4007.8956, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2533, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.4233, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2353, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4639.1226, device='cuda:2')
sum is tensor(0.2353, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6303, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1808, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4341, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8574, device='cuda:2', dtype=torch.float64)
sum is tensor(75.0235, device='cuda:2', dtype=torch.float64)
sum is tensor(705.5304, device='cuda:2', dtype=torch.float64)
sum is tensor(4713.4260, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0185, device='cuda:2', dtype=torch.float64)
threshold is tensor(4007.8956, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.1661, device='cuda:2')
discard
cal diff is tensor(0.3949, device='cuda:2')
discard
cal diff is tensor(630.5068, device='cuda:2')
discard
cal diff is tensor(0.5505, device='cuda:2')
discard
cal diff is tensor(4007.8955, device='cuda:2')
discard
cal diff is tensor(2.2533, device='cuda:2')
discard
cal diff is tensor(22.4233, device='cuda:2')
discard
cal diff is tensor(0.2353, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.023340093848609668
test entropy is  0.01118801013132006
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01118801013132006
avg test loss is  0.023340093848609668
avg accuracy is  0.993466666822985
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12475612025652359
avg test loss is  1.5974449063224325
avg accuracy is  0.7481166668229946
compute_distance is  tensor(86.9960, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(86.9960, device='cuda:2')
test acc is  0.7481166668229946
test loss is 1.5974449063224325
test entropy is  0.12475612025652359
________________________________
diff is  tensor(0.7628, device='cuda:2')
diff is  tensor(0.0059, device='cuda:2')
diff is  tensor(11.7639, device='cuda:2')
diff is  tensor(0.0125, device='cuda:2')
diff is  tensor(73.8183, device='cuda:2')
diff is  tensor(0.0432, device='cuda:2')
diff is  tensor(0.5907, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(12.6922, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0103, device='cuda:2')
sum is tensor(0.0228, device='cuda:2')
sum is tensor(0.0660, device='cuda:2')
sum is tensor(0.6567, device='cuda:2')
sum is tensor(1.4195, device='cuda:2')
sum is tensor(13.1834, device='cuda:2')
ratio is tensor(0.0418, device='cuda:2')
threshold is tensor(11.7639, device='cuda:2')
cal diff is tensor(0.7628, device='cuda:2')
discard
cal diff is tensor(0.0059, device='cuda:2')
discard
cal diff is tensor(11.7639, device='cuda:2')
clipping
cal diff is tensor(0.0125, device='cuda:2')
discard
cal diff is tensor(73.8183, device='cuda:2')
clipping
cal diff is tensor(0.0432, device='cuda:2')
discard
cal diff is tensor(0.5907, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(3.5719, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.023547407148697932
test entropy is  0.0113328699256452
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0113328699256452
avg test loss is  0.023547407148697932
avg accuracy is  0.993466666822985
compute_distance is  tensor(3.5719, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12508394129510755
avg test loss is  1.60696034533764
avg accuracy is  0.7464333334896615
compute_distance is  tensor(88.8703, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(88.8703, device='cuda:2')
test acc is  0.7464333334896615
test loss is 1.60696034533764
test entropy is  0.12508394129510755
________________________________
diff is  tensor(0.7377, device='cuda:2')
diff is  tensor(0.0058, device='cuda:2')
diff is  tensor(12.1576, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(75.3384, device='cuda:2')
diff is  tensor(0.0414, device='cuda:2')
diff is  tensor(0.5772, device='cuda:2')
diff is  tensor(0.0042, device='cuda:2')
threshold is  tensor(14.5666, device='cuda:2')
sum is tensor(0.0042, device='cuda:2')
sum is tensor(0.0100, device='cuda:2')
sum is tensor(0.0225, device='cuda:2')
sum is tensor(0.0638, device='cuda:2')
sum is tensor(0.6411, device='cuda:2')
sum is tensor(1.3787, device='cuda:2')
sum is tensor(13.5363, device='cuda:2')
sum is tensor(88.8747, device='cuda:2')
ratio is tensor(0.9863, device='cuda:2')
threshold is tensor(75.3384, device='cuda:2')
cal diff is tensor(0.7377, device='cuda:2')
discard
cal diff is tensor(0.0058, device='cuda:2')
discard
cal diff is tensor(12.1576, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(75.3384, device='cuda:2')
clipping
cal diff is tensor(0.0414, device='cuda:2')
discard
cal diff is tensor(0.5772, device='cuda:2')
discard
cal diff is tensor(0.0042, device='cuda:2')
discard
________________________________
test distance is  tensor(74.3123, device='cuda:2')
test acc is  0.9302000001563203
test loss is 0.2602133400780933
test entropy is  0.06939381148133959
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.3082, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0086, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1825, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.3082, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(13.5694, device='cuda:2')
test acc is  0.9928500001563184
test loss is 0.02525404688683673
test entropy is  0.012173280736670542
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012173280736670542
avg test loss is  0.02525404688683673
avg accuracy is  0.9928500001563184
compute_distance is  tensor(13.5694, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12572654217148005
avg test loss is  1.6344119694822632
avg accuracy is  0.7425333334896617
compute_distance is  tensor(94.9579, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(94.9579, device='cuda:2')
test acc is  0.7425333334896617
test loss is 1.6344119694822632
test entropy is  0.12572654217148005
________________________________
diff is  tensor(0.7062, device='cuda:2')
diff is  tensor(0.0060, device='cuda:2')
diff is  tensor(11.6980, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(81.9481, device='cuda:2')
diff is  tensor(0.0376, device='cuda:2')
diff is  tensor(0.5460, device='cuda:2')
diff is  tensor(0.0038, device='cuda:2')
threshold is  tensor(20.6542, device='cuda:2')
sum is tensor(0.0038, device='cuda:2')
sum is tensor(0.0098, device='cuda:2')
sum is tensor(0.0224, device='cuda:2')
sum is tensor(0.0600, device='cuda:2')
sum is tensor(0.6060, device='cuda:2')
sum is tensor(1.3122, device='cuda:2')
sum is tensor(13.0103, device='cuda:2')
sum is tensor(94.9584, device='cuda:2')
ratio is tensor(0.9067, device='cuda:2')
threshold is tensor(81.9481, device='cuda:2')
cal diff is tensor(0.7062, device='cuda:2')
discard
cal diff is tensor(0.0060, device='cuda:2')
discard
cal diff is tensor(11.6980, device='cuda:2')
discard
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(81.9481, device='cuda:2')
clipping
cal diff is tensor(0.0376, device='cuda:2')
discard
cal diff is tensor(0.5460, device='cuda:2')
discard
cal diff is tensor(0.0038, device='cuda:2')
discard
________________________________
test distance is  tensor(74.3102, device='cuda:2')
test acc is  0.9468333334896532
test loss is 0.1916029883392487
test entropy is  0.06106214242766915
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.3044, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0064, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.4169, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.3044, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(30.9813, device='cuda:2')
test acc is  0.991116666822985
test loss is 0.03205093105461984
test entropy is  0.015652011791275875
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.015652011791275875
avg test loss is  0.03205093105461984
avg accuracy is  0.991116666822985
compute_distance is  tensor(30.9813, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12568111239926522
avg test loss is  1.6824245273050216
avg accuracy is  0.736933333489662
compute_distance is  tensor(105.3757, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(105.3757, device='cuda:2')
test acc is  0.736933333489662
test loss is 1.6824245273050216
test entropy is  0.12568111239926522
________________________________
diff is  tensor(0.6599, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.5500, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(92.6087, device='cuda:2')
diff is  tensor(0.0322, device='cuda:2')
diff is  tensor(0.4977, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(31.0719, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0096, device='cuda:2')
sum is tensor(0.0220, device='cuda:2')
sum is tensor(0.0542, device='cuda:2')
sum is tensor(0.5520, device='cuda:2')
sum is tensor(1.2119, device='cuda:2')
sum is tensor(12.7619, device='cuda:2')
sum is tensor(105.3706, device='cuda:2')
ratio is tensor(0.8023, device='cuda:2')
threshold is tensor(92.6087, device='cuda:2')
cal diff is tensor(0.6599, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.5500, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(92.6087, device='cuda:2')
clipping
cal diff is tensor(0.0322, device='cuda:2')
discard
cal diff is tensor(0.4977, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(74.3070, device='cuda:2')
test acc is  0.9631500001563192
test loss is 0.12857047044097442
test entropy is  0.04923868359901559
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(74.2989, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0033, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7692, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(74.2989, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(57.1593, device='cuda:2')
test acc is  0.982583333489652
test loss is 0.06006136773754476
test entropy is  0.02774231242842097
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02774231242842097
avg test loss is  0.06006136773754476
avg accuracy is  0.982583333489652
compute_distance is  tensor(57.1593, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12455467776512541
avg test loss is  1.753045251565193
avg accuracy is  0.7304833334896622
compute_distance is  tensor(122.1597, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(122.1597, device='cuda:2')
test acc is  0.7304833334896622
test loss is 1.753045251565193
test entropy is  0.12455467776512541
________________________________
diff is  tensor(0.6584, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(11.0679, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(109.9400, device='cuda:2')
diff is  tensor(0.0261, device='cuda:2')
diff is  tensor(0.4355, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(47.8560, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0087, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0462, device='cuda:2')
sum is tensor(0.4817, device='cuda:2')
sum is tensor(1.1401, device='cuda:2')
sum is tensor(12.2079, device='cuda:2')
sum is tensor(122.1480, device='cuda:2')
ratio is tensor(0.6758, device='cuda:2')
threshold is tensor(109.9400, device='cuda:2')
cal diff is tensor(0.6584, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(11.0679, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(109.9400, device='cuda:2')
clipping
cal diff is tensor(0.0261, device='cuda:2')
discard
cal diff is tensor(0.4355, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(74.3030, device='cuda:2')
test acc is  0.9757666668229855
test loss is 0.08474306810304953
test entropy is  0.037491071196933234
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.037491071196933234
avg test loss is  0.08474306810304953
avg accuracy is  0.9757666668229855
compute_distance is  tensor(74.3030, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12405966561851597
avg test loss is  1.8010910279842327
avg accuracy is  0.7273166668229958
compute_distance is  tensor(134.5963, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(134.5963, device='cuda:2')
test acc is  0.7273166668229958
test loss is 1.8010910279842327
test entropy is  0.12405966561851597
________________________________
diff is  tensor(0.7097, device='cuda:2')
diff is  tensor(0.0060, device='cuda:2')
diff is  tensor(10.8723, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(122.5634, device='cuda:2')
diff is  tensor(0.0230, device='cuda:2')
diff is  tensor(0.3928, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(60.2926, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0081, device='cuda:2')
sum is tensor(0.0191, device='cuda:2')
sum is tensor(0.0421, device='cuda:2')
sum is tensor(0.4349, device='cuda:2')
sum is tensor(1.1446, device='cuda:2')
sum is tensor(12.0169, device='cuda:2')
sum is tensor(134.5803, device='cuda:2')
ratio is tensor(0.6061, device='cuda:2')
threshold is tensor(122.5634, device='cuda:2')
cal diff is tensor(0.7097, device='cuda:2')
discard
cal diff is tensor(0.0060, device='cuda:2')
discard
cal diff is tensor(10.8723, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(122.5634, device='cuda:2')
clipping
cal diff is tensor(0.0230, device='cuda:2')
discard
cal diff is tensor(0.3928, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(74.3007, device='cuda:2')
test acc is  0.980183333489652
test loss is 0.06699810065395241
test entropy is  0.03157467091439487
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03157467091439487
avg test loss is  0.06699810065395241
avg accuracy is  0.980183333489652
compute_distance is  tensor(74.3007, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12427427044618866
avg test loss is  1.80542187802573
avg accuracy is  0.7267000001563292
compute_distance is  tensor(136.0704, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.0704, device='cuda:2')
test acc is  0.7267000001563292
test loss is 1.80542187802573
test entropy is  0.12427427044618866
________________________________
diff is  tensor(0.7042, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(11.1630, device='cuda:2')
diff is  tensor(0.0115, device='cuda:2')
diff is  tensor(123.7522, device='cuda:2')
diff is  tensor(0.0238, device='cuda:2')
diff is  tensor(0.3901, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(61.7667, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0200, device='cuda:2')
sum is tensor(0.0438, device='cuda:2')
sum is tensor(0.4338, device='cuda:2')
sum is tensor(1.1381, device='cuda:2')
sum is tensor(12.3011, device='cuda:2')
sum is tensor(136.0533, device='cuda:2')
ratio is tensor(0.6003, device='cuda:2')
threshold is tensor(123.7522, device='cuda:2')
cal diff is tensor(0.7042, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(11.1630, device='cuda:2')
discard
cal diff is tensor(0.0115, device='cuda:2')
discard
cal diff is tensor(123.7522, device='cuda:2')
clipping
cal diff is tensor(0.0238, device='cuda:2')
discard
cal diff is tensor(0.3901, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(74.3005, device='cuda:2')
test acc is  0.9812000001563187
test loss is 0.06337268875240955
test entropy is  0.030233989996926936
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.030233989996926936
avg test loss is  0.06337268875240955
avg accuracy is  0.9812000001563187
compute_distance is  tensor(74.3005, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1243847869495466
avg test loss is  1.8078770801456752
avg accuracy is  0.7264166668229959
compute_distance is  tensor(136.6644, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.6644, device='cuda:2')
test acc is  0.7264166668229959
test loss is 1.8078770801456752
test entropy is  0.1243847869495466
________________________________
diff is  tensor(0.7036, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.2942, device='cuda:2')
diff is  tensor(0.0117, device='cuda:2')
diff is  tensor(124.2145, device='cuda:2')
diff is  tensor(0.0242, device='cuda:2')
diff is  tensor(0.3897, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(62.3607, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0086, device='cuda:2')
sum is tensor(0.0203, device='cuda:2')
sum is tensor(0.0445, device='cuda:2')
sum is tensor(0.4342, device='cuda:2')
sum is tensor(1.1379, device='cuda:2')
sum is tensor(12.4320, device='cuda:2')
sum is tensor(136.6465, device='cuda:2')
ratio is tensor(0.5980, device='cuda:2')
threshold is tensor(124.2145, device='cuda:2')
cal diff is tensor(0.7036, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.2942, device='cuda:2')
discard
cal diff is tensor(0.0117, device='cuda:2')
discard
cal diff is tensor(124.2145, device='cuda:2')
clipping
cal diff is tensor(0.0242, device='cuda:2')
discard
cal diff is tensor(0.3897, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 72 global rounds:
Train Accuracy: 99.00% 

Test Accuracy: 99.18% 


 | Global Training Round : 73 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.0042851450853049755
attack res is False
len of model dicts is  10
compute distance is  tensor(17.6635, device='cuda:2')
compute distance is  tensor(70.2694, device='cuda:2')
compute distance is  tensor(83.7941, device='cuda:2')
compute distance is  tensor(91.0596, device='cuda:2')
compute distance is  tensor(50.9387, device='cuda:2')
compute distance is  tensor(65.7418, device='cuda:2')
compute distance is  tensor(45.6517, device='cuda:2')
compute distance is  tensor(52.0227, device='cuda:2')
compute distance is  tensor(47.2000, device='cuda:2')
compute distance is  tensor(46.0209, device='cuda:2')
calculated distance threshold is  tensor(67.2927, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.6784000001563322
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8298500001563242
====================
====================
iteration is  0
round is  2
accuracy is  0.8457666668229902
====================
====================
iteration is  1
round is  0
accuracy is  0.6504000001563341
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7440166668229948
====================
====================
iteration is  1
round is  2
accuracy is  0.7796000001563266
====================
________________________________
test distance is  tensor(4714.4956, device='cuda:2')
test acc is  0.6504000001563341
test loss is 2.773693756635255
test entropy is  0.17205858643629404
________________________________
diff is  tensor(51.0339, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4224, device='cuda:2', dtype=torch.float64)
diff is  tensor(630.6516, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5629, device='cuda:2', dtype=torch.float64)
diff is  tensor(4007.1149, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2003, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3248, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1851, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4647.2031, device='cuda:2')
sum is tensor(0.1851, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6075, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1704, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3707, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6955, device='cuda:2', dtype=torch.float64)
sum is tensor(76.7294, device='cuda:2', dtype=torch.float64)
sum is tensor(707.3810, device='cuda:2', dtype=torch.float64)
sum is tensor(4714.4959, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0168, device='cuda:2', dtype=torch.float64)
threshold is tensor(4007.1149, device='cuda:2', dtype=torch.float64)
cal diff is tensor(51.0339, device='cuda:2')
discard
cal diff is tensor(0.4224, device='cuda:2')
discard
cal diff is tensor(630.6516, device='cuda:2')
discard
cal diff is tensor(0.5629, device='cuda:2')
discard
cal diff is tensor(4007.1150, device='cuda:2')
clipping
cal diff is tensor(2.2003, device='cuda:2')
discard
cal diff is tensor(22.3248, device='cuda:2')
discard
cal diff is tensor(0.1851, device='cuda:2')
discard
________________________________
test distance is  tensor(67.3030, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.02325705746739892
test entropy is  0.011212458653407822
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.2927, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(67.3029, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(67.2927, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.2927, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934833334896517
test loss is 0.02326862158895474
test entropy is  0.011196491533263606
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011196491533263606
avg test loss is  0.02326862158895474
avg accuracy is  0.9934833334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20563134808403088
avg test loss is  1.7378506706848835
avg accuracy is  0.6977333334896643
compute_distance is  tensor(92.4474, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.4474, device='cuda:2')
test acc is  0.6977333334896643
test loss is 1.7378506706848835
test entropy is  0.20563134808403088
________________________________
diff is  tensor(0.9225, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(13.8605, device='cuda:2')
diff is  tensor(0.0155, device='cuda:2')
diff is  tensor(77.0131, device='cuda:2')
diff is  tensor(0.0480, device='cuda:2')
diff is  tensor(0.5783, device='cuda:2')
diff is  tensor(0.0047, device='cuda:2')
threshold is  tensor(25.1547, device='cuda:2')
sum is tensor(0.0047, device='cuda:2')
sum is tensor(0.0121, device='cuda:2')
sum is tensor(0.0276, device='cuda:2')
sum is tensor(0.0756, device='cuda:2')
sum is tensor(0.6539, device='cuda:2')
sum is tensor(1.5764, device='cuda:2')
sum is tensor(15.4369, device='cuda:2')
sum is tensor(92.4500, device='cuda:2')
ratio is tensor(0.8738, device='cuda:2')
threshold is tensor(77.0131, device='cuda:2')
cal diff is tensor(0.9225, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(13.8605, device='cuda:2')
discard
cal diff is tensor(0.0155, device='cuda:2')
discard
cal diff is tensor(77.0131, device='cuda:2')
clipping
cal diff is tensor(0.0480, device='cuda:2')
discard
cal diff is tensor(0.5783, device='cuda:2')
discard
cal diff is tensor(0.0047, device='cuda:2')
discard
________________________________
test distance is  tensor(67.3000, device='cuda:2')
test acc is  0.9723333334896523
test loss is 0.09978143481196412
test entropy is  0.045885206379490576
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.2957, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0073, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3275, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.2957, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(22.0460, device='cuda:2')
test acc is  0.9928000001563184
test loss is 0.026829932495446972
test entropy is  0.013456303848200098
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.013456303848200098
avg test loss is  0.026829932495446972
avg accuracy is  0.9928000001563184
compute_distance is  tensor(22.0460, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19827363314404925
avg test loss is  1.859636583816268
avg accuracy is  0.6928000001563314
compute_distance is  tensor(104.7917, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(104.7917, device='cuda:2')
test acc is  0.6928000001563314
test loss is 1.859636583816268
test entropy is  0.19827363314404925
________________________________
diff is  tensor(0.8619, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(13.4263, device='cuda:2')
diff is  tensor(0.0149, device='cuda:2')
diff is  tensor(89.9331, device='cuda:2')
diff is  tensor(0.0394, device='cuda:2')
diff is  tensor(0.5024, device='cuda:2')
diff is  tensor(0.0039, device='cuda:2')
threshold is  tensor(37.4990, device='cuda:2')
sum is tensor(0.0039, device='cuda:2')
sum is tensor(0.0109, device='cuda:2')
sum is tensor(0.0258, device='cuda:2')
sum is tensor(0.0652, device='cuda:2')
sum is tensor(0.5676, device='cuda:2')
sum is tensor(1.4295, device='cuda:2')
sum is tensor(14.8558, device='cuda:2')
sum is tensor(104.7890, device='cuda:2')
ratio is tensor(0.7482, device='cuda:2')
threshold is tensor(89.9331, device='cuda:2')
cal diff is tensor(0.8619, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(13.4263, device='cuda:2')
discard
cal diff is tensor(0.0149, device='cuda:2')
discard
cal diff is tensor(89.9331, device='cuda:2')
clipping
cal diff is tensor(0.0394, device='cuda:2')
discard
cal diff is tensor(0.5024, device='cuda:2')
discard
cal diff is tensor(0.0039, device='cuda:2')
discard
________________________________
test distance is  tensor(67.2964, device='cuda:2')
test acc is  0.9781833334896521
test loss is 0.07737697346792455
test entropy is  0.03787312128619022
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.2905, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0037, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7195, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.2905, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(48.4200, device='cuda:2')
test acc is  0.9881166668229852
test loss is 0.04191650962992262
test entropy is  0.021950130580033898
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.021950130580033898
avg test loss is  0.04191650962992262
avg accuracy is  0.9881166668229852
compute_distance is  tensor(48.4200, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19294480815021467
avg test loss is  1.9561864607878077
avg accuracy is  0.687433333489665
compute_distance is  tensor(120.1645, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(120.1645, device='cuda:2')
test acc is  0.687433333489665
test loss is 1.9561864607878077
test entropy is  0.19294480815021467
________________________________
diff is  tensor(0.7867, device='cuda:2')
diff is  tensor(0.0073, device='cuda:2')
diff is  tensor(12.4784, device='cuda:2')
diff is  tensor(0.0137, device='cuda:2')
diff is  tensor(106.4054, device='cuda:2')
diff is  tensor(0.0318, device='cuda:2')
diff is  tensor(0.4301, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(52.8718, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0105, device='cuda:2')
sum is tensor(0.0242, device='cuda:2')
sum is tensor(0.0559, device='cuda:2')
sum is tensor(0.4860, device='cuda:2')
sum is tensor(1.2727, device='cuda:2')
sum is tensor(13.7511, device='cuda:2')
sum is tensor(120.1565, device='cuda:2')
ratio is tensor(0.6323, device='cuda:2')
threshold is tensor(106.4054, device='cuda:2')
cal diff is tensor(0.7867, device='cuda:2')
discard
cal diff is tensor(0.0073, device='cuda:2')
discard
cal diff is tensor(12.4784, device='cuda:2')
discard
cal diff is tensor(0.0137, device='cuda:2')
discard
cal diff is tensor(106.4054, device='cuda:2')
clipping
cal diff is tensor(0.0318, device='cuda:2')
discard
cal diff is tensor(0.4301, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(67.2934, device='cuda:2')
test acc is  0.9819000001563187
test loss is 0.063411419537639
test entropy is  0.03248542368292469
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.2851, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0006, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.6504, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.2851, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(43.7709, device='cuda:2')
test acc is  0.9904333334896517
test loss is 0.03414720055897374
test entropy is  0.018439525127459246
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.018439525127459246
avg test loss is  0.03414720055897374
avg accuracy is  0.9904333334896517
compute_distance is  tensor(43.7709, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19363855186905435
avg test loss is  1.9488665945748531
avg accuracy is  0.6881166668229982
compute_distance is  tensor(119.1180, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(119.1180, device='cuda:2')
test acc is  0.6881166668229982
test loss is 1.9488665945748531
test entropy is  0.19363855186905435
________________________________
diff is  tensor(0.8084, device='cuda:2')
diff is  tensor(0.0073, device='cuda:2')
diff is  tensor(13.0270, device='cuda:2')
diff is  tensor(0.0144, device='cuda:2')
diff is  tensor(104.7757, device='cuda:2')
diff is  tensor(0.0338, device='cuda:2')
diff is  tensor(0.4396, device='cuda:2')
diff is  tensor(0.0033, device='cuda:2')
threshold is  tensor(51.8253, device='cuda:2')
sum is tensor(0.0033, device='cuda:2')
sum is tensor(0.0107, device='cuda:2')
sum is tensor(0.0251, device='cuda:2')
sum is tensor(0.0589, device='cuda:2')
sum is tensor(0.4985, device='cuda:2')
sum is tensor(1.3069, device='cuda:2')
sum is tensor(14.3339, device='cuda:2')
sum is tensor(119.1096, device='cuda:2')
ratio is tensor(0.6422, device='cuda:2')
threshold is tensor(104.7757, device='cuda:2')
cal diff is tensor(0.8084, device='cuda:2')
discard
cal diff is tensor(0.0073, device='cuda:2')
discard
cal diff is tensor(13.0270, device='cuda:2')
discard
cal diff is tensor(0.0144, device='cuda:2')
discard
cal diff is tensor(104.7757, device='cuda:2')
clipping
cal diff is tensor(0.0338, device='cuda:2')
discard
cal diff is tensor(0.4396, device='cuda:2')
discard
cal diff is tensor(0.0033, device='cuda:2')
discard
________________________________
test distance is  tensor(67.2936, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.061443564937748274
test entropy is  0.031610693274313637
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.2845, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0009, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.3071, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.2845, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(20.6712, device='cuda:2')
test acc is  0.993116666822985
test loss is 0.0250053355033141
test entropy is  0.012812472875784206
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012812472875784206
avg test loss is  0.0250053355033141
avg accuracy is  0.993116666822985
compute_distance is  tensor(20.6712, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19837428452268338
avg test loss is  1.8671642593356337
avg accuracy is  0.692716666822998
compute_distance is  tensor(105.2734, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(105.2734, device='cuda:2')
test acc is  0.692716666822998
test loss is 1.8671642593356337
test entropy is  0.19837428452268338
________________________________
diff is  tensor(0.8639, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(13.7110, device='cuda:2')
diff is  tensor(0.0153, device='cuda:2')
diff is  tensor(90.1203, device='cuda:2')
diff is  tensor(0.0412, device='cuda:2')
diff is  tensor(0.5065, device='cuda:2')
diff is  tensor(0.0040, device='cuda:2')
threshold is  tensor(37.9807, device='cuda:2')
sum is tensor(0.0040, device='cuda:2')
sum is tensor(0.0110, device='cuda:2')
sum is tensor(0.0263, device='cuda:2')
sum is tensor(0.0674, device='cuda:2')
sum is tensor(0.5739, device='cuda:2')
sum is tensor(1.4378, device='cuda:2')
sum is tensor(15.1488, device='cuda:2')
sum is tensor(105.2691, device='cuda:2')
ratio is tensor(0.7467, device='cuda:2')
threshold is tensor(90.1203, device='cuda:2')
cal diff is tensor(0.8639, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(13.7110, device='cuda:2')
discard
cal diff is tensor(0.0153, device='cuda:2')
discard
cal diff is tensor(90.1203, device='cuda:2')
clipping
cal diff is tensor(0.0412, device='cuda:2')
discard
cal diff is tensor(0.5065, device='cuda:2')
discard
cal diff is tensor(0.0040, device='cuda:2')
discard
________________________________
test distance is  tensor(67.2963, device='cuda:2')
test acc is  0.9793166668229856
test loss is 0.07371866824808
test entropy is  0.03620814227469033
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.2887, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0036, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7271, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.2887, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(48.9307, device='cuda:2')
test acc is  0.9881833334896518
test loss is 0.041382654982867625
test entropy is  0.021670359726951634
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.021670359726951634
avg test loss is  0.041382654982867625
avg accuracy is  0.9881833334896518
compute_distance is  tensor(48.9307, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19286919384400472
avg test loss is  1.9625488154923738
avg accuracy is  0.6873500001563316
compute_distance is  tensor(121.0548, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(121.0548, device='cuda:2')
test acc is  0.6873500001563316
test loss is 1.9625488154923738
test entropy is  0.19286919384400472
________________________________
diff is  tensor(0.7861, device='cuda:2')
diff is  tensor(0.0073, device='cuda:2')
diff is  tensor(12.5443, device='cuda:2')
diff is  tensor(0.0137, device='cuda:2')
diff is  tensor(107.2338, device='cuda:2')
diff is  tensor(0.0318, device='cuda:2')
diff is  tensor(0.4258, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(53.7621, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0105, device='cuda:2')
sum is tensor(0.0242, device='cuda:2')
sum is tensor(0.0560, device='cuda:2')
sum is tensor(0.4818, device='cuda:2')
sum is tensor(1.2679, device='cuda:2')
sum is tensor(13.8122, device='cuda:2')
sum is tensor(121.0460, device='cuda:2')
ratio is tensor(0.6275, device='cuda:2')
threshold is tensor(107.2338, device='cuda:2')
cal diff is tensor(0.7861, device='cuda:2')
discard
cal diff is tensor(0.0073, device='cuda:2')
discard
cal diff is tensor(12.5443, device='cuda:2')
discard
cal diff is tensor(0.0137, device='cuda:2')
discard
cal diff is tensor(107.2338, device='cuda:2')
clipping
cal diff is tensor(0.0318, device='cuda:2')
discard
cal diff is tensor(0.4258, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(67.2932, device='cuda:2')
test acc is  0.9822666668229854
test loss is 0.06188292890860959
test entropy is  0.03178759149250836
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(67.2841, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0005, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.8697, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(67.2841, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 73 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.20% 


 | Global Training Round : 74 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004189166706055403
attack res is False
len of model dicts is  10
compute distance is  tensor(13.3459, device='cuda:2')
compute distance is  tensor(52.2162, device='cuda:2')
compute distance is  tensor(84.9258, device='cuda:2')
compute distance is  tensor(68.9389, device='cuda:2')
compute distance is  tensor(30.1137, device='cuda:2')
compute distance is  tensor(66.9393, device='cuda:2')
compute distance is  tensor(71.6526, device='cuda:2')
compute distance is  tensor(28.4859, device='cuda:2')
compute distance is  tensor(57.4516, device='cuda:2')
compute distance is  tensor(45.9107, device='cuda:2')
calculated distance threshold is  tensor(61.7470, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8954000001563216
====================
====================
iteration is  0
round is  1
accuracy is  0.8768833334896557
====================
====================
iteration is  0
round is  2
accuracy is  0.8823500001563221
====================
====================
iteration is  1
round is  0
accuracy is  0.7451000001563282
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.662816666823
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7683000001563272
====================
====================
iteration is  2
round is  0
accuracy is  0.6339000001563352
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6158000001563365
====================
succ_min + 1
________________________________
test distance is  tensor(4707.8149, device='cuda:2')
test acc is  0.6158000001563365
test loss is 3.927750771487954
test entropy is  0.153767336231432
________________________________
diff is  tensor(47.7378, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3642, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.4281, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5735, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.0011, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2338, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2571, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2192, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4646.0679, device='cuda:2')
sum is tensor(0.2192, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5834, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1569, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3907, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6478, device='cuda:2', dtype=torch.float64)
sum is tensor(73.3857, device='cuda:2', dtype=torch.float64)
sum is tensor(702.8138, device='cuda:2', dtype=torch.float64)
sum is tensor(4707.8149, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0154, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.0011, device='cuda:2', dtype=torch.float64)
cal diff is tensor(47.7378, device='cuda:2')
discard
cal diff is tensor(0.3642, device='cuda:2')
discard
cal diff is tensor(629.4281, device='cuda:2')
discard
cal diff is tensor(0.5735, device='cuda:2')
discard
cal diff is tensor(4005.0010, device='cuda:2')
discard
cal diff is tensor(2.2338, device='cuda:2')
discard
cal diff is tensor(22.2571, device='cuda:2')
discard
cal diff is tensor(0.2192, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934333334896517
test loss is 0.023300681121996597
test entropy is  0.011229976394553542
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011229976394553542
avg test loss is  0.023300681121996597
avg accuracy is  0.9934333334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1497203267292618
avg test loss is  2.8438136925194053
avg accuracy is  0.6569833334896669
compute_distance is  tensor(90.5487, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(90.5487, device='cuda:2')
test acc is  0.6569833334896669
test loss is 2.8438136925194053
test entropy is  0.1497203267292618
________________________________
diff is  tensor(0.8590, device='cuda:2')
diff is  tensor(0.0083, device='cuda:2')
diff is  tensor(13.1307, device='cuda:2')
diff is  tensor(0.0142, device='cuda:2')
diff is  tensor(75.9313, device='cuda:2')
diff is  tensor(0.0459, device='cuda:2')
diff is  tensor(0.5556, device='cuda:2')
diff is  tensor(0.0045, device='cuda:2')
threshold is  tensor(28.8017, device='cuda:2')
sum is tensor(0.0045, device='cuda:2')
sum is tensor(0.0128, device='cuda:2')
sum is tensor(0.0269, device='cuda:2')
sum is tensor(0.0729, device='cuda:2')
sum is tensor(0.6285, device='cuda:2')
sum is tensor(1.4875, device='cuda:2')
sum is tensor(14.6181, device='cuda:2')
sum is tensor(90.5494, device='cuda:2')
ratio is tensor(0.8132, device='cuda:2')
threshold is tensor(75.9313, device='cuda:2')
cal diff is tensor(0.8590, device='cuda:2')
discard
cal diff is tensor(0.0083, device='cuda:2')
discard
cal diff is tensor(13.1307, device='cuda:2')
discard
cal diff is tensor(0.0142, device='cuda:2')
discard
cal diff is tensor(75.9313, device='cuda:2')
clipping
cal diff is tensor(0.0459, device='cuda:2')
discard
cal diff is tensor(0.5556, device='cuda:2')
discard
cal diff is tensor(0.0045, device='cuda:2')
discard
________________________________
test distance is  tensor(61.7547, device='cuda:2')
test acc is  0.9587666668229862
test loss is 0.15423762785152098
test entropy is  0.05280106356116766
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(61.7481, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0077, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2795, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(61.7481, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(17.2639, device='cuda:2')
test acc is  0.9924500001563183
test loss is 0.026908830618988973
test entropy is  0.013191530970870788
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.013191530970870788
avg test loss is  0.026908830618988973
avg accuracy is  0.9924500001563183
compute_distance is  tensor(17.2639, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15193616578192598
avg test loss is  2.901714422364733
avg accuracy is  0.6541666668230004
compute_distance is  tensor(99.5467, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(99.5467, device='cuda:2')
test acc is  0.6541666668230004
test loss is 2.901714422364733
test entropy is  0.15193616578192598
________________________________
diff is  tensor(0.8029, device='cuda:2')
diff is  tensor(0.0075, device='cuda:2')
diff is  tensor(12.8395, device='cuda:2')
diff is  tensor(0.0139, device='cuda:2')
diff is  tensor(85.3368, device='cuda:2')
diff is  tensor(0.0392, device='cuda:2')
diff is  tensor(0.4991, device='cuda:2')
diff is  tensor(0.0038, device='cuda:2')
threshold is  tensor(37.7997, device='cuda:2')
sum is tensor(0.0038, device='cuda:2')
sum is tensor(0.0113, device='cuda:2')
sum is tensor(0.0252, device='cuda:2')
sum is tensor(0.0645, device='cuda:2')
sum is tensor(0.5636, device='cuda:2')
sum is tensor(1.3665, device='cuda:2')
sum is tensor(14.2060, device='cuda:2')
sum is tensor(99.5428, device='cuda:2')
ratio is tensor(0.7235, device='cuda:2')
threshold is tensor(85.3368, device='cuda:2')
cal diff is tensor(0.8029, device='cuda:2')
discard
cal diff is tensor(0.0075, device='cuda:2')
discard
cal diff is tensor(12.8395, device='cuda:2')
discard
cal diff is tensor(0.0139, device='cuda:2')
discard
cal diff is tensor(85.3368, device='cuda:2')
clipping
cal diff is tensor(0.0392, device='cuda:2')
discard
cal diff is tensor(0.4991, device='cuda:2')
discard
cal diff is tensor(0.0038, device='cuda:2')
discard
________________________________
test distance is  tensor(61.7517, device='cuda:2')
test acc is  0.9681833334896525
test loss is 0.11723799942491998
test entropy is  0.0443320781569496
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(61.7434, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0047, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6149, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(61.7434, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(37.9775, device='cuda:2')
test acc is  0.9879666668229852
test loss is 0.042783876537110875
test entropy is  0.01986102441301838
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01986102441301838
avg test loss is  0.042783876537110875
avg accuracy is  0.9879666668229852
compute_distance is  tensor(37.9775, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15412229451257536
avg test loss is  2.9627480349306867
avg accuracy is  0.6507666668230007
compute_distance is  tensor(111.4199, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(111.4199, device='cuda:2')
test acc is  0.6507666668230007
test loss is 2.9627480349306867
test entropy is  0.15412229451257536
________________________________
diff is  tensor(0.7382, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(12.1803, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(97.9905, device='cuda:2')
diff is  tensor(0.0330, device='cuda:2')
diff is  tensor(0.4458, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(49.6729, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(0.0228, device='cuda:2')
sum is tensor(0.0558, device='cuda:2')
sum is tensor(0.5016, device='cuda:2')
sum is tensor(1.2398, device='cuda:2')
sum is tensor(13.4201, device='cuda:2')
sum is tensor(111.4106, device='cuda:2')
ratio is tensor(0.6300, device='cuda:2')
threshold is tensor(97.9905, device='cuda:2')
cal diff is tensor(0.7382, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(12.1803, device='cuda:2')
discard
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(97.9905, device='cuda:2')
clipping
cal diff is tensor(0.0330, device='cuda:2')
discard
cal diff is tensor(0.4458, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(61.7482, device='cuda:2')
test acc is  0.9748333334896522
test loss is 0.09255475550281053
test entropy is  0.037796798894024354
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(61.7377, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0011, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.0257, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(61.7377, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(1.6005, device='cuda:2')
test acc is  0.993516666822985
test loss is 0.02333467395850632
test entropy is  0.011296822300630708
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011296822300630708
avg test loss is  0.02333467395850632
avg accuracy is  0.993516666822985
compute_distance is  tensor(1.6005, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15009747670371648
avg test loss is  2.8506465028089756
avg accuracy is  0.6566333334896669
compute_distance is  tensor(91.4652, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.4652, device='cuda:2')
test acc is  0.6566333334896669
test loss is 2.8506465028089756
test entropy is  0.15009747670371648
________________________________
diff is  tensor(0.8539, device='cuda:2')
diff is  tensor(0.0082, device='cuda:2')
diff is  tensor(13.1223, device='cuda:2')
diff is  tensor(0.0142, device='cuda:2')
diff is  tensor(76.8668, device='cuda:2')
diff is  tensor(0.0454, device='cuda:2')
diff is  tensor(0.5500, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(29.7182, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0126, device='cuda:2')
sum is tensor(0.0268, device='cuda:2')
sum is tensor(0.0722, device='cuda:2')
sum is tensor(0.6222, device='cuda:2')
sum is tensor(1.4761, device='cuda:2')
sum is tensor(14.5984, device='cuda:2')
sum is tensor(91.4652, device='cuda:2')
ratio is tensor(0.8033, device='cuda:2')
threshold is tensor(76.8668, device='cuda:2')
cal diff is tensor(0.8539, device='cuda:2')
discard
cal diff is tensor(0.0082, device='cuda:2')
discard
cal diff is tensor(13.1223, device='cuda:2')
discard
cal diff is tensor(0.0142, device='cuda:2')
discard
cal diff is tensor(76.8668, device='cuda:2')
clipping
cal diff is tensor(0.0454, device='cuda:2')
discard
cal diff is tensor(0.5500, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(61.7544, device='cuda:2')
test acc is  0.960316666822986
test loss is 0.14839595851407056
test entropy is  0.05150325462380464
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(61.7474, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0074, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3144, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(61.7474, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(19.4239, device='cuda:2')
test acc is  0.992366666822985
test loss is 0.02784389051111848
test entropy is  0.013640578240595096
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.013640578240595096
avg test loss is  0.02784389051111848
avg accuracy is  0.992366666822985
compute_distance is  tensor(19.4239, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15223464401148912
avg test loss is  2.9088377148739055
avg accuracy is  0.6538000001563338
compute_distance is  tensor(100.7604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(100.7604, device='cuda:2')
test acc is  0.6538000001563338
test loss is 2.9088377148739055
test entropy is  0.15223464401148912
________________________________
diff is  tensor(0.7960, device='cuda:2')
diff is  tensor(0.0074, device='cuda:2')
diff is  tensor(12.7844, device='cuda:2')
diff is  tensor(0.0139, device='cuda:2')
diff is  tensor(86.6189, device='cuda:2')
diff is  tensor(0.0385, device='cuda:2')
diff is  tensor(0.4928, device='cuda:2')
diff is  tensor(0.0037, device='cuda:2')
threshold is  tensor(39.0134, device='cuda:2')
sum is tensor(0.0037, device='cuda:2')
sum is tensor(0.0112, device='cuda:2')
sum is tensor(0.0250, device='cuda:2')
sum is tensor(0.0636, device='cuda:2')
sum is tensor(0.5564, device='cuda:2')
sum is tensor(1.3524, device='cuda:2')
sum is tensor(14.1369, device='cuda:2')
sum is tensor(100.7558, device='cuda:2')
ratio is tensor(0.7128, device='cuda:2')
threshold is tensor(86.6189, device='cuda:2')
cal diff is tensor(0.7960, device='cuda:2')
discard
cal diff is tensor(0.0074, device='cuda:2')
discard
cal diff is tensor(12.7844, device='cuda:2')
discard
cal diff is tensor(0.0139, device='cuda:2')
discard
cal diff is tensor(86.6189, device='cuda:2')
clipping
cal diff is tensor(0.0385, device='cuda:2')
discard
cal diff is tensor(0.4928, device='cuda:2')
discard
cal diff is tensor(0.0037, device='cuda:2')
discard
________________________________
test distance is  tensor(61.7513, device='cuda:2')
test acc is  0.9691833334896525
test loss is 0.1138571404884645
test entropy is  0.04346886266947293
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(61.7427, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0043, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.6584, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(61.7427, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(40.6576, device='cuda:2')
test acc is  0.9870166668229852
test loss is 0.04625117140811042
test entropy is  0.021184924265401125
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.021184924265401125
avg test loss is  0.04625117140811042
avg accuracy is  0.9870166668229852
compute_distance is  tensor(40.6576, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15443867776217238
avg test loss is  2.9721294541094605
avg accuracy is  0.6502166668230007
compute_distance is  tensor(113.0555, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(113.0555, device='cuda:2')
test acc is  0.6502166668230007
test loss is 2.9721294541094605
test entropy is  0.15443867776217238
________________________________
diff is  tensor(0.7299, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(12.0859, device='cuda:2')
diff is  tensor(0.0124, device='cuda:2')
diff is  tensor(99.7349, device='cuda:2')
diff is  tensor(0.0323, device='cuda:2')
diff is  tensor(0.4402, device='cuda:2')
diff is  tensor(0.0031, device='cuda:2')
threshold is  tensor(51.3085, device='cuda:2')
sum is tensor(0.0031, device='cuda:2')
sum is tensor(0.0100, device='cuda:2')
sum is tensor(0.0224, device='cuda:2')
sum is tensor(0.0547, device='cuda:2')
sum is tensor(0.4950, device='cuda:2')
sum is tensor(1.2249, device='cuda:2')
sum is tensor(13.3107, device='cuda:2')
sum is tensor(113.0456, device='cuda:2')
ratio is tensor(0.6190, device='cuda:2')
threshold is tensor(99.7349, device='cuda:2')
cal diff is tensor(0.7299, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(12.0859, device='cuda:2')
discard
cal diff is tensor(0.0124, device='cuda:2')
discard
cal diff is tensor(99.7349, device='cuda:2')
clipping
cal diff is tensor(0.0323, device='cuda:2')
discard
cal diff is tensor(0.4402, device='cuda:2')
discard
cal diff is tensor(0.0031, device='cuda:2')
discard
________________________________
test distance is  tensor(61.7477, device='cuda:2')
test acc is  0.9754666668229856
test loss is 0.09006121996097559
test entropy is  0.037070133634703926
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(61.7370, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0007, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
ratio is tensor(0.5407, device='cuda:2')
threshold is tensor(0.0008, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
clipping
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(61.7370, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(33.3936, device='cuda:2')
test acc is  0.990566666822985
test loss is 0.0342268181971413
test entropy is  0.016774143631096437
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.016774143631096437
avg test loss is  0.0342268181971413
avg accuracy is  0.990566666822985
compute_distance is  tensor(33.3936, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15430757937940962
avg test loss is  2.9585396598524123
avg accuracy is  0.650950000156334
compute_distance is  tensor(110.1003, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.7438016528925617
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 74 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.19% 


 | Global Training Round : 75 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004322304390370846
attack res is False
len of model dicts is  10
compute distance is  tensor(18.1459, device='cuda:2')
compute distance is  tensor(72.4135, device='cuda:2')
compute distance is  tensor(69.5451, device='cuda:2')
compute distance is  tensor(79.2160, device='cuda:2')
compute distance is  tensor(37.8027, device='cuda:2')
compute distance is  tensor(59.2206, device='cuda:2')
compute distance is  tensor(41.0019, device='cuda:2')
compute distance is  tensor(36.2505, device='cuda:2')
compute distance is  tensor(54.5115, device='cuda:2')
compute distance is  tensor(34.1907, device='cuda:2')
calculated distance threshold is  tensor(59.4405, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7084833334896637
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8528000001563232
====================
====================
iteration is  0
round is  2
accuracy is  0.8521000001563233
====================
====================
iteration is  1
round is  0
accuracy is  0.6689833334896661
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8225166668229912
====================
====================
iteration is  1
round is  2
accuracy is  0.7278500001563291
====================
====================
iteration is  2
round is  0
accuracy is  0.833050000156324
====================
________________________________
test distance is  tensor(4712.4668, device='cuda:2')
test acc is  0.6689833334896661
test loss is 2.546708259374094
test entropy is  0.15502749198376498
________________________________
diff is  tensor(49.7497, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4006, device='cuda:2', dtype=torch.float64)
diff is  tensor(631.3851, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.6000, device='cuda:2', dtype=torch.float64)
diff is  tensor(4005.6348, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2344, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2421, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2201, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4653.0264, device='cuda:2')
sum is tensor(0.2201, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6207, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2207, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4551, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6972, device='cuda:2', dtype=torch.float64)
sum is tensor(75.4469, device='cuda:2', dtype=torch.float64)
sum is tensor(706.8320, device='cuda:2', dtype=torch.float64)
sum is tensor(4712.4668, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0148, device='cuda:2', dtype=torch.float64)
threshold is tensor(4005.6348, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.7497, device='cuda:2')
discard
cal diff is tensor(0.4006, device='cuda:2')
discard
cal diff is tensor(631.3851, device='cuda:2')
discard
cal diff is tensor(0.6000, device='cuda:2')
discard
cal diff is tensor(4005.6348, device='cuda:2')
clipping
cal diff is tensor(2.2344, device='cuda:2')
discard
cal diff is tensor(22.2421, device='cuda:2')
discard
cal diff is tensor(0.2201, device='cuda:2')
discard
________________________________
test distance is  tensor(59.4507, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.023334851084809007
test entropy is  0.011174185119675044
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(59.4404, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0004, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(59.4404, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0734, device='cuda:2')
test acc is  0.9934500001563183
test loss is 0.023311754643248764
test entropy is  0.01117881622223595
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01117881622223595
avg test loss is  0.023311754643248764
avg accuracy is  0.9934500001563183
compute_distance is  tensor(0.0734, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15188091250656766
avg test loss is  1.6964979207973236
avg accuracy is  0.7182166668229963
compute_distance is  tensor(92.4514, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.4514, device='cuda:2')
test acc is  0.7182166668229963
test loss is 1.6964979207973236
test entropy is  0.15188091250656766
________________________________
diff is  tensor(0.8537, device='cuda:2')
diff is  tensor(0.0072, device='cuda:2')
diff is  tensor(12.9527, device='cuda:2')
diff is  tensor(0.0143, device='cuda:2')
diff is  tensor(78.0393, device='cuda:2')
diff is  tensor(0.0486, device='cuda:2')
diff is  tensor(0.5380, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(33.0109, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0115, device='cuda:2')
sum is tensor(0.0258, device='cuda:2')
sum is tensor(0.0744, device='cuda:2')
sum is tensor(0.6124, device='cuda:2')
sum is tensor(1.4661, device='cuda:2')
sum is tensor(14.4188, device='cuda:2')
sum is tensor(92.4581, device='cuda:2')
ratio is tensor(0.7618, device='cuda:2')
threshold is tensor(78.0393, device='cuda:2')
cal diff is tensor(0.8537, device='cuda:2')
discard
cal diff is tensor(0.0072, device='cuda:2')
discard
cal diff is tensor(12.9527, device='cuda:2')
discard
cal diff is tensor(0.0143, device='cuda:2')
discard
cal diff is tensor(78.0393, device='cuda:2')
clipping
cal diff is tensor(0.0486, device='cuda:2')
discard
cal diff is tensor(0.5380, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(59.4503, device='cuda:2')
test acc is  0.9765000001563189
test loss is 0.08123604243121632
test entropy is  0.036284630768125686
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(59.4482, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0098, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0430, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(59.4482, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(2.5636, device='cuda:2')
test acc is  0.9934833334896517
test loss is 0.023333620193844464
test entropy is  0.011294182979665555
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011294182979665555
avg test loss is  0.023333620193844464
avg accuracy is  0.9934833334896517
compute_distance is  tensor(2.5636, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15165849080853372
avg test loss is  1.70833595964446
avg accuracy is  0.7176166668229964
compute_distance is  tensor(93.8597, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.8597, device='cuda:2')
test acc is  0.7176166668229964
test loss is 1.70833595964446
test entropy is  0.15165849080853372
________________________________
diff is  tensor(0.8462, device='cuda:2')
diff is  tensor(0.0071, device='cuda:2')
diff is  tensor(12.9370, device='cuda:2')
diff is  tensor(0.0144, device='cuda:2')
diff is  tensor(79.4810, device='cuda:2')
diff is  tensor(0.0474, device='cuda:2')
diff is  tensor(0.5283, device='cuda:2')
diff is  tensor(0.0042, device='cuda:2')
threshold is  tensor(34.4192, device='cuda:2')
sum is tensor(0.0042, device='cuda:2')
sum is tensor(0.0113, device='cuda:2')
sum is tensor(0.0257, device='cuda:2')
sum is tensor(0.0731, device='cuda:2')
sum is tensor(0.6014, device='cuda:2')
sum is tensor(1.4475, device='cuda:2')
sum is tensor(14.3845, device='cuda:2')
sum is tensor(93.8656, device='cuda:2')
ratio is tensor(0.7479, device='cuda:2')
threshold is tensor(79.4810, device='cuda:2')
cal diff is tensor(0.8462, device='cuda:2')
discard
cal diff is tensor(0.0071, device='cuda:2')
discard
cal diff is tensor(12.9370, device='cuda:2')
discard
cal diff is tensor(0.0144, device='cuda:2')
discard
cal diff is tensor(79.4810, device='cuda:2')
clipping
cal diff is tensor(0.0474, device='cuda:2')
discard
cal diff is tensor(0.5283, device='cuda:2')
discard
cal diff is tensor(0.0042, device='cuda:2')
discard
________________________________
test distance is  tensor(59.4498, device='cuda:2')
test acc is  0.9773000001563189
test loss is 0.07837855842439266
test entropy is  0.03540637634929082
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(59.4473, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0093, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0991, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(59.4473, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(5.8955, device='cuda:2')
test acc is  0.9934000001563184
test loss is 0.02348350133986703
test entropy is  0.011498778187405566
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011498778187405566
avg test loss is  0.02348350133986703
avg accuracy is  0.9934000001563184
compute_distance is  tensor(5.8955, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15138087219902194
avg test loss is  1.723200943360705
avg accuracy is  0.7167333334896631
compute_distance is  tensor(95.7267, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(95.7267, device='cuda:2')
test acc is  0.7167333334896631
test loss is 1.723200943360705
test entropy is  0.15138087219902194
________________________________
diff is  tensor(0.8385, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(12.9193, device='cuda:2')
diff is  tensor(0.0145, device='cuda:2')
diff is  tensor(81.3860, device='cuda:2')
diff is  tensor(0.0459, device='cuda:2')
diff is  tensor(0.5163, device='cuda:2')
diff is  tensor(0.0040, device='cuda:2')
threshold is  tensor(36.2862, device='cuda:2')
sum is tensor(0.0040, device='cuda:2')
sum is tensor(0.0110, device='cuda:2')
sum is tensor(0.0254, device='cuda:2')
sum is tensor(0.0714, device='cuda:2')
sum is tensor(0.5877, device='cuda:2')
sum is tensor(1.4261, device='cuda:2')
sum is tensor(14.3455, device='cuda:2')
sum is tensor(95.7314, device='cuda:2')
ratio is tensor(0.7304, device='cuda:2')
threshold is tensor(81.3860, device='cuda:2')
cal diff is tensor(0.8385, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(12.9193, device='cuda:2')
discard
cal diff is tensor(0.0145, device='cuda:2')
discard
cal diff is tensor(81.3860, device='cuda:2')
clipping
cal diff is tensor(0.0459, device='cuda:2')
discard
cal diff is tensor(0.5163, device='cuda:2')
discard
cal diff is tensor(0.0040, device='cuda:2')
discard
________________________________
test distance is  tensor(59.4492, device='cuda:2')
test acc is  0.9782166668229854
test loss is 0.07501672588255724
test entropy is  0.034380307473354105
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(59.4463, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0087, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1707, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(59.4463, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(10.1546, device='cuda:2')
test acc is  0.9930500001563184
test loss is 0.0238713908023066
test entropy is  0.011855620635264992
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011855620635264992
avg test loss is  0.0238713908023066
avg accuracy is  0.9930500001563184
compute_distance is  tensor(10.1546, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15119425504049386
avg test loss is  1.742080476873719
avg accuracy is  0.7159666668229966
compute_distance is  tensor(98.0846, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(98.0846, device='cuda:2')
test acc is  0.7159666668229966
test loss is 1.742080476873719
test entropy is  0.15119425504049386
________________________________
diff is  tensor(0.8304, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(12.8911, device='cuda:2')
diff is  tensor(0.0145, device='cuda:2')
diff is  tensor(83.7953, device='cuda:2')
diff is  tensor(0.0441, device='cuda:2')
diff is  tensor(0.5019, device='cuda:2')
diff is  tensor(0.0038, device='cuda:2')
threshold is  tensor(38.6441, device='cuda:2')
sum is tensor(0.0038, device='cuda:2')
sum is tensor(0.0107, device='cuda:2')
sum is tensor(0.0252, device='cuda:2')
sum is tensor(0.0693, device='cuda:2')
sum is tensor(0.5712, device='cuda:2')
sum is tensor(1.4016, device='cuda:2')
sum is tensor(14.2927, device='cuda:2')
sum is tensor(98.0881, device='cuda:2')
ratio is tensor(0.7094, device='cuda:2')
threshold is tensor(83.7953, device='cuda:2')
cal diff is tensor(0.8304, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(12.8911, device='cuda:2')
discard
cal diff is tensor(0.0145, device='cuda:2')
discard
cal diff is tensor(83.7953, device='cuda:2')
clipping
cal diff is tensor(0.0441, device='cuda:2')
discard
cal diff is tensor(0.5019, device='cuda:2')
discard
cal diff is tensor(0.0038, device='cuda:2')
discard
________________________________
test distance is  tensor(59.4484, device='cuda:2')
test acc is  0.9790666668229855
test loss is 0.07141893617013777
test entropy is  0.033270048520284895
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(59.4450, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0079, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2533, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(59.4450, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(15.0650, device='cuda:2')
test acc is  0.9930166668229851
test loss is 0.024591033670342703
test entropy is  0.012414621888749571
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012414621888749571
avg test loss is  0.024591033670342703
avg accuracy is  0.9930166668229851
compute_distance is  tensor(15.0650, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15106043256104373
avg test loss is  1.7620162059630413
avg accuracy is  0.7151166668229966
compute_distance is  tensor(100.8914, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(100.8914, device='cuda:2')
test acc is  0.7151166668229966
test loss is 1.7620162059630413
test entropy is  0.15106043256104373
________________________________
diff is  tensor(0.8228, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(12.8461, device='cuda:2')
diff is  tensor(0.0145, device='cuda:2')
diff is  tensor(86.6709, device='cuda:2')
diff is  tensor(0.0422, device='cuda:2')
diff is  tensor(0.4864, device='cuda:2')
diff is  tensor(0.0037, device='cuda:2')
threshold is  tensor(41.4509, device='cuda:2')
sum is tensor(0.0037, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0249, device='cuda:2')
sum is tensor(0.0671, device='cuda:2')
sum is tensor(0.5536, device='cuda:2')
sum is tensor(1.3764, device='cuda:2')
sum is tensor(14.2225, device='cuda:2')
sum is tensor(100.8934, device='cuda:2')
ratio is tensor(0.6858, device='cuda:2')
threshold is tensor(86.6709, device='cuda:2')
cal diff is tensor(0.8228, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(12.8461, device='cuda:2')
discard
cal diff is tensor(0.0145, device='cuda:2')
discard
cal diff is tensor(86.6709, device='cuda:2')
clipping
cal diff is tensor(0.0422, device='cuda:2')
discard
cal diff is tensor(0.4864, device='cuda:2')
discard
cal diff is tensor(0.0037, device='cuda:2')
discard
________________________________
test distance is  tensor(59.4476, device='cuda:2')
test acc is  0.980033333489652
test loss is 0.06775395109189883
test entropy is  0.03210863822805123
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(59.4435, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0071, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3460, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(59.4435, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(20.5765, device='cuda:2')
test acc is  0.9926500001563183
test loss is 0.02576046696764661
test entropy is  0.013247895149336908
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.013247895149336908
avg test loss is  0.02576046696764661
avg accuracy is  0.9926500001563183
compute_distance is  tensor(20.5765, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15092230845155366
avg test loss is  1.782191323890869
avg accuracy is  0.7140833334896634
compute_distance is  tensor(104.0792, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(104.0792, device='cuda:2')
test acc is  0.7140833334896634
test loss is 1.782191323890869
test entropy is  0.15092230845155366
________________________________
diff is  tensor(0.8150, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(12.7873, device='cuda:2')
diff is  tensor(0.0144, device='cuda:2')
diff is  tensor(89.9419, device='cuda:2')
diff is  tensor(0.0402, device='cuda:2')
diff is  tensor(0.4706, device='cuda:2')
diff is  tensor(0.0035, device='cuda:2')
threshold is  tensor(44.6387, device='cuda:2')
sum is tensor(0.0035, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(0.0246, device='cuda:2')
sum is tensor(0.0648, device='cuda:2')
sum is tensor(0.5354, device='cuda:2')
sum is tensor(1.3504, device='cuda:2')
sum is tensor(14.1377, device='cuda:2')
sum is tensor(104.0795, device='cuda:2')
ratio is tensor(0.6609, device='cuda:2')
threshold is tensor(89.9419, device='cuda:2')
cal diff is tensor(0.8150, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(12.7873, device='cuda:2')
discard
cal diff is tensor(0.0144, device='cuda:2')
discard
cal diff is tensor(89.9419, device='cuda:2')
clipping
cal diff is tensor(0.0402, device='cuda:2')
discard
cal diff is tensor(0.4706, device='cuda:2')
discard
cal diff is tensor(0.0035, device='cuda:2')
discard
________________________________
test distance is  tensor(59.4467, device='cuda:2')
test acc is  0.981133333489652
test loss is 0.0641524983933572
test entropy is  0.030968195055202798
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(59.4418, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0062, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.4476, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(59.4418, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 75 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.21% 


 | Global Training Round : 76 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004368803463876247
attack res is False
len of model dicts is  10
compute distance is  tensor(15.4689, device='cuda:2')
compute distance is  tensor(52.6380, device='cuda:2')
compute distance is  tensor(68.7044, device='cuda:2')
compute distance is  tensor(75.3259, device='cuda:2')
compute distance is  tensor(55.9281, device='cuda:2')
compute distance is  tensor(57.4831, device='cuda:2')
compute distance is  tensor(66.3032, device='cuda:2')
compute distance is  tensor(35.0968, device='cuda:2')
compute distance is  tensor(90.3803, device='cuda:2')
compute distance is  tensor(43.0706, device='cuda:2')
calculated distance threshold is  tensor(66.1227, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8429166668229903
====================
====================
iteration is  0
round is  1
accuracy is  0.8741166668229892
====================
====================
iteration is  0
round is  2
accuracy is  0.7816333334896597
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.6431333334896678
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8191166668229912
====================
====================
iteration is  1
round is  2
accuracy is  0.7435000001563282
====================
====================
iteration is  2
round is  0
accuracy is  0.8370000001563238
====================
________________________________
test distance is  tensor(4707.5728, device='cuda:2')
test acc is  0.6431333334896678
test loss is 2.8403373513775847
test entropy is  0.15667849628211084
________________________________
diff is  tensor(48.1667, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4335, device='cuda:2', dtype=torch.float64)
diff is  tensor(629.5618, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5722, device='cuda:2', dtype=torch.float64)
diff is  tensor(4004.0285, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2462, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3838, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1807, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4641.4502, device='cuda:2')
sum is tensor(0.1807, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6142, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1864, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4327, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8164, device='cuda:2', dtype=torch.float64)
sum is tensor(73.9831, device='cuda:2', dtype=torch.float64)
sum is tensor(703.5449, device='cuda:2', dtype=torch.float64)
sum is tensor(4707.5734, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0165, device='cuda:2', dtype=torch.float64)
threshold is tensor(4004.0285, device='cuda:2', dtype=torch.float64)
cal diff is tensor(48.1667, device='cuda:2')
discard
cal diff is tensor(0.4335, device='cuda:2')
discard
cal diff is tensor(629.5618, device='cuda:2')
discard
cal diff is tensor(0.5722, device='cuda:2')
discard
cal diff is tensor(4004.0286, device='cuda:2')
clipping
cal diff is tensor(2.2462, device='cuda:2')
discard
cal diff is tensor(22.3838, device='cuda:2')
discard
cal diff is tensor(0.1807, device='cuda:2')
discard
________________________________
test distance is  tensor(66.1334, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.023284761737267266
test entropy is  0.011248523805901203
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.1233, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0107, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(66.1336, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(66.1233, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.1233, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(66.1329, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.023284747105167185
test entropy is  0.011248517376571893
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.1229, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0004, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.1229, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0746, device='cuda:2')
test acc is  0.9934500001563183
test loss is 0.02323128095613929
test entropy is  0.011205527242703482
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011205527242703482
avg test loss is  0.02323128095613929
avg accuracy is  0.9934500001563183
compute_distance is  tensor(0.0746, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17170479143066192
avg test loss is  2.06583380877082
avg accuracy is  0.6722166668229991
compute_distance is  tensor(91.5757, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.5757, device='cuda:2')
test acc is  0.6722166668229991
test loss is 2.06583380877082
test entropy is  0.17170479143066192
________________________________
diff is  tensor(0.7893, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(12.7050, device='cuda:2')
diff is  tensor(0.0139, device='cuda:2')
diff is  tensor(77.4497, device='cuda:2')
diff is  tensor(0.0481, device='cuda:2')
diff is  tensor(0.5644, device='cuda:2')
diff is  tensor(0.0044, device='cuda:2')
threshold is  tensor(25.4529, device='cuda:2')
sum is tensor(0.0044, device='cuda:2')
sum is tensor(0.0114, device='cuda:2')
sum is tensor(0.0253, device='cuda:2')
sum is tensor(0.0734, device='cuda:2')
sum is tensor(0.6378, device='cuda:2')
sum is tensor(1.4271, device='cuda:2')
sum is tensor(14.1322, device='cuda:2')
sum is tensor(91.5819, device='cuda:2')
ratio is tensor(0.8538, device='cuda:2')
threshold is tensor(77.4497, device='cuda:2')
cal diff is tensor(0.7893, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(12.7050, device='cuda:2')
discard
cal diff is tensor(0.0139, device='cuda:2')
discard
cal diff is tensor(77.4497, device='cuda:2')
clipping
cal diff is tensor(0.0481, device='cuda:2')
discard
cal diff is tensor(0.5644, device='cuda:2')
discard
cal diff is tensor(0.0044, device='cuda:2')
discard
________________________________
test distance is  tensor(66.1321, device='cuda:2')
test acc is  0.9664000001563191
test loss is 0.11920090980464414
test entropy is  0.05534157689029315
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.1295, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0094, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0949, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.1295, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(6.2789, device='cuda:2')
test acc is  0.9935333334896517
test loss is 0.02338948240572626
test entropy is  0.011555744627126776
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011555744627126776
avg test loss is  0.02338948240572626
avg accuracy is  0.9935333334896517
compute_distance is  tensor(6.2789, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17091167823020328
avg test loss is  2.086958296962384
avg accuracy is  0.6715666668229991
compute_distance is  tensor(94.7455, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(94.7455, device='cuda:2')
test acc is  0.6715666668229991
test loss is 2.086958296962384
test entropy is  0.17091167823020328
________________________________
diff is  tensor(0.7646, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(12.5772, device='cuda:2')
diff is  tensor(0.0138, device='cuda:2')
diff is  tensor(80.8003, device='cuda:2')
diff is  tensor(0.0450, device='cuda:2')
diff is  tensor(0.5377, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
threshold is  tensor(28.6227, device='cuda:2')
sum is tensor(0.0041, device='cuda:2')
sum is tensor(0.0109, device='cuda:2')
sum is tensor(0.0248, device='cuda:2')
sum is tensor(0.0698, device='cuda:2')
sum is tensor(0.6075, device='cuda:2')
sum is tensor(1.3721, device='cuda:2')
sum is tensor(13.9493, device='cuda:2')
sum is tensor(94.7497, device='cuda:2')
ratio is tensor(0.8184, device='cuda:2')
threshold is tensor(80.8003, device='cuda:2')
cal diff is tensor(0.7646, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(12.5772, device='cuda:2')
discard
cal diff is tensor(0.0138, device='cuda:2')
discard
cal diff is tensor(80.8003, device='cuda:2')
clipping
cal diff is tensor(0.0450, device='cuda:2')
discard
cal diff is tensor(0.5377, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
________________________________
test distance is  tensor(66.1311, device='cuda:2')
test acc is  0.9700833334896523
test loss is 0.10595851004081987
test entropy is  0.050492134073556565
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.1275, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0084, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.2053, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.1275, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(13.5809, device='cuda:2')
test acc is  0.9931833334896517
test loss is 0.02420660943644651
test entropy is  0.012257410830932573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012257410830932573
avg test loss is  0.02420660943644651
avg accuracy is  0.9931833334896517
compute_distance is  tensor(13.5809, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16999999267348984
avg test loss is  2.1109935734699024
avg accuracy is  0.6705833334896659
compute_distance is  tensor(98.5272, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(98.5272, device='cuda:2')
test acc is  0.6705833334896659
test loss is 2.1109935734699024
test entropy is  0.16999999267348984
________________________________
diff is  tensor(0.7464, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(12.3877, device='cuda:2')
diff is  tensor(0.0137, device='cuda:2')
diff is  tensor(84.8188, device='cuda:2')
diff is  tensor(0.0419, device='cuda:2')
diff is  tensor(0.5097, device='cuda:2')
diff is  tensor(0.0038, device='cuda:2')
threshold is  tensor(32.4044, device='cuda:2')
sum is tensor(0.0038, device='cuda:2')
sum is tensor(0.0107, device='cuda:2')
sum is tensor(0.0244, device='cuda:2')
sum is tensor(0.0663, device='cuda:2')
sum is tensor(0.5761, device='cuda:2')
sum is tensor(1.3225, device='cuda:2')
sum is tensor(13.7102, device='cuda:2')
sum is tensor(98.5290, device='cuda:2')
ratio is tensor(0.7796, device='cuda:2')
threshold is tensor(84.8188, device='cuda:2')
cal diff is tensor(0.7464, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(12.3877, device='cuda:2')
discard
cal diff is tensor(0.0137, device='cuda:2')
discard
cal diff is tensor(84.8188, device='cuda:2')
clipping
cal diff is tensor(0.0419, device='cuda:2')
discard
cal diff is tensor(0.5097, device='cuda:2')
discard
cal diff is tensor(0.0038, device='cuda:2')
discard
________________________________
test distance is  tensor(66.1298, device='cuda:2')
test acc is  0.9732000001563188
test loss is 0.09452745852464967
test entropy is  0.04618943050659613
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.1252, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0071, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.3427, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.1252, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(22.6661, device='cuda:2')
test acc is  0.992516666822985
test loss is 0.026238123362494075
test entropy is  0.013664261436972242
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.013664261436972242
avg test loss is  0.026238123362494075
avg accuracy is  0.992516666822985
compute_distance is  tensor(22.6661, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16884637066026106
avg test loss is  2.136355134342779
avg accuracy is  0.669683333489666
compute_distance is  tensor(103.3052, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(103.3052, device='cuda:2')
test acc is  0.669683333489666
test loss is 2.136355134342779
test entropy is  0.16884637066026106
________________________________
diff is  tensor(0.7264, device='cuda:2')
diff is  tensor(0.0070, device='cuda:2')
diff is  tensor(12.1127, device='cuda:2')
diff is  tensor(0.0134, device='cuda:2')
diff is  tensor(89.9230, device='cuda:2')
diff is  tensor(0.0387, device='cuda:2')
diff is  tensor(0.4795, device='cuda:2')
diff is  tensor(0.0035, device='cuda:2')
threshold is  tensor(37.1824, device='cuda:2')
sum is tensor(0.0035, device='cuda:2')
sum is tensor(0.0105, device='cuda:2')
sum is tensor(0.0238, device='cuda:2')
sum is tensor(0.0625, device='cuda:2')
sum is tensor(0.5420, device='cuda:2')
sum is tensor(1.2684, device='cuda:2')
sum is tensor(13.3811, device='cuda:2')
sum is tensor(103.3041, device='cuda:2')
ratio is tensor(0.7353, device='cuda:2')
threshold is tensor(89.9230, device='cuda:2')
cal diff is tensor(0.7264, device='cuda:2')
discard
cal diff is tensor(0.0070, device='cuda:2')
discard
cal diff is tensor(12.1127, device='cuda:2')
discard
cal diff is tensor(0.0134, device='cuda:2')
discard
cal diff is tensor(89.9230, device='cuda:2')
clipping
cal diff is tensor(0.0387, device='cuda:2')
discard
cal diff is tensor(0.4795, device='cuda:2')
discard
cal diff is tensor(0.0035, device='cuda:2')
discard
________________________________
test distance is  tensor(66.1283, device='cuda:2')
test acc is  0.9760666668229855
test loss is 0.08409003917352363
test entropy is  0.04214095518932239
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.1223, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0056, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5130, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.1223, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(33.9245, device='cuda:2')
test acc is  0.9908833334896517
test loss is 0.030703005988854518
test entropy is  0.0163502649925472
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0163502649925472
avg test loss is  0.030703005988854518
avg accuracy is  0.9908833334896517
compute_distance is  tensor(33.9245, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16762613487650335
avg test loss is  2.1631011995933713
avg accuracy is  0.6689666668229993
compute_distance is  tensor(109.6349, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(109.6349, device='cuda:2')
test acc is  0.6689666668229993
test loss is 2.1631011995933713
test entropy is  0.16762613487650335
________________________________
diff is  tensor(0.7086, device='cuda:2')
diff is  tensor(0.0072, device='cuda:2')
diff is  tensor(11.7197, device='cuda:2')
diff is  tensor(0.0127, device='cuda:2')
diff is  tensor(96.6967, device='cuda:2')
diff is  tensor(0.0351, device='cuda:2')
diff is  tensor(0.4473, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(43.5121, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0104, device='cuda:2')
sum is tensor(0.0230, device='cuda:2')
sum is tensor(0.0581, device='cuda:2')
sum is tensor(0.5054, device='cuda:2')
sum is tensor(1.2140, device='cuda:2')
sum is tensor(12.9337, device='cuda:2')
sum is tensor(109.6304, device='cuda:2')
ratio is tensor(0.6838, device='cuda:2')
threshold is tensor(96.6967, device='cuda:2')
cal diff is tensor(0.7086, device='cuda:2')
discard
cal diff is tensor(0.0072, device='cuda:2')
discard
cal diff is tensor(11.7197, device='cuda:2')
discard
cal diff is tensor(0.0127, device='cuda:2')
discard
cal diff is tensor(96.6967, device='cuda:2')
clipping
cal diff is tensor(0.0351, device='cuda:2')
discard
cal diff is tensor(0.4473, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(66.1264, device='cuda:2')
test acc is  0.9787500001563187
test loss is 0.07423481094079366
test entropy is  0.038145207393944745
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(66.1187, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0036, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7279, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(66.1187, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(48.1358, device='cuda:2')
test acc is  0.9880500001563185
test loss is 0.04069160432839033
test entropy is  0.0217779645691892
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0217779645691892
avg test loss is  0.04069160432839033
avg accuracy is  0.9880500001563185
compute_distance is  tensor(48.1358, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16627253293355646
avg test loss is  2.191280370836319
avg accuracy is  0.6678000001563328
compute_distance is  tensor(118.0759, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(118.0759, device='cuda:2')
test acc is  0.6678000001563328
test loss is 2.191280370836319
test entropy is  0.16627253293355646
________________________________
diff is  tensor(0.6936, device='cuda:2')
diff is  tensor(0.0072, device='cuda:2')
diff is  tensor(11.2124, device='cuda:2')
diff is  tensor(0.0119, device='cuda:2')
diff is  tensor(105.6969, device='cuda:2')
diff is  tensor(0.0310, device='cuda:2')
diff is  tensor(0.4118, device='cuda:2')
diff is  tensor(0.0028, device='cuda:2')
threshold is  tensor(51.9532, device='cuda:2')
sum is tensor(0.0028, device='cuda:2')
sum is tensor(0.0100, device='cuda:2')
sum is tensor(0.0219, device='cuda:2')
sum is tensor(0.0529, device='cuda:2')
sum is tensor(0.4648, device='cuda:2')
sum is tensor(1.1583, device='cuda:2')
sum is tensor(12.3707, device='cuda:2')
sum is tensor(118.0677, device='cuda:2')
ratio is tensor(0.6255, device='cuda:2')
threshold is tensor(105.6969, device='cuda:2')
cal diff is tensor(0.6936, device='cuda:2')
discard
cal diff is tensor(0.0072, device='cuda:2')
discard
cal diff is tensor(11.2124, device='cuda:2')
discard
cal diff is tensor(0.0119, device='cuda:2')
discard
cal diff is tensor(105.6969, device='cuda:2')
clipping
cal diff is tensor(0.0310, device='cuda:2')
discard
cal diff is tensor(0.4118, device='cuda:2')
discard
cal diff is tensor(0.0028, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  2
num1 of attacker is  0
current aggregation staleness i is  4
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 76 global rounds:
Train Accuracy: 99.00% 

Test Accuracy: 99.21% 


 | Global Training Round : 77 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004386587999761105
attack res is False
len of model dicts is  10
compute distance is  tensor(19.2768, device='cuda:2')
compute distance is  tensor(111.3653, device='cuda:2')
compute distance is  tensor(59.7901, device='cuda:2')
compute distance is  tensor(109.8798, device='cuda:2')
compute distance is  tensor(49.4166, device='cuda:2')
compute distance is  tensor(63.8291, device='cuda:2')
compute distance is  tensor(54.5600, device='cuda:2')
compute distance is  tensor(40.7684, device='cuda:2')
compute distance is  tensor(41.9026, device='cuda:2')
compute distance is  tensor(41.7848, device='cuda:2')
calculated distance threshold is  tensor(81.5455, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.7915666668229926
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.868833333489656
====================
====================
iteration is  0
round is  2
accuracy is  0.7083500001563302
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.7467500001563282
====================
====================
iteration is  1
round is  1
accuracy is  0.7064166668229971
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7607000001563274
====================
________________________________
test distance is  tensor(4713.4092, device='cuda:2')
test acc is  0.7064166668229971
test loss is 2.176807156821558
test entropy is  0.14124665981623283
________________________________
diff is  tensor(49.7638, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4255, device='cuda:2', dtype=torch.float64)
diff is  tensor(631.5313, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5982, device='cuda:2', dtype=torch.float64)
diff is  tensor(4006.3090, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2171, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.3534, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2103, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4631.8638, device='cuda:2')
sum is tensor(0.2103, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6357, device='cuda:2', dtype=torch.float64)
sum is tensor(1.2340, device='cuda:2', dtype=torch.float64)
sum is tensor(3.4510, device='cuda:2', dtype=torch.float64)
sum is tensor(25.8044, device='cuda:2', dtype=torch.float64)
sum is tensor(75.5682, device='cuda:2', dtype=torch.float64)
sum is tensor(707.0995, device='cuda:2', dtype=torch.float64)
sum is tensor(4713.4085, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0204, device='cuda:2', dtype=torch.float64)
threshold is tensor(4006.3090, device='cuda:2', dtype=torch.float64)
cal diff is tensor(49.7638, device='cuda:2')
discard
cal diff is tensor(0.4255, device='cuda:2')
discard
cal diff is tensor(631.5314, device='cuda:2')
discard
cal diff is tensor(0.5982, device='cuda:2')
discard
cal diff is tensor(4006.3091, device='cuda:2')
clipping
cal diff is tensor(2.2171, device='cuda:2')
discard
cal diff is tensor(22.3534, device='cuda:2')
discard
cal diff is tensor(0.2103, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5550, device='cuda:2')
test acc is  0.9935000001563183
test loss is 0.02328495175503283
test entropy is  0.011259373412262718
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(81.5448, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0094, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0881, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(81.5448, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(7.1954, device='cuda:2')
test acc is  0.9935000001563183
test loss is 0.023197918286772586
test entropy is  0.011213724738030994
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011213724738030994
avg test loss is  0.023197918286772586
avg accuracy is  0.9935000001563183
compute_distance is  tensor(7.1954, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15631425700414536
avg test loss is  1.4317880127030904
avg accuracy is  0.7381333334896619
compute_distance is  tensor(88.2046, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(88.2046, device='cuda:2')
test acc is  0.7381333334896619
test loss is 1.4317880127030904
test entropy is  0.15631425700414536
________________________________
diff is  tensor(0.7102, device='cuda:2')
diff is  tensor(0.0056, device='cuda:2')
diff is  tensor(11.6480, device='cuda:2')
diff is  tensor(0.0126, device='cuda:2')
diff is  tensor(75.2105, device='cuda:2')
diff is  tensor(0.0447, device='cuda:2')
diff is  tensor(0.5739, device='cuda:2')
diff is  tensor(0.0043, device='cuda:2')
threshold is  tensor(6.6591, device='cuda:2')
sum is tensor(0.0043, device='cuda:2')
sum is tensor(0.0099, device='cuda:2')
sum is tensor(0.0226, device='cuda:2')
sum is tensor(0.0673, device='cuda:2')
sum is tensor(0.6412, device='cuda:2')
sum is tensor(1.3514, device='cuda:2')
sum is tensor(12.9994, device='cuda:2')
ratio is tensor(0.5443, device='cuda:2')
threshold is tensor(11.6480, device='cuda:2')
cal diff is tensor(0.7102, device='cuda:2')
discard
cal diff is tensor(0.0056, device='cuda:2')
discard
cal diff is tensor(11.6480, device='cuda:2')
clipping
cal diff is tensor(0.0126, device='cuda:2')
discard
cal diff is tensor(75.2105, device='cuda:2')
clipping
cal diff is tensor(0.0447, device='cuda:2')
discard
cal diff is tensor(0.5739, device='cuda:2')
discard
cal diff is tensor(0.0043, device='cuda:2')
discard
________________________________
test distance is  tensor(47.2767, device='cuda:2')
test acc is  0.980983333489652
test loss is 0.06304788101259232
test entropy is  0.03003775132558138
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03003775132558138
avg test loss is  0.06304788101259232
avg accuracy is  0.980983333489652
compute_distance is  tensor(47.2767, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1519189330655883
avg test loss is  1.5554930581721162
avg accuracy is  0.7324833334896621
compute_distance is  tensor(110.3057, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(110.3057, device='cuda:2')
test acc is  0.7324833334896621
test loss is 1.5554930581721162
test entropy is  0.1519189330655883
________________________________
diff is  tensor(0.6215, device='cuda:2')
diff is  tensor(0.0061, device='cuda:2')
diff is  tensor(14.9864, device='cuda:2')
diff is  tensor(0.0102, device='cuda:2')
diff is  tensor(94.2306, device='cuda:2')
diff is  tensor(0.0248, device='cuda:2')
diff is  tensor(0.4183, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(28.7602, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0082, device='cuda:2')
sum is tensor(0.0184, device='cuda:2')
sum is tensor(0.0432, device='cuda:2')
sum is tensor(0.4615, device='cuda:2')
sum is tensor(1.0830, device='cuda:2')
sum is tensor(16.0694, device='cuda:2')
sum is tensor(110.3000, device='cuda:2')
ratio is tensor(0.8653, device='cuda:2')
threshold is tensor(94.2306, device='cuda:2')
cal diff is tensor(0.6215, device='cuda:2')
discard
cal diff is tensor(0.0061, device='cuda:2')
discard
cal diff is tensor(14.9864, device='cuda:2')
discard
cal diff is tensor(0.0102, device='cuda:2')
discard
cal diff is tensor(94.2306, device='cuda:2')
clipping
cal diff is tensor(0.0248, device='cuda:2')
discard
cal diff is tensor(0.4183, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5482, device='cuda:2')
test acc is  0.9629500001563194
test loss is 0.12990476752863359
test entropy is  0.050970658960157456
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(81.5400, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0026, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8400, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(81.5400, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(68.5028, device='cuda:2')
test acc is  0.9775000001563189
test loss is 0.07694333325174998
test entropy is  0.0346923902376256
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0346923902376256
avg test loss is  0.07694333325174998
avg accuracy is  0.9775000001563189
compute_distance is  tensor(68.5028, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15102091188560415
avg test loss is  1.6093404782034442
avg accuracy is  0.7303000001563289
compute_distance is  tensor(128.6172, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(128.6172, device='cuda:2')
test acc is  0.7303000001563289
test loss is 1.6093404782034442
test entropy is  0.15102091188560415
________________________________
diff is  tensor(0.6350, device='cuda:2')
diff is  tensor(0.0059, device='cuda:2')
diff is  tensor(10.5618, device='cuda:2')
diff is  tensor(0.0110, device='cuda:2')
diff is  tensor(116.9833, device='cuda:2')
diff is  tensor(0.0242, device='cuda:2')
diff is  tensor(0.3821, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(47.0717, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0080, device='cuda:2')
sum is tensor(0.0190, device='cuda:2')
sum is tensor(0.0433, device='cuda:2')
sum is tensor(0.4254, device='cuda:2')
sum is tensor(1.0604, device='cuda:2')
sum is tensor(11.6222, device='cuda:2')
sum is tensor(128.6055, device='cuda:2')
ratio is tensor(0.6970, device='cuda:2')
threshold is tensor(116.9833, device='cuda:2')
cal diff is tensor(0.6350, device='cuda:2')
discard
cal diff is tensor(0.0059, device='cuda:2')
discard
cal diff is tensor(10.5618, device='cuda:2')
discard
cal diff is tensor(0.0110, device='cuda:2')
discard
cal diff is tensor(116.9833, device='cuda:2')
clipping
cal diff is tensor(0.0242, device='cuda:2')
discard
cal diff is tensor(0.3821, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5439, device='cuda:2')
test acc is  0.9695166668229858
test loss is 0.10438753861350877
test entropy is  0.04536855050124603
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04536855050124603
avg test loss is  0.10438753861350877
avg accuracy is  0.9695166668229858
compute_distance is  tensor(81.5439, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1506041221495376
avg test loss is  1.6412190121691872
avg accuracy is  0.7291333334896624
compute_distance is  tensor(138.4841, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(138.4841, device='cuda:2')
test acc is  0.7291333334896624
test loss is 1.6412190121691872
test entropy is  0.1506041221495376
________________________________
diff is  tensor(0.6620, device='cuda:2')
diff is  tensor(0.0055, device='cuda:2')
diff is  tensor(10.3962, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(127.0186, device='cuda:2')
diff is  tensor(0.0214, device='cuda:2')
diff is  tensor(0.3524, device='cuda:2')
diff is  tensor(0.0018, device='cuda:2')
threshold is  tensor(56.9386, device='cuda:2')
sum is tensor(0.0018, device='cuda:2')
sum is tensor(0.0073, device='cuda:2')
sum is tensor(0.0181, device='cuda:2')
sum is tensor(0.0395, device='cuda:2')
sum is tensor(0.3919, device='cuda:2')
sum is tensor(1.0539, device='cuda:2')
sum is tensor(11.4501, device='cuda:2')
sum is tensor(138.4686, device='cuda:2')
ratio is tensor(0.6419, device='cuda:2')
threshold is tensor(127.0186, device='cuda:2')
cal diff is tensor(0.6620, device='cuda:2')
discard
cal diff is tensor(0.0055, device='cuda:2')
discard
cal diff is tensor(10.3962, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(127.0186, device='cuda:2')
clipping
cal diff is tensor(0.0214, device='cuda:2')
discard
cal diff is tensor(0.3524, device='cuda:2')
discard
cal diff is tensor(0.0018, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5420, device='cuda:2')
test acc is  0.9747333334896522
test loss is 0.086567590079301
test entropy is  0.039805137521945
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.039805137521945
avg test loss is  0.086567590079301
avg accuracy is  0.9747333334896522
compute_distance is  tensor(81.5420, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1506926833407711
avg test loss is  1.6446044337965533
avg accuracy is  0.7287833334896624
compute_distance is  tensor(139.9833, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(139.9833, device='cuda:2')
test acc is  0.7287833334896624
test loss is 1.6446044337965533
test entropy is  0.1506926833407711
________________________________
diff is  tensor(0.6680, device='cuda:2')
diff is  tensor(0.0057, device='cuda:2')
diff is  tensor(10.6993, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(128.2083, device='cuda:2')
diff is  tensor(0.0221, device='cuda:2')
diff is  tensor(0.3501, device='cuda:2')
diff is  tensor(0.0019, device='cuda:2')
threshold is  tensor(58.4378, device='cuda:2')
sum is tensor(0.0019, device='cuda:2')
sum is tensor(0.0077, device='cuda:2')
sum is tensor(0.0189, device='cuda:2')
sum is tensor(0.0409, device='cuda:2')
sum is tensor(0.3910, device='cuda:2')
sum is tensor(1.0590, device='cuda:2')
sum is tensor(11.7583, device='cuda:2')
sum is tensor(139.9666, device='cuda:2')
ratio is tensor(0.6359, device='cuda:2')
threshold is tensor(128.2083, device='cuda:2')
cal diff is tensor(0.6680, device='cuda:2')
discard
cal diff is tensor(0.0057, device='cuda:2')
discard
cal diff is tensor(10.6993, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(128.2083, device='cuda:2')
clipping
cal diff is tensor(0.0221, device='cuda:2')
discard
cal diff is tensor(0.3501, device='cuda:2')
discard
cal diff is tensor(0.0019, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5418, device='cuda:2')
test acc is  0.9759000001563188
test loss is 0.0813312412826055
test entropy is  0.038033473741527254
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.038033473741527254
avg test loss is  0.0813312412826055
avg accuracy is  0.9759000001563188
compute_distance is  tensor(81.5418, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15070330821819652
avg test loss is  1.6465854297822982
avg accuracy is  0.7287000001563291
compute_distance is  tensor(140.5522, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(140.5522, device='cuda:2')
test acc is  0.7287000001563291
test loss is 1.6465854297822982
test entropy is  0.15070330821819652
________________________________
diff is  tensor(0.6700, device='cuda:2')
diff is  tensor(0.0058, device='cuda:2')
diff is  tensor(10.8523, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(128.6213, device='cuda:2')
diff is  tensor(0.0224, device='cuda:2')
diff is  tensor(0.3495, device='cuda:2')
diff is  tensor(0.0020, device='cuda:2')
threshold is  tensor(59.0067, device='cuda:2')
sum is tensor(0.0020, device='cuda:2')
sum is tensor(0.0078, device='cuda:2')
sum is tensor(0.0192, device='cuda:2')
sum is tensor(0.0416, device='cuda:2')
sum is tensor(0.3912, device='cuda:2')
sum is tensor(1.0612, device='cuda:2')
sum is tensor(11.9134, device='cuda:2')
sum is tensor(140.5348, device='cuda:2')
ratio is tensor(0.6339, device='cuda:2')
threshold is tensor(128.6213, device='cuda:2')
cal diff is tensor(0.6700, device='cuda:2')
discard
cal diff is tensor(0.0058, device='cuda:2')
discard
cal diff is tensor(10.8523, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(128.6213, device='cuda:2')
clipping
cal diff is tensor(0.0224, device='cuda:2')
discard
cal diff is tensor(0.3495, device='cuda:2')
discard
cal diff is tensor(0.0020, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5417, device='cuda:2')
test acc is  0.9764500001563189
test loss is 0.07933668518559485
test entropy is  0.03731762131140915
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03731762131140915
avg test loss is  0.07933668518559485
avg accuracy is  0.9764500001563189
compute_distance is  tensor(81.5417, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1507147874103299
avg test loss is  1.6484354729019504
avg accuracy is  0.7285333334896624
compute_distance is  tensor(140.8704, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(140.8704, device='cuda:2')
test acc is  0.7285333334896624
test loss is 1.6484354729019504
test entropy is  0.1507147874103299
________________________________
diff is  tensor(0.6709, device='cuda:2')
diff is  tensor(0.0059, device='cuda:2')
diff is  tensor(10.9324, device='cuda:2')
diff is  tensor(0.0115, device='cuda:2')
diff is  tensor(128.8583, device='cuda:2')
diff is  tensor(0.0226, device='cuda:2')
diff is  tensor(0.3489, device='cuda:2')
diff is  tensor(0.0020, device='cuda:2')
threshold is  tensor(59.3249, device='cuda:2')
sum is tensor(0.0020, device='cuda:2')
sum is tensor(0.0079, device='cuda:2')
sum is tensor(0.0194, device='cuda:2')
sum is tensor(0.0420, device='cuda:2')
sum is tensor(0.3909, device='cuda:2')
sum is tensor(1.0618, device='cuda:2')
sum is tensor(11.9942, device='cuda:2')
sum is tensor(140.8525, device='cuda:2')
ratio is tensor(0.6327, device='cuda:2')
threshold is tensor(128.8583, device='cuda:2')
cal diff is tensor(0.6709, device='cuda:2')
discard
cal diff is tensor(0.0059, device='cuda:2')
discard
cal diff is tensor(10.9324, device='cuda:2')
discard
cal diff is tensor(0.0115, device='cuda:2')
discard
cal diff is tensor(128.8583, device='cuda:2')
clipping
cal diff is tensor(0.0226, device='cuda:2')
discard
cal diff is tensor(0.3489, device='cuda:2')
discard
cal diff is tensor(0.0020, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5416, device='cuda:2')
test acc is  0.9766166668229855
test loss is 0.07829960026747416
test entropy is  0.03694102517461023
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03694102517461023
avg test loss is  0.07829960026747416
avg accuracy is  0.9766166668229855
compute_distance is  tensor(81.5416, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1507258392505046
avg test loss is  1.6492479957306563
avg accuracy is  0.7284333334896623
compute_distance is  tensor(141.0266, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(141.0266, device='cuda:2')
test acc is  0.7284333334896623
test loss is 1.6492479957306563
test entropy is  0.1507258392505046
________________________________
diff is  tensor(0.6712, device='cuda:2')
diff is  tensor(0.0059, device='cuda:2')
diff is  tensor(10.9785, device='cuda:2')
diff is  tensor(0.0116, device='cuda:2')
diff is  tensor(128.9680, device='cuda:2')
diff is  tensor(0.0227, device='cuda:2')
diff is  tensor(0.3484, device='cuda:2')
diff is  tensor(0.0020, device='cuda:2')
threshold is  tensor(59.4811, device='cuda:2')
sum is tensor(0.0020, device='cuda:2')
sum is tensor(0.0079, device='cuda:2')
sum is tensor(0.0195, device='cuda:2')
sum is tensor(0.0422, device='cuda:2')
sum is tensor(0.3906, device='cuda:2')
sum is tensor(1.0618, device='cuda:2')
sum is tensor(12.0403, device='cuda:2')
sum is tensor(141.0083, device='cuda:2')
ratio is tensor(0.6322, device='cuda:2')
threshold is tensor(128.9680, device='cuda:2')
cal diff is tensor(0.6712, device='cuda:2')
discard
cal diff is tensor(0.0059, device='cuda:2')
discard
cal diff is tensor(10.9785, device='cuda:2')
discard
cal diff is tensor(0.0116, device='cuda:2')
discard
cal diff is tensor(128.9680, device='cuda:2')
clipping
cal diff is tensor(0.0227, device='cuda:2')
discard
cal diff is tensor(0.3484, device='cuda:2')
discard
cal diff is tensor(0.0020, device='cuda:2')
discard
________________________________
test distance is  tensor(81.5415, device='cuda:2')
test acc is  0.9767166668229855
test loss is 0.07770811419324987
test entropy is  0.03672018585762487
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03672018585762487
avg test loss is  0.07770811419324987
avg accuracy is  0.9767166668229855
compute_distance is  tensor(81.5415, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15072614342164892
avg test loss is  1.650278657928967
avg accuracy is  0.7282000001563291
compute_distance is  tensor(141.1063, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  3
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 77 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.21% 


 | Global Training Round : 78 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.00441937567666173
attack res is False
len of model dicts is  10
compute distance is  tensor(15.1891, device='cuda:2')
compute distance is  tensor(39.8270, device='cuda:2')
compute distance is  tensor(81.7870, device='cuda:2')
compute distance is  tensor(77.8594, device='cuda:2')
compute distance is  tensor(96.4242, device='cuda:2')
compute distance is  tensor(72.3949, device='cuda:2')
compute distance is  tensor(87.0110, device='cuda:2')
compute distance is  tensor(35.2680, device='cuda:2')
compute distance is  tensor(58.2582, device='cuda:2')
compute distance is  tensor(41.2381, device='cuda:2')
calculated distance threshold is  tensor(70.1189, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.9221166668229873
====================
====================
iteration is  0
round is  1
accuracy is  0.8248333334896576
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.7455000001563283
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.6913666668229979
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5903666668230051
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7533833334896612
====================
________________________________
test distance is  tensor(4707.9570, device='cuda:2')
test acc is  0.5903666668230051
test loss is 3.412925103071656
test entropy is  0.16573350785224678
________________________________
diff is  tensor(47.1020, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3449, device='cuda:2', dtype=torch.float64)
diff is  tensor(631.5371, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5707, device='cuda:2', dtype=torch.float64)
diff is  tensor(4003.7176, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.2540, device='cuda:2', dtype=torch.float64)
diff is  tensor(22.2179, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2127, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4637.8379, device='cuda:2')
sum is tensor(0.2127, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5576, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1284, device='cuda:2', dtype=torch.float64)
sum is tensor(3.3824, device='cuda:2', dtype=torch.float64)
sum is tensor(25.6003, device='cuda:2', dtype=torch.float64)
sum is tensor(72.7023, device='cuda:2', dtype=torch.float64)
sum is tensor(704.2394, device='cuda:2', dtype=torch.float64)
sum is tensor(4707.9569, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0175, device='cuda:2', dtype=torch.float64)
threshold is tensor(4003.7176, device='cuda:2', dtype=torch.float64)
cal diff is tensor(47.1020, device='cuda:2')
discard
cal diff is tensor(0.3449, device='cuda:2')
discard
cal diff is tensor(631.5370, device='cuda:2')
discard
cal diff is tensor(0.5707, device='cuda:2')
discard
cal diff is tensor(4003.7178, device='cuda:2')
clipping
cal diff is tensor(2.2540, device='cuda:2')
discard
cal diff is tensor(22.2179, device='cuda:2')
discard
cal diff is tensor(0.2127, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1293, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.02319739269443014
test entropy is  0.011223125028161814
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.1191, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(70.1293, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(70.1191, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.1191, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1292, device='cuda:2')
test acc is  0.993466666822985
test loss is 0.02319738863083981
test entropy is  0.011223127821040664
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.1190, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(70.1292, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(70.1190, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.1190, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934833334896517
test loss is 0.02322183934744519
test entropy is  0.011180718430181697
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.011180718430181697
avg test loss is  0.02322183934744519
avg accuracy is  0.9934833334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18578426836967976
avg test loss is  2.516439821928549
avg accuracy is  0.6036833334896706
compute_distance is  tensor(91.8298, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.8298, device='cuda:2')
test acc is  0.6036833334896706
test loss is 2.516439821928549
test entropy is  0.18578426836967976
________________________________
diff is  tensor(0.7409, device='cuda:2')
diff is  tensor(0.0069, device='cuda:2')
diff is  tensor(12.0590, device='cuda:2')
diff is  tensor(0.0131, device='cuda:2')
diff is  tensor(78.3255, device='cuda:2')
diff is  tensor(0.0481, device='cuda:2')
diff is  tensor(0.6359, device='cuda:2')
diff is  tensor(0.0054, device='cuda:2')
threshold is  tensor(21.7108, device='cuda:2')
sum is tensor(0.0054, device='cuda:2')
sum is tensor(0.0123, device='cuda:2')
sum is tensor(0.0254, device='cuda:2')
sum is tensor(0.0735, device='cuda:2')
sum is tensor(0.7094, device='cuda:2')
sum is tensor(1.4503, device='cuda:2')
sum is tensor(13.5093, device='cuda:2')
sum is tensor(91.8348, device='cuda:2')
ratio is tensor(0.8953, device='cuda:2')
threshold is tensor(78.3255, device='cuda:2')
cal diff is tensor(0.7409, device='cuda:2')
discard
cal diff is tensor(0.0069, device='cuda:2')
discard
cal diff is tensor(12.0590, device='cuda:2')
discard
cal diff is tensor(0.0131, device='cuda:2')
discard
cal diff is tensor(78.3255, device='cuda:2')
clipping
cal diff is tensor(0.0481, device='cuda:2')
discard
cal diff is tensor(0.6359, device='cuda:2')
discard
cal diff is tensor(0.0054, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1277, device='cuda:2')
test acc is  0.9442666668229865
test loss is 0.22172508550541492
test entropy is  0.0638576942113246
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.1243, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0088, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1623, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.1243, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(11.3867, device='cuda:2')
test acc is  0.9928000001563184
test loss is 0.02512149555714349
test entropy is  0.012109867592284697
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.012109867592284697
avg test loss is  0.02512149555714349
avg accuracy is  0.9928000001563184
compute_distance is  tensor(11.3867, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18448570554952887
avg test loss is  2.551873434962494
avg accuracy is  0.6030000001563374
compute_distance is  tensor(97.6179, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(97.6179, device='cuda:2')
test acc is  0.6030000001563374
test loss is 2.551873434962494
test entropy is  0.18448570554952887
________________________________
diff is  tensor(0.7031, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(12.1490, device='cuda:2')
diff is  tensor(0.0133, device='cuda:2')
diff is  tensor(84.1113, device='cuda:2')
diff is  tensor(0.0427, device='cuda:2')
diff is  tensor(0.5877, device='cuda:2')
diff is  tensor(0.0049, device='cuda:2')
threshold is  tensor(27.4989, device='cuda:2')
sum is tensor(0.0049, device='cuda:2')
sum is tensor(0.0115, device='cuda:2')
sum is tensor(0.0247, device='cuda:2')
sum is tensor(0.0674, device='cuda:2')
sum is tensor(0.6551, device='cuda:2')
sum is tensor(1.3583, device='cuda:2')
sum is tensor(13.5073, device='cuda:2')
sum is tensor(97.6186, device='cuda:2')
ratio is tensor(0.8337, device='cuda:2')
threshold is tensor(84.1113, device='cuda:2')
cal diff is tensor(0.7031, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(12.1490, device='cuda:2')
discard
cal diff is tensor(0.0133, device='cuda:2')
discard
cal diff is tensor(84.1113, device='cuda:2')
clipping
cal diff is tensor(0.0427, device='cuda:2')
discard
cal diff is tensor(0.5877, device='cuda:2')
discard
cal diff is tensor(0.0049, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1249, device='cuda:2')
test acc is  0.9543833334896529
test loss is 0.178076732774179
test entropy is  0.05587720287107884
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.1201, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0060, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.4683, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.1201, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(32.8418, device='cuda:2')
test acc is  0.9892666668229851
test loss is 0.03797535797508023
test entropy is  0.017240690882465104
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.017240690882465104
avg test loss is  0.03797535797508023
avg accuracy is  0.9892666668229851
compute_distance is  tensor(32.8418, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18202769684829692
avg test loss is  2.6119088831105466
avg accuracy is  0.6009166668230042
compute_distance is  tensor(109.3650, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(109.3650, device='cuda:2')
test acc is  0.6009166668230042
test loss is 2.6119088831105466
test entropy is  0.18202769684829692
________________________________
diff is  tensor(0.6707, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(12.1435, device='cuda:2')
diff is  tensor(0.0129, device='cuda:2')
diff is  tensor(95.9699, device='cuda:2')
diff is  tensor(0.0352, device='cuda:2')
diff is  tensor(0.5170, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
threshold is  tensor(39.2461, device='cuda:2')
sum is tensor(0.0041, device='cuda:2')
sum is tensor(0.0106, device='cuda:2')
sum is tensor(0.0235, device='cuda:2')
sum is tensor(0.0587, device='cuda:2')
sum is tensor(0.5757, device='cuda:2')
sum is tensor(1.2464, device='cuda:2')
sum is tensor(13.3899, device='cuda:2')
sum is tensor(109.3598, device='cuda:2')
ratio is tensor(0.7306, device='cuda:2')
threshold is tensor(95.9699, device='cuda:2')
cal diff is tensor(0.6707, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(12.1435, device='cuda:2')
discard
cal diff is tensor(0.0129, device='cuda:2')
discard
cal diff is tensor(95.9699, device='cuda:2')
clipping
cal diff is tensor(0.0352, device='cuda:2')
discard
cal diff is tensor(0.5170, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1212, device='cuda:2')
test acc is  0.9646500001563192
test loss is 0.1345060808942819
test entropy is  0.04691439674264177
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(70.1141, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0023, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8779, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(70.1141, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(61.5634, device='cuda:2')
test acc is  0.9751333334896521
test loss is 0.09271824503067269
test entropy is  0.03554865388316475
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03554865388316475
avg test loss is  0.09271824503067269
avg accuracy is  0.9751333334896521
compute_distance is  tensor(61.5634, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17944140462224673
avg test loss is  2.6761053333531564
avg accuracy is  0.6007666668230042
compute_distance is  tensor(126.3258, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(126.3258, device='cuda:2')
test acc is  0.6007666668230042
test loss is 2.6761053333531564
test entropy is  0.17944140462224673
________________________________
diff is  tensor(0.6402, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(11.3268, device='cuda:2')
diff is  tensor(0.0117, device='cuda:2')
diff is  tensor(113.8544, device='cuda:2')
diff is  tensor(0.0275, device='cuda:2')
diff is  tensor(0.4443, device='cuda:2')
diff is  tensor(0.0033, device='cuda:2')
threshold is  tensor(56.2069, device='cuda:2')
sum is tensor(0.0033, device='cuda:2')
sum is tensor(0.0096, device='cuda:2')
sum is tensor(0.0213, device='cuda:2')
sum is tensor(0.0488, device='cuda:2')
sum is tensor(0.4931, device='cuda:2')
sum is tensor(1.1333, device='cuda:2')
sum is tensor(12.4601, device='cuda:2')
sum is tensor(126.3145, device='cuda:2')
ratio is tensor(0.6158, device='cuda:2')
threshold is tensor(113.8544, device='cuda:2')
cal diff is tensor(0.6402, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(11.3268, device='cuda:2')
discard
cal diff is tensor(0.0117, device='cuda:2')
discard
cal diff is tensor(113.8544, device='cuda:2')
clipping
cal diff is tensor(0.0275, device='cuda:2')
discard
cal diff is tensor(0.4443, device='cuda:2')
discard
cal diff is tensor(0.0033, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1178, device='cuda:2')
test acc is  0.9723166668229857
test loss is 0.100791091918012
test entropy is  0.03880280475927714
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03880280475927714
avg test loss is  0.100791091918012
avg accuracy is  0.9723166668229857
compute_distance is  tensor(70.1178, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17886136105256295
avg test loss is  2.694344634122686
avg accuracy is  0.6007000001563375
compute_distance is  tensor(133.4880, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(133.4880, device='cuda:2')
test acc is  0.6007000001563375
test loss is 2.694344634122686
test entropy is  0.17886136105256295
________________________________
diff is  tensor(0.6563, device='cuda:2')
diff is  tensor(0.0062, device='cuda:2')
diff is  tensor(11.2341, device='cuda:2')
diff is  tensor(0.0116, device='cuda:2')
diff is  tensor(121.1128, device='cuda:2')
diff is  tensor(0.0262, device='cuda:2')
diff is  tensor(0.4239, device='cuda:2')
diff is  tensor(0.0031, device='cuda:2')
threshold is  tensor(63.3691, device='cuda:2')
sum is tensor(0.0031, device='cuda:2')
sum is tensor(0.0093, device='cuda:2')
sum is tensor(0.0208, device='cuda:2')
sum is tensor(0.0470, device='cuda:2')
sum is tensor(0.4709, device='cuda:2')
sum is tensor(1.1272, device='cuda:2')
sum is tensor(12.3613, device='cuda:2')
sum is tensor(133.4741, device='cuda:2')
ratio is tensor(0.5788, device='cuda:2')
threshold is tensor(121.1128, device='cuda:2')
cal diff is tensor(0.6563, device='cuda:2')
discard
cal diff is tensor(0.0062, device='cuda:2')
discard
cal diff is tensor(11.2341, device='cuda:2')
discard
cal diff is tensor(0.0116, device='cuda:2')
discard
cal diff is tensor(121.1128, device='cuda:2')
clipping
cal diff is tensor(0.0262, device='cuda:2')
discard
cal diff is tensor(0.4239, device='cuda:2')
discard
cal diff is tensor(0.0031, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1168, device='cuda:2')
test acc is  0.9762333334896522
test loss is 0.08692591952423487
test entropy is  0.034972719153325296
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.034972719153325296
avg test loss is  0.08692591952423487
avg accuracy is  0.9762333334896522
compute_distance is  tensor(70.1168, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17889886714819905
avg test loss is  2.694736214716043
avg accuracy is  0.6007333334896708
compute_distance is  tensor(134.6137, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(134.6137, device='cuda:2')
test acc is  0.6007333334896708
test loss is 2.694736214716043
test entropy is  0.17889886714819905
________________________________
diff is  tensor(0.6618, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.4357, device='cuda:2')
diff is  tensor(0.0119, device='cuda:2')
diff is  tensor(122.0290, device='cuda:2')
diff is  tensor(0.0269, device='cuda:2')
diff is  tensor(0.4241, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(64.4947, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0095, device='cuda:2')
sum is tensor(0.0214, device='cuda:2')
sum is tensor(0.0483, device='cuda:2')
sum is tensor(0.4723, device='cuda:2')
sum is tensor(1.1342, device='cuda:2')
sum is tensor(12.5699, device='cuda:2')
sum is tensor(134.5989, device='cuda:2')
ratio is tensor(0.5745, device='cuda:2')
threshold is tensor(122.0290, device='cuda:2')
cal diff is tensor(0.6618, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.4357, device='cuda:2')
discard
cal diff is tensor(0.0119, device='cuda:2')
discard
cal diff is tensor(122.0290, device='cuda:2')
clipping
cal diff is tensor(0.0269, device='cuda:2')
discard
cal diff is tensor(0.4241, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
________________________________
test distance is  tensor(70.1167, device='cuda:2')
test acc is  0.9774666668229856
test loss is 0.08274572570948399
test entropy is  0.03373166669699634
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03373166669699634
avg test loss is  0.08274572570948399
avg accuracy is  0.9774666668229856
compute_distance is  tensor(70.1167, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17886739292505707
avg test loss is  2.6962161304981214
avg accuracy is  0.6006333334896709
compute_distance is  tensor(135.0444, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(135.0444, device='cuda:2')
test acc is  0.6006333334896709
test loss is 2.6962161304981214
test entropy is  0.17886739292505707
________________________________
diff is  tensor(0.6635, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(11.5189, device='cuda:2')
diff is  tensor(0.0120, device='cuda:2')
diff is  tensor(122.3734, device='cuda:2')
diff is  tensor(0.0272, device='cuda:2')
diff is  tensor(0.4244, device='cuda:2')
diff is  tensor(0.0032, device='cuda:2')
threshold is  tensor(64.9254, device='cuda:2')
sum is tensor(0.0032, device='cuda:2')
sum is tensor(0.0096, device='cuda:2')
sum is tensor(0.0216, device='cuda:2')
sum is tensor(0.0488, device='cuda:2')
sum is tensor(0.4732, device='cuda:2')
sum is tensor(1.1367, device='cuda:2')
sum is tensor(12.6556, device='cuda:2')
sum is tensor(135.0291, device='cuda:2')
ratio is tensor(0.5729, device='cuda:2')
threshold is tensor(122.3734, device='cuda:2')
cal diff is tensor(0.6635, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(11.5189, device='cuda:2')
discard
cal diff is tensor(0.0120, device='cuda:2')
discard
cal diff is tensor(122.3734, device='cuda:2')
clipping
cal diff is tensor(0.0272, device='cuda:2')
discard
cal diff is tensor(0.4244, device='cuda:2')
discard
cal diff is tensor(0.0032, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 78 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.21% 


 | Global Training Round : 79 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004432590212672949
attack res is False
len of model dicts is  10
compute distance is  tensor(13.2067, device='cuda:2')
compute distance is  tensor(74.9089, device='cuda:2')
compute distance is  tensor(83.4842, device='cuda:2')
compute distance is  tensor(113.4350, device='cuda:2')
compute distance is  tensor(39.0785, device='cuda:2')
compute distance is  tensor(47.5193, device='cuda:2')
compute distance is  tensor(44.8456, device='cuda:2')
compute distance is  tensor(41.8433, device='cuda:2')
compute distance is  tensor(72.2766, device='cuda:2')
compute distance is  tensor(117.4687, device='cuda:2')
calculated distance threshold is  tensor(83.7069, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8408000001563238
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8067166668229919
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8282333334896577
====================
====================
iteration is  1
round is  0
accuracy is  0.7005500001563307
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7991333334896588
====================
________________________________
test distance is  tensor(4283.3086, device='cuda:2')
test acc is  0.7005500001563307
test loss is 2.6669257038564824
test entropy is  0.1744406112491576
________________________________
diff is  tensor(45.4538, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2841, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.3410, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4957, device='cuda:2', dtype=torch.float64)
diff is  tensor(3643.0950, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0788, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3332, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2272, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4199.6016, device='cuda:2')
sum is tensor(0.2272, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5113, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0069, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0857, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4189, device='cuda:2', dtype=torch.float64)
sum is tensor(68.8727, device='cuda:2', dtype=torch.float64)
sum is tensor(640.2137, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.3087, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0230, device='cuda:2', dtype=torch.float64)
threshold is tensor(3643.0950, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.4538, device='cuda:2')
discard
cal diff is tensor(0.2841, device='cuda:2')
discard
cal diff is tensor(571.3410, device='cuda:2')
discard
cal diff is tensor(0.4957, device='cuda:2')
discard
cal diff is tensor(3643.0950, device='cuda:2')
discard
cal diff is tensor(2.0788, device='cuda:2')
discard
cal diff is tensor(20.3332, device='cuda:2')
discard
cal diff is tensor(0.2272, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934500001563183
test loss is 0.023208794495740245
test entropy is  0.01118171440430839
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01118171440430839
avg test loss is  0.023208794495740245
avg accuracy is  0.9934500001563183
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18162016545944631
avg test loss is  2.0642165191836956
avg accuracy is  0.7385500001563287
compute_distance is  tensor(93.1008, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.1008, device='cuda:2')
test acc is  0.7385500001563287
test loss is 2.0642165191836956
test entropy is  0.18162016545944631
________________________________
diff is  tensor(0.8331, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(13.5659, device='cuda:2')
diff is  tensor(0.0149, device='cuda:2')
diff is  tensor(78.0807, device='cuda:2')
diff is  tensor(0.0449, device='cuda:2')
diff is  tensor(0.5504, device='cuda:2')
diff is  tensor(0.0041, device='cuda:2')
threshold is  tensor(9.3939, device='cuda:2')
sum is tensor(0.0041, device='cuda:2')
sum is tensor(0.0118, device='cuda:2')
sum is tensor(0.0267, device='cuda:2')
sum is tensor(0.0715, device='cuda:2')
sum is tensor(0.6219, device='cuda:2')
sum is tensor(1.4550, device='cuda:2')
sum is tensor(15.0209, device='cuda:2')
ratio is tensor(0.4148, device='cuda:2')
threshold is tensor(13.5659, device='cuda:2')
cal diff is tensor(0.8331, device='cuda:2')
discard
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(13.5659, device='cuda:2')
clipping
cal diff is tensor(0.0149, device='cuda:2')
discard
cal diff is tensor(78.0807, device='cuda:2')
clipping
cal diff is tensor(0.0449, device='cuda:2')
discard
cal diff is tensor(0.5504, device='cuda:2')
discard
cal diff is tensor(0.0041, device='cuda:2')
discard
________________________________
test distance is  tensor(38.0145, device='cuda:2')
test acc is  0.9883166668229851
test loss is 0.03888057213227196
test entropy is  0.022025662354986816
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.022025662354986816
avg test loss is  0.03888057213227196
avg accuracy is  0.9883166668229851
compute_distance is  tensor(38.0145, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18002424665542047
avg test loss is  2.2021939818665923
avg accuracy is  0.731300000156329
compute_distance is  tensor(109.3872, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(109.3872, device='cuda:2')
test acc is  0.731300000156329
test loss is 2.2021939818665923
test entropy is  0.18002424665542047
________________________________
diff is  tensor(0.7298, device='cuda:2')
diff is  tensor(0.0076, device='cuda:2')
diff is  tensor(16.4730, device='cuda:2')
diff is  tensor(0.0123, device='cuda:2')
diff is  tensor(91.6948, device='cuda:2')
diff is  tensor(0.0296, device='cuda:2')
diff is  tensor(0.4307, device='cuda:2')
diff is  tensor(0.0026, device='cuda:2')
threshold is  tensor(25.6803, device='cuda:2')
sum is tensor(0.0026, device='cuda:2')
sum is tensor(0.0103, device='cuda:2')
sum is tensor(0.0225, device='cuda:2')
sum is tensor(0.0521, device='cuda:2')
sum is tensor(0.4828, device='cuda:2')
sum is tensor(1.2126, device='cuda:2')
sum is tensor(17.6856, device='cuda:2')
sum is tensor(109.3804, device='cuda:2')
ratio is tensor(0.9128, device='cuda:2')
threshold is tensor(91.6948, device='cuda:2')
cal diff is tensor(0.7298, device='cuda:2')
discard
cal diff is tensor(0.0076, device='cuda:2')
discard
cal diff is tensor(16.4730, device='cuda:2')
discard
cal diff is tensor(0.0123, device='cuda:2')
discard
cal diff is tensor(91.6948, device='cuda:2')
clipping
cal diff is tensor(0.0296, device='cuda:2')
discard
cal diff is tensor(0.4307, device='cuda:2')
discard
cal diff is tensor(0.0026, device='cuda:2')
discard
________________________________
test distance is  tensor(83.7091, device='cuda:2')
test acc is  0.9500166668229864
test loss is 0.17266477670916208
test entropy is  0.07302376950906316
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(83.7002, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0022, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.8855, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(83.7002, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(74.1279, device='cuda:2')
test acc is  0.9688500001563191
test loss is 0.10418560459688832
test entropy is  0.05272757661030459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05272757661030459
avg test loss is  0.10418560459688832
avg accuracy is  0.9688500001563191
compute_distance is  tensor(74.1279, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18036828436322813
avg test loss is  2.28887634694195
avg accuracy is  0.7266333334896626
compute_distance is  tensor(133.4545, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(133.4545, device='cuda:2')
test acc is  0.7266333334896626
test loss is 2.28887634694195
test entropy is  0.18036828436322813
________________________________
diff is  tensor(0.7446, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.1545, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(121.1297, device='cuda:2')
diff is  tensor(0.0247, device='cuda:2')
diff is  tensor(0.3670, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(49.7476, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0199, device='cuda:2')
sum is tensor(0.0446, device='cuda:2')
sum is tensor(0.4116, device='cuda:2')
sum is tensor(1.1562, device='cuda:2')
sum is tensor(12.3107, device='cuda:2')
sum is tensor(133.4404, device='cuda:2')
ratio is tensor(0.6909, device='cuda:2')
threshold is tensor(121.1297, device='cuda:2')
cal diff is tensor(0.7446, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.1545, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(121.1297, device='cuda:2')
clipping
cal diff is tensor(0.0247, device='cuda:2')
discard
cal diff is tensor(0.3670, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(83.7044, device='cuda:2')
test acc is  0.9613500001563193
test loss is 0.1329239682626547
test entropy is  0.06325816034551845
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.06325816034551845
avg test loss is  0.1329239682626547
avg accuracy is  0.9613500001563193
compute_distance is  tensor(83.7044, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1806299128114923
avg test loss is  2.300361570074106
avg accuracy is  0.7254333334896628
compute_distance is  tensor(141.3884, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(141.3884, device='cuda:2')
test acc is  0.7254333334896628
test loss is 2.300361570074106
test entropy is  0.1806299128114923
________________________________
diff is  tensor(0.7644, device='cuda:2')
diff is  tensor(0.0063, device='cuda:2')
diff is  tensor(10.8875, device='cuda:2')
diff is  tensor(0.0107, device='cuda:2')
diff is  tensor(129.3344, device='cuda:2')
diff is  tensor(0.0226, device='cuda:2')
diff is  tensor(0.3435, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(57.6815, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0084, device='cuda:2')
sum is tensor(0.0190, device='cuda:2')
sum is tensor(0.0417, device='cuda:2')
sum is tensor(0.3852, device='cuda:2')
sum is tensor(1.1496, device='cuda:2')
sum is tensor(12.0370, device='cuda:2')
sum is tensor(141.3714, device='cuda:2')
ratio is tensor(0.6471, device='cuda:2')
threshold is tensor(129.3344, device='cuda:2')
cal diff is tensor(0.7644, device='cuda:2')
discard
cal diff is tensor(0.0063, device='cuda:2')
discard
cal diff is tensor(10.8875, device='cuda:2')
discard
cal diff is tensor(0.0107, device='cuda:2')
discard
cal diff is tensor(129.3344, device='cuda:2')
clipping
cal diff is tensor(0.0226, device='cuda:2')
discard
cal diff is tensor(0.3435, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(83.7032, device='cuda:2')
test acc is  0.9676833334896524
test loss is 0.1096678281380452
test entropy is  0.05522128037596022
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05522128037596022
avg test loss is  0.1096678281380452
avg accuracy is  0.9676833334896524
compute_distance is  tensor(83.7032, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1806378749721467
avg test loss is  2.303568991707332
avg accuracy is  0.7253500001563294
compute_distance is  tensor(142.9500, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(142.9500, device='cuda:2')
test acc is  0.7253500001563294
test loss is 2.303568991707332
test entropy is  0.1806378749721467
________________________________
diff is  tensor(0.7701, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.1222, device='cuda:2')
diff is  tensor(0.0110, device='cuda:2')
diff is  tensor(130.6550, device='cuda:2')
diff is  tensor(0.0233, device='cuda:2')
diff is  tensor(0.3418, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(59.2431, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0086, device='cuda:2')
sum is tensor(0.0196, device='cuda:2')
sum is tensor(0.0429, device='cuda:2')
sum is tensor(0.3847, device='cuda:2')
sum is tensor(1.1547, device='cuda:2')
sum is tensor(12.2769, device='cuda:2')
sum is tensor(142.9319, device='cuda:2')
ratio is tensor(0.6405, device='cuda:2')
threshold is tensor(130.6550, device='cuda:2')
cal diff is tensor(0.7701, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.1222, device='cuda:2')
discard
cal diff is tensor(0.0110, device='cuda:2')
discard
cal diff is tensor(130.6550, device='cuda:2')
clipping
cal diff is tensor(0.0233, device='cuda:2')
discard
cal diff is tensor(0.3418, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(83.7030, device='cuda:2')
test acc is  0.9698166668229857
test loss is 0.10187451228340427
test entropy is  0.0522083455485963
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0522083455485963
avg test loss is  0.10187451228340427
avg accuracy is  0.9698166668229857
compute_distance is  tensor(83.7030, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18056976984241116
avg test loss is  2.306830981043356
avg accuracy is  0.725166666822996
compute_distance is  tensor(143.5573, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(143.5573, device='cuda:2')
test acc is  0.725166666822996
test loss is 2.306830981043356
test entropy is  0.18056976984241116
________________________________
diff is  tensor(0.7724, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.2439, device='cuda:2')
diff is  tensor(0.0111, device='cuda:2')
diff is  tensor(131.1369, device='cuda:2')
diff is  tensor(0.0237, device='cuda:2')
diff is  tensor(0.3418, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(59.8504, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0087, device='cuda:2')
sum is tensor(0.0199, device='cuda:2')
sum is tensor(0.0435, device='cuda:2')
sum is tensor(0.3853, device='cuda:2')
sum is tensor(1.1577, device='cuda:2')
sum is tensor(12.4016, device='cuda:2')
sum is tensor(143.5386, device='cuda:2')
ratio is tensor(0.6382, device='cuda:2')
threshold is tensor(131.1369, device='cuda:2')
cal diff is tensor(0.7724, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.2439, device='cuda:2')
discard
cal diff is tensor(0.0111, device='cuda:2')
discard
cal diff is tensor(131.1369, device='cuda:2')
clipping
cal diff is tensor(0.0237, device='cuda:2')
discard
cal diff is tensor(0.3418, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(83.7029, device='cuda:2')
test acc is  0.970550000156319
test loss is 0.0986856520856678
test entropy is  0.05092104108468481
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05092104108468481
avg test loss is  0.0986856520856678
avg accuracy is  0.970550000156319
compute_distance is  tensor(83.7029, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1805546129150177
avg test loss is  2.3089869127853087
avg accuracy is  0.7252166668229961
compute_distance is  tensor(143.8231, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(143.8231, device='cuda:2')
test acc is  0.7252166668229961
test loss is 2.3089869127853087
test entropy is  0.1805546129150177
________________________________
diff is  tensor(0.7730, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(11.2981, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(131.3471, device='cuda:2')
diff is  tensor(0.0238, device='cuda:2')
diff is  tensor(0.3418, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(60.1162, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0200, device='cuda:2')
sum is tensor(0.0438, device='cuda:2')
sum is tensor(0.3856, device='cuda:2')
sum is tensor(1.1587, device='cuda:2')
sum is tensor(12.4568, device='cuda:2')
sum is tensor(143.8039, device='cuda:2')
ratio is tensor(0.6371, device='cuda:2')
threshold is tensor(131.3471, device='cuda:2')
cal diff is tensor(0.7730, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(11.2981, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(131.3471, device='cuda:2')
clipping
cal diff is tensor(0.0238, device='cuda:2')
discard
cal diff is tensor(0.3418, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(83.7028, device='cuda:2')
test acc is  0.9710333334896523
test loss is 0.09714664388579557
test entropy is  0.050270554990987225
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.050270554990987225
avg test loss is  0.09714664388579557
avg accuracy is  0.9710333334896523
compute_distance is  tensor(83.7028, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18053292325024667
avg test loss is  2.31097450734837
avg accuracy is  0.7252166668229961
compute_distance is  tensor(143.9327, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(143.9327, device='cuda:2')
test acc is  0.7252166668229961
test loss is 2.31097450734837
test entropy is  0.18053292325024667
________________________________
diff is  tensor(0.7727, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(11.3216, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(131.4331, device='cuda:2')
diff is  tensor(0.0240, device='cuda:2')
diff is  tensor(0.3417, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(60.2258, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0200, device='cuda:2')
sum is tensor(0.0440, device='cuda:2')
sum is tensor(0.3857, device='cuda:2')
sum is tensor(1.1584, device='cuda:2')
sum is tensor(12.4800, device='cuda:2')
sum is tensor(143.9131, device='cuda:2')
ratio is tensor(0.6367, device='cuda:2')
threshold is tensor(131.4331, device='cuda:2')
cal diff is tensor(0.7727, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(11.3216, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(131.4331, device='cuda:2')
clipping
cal diff is tensor(0.0240, device='cuda:2')
discard
cal diff is tensor(0.3417, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(83.7028, device='cuda:2')
test acc is  0.9711833334896524
test loss is 0.09637227190202904
test entropy is  0.04991940764011815
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04991940764011815
avg test loss is  0.09637227190202904
avg accuracy is  0.9711833334896524
compute_distance is  tensor(83.7028, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18051474338877938
avg test loss is  2.312671832597332
avg accuracy is  0.7250333334896627
compute_distance is  tensor(143.9998, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(143.9998, device='cuda:2')
test acc is  0.7250333334896627
test loss is 2.312671832597332
test entropy is  0.18051474338877938
________________________________
diff is  tensor(0.7727, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(11.3354, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(131.4864, device='cuda:2')
diff is  tensor(0.0240, device='cuda:2')
diff is  tensor(0.3414, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(60.2929, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0201, device='cuda:2')
sum is tensor(0.0441, device='cuda:2')
sum is tensor(0.3855, device='cuda:2')
sum is tensor(1.1582, device='cuda:2')
sum is tensor(12.4936, device='cuda:2')
sum is tensor(143.9800, device='cuda:2')
ratio is tensor(0.6365, device='cuda:2')
threshold is tensor(131.4864, device='cuda:2')
cal diff is tensor(0.7727, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(11.3354, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(131.4864, device='cuda:2')
clipping
cal diff is tensor(0.0240, device='cuda:2')
discard
cal diff is tensor(0.3414, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
reach max round
new distance ratio is 0.7438016528925617
current aggregation staleness i is  1
num1 of attacker is  0
current aggregation staleness i is  2
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 79 global rounds:
Train Accuracy: 98.98% 

Test Accuracy: 99.20% 


 | Global Training Round : 80 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.004390562418848276
attack res is False
len of model dicts is  10
compute distance is  tensor(19.4631, device='cuda:2')
compute distance is  tensor(105.5389, device='cuda:2')
compute distance is  tensor(103.9950, device='cuda:2')
compute distance is  tensor(98.2489, device='cuda:2')
compute distance is  tensor(39.1729, device='cuda:2')
compute distance is  tensor(76.5266, device='cuda:2')
compute distance is  tensor(59.1638, device='cuda:2')
compute distance is  tensor(42.1826, device='cuda:2')
compute distance is  tensor(73.6592, device='cuda:2')
compute distance is  tensor(45.9524, device='cuda:2')
calculated distance threshold is  tensor(77.6661, device='cuda:2')
pinned_accuracy threshold is  0.8421000001570009
====================
iteration is  0
round is  0
accuracy is  0.8196166668229914
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8073500001563251
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.77438333348966
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.7907333334896595
====================
====================
iteration is  1
round is  1
accuracy is  0.8086833334896585
====================
________________________________
test distance is  tensor(4283.3438, device='cuda:2')
test acc is  0.77438333348966
test loss is 1.4204180068743508
test entropy is  0.1513567043384954
________________________________
diff is  tensor(45.0897, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3701, device='cuda:2', dtype=torch.float64)
diff is  tensor(572.1335, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4932, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.7616, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0295, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2530, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2135, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4205.6777, device='cuda:2')
sum is tensor(0.2135, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5836, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0768, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1064, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3593, device='cuda:2', dtype=torch.float64)
sum is tensor(68.4490, device='cuda:2', dtype=torch.float64)
sum is tensor(640.5825, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.3441, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0213, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.7616, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.0897, device='cuda:2')
discard
cal diff is tensor(0.3701, device='cuda:2')
discard
cal diff is tensor(572.1335, device='cuda:2')
discard
cal diff is tensor(0.4932, device='cuda:2')
discard
cal diff is tensor(3642.7615, device='cuda:2')
discard
cal diff is tensor(2.0295, device='cuda:2')
discard
cal diff is tensor(20.2530, device='cuda:2')
discard
cal diff is tensor(0.2135, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9934333334896517
test loss is 0.023219958904849534
test entropy is  0.01119086231726897
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01119086231726897
avg test loss is  0.023219958904849534
avg accuracy is  0.9934333334896517
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1541495292918133
avg test loss is  0.8979596928047981
avg accuracy is  0.8157000001563248
compute_distance is  tensor(87.2467, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(87.2467, device='cuda:2')
test acc is  0.8157000001563248
test loss is 0.8979596928047981
test entropy is  0.1541495292918133
________________________________
diff is  tensor(0.7443, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(12.0576, device='cuda:2')
diff is  tensor(0.0136, device='cuda:2')
diff is  tensor(73.8180, device='cuda:2')
diff is  tensor(0.0438, device='cuda:2')
diff is  tensor(0.5612, device='cuda:2')
diff is  tensor(0.0042, device='cuda:2')
threshold is  tensor(9.5805, device='cuda:2')
sum is tensor(0.0042, device='cuda:2')
sum is tensor(0.0110, device='cuda:2')
sum is tensor(0.0246, device='cuda:2')
sum is tensor(0.0684, device='cuda:2')
sum is tensor(0.6296, device='cuda:2')
sum is tensor(1.3739, device='cuda:2')
sum is tensor(13.4315, device='cuda:2')
ratio is tensor(0.3194, device='cuda:2')
threshold is tensor(12.0576, device='cuda:2')
cal diff is tensor(0.7443, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(12.0576, device='cuda:2')
clipping
cal diff is tensor(0.0136, device='cuda:2')
discard
cal diff is tensor(73.8180, device='cuda:2')
clipping
cal diff is tensor(0.0438, device='cuda:2')
discard
cal diff is tensor(0.5612, device='cuda:2')
discard
cal diff is tensor(0.0042, device='cuda:2')
discard
________________________________
test distance is  tensor(27.4264, device='cuda:2')
test acc is  0.9912500001563184
test loss is 0.03032238006010003
test entropy is  0.015061633946458732
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.015061633946458732
avg test loss is  0.03032238006010003
avg accuracy is  0.9912500001563184
compute_distance is  tensor(27.4264, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15540819776369563
avg test loss is  0.9589588170779794
avg accuracy is  0.8066000001563253
compute_distance is  tensor(100.0665, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(100.0665, device='cuda:2')
test acc is  0.8066000001563253
test loss is 0.9589588170779794
test entropy is  0.15540819776369563
________________________________
diff is  tensor(0.6555, device='cuda:2')
diff is  tensor(0.0062, device='cuda:2')
diff is  tensor(14.2850, device='cuda:2')
diff is  tensor(0.0120, device='cuda:2')
diff is  tensor(84.5908, device='cuda:2')
diff is  tensor(0.0322, device='cuda:2')
diff is  tensor(0.4779, device='cuda:2')
diff is  tensor(0.0031, device='cuda:2')
threshold is  tensor(22.4003, device='cuda:2')
sum is tensor(0.0031, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0212, device='cuda:2')
sum is tensor(0.0534, device='cuda:2')
sum is tensor(0.5313, device='cuda:2')
sum is tensor(1.1868, device='cuda:2')
sum is tensor(15.4718, device='cuda:2')
sum is tensor(100.0626, device='cuda:2')
ratio is tensor(0.9181, device='cuda:2')
threshold is tensor(84.5908, device='cuda:2')
cal diff is tensor(0.6555, device='cuda:2')
discard
cal diff is tensor(0.0062, device='cuda:2')
discard
cal diff is tensor(14.2850, device='cuda:2')
discard
cal diff is tensor(0.0120, device='cuda:2')
discard
cal diff is tensor(84.5908, device='cuda:2')
clipping
cal diff is tensor(0.0322, device='cuda:2')
discard
cal diff is tensor(0.4779, device='cuda:2')
discard
cal diff is tensor(0.0031, device='cuda:2')
discard
________________________________
test distance is  tensor(77.6718, device='cuda:2')
test acc is  0.9713833334896523
test loss is 0.10449161794354535
test entropy is  0.04018108374549638
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.6623, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0056, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.5062, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.6623, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(39.3229, device='cuda:2')
test acc is  0.9902333334896517
test loss is 0.0342030057293816
test entropy is  0.01668911336857611
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.01668911336857611
avg test loss is  0.0342030057293816
avg accuracy is  0.9902333334896517
compute_distance is  tensor(39.3229, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15647429078499644
avg test loss is  0.9839743100948679
avg accuracy is  0.8030666668229921
compute_distance is  tensor(109.9305, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(109.9305, device='cuda:2')
test acc is  0.8030666668229921
test loss is 0.9839743100948679
test entropy is  0.15647429078499644
________________________________
diff is  tensor(0.6909, device='cuda:2')
diff is  tensor(0.0065, device='cuda:2')
diff is  tensor(11.4454, device='cuda:2')
diff is  tensor(0.0129, device='cuda:2')
diff is  tensor(97.2843, device='cuda:2')
diff is  tensor(0.0311, device='cuda:2')
diff is  tensor(0.4488, device='cuda:2')
diff is  tensor(0.0030, device='cuda:2')
threshold is  tensor(32.2644, device='cuda:2')
sum is tensor(0.0030, device='cuda:2')
sum is tensor(0.0095, device='cuda:2')
sum is tensor(0.0224, device='cuda:2')
sum is tensor(0.0535, device='cuda:2')
sum is tensor(0.5023, device='cuda:2')
sum is tensor(1.1932, device='cuda:2')
sum is tensor(12.6386, device='cuda:2')
sum is tensor(109.9229, device='cuda:2')
ratio is tensor(0.7983, device='cuda:2')
threshold is tensor(97.2843, device='cuda:2')
cal diff is tensor(0.6909, device='cuda:2')
discard
cal diff is tensor(0.0065, device='cuda:2')
discard
cal diff is tensor(11.4454, device='cuda:2')
discard
cal diff is tensor(0.0129, device='cuda:2')
discard
cal diff is tensor(97.2843, device='cuda:2')
clipping
cal diff is tensor(0.0311, device='cuda:2')
discard
cal diff is tensor(0.4488, device='cuda:2')
discard
cal diff is tensor(0.0030, device='cuda:2')
discard
________________________________
test distance is  tensor(77.6692, device='cuda:2')
test acc is  0.9742666668229856
test loss is 0.09310948467578213
test entropy is  0.03824963133376556
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(77.6585, device='cuda:2')
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0030, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.7945, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(77.6585, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(61.7097, device='cuda:2')
test acc is  0.983733333489652
test loss is 0.055794503715549344
test entropy is  0.025760551010600916
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.025760551010600916
avg test loss is  0.055794503715549344
avg accuracy is  0.983733333489652
compute_distance is  tensor(61.7097, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.156861882069027
avg test loss is  1.0231712780781645
avg accuracy is  0.7984000001563255
compute_distance is  tensor(123.7361, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(123.7361, device='cuda:2')
test acc is  0.7984000001563255
test loss is 1.0231712780781645
test entropy is  0.156861882069027
________________________________
diff is  tensor(0.6952, device='cuda:2')
diff is  tensor(0.0068, device='cuda:2')
diff is  tensor(10.6721, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(111.9117, device='cuda:2')
diff is  tensor(0.0253, device='cuda:2')
diff is  tensor(0.3984, device='cuda:2')
diff is  tensor(0.0024, device='cuda:2')
threshold is  tensor(46.0700, device='cuda:2')
sum is tensor(0.0024, device='cuda:2')
sum is tensor(0.0092, device='cuda:2')
sum is tensor(0.0207, device='cuda:2')
sum is tensor(0.0460, device='cuda:2')
sum is tensor(0.4444, device='cuda:2')
sum is tensor(1.1395, device='cuda:2')
sum is tensor(11.8116, device='cuda:2')
sum is tensor(123.7234, device='cuda:2')
ratio is tensor(0.6939, device='cuda:2')
threshold is tensor(111.9117, device='cuda:2')
cal diff is tensor(0.6952, device='cuda:2')
discard
cal diff is tensor(0.0068, device='cuda:2')
discard
cal diff is tensor(10.6721, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(111.9117, device='cuda:2')
clipping
cal diff is tensor(0.0253, device='cuda:2')
discard
cal diff is tensor(0.3984, device='cuda:2')
discard
cal diff is tensor(0.0024, device='cuda:2')
discard
________________________________
test distance is  tensor(77.6660, device='cuda:2')
test acc is  0.9788666668229855
test loss is 0.07566919911501296
test entropy is  0.033269371416364886
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.033269371416364886
avg test loss is  0.07566919911501296
avg accuracy is  0.9788666668229855
compute_distance is  tensor(77.6660, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15685531395330612
avg test loss is  1.0508356609705414
avg accuracy is  0.7968000001563257
compute_distance is  tensor(134.6445, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(134.6445, device='cuda:2')
test acc is  0.7968000001563257
test loss is 1.0508356609705414
test entropy is  0.15685531395330612
________________________________
diff is  tensor(0.7100, device='cuda:2')
diff is  tensor(0.0064, device='cuda:2')
diff is  tensor(10.2476, device='cuda:2')
diff is  tensor(0.0108, device='cuda:2')
diff is  tensor(123.2660, device='cuda:2')
diff is  tensor(0.0221, device='cuda:2')
diff is  tensor(0.3632, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(56.9783, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0085, device='cuda:2')
sum is tensor(0.0193, device='cuda:2')
sum is tensor(0.0414, device='cuda:2')
sum is tensor(0.4045, device='cuda:2')
sum is tensor(1.1145, device='cuda:2')
sum is tensor(11.3622, device='cuda:2')
sum is tensor(134.6282, device='cuda:2')
ratio is tensor(0.6299, device='cuda:2')
threshold is tensor(123.2660, device='cuda:2')
cal diff is tensor(0.7100, device='cuda:2')
discard
cal diff is tensor(0.0064, device='cuda:2')
discard
cal diff is tensor(10.2476, device='cuda:2')
discard
cal diff is tensor(0.0108, device='cuda:2')
discard
cal diff is tensor(123.2660, device='cuda:2')
clipping
cal diff is tensor(0.0221, device='cuda:2')
discard
cal diff is tensor(0.3632, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(77.6641, device='cuda:2')
test acc is  0.9813000001563187
test loss is 0.06528907629124928
test entropy is  0.02983778204718259
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02983778204718259
avg test loss is  0.06528907629124928
avg accuracy is  0.9813000001563187
compute_distance is  tensor(77.6641, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1568528169444375
avg test loss is  1.0517165656568908
avg accuracy is  0.7971166668229923
compute_distance is  tensor(136.0230, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.0230, device='cuda:2')
test acc is  0.7971166668229923
test loss is 1.0517165656568908
test entropy is  0.1568528169444375
________________________________
diff is  tensor(0.7080, device='cuda:2')
diff is  tensor(0.0066, device='cuda:2')
diff is  tensor(10.4835, device='cuda:2')
diff is  tensor(0.0112, device='cuda:2')
diff is  tensor(124.4085, device='cuda:2')
diff is  tensor(0.0230, device='cuda:2')
diff is  tensor(0.3629, device='cuda:2')
diff is  tensor(0.0021, device='cuda:2')
threshold is  tensor(58.3568, device='cuda:2')
sum is tensor(0.0021, device='cuda:2')
sum is tensor(0.0088, device='cuda:2')
sum is tensor(0.0200, device='cuda:2')
sum is tensor(0.0429, device='cuda:2')
sum is tensor(0.4058, device='cuda:2')
sum is tensor(1.1138, device='cuda:2')
sum is tensor(11.5974, device='cuda:2')
sum is tensor(136.0058, device='cuda:2')
ratio is tensor(0.6241, device='cuda:2')
threshold is tensor(124.4085, device='cuda:2')
cal diff is tensor(0.7080, device='cuda:2')
discard
cal diff is tensor(0.0066, device='cuda:2')
discard
cal diff is tensor(10.4835, device='cuda:2')
discard
cal diff is tensor(0.0112, device='cuda:2')
discard
cal diff is tensor(124.4085, device='cuda:2')
clipping
cal diff is tensor(0.0230, device='cuda:2')
discard
cal diff is tensor(0.3629, device='cuda:2')
discard
cal diff is tensor(0.0021, device='cuda:2')
discard
________________________________
test distance is  tensor(77.6639, device='cuda:2')
test acc is  0.9820000001563187
test loss is 0.062433062613839095
test entropy is  0.028833255823292058
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.028833255823292058
avg test loss is  0.062433062613839095
avg accuracy is  0.9820000001563187
compute_distance is  tensor(77.6639, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15680699759343666
avg test loss is  1.0524246599406069
avg accuracy is  0.797083333489659
compute_distance is  tensor(136.5366, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.5366, device='cuda:2')
test acc is  0.797083333489659
test loss is 1.0524246599406069
test entropy is  0.15680699759343666
________________________________
diff is  tensor(0.7076, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(10.5919, device='cuda:2')
diff is  tensor(0.0113, device='cuda:2')
diff is  tensor(124.8125, device='cuda:2')
diff is  tensor(0.0234, device='cuda:2')
diff is  tensor(0.3633, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(58.8704, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0202, device='cuda:2')
sum is tensor(0.0436, device='cuda:2')
sum is tensor(0.4069, device='cuda:2')
sum is tensor(1.1144, device='cuda:2')
sum is tensor(11.7064, device='cuda:2')
sum is tensor(136.5188, device='cuda:2')
ratio is tensor(0.6221, device='cuda:2')
threshold is tensor(124.8125, device='cuda:2')
cal diff is tensor(0.7076, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(10.5919, device='cuda:2')
discard
cal diff is tensor(0.0113, device='cuda:2')
discard
cal diff is tensor(124.8125, device='cuda:2')
clipping
cal diff is tensor(0.0234, device='cuda:2')
discard
cal diff is tensor(0.3633, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(77.6638, device='cuda:2')
test acc is  0.9823000001563186
test loss is 0.06136956035934049
test entropy is  0.02844722155995207
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02844722155995207
avg test loss is  0.06136956035934049
avg accuracy is  0.9823000001563186
compute_distance is  tensor(77.6638, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1568011546940374
avg test loss is  1.053230091643486
avg accuracy is  0.797033333489659
compute_distance is  tensor(136.7635, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(136.7635, device='cuda:2')
test acc is  0.797033333489659
test loss is 1.053230091643486
test entropy is  0.1568011546940374
________________________________
diff is  tensor(0.7076, device='cuda:2')
diff is  tensor(0.0067, device='cuda:2')
diff is  tensor(10.6463, device='cuda:2')
diff is  tensor(0.0114, device='cuda:2')
diff is  tensor(124.9846, device='cuda:2')
diff is  tensor(0.0235, device='cuda:2')
diff is  tensor(0.3630, device='cuda:2')
diff is  tensor(0.0022, device='cuda:2')
threshold is  tensor(59.0974, device='cuda:2')
sum is tensor(0.0022, device='cuda:2')
sum is tensor(0.0089, device='cuda:2')
sum is tensor(0.0203, device='cuda:2')
sum is tensor(0.0439, device='cuda:2')
sum is tensor(0.4069, device='cuda:2')
sum is tensor(1.1144, device='cuda:2')
sum is tensor(11.7608, device='cuda:2')
sum is tensor(136.7454, device='cuda:2')
ratio is tensor(0.6213, device='cuda:2')
threshold is tensor(124.9846, device='cuda:2')
cal diff is tensor(0.7076, device='cuda:2')
discard
cal diff is tensor(0.0067, device='cuda:2')
discard
cal diff is tensor(10.6463, device='cuda:2')
discard
cal diff is tensor(0.0114, device='cuda:2')
discard
cal diff is tensor(124.9846, device='cuda:2')
clipping
cal diff is tensor(0.0235, device='cuda:2')
discard
cal diff is tensor(0.3630, device='cuda:2')
discard
cal diff is tensor(0.0022, device='cuda:2')
discard
________________________________
test distance is  tensor(77.6638, device='cuda:2')
test acc is  0.982333333489652
test loss is 0.06088588130035926
test entropy is  0.028264983630886097
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.028264983630886097
avg test loss is  0.06088588130035926
avg accuracy is  0.982333333489652
compute_distance is  tensor(77.6638, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15677350257505487
avg test loss is  1.0536388607262803
avg accuracy is  0.7971166668229923
compute_distance is  tensor(136.8828, device='cuda:2')
++++++++++++++++++++
reach max round
new distance ratio is 0.7438016528925617
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 80 global rounds:
Train Accuracy: 98.99% 

Test Accuracy: 99.20% 

 
 Results after 80 global rounds of training:
|---- Avg testing Accuracy across each device's data: 98.99%
|----0th round Training Accuracy : 96.33%
|----1th round Training Accuracy : 97.38%
|----2th round Training Accuracy : 97.81%
|----3th round Training Accuracy : 98.00%
|----4th round Training Accuracy : 98.10%
|----5th round Training Accuracy : 98.32%
|----6th round Training Accuracy : 98.39%
|----7th round Training Accuracy : 98.54%
|----8th round Training Accuracy : 98.57%
|----9th round Training Accuracy : 98.63%
|----10th round Training Accuracy : 98.67%
|----11th round Training Accuracy : 98.69%
|----12th round Training Accuracy : 98.67%
|----13th round Training Accuracy : 98.77%
|----14th round Training Accuracy : 98.76%
|----15th round Training Accuracy : 98.77%
|----16th round Training Accuracy : 98.81%
|----17th round Training Accuracy : 98.81%
|----18th round Training Accuracy : 98.82%
|----19th round Training Accuracy : 98.84%
|----20th round Training Accuracy : 98.84%
|----21th round Training Accuracy : 98.84%
|----22th round Training Accuracy : 98.87%
|----23th round Training Accuracy : 98.85%
|----24th round Training Accuracy : 98.85%
|----25th round Training Accuracy : 98.87%
|----26th round Training Accuracy : 98.87%
|----27th round Training Accuracy : 98.92%
|----28th round Training Accuracy : 98.88%
|----29th round Training Accuracy : 98.92%
|----30th round Training Accuracy : 98.92%
|----31th round Training Accuracy : 98.93%
|----32th round Training Accuracy : 98.92%
|----33th round Training Accuracy : 98.93%
|----34th round Training Accuracy : 98.95%
|----35th round Training Accuracy : 98.95%
|----36th round Training Accuracy : 98.96%
|----37th round Training Accuracy : 98.95%
|----38th round Training Accuracy : 98.96%
|----39th round Training Accuracy : 98.97%
|----40th round Training Accuracy : 98.97%
|----41th round Training Accuracy : 98.98%
|----42th round Training Accuracy : 98.97%
|----43th round Training Accuracy : 98.97%
|----44th round Training Accuracy : 98.99%
|----45th round Training Accuracy : 98.98%
|----46th round Training Accuracy : 98.98%
|----47th round Training Accuracy : 99.01%
|----48th round Training Accuracy : 98.99%
|----49th round Training Accuracy : 98.97%
|----50th round Training Accuracy : 99.01%
|----51th round Training Accuracy : 99.00%
|----52th round Training Accuracy : 99.00%
|----53th round Training Accuracy : 99.01%
|----54th round Training Accuracy : 99.01%
|----55th round Training Accuracy : 99.00%
|----56th round Training Accuracy : 98.99%
|----57th round Training Accuracy : 98.97%
|----58th round Training Accuracy : 98.97%
|----59th round Training Accuracy : 98.97%
|----60th round Training Accuracy : 98.97%
|----61th round Training Accuracy : 98.97%
|----62th round Training Accuracy : 98.97%
|----63th round Training Accuracy : 98.97%
|----64th round Training Accuracy : 98.98%
|----65th round Training Accuracy : 98.98%
|----66th round Training Accuracy : 98.98%
|----67th round Training Accuracy : 99.00%
|----68th round Training Accuracy : 98.99%
|----69th round Training Accuracy : 98.99%
|----70th round Training Accuracy : 98.99%
|----71th round Training Accuracy : 99.00%
|----72th round Training Accuracy : 98.98%
|----73th round Training Accuracy : 98.99%
|----74th round Training Accuracy : 98.98%
|----75th round Training Accuracy : 99.00%
|----76th round Training Accuracy : 98.99%
|----77th round Training Accuracy : 98.98%
|----78th round Training Accuracy : 98.98%
|----79th round Training Accuracy : 98.99%
|----Final Test Accuracy: 99.20%
|----0th round Final Test Accuracy : 96.63%
|----1th round Final Test Accuracy : 97.69%
|----2th round Final Test Accuracy : 97.98%
|----3th round Final Test Accuracy : 98.14%
|----4th round Final Test Accuracy : 98.27%
|----5th round Final Test Accuracy : 98.46%
|----6th round Final Test Accuracy : 98.68%
|----7th round Final Test Accuracy : 98.75%
|----8th round Final Test Accuracy : 98.77%
|----9th round Final Test Accuracy : 98.80%
|----10th round Final Test Accuracy : 98.89%
|----11th round Final Test Accuracy : 98.91%
|----12th round Final Test Accuracy : 98.96%
|----13th round Final Test Accuracy : 98.93%
|----14th round Final Test Accuracy : 99.00%
|----15th round Final Test Accuracy : 99.04%
|----16th round Final Test Accuracy : 99.05%
|----17th round Final Test Accuracy : 99.04%
|----18th round Final Test Accuracy : 99.10%
|----19th round Final Test Accuracy : 99.06%
|----20th round Final Test Accuracy : 99.11%
|----21th round Final Test Accuracy : 99.12%
|----22th round Final Test Accuracy : 99.14%
|----23th round Final Test Accuracy : 99.17%
|----24th round Final Test Accuracy : 99.18%
|----25th round Final Test Accuracy : 99.12%
|----26th round Final Test Accuracy : 99.15%
|----27th round Final Test Accuracy : 99.14%
|----28th round Final Test Accuracy : 99.17%
|----29th round Final Test Accuracy : 99.19%
|----30th round Final Test Accuracy : 99.20%
|----31th round Final Test Accuracy : 99.18%
|----32th round Final Test Accuracy : 99.18%
|----33th round Final Test Accuracy : 99.18%
|----34th round Final Test Accuracy : 99.19%
|----35th round Final Test Accuracy : 99.22%
|----36th round Final Test Accuracy : 99.22%
|----37th round Final Test Accuracy : 99.22%
|----38th round Final Test Accuracy : 99.21%
|----39th round Final Test Accuracy : 99.21%
|----40th round Final Test Accuracy : 99.20%
|----41th round Final Test Accuracy : 99.17%
|----42th round Final Test Accuracy : 99.18%
|----43th round Final Test Accuracy : 99.15%
|----44th round Final Test Accuracy : 99.16%
|----45th round Final Test Accuracy : 99.15%
|----46th round Final Test Accuracy : 99.15%
|----47th round Final Test Accuracy : 99.14%
|----48th round Final Test Accuracy : 99.15%
|----49th round Final Test Accuracy : 99.16%
|----50th round Final Test Accuracy : 99.16%
|----51th round Final Test Accuracy : 99.16%
|----52th round Final Test Accuracy : 99.16%
|----53th round Final Test Accuracy : 99.17%
|----54th round Final Test Accuracy : 99.17%
|----55th round Final Test Accuracy : 99.18%
|----56th round Final Test Accuracy : 99.19%
|----57th round Final Test Accuracy : 99.21%
|----58th round Final Test Accuracy : 99.20%
|----59th round Final Test Accuracy : 99.22%
|----60th round Final Test Accuracy : 99.21%
|----61th round Final Test Accuracy : 99.20%
|----62th round Final Test Accuracy : 99.20%
|----63th round Final Test Accuracy : 99.21%
|----64th round Final Test Accuracy : 99.19%
|----65th round Final Test Accuracy : 99.19%
|----66th round Final Test Accuracy : 99.18%
|----67th round Final Test Accuracy : 99.18%
|----68th round Final Test Accuracy : 99.18%
|----69th round Final Test Accuracy : 99.19%
|----70th round Final Test Accuracy : 99.17%
|----71th round Final Test Accuracy : 99.18%
|----72th round Final Test Accuracy : 99.20%
|----73th round Final Test Accuracy : 99.19%
|----74th round Final Test Accuracy : 99.21%
|----75th round Final Test Accuracy : 99.21%
|----76th round Final Test Accuracy : 99.21%
|----77th round Final Test Accuracy : 99.21%
|----78th round Final Test Accuracy : 99.20%
|----79th round Final Test Accuracy : 99.20%

Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 80

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 23836.2510
