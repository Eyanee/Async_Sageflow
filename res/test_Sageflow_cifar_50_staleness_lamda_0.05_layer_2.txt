
Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
poisoned accuracy threshold is  0.5
distance ratio is <class 'float'>
len of model dicts is  12
compute distance is  tensor(6.3470, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.1188, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.7361, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(5.9075, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.0767, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(5.7610, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(5.5138, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(5.7153, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.0821, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.3851, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.0626, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.2115, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(6.7238, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1061.4180, device='cuda:2')
test similarity is  tensor(0.6965, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029765671171494
test entropy is  2.3022094111308418
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3022094111308418
avg test loss is  2.3029765671171494
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1061.4180, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011711502911599204
avg test loss is  9.157142642818753
avg accuracy is  0.10000000015639873
compute_distance is  tensor(945.0870, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(945.0870, device='cuda:2')
test similarity is  tensor(0.7630, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.157142642818753
test entropy is  0.011711502911599204
________________________________
cal_distance is  tensor(79.8387, device='cuda:2')
cal_distance is  tensor(7.0364, device='cuda:2')
cal_distance is  tensor(0.9973, device='cuda:2')
________________________________
test distance is  tensor(0.9973, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029698712746507
test entropy is  2.3022079202525148
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3022079202525148
avg test loss is  2.3029698712746507
avg accuracy is  0.10000000015639873
compute_distance is  tensor(0.9973, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.022038715543782773
avg test loss is  7.627946242651976
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.0283, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.0283, device='cuda:2')
test similarity is  tensor(0.9981, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.627946242651976
test entropy is  0.022038715543782773
________________________________
cal_distance is  tensor(23.5584, device='cuda:2')
cal_distance is  tensor(6.8462, device='cuda:2')
cal_distance is  tensor(2.1355, device='cuda:2')
________________________________
test distance is  tensor(2.1355, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303181219893648
test entropy is  2.301989079741261
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301989079741261
avg test loss is  2.303181219893648
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.1355, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01808317932669464
avg test loss is  7.927258464076635
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.3098, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.3098, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.927258464076635
test entropy is  0.01808317932669464
________________________________
cal_distance is  tensor(23.8833, device='cuda:2')
cal_distance is  tensor(6.8469, device='cuda:2')
cal_distance is  tensor(2.1110, device='cuda:2')
________________________________
test distance is  tensor(2.1110, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031397786591667
test entropy is  2.3020317097149237
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3020317097149237
avg test loss is  2.3031397786591667
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.1110, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.018023328405454793
avg test loss is  7.933909418637795
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.2958, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.2958, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.933909418637795
test entropy is  0.018023328405454793
________________________________
cal_distance is  tensor(23.8813, device='cuda:2')
cal_distance is  tensor(6.8469, device='cuda:2')
cal_distance is  tensor(2.1111, device='cuda:2')
________________________________
test distance is  tensor(2.1111, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031400420781596
test entropy is  2.30203162953067
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.30203162953067
avg test loss is  2.3031400420781596
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.1111, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017996370406521252
avg test loss is  7.9362047438121515
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.3011, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.3011, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.9362047438121515
test entropy is  0.017996370406521252
________________________________
cal_distance is  tensor(23.8821, device='cuda:2')
cal_distance is  tensor(6.8469, device='cuda:2')
cal_distance is  tensor(2.1111, device='cuda:2')
reach max round
new distance ratio is 0.99
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.00015470122161787003
attack res is False
len of model dicts is  12
compute distance is  tensor(6.8195, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.3063, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.5738, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.3477, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.7611, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.3028, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.2541, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.4276, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.4865, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.0726, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.5462, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.8901, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(7.4418, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1062.4274, device='cuda:2')
test similarity is  tensor(0.6966, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303170903259531
test entropy is  2.30199135630332
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.30199135630332
avg test loss is  2.303170903259531
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1062.4274, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011543328901800468
avg test loss is  9.116279292289558
avg accuracy is  0.10000000015639873
compute_distance is  tensor(945.2226, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(945.2226, device='cuda:2')
test similarity is  tensor(0.7630, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.116279292289558
test entropy is  0.011543328901800468
________________________________
cal_distance is  tensor(83.9902, device='cuda:2')
cal_distance is  tensor(7.7470, device='cuda:2')
cal_distance is  tensor(1.0876, device='cuda:2')
________________________________
test distance is  tensor(1.0876, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.30316034576777
test entropy is  2.301987845269615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301987845269615
avg test loss is  2.30316034576777
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.0876, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.018110799604355146
avg test loss is  7.9218518862029175
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.6239, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.6239, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.9218518862029175
test entropy is  0.018110799604355146
________________________________
cal_distance is  tensor(24.8686, device='cuda:2')
cal_distance is  tensor(7.5602, device='cuda:2')
cal_distance is  tensor(2.4312, device='cuda:2')
________________________________
test distance is  tensor(2.4312, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303550081484763
test entropy is  2.3015773656118252
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3015773656118252
avg test loss is  2.303550081484763
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.4312, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0159713933375352
avg test loss is  8.147125122187388
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5340, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5340, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.147125122187388
test entropy is  0.0159713933375352
________________________________
cal_distance is  tensor(25.1540, device='cuda:2')
cal_distance is  tensor(7.5606, device='cuda:2')
cal_distance is  tensor(2.4068, device='cuda:2')
________________________________
test distance is  tensor(2.4068, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3034764055705743
test entropy is  2.3016541412724254
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3016541412724254
avg test loss is  2.3034764055705743
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.4068, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01593102039197636
avg test loss is  8.153245927122853
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5166, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5166, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.153245927122853
test entropy is  0.01593102039197636
________________________________
cal_distance is  tensor(25.1514, device='cuda:2')
cal_distance is  tensor(7.5605, device='cuda:2')
cal_distance is  tensor(2.4069, device='cuda:2')
________________________________
test distance is  tensor(2.4069, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3034767131976155
test entropy is  2.301653801022893
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301653801022893
avg test loss is  2.3034767131976155
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.4069, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01592166287600613
avg test loss is  8.154622488924305
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5136, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5136, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.154622488924305
test entropy is  0.01592166287600613
________________________________
cal_distance is  tensor(25.1510, device='cuda:2')
cal_distance is  tensor(7.5605, device='cuda:2')
cal_distance is  tensor(2.4069, device='cuda:2')
reach max round
new distance ratio is 0.99
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.391559064562898e-05
attack res is False
len of model dicts is  12
compute distance is  tensor(7.7263, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.8290, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.0611, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.3297, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.6484, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.0305, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.7345, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.0044, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.2497, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(8.1491, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.1574, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.6441, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(8.0076, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1063.8751, device='cuda:2')
test similarity is  tensor(0.6956, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031107915941713
test entropy is  2.3020209467319575
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3020209467319575
avg test loss is  2.3031107915941713
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1063.8751, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012086021966393799
avg test loss is  9.049683566593453
avg accuracy is  0.10000000015639873
compute_distance is  tensor(947.6510, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(947.6510, device='cuda:2')
test similarity is  tensor(0.7622, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.049683566593453
test entropy is  0.012086021966393799
________________________________
cal_distance is  tensor(87.2315, device='cuda:2')
cal_distance is  tensor(8.3074, device='cuda:2')
cal_distance is  tensor(1.1609, device='cuda:2')
________________________________
test distance is  tensor(1.1609, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3030820395940403
test entropy is  2.302028531613557
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.302028531613557
avg test loss is  2.3030820395940403
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.1609, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01636708141221186
avg test loss is  8.099227208310685
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.8487, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.8487, device='cuda:2')
test similarity is  tensor(0.9986, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.099227208310685
test entropy is  0.01636708141221186
________________________________
cal_distance is  tensor(25.8280, device='cuda:2')
cal_distance is  tensor(8.1233, device='cuda:2')
cal_distance is  tensor(2.6783, device='cuda:2')
________________________________
test distance is  tensor(2.6783, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3035096189250117
test entropy is  2.301574341781304
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301574341781304
avg test loss is  2.3035096189250117
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.6783, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014910672374469849
avg test loss is  8.290958516128228
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.6002, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.6002, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.290958516128228
test entropy is  0.014910672374469849
________________________________
cal_distance is  tensor(26.0991, device='cuda:2')
cal_distance is  tensor(8.1233, device='cuda:2')
cal_distance is  tensor(2.6529, device='cuda:2')
________________________________
test distance is  tensor(2.6529, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303425109904745
test entropy is  2.3016625737290246
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3016625737290246
avg test loss is  2.303425109904745
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.6529, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014877167370770593
avg test loss is  8.297345004118313
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5857, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5857, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.297345004118313
test entropy is  0.014877167370770593
________________________________
cal_distance is  tensor(26.0967, device='cuda:2')
cal_distance is  tensor(8.1231, device='cuda:2')
cal_distance is  tensor(2.6529, device='cuda:2')
________________________________
test distance is  tensor(2.6529, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303425314786184
test entropy is  2.301662712145949
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301662712145949
avg test loss is  2.303425314786184
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.6529, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014862599667123593
avg test loss is  8.299536130617343
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5813, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5813, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.299536130617343
test entropy is  0.014862599667123593
________________________________
cal_distance is  tensor(26.0959, device='cuda:2')
cal_distance is  tensor(8.1229, device='cuda:2')
cal_distance is  tensor(2.6528, device='cuda:2')
reach max round
new distance ratio is 0.99
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  5.312614666763693e-05
attack res is False
len of model dicts is  12
compute distance is  tensor(8.7997, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.2705, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.2426, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.6801, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(9.0916, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.3107, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.8077, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.8677, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.6797, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.6036, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.3631, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.2971, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(9.3743, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1065.2941, device='cuda:2')
test similarity is  tensor(0.6951, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031232735080183
test entropy is  2.301922089608429
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301922089608429
avg test loss is  2.3031232735080183
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1065.2941, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011201383954490466
avg test loss is  9.123903172095414
avg accuracy is  0.10000000015639873
compute_distance is  tensor(946.4854, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(946.4854, device='cuda:2')
test similarity is  tensor(0.7618, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.123903172095414
test entropy is  0.011201383954490466
________________________________
cal_distance is  tensor(94.3089, device='cuda:2')
cal_distance is  tensor(9.6587, device='cuda:2')
cal_distance is  tensor(1.3521, device='cuda:2')
________________________________
test distance is  tensor(1.3521, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303144039400398
test entropy is  2.3019339867565027
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019339867565027
avg test loss is  2.303144039400398
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.3521, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015107611689687994
avg test loss is  8.255962211457664
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.8019, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.8019, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.255962211457664
test entropy is  0.015107611689687994
________________________________
cal_distance is  tensor(27.9287, device='cuda:2')
cal_distance is  tensor(9.4836, device='cuda:2')
cal_distance is  tensor(3.3243, device='cuda:2')
________________________________
test distance is  tensor(3.3243, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3036971406253706
test entropy is  2.301336238146438
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301336238146438
avg test loss is  2.3036971406253706
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.3243, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01393180424014054
avg test loss is  8.443633104529223
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5519, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5519, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.443633104529223
test entropy is  0.01393180424014054
________________________________
cal_distance is  tensor(28.2218, device='cuda:2')
cal_distance is  tensor(9.4836, device='cuda:2')
cal_distance is  tensor(3.2917, device='cuda:2')
________________________________
test distance is  tensor(3.2917, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303565094233169
test entropy is  2.3014740946957524
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3014740946957524
avg test loss is  2.303565094233169
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.2917, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013888910656933056
avg test loss is  8.452447446106035
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5506, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5506, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.452447446106035
test entropy is  0.013888910656933056
________________________________
cal_distance is  tensor(28.2214, device='cuda:2')
cal_distance is  tensor(9.4834, device='cuda:2')
cal_distance is  tensor(3.2916, device='cuda:2')
________________________________
test distance is  tensor(3.2916, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3035619975355885
test entropy is  2.3014768587658776
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3014768587658776
avg test loss is  2.3035619975355885
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.2916, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013873606383124047
avg test loss is  8.454709389630485
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5425, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5425, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.454709389630485
test entropy is  0.013873606383124047
________________________________
cal_distance is  tensor(28.2201, device='cuda:2')
cal_distance is  tensor(9.4834, device='cuda:2')
cal_distance is  tensor(3.2918, device='cuda:2')
reach max round
new distance ratio is 0.99
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.00022503601212520152
attack res is False
len of model dicts is  12
compute distance is  tensor(10.3756, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.7541, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(12.1336, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.5217, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(10.3769, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.8945, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.6360, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.9795, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.5823, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(12.5443, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.2615, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.9031, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(12.1793, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1067.4198, device='cuda:2')
test similarity is  tensor(0.6946, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029275958800253
test entropy is  2.3021271893435427
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3021271893435427
avg test loss is  2.3029275958800253
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1067.4198, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011145807006527357
avg test loss is  9.1635045608901
avg accuracy is  0.10000000015639873
compute_distance is  tensor(947.0596, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(947.0596, device='cuda:2')
test similarity is  tensor(0.7613, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.1635045608901
test entropy is  0.011145807006527357
________________________________
cal_distance is  tensor(107.5071, device='cuda:2')
cal_distance is  tensor(12.4407, device='cuda:2')
cal_distance is  tensor(1.7885, device='cuda:2')
________________________________
test distance is  tensor(1.7885, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.302878988673315
test entropy is  2.3021479652970647
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3021479652970647
avg test loss is  2.302878988673315
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.7885, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014114293286486355
avg test loss is  8.407238165740772
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.7414, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.7414, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.407238165740772
test entropy is  0.014114293286486355
________________________________
cal_distance is  tensor(31.8077, device='cuda:2')
cal_distance is  tensor(12.2789, device='cuda:2')
cal_distance is  tensor(4.8167, device='cuda:2')
________________________________
test distance is  tensor(4.8167, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303633433168806
test entropy is  2.3013154509122415
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3013154509122415
avg test loss is  2.303633433168806
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4.8167, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012985842282195454
avg test loss is  8.616536933137938
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.8650, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.8650, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.616536933137938
test entropy is  0.012985842282195454
________________________________
cal_distance is  tensor(32.2127, device='cuda:2')
cal_distance is  tensor(12.2789, device='cuda:2')
cal_distance is  tensor(4.7580, device='cuda:2')
________________________________
test distance is  tensor(4.7580, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303370662052613
test entropy is  2.301591311574287
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301591311574287
avg test loss is  2.303370662052613
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4.7580, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012932731746160008
avg test loss is  8.62865322935002
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.9162, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.9162, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.62865322935002
test entropy is  0.012932731746160008
________________________________
cal_distance is  tensor(32.2222, device='cuda:2')
cal_distance is  tensor(12.2785, device='cuda:2')
cal_distance is  tensor(4.7563, device='cuda:2')
________________________________
test distance is  tensor(4.7563, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3033613030562927
test entropy is  2.3016009105136024
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3016009105136024
avg test loss is  2.3033613030562927
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4.7563, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012917039575307723
avg test loss is  8.631562194555922
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.9049, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.9049, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.631562194555922
test entropy is  0.012917039575307723
________________________________
cal_distance is  tensor(32.2200, device='cuda:2')
cal_distance is  tensor(12.2785, device='cuda:2')
cal_distance is  tensor(4.7565, device='cuda:2')
reach max round
new distance ratio is 0.99
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  6.38043275102973e-05
attack res is False
len of model dicts is  12
compute distance is  tensor(13.8109, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(12.6264, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(17.3523, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(15.0966, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(16.8578, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.6398, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(14.6532, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(12.0250, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(15.0796, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(18.8404, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(13.0746, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(16.6129, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(18.0203, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1064.0391, device='cuda:2')
test similarity is  tensor(0.6955, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303107747641366
test entropy is  2.3018294661246297
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3018294661246297
avg test loss is  2.303107747641366
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1064.0391, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01049700585763206
avg test loss is  9.248074515091488
avg accuracy is  0.10000000015639873
compute_distance is  tensor(941.8348, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(941.8348, device='cuda:2')
test similarity is  tensor(0.7622, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.248074515091488
test entropy is  0.01049700585763206
________________________________
cal_distance is  tensor(130.3775, device='cuda:2')
cal_distance is  tensor(18.2458, device='cuda:2')
cal_distance is  tensor(2.8753, device='cuda:2')
________________________________
test distance is  tensor(2.8753, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303040001398462
test entropy is  2.301896249851607
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301896249851607
avg test loss is  2.303040001398462
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.8753, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012783277000341079
avg test loss is  8.62308906228341
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.1576, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.1576, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.62308906228341
test entropy is  0.012783277000341079
________________________________
cal_distance is  tensor(38.5306, device='cuda:2')
cal_distance is  tensor(18.1051, device='cuda:2')
cal_distance is  tensor(8.5531, device='cuda:2')
________________________________
test distance is  tensor(8.5531, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3047801039712814
test entropy is  2.299893341101039
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.299893341101039
avg test loss is  2.3047801039712814
avg accuracy is  0.10000000015639873
compute_distance is  tensor(8.5531, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01181998272555049
avg test loss is  8.860454439811999
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.3991, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.3991, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.860454439811999
test entropy is  0.01181998272555049
________________________________
cal_distance is  tensor(39.0524, device='cuda:2')
cal_distance is  tensor(18.1053, device='cuda:2')
cal_distance is  tensor(8.4402, device='cuda:2')
________________________________
test distance is  tensor(8.4402, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3039330369066398
test entropy is  2.3008049628923617
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3008049628923617
avg test loss is  2.3039330369066398
avg accuracy is  0.10000000015639873
compute_distance is  tensor(8.4402, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011746928421542277
avg test loss is  8.882590047538738
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5331, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5331, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.882590047538738
test entropy is  0.011746928421542277
________________________________
cal_distance is  tensor(39.0831, device='cuda:2')
cal_distance is  tensor(18.1050, device='cuda:2')
cal_distance is  tensor(8.4332, device='cuda:2')
________________________________
test distance is  tensor(8.4332, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3038768012200475
test entropy is  2.3008641138710937
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3008641138710937
avg test loss is  2.3038768012200475
avg accuracy is  0.10000000015639873
compute_distance is  tensor(8.4332, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011729317666638804
avg test loss is  8.886800009881139
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.5190, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5190, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.886800009881139
test entropy is  0.011729317666638804
________________________________
cal_distance is  tensor(39.0797, device='cuda:2')
cal_distance is  tensor(18.1049, device='cuda:2')
cal_distance is  tensor(8.4337, device='cuda:2')
reach max round
new distance ratio is 0.99
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.0002618360158521682
attack res is False
len of model dicts is  12
compute distance is  tensor(23.9461, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(25.4746, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(48.2866, device='cuda:2')
compute similarity is  tensor(0.9998, device='cuda:2')
compute distance is  tensor(35.2806, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(45.2730, device='cuda:2')
compute similarity is  tensor(0.9998, device='cuda:2')
compute distance is  tensor(18.3430, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(35.9912, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(17.1303, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(32.8042, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(84.3392, device='cuda:2')
compute similarity is  tensor(0.9995, device='cuda:2')
compute distance is  tensor(24.7826, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(46.1729, device='cuda:2')
compute similarity is  tensor(0.9998, device='cuda:2')
calculated distance threshold is  tensor(77.6183, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1064.2153, device='cuda:2')
test similarity is  tensor(0.6952, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.302721570824723
test entropy is  2.30199252126162
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.30199252126162
avg test loss is  2.302721570824723
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1064.2153, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.010191333667158395
avg test loss is  9.239132546402914
avg accuracy is  0.10000000015639873
compute_distance is  tensor(940.1658, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(940.1658, device='cuda:2')
test similarity is  tensor(0.7620, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.239132546402914
test entropy is  0.010191333667158395
________________________________
cal_distance is  tensor(270.2103, device='cuda:2')
cal_distance is  tensor(77.7394, device='cuda:2')
cal_distance is  tensor(22.5084, device='cuda:2')
________________________________
test distance is  tensor(22.5084, device='cuda:2')
test similarity is  tensor(0.9998, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3027253492409008
test entropy is  2.302024327580581
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.302024327580581
avg test loss is  2.3027253492409008
avg accuracy is  0.10000000015639873
compute_distance is  tensor(22.5084, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011544313064426222
avg test loss is  8.87170507231027
avg accuracy is  0.10000000015639873
compute_distance is  tensor(93.2869, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.2869, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.87170507231027
test entropy is  0.011544313064426222
________________________________
cal_distance is  tensor(85.1010, device='cuda:2')
cal_distance is  tensor(77.6342, device='cuda:2')
cal_distance is  tensor(70.8233, device='cuda:2')
________________________________
test distance is  tensor(70.8233, device='cuda:2')
test similarity is  tensor(0.9996, device='cuda:2')
test acc is  0.10000000015639873
test loss is 3.4740740124831726
test entropy is  0.9314321229982254
________________________________
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.0026133297942578793
attack res is True
len of model dicts is  12
compute distance is  tensor(128.3393, device='cuda:2')
compute similarity is  tensor(0.9985, device='cuda:2')
compute distance is  tensor(87.2095, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(144.3511, device='cuda:2')
compute similarity is  tensor(0.9976, device='cuda:2')
compute distance is  tensor(143.6771, device='cuda:2')
compute similarity is  tensor(0.9979, device='cuda:2')
compute distance is  tensor(108.0979, device='cuda:2')
compute similarity is  tensor(0.9989, device='cuda:2')
compute distance is  tensor(115.7990, device='cuda:2')
compute similarity is  tensor(0.9985, device='cuda:2')
compute distance is  tensor(145.8423, device='cuda:2')
compute similarity is  tensor(0.9979, device='cuda:2')
compute distance is  tensor(105.1975, device='cuda:2')
compute similarity is  tensor(0.9989, device='cuda:2')
compute distance is  tensor(145.2440, device='cuda:2')
compute similarity is  tensor(0.9980, device='cuda:2')
compute distance is  tensor(150.7856, device='cuda:2')
compute similarity is  tensor(0.9978, device='cuda:2')
compute distance is  tensor(117.5060, device='cuda:2')
compute similarity is  tensor(0.9984, device='cuda:2')
compute distance is  tensor(129.2960, device='cuda:2')
compute similarity is  tensor(0.9981, device='cuda:2')
calculated distance threshold is  tensor(150.1498, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1062.4797, device='cuda:2')
test similarity is  tensor(0.6962, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.5675087240345946
test entropy is  1.9123168525183598
________________________________
cal_distance is  tensor(399.6949, device='cuda:2')
cal_distance is  tensor(150.5369, device='cuda:2')
cal_distance is  tensor(56.8721, device='cuda:2')
________________________________
test distance is  tensor(56.8721, device='cuda:2')
test similarity is  tensor(0.9985, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3635054784052816
test entropy is  2.2118326480431323
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2118326480431323
avg test loss is  2.3635054784052816
avg accuracy is  0.10000000015639873
compute_distance is  tensor(56.8721, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.006157170720053051
avg test loss is  9.927139993213936
avg accuracy is  0.10000000015639873
compute_distance is  tensor(91.3316, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.3316, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.927139993213936
test entropy is  0.006157170720053051
________________________________
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.00039235688745975494
attack res is False
len of model dicts is  12
compute distance is  tensor(141.5216, device='cuda:2')
compute similarity is  tensor(0.9980, device='cuda:2')
compute distance is  tensor(174.8119, device='cuda:2')
compute similarity is  tensor(0.9977, device='cuda:2')
compute distance is  tensor(174.1429, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(176.1577, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(149.0434, device='cuda:2')
compute similarity is  tensor(0.9978, device='cuda:2')
compute distance is  tensor(190.3958, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(136.8670, device='cuda:2')
compute similarity is  tensor(0.9985, device='cuda:2')
compute distance is  tensor(148.3050, device='cuda:2')
compute similarity is  tensor(0.9978, device='cuda:2')
compute distance is  tensor(100.1149, device='cuda:2')
compute similarity is  tensor(0.9990, device='cuda:2')
compute distance is  tensor(175.9201, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(95.9817, device='cuda:2')
compute similarity is  tensor(0.9991, device='cuda:2')
compute distance is  tensor(140.7036, device='cuda:2')
compute similarity is  tensor(0.9979, device='cuda:2')
calculated distance threshold is  tensor(180.9544, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1065.7726, device='cuda:2')
test similarity is  tensor(0.6945, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.6128959805154435
test entropy is  1.87033219380147
________________________________
cal_distance is  tensor(439.4193, device='cuda:2')
cal_distance is  tensor(181.3287, device='cuda:2')
cal_distance is  tensor(74.9820, device='cuda:2')
________________________________
test distance is  tensor(74.9820, device='cuda:2')
test similarity is  tensor(0.9974, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.332937192124174
test entropy is  2.2366580283245465
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2366580283245465
avg test loss is  2.332937192124174
avg accuracy is  0.10000000015639873
compute_distance is  tensor(74.9820, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.005954744878148808
avg test loss is  10.476099327702046
avg accuracy is  0.10000000015639873
compute_distance is  tensor(105.4294, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(105.4294, device='cuda:2')
test similarity is  tensor(0.9981, device='cuda:2')
test acc is  0.10000000015639873
test loss is 10.476099327702046
test entropy is  0.005954744878148808
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.0036764706019312143
attack res is True
len of model dicts is  12
compute distance is  tensor(209.7844, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(211.1945, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(144.6310, device='cuda:2')
compute similarity is  tensor(0.9984, device='cuda:2')
compute distance is  tensor(227.6308, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(193.9510, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(221.0436, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(204.9301, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(107.0666, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(210.4289, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(132.2983, device='cuda:2')
compute similarity is  tensor(0.9989, device='cuda:2')
compute distance is  tensor(100.1362, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(84.1156, device='cuda:2')
compute similarity is  tensor(0.9994, device='cuda:2')
calculated distance threshold is  tensor(226.1957, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1066.5435, device='cuda:2')
test similarity is  tensor(0.6941, device='cuda:2')
test acc is  0.10000000015639873
test loss is 4.1173405366785385
test entropy is  0.7268315706868915
________________________________
cal_distance is  tensor(491.4129, device='cuda:2')
cal_distance is  tensor(226.5509, device='cuda:2')
cal_distance is  tensor(104.5755, device='cuda:2')
________________________________
test distance is  tensor(104.5755, device='cuda:2')
test similarity is  tensor(0.9949, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.5903277445937056
test entropy is  1.8182658579038538
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 16.61% 

Test Accuracy: 16.66% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.009607978165149689
attack res is True
len of model dicts is  12
compute distance is  tensor(216.6706, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(260.3704, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(230.9643, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(237.0882, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(227.7017, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(206.9760, device='cuda:2')
compute similarity is  tensor(0.9978, device='cuda:2')
compute distance is  tensor(92.1293, device='cuda:2')
compute similarity is  tensor(0.9990, device='cuda:2')
compute distance is  tensor(229.7930, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(227.5779, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(221.8947, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(229.9379, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(206.2408, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
calculated distance threshold is  tensor(275.3438, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1016800001563987
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10170000015639871
====================
====================
iteration is  1
round is  1
accuracy is  0.1000400001563987
====================
________________________________
test distance is  tensor(1065.3536, device='cuda:2')
test similarity is  tensor(0.6949, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3468271820136652
test entropy is  2.1747590132686487
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.1747590132686487
avg test loss is  2.3468271820136652
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1065.3536, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.006322836755570072
avg test loss is  12.121813297271729
avg accuracy is  0.10000000015639873
compute_distance is  tensor(915.2244, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(915.2244, device='cuda:2')
test similarity is  tensor(0.7618, device='cuda:2')
test acc is  0.10000000015639873
test loss is 12.121813297271729
test entropy is  0.006322836755570072
________________________________
cal_distance is  tensor(502.0395, device='cuda:2')
cal_distance is  tensor(275.4136, device='cuda:2')
cal_distance is  tensor(151.1180, device='cuda:2')
________________________________
test distance is  tensor(151.1180, device='cuda:2')
test similarity is  tensor(0.9904, device='cuda:2')
test acc is  0.14692000015639858
test loss is 2.193859923526149
test entropy is  2.2450476296417547
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2450476296417547
avg test loss is  2.193859923526149
avg accuracy is  0.14692000015639858
compute_distance is  tensor(151.1180, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.007077325724096269
avg test loss is  12.539258695929252
avg accuracy is  0.10000000015639873
compute_distance is  tensor(171.3677, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(171.3677, device='cuda:2')
test similarity is  tensor(0.9932, device='cuda:2')
test acc is  0.10000000015639873
test loss is 12.539258695929252
test entropy is  0.007077325724096269
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 9.92% 

Test Accuracy: 10.24% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.01921754516661167
attack res is True
len of model dicts is  12
compute distance is  tensor(233.1483, device='cuda:2')
compute similarity is  tensor(0.9973, device='cuda:2')
compute distance is  tensor(264.9164, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(226.1277, device='cuda:2')
compute similarity is  tensor(0.9975, device='cuda:2')
compute distance is  tensor(280.6668, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(253.5271, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(241.6683, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(230.0356, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(257.3551, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(242.1046, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(240.8297, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(204.5167, device='cuda:2')
compute similarity is  tensor(0.9979, device='cuda:2')
compute distance is  tensor(233.4069, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
calculated distance threshold is  tensor(295.7369, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1065.3285, device='cuda:2')
test similarity is  tensor(0.6954, device='cuda:2')
test acc is  0.10000000015639873
test loss is 6.398836223670589
test entropy is  0.3677427475638402
________________________________
cal_distance is  tensor(561.5125, device='cuda:2')
cal_distance is  tensor(296.0627, device='cuda:2')
cal_distance is  tensor(156.2024, device='cuda:2')
________________________________
test distance is  tensor(156.2024, device='cuda:2')
test similarity is  tensor(0.9888, device='cuda:2')
test acc is  0.10106000015639871
test loss is 3.305942852478808
test entropy is  1.233745307873582
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 22.46% 

Test Accuracy: 22.54% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.020859425887465477
attack res is True
len of model dicts is  12
compute distance is  tensor(227.9897, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(255.4221, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(249.4750, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(255.3278, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(253.9997, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(252.2413, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(253.4435, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(241.8423, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(226.8318, device='cuda:2')
compute similarity is  tensor(0.9973, device='cuda:2')
compute distance is  tensor(232.0414, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(232.9665, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(256.1129, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
calculated distance threshold is  tensor(265.4153, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1554800001563986
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.1416400001563986
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.1435400001563986
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.15716000015639858
====================
====================
iteration is  1
round is  1
accuracy is  0.1354600001563986
====================
succ_min + 1
________________________________
test distance is  tensor(1066.6587, device='cuda:2')
test similarity is  tensor(0.6949, device='cuda:2')
test acc is  0.1354600001563986
test loss is 2.2404299047596923
test entropy is  2.113431477180832
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.113431477180832
avg test loss is  2.2404299047596923
avg accuracy is  0.1354600001563986
compute_distance is  tensor(1066.6587, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.31784878522538773
avg test loss is  9.144093654954524
avg accuracy is  0.13112000015639863
compute_distance is  tensor(970.9483, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(970.9483, device='cuda:2')
test similarity is  tensor(0.7621, device='cuda:2')
test acc is  0.13112000015639863
test loss is 9.144093654954524
test entropy is  0.31784878522538773
________________________________
cal_distance is  tensor(507.6862, device='cuda:2')
cal_distance is  tensor(265.4796, device='cuda:2')
cal_distance is  tensor(138.8513, device='cuda:2')
________________________________
test distance is  tensor(138.8513, device='cuda:2')
test similarity is  tensor(0.9928, device='cuda:2')
test acc is  0.22540000015640238
test loss is 2.0543312938012126
test entropy is  2.182809797699189
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.182809797699189
avg test loss is  2.0543312938012126
avg accuracy is  0.22540000015640238
compute_distance is  tensor(138.8513, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.32631998046127425
avg test loss is  8.963230987339069
avg accuracy is  0.13136000015639862
compute_distance is  tensor(204.5827, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(204.5827, device='cuda:2')
test similarity is  tensor(0.9944, device='cuda:2')
test acc is  0.13136000015639862
test loss is 8.963230987339069
test entropy is  0.32631998046127425
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 17.38% 

Test Accuracy: 17.17% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.03184524178504944
attack res is True
len of model dicts is  12
compute distance is  tensor(241.9459, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(259.9665, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(241.0684, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(253.4405, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(268.9231, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(199.8382, device='cuda:2')
compute similarity is  tensor(0.9975, device='cuda:2')
compute distance is  tensor(233.4797, device='cuda:2')
compute similarity is  tensor(0.9974, device='cuda:2')
compute distance is  tensor(230.0004, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(238.3463, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(256.7814, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(254.4603, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(267.3742, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
calculated distance threshold is  tensor(299.9739, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.13320000015639863
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.12994000015639862
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.12796000015639863
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.1324000001563986
====================
====================
iteration is  1
round is  1
accuracy is  0.12888000015639864
====================
________________________________
test distance is  tensor(1067.4133, device='cuda:2')
test similarity is  tensor(0.6963, device='cuda:2')
test acc is  0.12796000015639863
test loss is 5.533862636522259
test entropy is  0.5922962181708392
________________________________
cal_distance is  tensor(566.0706, device='cuda:2')
cal_distance is  tensor(300.2982, device='cuda:2')
cal_distance is  tensor(159.4063, device='cuda:2')
________________________________
test distance is  tensor(159.4063, device='cuda:2')
test similarity is  tensor(0.9884, device='cuda:2')
test acc is  0.17618000015639954
test loss is 3.262913847213511
test entropy is  1.1454273376166058
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 23.61% 

Test Accuracy: 23.72% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.037660788744688034
attack res is True
len of model dicts is  12
compute distance is  tensor(276.9609, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(270.9553, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(284.9399, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(263.8015, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(298.3993, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(272.2665, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(276.1911, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(271.8439, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(282.6157, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(252.1406, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(292.4789, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(279.3165, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
calculated distance threshold is  tensor(325.8957, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.17272000015639927
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2088200001564016
====================
====================
iteration is  0
round is  2
accuracy is  0.15272000015639858
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.1742200001563994
====================
====================
iteration is  1
round is  1
accuracy is  0.17522000015639944
====================
________________________________
test distance is  tensor(1061.1796, device='cuda:2')
test similarity is  tensor(0.6998, device='cuda:2')
test acc is  0.15272000015639858
test loss is 2.4614078321725206
test entropy is  1.7052899483219741
________________________________
cal_distance is  tensor(588.2773, device='cuda:2')
cal_distance is  tensor(326.2082, device='cuda:2')
cal_distance is  tensor(180.9765, device='cuda:2')
________________________________
test distance is  tensor(180.9765, device='cuda:2')
test similarity is  tensor(0.9852, device='cuda:2')
test acc is  0.23924000015640304
test loss is 1.953169015209998
test entropy is  1.9449304430685994
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 25.58% 

Test Accuracy: 26.04% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.04703278839588165
attack res is True
len of model dicts is  12
compute distance is  tensor(310.4261, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(281.2441, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(305.0449, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(283.2507, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(334.0031, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(294.7616, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(313.0602, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(283.8574, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(304.4311, device='cuda:2')
compute similarity is  tensor(0.9961, device='cuda:2')
compute distance is  tensor(282.9993, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(318.4055, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(307.4396, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
calculated distance threshold is  tensor(373.7751, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.19350000015640076
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.23678000015640288
====================
====================
iteration is  0
round is  2
accuracy is  0.23176000015640266
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.240740000156403
====================
====================
iteration is  1
round is  1
accuracy is  0.22706000015640254
====================
________________________________
test distance is  tensor(1063.6340, device='cuda:2')
test similarity is  tensor(0.7000, device='cuda:2')
test acc is  0.19350000015640076
test loss is 2.1049230539280437
test entropy is  1.9195497993313138
________________________________
cal_distance is  tensor(630.7071, device='cuda:2')
cal_distance is  tensor(374.0677, device='cuda:2')
cal_distance is  tensor(221.9313, device='cuda:2')
________________________________
test distance is  tensor(221.9312, device='cuda:2')
test similarity is  tensor(0.9782, device='cuda:2')
test acc is  0.26042000015640376
test loss is 1.8954903039785906
test entropy is  2.003501928980698
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.003501928980698
avg test loss is  1.8954903039785906
avg accuracy is  0.26042000015640376
compute_distance is  tensor(221.9312, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3120085912211167
avg test loss is  9.68512073075375
avg accuracy is  0.19402000015640078
compute_distance is  tensor(286.3977, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(286.3977, device='cuda:2')
test similarity is  tensor(0.9845, device='cuda:2')
test acc is  0.19402000015640078
test loss is 9.68512073075375
test entropy is  0.3120085912211167
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 25.93% 

Test Accuracy: 26.09% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.053893476724624634
attack res is True
len of model dicts is  12
compute distance is  tensor(319.1252, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(316.2563, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(331.6263, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(322.0779, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(368.3054, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(318.6735, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(317.5266, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(335.2370, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(349.2287, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(330.8412, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(354.0238, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(319.2942, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
calculated distance threshold is  tensor(416.6709, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1857600001564002
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.17312000015639928
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.20152000015640117
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.1538400001563986
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.20584000015640147
====================
________________________________
test distance is  tensor(1062.6244, device='cuda:2')
test similarity is  tensor(0.7007, device='cuda:2')
test acc is  0.1538400001563986
test loss is 3.7256901953226467
test entropy is  1.079102270819647
________________________________
cal_distance is  tensor(665.5742, device='cuda:2')
cal_distance is  tensor(416.9451, device='cuda:2')
cal_distance is  tensor(261.2558, device='cuda:2')
________________________________
test distance is  tensor(261.2558, device='cuda:2')
test similarity is  tensor(0.9702, device='cuda:2')
test acc is  0.25200000015640356
test loss is 2.165950626973301
test entropy is  1.4914230742417942
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 28.18% 

Test Accuracy: 28.26% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.07818598300218582
attack res is True
len of model dicts is  12
compute distance is  tensor(340.5889, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(350.3457, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(379.6376, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(332.5908, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(371.7228, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(332.8620, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(325.0992, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(344.1773, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(349.7296, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(353.3912, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(376.8795, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(347.1877, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
calculated distance threshold is  tensor(440.8380, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.19098000015640054
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.21458000015640183
====================
====================
iteration is  0
round is  2
accuracy is  0.23150000015640265
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.23692000015640288
====================
====================
iteration is  1
round is  1
accuracy is  0.21808000015640203
====================
________________________________
test distance is  tensor(1066.0021, device='cuda:2')
test similarity is  tensor(0.7053, device='cuda:2')
test acc is  0.19098000015640054
test loss is 2.216677787206362
test entropy is  1.6909210169711686
________________________________
cal_distance is  tensor(685.6784, device='cuda:2')
cal_distance is  tensor(441.1026, device='cuda:2')
cal_distance is  tensor(283.8222, device='cuda:2')
________________________________
test distance is  tensor(283.8223, device='cuda:2')
test similarity is  tensor(0.9661, device='cuda:2')
test acc is  0.2760400001564043
test loss is 1.840580750914181
test entropy is  1.777552281499214
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 29.69% 

Test Accuracy: 30.06% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.08163256198167801
attack res is True
len of model dicts is  12
compute distance is  tensor(362.6507, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(367.2671, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(358.9302, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(356.4846, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(370.2314, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(351.2450, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(333.3442, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(377.1399, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(356.2431, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(383.4954, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(369.2183, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(358.7016, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
calculated distance threshold is  tensor(450.4156, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2378400001564029
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.27534000015640425
====================
====================
iteration is  0
round is  2
accuracy is  0.239660000156403
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.20544000015640138
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.27686000015640433
====================
________________________________
test distance is  tensor(1061.7247, device='cuda:2')
test similarity is  tensor(0.7067, device='cuda:2')
test acc is  0.20544000015640138
test loss is 2.0281485104194994
test entropy is  1.8966520289935724
________________________________
cal_distance is  tensor(691.6898, device='cuda:2')
cal_distance is  tensor(450.6754, device='cuda:2')
cal_distance is  tensor(293.6953, device='cuda:2')
________________________________
test distance is  tensor(293.6954, device='cuda:2')
test similarity is  tensor(0.9638, device='cuda:2')
test acc is  0.2885800001564046
test loss is 1.783918094756963
test entropy is  1.8723265690266933
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 32.17% 

Test Accuracy: 32.49% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.10806943476200104
attack res is True
len of model dicts is  12
compute distance is  tensor(375.9131, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(401.8555, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(373.7410, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(357.2344, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(387.8899, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(375.7763, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(353.8828, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(381.1324, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(386.6056, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(399.6118, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(393.2351, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(371.4296, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
calculated distance threshold is  tensor(477.0672, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.27968000015640443
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2409200001564031
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.2524600001564035
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.28088000015640446
====================
====================
iteration is  1
round is  1
accuracy is  0.27478000015640425
====================
________________________________
test distance is  tensor(1063.6647, device='cuda:2')
test similarity is  tensor(0.7126, device='cuda:2')
test acc is  0.2409200001564031
test loss is 1.9327690592202385
test entropy is  1.988071698514397
________________________________
cal_distance is  tensor(712.4968, device='cuda:2')
cal_distance is  tensor(477.3160, device='cuda:2')
cal_distance is  tensor(319.8127, device='cuda:2')
________________________________
test distance is  tensor(319.8127, device='cuda:2')
test similarity is  tensor(0.9590, device='cuda:2')
test acc is  0.3060800001564051
test loss is 1.7811934441861594
test entropy is  1.9230678703473962
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 33.34% 

Test Accuracy: 33.53% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.10778395086526871
attack res is True
len of model dicts is  12
compute distance is  tensor(362.5167, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(388.4798, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(368.7869, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(394.8748, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(386.3820, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(372.6687, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(371.1768, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(387.4332, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(396.6162, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(381.6483, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(380.1312, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(386.0835, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
calculated distance threshold is  tensor(458.8336, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.28222000015640447
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2994800001564049
====================
====================
iteration is  0
round is  2
accuracy is  0.2901600001564047
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.30934000015640517
====================
====================
iteration is  1
round is  1
accuracy is  0.2920200001564047
====================
________________________________
test distance is  tensor(1064.7686, device='cuda:2')
test similarity is  tensor(0.7113, device='cuda:2')
test acc is  0.28222000015640447
test loss is 1.847942693611545
test entropy is  1.9231077713124893
________________________________
cal_distance is  tensor(699.1194, device='cuda:2')
cal_distance is  tensor(459.0903, device='cuda:2')
cal_distance is  tensor(301.5236, device='cuda:2')
________________________________
test distance is  tensor(301.5236, device='cuda:2')
test similarity is  tensor(0.9631, device='cuda:2')
test acc is  0.3305200001564056
test loss is 1.7377885459634044
test entropy is  1.8884075197112529
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 33.94% 

Test Accuracy: 33.92% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.11499983817338943
attack res is True
len of model dicts is  12
compute distance is  tensor(414.6160, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(393.1027, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(406.4258, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(380.7182, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(402.9107, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(395.3473, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(378.1692, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(397.4086, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(402.1211, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(398.7387, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(424.8191, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(392.7596, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
calculated distance threshold is  tensor(523.1125, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2877800001564046
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.27412000015640425
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.29484000015640477
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.29220000015640474
====================
====================
iteration is  1
round is  1
accuracy is  0.28180000015640444
====================
________________________________
test distance is  tensor(1064.9812, device='cuda:2')
test similarity is  tensor(0.7132, device='cuda:2')
test acc is  0.27412000015640425
test loss is 1.8754560392530983
test entropy is  1.948662579669367
________________________________
cal_distance is  tensor(746.5294, device='cuda:2')
cal_distance is  tensor(523.3418, device='cuda:2')
cal_distance is  tensor(366.9205, device='cuda:2')
________________________________
test distance is  tensor(366.9205, device='cuda:2')
test similarity is  tensor(0.9472, device='cuda:2')
test acc is  0.32644000015640556
test loss is 1.7422917928842023
test entropy is  1.868042421615337
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 35.36% 

Test Accuracy: 35.20% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.14034666121006012
attack res is True
len of model dicts is  12
compute distance is  tensor(406.7884, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(408.6184, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(438.3482, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(431.6798, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(433.6144, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(419.7646, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(400.2993, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(448.0305, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(405.7917, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(424.7347, device='cuda:2')
compute similarity is  tensor(0.9941, device='cuda:2')
compute distance is  tensor(437.2052, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(413.2090, device='cuda:2')
compute similarity is  tensor(0.9941, device='cuda:2')
calculated distance threshold is  tensor(563.4325, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.28876000015640463
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3226200001564055
====================
====================
iteration is  0
round is  2
accuracy is  0.31380000015640525
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.301280000156405
====================
====================
iteration is  1
round is  1
accuracy is  0.3129200001564052
====================
________________________________
test distance is  tensor(1065.6096, device='cuda:2')
test similarity is  tensor(0.7185, device='cuda:2')
test acc is  0.28876000015640463
test loss is 1.8581331817390363
test entropy is  1.9285958264489917
________________________________
cal_distance is  tensor(774.9771, device='cuda:2')
cal_distance is  tensor(563.6448, device='cuda:2')
cal_distance is  tensor(409.9755, device='cuda:2')
________________________________
test distance is  tensor(409.9755, device='cuda:2')
test similarity is  tensor(0.9373, device='cuda:2')
test acc is  0.34272000015640586
test loss is 1.7130606625695972
test entropy is  1.8276158466058618
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 35.60% 

Test Accuracy: 35.88% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.17678722739219666
attack res is True
len of model dicts is  12
compute distance is  tensor(462.1494, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(450.8898, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(462.8161, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(464.3905, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(448.3909, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(456.3604, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(420.3648, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(478.6332, device='cuda:2')
compute similarity is  tensor(0.9929, device='cuda:2')
compute distance is  tensor(458.6124, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(449.9546, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(453.9936, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(468.3652, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
calculated distance threshold is  tensor(639.4260, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3082400001564051
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3271200001564055
====================
====================
iteration is  0
round is  2
accuracy is  0.3317600001564056
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3066000001564051
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3183000001564053
====================
________________________________
test distance is  tensor(1063.8683, device='cuda:2')
test similarity is  tensor(0.7304, device='cuda:2')
test acc is  0.3066000001564051
test loss is 1.8074344861537903
test entropy is  1.8671962371872515
________________________________
cal_distance is  tensor(824.8830, device='cuda:2')
cal_distance is  tensor(639.6057, device='cuda:2')
cal_distance is  tensor(495.9666, device='cuda:2')
________________________________
test distance is  tensor(495.9666, device='cuda:2')
test similarity is  tensor(0.9168, device='cuda:2')
test acc is  0.3444200001564059
test loss is 1.7076211378092656
test entropy is  1.795169869499743
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 37.22% 

Test Accuracy: 37.13% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.15937526524066925
attack res is True
len of model dicts is  12
compute distance is  tensor(471.4218, device='cuda:2')
compute similarity is  tensor(0.9928, device='cuda:2')
compute distance is  tensor(481.0531, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(473.9508, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(438.3455, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(450.7002, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(459.4527, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(429.8483, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(460.3511, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(469.6667, device='cuda:2')
compute similarity is  tensor(0.9928, device='cuda:2')
compute distance is  tensor(445.2487, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(479.7384, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(439.4063, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
calculated distance threshold is  tensor(641.6046, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.31026000015640515
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3251600001564055
====================
====================
iteration is  0
round is  2
accuracy is  0.33102000015640565
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3450400001564059
====================
====================
iteration is  1
round is  1
accuracy is  0.34438000015640585
====================
________________________________
test distance is  tensor(1066.8555, device='cuda:2')
test similarity is  tensor(0.7226, device='cuda:2')
test acc is  0.31026000015640515
test loss is 1.820661451200695
test entropy is  1.8438281416893005
________________________________
cal_distance is  tensor(827.4459, device='cuda:2')
cal_distance is  tensor(641.7842, device='cuda:2')
cal_distance is  tensor(497.8041, device='cuda:2')
________________________________
test distance is  tensor(497.8041, device='cuda:2')
test similarity is  tensor(0.9133, device='cuda:2')
test acc is  0.3565200001564061
test loss is 1.691415254417283
test entropy is  1.7576921629478863
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 38.13% 

Test Accuracy: 37.73% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.1900070756673813
attack res is True
len of model dicts is  12
compute distance is  tensor(484.2924, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(474.8950, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(490.6467, device='cuda:2')
compute similarity is  tensor(0.9929, device='cuda:2')
compute distance is  tensor(484.7081, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(479.6712, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(472.5488, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(453.4064, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(488.7193, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(478.3745, device='cuda:2')
compute similarity is  tensor(0.9929, device='cuda:2')
compute distance is  tensor(468.1606, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(505.3175, device='cuda:2')
compute similarity is  tensor(0.9924, device='cuda:2')
compute distance is  tensor(467.7875, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
calculated distance threshold is  tensor(689.5511, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3629000001564062
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3237200001564054
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.35256000015640604
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.33690000015640575
====================
====================
iteration is  1
round is  1
accuracy is  0.34786000015640595
====================
________________________________
test distance is  tensor(1062.8241, device='cuda:2')
test similarity is  tensor(0.7340, device='cuda:2')
test acc is  0.3237200001564054
test loss is 1.7896609121881177
test entropy is  1.8812070806008165
________________________________
cal_distance is  tensor(856.1667, device='cuda:2')
cal_distance is  tensor(689.7093, device='cuda:2')
cal_distance is  tensor(555.6318, device='cuda:2')
________________________________
test distance is  tensor(555.6318, device='cuda:2')
test similarity is  tensor(0.9003, device='cuda:2')
test acc is  0.3646800001564062
test loss is 1.6789699699872596
test entropy is  1.7769670945299252
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 39.71% 

Test Accuracy: 39.60% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.21938133239746094
attack res is True
len of model dicts is  12
compute distance is  tensor(527.6973, device='cuda:2')
compute similarity is  tensor(0.9920, device='cuda:2')
compute distance is  tensor(529.7609, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(521.5894, device='cuda:2')
compute similarity is  tensor(0.9922, device='cuda:2')
compute distance is  tensor(530.1796, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(529.5602, device='cuda:2')
compute similarity is  tensor(0.9923, device='cuda:2')
compute distance is  tensor(503.9712, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(515.6603, device='cuda:2')
compute similarity is  tensor(0.9924, device='cuda:2')
compute distance is  tensor(503.7142, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(541.1595, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(503.8934, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(548.6434, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(514.1624, device='cuda:2')
compute similarity is  tensor(0.9923, device='cuda:2')
calculated distance threshold is  tensor(728.5367, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.35970000015640624
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3706600001564064
====================
====================
iteration is  0
round is  2
accuracy is  0.35010000015640597
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.352520000156406
====================
====================
iteration is  1
round is  1
accuracy is  0.35466000015640603
====================
________________________________
test distance is  tensor(1064.7263, device='cuda:2')
test similarity is  tensor(0.7431, device='cuda:2')
test acc is  0.35010000015640597
test loss is 1.7179504021659227
test entropy is  1.809037091482021
________________________________
cal_distance is  tensor(880.8118, device='cuda:2')
cal_distance is  tensor(728.6790, device='cuda:2')
cal_distance is  tensor(602.8359, device='cuda:2')
________________________________
test distance is  tensor(602.8359, device='cuda:2')
test similarity is  tensor(0.8908, device='cuda:2')
test acc is  0.38404000015640655
test loss is 1.6373189199915932
test entropy is  1.743317705743453
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 39.73% 

Test Accuracy: 39.58% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.2487378567457199
attack res is True
len of model dicts is  12
compute distance is  tensor(547.2478, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(564.0190, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(575.3705, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(557.5662, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(576.9720, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(532.3004, device='cuda:2')
compute similarity is  tensor(0.9922, device='cuda:2')
compute distance is  tensor(541.6549, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(551.6362, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(552.5793, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(538.7859, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(561.9290, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(547.6970, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
calculated distance threshold is  tensor(778.1876, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.354700000156406
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3564600001564061
====================
====================
iteration is  0
round is  2
accuracy is  0.36740000015640634
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.33428000015640563
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3762000001564065
====================
________________________________
test distance is  tensor(1064.1671, device='cuda:2')
test similarity is  tensor(0.7515, device='cuda:2')
test acc is  0.33428000015640563
test loss is 1.7788242252586444
test entropy is  1.7582433150552423
________________________________
cal_distance is  tensor(910.0770, device='cuda:2')
cal_distance is  tensor(778.3085, device='cuda:2')
cal_distance is  tensor(665.6281, device='cuda:2')
________________________________
test distance is  tensor(665.6281, device='cuda:2')
test similarity is  tensor(0.8768, device='cuda:2')
test acc is  0.37304000015640637
test loss is 1.663698955417594
test entropy is  1.7019701671722296
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 40.95% 

Test Accuracy: 40.54% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.2483200877904892
attack res is True
len of model dicts is  12
compute distance is  tensor(569.7566, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(570.0553, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(574.4876, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(569.6273, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(572.1108, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(560.6848, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(554.2822, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(563.3088, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(557.3535, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(571.9339, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(580.6686, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(556.4366, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
calculated distance threshold is  tensor(714.0457, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3697000001564063
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3428400001564058
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.35570000015640607
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3898400001564067
====================
====================
iteration is  1
round is  1
accuracy is  0.35300000015640604
====================
________________________________
test distance is  tensor(1063.4600, device='cuda:2')
test similarity is  tensor(0.7510, device='cuda:2')
test acc is  0.3428400001564058
test loss is 1.727794799201019
test entropy is  1.7897068100512181
________________________________
cal_distance is  tensor(871.4933, device='cuda:2')
cal_distance is  tensor(714.1937, device='cuda:2')
cal_distance is  tensor(585.3004, device='cuda:2')
________________________________
test distance is  tensor(585.3003, device='cuda:2')
test similarity is  tensor(0.9002, device='cuda:2')
test acc is  0.3958200001564067
test loss is 1.6112947421305626
test entropy is  1.7010366122436036
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 41.23% 

Test Accuracy: 41.54% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.2973407804965973
attack res is True
len of model dicts is  12
compute distance is  tensor(593.9016, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(595.9820, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(608.7476, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(611.3620, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(621.6332, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(606.3487, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(577.4462, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(588.2047, device='cuda:2')
compute similarity is  tensor(0.9916, device='cuda:2')
compute distance is  tensor(589.5455, device='cuda:2')
compute similarity is  tensor(0.9916, device='cuda:2')
compute distance is  tensor(582.6959, device='cuda:2')
compute similarity is  tensor(0.9916, device='cuda:2')
compute distance is  tensor(605.0037, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(608.5660, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
calculated distance threshold is  tensor(871.7413, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3139200001564052
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3687200001564063
====================
====================
iteration is  0
round is  2
accuracy is  0.3598000001564062
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.35142000015640595
====================
====================
iteration is  1
round is  1
accuracy is  0.3419000001564058
====================
________________________________
test distance is  tensor(1064.0804, device='cuda:2')
test similarity is  tensor(0.7681, device='cuda:2')
test acc is  0.3139200001564052
test loss is 1.8932763149061471
test entropy is  1.747799983262406
________________________________
cal_distance is  tensor(963.1642, device='cuda:2')
cal_distance is  tensor(871.8228, device='cuda:2')
cal_distance is  tensor(789.1478, device='cuda:2')
________________________________
test distance is  tensor(789.1478, device='cuda:2')
test similarity is  tensor(0.8506, device='cuda:2')
test acc is  0.354040000156406
test loss is 1.7627024324348821
test entropy is  1.7165932951071072
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 41.87% 

Test Accuracy: 41.69% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.28704771399497986
attack res is True
len of model dicts is  12
compute distance is  tensor(604.8671, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(656.2418, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(635.0311, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(615.1267, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(643.3818, device='cuda:2')
compute similarity is  tensor(0.9896, device='cuda:2')
compute distance is  tensor(604.6154, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(595.8823, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(612.3135, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(612.4908, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(602.4324, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(633.1944, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(627.3812, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
calculated distance threshold is  tensor(1038.0905, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3642800001564062
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.37782000015640643
====================
====================
iteration is  0
round is  2
accuracy is  0.3701800001564063
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.35020000015640596
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.31496000015640535
====================
succ_min + 1
________________________________
test distance is  tensor(1064.3883, device='cuda:2')
test similarity is  tensor(0.7628, device='cuda:2')
test acc is  0.31496000015640535
test loss is 1.852787757925975
test entropy is  1.7654036185930453
________________________________
cal_distance is  tensor(1051.1627, device='cuda:2')
cal_distance is  tensor(1038.1014, device='cuda:2')
cal_distance is  tensor(1025.2028, device='cuda:2')
________________________________
test distance is  tensor(1025.2028, device='cuda:2')
test similarity is  tensor(0.7746, device='cuda:2')
test acc is  0.3221600001564055
test loss is 1.8325218056778774
test entropy is  1.7592343857221286
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 39.33% 

Test Accuracy: 39.39% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.3962138295173645
attack res is True
len of model dicts is  12
compute distance is  tensor(666.6133, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(707.2988, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(676.4264, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(674.2114, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(668.6022, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(644.0912, device='cuda:2')
compute similarity is  tensor(0.9920, device='cuda:2')
compute distance is  tensor(638.3428, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(665.5121, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(681.0136, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(645.1746, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(672.5787, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(666.9303, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
calculated distance threshold is  tensor(1194.0503, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.33104000015640567
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.33760000015640573
====================
====================
iteration is  0
round is  2
accuracy is  0.3706800001564063
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3380200001564057
====================
====================
iteration is  1
round is  1
accuracy is  0.3189400001564054
====================
succ_min + 1
________________________________
test distance is  tensor(1064.5281, device='cuda:2')
test similarity is  tensor(0.8031, device='cuda:2')
test acc is  0.3189400001564054
test loss is 1.9107826798773178
test entropy is  1.7167803038416616
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 42.69% 

Test Accuracy: 42.44% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.38099417090415955
attack res is True
len of model dicts is  12
compute distance is  tensor(661.2463, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(707.8288, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(699.2917, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(702.5299, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(697.1475, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(683.3879, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(658.4342, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(684.8715, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(687.3508, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(670.0106, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(684.1083, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(719.8228, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
calculated distance threshold is  tensor(1202.6294, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3565200001564061
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.37980000015640647
====================
====================
iteration is  0
round is  2
accuracy is  0.3404800001564058
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3454200001564059
====================
====================
iteration is  1
round is  1
accuracy is  0.36494000015640626
====================
________________________________
test distance is  tensor(1062.7426, device='cuda:2')
test similarity is  tensor(0.7967, device='cuda:2')
test acc is  0.3404800001564058
test loss is 1.7909611475742078
test entropy is  1.697841150986264
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 41.82% 

Test Accuracy: 41.56% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.4337586760520935
attack res is True
len of model dicts is  12
compute distance is  tensor(726.3296, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(733.9653, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(708.5261, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(735.5374, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(722.3337, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(712.5573, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(725.0732, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(740.5716, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(735.9682, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(708.5546, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(709.2099, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(738.0095, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
calculated distance threshold is  tensor(1021.0096, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3681400001564063
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.35218000015640605
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3875000001564066
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.351420000156406
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.36084000015640616
====================
________________________________
test distance is  tensor(1065.7495, device='cuda:2')
test similarity is  tensor(0.8130, device='cuda:2')
test acc is  0.351420000156406
test loss is 1.808041640407289
test entropy is  1.6313220192404354
________________________________
cal_distance is  tensor(1043.1494, device='cuda:2')
cal_distance is  tensor(1021.0286, device='cuda:2')
cal_distance is  tensor(999.3771, device='cuda:2')
________________________________
test distance is  tensor(999.3770, device='cuda:2')
test similarity is  tensor(0.8302, device='cuda:2')
test acc is  0.35756000015640615
test loss is 1.7835315703735937
test entropy is  1.6219877897930877
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 43.51% 

Test Accuracy: 42.64% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.4767787456512451
attack res is True
len of model dicts is  12
compute distance is  tensor(775.1830, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(747.8843, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(801.6647, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(807.8477, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(767.7578, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(752.6207, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(763.9001, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(757.7791, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(772.1981, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(756.9334, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(757.1852, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(778.2889, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
calculated distance threshold is  tensor(1391.0724, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.36424000015640623
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3692800001564064
====================
====================
iteration is  0
round is  2
accuracy is  0.3839600001564065
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.38354000015640655
====================
====================
iteration is  1
round is  1
accuracy is  0.39908000015640677
====================
________________________________
test distance is  tensor(1060.2100, device='cuda:2')
test similarity is  tensor(0.8252, device='cuda:2')
test acc is  0.36424000015640623
test loss is 1.7855593225230342
test entropy is  1.5694718254191795
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 43.33% 

Test Accuracy: 43.12% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.4759306013584137
attack res is True
len of model dicts is  12
compute distance is  tensor(745.0273, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(832.3088, device='cuda:2')
compute similarity is  tensor(0.9883, device='cuda:2')
compute distance is  tensor(788.7703, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(832.1491, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(798.2826, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(764.0987, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(777.4583, device='cuda:2')
compute similarity is  tensor(0.9896, device='cuda:2')
compute distance is  tensor(793.6840, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(820.5688, device='cuda:2')
compute similarity is  tensor(0.9888, device='cuda:2')
compute distance is  tensor(763.9160, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(783.6793, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(745.5331, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
calculated distance threshold is  tensor(1774.8606, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.40390000015640687
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.38042000015640653
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.37874000015640646
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.37562000015640645
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3705200001564064
====================
succ_min + 1
________________________________
test distance is  tensor(1064.5857, device='cuda:2')
test similarity is  tensor(0.8234, device='cuda:2')
test acc is  0.3705200001564064
test loss is 1.773660377620736
test entropy is  1.5262790063153142
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 45.02% 

Test Accuracy: 43.81% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.4650861620903015
attack res is True
len of model dicts is  12
compute distance is  tensor(810.7704, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(846.3986, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(840.9340, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(850.8178, device='cuda:2')
compute similarity is  tensor(0.9874, device='cuda:2')
compute distance is  tensor(813.4448, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(785.7610, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(820.1133, device='cuda:2')
compute similarity is  tensor(0.9881, device='cuda:2')
compute distance is  tensor(808.3152, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(833.4485, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(802.4873, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(808.1864, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
compute distance is  tensor(858.4243, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
calculated distance threshold is  tensor(1728.8499, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.41320000015640695
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.40832000015640696
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.39612000015640675
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.45046000015640747
====================
====================
iteration is  1
round is  1
accuracy is  0.4413200001564073
====================
________________________________
test distance is  tensor(1064.7729, device='cuda:2')
test similarity is  tensor(0.8176, device='cuda:2')
test acc is  0.39612000015640675
test loss is 1.6901224516236875
test entropy is  1.5178198562863539
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 44.68% 

Test Accuracy: 44.44% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.5519799590110779
attack res is True
len of model dicts is  12
compute distance is  tensor(871.4304, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(860.0724, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(877.6429, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(889.3768, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(891.0077, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(846.2963, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(873.5717, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(871.3250, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(867.0227, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(827.2226, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(872.1509, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(876.6415, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
calculated distance threshold is  tensor(1737.8687, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3986400001564068
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3825000001564065
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.36918000015640634
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4000000001564068
====================
====================
iteration is  1
round is  1
accuracy is  0.4066000001564069
====================
________________________________
test distance is  tensor(1062.1797, device='cuda:2')
test similarity is  tensor(0.8439, device='cuda:2')
test acc is  0.36918000015640634
test loss is 1.810134206129157
test entropy is  1.491542308074434
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 46.21% 

Test Accuracy: 46.19% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.5830545425415039
attack res is True
len of model dicts is  12
compute distance is  tensor(878.5549, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(900.9636, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(924.8199, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
compute distance is  tensor(932.0575, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(906.7750, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(894.9305, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
compute distance is  tensor(941.7969, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(897.9282, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(903.2507, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(905.6648, device='cuda:2')
compute similarity is  tensor(0.9888, device='cuda:2')
compute distance is  tensor(890.8285, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(943.6165, device='cuda:2')
compute similarity is  tensor(0.9881, device='cuda:2')
calculated distance threshold is  tensor(1900.3130, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.43934000015640734
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4287200001564072
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4488600001564075
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4207400001564071
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.41954000015640713
====================
succ_min + 1
________________________________
test distance is  tensor(1064.7806, device='cuda:2')
test similarity is  tensor(0.8519, device='cuda:2')
test acc is  0.41954000015640713
test loss is 1.6377599875030615
test entropy is  1.392147793794227
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 48.01% 

Test Accuracy: 48.16% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.6152018308639526
attack res is True
len of model dicts is  12
compute distance is  tensor(944.8307, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
compute distance is  tensor(922.6064, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(971.9815, device='cuda:2')
compute similarity is  tensor(0.9880, device='cuda:2')
compute distance is  tensor(955.3428, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(946.6121, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(978.3839, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(967.9833, device='cuda:2')
compute similarity is  tensor(0.9880, device='cuda:2')
compute distance is  tensor(942.2536, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(953.5771, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(903.7792, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(912.4995, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(939.6713, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
calculated distance threshold is  tensor(2192.5681, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4224200001564072
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.39530000015640676
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4436000001564074
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.43380000015640735
====================
====================
iteration is  1
round is  1
accuracy is  0.43668000015640734
====================
________________________________
test distance is  tensor(1062.1665, device='cuda:2')
test similarity is  tensor(0.8583, device='cuda:2')
test acc is  0.39530000015640676
test loss is 1.7454527724734352
test entropy is  1.375774485680758
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 49.40% 

Test Accuracy: 48.74% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.5791316628456116
attack res is True
len of model dicts is  12
compute distance is  tensor(955.1136, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(957.0226, device='cuda:2')
compute similarity is  tensor(0.9869, device='cuda:2')
compute distance is  tensor(939.1573, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(934.5712, device='cuda:2')
compute similarity is  tensor(0.9877, device='cuda:2')
compute distance is  tensor(965.9047, device='cuda:2')
compute similarity is  tensor(0.9867, device='cuda:2')
compute distance is  tensor(914.8918, device='cuda:2')
compute similarity is  tensor(0.9881, device='cuda:2')
compute distance is  tensor(956.0956, device='cuda:2')
compute similarity is  tensor(0.9873, device='cuda:2')
compute distance is  tensor(962.6594, device='cuda:2')
compute similarity is  tensor(0.9873, device='cuda:2')
compute distance is  tensor(962.6634, device='cuda:2')
compute similarity is  tensor(0.9871, device='cuda:2')
compute distance is  tensor(935.8242, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(930.3798, device='cuda:2')
compute similarity is  tensor(0.9877, device='cuda:2')
compute distance is  tensor(985.9671, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
calculated distance threshold is  tensor(2265.4922, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4737200001564077
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4687400001564077
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4708000001564077
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.45998000015640755
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4687400001564076
====================
________________________________
test distance is  tensor(1067.2412, device='cuda:2')
test similarity is  tensor(0.8452, device='cuda:2')
test acc is  0.45998000015640755
test loss is 1.4984879208647686
test entropy is  1.3527461162308598
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 49.66% 

Test Accuracy: 49.38% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.655728816986084
attack res is True
len of model dicts is  12
compute distance is  tensor(993.2272, device='cuda:2')
compute similarity is  tensor(0.9881, device='cuda:2')
compute distance is  tensor(1001.8568, device='cuda:2')
compute similarity is  tensor(0.9880, device='cuda:2')
compute distance is  tensor(1008.1316, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(965.3259, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
compute distance is  tensor(1010.2478, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(1002.7418, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(1028.5612, device='cuda:2')
compute similarity is  tensor(0.9875, device='cuda:2')
compute distance is  tensor(1028.8887, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(1059.3333, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
compute distance is  tensor(1014.1800, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(960.7474, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(1002.6915, device='cuda:2')
compute similarity is  tensor(0.9880, device='cuda:2')
calculated distance threshold is  tensor(3021.4512, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4390600001564074
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.45894000015640757
====================
====================
iteration is  0
round is  2
accuracy is  0.4414000001564074
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.44834000015640746
====================
====================
iteration is  1
round is  1
accuracy is  0.45464000015640754
====================
________________________________
test distance is  tensor(1062.2726, device='cuda:2')
test similarity is  tensor(0.8655, device='cuda:2')
test acc is  0.4390600001564074
test loss is 1.6142136706110766
test entropy is  1.2955607556930893
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 51.34% 

Test Accuracy: 50.64% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.6223666667938232
attack res is True
len of model dicts is  12
compute distance is  tensor(1029.1313, device='cuda:2')
compute similarity is  tensor(0.9863, device='cuda:2')
compute distance is  tensor(999.8751, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
compute distance is  tensor(1056.5781, device='cuda:2')
compute similarity is  tensor(0.9855, device='cuda:2')
compute distance is  tensor(1023.2294, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(1036.0490, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(1005.7849, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
compute distance is  tensor(1003.0250, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(1006.8121, device='cuda:2')
compute similarity is  tensor(0.9873, device='cuda:2')
compute distance is  tensor(1028.3567, device='cuda:2')
compute similarity is  tensor(0.9865, device='cuda:2')
compute distance is  tensor(979.3853, device='cuda:2')
compute similarity is  tensor(0.9874, device='cuda:2')
compute distance is  tensor(999.4950, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
compute distance is  tensor(992.6290, device='cuda:2')
compute similarity is  tensor(0.9869, device='cuda:2')
calculated distance threshold is  tensor(2754.2720, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.48908000015640785
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4857200001564078
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4706400001564077
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.48582000015640786
====================
====================
iteration is  1
round is  1
accuracy is  0.4620200001564076
====================
succ_min + 1
________________________________
test distance is  tensor(1063.0946, device='cuda:2')
test similarity is  tensor(0.8556, device='cuda:2')
test acc is  0.4620200001564076
test loss is 1.5951604160201518
test entropy is  1.214872398949645
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 50.05% 

Test Accuracy: 49.05% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.6965815424919128
attack res is True
len of model dicts is  12
compute distance is  tensor(1044.9598, device='cuda:2')
compute similarity is  tensor(0.9877, device='cuda:2')
compute distance is  tensor(1047.5387, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(1058.0420, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(1059.8820, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(1020.8469, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(1023.8585, device='cuda:2')
compute similarity is  tensor(0.9883, device='cuda:2')
compute distance is  tensor(1104.1803, device='cuda:2')
compute similarity is  tensor(0.9865, device='cuda:2')
compute distance is  tensor(1014.3217, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(1050.8707, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(1016.2939, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(1031.1412, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(1063.1533, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
calculated distance threshold is  tensor(3287.0422, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.44596000015640747
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4737800001564077
====================
====================
iteration is  0
round is  2
accuracy is  0.43216000015640726
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4623200001564076
====================
====================
iteration is  1
round is  1
accuracy is  0.4687000001564076
====================
________________________________
test distance is  tensor(1062.5643, device='cuda:2')
test similarity is  tensor(0.8731, device='cuda:2')
test acc is  0.43216000015640726
test loss is 1.725532191183866
test entropy is  1.1992498997532193
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 51.30% 

Test Accuracy: 50.36% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.7025846242904663
attack res is True
len of model dicts is  12
compute distance is  tensor(1042.4504, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(1072.9136, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(1018.3353, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(1081.3861, device='cuda:2')
compute similarity is  tensor(0.9869, device='cuda:2')
compute distance is  tensor(1089.3690, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
compute distance is  tensor(1051.3000, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(1079.9712, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(1071.5023, device='cuda:2')
compute similarity is  tensor(0.9874, device='cuda:2')
compute distance is  tensor(1063.5374, device='cuda:2')
compute similarity is  tensor(0.9875, device='cuda:2')
compute distance is  tensor(1020.5024, device='cuda:2')
compute similarity is  tensor(0.9883, device='cuda:2')
compute distance is  tensor(1026.0896, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(1105.2932, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
calculated distance threshold is  tensor(3437.6282, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.48238000015640775
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.48652000015640784
====================
====================
iteration is  0
round is  2
accuracy is  0.4520200001564075
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.49300000015640794
====================
====================
iteration is  1
round is  1
accuracy is  0.4692600001564077
====================
________________________________
test distance is  tensor(1063.4612, device='cuda:2')
test similarity is  tensor(0.8717, device='cuda:2')
test acc is  0.4520200001564075
test loss is 1.6248681882153386
test entropy is  1.1574143127102376
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 51.54% 

Test Accuracy: 50.44% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.7116014361381531
attack res is True
len of model dicts is  12
compute distance is  tensor(1102.6786, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(1079.1960, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(1086.4327, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
compute distance is  tensor(1058.8610, device='cuda:2')
compute similarity is  tensor(0.9877, device='cuda:2')
compute distance is  tensor(1078.0408, device='cuda:2')
compute similarity is  tensor(0.9871, device='cuda:2')
compute distance is  tensor(1052.5894, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(1107.9819, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(1068.5784, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(1092.3115, device='cuda:2')
compute similarity is  tensor(0.9869, device='cuda:2')
compute distance is  tensor(1100.6097, device='cuda:2')
compute similarity is  tensor(0.9865, device='cuda:2')
compute distance is  tensor(1064.9592, device='cuda:2')
compute similarity is  tensor(0.9874, device='cuda:2')
compute distance is  tensor(1050.5149, device='cuda:2')
compute similarity is  tensor(0.9875, device='cuda:2')
calculated distance threshold is  tensor(2809.2104, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4966400001564079
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4639800001564076
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.500040000156408
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.37716000015640655
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.38288000015640655
====================
====================
iteration is  1
round is  2
accuracy is  0.3189200001564054
====================
succ_min + 1
________________________________
test distance is  tensor(2129.6189, device='cuda:2')
test similarity is  tensor(0.6645, device='cuda:2')
test acc is  0.3189200001564054
test loss is 2.1552629612595835
test entropy is  1.3437659738923582
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 48.13% 

Test Accuracy: 47.29% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.8570820093154907
attack res is True
len of model dicts is  12
compute distance is  tensor(1163.2513, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(1149.8018, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(1135.6976, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(1153.0731, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(1181.8975, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(1157.3822, device='cuda:2')
compute similarity is  tensor(0.9888, device='cuda:2')
compute distance is  tensor(1189.0765, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(1154.8081, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(1177.3877, device='cuda:2')
compute similarity is  tensor(0.9888, device='cuda:2')
compute distance is  tensor(1132.4482, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(1146.9264, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(1184.3601, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
calculated distance threshold is  tensor(3038.7781, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4364800001564073
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4486000001564075
====================
====================
iteration is  0
round is  2
accuracy is  0.4767600001564078
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4449400001564074
====================
====================
iteration is  1
round is  1
accuracy is  0.4521000001564075
====================
________________________________
test distance is  tensor(1067.6241, device='cuda:2')
test similarity is  tensor(0.9009, device='cuda:2')
test acc is  0.4364800001564073
test loss is 1.7022987473041504
test entropy is  1.1609701817602758
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 50.00% 

Test Accuracy: 48.87% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.9151146411895752
attack res is True
len of model dicts is  12
compute distance is  tensor(1186.0527, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(1142.1379, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(1199.1960, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(1191.8501, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(1183.8431, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(1219.5032, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(1202.3702, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(1155.8237, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(1166.8446, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(1151.2925, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(1169.6531, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(1171.4556, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
calculated distance threshold is  tensor(4006.9958, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4730600001564077
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4630800001564076
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4483200001564075
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.46840000015640765
====================
====================
iteration is  1
round is  1
accuracy is  0.47882000015640774
====================
________________________________
test distance is  tensor(1065.9637, device='cuda:2')
test similarity is  tensor(0.9102, device='cuda:2')
test acc is  0.4483200001564075
test loss is 1.664912777026291
test entropy is  1.135003976504821
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 53.41% 

Test Accuracy: 51.68% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.8140116930007935
attack res is True
len of model dicts is  12
compute distance is  tensor(1158.0193, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(1193.5266, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(1119.8663, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(1179.2019, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(1186.7709, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(1170.5059, device='cuda:2')
compute similarity is  tensor(0.9875, device='cuda:2')
compute distance is  tensor(1166.9333, device='cuda:2')
compute similarity is  tensor(0.9877, device='cuda:2')
compute distance is  tensor(1143.8035, device='cuda:2')
compute similarity is  tensor(0.9881, device='cuda:2')
compute distance is  tensor(1112.8828, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(1131.8904, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(1102.3843, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(1215.8654, device='cuda:2')
compute similarity is  tensor(0.9866, device='cuda:2')
calculated distance threshold is  tensor(5724.8467, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5221000001564082
====================
====================
iteration is  0
round is  1
accuracy is  0.507600000156408
====================
====================
iteration is  0
round is  2
accuracy is  0.4871400001564079
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.42684000015640716
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.36330000015640623
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.32482000015640555
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.37394000015640644
====================
________________________________
test distance is  tensor(2126.8862, device='cuda:2')
test similarity is  tensor(0.6998, device='cuda:2')
test acc is  0.32482000015640555
test loss is 2.2265782424860903
test entropy is  1.2359561467414621
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 48.35% 

Test Accuracy: 47.42% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.9423727989196777
attack res is True
len of model dicts is  12
compute distance is  tensor(1179.5476, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(1188.1752, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(1184.4108, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(1202.7668, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(1212.3611, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(1184.7535, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(1220.5272, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(1152.7638, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(1188.9305, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(1180.8361, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(1170.1469, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(1244.3407, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
calculated distance threshold is  tensor(5256.0190, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4387400001564074
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.43806000015640734
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.43890000015640734
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4701400001564077
====================
====================
iteration is  1
round is  1
accuracy is  0.4471600001564075
====================
________________________________
test distance is  tensor(1064.9431, device='cuda:2')
test similarity is  tensor(0.9128, device='cuda:2')
test acc is  0.43806000015640734
test loss is 1.7197131371254202
test entropy is  1.1427377425038907
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 53.06% 

Test Accuracy: 51.70% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 53.06%
|----0th round Training Accuracy : 9.74%
|----1th round Training Accuracy : 9.74%
|----2th round Training Accuracy : 9.74%
|----3th round Training Accuracy : 9.74%
|----4th round Training Accuracy : 9.74%
|----5th round Training Accuracy : 9.74%
|----6th round Training Accuracy : 9.74%
|----7th round Training Accuracy : 9.74%
|----8th round Training Accuracy : 9.74%
|----9th round Training Accuracy : 16.61%
|----10th round Training Accuracy : 9.92%
|----11th round Training Accuracy : 22.46%
|----12th round Training Accuracy : 17.38%
|----13th round Training Accuracy : 23.61%
|----14th round Training Accuracy : 25.58%
|----15th round Training Accuracy : 25.93%
|----16th round Training Accuracy : 28.18%
|----17th round Training Accuracy : 29.69%
|----18th round Training Accuracy : 32.17%
|----19th round Training Accuracy : 33.34%
|----20th round Training Accuracy : 33.94%
|----21th round Training Accuracy : 35.36%
|----22th round Training Accuracy : 35.60%
|----23th round Training Accuracy : 37.22%
|----24th round Training Accuracy : 38.13%
|----25th round Training Accuracy : 39.71%
|----26th round Training Accuracy : 39.73%
|----27th round Training Accuracy : 40.95%
|----28th round Training Accuracy : 41.23%
|----29th round Training Accuracy : 41.87%
|----30th round Training Accuracy : 39.33%
|----31th round Training Accuracy : 42.69%
|----32th round Training Accuracy : 41.82%
|----33th round Training Accuracy : 43.51%
|----34th round Training Accuracy : 43.33%
|----35th round Training Accuracy : 45.02%
|----36th round Training Accuracy : 44.68%
|----37th round Training Accuracy : 46.21%
|----38th round Training Accuracy : 48.01%
|----39th round Training Accuracy : 49.40%
|----40th round Training Accuracy : 49.66%
|----41th round Training Accuracy : 51.34%
|----42th round Training Accuracy : 50.05%
|----43th round Training Accuracy : 51.30%
|----44th round Training Accuracy : 51.54%
|----45th round Training Accuracy : 48.13%
|----46th round Training Accuracy : 50.00%
|----47th round Training Accuracy : 53.41%
|----48th round Training Accuracy : 48.35%
|----49th round Training Accuracy : 53.06%
|----Final Test Accuracy: 51.70%
|----0th round Final Test Accuracy : 10.00%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 10.00%
|----3th round Final Test Accuracy : 10.00%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 10.00%
|----6th round Final Test Accuracy : 10.00%
|----7th round Final Test Accuracy : 10.00%
|----8th round Final Test Accuracy : 10.00%
|----9th round Final Test Accuracy : 16.66%
|----10th round Final Test Accuracy : 10.24%
|----11th round Final Test Accuracy : 22.54%
|----12th round Final Test Accuracy : 17.17%
|----13th round Final Test Accuracy : 23.72%
|----14th round Final Test Accuracy : 26.04%
|----15th round Final Test Accuracy : 26.09%
|----16th round Final Test Accuracy : 28.26%
|----17th round Final Test Accuracy : 30.06%
|----18th round Final Test Accuracy : 32.49%
|----19th round Final Test Accuracy : 33.53%
|----20th round Final Test Accuracy : 33.92%
|----21th round Final Test Accuracy : 35.20%
|----22th round Final Test Accuracy : 35.88%
|----23th round Final Test Accuracy : 37.13%
|----24th round Final Test Accuracy : 37.73%
|----25th round Final Test Accuracy : 39.60%
|----26th round Final Test Accuracy : 39.58%
|----27th round Final Test Accuracy : 40.54%
|----28th round Final Test Accuracy : 41.54%
|----29th round Final Test Accuracy : 41.69%
|----30th round Final Test Accuracy : 39.39%
|----31th round Final Test Accuracy : 42.44%
|----32th round Final Test Accuracy : 41.56%
|----33th round Final Test Accuracy : 42.64%
|----34th round Final Test Accuracy : 43.12%
|----35th round Final Test Accuracy : 43.81%
|----36th round Final Test Accuracy : 44.44%
|----37th round Final Test Accuracy : 46.19%
|----38th round Final Test Accuracy : 48.16%
|----39th round Final Test Accuracy : 48.74%
|----40th round Final Test Accuracy : 49.38%
|----41th round Final Test Accuracy : 50.64%
|----42th round Final Test Accuracy : 49.05%
|----43th round Final Test Accuracy : 50.36%
|----44th round Final Test Accuracy : 50.44%
|----45th round Final Test Accuracy : 47.29%
|----46th round Final Test Accuracy : 48.87%
|----47th round Final Test Accuracy : 51.68%
|----48th round Final Test Accuracy : 47.42%
|----49th round Final Test Accuracy : 51.70%

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 12861.8820
