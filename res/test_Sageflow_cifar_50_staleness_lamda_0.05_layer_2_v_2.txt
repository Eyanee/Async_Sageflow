
Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
poisoned accuracy threshold is  0.5
len of model dicts is  12
compute distance is  tensor(6.3548, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.1594, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.6830, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(5.9218, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.0612, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(5.7635, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(5.5325, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(5.7100, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.0910, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.3606, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.0534, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.2483, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(7.8335, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1061.4180, device='cuda:2')
test similarity is  tensor(0.6965, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029765671171494
test entropy is  2.3022094111308418
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3022094111308418
avg test loss is  2.3029765671171494
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1061.4180, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011710729431527693
avg test loss is  9.157223254518435
avg accuracy is  0.10000000015639873
compute_distance is  tensor(945.0866, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(945.0866, device='cuda:2')
test similarity is  tensor(0.7630, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.157223254518435
test entropy is  0.011710729431527693
________________________________
cal_distance is  tensor(86.1625, device='cuda:2')
cal_distance is  tensor(8.1331, device='cuda:2')
cal_distance is  tensor(1.1387, device='cuda:2')
________________________________
test distance is  tensor(1.1387, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.302970238049012
test entropy is  2.302207471464601
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.302207471464601
avg test loss is  2.302970238049012
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.1387, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.022013189811783525
avg test loss is  7.629657541089656
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.0666, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.0666, device='cuda:2')
test similarity is  tensor(0.9981, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.629657541089656
test entropy is  0.022013189811783525
________________________________
cal_distance is  tensor(25.4254, device='cuda:2')
cal_distance is  tensor(7.9489, device='cuda:2')
cal_distance is  tensor(2.6104, device='cuda:2')
________________________________
test distance is  tensor(2.6104, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032629791732946
test entropy is  2.3019036966211655
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019036966211655
avg test loss is  2.3032629791732946
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.6104, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017511827203080706
avg test loss is  7.981635254057472
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.7922, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.7922, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.981635254057472
test entropy is  0.017511827203080706
Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
poisoned accuracy threshold is  0.5
len of model dicts is  12
compute distance is  tensor(6.3415, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.1272, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.6934, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(5.8948, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.0763, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(5.7878, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(5.5513, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(5.6948, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.0787, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.3632, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.0884, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.2457, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(7.8356, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1061.4180, device='cuda:2')
test similarity is  tensor(0.6965, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029765671171494
test entropy is  2.3022094111308418
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3022094111308418
avg test loss is  2.3029765671171494
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1061.4180, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011710906521562496
avg test loss is  9.15720674875752
avg accuracy is  0.10000000015639873
compute_distance is  tensor(945.0869, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(945.0869, device='cuda:2')
test similarity is  tensor(0.7630, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.15720674875752
test entropy is  0.011710906521562496
________________________________
cal_distance is  tensor(86.1740, device='cuda:2')
cal_distance is  tensor(8.1351, device='cuda:2')
cal_distance is  tensor(1.1389, device='cuda:2')
________________________________
test distance is  tensor(1.1389, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.302970237744129
test entropy is  2.302207471464601
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.302207471464601
avg test loss is  2.302970237744129
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.1389, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.02201422907011893
avg test loss is  7.629610132378385
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.0666, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.0666, device='cuda:2')
test similarity is  tensor(0.9981, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.629610132378385
test entropy is  0.02201422907011893
________________________________
cal_distance is  tensor(25.4287, device='cuda:2')
cal_distance is  tensor(7.9509, device='cuda:2')
cal_distance is  tensor(2.6114, device='cuda:2')
________________________________
test distance is  tensor(2.6114, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032631334441396
test entropy is  2.3019035103375955
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019035103375955
avg test loss is  2.3032631334441396
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.6114, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017509102651044307
avg test loss is  7.981847174637153
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.7930, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.7930, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.981847174637153
test entropy is  0.017509102651044307
________________________________
cal_distance is  tensor(25.8472, device='cuda:2')
cal_distance is  tensor(7.9517, device='cuda:2')
cal_distance is  tensor(2.5741, device='cuda:2')
________________________________
test distance is  tensor(2.5741, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031916414075497
test entropy is  2.3019773740597698
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019773740597698
avg test loss is  2.3031916414075497
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.5741, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017412472612765212
avg test loss is  7.993127803973225
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.7749, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.7749, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.993127803973225
test entropy is  0.017412472612765212
________________________________
cal_distance is  tensor(25.8445, device='cuda:2')
cal_distance is  tensor(7.9518, device='cuda:2')
cal_distance is  tensor(2.5744, device='cuda:2')
________________________________
test distance is  tensor(2.5744, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303191930741605
test entropy is  2.301977238691676
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301977238691676
avg test loss is  2.303191930741605
avg accuracy is  0.10000000015639873
compute_distance is  tensor(2.5744, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0173679736866842
avg test loss is  7.997610997665873
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.7745, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.7745, device='cuda:2')
test similarity is  tensor(0.9985, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.997610997665873
test entropy is  0.0173679736866842
________________________________
cal_distance is  tensor(25.8445, device='cuda:2')
cal_distance is  tensor(7.9519, device='cuda:2')
cal_distance is  tensor(2.5745, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(6.8895, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.4371, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.5470, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.4249, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.7839, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.3821, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.2978, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(6.4310, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.6706, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.1829, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.7088, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.9561, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(8.7962, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1062.4274, device='cuda:2')
test similarity is  tensor(0.6965, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032062166487166
test entropy is  2.3019528989596747
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019528989596747
avg test loss is  2.3032062166487166
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1062.4274, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011490650969269255
avg test loss is  9.127136276201213
avg accuracy is  0.10000000015639873
compute_distance is  tensor(945.0731, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(945.0731, device='cuda:2')
test similarity is  tensor(0.7630, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.127136276201213
test entropy is  0.011490650969269255
________________________________
cal_distance is  tensor(91.2925, device='cuda:2')
cal_distance is  tensor(9.0869, device='cuda:2')
cal_distance is  tensor(1.2703, device='cuda:2')
________________________________
test distance is  tensor(1.2703, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031954743978007
test entropy is  2.3019501260479394
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019501260479394
avg test loss is  2.3031954743978007
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.2703, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017567110439652905
avg test loss is  7.9713777953096665
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.6933, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.6933, device='cuda:2')
test similarity is  tensor(0.9985, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.9713777953096665
test entropy is  0.017567110439652905
________________________________
cal_distance is  tensor(27.0388, device='cuda:2')
cal_distance is  tensor(8.9072, device='cuda:2')
cal_distance is  tensor(3.0458, device='cuda:2')
________________________________
test distance is  tensor(3.0458, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303746752726757
test entropy is  2.301367563969644
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301367563969644
avg test loss is  2.303746752726757
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.0458, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015369669168644472
avg test loss is  8.225229268183794
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.9100, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.9100, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.225229268183794
test entropy is  0.015369669168644472
________________________________
cal_distance is  tensor(27.3983, device='cuda:2')
cal_distance is  tensor(8.9076, device='cuda:2')
cal_distance is  tensor(3.0090, device='cuda:2')
________________________________
test distance is  tensor(3.0090, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3036194420836464
test entropy is  2.301501311609507
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301501311609507
avg test loss is  2.3036194420836464
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.0090, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015328468833490254
avg test loss is  8.232836095268464
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.8775, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.8775, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.232836095268464
test entropy is  0.015328468833490254
________________________________
cal_distance is  tensor(27.3930, device='cuda:2')
cal_distance is  tensor(8.9075, device='cuda:2')
cal_distance is  tensor(3.0094, device='cuda:2')
________________________________
test distance is  tensor(3.0094, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3036201045946085
test entropy is  2.3015005945244713
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3015005945244713
avg test loss is  2.3036201045946085
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.0094, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01531356966118221
avg test loss is  8.234755991060105
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.8464, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.8464, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.234755991060105
test entropy is  0.01531356966118221
________________________________
cal_distance is  tensor(27.3880, device='cuda:2')
cal_distance is  tensor(8.9074, device='cuda:2')
cal_distance is  tensor(3.0098, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(8.0151, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.9261, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.3146, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.5597, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.8598, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.1351, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(6.7667, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(7.1966, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.4852, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(8.3924, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.4424, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.9250, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(10.0181, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1063.8751, device='cuda:2')
test similarity is  tensor(0.6956, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303161976587437
test entropy is  2.3019629735166154
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019629735166154
avg test loss is  2.303161976587437
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1063.8751, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011969237181636722
avg test loss is  9.071558463908827
avg accuracy is  0.10000000015639873
compute_distance is  tensor(947.2267, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(947.2267, device='cuda:2')
test similarity is  tensor(0.7622, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.071558463908827
test entropy is  0.011969237181636722
________________________________
cal_distance is  tensor(97.5285, device='cuda:2')
cal_distance is  tensor(10.2981, device='cuda:2')
cal_distance is  tensor(1.4467, device='cuda:2')
________________________________
test distance is  tensor(1.4467, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031345331455437
test entropy is  2.301972590748916
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301972590748916
avg test loss is  2.3031345331455437
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.4467, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015757553920130746
avg test loss is  8.170491048442129
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.8603, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.8603, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.170491048442129
test entropy is  0.015757553920130746
________________________________
cal_distance is  tensor(28.8780, device='cuda:2')
cal_distance is  tensor(10.1243, device='cuda:2')
cal_distance is  tensor(3.6460, device='cuda:2')
________________________________
test distance is  tensor(3.6460, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303804290569042
test entropy is  2.301254975216468
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301254975216468
avg test loss is  2.303804290569042
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.6460, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014219721059893707
avg test loss is  8.397791695411858
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.9891, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.9891, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.397791695411858
test entropy is  0.014219721059893707
________________________________
cal_distance is  tensor(29.2460, device='cuda:2')
cal_distance is  tensor(10.1244, device='cuda:2')
cal_distance is  tensor(3.6025, device='cuda:2')
________________________________
test distance is  tensor(3.6025, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3036281519838613
test entropy is  2.30144058621448
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.30144058621448
avg test loss is  2.3036281519838613
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.6025, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014164633098560983
avg test loss is  8.408791570712234
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.9768, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.9768, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.408791570712234
test entropy is  0.014164633098560983
________________________________
cal_distance is  tensor(29.2436, device='cuda:2')
cal_distance is  tensor(10.1240, device='cuda:2')
cal_distance is  tensor(3.6024, device='cuda:2')
________________________________
test distance is  tensor(3.6024, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303625692796829
test entropy is  2.30144297619305
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.30144297619305
avg test loss is  2.303625692796829
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.6024, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014153855370448144
avg test loss is  8.411170579588322
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.9571, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.9571, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.411170579588322
test entropy is  0.014153855370448144
________________________________
cal_distance is  tensor(29.2402, device='cuda:2')
cal_distance is  tensor(10.1239, device='cuda:2')
cal_distance is  tensor(3.6027, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(9.3782, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.7113, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.9869, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.3139, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(9.7773, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(7.8590, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(8.4463, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(8.1315, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.1994, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.2246, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.0048, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.1433, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(12.5901, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1065.2941, device='cuda:2')
test similarity is  tensor(0.6951, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031874172522895
test entropy is  2.301828237445763
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301828237445763
avg test loss is  2.3031874172522895
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1065.2941, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011010968043585605
avg test loss is  9.160980291073889
avg accuracy is  0.10000000015639873
compute_distance is  tensor(945.6648, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(945.6648, device='cuda:2')
test similarity is  tensor(0.7618, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.160980291073889
test entropy is  0.011010968043585605
________________________________
cal_distance is  tensor(109.2228, device='cuda:2')
cal_distance is  tensor(12.8477, device='cuda:2')
cal_distance is  tensor(1.8581, device='cuda:2')
________________________________
test distance is  tensor(1.8581, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032184055699108
test entropy is  2.301848044785697
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301848044785697
avg test loss is  2.3032184055699108
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1.8581, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014380819790656
avg test loss is  8.35803573515714
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.6856, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.6856, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.35803573515714
test entropy is  0.014380819790656
________________________________
cal_distance is  tensor(32.3266, device='cuda:2')
cal_distance is  tensor(12.6878, device='cuda:2')
cal_distance is  tensor(5.0532, device='cuda:2')
________________________________
test distance is  tensor(5.0532, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.304214641566167
test entropy is  2.3007585319411725
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3007585319411725
avg test loss is  2.304214641566167
avg accuracy is  0.10000000015639873
compute_distance is  tensor(5.0532, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013116704889566011
avg test loss is  8.586868584308478
avg accuracy is  0.10000000015639873
compute_distance is  tensor(84.9961, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.9961, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.586868584308478
test entropy is  0.013116704889566011
________________________________
cal_distance is  tensor(32.7744, device='cuda:2')
cal_distance is  tensor(12.6876, device='cuda:2')
cal_distance is  tensor(4.9859, device='cuda:2')
________________________________
test distance is  tensor(4.9859, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303867273318493
test entropy is  2.301126725228546
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301126725228546
avg test loss is  2.303867273318493
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4.9859, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013052874867616178
avg test loss is  8.601474036950894
avg accuracy is  0.10000000015639873
compute_distance is  tensor(85.0651, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.0651, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.601474036950894
test entropy is  0.013052874867616178
________________________________
cal_distance is  tensor(32.7874, device='cuda:2')
cal_distance is  tensor(12.6874, device='cuda:2')
cal_distance is  tensor(4.9837, device='cuda:2')
________________________________
test distance is  tensor(4.9837, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3038529526547094
test entropy is  2.301140400454821
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301140400454821
avg test loss is  2.3038529526547094
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4.9837, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01303200142772492
avg test loss is  8.60546988233581
avg accuracy is  0.10000000015639873
compute_distance is  tensor(85.0650, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.0650, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.60546988233581
test entropy is  0.01303200142772492
________________________________
cal_distance is  tensor(32.7874, device='cuda:2')
cal_distance is  tensor(12.6873, device='cuda:2')
cal_distance is  tensor(4.9836, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(11.4919, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.6000, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(14.0258, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(11.6450, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(11.9657, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.7883, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(10.4174, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(9.7146, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(11.8542, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(14.5059, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(11.2965, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(12.6157, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(19.2973, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1067.4198, device='cuda:2')
test similarity is  tensor(0.6946, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.302977162248948
test entropy is  2.302024459899844
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.302024459899844
avg test loss is  2.302977162248948
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1067.4198, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.010867304461615166
avg test loss is  9.222545865856473
avg accuracy is  0.10000000015639873
compute_distance is  tensor(945.9462, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(945.9462, device='cuda:2')
test similarity is  tensor(0.7613, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.222545865856473
test entropy is  0.010867304461615166
________________________________
cal_distance is  tensor(135.2076, device='cuda:2')
cal_distance is  tensor(19.5163, device='cuda:2')
cal_distance is  tensor(3.1331, device='cuda:2')
________________________________
test distance is  tensor(3.1331, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029404622514535
test entropy is  2.3020601043920688
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3020601043920688
avg test loss is  2.3029404622514535
avg accuracy is  0.10000000015639873
compute_distance is  tensor(3.1331, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013249713660734694
avg test loss is  8.542988012513845
avg accuracy is  0.10000000015639873
compute_distance is  tensor(82.7770, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.7770, device='cuda:2')
test similarity is  tensor(0.9991, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.542988012513845
test entropy is  0.013249713660734694
________________________________
cal_distance is  tensor(40.0186, device='cuda:2')
cal_distance is  tensor(19.3796, device='cuda:2')
cal_distance is  tensor(9.4267, device='cuda:2')
________________________________
test distance is  tensor(9.4267, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.30494680551007
test entropy is  2.2997791123817035
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2997791123817035
avg test loss is  2.30494680551007
avg accuracy is  0.10000000015639873
compute_distance is  tensor(9.4267, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012026335202071749
avg test loss is  8.827562769965443
avg accuracy is  0.10000000015639873
compute_distance is  tensor(85.4470, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.4470, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.827562769965443
test entropy is  0.012026335202071749
________________________________
cal_distance is  tensor(40.6585, device='cuda:2')
cal_distance is  tensor(19.3798, device='cuda:2')
cal_distance is  tensor(9.2799, device='cuda:2')
________________________________
test distance is  tensor(9.2799, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303861354318116
test entropy is  2.3009485329508474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3009485329508474
avg test loss is  2.303861354318116
avg accuracy is  0.10000000015639873
compute_distance is  tensor(9.2799, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011928819324773595
avg test loss is  8.85636242027478
avg accuracy is  0.10000000015639873
compute_distance is  tensor(85.6814, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.6814, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.85636242027478
test entropy is  0.011928819324773595
________________________________
cal_distance is  tensor(40.7138, device='cuda:2')
cal_distance is  tensor(19.3792, device='cuda:2')
cal_distance is  tensor(9.2666, device='cuda:2')
________________________________
test distance is  tensor(9.2666, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3037859009354924
test entropy is  2.301028316283165
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301028316283165
avg test loss is  2.3037859009354924
avg accuracy is  0.10000000015639873
compute_distance is  tensor(9.2666, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011906799853748411
avg test loss is  8.861678088107682
avg accuracy is  0.10000000015639873
compute_distance is  tensor(85.6790, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.6790, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.861678088107682
test entropy is  0.011906799853748411
________________________________
cal_distance is  tensor(40.7131, device='cuda:2')
cal_distance is  tensor(19.3791, device='cuda:2')
cal_distance is  tensor(9.2666, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(21.2393, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(17.4260, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(33.4848, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(25.2460, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(32.3730, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(13.6664, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(23.2834, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(14.8596, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(24.9609, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(46.1179, device='cuda:2')
compute similarity is  tensor(0.9998, device='cuda:2')
compute distance is  tensor(19.1582, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(31.6359, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(78.5694, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1064.0391, device='cuda:2')
test similarity is  tensor(0.6954, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032683573110635
test entropy is  2.301485933001389
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301485933001389
avg test loss is  2.3032683573110635
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1064.0391, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.009881962495653526
avg test loss is  9.36460612862921
avg accuracy is  0.10000000015639873
compute_distance is  tensor(938.6503, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(938.6503, device='cuda:2')
test similarity is  tensor(0.7622, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.36460612862921
test entropy is  0.009881962495653526
________________________________
cal_distance is  tensor(271.6400, device='cuda:2')
cal_distance is  tensor(78.6890, device='cuda:2')
cal_distance is  tensor(22.9357, device='cuda:2')
________________________________
test distance is  tensor(22.9357, device='cuda:2')
test similarity is  tensor(0.9998, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032420657174972
test entropy is  2.301571324353328
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301571324353328
avg test loss is  2.3032420657174972
avg accuracy is  0.10000000015639873
compute_distance is  tensor(22.9357, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011370095260598508
avg test loss is  8.90333501030417
avg accuracy is  0.10000000015639873
compute_distance is  tensor(93.0720, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(93.0720, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.90333501030417
test entropy is  0.011370095260598508
________________________________
cal_distance is  tensor(85.5214, device='cuda:2')
cal_distance is  tensor(78.5840, device='cuda:2')
cal_distance is  tensor(72.2100, device='cuda:2')
________________________________
test distance is  tensor(72.2100, device='cuda:2')
test similarity is  tensor(0.9996, device='cuda:2')
test acc is  0.10000000015639873
test loss is 3.7065248126569004
test entropy is  0.7707453354850144
________________________________
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(91.0870, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(95.4367, device='cuda:2')
compute similarity is  tensor(0.9990, device='cuda:2')
compute distance is  tensor(125.7518, device='cuda:2')
compute similarity is  tensor(0.9982, device='cuda:2')
compute distance is  tensor(125.6968, device='cuda:2')
compute similarity is  tensor(0.9984, device='cuda:2')
compute distance is  tensor(123.5230, device='cuda:2')
compute similarity is  tensor(0.9982, device='cuda:2')
compute distance is  tensor(64.7447, device='cuda:2')
compute similarity is  tensor(0.9995, device='cuda:2')
compute distance is  tensor(119.4524, device='cuda:2')
compute similarity is  tensor(0.9986, device='cuda:2')
compute distance is  tensor(97.5382, device='cuda:2')
compute similarity is  tensor(0.9990, device='cuda:2')
compute distance is  tensor(111.8775, device='cuda:2')
compute similarity is  tensor(0.9989, device='cuda:2')
compute distance is  tensor(132.6099, device='cuda:2')
compute similarity is  tensor(0.9981, device='cuda:2')
compute distance is  tensor(95.6853, device='cuda:2')
compute similarity is  tensor(0.9989, device='cuda:2')
compute distance is  tensor(108.2633, device='cuda:2')
compute similarity is  tensor(0.9987, device='cuda:2')
calculated distance threshold is  tensor(200.4751, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1064.2153, device='cuda:2')
test similarity is  tensor(0.6949, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3296804937255353
test entropy is  2.2613453724805046
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2613453724805046
avg test loss is  2.3296804937255353
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1064.2153, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.007067155876599462
avg test loss is  9.773472151792873
avg accuracy is  0.10000000015639873
compute_distance is  tensor(918.9995, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(918.9995, device='cuda:2')
test similarity is  tensor(0.7618, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.773472151792873
test entropy is  0.007067155876599462
________________________________
cal_distance is  tensor(429.2803, device='cuda:2')
cal_distance is  tensor(200.5598, device='cuda:2')
cal_distance is  tensor(93.7495, device='cuda:2')
________________________________
test distance is  tensor(93.7495, device='cuda:2')
test similarity is  tensor(0.9963, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3193097529203994
test entropy is  2.2776526788921307
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2776526788921307
avg test loss is  2.3193097529203994
avg accuracy is  0.10000000015639873
compute_distance is  tensor(93.7495, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.007516424372897047
avg test loss is  9.586485996880494
avg accuracy is  0.10000000015639873
compute_distance is  tensor(128.5952, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(128.5952, device='cuda:2')
test similarity is  tensor(0.9973, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.586485996880494
test entropy is  0.007516424372897047
________________________________
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(91.2504, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(84.2395, device='cuda:2')
compute similarity is  tensor(0.9994, device='cuda:2')
compute distance is  tensor(67.5586, device='cuda:2')
compute similarity is  tensor(0.9996, device='cuda:2')
compute distance is  tensor(90.3269, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(140.8298, device='cuda:2')
compute similarity is  tensor(0.9980, device='cuda:2')
compute distance is  tensor(73.6136, device='cuda:2')
compute similarity is  tensor(0.9995, device='cuda:2')
compute distance is  tensor(106.1852, device='cuda:2')
compute similarity is  tensor(0.9991, device='cuda:2')
compute distance is  tensor(89.6346, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(97.7903, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(173.0114, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(91.7764, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(99.4170, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
calculated distance threshold is  tensor(278.4643, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1062.4796, device='cuda:2')
test similarity is  tensor(0.6960, device='cuda:2')
test acc is  0.10000000015639873
test loss is 4.596092727483081
test entropy is  0.45237935911816407
________________________________
cal_distance is  tensor(544.1525, device='cuda:2')
cal_distance is  tensor(278.7971, device='cuda:2')
cal_distance is  tensor(142.9491, device='cuda:2')
________________________________
test distance is  tensor(142.9491, device='cuda:2')
test similarity is  tensor(0.9905, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.75883036958592
test entropy is  1.6427599342582782
________________________________
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 14.35% 

Test Accuracy: 14.34% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(167.6326, device='cuda:2')
compute similarity is  tensor(0.9973, device='cuda:2')
compute distance is  tensor(206.5782, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(191.6439, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(197.9312, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(160.4942, device='cuda:2')
compute similarity is  tensor(0.9980, device='cuda:2')
compute distance is  tensor(208.8925, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(193.4717, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(212.1132, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(179.0126, device='cuda:2')
compute similarity is  tensor(0.9974, device='cuda:2')
compute distance is  tensor(178.9080, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(175.9837, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(111.1179, device='cuda:2')
compute similarity is  tensor(0.9987, device='cuda:2')
calculated distance threshold is  tensor(313.1085, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1065.7726, device='cuda:2')
test similarity is  tensor(0.6952, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3127489004598556
test entropy is  2.272811845440389
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.272811845440389
avg test loss is  2.3127489004598556
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1065.7726, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.006647746534803716
avg test loss is  10.723243446301316
avg accuracy is  0.10000000015639873
compute_distance is  tensor(919.1880, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(919.1880, device='cuda:2')
test similarity is  tensor(0.7620, device='cuda:2')
test acc is  0.10000000015639873
test loss is 10.723243446301316
test entropy is  0.006647746534803716
________________________________
cal_distance is  tensor(536.5155, device='cuda:2')
cal_distance is  tensor(313.1757, device='cuda:2')
cal_distance is  tensor(182.8311, device='cuda:2')
________________________________
test distance is  tensor(182.8311, device='cuda:2')
test similarity is  tensor(0.9861, device='cuda:2')
test acc is  0.1000400001563987
test loss is 2.282119805245753
test entropy is  2.2866529765946177
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2866529765946177
avg test loss is  2.282119805245753
avg accuracy is  0.1000400001563987
compute_distance is  tensor(182.8311, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.007865445917326947
avg test loss is  10.667015206173557
avg accuracy is  0.10000000015639873
compute_distance is  tensor(200.5802, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(200.5802, device='cuda:2')
test similarity is  tensor(0.9903, device='cuda:2')
test acc is  0.10000000015639873
test loss is 10.667015206173557
test entropy is  0.007865445917326947
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 9.84% 

Test Accuracy: 10.15% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(172.1208, device='cuda:2')
compute similarity is  tensor(0.9983, device='cuda:2')
compute distance is  tensor(247.4393, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(154.7487, device='cuda:2')
compute similarity is  tensor(0.9985, device='cuda:2')
compute distance is  tensor(146.0391, device='cuda:2')
compute similarity is  tensor(0.9987, device='cuda:2')
compute distance is  tensor(212.9713, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(113.4465, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(116.8083, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(215.2849, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(219.4280, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(213.6499, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(221.4510, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(95.8816, device='cuda:2')
compute similarity is  tensor(0.9991, device='cuda:2')
calculated distance threshold is  tensor(398.9969, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(1066.5435, device='cuda:2')
test similarity is  tensor(0.6956, device='cuda:2')
test acc is  0.10000000015639873
test loss is 4.953659732628356
test entropy is  0.6059978206444274
________________________________
cal_distance is  tensor(652.5151, device='cuda:2')
cal_distance is  tensor(399.2792, device='cuda:2')
cal_distance is  tensor(244.3899, device='cuda:2')
________________________________
test distance is  tensor(244.3899, device='cuda:2')
test similarity is  tensor(0.9732, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.8770431371601037
test entropy is  1.5332693270100353
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 17.12% 

Test Accuracy: 17.09% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(212.4484, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(237.1419, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(213.8987, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(246.7543, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(228.0630, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(258.2095, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(216.5443, device='cuda:2')
compute similarity is  tensor(0.9974, device='cuda:2')
compute distance is  tensor(254.6700, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(227.2649, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(221.6034, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(243.4101, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(223.3885, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
calculated distance threshold is  tensor(303.9706, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1023600001563987
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10192000015639871
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.10694000015639869
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.1086200001563987
====================
====================
iteration is  1
round is  1
accuracy is  0.10370000015639871
====================
________________________________
test distance is  tensor(1065.3536, device='cuda:2')
test similarity is  tensor(0.6980, device='cuda:2')
test acc is  0.10192000015639871
test loss is 2.512112037605032
test entropy is  1.990628303621736
________________________________
cal_distance is  tensor(569.2761, device='cuda:2')
cal_distance is  tensor(304.2930, device='cuda:2')
cal_distance is  tensor(162.7502, device='cuda:2')
________________________________
test distance is  tensor(162.7502, device='cuda:2')
test similarity is  tensor(0.9880, device='cuda:2')
test acc is  0.168720000156399
test loss is 2.129359255056552
test entropy is  2.212018370628357
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.212018370628357
avg test loss is  2.129359255056552
avg accuracy is  0.168720000156399
compute_distance is  tensor(162.7502, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10006614767796243
avg test loss is  13.026946642209806
avg accuracy is  0.10004000015639873
compute_distance is  tensor(186.2785, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(186.2785, device='cuda:2')
test similarity is  tensor(0.9916, device='cuda:2')
test acc is  0.10004000015639873
test loss is 13.026946642209806
test entropy is  0.10006614767796243
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 12.12% 

Test Accuracy: 12.21% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(234.5195, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(259.0831, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(249.9386, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(277.5959, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(250.1171, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(255.2721, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(248.8071, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(263.8836, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(274.1043, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(257.4601, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(248.2733, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(222.5876, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
calculated distance threshold is  tensor(332.6042, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.12070000015639866
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.11708000015639868
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.12030000015639866
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.12058000015639865
====================
====================
iteration is  1
round is  1
accuracy is  0.11600000015639868
====================
succ_min + 1
________________________________
test distance is  tensor(1061.8987, device='cuda:2')
test similarity is  tensor(0.7010, device='cuda:2')
test acc is  0.11600000015639868
test loss is 5.383997434240473
test entropy is  0.9560891623082368
________________________________
cal_distance is  tensor(594.4980, device='cuda:2')
cal_distance is  tensor(332.9139, device='cuda:2')
cal_distance is  tensor(186.5162, device='cuda:2')
________________________________
test distance is  tensor(186.5162, device='cuda:2')
test similarity is  tensor(0.9844, device='cuda:2')
test acc is  0.12272000015639865
test loss is 3.5421412860036203
test entropy is  1.298518030844686
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 23.46% 

Test Accuracy: 23.89% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(223.7653, device='cuda:2')
compute similarity is  tensor(0.9973, device='cuda:2')
compute distance is  tensor(248.6613, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(244.5269, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(252.7301, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(251.8253, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(248.1858, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(243.4252, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(237.8693, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(238.6585, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(235.8793, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(244.9684, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(222.7395, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
calculated distance threshold is  tensor(282.7207, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.16468000015639864
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.16992000015639908
====================
====================
iteration is  0
round is  2
accuracy is  0.15474000015639858
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.18346000015640004
====================
====================
iteration is  1
round is  1
accuracy is  0.1462000001563986
====================
succ_min + 1
________________________________
test distance is  tensor(1066.6587, device='cuda:2')
test similarity is  tensor(0.6973, device='cuda:2')
test acc is  0.1462000001563986
test loss is 2.2032643797452494
test entropy is  2.080411453686102
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.080411453686102
avg test loss is  2.2032643797452494
avg accuracy is  0.1462000001563986
compute_distance is  tensor(1066.6587, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.39370795693772526
avg test loss is  9.504014171297898
avg accuracy is  0.1448400001563986
compute_distance is  tensor(972.5896, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(972.5896, device='cuda:2')
test similarity is  tensor(0.7643, device='cuda:2')
test acc is  0.1448400001563986
test loss is 9.504014171297898
test entropy is  0.39370795693772526
________________________________
cal_distance is  tensor(524.4271, device='cuda:2')
cal_distance is  tensor(282.8004, device='cuda:2')
cal_distance is  tensor(152.5309, device='cuda:2')
________________________________
test distance is  tensor(152.5309, device='cuda:2')
test similarity is  tensor(0.9914, device='cuda:2')
test acc is  0.23366000015640276
test loss is 2.008377955545245
test entropy is  2.108192273418007
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.108192273418007
avg test loss is  2.008377955545245
avg accuracy is  0.23366000015640276
compute_distance is  tensor(152.5309, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.39557204976716004
avg test loss is  9.503201415776596
avg accuracy is  0.1428600001563986
compute_distance is  tensor(216.9895, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(216.9895, device='cuda:2')
test similarity is  tensor(0.9935, device='cuda:2')
test acc is  0.1428600001563986
test loss is 9.503201415776596
test entropy is  0.39557204976716004
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 18.70% 

Test Accuracy: 18.48% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(276.0992, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(261.5282, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(260.6192, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(255.4059, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(239.9501, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(254.7013, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(279.9036, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(265.4558, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(243.4977, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(252.4906, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(248.9577, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(263.0766, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
calculated distance threshold is  tensor(319.8571, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.12612000015639863
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.12590000015639863
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.12624000015639864
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.13736000015639863
====================
====================
iteration is  1
round is  1
accuracy is  0.11800000015639865
====================
succ_min + 1
________________________________
test distance is  tensor(1069.0043, device='cuda:2')
test similarity is  tensor(0.6987, device='cuda:2')
test acc is  0.11800000015639865
test loss is 9.097366086662273
test entropy is  0.30055711727084405
________________________________
cal_distance is  tensor(584.9509, device='cuda:2')
cal_distance is  tensor(320.1732, device='cuda:2')
cal_distance is  tensor(175.3393, device='cuda:2')
________________________________
test distance is  tensor(175.3393, device='cuda:2')
test similarity is  tensor(0.9862, device='cuda:2')
test acc is  0.17778000015639966
test loss is 3.9649912710384942
test entropy is  0.9277844770485179
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 24.65% 

Test Accuracy: 24.90% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(289.6954, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(257.9481, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(294.7693, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(273.4891, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(313.2502, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(275.3332, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(261.7795, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(267.5271, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(282.9354, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(289.6782, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(289.9145, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(312.5594, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
calculated distance threshold is  tensor(368.5523, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.20028000015640118
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.23854000015640298
====================
====================
iteration is  0
round is  2
accuracy is  0.1709000001563991
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.1763400001563995
====================
====================
iteration is  1
round is  1
accuracy is  0.21338000015640188
====================
________________________________
test distance is  tensor(1061.1796, device='cuda:2')
test similarity is  tensor(0.7018, device='cuda:2')
test acc is  0.1709000001563991
test loss is 2.232249973527611
test entropy is  1.8530700005533751
________________________________
cal_distance is  tensor(625.5651, device='cuda:2')
cal_distance is  tensor(368.8467, device='cuda:2')
cal_distance is  tensor(217.5557, device='cuda:2')
________________________________
test distance is  tensor(217.5557, device='cuda:2')
test similarity is  tensor(0.9791, device='cuda:2')
test acc is  0.25066000015640344
test loss is 1.925766906165101
test entropy is  1.999310392705376
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 26.29% 

Test Accuracy: 26.52% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(295.5074, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(281.4999, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(315.5427, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(298.3260, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(325.7743, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(305.6899, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(291.2015, device='cuda:2')
Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
poisoned accuracy threshold is  0.5
len of model dicts is  12
compute distance is  tensor(47.2601, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(45.2982, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(50.3415, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(45.4292, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(46.5587, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(43.2900, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(42.4596, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(43.0401, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(46.3450, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(47.5065, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(45.8178, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(47.2411, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(58.2234, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4715.3330, device='cuda:2')
test similarity is  tensor(0.6965, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029765689464483
test entropy is  2.3022094172285037
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3022094172285037
avg test loss is  2.3029765689464483
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4715.3330, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011708722391482585
avg test loss is  9.157461290164372
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4480.5874, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4480.5874, device='cuda:2')
test similarity is  tensor(0.7630, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.157461290164372
test entropy is  0.011708722391482585
________________________________
cal_distance is  tensor(512.1159, device='cuda:2')
cal_distance is  tensor(61.6221, device='cuda:2')
cal_distance is  tensor(11.5933, device='cuda:2')
________________________________
test distance is  tensor(11.5933, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029719877730854
test entropy is  2.3022056366781443
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3022056366781443
avg test loss is  2.3029719877730854
avg accuracy is  0.10000000015639873
compute_distance is  tensor(11.5933, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0218086105978588
avg test loss is  7.643445478375916
avg accuracy is  0.10000000015639873
compute_distance is  tensor(642.9723, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(642.9723, device='cuda:2')
test similarity is  tensor(0.9981, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.643445478375916
test entropy is  0.0218086105978588
________________________________
cal_distance is  tensor(194.3281, device='cuda:2')
cal_distance is  tensor(59.6352, device='cuda:2')
cal_distance is  tensor(20.0089, device='cuda:2')
________________________________
test distance is  tensor(20.0089, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032305505879394
test entropy is  2.3019380038961423
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019380038961423
avg test loss is  2.3032305505879394
avg accuracy is  0.10000000015639873
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(294.7569, device='cuda:2')
compute similarity is  tensor(0.9961, device='cuda:2')
compute distance is  tensor(300.8839, device='cuda:2')
compute similarity is  tensor(0.9961, device='cuda:2')
compute distance is  tensor(309.8629, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(329.4759, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(316.4573, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
calculated distance threshold is  tensor(377.4519, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.21390000015640184
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2560600001564037
====================
====================
iteration is  0
round is  2
accuracy is  0.24450000015640314
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2615000001564038
====================
====================
iteration is  1
round is  1
accuracy is  0.24498000015640317
====================
________________________________
test distance is  tensor(1063.6340, device='cuda:2')
test similarity is  tensor(0.7028, device='cuda:2')
test acc is  0.21390000015640184
test loss is 2.0556405049455746
test entropy is  1.9097692673773412
________________________________
cal_distance is  tensor(633.7994, device='cuda:2')
cal_distance is  tensor(377.7429, device='cuda:2')
cal_distance is  tensor(225.2072, device='cuda:2')
________________________________
test distance is  tensor(225.2072, device='cuda:2')
test similarity is  tensor(0.9779, device='cuda:2')
test acc is  0.267560000156404
test loss is 1.8744234275025176
test entropy is  1.9832054247026858
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 27.66% 

Test Accuracy: 27.20% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(325.6127, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(321.0922, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(316.7336, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(322.3326, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(361.2632, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(308.5136, device='cuda:2')
compute similarity is  tensor(0.9961, device='cuda:2')
compute distance is  tensor(334.0830, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(308.3199, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(343.5953, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(341.5635, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(359.5480, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(325.6042, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
calculated distance threshold is  tensor(414.2064, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2529800001564036
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.25078000015640345
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.266560000156404
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.21166000015640174
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2616200001564038
====================
________________________________
test distance is  tensor(1062.6244, device='cuda:2')
test similarity is  tensor(0.7036, device='cuda:2')
test acc is  0.21166000015640174
test loss is 2.0759370200469367
test entropy is  1.9686148691055414
________________________________
cal_distance is  tensor(663.6042, device='cuda:2')
cal_distance is  tensor(414.4816, device='cuda:2')
cal_distance is  tensor(258.9453, device='cuda:2')
________________________________
test distance is  tensor(258.9453, device='cuda:2')
test similarity is  tensor(0.9711, device='cuda:2')
test acc is  0.28324000015640444
test loss is 1.8622048071888098
test entropy is  2.021662689688261
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.021662689688261
avg test loss is  1.8622048071888098
avg accuracy is  0.28324000015640444
compute_distance is  tensor(258.9453, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.49081094383888535
avg test loss is  6.703323506333334
avg accuracy is  0.22004000015640215
compute_distance is  tensor(327.6033, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(327.6033, device='cuda:2')
test similarity is  tensor(0.9795, device='cuda:2')
test acc is  0.22004000015640215
test loss is 6.703323506333334
test entropy is  0.49081094383888535
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 26.39% 

Test Accuracy: 26.17% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is 
compute_distance is  tensor(20.0089, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017665938115762093
avg test loss is  7.966968190029759
avg accuracy is  0.10000000015639873
compute_distance is  tensor(656.7153, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(656.7153, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.966968190029759
test entropy is  0.017665938115762093
________________________________
cal_distance is  tensor(196.3926, device='cuda:2')
cal_distance is  tensor(59.6434, device='cuda:2')
cal_distance is  tensor(19.8417, device='cuda:2')
________________________________
test distance is  tensor(19.8417, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303175993892543
test entropy is  2.301993906650397
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301993906650397
avg test loss is  2.303175993892543
avg accuracy is  0.10000000015639873
compute_distance is  tensor(19.8417, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017555357011802056
avg test loss is  7.979262887364459
avg accuracy is  0.10000000015639873
compute_distance is  tensor(656.4026, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(656.4026, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.979262887364459
test entropy is  0.017555357011802056
________________________________
cal_distance is  tensor(196.3464, device='cuda:2')
cal_distance is  tensor(59.6436, device='cuda:2')
cal_distance is  tensor(19.8454, device='cuda:2')
________________________________
test distance is  tensor(19.8454, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031761551756995
test entropy is  2.3019941011658105
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019941011658105
avg test loss is  2.3031761551756995
avg accuracy is  0.10000000015639873
compute_distance is  tensor(19.8454, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01751295370204598
avg test loss is  7.983438435113034
avg accuracy is  0.10000000015639873
compute_distance is  tensor(656.4911, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(656.4911, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.983438435113034
test entropy is  0.01751295370204598
________________________________
cal_distance is  tensor(196.3602, device='cuda:2')
cal_distance is  tensor(59.6445, device='cuda:2')
cal_distance is  tensor(19.8452, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(51.1282, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(48.0760, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(57.3215, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(48.9832, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(52.1180, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(47.6382, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(47.6486, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(48.9606, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(50.2679, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(53.5697, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(50.4506, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(52.2937, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(67.0049, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4720.1992, device='cuda:2')
test similarity is  tensor(0.6965, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031959259296624
test entropy is  2.3019646043362827
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3019646043362827
avg test loss is  2.3031959259296624
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4720.1992, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011503320124209918
avg test loss is  9.124862242842575
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4474.0127, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4474.0127, device='cuda:2')
test similarity is  tensor(0.7630, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.124862242842575
test entropy is  0.011503320124209918
________________________________
cal_distance is  tensor(548.8314, device='cuda:2')
cal_distance is  tensor(70.2480, device='cuda:2')
cal_distance is  tensor(13.0934, device='cuda:2')
________________________________
test distance is  tensor(13.0934, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303189128561093
test entropy is  2.301956808475582
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301956808475582
avg test loss is  2.303189128561093
avg accuracy is  0.10000000015639873
compute_distance is  tensor(13.0934, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017661897820489637
avg test loss is  7.962944775286233
avg accuracy is  0.10000000015639873
compute_distance is  tensor(643.3747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(643.3747, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.10000000015639873
test loss is 7.962944775286233
test entropy is  0.017661897820489637
________________________________ 57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(364.0098, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(338.2005, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(348.9533, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(340.9085, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(367.3435, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(356.5009, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(339.3222, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(354.0101, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(344.1054, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(354.7893, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(374.3837, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(366.0397, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
calculated distance threshold is  tensor(410.5669, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1743800001563994
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.1743800001563994
====================
====================
iteration is  0
round is  2
accuracy is  0.1911800001564006
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2137600001564018
====================
====================
iteration is  1
round is  1
accuracy is  0.20164000015640118
====================
________________________________
test distance is  tensor(1066.0021, device='cuda:2')
test similarity is  tensor(0.7065, device='cuda:2')
test acc is  0.1743800001563994
test loss is 5.3354304239268195
test entropy is  0.6711425977137387
________________________________
cal_distance is  tensor(661.7336, device='cuda:2')
cal_distance is  tensor(410.8443, device='cuda:2')
cal_distance is  tensor(255.1416, device='cuda:2')
________________________________
test distance is  tensor(255.1416, device='cuda:2')
test similarity is  tensor(0.9726, device='cuda:2')
test acc is  0.25192000015640353
test loss is 3.08935310438161
test entropy is  0.9864300369759045
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 30.62% 

Test Accuracy: 31.19% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(361.5522, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(355.8484, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(370.1844, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(352.6246, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(346.0092, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(345.0503, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(336.5672, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(363.0948, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(365.3272, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(363.7979, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(379.6213, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(353.8060, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
calculated distance threshold is  tensor(422.6755, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2546600001564036
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.265400000156404
====================
====================
iteration is  0
round is  2
accuracy is  0.23918000015640298
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2061000001564014
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.25328000015640356
====================
________________________________
test distance is  tensor(1061.7247, device='cuda:2')
test similarity is  tensor(0.7082, device='cuda:2')
test acc is  0.2061000001564014
test loss is 2.373770786673212
test entropy is  1.5289209619202577
________________________________
cal_distance is  tensor(670.0656, device='cuda:2')
cal_distance is  tensor(422.9470, device='cuda:2')
cal_distance is  tensor(267.0264, device='cuda:2')
________________________________
test distance is  tensor(267.0264, device='cuda:2')
test similarity is  tensor(0.9701, device='cuda:2')
test acc is  0.2978200001564049
test loss is 1.8181414101129907
test entropy is  1.6397364116690654
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 32.59% 

Test Accuracy: 33.19% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(387.6421, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(376.3549, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(386.5275, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(373.4029, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(380.8156, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(357.9473, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(365.7833, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(369.5218, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(388.1899, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(383.7796, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(404.3724, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(377.6682, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
calculated distance threshold is  tensor(450.7975, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.27468000015640426
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24476000015640317
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.28096000015640443
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2574200001564037
====================
====================
iteration is  1
round is  1
accuracy is  0.26370000015640394
====================
________________________________
test distance is  tensor(1063.6647, device='cuda:2')
test similarity is  tensor(0.7132, device='cuda:2')
test acc is  0.24476000015640317
test loss is 1.9589463963228113
test entropy is  1.787919326359049
________________________________
cal_distance is  tensor(692.6148, device='cuda:2')
cal_distance is  tensor(451.0575, device='cuda:2')
cal_distance is  tensor(293.8008, device='cuda:2')
________________________________
test distance is  tensor(293.8008, device='cuda:2')
test similarity is  tensor(0.9652, device='cuda:2')
test acc is  0.31560000015640527
test loss is 1.734776234535305
test entropy is  1.7608931654554498
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 33.21% 

Test Accuracy: 33.95% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(409.2256, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(387.4928, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(417.6518, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(399.3001, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(385.2993, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(387.4236, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(381.5475, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(376.1590, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(384.5106, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(396.8311, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(411.7808, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(394.9692, device='cuda:2')
compute similarity is  tensor(0.9941, device='cuda:2')
calculated distance threshold is  tensor(459.1446, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3067000001564051
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3141000001564053
====================
====================
iteration is  0
round is  2
accuracy is  0.31298000015640526
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3164200001564053
====================
====================
iteration is  1
round is  1
accuracy is  0.2989800001564049
====================
succ_min + 1
________________________________
test distance is  tensor(1065.1613, device='cuda:2')
test similarity is  tensor(0.7121, device='cuda:2')
test acc is  0.2989800001564049
test loss is 1.8128795407312301
test entropy is  1.802085107549682
________________________________
cal_distance is  tensor(699.4852, device='cuda:2')
cal_distance is  tensor(459.4012, device='cuda:2')
cal_distance is  tensor(301.7742, device='cuda:2')
________________________________
test distance is  tensor(301.7742, device='cuda:2')
test similarity is  tensor(0.9632, device='cuda:2')
test acc is  0.33596000015640565
test loss is 1.7023434481962259
test entropy is  1.8023526333177182
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 33.22% 

Test Accuracy: 33.82% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is 
cal_distance is  tensor(208.4495, device='cuda:2')
cal_distance is  tensor(68.3514, device='cuda:2')
cal_distance is  tensor(23.8689, device='cuda:2')
________________________________
test distance is  tensor(23.8689, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303709185336862
test entropy is  2.301408759773235
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301408759773235
avg test loss is  2.303709185336862
avg accuracy is  0.10000000015639873
compute_distance is  tensor(23.8689, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015487571886461942
avg test loss is  8.209418763894863
avg accuracy is  0.10000000015639873
compute_distance is  tensor(654.6132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(654.6132, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.209418763894863
test entropy is  0.015487571886461942
________________________________
cal_distance is  tensor(210.2605, device='cuda:2')
cal_distance is  tensor(68.3550, device='cuda:2')
cal_distance is  tensor(23.6868, device='cuda:2')
________________________________
test distance is  tensor(23.6868, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3035990676611586
test entropy is  2.3015241141209515
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3015241141209515
avg test loss is  2.3035990676611586
avg accuracy is  0.10000000015639873
compute_distance is  tensor(23.6868, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015428702567306244
avg test loss is  8.219347905015091
avg accuracy is  0.10000000015639873
compute_distance is  tensor(654.0064, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(654.0064, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.219347905015091
test entropy is  0.015428702567306244
________________________________
cal_distance is  tensor(210.1623, device='cuda:2')
cal_distance is  tensor(68.3533, device='cuda:2')
cal_distance is  tensor(23.6938, device='cuda:2')
________________________________
test distance is  tensor(23.6938, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303599101503182
test entropy is  2.301524043692957
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301524043692957
avg test loss is  2.303599101503182
avg accuracy is  0.10000000015639873
compute_distance is  tensor(23.6938, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015413988308976298
avg test loss is  8.221525798978098
avg accuracy is  0.10000000015639873
compute_distance is  tensor(653.8032, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(653.8032, device='cuda:2')
test similarity is  tensor(0.9988, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.221525798978098
test entropy is  0.015413988308976298
________________________________
cal_distance is  tensor(210.1293, device='cuda:2')
cal_distance is  tensor(68.3526, device='cuda:2')
cal_distance is  tensor(23.6961, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(58.9506, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(52.0948, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(62.9523, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(57.4279, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(59.0336, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(53.7576, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(51.0701, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(53.3475, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(55.1846, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(63.0339, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(56.2036, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(59.5805, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(74.9976, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4722.6602, device='cuda:2')
test similarity is  tensor(0.6956, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031538011472854
test entropy is  2.301971739515319
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301971739515319
avg test loss is  2.3031538011472854
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4722.6602, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011986960895726328
avg test loss is  9.068395218276002
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4481.3438, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4481.3438, device='cuda:2')
test similarity is  tensor(0.7622, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.068395218276002
test entropy is  0.011986960895726328
________________________________
cal_distance is  tensor(581.0268, device='cuda:2')
cal_distance is  tensor(78.1128, device='cuda:2')
cal_distance is  tensor(14.5367, device='cuda:2')
________________________________
test distance is  tensor(14.5367, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2') 15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(399.0062, device='cuda:2')
compute similarity is  tensor(0.9941, device='cuda:2')
compute distance is  tensor(413.0794, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(391.9885, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(396.4209, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(397.4061, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(409.2325, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(378.4367, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(411.5913, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(410.0051, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(400.2193, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(409.4898, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(393.1972, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
calculated distance threshold is  tensor(447.7220, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2961800001564048
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2924800001564047
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.30494000015640504
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.30506000015640505
====================
====================
iteration is  1
round is  1
accuracy is  0.28868000015640466
====================
succ_min + 1
________________________________
test distance is  tensor(1064.7433, device='cuda:2')
test similarity is  tensor(0.7146, device='cuda:2')
test acc is  0.28868000015640466
test loss is 1.8183785989461347
test entropy is  1.8865517571454158
________________________________
cal_distance is  tensor(690.5997, device='cuda:2')
cal_distance is  tensor(447.9834, device='cuda:2')
cal_distance is  tensor(290.6569, device='cuda:2')
________________________________
test distance is  tensor(290.6569, device='cuda:2')
test similarity is  tensor(0.9661, device='cuda:2')
test acc is  0.3294800001564056
test loss is 1.7176570407569867
test entropy is  1.8247840970068636
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 34.50% 

Test Accuracy: 35.13% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(434.5547, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(433.4405, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(439.8777, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(418.3839, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(430.4925, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(421.2417, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(400.6537, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(430.0339, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(419.0671, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(422.0313, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(450.1090, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(429.1507, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
calculated distance threshold is  tensor(499.5642, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2988600001564049
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.33320000015640566
====================
====================
iteration is  0
round is  2
accuracy is  0.3063600001564051
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.31874000015640536
====================
====================
iteration is  1
round is  1
accuracy is  0.3290800001564056
====================
________________________________
test distance is  tensor(1065.6095, device='cuda:2')
test similarity is  tensor(0.7178, device='cuda:2')
test acc is  0.2988600001564049
test loss is 1.837183448207348
test entropy is  1.9086055847080163
________________________________
cal_distance is  tensor(729.7587, device='cuda:2')
cal_distance is  tensor(499.8038, device='cuda:2')
cal_distance is  tensor(342.3549, device='cuda:2')
________________________________
test distance is  tensor(342.3549, device='cuda:2')
test similarity is  tensor(0.9548, device='cuda:2')
test acc is  0.3440200001564059
test loss is 1.7027354394383443
test entropy is  1.8121964942158946
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 36.17% 

Test Accuracy: 36.59% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is 
test acc is  0.10000000015639873
test loss is 2.303132065116902
test entropy is  2.301974393827531
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301974393827531
avg test loss is  2.303132065116902
avg accuracy is  0.10000000015639873
compute_distance is  tensor(14.5367, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.015782470368277617
avg test loss is  8.168039593855134
avg accuracy is  0.10000000015639873
compute_distance is  tensor(640.7222, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(640.7222, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.168039593855134
test entropy is  0.015782470368277617
________________________________
cal_distance is  tensor(220.0067, device='cuda:2')
cal_distance is  tensor(76.2890, device='cuda:2')
cal_distance is  tensor(27.7196, device='cuda:2')
________________________________
test distance is  tensor(27.7196, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303750626571343
test entropy is  2.301313225265659
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301313225265659
avg test loss is  2.303750626571343
avg accuracy is  0.10000000015639873
compute_distance is  tensor(27.7196, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014315477243679412
avg test loss is  8.38314722017254
avg accuracy is  0.10000000015639873
compute_distance is  tensor(651.4686, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(651.4686, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.38314722017254
test entropy is  0.014315477243679412
________________________________
cal_distance is  tensor(221.8399, device='cuda:2')
cal_distance is  tensor(76.2881, device='cuda:2')
cal_distance is  tensor(27.5043, device='cuda:2')
________________________________
test distance is  tensor(27.5043, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3036025506456186
test entropy is  2.301468701618712
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301468701618712
avg test loss is  2.3036025506456186
avg accuracy is  0.10000000015639873
compute_distance is  tensor(27.5043, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01426325547044425
avg test loss is  8.393736673438031
avg accuracy is  0.10000000015639873
compute_distance is  tensor(651.0728, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(651.0728, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.393736673438031
test entropy is  0.01426325547044425
________________________________
cal_distance is  tensor(221.7721, device='cuda:2')
cal_distance is  tensor(76.2870, device='cuda:2')
cal_distance is  tensor(27.5099, device='cuda:2')
________________________________
test distance is  tensor(27.5099, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3036004475620397
test entropy is  2.3014707303108155
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3014707303108155
avg test loss is  2.3036004475620397
avg accuracy is  0.10000000015639873
compute_distance is  tensor(27.5099, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014246945306325278
avg test loss is  8.39637566893302
avg accuracy is  0.10000000015639873
compute_distance is  tensor(650.9159, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(650.9159, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.39637566893302
test entropy is  0.014246945306325278
________________________________
cal_distance is  tensor(221.7453, device='cuda:2')
cal_distance is  tensor(76.2868, device='cuda:2')
cal_distance is  tensor(27.5126, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(68.5372, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(65.2026, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(74.5688, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(68.8650, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(71.9953, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(58.4327, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(61.4468, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(60.1517, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(68.0918, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(76.3153, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(67.0112, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(75.0812, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(94.1979, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4732.1143, device='cuda:2')
test similarity is  tensor(0.6951, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3031788573545566
test entropy is  2.3018405303320923
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3018405303320923
avg test loss is  2.3031788573545566
avg accuracy is  0.10000000015639873 48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(476.5898, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(461.1786, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(483.2123, device='cuda:2')
compute similarity is  tensor(0.9925, device='cuda:2')
compute distance is  tensor(452.3322, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(449.9175, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(457.7143, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(449.5147, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(456.2998, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(458.0471, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(460.0407, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(453.2246, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(451.4919, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
calculated distance threshold is  tensor(516.9099, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.31362000015640523
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3391600001564058
====================
====================
iteration is  0
round is  2
accuracy is  0.3412600001564058
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3291800001564056
====================
====================
iteration is  1
round is  1
accuracy is  0.3267600001564055
====================
________________________________
test distance is  tensor(1061.2589, device='cuda:2')
test similarity is  tensor(0.7290, device='cuda:2')
test acc is  0.31362000015640523
test loss is 1.7623064446327326
test entropy is  1.8350722237926005
________________________________
cal_distance is  tensor(740.7948, device='cuda:2')
cal_distance is  tensor(517.1410, device='cuda:2')
cal_distance is  tensor(361.0521, device='cuda:2')
________________________________
test distance is  tensor(361.0521, device='cuda:2')
test similarity is  tensor(0.9525, device='cuda:2')
test acc is  0.36410000015640626
test loss is 1.647105292133663
test entropy is  1.754045785845393
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 36.67% 

Test Accuracy: 37.14% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(459.2421, device='cuda:2')
compute similarity is  tensor(0.9930, device='cuda:2')
compute distance is  tensor(455.7775, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(477.6037, device='cuda:2')
compute similarity is  tensor(0.9925, device='cuda:2')
compute distance is  tensor(458.8842, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(452.5329, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(445.6066, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(443.9747, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(470.9298, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(482.3900, device='cuda:2')
compute similarity is  tensor(0.9922, device='cuda:2')
compute distance is  tensor(454.1133, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(480.0180, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(474.3628, device='cuda:2')
compute similarity is  tensor(0.9923, device='cuda:2')
calculated distance threshold is  tensor(520.8052, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3238600001564055
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3213000001564055
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.33446000015640576
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3330000001564057
====================
====================
iteration is  1
round is  1
accuracy is  0.3493400001564059
====================
________________________________
test distance is  tensor(1062.1405, device='cuda:2')
test similarity is  tensor(0.7225, device='cuda:2')
test acc is  0.3213000001564055
test loss is 1.7624398482120252
test entropy is  1.8601398745461193
________________________________
cal_distance is  tensor(743.8879, device='cuda:2')
cal_distance is  tensor(521.0349, device='cuda:2')
cal_distance is  tensor(364.9846, device='cuda:2')
________________________________
test distance is  tensor(364.9846, device='cuda:2')
test similarity is  tensor(0.9500, device='cuda:2')
test acc is  0.36524000015640623
test loss is 1.6424692579547462
test entropy is  1.75001655850569
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 37.97% 

Test Accuracy: 38.35% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(495.0888, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(498.1938, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(500.4654, device='cuda:2')
compute similarity is  tensor(0.9920, device='cuda:2')
compute distance is  tensor(470.1411, device='cuda:2')
compute similarity is  tensor(0.9930, device='cuda:2')
compute distance is  tensor(476.6298, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(478.3884, device='cuda:2')
compute similarity is  tensor(0.9928, device='cuda:2')
compute distance is  tensor(472.2914, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(498.9346, device='cuda:2')
compute similarity is  tensor(0.9920, device='cuda:2')
compute distance is  tensor(485.4651, device='cuda:2')
compute similarity is  tensor(0.9924, device='cuda:2')
compute distance is  tensor(475.6266, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(478.3998, device='cuda:2')
compute similarity is  tensor(0.9925, device='cuda:2')
compute distance is  tensor(466.7420, device='cuda:2')
compute similarity is  tensor(0.9929, device='cuda:2')
calculated distance threshold is  tensor(534.1887, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3381200001564058
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3354400001564057
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.36920000015640636
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3453200001564059
====================
====================
iteration is  1
round is  1
accuracy is  0.3402800001564058
====================
________________________________
test distance is  tensor(1062.8241, device='cuda:2')
test similarity is  tensor(0.7280, device='cuda:2')
test acc is  0.3354400001564057
test loss is 1.7480701436776944
test entropy is  1.8248196753394572
________________________________
cal_distance is  tensor(753.6221, device='cuda:2')
cal_distance is  tensor(534.4128, device='cuda:2')
cal_distance is  tensor(379.0043, device='cuda:2')
________________________________
test distance is  tensor(379.0043, device='cuda:2')
test similarity is  tensor(0.9480, device='cuda:2')
test acc is  0.3842800001564065
test loss is 1.6138616275909308
test entropy is  1.7032741417970194
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 39.31% 

Test Accuracy: 40.11% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(519.1401, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(532.6887, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(541.2040, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(511.0667, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(522.7531, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(506.8260, device='cuda:2')
compute similarity is  tensor(0.9922, device='cuda:2')
compute distance is  tensor(519.6060, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(547.0574, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(534.2723, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(516.1157, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(522.1722, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(491.8442, device='cuda:2')
compute similarity is  tensor(0.9924, device='cuda:2')
calculated distance threshold is  tensor(602.2706, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.35920000015640624
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3440800001564059
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.35544000015640603
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.34510000015640585
====================
====================
iteration is  1
round is  1
accuracy is  0.34840000015640593
====================
________________________________
test distance is  tensor(1065.6954, device='cuda:2')
test similarity is  tensor(0.7320, device='cuda:2')
test acc is  0.3440800001564059
test loss is 1.6985770345039075
test entropy is  1.7477299784455458
________________________________
cal_distance is  tensor(801.2592, device='cuda:2')
cal_distance is  tensor(602.4666, device='cuda:2')
cal_distance is  tensor(453.0225, device='cuda:2')
________________________________
test distance is  tensor(453.0225, device='cuda:2')
test similarity is  tensor(0.9299, device='cuda:2')
test acc is  0.39466000015640673
compute_distance is  tensor(4732.1143, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011038507484352153
avg test loss is  9.156121555191781
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4466.8452, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4466.8452, device='cuda:2')
test similarity is  tensor(0.7618, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.156121555191781
test entropy is  0.011038507484352153
________________________________
cal_distance is  tensor(649.8764, device='cuda:2')
cal_distance is  tensor(97.0001, device='cuda:2')
cal_distance is  tensor(18.3494, device='cuda:2')
________________________________
test distance is  tensor(18.3494, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303216071080064
test entropy is  2.30185088446683
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.30185088446683
avg test loss is  2.303216071080064
avg accuracy is  0.10000000015639873
compute_distance is  tensor(18.3494, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.014437154503515386
avg test loss is  8.350483727881976
avg accuracy is  0.10000000015639873
compute_distance is  tensor(637.8321, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(637.8321, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.350483727881976
test entropy is  0.014437154503515386
________________________________
cal_distance is  tensor(245.8602, device='cuda:2')
cal_distance is  tensor(95.3845, device='cuda:2')
cal_distance is  tensor(37.9523, device='cuda:2')
________________________________
test distance is  tensor(37.9523, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.304139344893453
test entropy is  2.300841718073696
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.300841718073696
avg test loss is  2.304139344893453
avg accuracy is  0.10000000015639873
compute_distance is  tensor(37.9523, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013208613841725355
avg test loss is  8.570228661417657
avg accuracy is  0.10000000015639873
compute_distance is  tensor(649.5585, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(649.5585, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.570228661417657
test entropy is  0.013208613841725355
________________________________
cal_distance is  tensor(248.1018, device='cuda:2')
cal_distance is  tensor(95.3781, device='cuda:2')
cal_distance is  tensor(37.6134, device='cuda:2')
________________________________
test distance is  tensor(37.6134, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303841499721303
test entropy is  2.3011565229776876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3011565229776876
avg test loss is  2.303841499721303
avg accuracy is  0.10000000015639873
compute_distance is  tensor(37.6134, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013140281942218085
avg test loss is  8.585637348082365
avg accuracy is  0.10000000015639873
compute_distance is  tensor(649.2701, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(649.2701, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.585637348082365
test entropy is  0.013140281942218085
________________________________
cal_distance is  tensor(248.0433, device='cuda:2')
cal_distance is  tensor(95.3732, device='cuda:2')
cal_distance is  tensor(37.6160, device='cuda:2')
________________________________
test distance is  tensor(37.6160, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3038288940249196
test entropy is  2.301169475631031
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301169475631031
avg test loss is  2.3038288940249196
avg accuracy is  0.10000000015639873
compute_distance is  tensor(37.6160, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013118925517486871
avg test loss is  8.589505336473666
avg accuracy is  0.10000000015639873
compute_distance is  tensor(648.9342, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(648.9342, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.589505336473666
test entropy is  0.013118925517486871
________________________________
cal_distance is  tensor(247.9791, device='cuda:2')
cal_distance is  tensor(95.3729, device='cuda:2')
cal_distance is  tensor(37.6247, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(84.7950, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(77.2191, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(102.5376, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(88.1660, device='cuda:2')
compute similarity is  tensor(1.0000, device='cuda:2')
compute distance is  tensor(86.4853, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(72.9835, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(77.1432, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(71.0446, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(85.5273, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(104.4140, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(82.6210, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
test loss is 1.5886458070076945
test entropy is  1.6756569938281614
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 40.23% 

Test Accuracy: 40.97% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(552.4114, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(565.5380, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(583.3819, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(549.0989, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(552.6237, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(531.9949, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(536.5121, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(547.6157, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(547.8558, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(518.4846, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(558.1339, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(540.2090, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
calculated distance threshold is  tensor(648.2792, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.35222000015640603
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.33314000015640566
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3466800001564059
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3107400001564051
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3588000001564061
====================
________________________________
test distance is  tensor(1064.1671, device='cuda:2')
test similarity is  tensor(0.7389, device='cuda:2')
test acc is  0.3107400001564051
test loss is 1.8673370161934582
test entropy is  1.718056465811132
________________________________
cal_distance is  tensor(830.6874, device='cuda:2')
cal_distance is  tensor(648.4553, device='cuda:2')
cal_distance is  tensor(506.2223, device='cuda:2')
________________________________
test distance is  tensor(506.2222, device='cuda:2')
test similarity is  tensor(0.9176, device='cuda:2')
test acc is  0.3865000001564066
test loss is 1.6260626223081214
test entropy is  1.6433508153766623
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 41.10% 

Test Accuracy: 41.47% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(572.1220, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(599.9549, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(609.3917, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(578.9351, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(590.9897, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(552.9562, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(555.8417, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(560.5618, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(581.0519, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(536.4456, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(579.4706, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(585.3440, device='cuda:2')
compute similarity is  tensor(0.9896, device='cuda:2')
calculated distance threshold is  tensor(682.3377, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3752800001564064
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34484000015640587
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3478000001564059
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.37944000015640644
====================
====================
iteration is  1
round is  1
accuracy is  0.3263800001564055
====================
succ_min + 1
________________________________
test distance is  tensor(1064.7642, device='cuda:2')
test similarity is 
compute distance is  tensor(91.4984, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(137.7834, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4745.8296, device='cuda:2')
test similarity is  tensor(0.6946, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.302973176512267
test entropy is  2.3020340679856517
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3020340679856517
avg test loss is  2.302973176512267
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4745.8296, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.010896037614968655
avg test loss is  9.215981336505822
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4464.8530, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4464.8530, device='cuda:2')
test similarity is  tensor(0.7613, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.215981336505822
test entropy is  0.010896037614968655
________________________________
cal_distance is  tensor(785.4566, device='cuda:2')
cal_distance is  tensor(140.1232, device='cuda:2')
cal_distance is  tensor(28.5096, device='cuda:2')
________________________________
test distance is  tensor(28.5096, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3029461266744473
test entropy is  2.3020565878704686
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3020565878704686
avg test loss is  2.3029461266744473
avg accuracy is  0.10000000015639873
compute_distance is  tensor(28.5096, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.013302461643134008
avg test loss is  8.536723975330363
avg accuracy is  0.10000000015639873
compute_distance is  tensor(637.6830, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(637.6830, device='cuda:2')
test similarity is  tensor(0.9991, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.536723975330363
test entropy is  0.013302461643134008
________________________________
cal_distance is  tensor(297.0518, device='cuda:2')
cal_distance is  tensor(138.8020, device='cuda:2')
cal_distance is  tensor(65.4255, device='cuda:2')
________________________________
test distance is  tensor(65.4255, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3046009747878364
test entropy is  2.300185131904719
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.300185131904719
avg test loss is  2.3046009747878364
avg accuracy is  0.10000000015639873
compute_distance is  tensor(65.4255, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012142397418661077
avg test loss is  8.798893996821645
avg accuracy is  0.10000000015639873
compute_distance is  tensor(649.8469, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(649.8469, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.798893996821645
test entropy is  0.012142397418661077
________________________________
cal_distance is  tensor(299.8571, device='cuda:2')
cal_distance is  tensor(138.7845, device='cuda:2')
cal_distance is  tensor(64.7966, device='cuda:2')
________________________________
test distance is  tensor(64.7966, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303787794259503
test entropy is  2.3010544572644833
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.3010544572644833
avg test loss is  2.303787794259503
avg accuracy is  0.10000000015639873
compute_distance is  tensor(64.7966, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0120397892850868
avg test loss is  8.826860626640222
avg accuracy is  0.10000000015639873
compute_distance is  tensor(650.7566, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(650.7566, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.826860626640222
test entropy is  0.0120397892850868
________________________________
cal_distance is  tensor(300.0611, device='cuda:2')
cal_distance is  tensor(138.7765, device='cuda:2')
cal_distance is  tensor(64.7432, device='cuda:2')
________________________________
test distance is  tensor(64.7432, device='cuda:2')
test similarity is  tensor(1.0000, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303723093188937
test entropy is  2.301119285776182
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301119285776182
avg test loss is  2.303723093188937
avg accuracy is  0.10000000015639873
compute_distance is  tensor(64.7432, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01202356904957091
avg test loss is  8.83146877240037
avg accuracy is  0.10000000015639873
compute_distance is  tensor(650.9627, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(650.9627, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.83146877240037
test entropy is  0.01202356904957091
________________________________
cal_distance is  tensor(300.1069, device='cuda:2')
cal_distance is  tensor(138.7740, device='cuda:2')
cal_distance is  tensor(64.7304, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(139.3421, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(120.5418, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(222.2158, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2') tensor(0.7392, device='cuda:2')
test acc is  0.3263800001564055
test loss is 1.7708662120277618
test entropy is  1.7094806479980877
________________________________
cal_distance is  tensor(852.4564, device='cuda:2')
cal_distance is  tensor(682.4995, device='cuda:2')
cal_distance is  tensor(546.4453, device='cuda:2')
________________________________
test distance is  tensor(546.4453, device='cuda:2')
test similarity is  tensor(0.9059, device='cuda:2')
test acc is  0.3968200001564067
test loss is 1.603323774417038
test entropy is  1.634752544448199
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 42.03% 

Test Accuracy: 41.98% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(617.1092, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(617.1906, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(626.4066, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(628.1182, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(621.4288, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(584.3918, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(627.4193, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(613.8448, device='cuda:2')
compute similarity is  tensor(0.9896, device='cuda:2')
compute distance is  tensor(609.5065, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(600.2562, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(608.9015, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(624.6044, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
calculated distance threshold is  tensor(671.8447, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.32090000015640546
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34966000015640597
====================
====================
iteration is  0
round is  2
accuracy is  0.33160000015640567
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3582000001564061
====================
====================
iteration is  1
round is  1
accuracy is  0.3329800001564056
====================
________________________________
test distance is  tensor(1064.0804, device='cuda:2')
test similarity is  tensor(0.7556, device='cuda:2')
test acc is  0.32090000015640546
test loss is 1.9178886584308752
test entropy is  1.6201407767622673
________________________________
cal_distance is  tensor(845.6082, device='cuda:2')
cal_distance is  tensor(672.0108, device='cuda:2')
cal_distance is  tensor(534.0707, device='cuda:2')
________________________________
test distance is  tensor(534.0706, device='cuda:2')
test similarity is  tensor(0.9171, device='cuda:2')
test acc is  0.3967600001564067
test loss is 1.647740355690422
test entropy is  1.5601579507293604
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 43.03% 

Test Accuracy: 42.49% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(648.2867, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(655.3323, device='cuda:2')
compute similarity is  tensor(0.9877, device='cuda:2')
compute distance is  tensor(629.9799, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(636.6057, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(643.9219, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(616.8880, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(602.9642, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(642.1996, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
compute distance is  tensor(642.0095, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(621.1459, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(621.1581, device='cuda:2')
compute similarity is  tensor(0.9888, device='cuda:2')
compute distance is  tensor(639.9774, device='cuda:2')
compute similarity is  tensor(0.9883, device='cuda:2')
calculated distance threshold is  tensor(707.7004, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.35540000015640605
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.37700000015640645
====================
====================
iteration is  0
round is  2
accuracy is  0.3765800001564064
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.33568000015640564
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2935800001564048
====================
succ_min + 1
________________________________
test distance is  tensor(1064.3883, device='cuda:2')
test similarity is  tensor(0.7490, device='cuda:2')
test acc is  0.2935800001564048
test loss is 1.9549294964736685
test entropy is  1.6956094245776496
________________________________
cal_distance is  tensor(867.9932, device='cuda:2')
cal_distance is  tensor(707.8513, device='cuda:2')
cal_distance is  tensor(577.2704, device='cuda:2')
________________________________
test distance is  tensor(577.2704, device='cuda:2')
test similarity is  tensor(0.9014, device='cuda:2')
test acc is  0.3900000001564066
test loss is 1.6501701888830766
test entropy is  1.5943026214914249
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 42.15% 

Test Accuracy: 41.87% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(644.2104, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(691.0926, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(653.8635, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(659.1108, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(676.8173, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
compute distance is  tensor(666.1528, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(677.8242, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(655.8207, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
compute distance is  tensor(695.7963, device='cuda:2')
compute similarity is  tensor(0.9878, device='cuda:2')
compute distance is  tensor(653.2272, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
compute distance is  tensor(682.2501, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(682.2473, device='cuda:2')
compute similarity is  tensor(0.9877, device='cuda:2')
calculated distance threshold is  tensor(747.3823, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.35764000015640607
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3455800001564059
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.39260000015640667
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3405000001564058
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.32242000015640543
====================
succ_min + 1
________________________________
test distance is  tensor(1064.5281, device='cuda:2')
test similarity is  tensor(0.7658, device='cuda:2')
test acc is  0.32242000015640543
test loss is 1.9449976111007163
test entropy is  1.625763784284177
________________________________
cal_distance is  tensor(892.0425, device='cuda:2')
cal_distance is  tensor(747.5165, device='cuda:2')
cal_distance is  tensor(626.4180, device='cuda:2')
________________________________
test distance is  tensor(626.4180, device='cuda:2')
test similarity is  tensor(0.8965, device='cuda:2')
test acc is  0.39170000015640666
test loss is 1.6724648969557585
test entropy is  1.5480534894692013
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 43.62% 

Test Accuracy: 42.97% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(674.2479, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(707.4109, device='cuda:2')
compute similarity is  tensor(0.9868, device='cuda:2')
compute distance is  tensor(719.9339, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(708.5798, device='cuda:2')
compute similarity is  tensor(0.9871, device='cuda:2')
compute distance is  tensor(702.6672, device='cuda:2')
compute similarity is  tensor(0.9871, device='cuda:2')
compute distance is  tensor(682.1819, device='cuda:2')
compute similarity is  tensor(0.9876, device='cuda:2')
compute distance is  tensor(692.6559, device='cuda:2')
compute similarity is  tensor(0.9874, device='cuda:2')
compute distance is  tensor(669.5469, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(679.9851, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
compute distance is  tensor(659.1510, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(675.1263, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(713.5845, device='cuda:2')
compute similarity is  tensor(0.9863, device='cuda:2')
calculated distance threshold is  tensor(780.7168, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
compute distance is  tensor(167.3359, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(212.1745, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(100.9034, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(155.3460, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(108.9500, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(163.3500, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(246.6885, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(131.6479, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
compute distance is  tensor(193.2171, device='cuda:2')
compute similarity is  tensor(0.9999, device='cuda:2')
calculated distance threshold is  tensor(392.4737, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4729.5371, device='cuda:2')
test similarity is  tensor(0.6954, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.303242951707767
test entropy is  2.301542004051111
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301542004051111
avg test loss is  2.303242951707767
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4729.5371, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.009977242708696848
avg test loss is  9.346434221853075
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4419.0859, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4419.0859, device='cuda:2')
test similarity is  tensor(0.7622, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.346434221853075
test entropy is  0.009977242708696848
________________________________
cal_distance is  tensor(1317.8010, device='cuda:2')
cal_distance is  tensor(393.8872, device='cuda:2')
cal_distance is  tensor(119.4656, device='cuda:2')
________________________________
test distance is  tensor(119.4656, device='cuda:2')
test similarity is  tensor(0.9997, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3032364232460862
test entropy is  2.301589704230618
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.301589704230618
avg test loss is  2.3032364232460862
avg accuracy is  0.10000000015639873
compute_distance is  tensor(119.4656, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011507396340308248
avg test loss is  8.87765326463353
avg accuracy is  0.10000000015639873
compute_distance is  tensor(680.9018, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(680.9018, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.10000000015639873
test loss is 8.87765326463353
test entropy is  0.011507396340308248
________________________________
cal_distance is  tensor(517.2188, device='cuda:2')
cal_distance is  tensor(392.9565, device='cuda:2')
cal_distance is  tensor(298.6255, device='cuda:2')
________________________________
test distance is  tensor(298.6255, device='cuda:2')
test similarity is  tensor(0.9999, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3464960548883815
test entropy is  2.242215536134627
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.242215536134627
avg test loss is  2.3464960548883815
avg accuracy is  0.10000000015639873
compute_distance is  tensor(298.6255, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01076287819641878
avg test loss is  9.083423737064956
avg accuracy is  0.10000000015639873
compute_distance is  tensor(679.6331, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(679.6331, device='cuda:2')
test similarity is  tensor(0.9995, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.083423737064956
test entropy is  0.01076287819641878
________________________________
cal_distance is  tensor(516.7275, device='cuda:2')
cal_distance is  tensor(392.9384, device='cuda:2')
cal_distance is  tensor(298.8766, device='cuda:2')
________________________________
test distance is  tensor(298.8766, device='cuda:2')
test similarity is  tensor(0.9999, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3301482292087488
test entropy is  2.263303622565306
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.263303622565306
avg test loss is  2.3301482292087488
avg accuracy is  0.10000000015639873
compute_distance is  tensor(298.8766, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.010529074087843794
avg test loss is  9.155828582051464
avg accuracy is  0.10000000015639873
compute_distance is  tensor(683.7202, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(683.7202, device='cuda:2')
test similarity is  tensor(0.9996, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.155828582051464
test entropy is  0.010529074087843794
________________________________
cal_distance is  tensor(518.2761, device='cuda:2')
cal_distance is  tensor(392.9341, device='cuda:2')
cal_distance is  tensor(297.9769, device='cuda:2')
________________________________
test distance is  tensor(297.9769, device='cuda:2')
test similarity is  tensor(0.9999, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3240108660724768
test entropy is  2.271193559822219
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.271193559822219
avg test loss is  2.3240108660724768
avg accuracy is  0.10000000015639873
compute_distance is  tensor(297.9769, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.010436473229704687
avg test loss is  9.183825202000415
avg accuracy is  0.10000000015639873
compute_distance is  tensor(686.0624, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(686.0624, device='cuda:2')
test similarity is  tensor(0.9996, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.183825202000415
test entropy is  0.010436473229704687
________________________________
cal_distance is  tensor(519.1619, device='cuda:2')
cal_distance is  tensor(392.9323, device='cuda:2')
cal_distance is  tensor(297.4660, device='cuda:2')
reach max round
new distance ratio is 2
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is 
accuracy is  0.34976000015640596
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3774600001564064
====================
====================
iteration is  0
round is  2
accuracy is  0.350100000156406
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.35900000015640615
====================
====================
iteration is  1
round is  1
accuracy is  0.34450000015640586
====================
succ_min + 1
________________________________
test distance is  tensor(1063.2373, device='cuda:2')
test similarity is  tensor(0.7620, device='cuda:2')
test acc is  0.34450000015640586
test loss is 1.842819455182156
test entropy is  1.602226735838234
________________________________
cal_distance is  tensor(911.1558, device='cuda:2')
cal_distance is  tensor(780.8365, device='cuda:2')
cal_distance is  tensor(669.1656, device='cuda:2')
________________________________
test distance is  tensor(669.1656, device='cuda:2')
test similarity is  tensor(0.8818, device='cuda:2')
test acc is  0.407560000156407
test loss is 1.6279356020795719
test entropy is  1.5269608861954926
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 43.66% 

Test Accuracy: 43.83% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(747.8254, device='cuda:2')
compute similarity is  tensor(0.9860, device='cuda:2')
compute distance is  tensor(790.9155, device='cuda:2')
compute similarity is  tensor(0.9845, device='cuda:2')
compute distance is  tensor(734.5931, device='cuda:2')
compute similarity is  tensor(0.9869, device='cuda:2')
compute distance is  tensor(733.1588, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(773.0997, device='cuda:2')
compute similarity is  tensor(0.9853, device='cuda:2')
compute distance is  tensor(732.5435, device='cuda:2')
compute similarity is  tensor(0.9866, device='cuda:2')
compute distance is  tensor(739.1015, device='cuda:2')
compute similarity is  tensor(0.9866, device='cuda:2')
compute distance is  tensor(694.6851, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
compute distance is  tensor(732.7698, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(712.4544, device='cuda:2')
compute similarity is  tensor(0.9871, device='cuda:2')
compute distance is  tensor(719.4854, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(782.0500, device='cuda:2')
compute similarity is  tensor(0.9841, device='cuda:2')
calculated distance threshold is  tensor(887.1460, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3736200001564064
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3477000001564059
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.38488000015640655
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3755200001564064
====================
====================
iteration is  1
round is  1
accuracy is  0.3570000001564061
====================
________________________________
test distance is  tensor(1066.5121, device='cuda:2')
test similarity is  tensor(0.7723, device='cuda:2')
test acc is  0.3477000001564059
test loss is 1.7964151442203375
test entropy is  1.5267347448012407
________________________________
cal_distance is  tensor(972.7430, device='cuda:2')
cal_distance is  tensor(887.2218, device='cuda:2')
cal_distance is  tensor(809.2228, device='cuda:2')
________________________________
test distance is  tensor(809.2228, device='cuda:2')
test similarity is  tensor(0.8484, device='cuda:2')
test acc is  0.3989800001564067
test loss is 1.6435744283754197
test entropy is  1.4859097258514151
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 45.58% 

Test Accuracy: 45.84% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(755.4695, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(749.4196, device='cuda:2')
compute similarity is  tensor(0.9874, device='cuda:2')
compute distance is  tensor(791.0877, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(818.6518, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(765.1516, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(776.4847, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(800.1385, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
compute distance is  tensor(757.4501, device='cuda:2')
compute similarity is  tensor(0.9873, device='cuda:2')
compute distance is  tensor(802.3254, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(772.4593, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(790.9131, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(821.0322, device='cuda:2')
compute similarity is  tensor(0.9844, device='cuda:2')
calculated distance threshold is  tensor(892.6448, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3577600001564061
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(639.6689, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(714.3470, device='cuda:2')
compute similarity is  tensor(0.9988, device='cuda:2')
compute distance is  tensor(827.7213, device='cuda:2')
compute similarity is  tensor(0.9983, device='cuda:2')
compute distance is  tensor(794.9850, device='cuda:2')
compute similarity is  tensor(0.9986, device='cuda:2')
compute distance is  tensor(817.6469, device='cuda:2')
compute similarity is  tensor(0.9984, device='cuda:2')
compute distance is  tensor(586.4193, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(818.0120, device='cuda:2')
compute similarity is  tensor(0.9986, device='cuda:2')
compute distance is  tensor(625.4288, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(809.3956, device='cuda:2')
compute similarity is  tensor(0.9986, device='cuda:2')
compute distance is  tensor(899.2228, device='cuda:2')
compute similarity is  tensor(0.9983, device='cuda:2')
compute distance is  tensor(622.7503, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(689.9485, device='cuda:2')
compute similarity is  tensor(0.9988, device='cuda:2')
calculated distance threshold is  tensor(1212.0264, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4725.7373, device='cuda:2')
test similarity is  tensor(0.6949, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.302892944392036
test entropy is  2.2996204021336784
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2996204021336784
avg test loss is  2.302892944392036
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4725.7373, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.00827078442291721
avg test loss is  9.598417038198017
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4332.3462, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4332.3462, device='cuda:2')
test similarity is  tensor(0.7618, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.598417038198017
test entropy is  0.00827078442291721
________________________________
cal_distance is  tensor(2292.0129, device='cuda:2')
cal_distance is  tensor(1212.8856, device='cuda:2')
cal_distance is  tensor(642.2147, device='cuda:2')
________________________________
test distance is  tensor(642.2147, device='cuda:2')
test similarity is  tensor(0.9922, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3034120374323463
test entropy is  2.2991901401363677
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2991901401363677
avg test loss is  2.3034120374323463
avg accuracy is  0.10000000015639873
compute_distance is  tensor(642.2147, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.008847376008939636
avg test loss is  9.3945078191245
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1001.5096, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1001.5096, device='cuda:2')
test similarity is  tensor(0.9944, device='cuda:2')
test acc is  0.10000000015639873
test loss is 9.3945078191245
test entropy is  0.008847376008939636
________________________________
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(599.3895, device='cuda:2')
compute similarity is  tensor(0.9994, device='cuda:2')
compute distance is  tensor(671.5547, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(680.0541, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(526.5790, device='cuda:2')
compute similarity is  tensor(0.9995, device='cuda:2')
compute distance is  tensor(884.0135, device='cuda:2')
compute similarity is  tensor(0.9984, device='cuda:2')
compute distance is  tensor(620.5656, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(674.5356, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(542.0707, device='cuda:2')
compute similarity is  tensor(0.9995, device='cuda:2')
compute distance is  tensor(717.8513, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(531.7065, device='cuda:2')
compute similarity is  tensor(0.9995, device='cuda:2')
compute distance is  tensor(608.8865, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(954.9963, device='cuda:2')
compute similarity is  tensor(0.9977, device='cuda:2')
calculated distance threshold is  tensor(1383.4136, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34948000015640596
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3902600001564066
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3626200001564062
====================
====================
iteration is  1
round is  1
accuracy is  0.40082000015640684
====================
________________________________
test distance is  tensor(1063.1777, device='cuda:2')
test similarity is  tensor(0.7882, device='cuda:2')
test acc is  0.34948000015640596
test loss is 1.7937229589733017
test entropy is  1.5045766094151665
________________________________
cal_distance is  tensor(974.2247, device='cuda:2')
cal_distance is  tensor(892.7172, device='cuda:2')
cal_distance is  tensor(818.0320, device='cuda:2')
________________________________
test distance is  tensor(818.0320, device='cuda:2')
test similarity is  tensor(0.8572, device='cuda:2')
test acc is  0.4053000001564069
test loss is 1.6274834781351601
test entropy is  1.4637840329228764
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 46.35% 

Test Accuracy: 46.85% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(792.1001, device='cuda:2')
compute similarity is  tensor(0.9858, device='cuda:2')
compute distance is  tensor(808.7804, device='cuda:2')
compute similarity is  tensor(0.9858, device='cuda:2')
compute distance is  tensor(817.3467, device='cuda:2')
compute similarity is  tensor(0.9853, device='cuda:2')
compute distance is  tensor(809.8418, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
compute distance is  tensor(813.5201, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(785.7840, device='cuda:2')
compute similarity is  tensor(0.9860, device='cuda:2')
compute distance is  tensor(790.2325, device='cuda:2')
compute similarity is  tensor(0.9863, device='cuda:2')
compute distance is  tensor(793.4682, device='cuda:2')
compute similarity is  tensor(0.9863, device='cuda:2')
compute distance is  tensor(789.2957, device='cuda:2')
compute similarity is  tensor(0.9865, device='cuda:2')
compute distance is  tensor(781.0042, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(783.4194, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(820.9227, device='cuda:2')
compute similarity is  tensor(0.9846, device='cuda:2')
calculated distance threshold is  tensor(860.8412, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3881400001564066
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.355260000156406
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3672200001564063
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.36548000015640625
====================
====================
iteration is  1
round is  1
accuracy is  0.38204000015640655
====================
________________________________
test distance is  tensor(1066.5660, device='cuda:2')
test similarity is  tensor(0.7894, device='cuda:2')
test acc is  0.355260000156406
test loss is 1.8458899021758448
test entropy is  1.4147247085181038
________________________________
cal_distance is  tensor(958.2441, device='cuda:2')
cal_distance is  tensor(860.9282, device='cuda:2')
cal_distance is  tensor(773.5000, device='cuda:2')
________________________________
test distance is  tensor(773.4999, device='cuda:2')
test similarity is  tensor(0.8711, device='cuda:2')
test acc is  0.4202200001564071
test loss is 1.6197261557249767
test entropy is  1.3725502181540974
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 48.03% 

Test Accuracy: 47.75% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(817.3899, device='cuda:2')
compute similarity is  tensor(0.9846, device='cuda:2')
compute distance is  tensor(811.6378, device='cuda:2')
compute similarity is  tensor(0.9848, device='cuda:2')
compute distance is  tensor(830.9487, device='cuda:2')
compute similarity is  tensor(0.9848, device='cuda:2')
compute distance is  tensor(809.7604, device='cuda:2')
compute similarity is  tensor(0.9853, device='cuda:2')
compute distance is  tensor(842.3276, device='cuda:2')
compute similarity is  tensor(0.9839, device='cuda:2') 0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4722.7446, device='cuda:2')
test similarity is  tensor(0.6964, device='cuda:2')
test acc is  0.10000000015639873
test loss is 4.259047380798613
test entropy is  0.5787812499591457
________________________________
cal_distance is  tensor(2558.4946, device='cuda:2')
cal_distance is  tensor(1387.1467, device='cuda:2')
cal_distance is  tensor(753.1822, device='cuda:2')
________________________________
test distance is  tensor(753.1821, device='cuda:2')
test similarity is  tensor(0.9869, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.662070433806885
test entropy is  1.7633825985671918
________________________________
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 16.23% 

Test Accuracy: 16.21% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1142.8397, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(1191.9095, device='cuda:2')
compute similarity is  tensor(0.9980, device='cuda:2')
compute distance is  tensor(1298.1066, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(1441.8145, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(1182.9738, device='cuda:2')
compute similarity is  tensor(0.9976, device='cuda:2')
compute distance is  tensor(584.0272, device='cuda:2')
compute similarity is  tensor(0.9993, device='cuda:2')
compute distance is  tensor(1421.0846, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(1468.3925, device='cuda:2')
compute similarity is  tensor(0.9961, device='cuda:2')
compute distance is  tensor(1444.6946, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(481.9270, device='cuda:2')
compute similarity is  tensor(0.9992, device='cuda:2')
compute distance is  tensor(1228.0593, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(1005.6019, device='cuda:2')
compute similarity is  tensor(0.9977, device='cuda:2')
calculated distance threshold is  tensor(2454.8579, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4736.2124, device='cuda:2')
test similarity is  tensor(0.6956, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.3097362076230064
test entropy is  2.2768652265334066
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.2768652265334066
avg test loss is  2.3097362076230064
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4736.2124, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.006648940267636801
avg test loss is  10.74295474684147
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4265.0312, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4265.0312, device='cuda:2')
test similarity is  tensor(0.7624, device='cuda:2')
test acc is  0.10000000015639873
test loss is 10.74295474684147
test entropy is  0.006648940267636801
________________________________
cal_distance is  tensor(3236.0032, device='cuda:2')
cal_distance is  tensor(2455.3208, device='cuda:2')
cal_distance is  tensor(1863.0541, device='cuda:2')
________________________________
test distance is  tensor(1863.0541, device='cuda:2')
test similarity is  tensor(0.9379, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.4011717293878347
test entropy is  2.125563620606347
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.125563620606347
avg test loss is  2.4011717293878347
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1863.0541, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.007930085913020917
avg test loss is  10.436165886461888
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1881.1654, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1881.1654, device='cuda:2')
test similarity is  tensor(0.9566, device='cuda:2')
test acc is  0.10000000015639873
test loss is 10.436165886461888
test entropy is  0.007930085913020917
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 9.86% 

Test Accuracy: 10.20% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  
compute distance is  tensor(828.4960, device='cuda:2')
compute similarity is  tensor(0.9835, device='cuda:2')
compute distance is  tensor(820.8149, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(804.5930, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(858.6039, device='cuda:2')
compute similarity is  tensor(0.9832, device='cuda:2')
compute distance is  tensor(810.0082, device='cuda:2')
compute similarity is  tensor(0.9848, device='cuda:2')
compute distance is  tensor(831.3234, device='cuda:2')
compute similarity is  tensor(0.9842, device='cuda:2')
compute distance is  tensor(849.0594, device='cuda:2')
compute similarity is  tensor(0.9833, device='cuda:2')
calculated distance threshold is  tensor(912.6147, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.41826000015640713
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4009600001564068
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3924000001564067
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.41136000015640695
====================
====================
iteration is  1
round is  1
accuracy is  0.40772000015640697
====================
________________________________
test distance is  tensor(1064.7729, device='cuda:2')
test similarity is  tensor(0.7845, device='cuda:2')
test acc is  0.3924000001564067
test loss is 1.7168328768152106
test entropy is  1.4303250172558952
________________________________
cal_distance is  tensor(985.7958, device='cuda:2')
cal_distance is  tensor(912.6791, device='cuda:2')
cal_distance is  tensor(844.9880, device='cuda:2')
________________________________
test distance is  tensor(844.9880, device='cuda:2')
test similarity is  tensor(0.8471, device='cuda:2')
test acc is  0.43048000015640725
test loss is 1.5868223367444694
test entropy is  1.377791172403204
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 47.04% 

Test Accuracy: 47.16% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(854.2476, device='cuda:2')
compute similarity is  tensor(0.9855, device='cuda:2')
compute distance is  tensor(886.9902, device='cuda:2')
compute similarity is  tensor(0.9847, device='cuda:2')
compute distance is  tensor(879.1421, device='cuda:2')
compute similarity is  tensor(0.9853, device='cuda:2')
compute distance is  tensor(859.7207, device='cuda:2')
compute similarity is  tensor(0.9860, device='cuda:2')
compute distance is  tensor(858.1010, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(864.6362, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(872.9693, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(870.7585, device='cuda:2')
compute similarity is  tensor(0.9858, device='cuda:2')
compute distance is  tensor(903.9985, device='cuda:2')
compute similarity is  tensor(0.9843, device='cuda:2')
compute distance is  tensor(846.8149, device='cuda:2')
compute similarity is  tensor(0.9860, device='cuda:2')
compute distance is  tensor(851.1943, device='cuda:2')
compute similarity is  tensor(0.9858, device='cuda:2')
compute distance is  tensor(907.5269, device='cuda:2')
compute similarity is  tensor(0.9838, device='cuda:2')
calculated distance threshold is  tensor(968.2388, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3747000001564065
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3843800001564066
====================
====================
iteration is  0
round is  2
accuracy is  0.3433200001564059
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.36498000015640625
====================
====================
iteration is  1
round is  1
accuracy is  0.4004600001564068
====================
________________________________
test distance is  tensor(1062.1797, device='cuda:2')
test similarity is  tensor(0.8089, device='cuda:2')
test acc is  0.3433200001564059
test loss is 1.967638414076832
test entropy is  1.41703081283423
________________________________
cal_distance is  tensor(1014.1423, device='cuda:2')
cal_distance is  tensor(968.2786, device='cuda:2')
cal_distance is  tensor(924.4898, device='cuda:2')
________________________________
test distance is  tensor(924.4898, device='cuda:2')
test similarity is  tensor(0.8452, device='cuda:2')
test acc is  0.3759200001564065
test loss is 1.826834854262564
test entropy is  1.3889556435672827
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 47.79% 

Test Accuracy: 47.25% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(882.9479, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
compute distance is  tensor(880.1052, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(945.4154, device='cuda:2')
compute similarity is  tensor(0.9841, device='cuda:2')
compute distance is  tensor(941.3912, device='cuda:2')
compute similarity is  tensor(0.9842, device='cuda:2')
compute distance is  tensor(915.8024, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(931.4167, device='cuda:2')
compute similarity is  tensor(0.9844, device='cuda:2')
compute distance is  tensor(913.8633, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(900.2572, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(934.3896, device='cuda:2')
compute similarity is  tensor(0.9845, device='cuda:2')53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1613.7607, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1699.1543, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(1694.8622, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(1639.0959, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(1364.3142, device='cuda:2')
compute similarity is  tensor(0.9974, device='cuda:2')
compute distance is  tensor(1790.3816, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(1649.0764, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1706.9481, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(1593.6077, device='cuda:2')
compute similarity is  tensor(0.9973, device='cuda:2')
compute distance is  tensor(1576.9055, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(1449.1766, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(1343.3583, device='cuda:2')
compute similarity is  tensor(0.9974, device='cuda:2')
calculated distance threshold is  tensor(2237.4048, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
====================
iteration is  0
round is  2
accuracy is  0.10000000015639873
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10000000015639873
====================
====================
iteration is  1
round is  1
accuracy is  0.10000000015639873
====================
________________________________
test distance is  tensor(4739.7803, device='cuda:2')
test similarity is  tensor(0.6997, device='cuda:2')
test acc is  0.10000000015639873
test loss is 4.385345252578521
test entropy is  0.7506536067751668
________________________________
cal_distance is  tensor(3258.1543, device='cuda:2')
cal_distance is  tensor(2240.1921, device='cuda:2')
cal_distance is  tensor(1540.7936, device='cuda:2')
________________________________
test distance is  tensor(1540.7936, device='cuda:2')
test similarity is  tensor(0.9493, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.7704684091041156
test entropy is  1.6300385123323602
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 17.87% 

Test Accuracy: 18.25% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1637.6815, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(1847.8513, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(1536.8683, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1975.7744, device='cuda:2')
compute similarity is  tensor(0.9961, device='cuda:2')
compute distance is  tensor(1855.7158, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(1903.8208, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(1831.6768, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1747.0599, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(1813.7714, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(1634.0239, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(1805.3821, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(1410.6448, device='cuda:2')
compute similarity is  tensor(0.9977, device='cuda:2')
calculated distance threshold is  tensor(2540.9041, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1065400001563987
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10000000015639873
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.10044000015639871
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.11258000015639867
====================
====================
iteration is  1
round is  1
accuracy is  0.1005400001563987
====================
________________________________
test distance is  tensor(4732.8096, device='cuda:2')
test similarity is  tensor(0.7024, device='cuda:2')
test acc is  0.10000000015639873
test loss is 2.373046255172671
test entropy is  2.0894780390707735
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.0894780390707735
avg test loss is  2.373046255172671
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4732.8096, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0066425918060762194
avg test loss is  12.925309678782588
avg accuracy is  0.10000000015639873
compute_distance is  tensor(4222.0835, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4222.0835, device='cuda:2')
test similarity is  tensor(0.7685, device='cuda:2')
test acc is  0.10000000015639873
test loss is 12.925309678782588
test entropy is  0.0066425918060762194
________________________________
cal_distance is  tensor(3275.5730, device='cuda:2')
cal_distance is  tensor(2541.3098, device='cuda:2')
cal_distance is  tensor(1971.7032, device='cuda:2')
________________________________
test distance is  tensor(1971.7032, device='cuda:2')
test similarity is  tensor(0.9323, device='cuda:2')
test acc is  0.1003600001563987
test loss is 2.7502824028434656
test entropy is  1.6214690478256597
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 17.27% 

Test Accuracy: 17.46% 

compute distance is  tensor(930.7255, device='cuda:2')
compute similarity is  tensor(0.9840, device='cuda:2')
compute distance is  tensor(904.7955, device='cuda:2')
compute similarity is  tensor(0.9852, device='cuda:2')
compute distance is  tensor(937.7534, device='cuda:2')
compute similarity is  tensor(0.9837, device='cuda:2')
calculated distance threshold is  tensor(1010.7256, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3845000001564066
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.39612000015640675
====================
====================
iteration is  0
round is  2
accuracy is  0.42968000015640717
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.37686000015640647
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3597000001564062
====================
succ_min + 1
________________________________
test distance is  tensor(1064.7806, device='cuda:2')
test similarity is  tensor(0.8200, device='cuda:2')
test acc is  0.3597000001564062
test loss is 1.9129720215907182
test entropy is  1.328833128942553
________________________________
cal_distance is  tensor(1037.4127, device='cuda:2')
cal_distance is  tensor(1010.7485, device='cuda:2')
cal_distance is  tensor(984.7700, device='cuda:2')
________________________________
test distance is  tensor(984.7700, device='cuda:2')
test similarity is  tensor(0.8401, device='cuda:2')
test acc is  0.3804600001564065
test loss is 1.8249771389205132
test entropy is  1.3153203922464414
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 48.41% 

Test Accuracy: 48.31% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(941.9819, device='cuda:2')
compute similarity is  tensor(0.9851, device='cuda:2')
compute distance is  tensor(964.6534, device='cuda:2')
compute similarity is  tensor(0.9847, device='cuda:2')
compute distance is  tensor(953.1509, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(978.8541, device='cuda:2')
compute similarity is  tensor(0.9842, device='cuda:2')
compute distance is  tensor(963.1733, device='cuda:2')
compute similarity is  tensor(0.9851, device='cuda:2')
compute distance is  tensor(927.2665, device='cuda:2')
compute similarity is  tensor(0.9856, device='cuda:2')
compute distance is  tensor(964.4787, device='cuda:2')
compute similarity is  tensor(0.9844, device='cuda:2')
compute distance is  tensor(959.4356, device='cuda:2')
compute similarity is  tensor(0.9851, device='cuda:2')
compute distance is  tensor(979.1016, device='cuda:2')
compute similarity is  tensor(0.9843, device='cuda:2')
compute distance is  tensor(925.5164, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(920.6740, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
compute distance is  tensor(970.4733, device='cuda:2')
compute similarity is  tensor(0.9841, device='cuda:2')
calculated distance threshold is  tensor(1037.5291, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3632800001564062
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3696000001564063
====================
====================
iteration is  0
round is  2
accuracy is  0.4182200001564071
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.42792000015640724
====================
====================
iteration is  1
round is  1
accuracy is  0.39140000015640675
====================
________________________________
test distance is  tensor(1067.7244, device='cuda:2')
test similarity is  tensor(0.8283, device='cuda:2')
test acc is  0.3632800001564062
test loss is 1.9461440527835465
test entropy is  1.328546543712811
________________________________
cal_distance is  tensor(1052.5250, device='cuda:2')
cal_distance is  tensor(1037.5419, device='cuda:2')
cal_distance is  tensor(1022.7722, device='cuda:2')
________________________________
test distance is  tensor(1022.7722, device='cuda:2')
test similarity is  tensor(0.8393, device='cuda:2')
test acc is  0.37200000015640644
test loss is 1.9004186288170193
test entropy is  1.3209586712100623
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 50.47% 

Test Accuracy: 49.60% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(949.1345, device='cuda:2')
compute similarity is  tensor(0.9837, device='cuda:2')
compute distance is  tensor(951.7547, device='cuda:2')
compute similarity is  tensor(0.9837, device='cuda:2')

 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1770.0175, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(2020.3290, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(1766.2695, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1929.6066, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(2007.3788, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(2019.9858, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(1884.6399, device='cuda:2')
compute similarity is  tensor(0.9971, device='cuda:2')
compute distance is  tensor(1868.3400, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(1937.3251, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1756.4491, device='cuda:2')
compute similarity is  tensor(0.9973, device='cuda:2')
compute distance is  tensor(1873.6022, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(1849.9652, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
calculated distance threshold is  tensor(2284.2090, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.10120000015639871
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10020000015639871
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.1003600001563987
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10080000015639871
====================
====================
iteration is  1
round is  1
accuracy is  0.10336000015639871
====================
________________________________
test distance is  tensor(4730.5874, device='cuda:2')
test similarity is  tensor(0.7142, device='cuda:2')
test acc is  0.10020000015639871
test loss is 2.627989353426277
test entropy is  1.825486494604584
________________________________
cal_distance is  tensor(3288.8054, device='cuda:2')
cal_distance is  tensor(2286.9390, device='cuda:2')
cal_distance is  tensor(1590.7614, device='cuda:2')
________________________________
test distance is  tensor(1590.7614, device='cuda:2')
test similarity is  tensor(0.9500, device='cuda:2')
test acc is  0.1485400001563986
test loss is 2.13419977767998
test entropy is  2.1139733834034953
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.1139733834034953
avg test loss is  2.13419977767998
avg accuracy is  0.1485400001563986
compute_distance is  tensor(1590.7614, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011512580237177479
avg test loss is  13.478888001893182
avg accuracy is  0.10000000015639873
compute_distance is  tensor(1663.4801, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1663.4801, device='cuda:2')
test similarity is  tensor(0.9653, device='cuda:2')
test acc is  0.10000000015639873
test loss is 13.478888001893182
test entropy is  0.011512580237177479
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 18.97% 

Test Accuracy: 18.92% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1869.7811, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(1958.1721, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(1864.9153, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(1908.9894, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(2086.7004, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(1929.4233, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(1918.2516, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(1888.9675, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(1923.4862, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1749.6361, device='cuda:2')
compute similarity is  tensor(0.9972, device='cuda:2')
compute distance is  tensor(1760.4845, device='cuda:2')
compute similarity is  tensor(0.9968, device='cuda:2')
compute distance is  tensor(1977.0958, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
calculated distance threshold is  tensor(2423.7646, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.11694000015639866
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is 
compute distance is  tensor(940.6426, device='cuda:2')
compute similarity is  tensor(0.9843, device='cuda:2')
compute distance is  tensor(949.8481, device='cuda:2')
compute similarity is  tensor(0.9839, device='cuda:2')
compute distance is  tensor(925.3099, device='cuda:2')
compute similarity is  tensor(0.9846, device='cuda:2')
compute distance is  tensor(965.5696, device='cuda:2')
compute similarity is  tensor(0.9831, device='cuda:2')
compute distance is  tensor(942.9687, device='cuda:2')
compute similarity is  tensor(0.9841, device='cuda:2')
compute distance is  tensor(948.4564, device='cuda:2')
compute similarity is  tensor(0.9843, device='cuda:2')
compute distance is  tensor(965.4379, device='cuda:2')
compute similarity is  tensor(0.9836, device='cuda:2')
compute distance is  tensor(940.1350, device='cuda:2')
compute similarity is  tensor(0.9839, device='cuda:2')
compute distance is  tensor(960.1934, device='cuda:2')
compute similarity is  tensor(0.9832, device='cuda:2')
compute distance is  tensor(1000.6263, device='cuda:2')
compute similarity is  tensor(0.9814, device='cuda:2')
calculated distance threshold is  tensor(1075.9426, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4702800001564077
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.44934000015640746
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4723600001564077
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.46164000015640755
====================
====================
iteration is  1
round is  1
accuracy is  0.4689600001564076
====================
________________________________
test distance is  tensor(1060.3970, device='cuda:2')
test similarity is  tensor(0.8200, device='cuda:2')
test acc is  0.44934000015640746
test loss is 1.5829962485891473
test entropy is  1.2464213003892728
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 49.88% 

Test Accuracy: 49.09% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(955.1085, device='cuda:2')
compute similarity is  tensor(0.9867, device='cuda:2')
compute distance is  tensor(1020.8832, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(979.3637, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(1012.2205, device='cuda:2')
compute similarity is  tensor(0.9855, device='cuda:2')
compute distance is  tensor(974.3524, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(958.7872, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(986.7006, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(977.3397, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(1029.6436, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(982.5446, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(956.1730, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(996.9220, device='cuda:2')
compute similarity is  tensor(0.9856, device='cuda:2')
calculated distance threshold is  tensor(1104.1787, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4566200001564075
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.43506000015640733
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3994400001564069
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.40910000015640696
====================
====================
iteration is  1
round is  1
accuracy is  0.42060000015640714
====================
________________________________
test distance is  tensor(1061.7916, device='cuda:2')
test similarity is  tensor(0.8451, device='cuda:2')
test acc is  0.3994400001564069
test loss is 1.8200630223964487
test entropy is  1.231027617631361
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 51.25% 

Test Accuracy: 49.65% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(968.7172, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(995.1937, device='cuda:2')
compute similarity is  tensor(0.9837, device='cuda:2')
compute distance is  tensor(1045.3170, device='cuda:2')
compute similarity is  tensor(0.9826, device='cuda:2')
compute distance is  tensor(1030.8899, device='cuda:2')
compute similarity is  tensor(0.9831, device='cuda:2')
compute distance is  tensor(1012.0234, device='cuda:2')
compute similarity is  tensor(0.9832, device='cuda:2')
compute distance is  tensor(998.1825, device='cuda:2')
compute similarity is  tensor(0.9835, device='cuda:2')
compute distance is  tensor(1038.7446, device='cuda:2')
compute similarity is  tensor(0.9824, device='cuda:2')
compute distance is  tensor(993.5959, device='cuda:2')
compute similarity is  tensor(0.9843, device='cuda:2')
compute distance is  tensor(1021.7786, device='cuda:2')
compute similarity is  tensor(0.9834, device='cuda:2')
compute distance is  tensor(999.3105, device='cuda:2')
compute similarity is  tensor(0.9835, device='cuda:2')
compute distance is  tensor(988.1634, device='cuda:2')
compute similarity is  tensor(0.9844, device='cuda:2')
compute distance is  tensor(1014.0032, device='cuda:2')
compute similarity is  tensor(0.9834, device='cuda:2')
calculated distance threshold is  tensor(1121.9167, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.44512000015640746
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.43386000015640735
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.43778000015640733
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.47628000015640776
====================
====================
iteration is  1
round is  1
accuracy is  0.4398400001564074
====================
________________________________
test distance is  tensor(1061.4763, device='cuda:2')
test similarity is  tensor(0.8331, device='cuda:2')
test acc is  0.43386000015640735
test loss is 1.6890988323999487
test entropy is  1.2343145770490016
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 48.87% 

Test Accuracy: 48.15% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1063.2997, device='cuda:2')
compute similarity is  tensor(0.9846, device='cuda:2')
compute distance is  tensor(1021.7360, device='cuda:2')
compute similarity is  tensor(0.9860, device='cuda:2')
compute distance is  tensor(1017.0510, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(1030.7004, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
compute distance is  tensor(1039.7949, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
compute distance is  tensor(1004.1450, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(1023.4592, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(1029.3660, device='cuda:2')
compute similarity is  tensor(0.9860, device='cuda:2')
compute distance is  tensor(1048.4290, device='cuda:2')
compute similarity is  tensor(0.9855, device='cuda:2')
compute distance is  tensor(1029.7950, device='cuda:2')
compute similarity is  tensor(0.9856, device='cuda:2')
compute distance is  tensor(1010.1948, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(1053.6154, device='cuda:2')
compute similarity is  tensor(0.9851, device='cuda:2')
calculated distance threshold is  tensor(1122.4543, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.42690000015640717
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4250800001564072
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4289600001564072
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4250800001564072
====================
====================
iteration is  1
round is  1
accuracy is  0.4243600001564072
====================
succ_min + 1
________________________________
test distance is  tensor(1066.4166, device='cuda:2')
test similarity is  tensor(0.8552, device='cuda:2')
test acc is  0.4243600001564072
test loss is 1.7352986207703496
test entropy is  1.1968705675486104
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 52.01% 

Test Accuracy: 50.96% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1032.0751, device='cuda:2')
compute similarity is  tensor(0.9855, device='cuda:2')
compute distance is  tensor(1050.5477, device='cuda:2')
compute similarity is  tensor(0.9851, device='cuda:2')
compute distance is  tensor(1038.9641, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(1080.9569, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(1044.0411, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(1027.3976, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(1072.6582, device='cuda:2')
compute similarity is  tensor(0.9845, device='cuda:2')
compute distance is  tensor(1014.9188, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(1073.8698, device='cuda:2')
compute similarity is  tensor(0.9844, device='cuda:2')
compute distance is  tensor(1049.4205, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(1033.4457, device='cuda:2')
compute similarity is  tensor(0.9856, device='cuda:2')
compute distance is  tensor(1058.7795, device='cuda:2')
compute similarity is  tensor(0.9847, device='cuda:2')
calculated distance threshold is  tensor(1146.9951, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4685400001564077
====================
succ_min + 1
====================
iteration is  0.1077200001563987
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.11484000015639867
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.1107600001563987
====================
====================
iteration is  1
round is  1
accuracy is  0.11622000015639866
====================
________________________________
test distance is  tensor(4718.8794, device='cuda:2')
test similarity is  tensor(0.7074, device='cuda:2')
test acc is  0.1077200001563987
test loss is 2.6110758159471597
test entropy is  1.783239090991447
________________________________
cal_distance is  tensor(3383.4260, device='cuda:2')
cal_distance is  tensor(2426.3323, device='cuda:2')
cal_distance is  tensor(1740.4020, device='cuda:2')
________________________________
test distance is  tensor(1740.4020, device='cuda:2')
test similarity is  tensor(0.9385, device='cuda:2')
test acc is  0.16758000015639885
test loss is 2.1143180526735836
test entropy is  2.014659411004742
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.014659411004742
avg test loss is  2.1143180526735836
avg accuracy is  0.16758000015639885
compute_distance is  tensor(1740.4020, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.09478960219589645
avg test loss is  12.884861025359015
avg accuracy is  0.10568000015639871
compute_distance is  tensor(1951.2186, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1951.2186, device='cuda:2')
test similarity is  tensor(0.9569, device='cuda:2')
test acc is  0.10568000015639871
test loss is 12.884861025359015
test entropy is  0.09478960219589645
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 12.58% 

Test Accuracy: 12.62% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1849.6763, device='cuda:2')
compute similarity is  tensor(0.9967, device='cuda:2')
compute distance is  tensor(2019.5718, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(2092.1838, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(1952.3999, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
compute distance is  tensor(2087.7222, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(2185.9104, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(1994.8804, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(2114.8459, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(1987.2336, device='cuda:2')
compute similarity is  tensor(0.9970, device='cuda:2')
compute distance is  tensor(1930.4664, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(2140.0288, device='cuda:2')
compute similarity is  tensor(0.9961, device='cuda:2')
compute distance is  tensor(1845.2964, device='cuda:2')
compute similarity is  tensor(0.9969, device='cuda:2')
calculated distance threshold is  tensor(2526.5244, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.12194000015639865
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.12222000015639865
====================
====================
iteration is  0
round is  2
accuracy is  0.11552000015639866
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.11220000015639868
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.12644000015639864
====================
________________________________
test distance is  tensor(4726.4287, device='cuda:2')
test similarity is  tensor(0.7139, device='cuda:2')
test acc is  0.11220000015639868
test loss is 7.714924712925006
test entropy is  0.31991875949113263
________________________________
cal_distance is  tensor(3457.0576, device='cuda:2')
cal_distance is  tensor(2528.9814, device='cuda:2')
cal_distance is  tensor(1850.4365, device='cuda:2')
________________________________
test distance is  tensor(1850.4364, device='cuda:2')
test similarity is  tensor(0.9337, device='cuda:2')
test acc is  0.12044000015639865
test loss is 4.583195777500377
test entropy is  0.8141510748040036
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 24.69% 

Test Accuracy: 25.08% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(2081.8352, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(2113.1829, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(2150.7830, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(2089.6401, device='cuda:2')
compute similarity is  tensor(0.9963, device='cuda:2')
compute distance is  tensor(2467.7715, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(2103.7153, device='cuda:2')
compute similarity is  tensor(0.9965, device='cuda:2')
compute distance is  tensor(2126.1428, device='cuda:2')
compute similarity is  tensor(0.9964, device='cuda:2')
compute distance is  tensor(2041.0839, device='cuda:2')
compute similarity is  tensor(0.9966, device='cuda:2')
compute distance is  tensor(2280.3103, device='cuda:2')
compute similarity is  0
round is  1
accuracy is  0.4710200001564077
====================
====================
iteration is  0
round is  2
accuracy is  0.42982000015640726
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4804600001564078
====================
====================
iteration is  1
round is  1
accuracy is  0.4683000001564077
====================
________________________________
test distance is  tensor(1063.4612, device='cuda:2')
test similarity is  tensor(0.8538, device='cuda:2')
test acc is  0.42982000015640726
test loss is 1.7697252032092161
test entropy is  1.1291757568983776
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 51.72% 

Test Accuracy: 50.93% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1113.2004, device='cuda:2')
compute similarity is  tensor(0.9830, device='cuda:2')
compute distance is  tensor(1099.8627, device='cuda:2')
compute similarity is  tensor(0.9838, device='cuda:2')
compute distance is  tensor(1101.8027, device='cuda:2')
compute similarity is  tensor(0.9836, device='cuda:2')
compute distance is  tensor(1065.0963, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(1082.5459, device='cuda:2')
compute similarity is  tensor(0.9843, device='cuda:2')
compute distance is  tensor(1084.1151, device='cuda:2')
compute similarity is  tensor(0.9839, device='cuda:2')
compute distance is  tensor(1069.1396, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(1093.4432, device='cuda:2')
compute similarity is  tensor(0.9840, device='cuda:2')
compute distance is  tensor(1054.6034, device='cuda:2')
compute similarity is  tensor(0.9852, device='cuda:2')
compute distance is  tensor(1080.3077, device='cuda:2')
compute similarity is  tensor(0.9843, device='cuda:2')
compute distance is  tensor(1054.0305, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(1039.2715, device='cuda:2')
compute similarity is  tensor(0.9855, device='cuda:2')
calculated distance threshold is  tensor(1187.1294, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.48620000015640785
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4193000001564071
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.45062000015640746
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4457200001564074
====================
====================
iteration is  1
round is  1
accuracy is  0.4487600001564075
====================
________________________________
test distance is  tensor(1064.9380, device='cuda:2')
test similarity is  tensor(0.8557, device='cuda:2')
test acc is  0.4193000001564071
test loss is 1.88129772646043
test entropy is  1.0792798439560034
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 51.20% 

Test Accuracy: 50.06% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1146.8031, device='cuda:2')
compute similarity is  tensor(0.9838, device='cuda:2')
compute distance is  tensor(1090.4077, device='cuda:2')
compute similarity is  tensor(0.9856, device='cuda:2')
compute distance is  tensor(1095.7078, device='cuda:2')
compute similarity is  tensor(0.9853, device='cuda:2')
compute distance is  tensor(1126.1715, device='cuda:2')
compute similarity is  tensor(0.9848, device='cuda:2')
compute distance is  tensor(1100.4078, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(1117.0922, device='cuda:2')
compute similarity is  tensor(0.9849, device='cuda:2')
compute distance is  tensor(1074.8020, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(1100.3163, device='cuda:2')
compute similarity is  tensor(0.9854, device='cuda:2')
compute distance is  tensor(1116.9957, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(1114.3198, device='cuda:2')
compute similarity is  tensor(0.9848, device='cuda:2')
compute distance is  tensor(1064.0337, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(1112.2438, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
calculated distance threshold is  tensor(1229.5725, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4254200001564072
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.42424000015640717
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4457200001564075
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4766400001564078
====================
====================
iteration is  1
round is  1
accuracy is  0.4440000001564074
====================
________________________________
test distance is  tensor(1067.6241, device='cuda:2')
test similarity is  tensor(0.8649, device='cuda:2')
test acc is  0.42424000015640717
test loss is 1.9043207889627618
test entropy is  1.0378578943974526
 tensor(0.9960, device='cuda:2')
compute distance is  tensor(2208.8250, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(2454.6008, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(2267.4363, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
calculated distance threshold is  tensor(2894.4590, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.16844000015639896
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.18134000015639987
====================
====================
iteration is  0
round is  2
accuracy is  0.1531200001563986
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.1467400001563986
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.169400000156399
====================
________________________________
test distance is  tensor(4744.2339, device='cuda:2')
test similarity is  tensor(0.7147, device='cuda:2')
test acc is  0.1467400001563986
test loss is 2.506135862806569
test entropy is  1.6850926275448421
________________________________
cal_distance is  tensor(3706.8257, device='cuda:2')
cal_distance is  tensor(2896.5171, device='cuda:2')
cal_distance is  tensor(2263.5940, device='cuda:2')
________________________________
test distance is  tensor(2263.5940, device='cuda:2')
test similarity is  tensor(0.9062, device='cuda:2')
test acc is  0.22888000015640256
test loss is 2.0240238836354307
test entropy is  1.9034830183934068
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 26.98% 

Test Accuracy: 27.60% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(2319.7939, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(2353.8687, device='cuda:2')
compute similarity is  tensor(0.9959, device='cuda:2')
compute distance is  tensor(2321.2939, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(2387.1123, device='cuda:2')
compute similarity is  tensor(0.9958, device='cuda:2')
compute distance is  tensor(2665.7292, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(2371.8030, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(2205.6975, device='cuda:2')
compute similarity is  tensor(0.9962, device='cuda:2')
compute distance is  tensor(2364.3318, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(2513.4844, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(2528.6709, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(2639.3115, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(2394.9529, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
calculated distance threshold is  tensor(3125.7610, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.20418000015640128
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2324400001564027
====================
====================
iteration is  0
round is  2
accuracy is  0.2586000001564037
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.24580000015640327
====================
====================
iteration is  1
round is  1
accuracy is  0.24224000015640312
====================
________________________________
test distance is  tensor(4726.8877, device='cuda:2')
test similarity is  tensor(0.7212, device='cuda:2')
test acc is  0.20418000015640128
test loss is 2.126327132020155
test entropy is  1.8637364329889303
________________________________
cal_distance is  tensor(3844.8276, device='cuda:2')
cal_distance is  tensor(3127.5488, device='cuda:2')
cal_distance is  tensor(2544.2671, device='cuda:2')
________________________________
test distance is  tensor(2544.2671, device='cuda:2')
test similarity is  tensor(0.8885, device='cuda:2')
test acc is  0.25772000015640373
test loss is 1.9183270704105992
test entropy is  1.9240273968947819
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 28.89% 

Test Accuracy: 28.62% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(2355.3420, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(2479.3608, device='cuda:2')________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 49.79% 

Test Accuracy: 48.72% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1147.4086, device='cuda:2')
compute similarity is  tensor(0.9861, device='cuda:2')
compute distance is  tensor(1146.6179, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(1154.6276, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(1154.1483, device='cuda:2')
compute similarity is  tensor(0.9864, device='cuda:2')
compute distance is  tensor(1129.9070, device='cuda:2')
compute similarity is  tensor(0.9867, device='cuda:2')
compute distance is  tensor(1133.1133, device='cuda:2')
compute similarity is  tensor(0.9863, device='cuda:2')
compute distance is  tensor(1197.0363, device='cuda:2')
compute similarity is  tensor(0.9852, device='cuda:2')
compute distance is  tensor(1147.9254, device='cuda:2')
compute similarity is  tensor(0.9866, device='cuda:2')
compute distance is  tensor(1129.6954, device='cuda:2')
compute similarity is  tensor(0.9867, device='cuda:2')
compute distance is  tensor(1144.0162, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(1119.6719, device='cuda:2')
compute similarity is  tensor(0.9870, device='cuda:2')
compute distance is  tensor(1171.1097, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
calculated distance threshold is  tensor(1274.4006, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4748400001564077
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4672200001564077
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.43730000015640735
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.41122000015640703
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4459000001564074
====================
________________________________
test distance is  tensor(1065.9637, device='cuda:2')
test similarity is  tensor(0.8809, device='cuda:2')
test acc is  0.41122000015640703
test loss is 1.9250518400650805
test entropy is  1.0678946775243716
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 53.38% 

Test Accuracy: 52.03% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1106.2662, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(1080.7300, device='cuda:2')
compute similarity is  tensor(0.9857, device='cuda:2')
compute distance is  tensor(1094.2621, device='cuda:2')
compute similarity is  tensor(0.9855, device='cuda:2')
compute distance is  tensor(1174.2101, device='cuda:2')
compute similarity is  tensor(0.9833, device='cuda:2')
compute distance is  tensor(1129.8344, device='cuda:2')
compute similarity is  tensor(0.9846, device='cuda:2')
compute distance is  tensor(1119.7650, device='cuda:2')
compute similarity is  tensor(0.9851, device='cuda:2')
compute distance is  tensor(1131.6726, device='cuda:2')
compute similarity is  tensor(0.9847, device='cuda:2')
compute distance is  tensor(1117.1229, device='cuda:2')
compute similarity is  tensor(0.9851, device='cuda:2')
compute distance is  tensor(1166.1775, device='cuda:2')
compute similarity is  tensor(0.9835, device='cuda:2')
compute distance is  tensor(1107.0225, device='cuda:2')
compute similarity is  tensor(0.9852, device='cuda:2')
compute distance is  tensor(1091.5011, device='cuda:2')
compute similarity is  tensor(0.9856, device='cuda:2')
compute distance is  tensor(1136.8181, device='cuda:2')
compute similarity is  tensor(0.9842, device='cuda:2')
calculated distance threshold is  tensor(1267.6902, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.500220000156408
====================
====================
iteration is  0
round is  1
accuracy is  0.503140000156408
====================
====================
iteration is  0
round is  2
accuracy is  0.4919000001564079
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.25946000015640375
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3113000001564052
====================
====================
iteration is  1
round is  2
accuracy is  0.26946000015640403
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.2638200001564039
====================
________________________________
test distance is  tensor(2126.6677, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(2482.1145, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(2475.3123, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(2722.7344, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(2558.4380, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(2373.2505, device='cuda:2')
compute similarity is  tensor(0.9960, device='cuda:2')
compute distance is  tensor(2650.2302, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(2594.0515, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(2557.4497, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(2648.7434, device='cuda:2')
compute similarity is  tensor(0.9952, device='cuda:2')
compute distance is  tensor(2530.2952, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
calculated distance threshold is  tensor(3090.1267, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2599800001564038
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24782000015640337
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.264580000156404
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.22260000015640224
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.264740000156404
====================
________________________________
test distance is  tensor(4720.4624, device='cuda:2')
test similarity is  tensor(0.7233, device='cuda:2')
test acc is  0.22260000015640224
test loss is 2.073718618096598
test entropy is  1.924299040871203
________________________________
cal_distance is  tensor(3820.2783, device='cuda:2')
cal_distance is  tensor(3091.9500, device='cuda:2')
cal_distance is  tensor(2502.6685, device='cuda:2')
________________________________
test distance is  tensor(2502.6685, device='cuda:2')
test similarity is  tensor(0.8925, device='cuda:2')
test acc is  0.2853000001564046
test loss is 1.8682176876251044
test entropy is  1.9708307112574273
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 29.71% 

Test Accuracy: 30.01% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(2677.2371, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(2807.0059, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(2753.7859, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(2579.5107, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(2820.8145, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(2674.2241, device='cuda:2')
compute similarity is  tensor(0.9957, device='cuda:2')
compute distance is  tensor(2594.8276, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(2733.0425, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(2839.7683, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(2737.5381, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(2901.4109, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(2738.1152, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
calculated distance threshold is  tensor(3223.3110, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2519200001564034
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24542000015640314
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.27158000015640416
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2681600001564041
====================
====================
iteration is  1
round is  1
accuracy is  0.2528200001564035
====================
________________________________
test distance is  tensor(4717.6284, device='cuda:2')
test similarity is  tensor(0.7422, device='cuda:2')
test acc is  0.24542000015640314
test loss is 1.9292877938436426
test entropy is  2.045738929372919
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.045738929372919
avg test loss is  1.9292877938436426
avg accuracy is  0.24542000015640314
compute_distance is  tensor(4717.6284, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5047410870985607
avg test loss is  5.557443235536366
avg accuracy is  0.2503000001564034
compute_distance is  tensor(4866.5625, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(4866.5625, device='cuda:2')
test similarity is  tensor(0.8034, device='cuda:2')
test acc is  0.2503000001564034
test loss is 5.557443235536366
test entropy is  0.5047410870985607
________________________________
cal_distance is  tensor(3960.9172, device='cuda:2')
cal_distance is  tensor(3223.8684, device='cuda:2')
cal_distance is  tensor(2624.0305, device='cuda:2')
________________________________
test distance is  tensor(2624.0305, device='cuda:2')
test similarity is  tensor(0.9288, device='cuda:2')
test acc is  0.2787400001564043
test loss is 2.1454873868571522
test entropy is  1.3341092429197658
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 31.64% 

Test Accuracy: 31.78% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is 
test similarity is  tensor(0.6531, device='cuda:2')
test acc is  0.25946000015640375
test loss is 2.605043174665602
test entropy is  1.274184369979917
________________________________
cal_distance is  tensor(1642.0393, device='cuda:2')
cal_distance is  tensor(1267.8722, device='cuda:2')
cal_distance is  tensor(978.9890, device='cuda:2')
________________________________
test distance is  tensor(978.9890, device='cuda:2')
test similarity is  tensor(0.8824, device='cuda:2')
test acc is  0.4891600001564078
test loss is 1.56379411897391
test entropy is  1.0435718685159903
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 52.81% 

Test Accuracy: 52.03% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(1087.3329, device='cuda:2')
compute similarity is  tensor(0.9865, device='cuda:2')
compute distance is  tensor(1095.2334, device='cuda:2')
compute similarity is  tensor(0.9862, device='cuda:2')
compute distance is  tensor(1138.1802, device='cuda:2')
compute similarity is  tensor(0.9853, device='cuda:2')
compute distance is  tensor(1150.1558, device='cuda:2')
compute similarity is  tensor(0.9848, device='cuda:2')
compute distance is  tensor(1144.8230, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(1137.4514, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(1104.7117, device='cuda:2')
compute similarity is  tensor(0.9860, device='cuda:2')
compute distance is  tensor(1113.7367, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(1153.3214, device='cuda:2')
compute similarity is  tensor(0.9850, device='cuda:2')
compute distance is  tensor(1095.8483, device='cuda:2')
compute similarity is  tensor(0.9859, device='cuda:2')
compute distance is  tensor(1092.9292, device='cuda:2')
compute similarity is  tensor(0.9863, device='cuda:2')
compute distance is  tensor(1159.2848, device='cuda:2')
compute similarity is  tensor(0.9844, device='cuda:2')
calculated distance threshold is  tensor(1231.2367, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4806400001564078
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4708400001564077
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.47756000015640776
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.46892000015640767
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5167400001564081
====================
====================
iteration is  1
round is  2
accuracy is  0.4964600001564079
====================
________________________________
test distance is  tensor(1065.6538, device='cuda:2')
test similarity is  tensor(0.8710, device='cuda:2')
test acc is  0.46892000015640767
test loss is 1.6442594563259798
test entropy is  1.035525883021562
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 54.36% 

Test Accuracy: 52.92% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 54.36%
|----0th round Training Accuracy : 9.74%
|----1th round Training Accuracy : 9.74%
|----2th round Training Accuracy : 9.74%
|----3th round Training Accuracy : 9.74%
|----4th round Training Accuracy : 9.74%
|----5th round Training Accuracy : 9.74%
|----6th round Training Accuracy : 9.74%
|----7th round Training Accuracy : 14.35%
|----8th round Training Accuracy : 9.84%
|----9th round Training Accuracy : 17.12%
|----10th round Training Accuracy : 12.12%
|----11th round Training Accuracy : 23.46%
|----12th round Training Accuracy : 18.70%
|----13th round Training Accuracy : 24.65%
|----14th round Training Accuracy : 26.29%
|----15th round Training Accuracy : 27.66%
|----16th round Training Accuracy : 26.39%
|----17th round Training Accuracy : 30.62%
|----18th round Training Accuracy : 32.59%
|----19th round Training Accuracy : 33.21%
|----20th round Training Accuracy : 33.22%
|----21th round Training Accuracy : 34.50%
|----22th round Training Accuracy : 36.17%
|----23th round Training Accuracy : 36.67%
|----24th round Training Accuracy : 37.97%
|----25th round Training Accuracy : 39.31%
|----26th round Training Accuracy : 40.23%
|----27th round Training Accuracy : 41.10%
|----28th round Training Accuracy : 42.03%
|----29th round Training Accuracy : 43.03%
|----30th round Training Accuracy : 42.15%
|----31th round Training Accuracy : 43.62%
|----32th round Training Accuracy : 43.66%
|----33th round Training Accuracy : 45.58%
|----34th round Training Accuracy : 46.35%
|----35th round Training Accuracy : 48.03%
|----36th round Training Accuracy : 47.04%
|----37th round Training Accuracy : 47.79%
|----38th round Training Accuracy : 48.41%
|----39th round Training Accuracy : 50.47%
|----40th round Training Accuracy : 49.88%
|----41th round Training Accuracy : 51.25%
|----42th round Training Accuracy : 48.87%
|----43th round Training Accuracy : 52.01%
|----44th round Training Accuracy : 51.72%
|----45th round Training Accuracy : 51.20%
|----46th round Training Accuracy : 49.79%
|----47th round Training Accuracy : 53.38%
|----48th round Training Accuracy : 52.81%
|----49th round Training Accuracy : 54.36%
|----Final Test Accuracy: 52.92%
|----0th round Final Test Accuracy : 10.00%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 10.00%
|----3th round Final Test Accuracy : 10.00%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 10.00%
|----6th round Final Test Accuracy : 10.00%
|----7th round Final Test Accuracy : 14.34%
|----8th round Final Test Accuracy : 10.15%
|----9th round Final Test Accuracy : 17.09%
|----10th round Final Test Accuracy : 12.21%
|----11th round Final Test Accuracy : 23.89%
|----12th round Final Test Accuracy : 18.48%
|----13th round Final Test Accuracy : 24.90%
|----14th round Final Test Accuracy : 26.52%
|----15th round Final Test Accuracy : 27.20%
|----16th round Final Test Accuracy : 26.17%
|----17th round Final Test Accuracy : 31.19%
|----18th round Final Test Accuracy : 33.19%
|----19th round Final Test Accuracy : 33.95%
|----20th round Final Test Accuracy : 33.82%
|----21th round Final Test Accuracy : 35.13%
|----22th round Final Test Accuracy : 36.59%
|----23th round Final Test Accuracy : 37.14%
|----24th round Final Test Accuracy : 38.35%
|----25th round Final Test Accuracy : 40.11%
|----26th round Final Test Accuracy : 40.97%
|----27th round Final Test Accuracy : 41.47%
|----28th round Final Test Accuracy : 41.98%
|----29th round Final Test Accuracy : 42.49%
|----30th round Final Test Accuracy : 41.87%
|----31th round Final Test Accuracy : 42.97%
|----32th round Final Test Accuracy : 43.83%
|----33th round Final Test Accuracy : 45.84%
|----34th round Final Test Accuracy : 46.85%
|----35th round Final Test Accuracy : 47.75%
|----36th round Final Test Accuracy : 47.16%
|----37th round Final Test Accuracy : 47.25%
|----38th round Final Test Accuracy : 48.31%
|----39th round Final Test Accuracy : 49.60%
|----40th round Final Test Accuracy : 49.09%
|----41th round Final Test Accuracy : 49.65%
|----42th round Final Test Accuracy : 48.15%
|----43th round Final Test Accuracy : 50.96%
|----44th round Final Test Accuracy : 50.93%
|----45th round Final Test Accuracy : 50.06%
|----46th round Final Test Accuracy : 48.72%
|----47th round Final Test Accuracy : 52.03%
|----48th round Final Test Accuracy : 52.03%
|----49th round Final Test Accuracy : 52.92%

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 12954.6056
 33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(2684.7217, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(2904.5442, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(2754.4771, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(2820.8032, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(2937.2888, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(2704.2910, device='cuda:2')
compute similarity is  tensor(0.9956, device='cuda:2')
compute distance is  tensor(2764.3792, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(2869.0479, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(2937.9980, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(2801.3503, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(3077.6931, device='cuda:2')
compute similarity is  tensor(0.9941, device='cuda:2')
compute distance is  tensor(2789.7329, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
calculated distance threshold is  tensor(3470.6646, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.27770000015640434
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2957600001564048
====================
====================
iteration is  0
round is  2
accuracy is  0.2705800001564041
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.24610000015640326
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2746400001564042
====================
________________________________
test distance is  tensor(4715.3696, device='cuda:2')
test similarity is  tensor(0.7349, device='cuda:2')
test acc is  0.24610000015640326
test loss is 2.0188806189600466
test entropy is  1.7035188874625184
________________________________
cal_distance is  tensor(4046.1755, device='cuda:2')
cal_distance is  tensor(3472.0581, device='cuda:2')
cal_distance is  tensor(2979.5098, device='cuda:2')
________________________________
test distance is  tensor(2979.5098, device='cuda:2')
test similarity is  tensor(0.8641, device='cuda:2')
test acc is  0.29322000015640476
test loss is 1.8276443205526114
test entropy is  1.716033863899348
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 32.22% 

Test Accuracy: 33.09% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(2922.4385, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(3053.2925, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(3084.6570, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(3063.7107, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(3278.0403, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(2910.0317, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(2828.3506, device='cuda:2')
compute similarity is  tensor(0.9955, device='cuda:2')
compute distance is  tensor(3047.9397, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(3107.1091, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(2950.6331, device='cuda:2')
compute similarity is  tensor(0.9953, device='cuda:2')
compute distance is  tensor(3167.6311, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(2942.6638, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
calculated distance threshold is  tensor(3727.7300, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.29196000015640466
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.23398000015640283
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.2867400001564046
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2749200001564042
====================
====================
iteration is  1
round is  1
accuracy is  0.2914600001564048
====================
________________________________
test distance is  tensor(4726.2559, device='cuda:2')
test similarity is  tensor(0.7578, device='cuda:2')
test acc is  0.23398000015640283
test loss is 2.0049721805945686
test entropy is  1.8035981941710957
________________________________
cal_distance is  tensor(4197.9956, device='cuda:2')
cal_distance is  tensor(3728.8450, device='cuda:2')
cal_distance is  tensor(3312.1914, device='cuda:2')
________________________________
test distance is  tensor(3312.1914, device='cuda:2')
test similarity is  tensor(0.8564, device='cuda:2')
test acc is  0.2619200001564038
test loss is 1.8930318933313766
test entropy is  1.8078817330357972
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 32.38% 

Test Accuracy: 33.08% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(3193.1848, device='cuda:2')
compute similarity is  tensor(0.9941, device='cuda:2')
compute distance is  tensor(3180.1948, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(3097.8086, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(2991.1353, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(3097.5798, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(2968.5037, device='cuda:2')
compute similarity is  tensor(0.9954, device='cuda:2')
compute distance is  tensor(2937.2537, device='cuda:2')
compute similarity is  tensor(0.9951, device='cuda:2')
compute distance is  tensor(3092.0598, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(3213.8000, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(3150.8232, device='cuda:2')
compute similarity is  tensor(0.9950, device='cuda:2')
compute distance is  tensor(3365.5745, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(3010.2195, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
calculated distance threshold is  tensor(3793.8953, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.31034000015640517
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3064800001564051
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.30780000015640513
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3147800001564053
====================
====================
iteration is  1
round is  1
accuracy is  0.31362000015640523
====================
________________________________
test distance is  tensor(4736.2539, device='cuda:2')
test similarity is  tensor(0.7528, device='cuda:2')
test acc is  0.3064800001564051
test loss is 1.7820466642489519
test entropy is  1.7864234328574842
________________________________
cal_distance is  tensor(4239.5229, device='cuda:2')
cal_distance is  tensor(3794.9456, device='cuda:2')
cal_distance is  tensor(3397.0474, device='cuda:2')
________________________________
test distance is  tensor(3397.0476, device='cuda:2')
test similarity is  tensor(0.8473, device='cuda:2')
test acc is  0.31740000015640535
test loss is 1.7510797635978446
test entropy is  1.784122056973255
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 33.77% 

Test Accuracy: 33.87% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(3371.6802, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(3374.8376, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(3506.9746, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(3250.6609, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(3252.0415, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(3227.6426, device='cuda:2')
compute similarity is  tensor(0.9947, device='cuda:2')
compute distance is  tensor(3063.0798, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(3191.3213, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(3301.0579, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(3300.1584, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(3377.6902, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(3150.1221, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
calculated distance threshold is  tensor(3950.8694, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3114400001564052
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2804800001564044
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3084400001564052
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3120400001564053
====================
====================
iteration is  1
round is  1
accuracy is  0.3063200001564051
====================
________________________________
test distance is  tensor(4732.1479, device='cuda:2')
test similarity is  tensor(0.7592, device='cuda:2')
test acc is  0.2804800001564044
test loss is 1.8650258814587313
test entropy is  1.8311306968369447
________________________________
cal_distance is  tensor(4324.3545, device='cuda:2')
cal_distance is  tensor(3951.7410, device='cuda:2')
cal_distance is  tensor(3611.2737, device='cuda:2')
________________________________
test distance is  tensor(3611.2739, device='cuda:2')
test similarity is  tensor(0.8370, device='cuda:2')
test acc is  0.2977800001564049
test loss is 1.818327874021457
test entropy is  1.8211985021600943
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 34.35% 

Test Accuracy: 34.30% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(3430.6399, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(3475.2922, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(3470.4060, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(3465.5935, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(3503.2341, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(3378.1982, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(3432.4951, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(3569.0352, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(3515.5044, device='cuda:2')
compute similarity is  tensor(0.9941, device='cuda:2')
compute distance is  tensor(3310.1118, device='cuda:2')
compute similarity is  tensor(0.9949, device='cuda:2')
compute distance is  tensor(3597.2236, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(3321.5103, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
calculated distance threshold is  tensor(3884.3354, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.30440000015640506
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3218000001564055
====================
====================
iteration is  0
round is  2
accuracy is  0.30430000015640507
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3077000001564051
====================
====================
iteration is  1
round is  1
accuracy is  0.31352000015640524
====================
________________________________
test distance is  tensor(4725.2539, device='cuda:2')
test similarity is  tensor(0.7753, device='cuda:2')
test acc is  0.30430000015640507
test loss is 1.7888062111556988
test entropy is  1.8402715654629271
________________________________
cal_distance is  tensor(4284.7046, device='cuda:2')
cal_distance is  tensor(3885.2747, device='cuda:2')
cal_distance is  tensor(3523.1267, device='cuda:2')
________________________________
test distance is  tensor(3523.1267, device='cuda:2')
test similarity is  tensor(0.8549, device='cuda:2')
test acc is  0.3272200001564055
test loss is 1.7403792466044121
test entropy is  1.8217392923581937
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 36.55% 

Test Accuracy: 36.14% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(3753.5615, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(3641.2949, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(3683.8184, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(3726.7939, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(3619.6885, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(3767.2693, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(3734.4976, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(3707.7332, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(3741.4131, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(3555.1074, device='cuda:2')
compute similarity is  tensor(0.9948, device='cuda:2')
compute distance is  tensor(3933.2146, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(3683.1555, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
calculated distance threshold is  tensor(4311.3218, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3104200001564052
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3356800001564058
====================
====================
iteration is  0
round is  2
accuracy is  0.33202000015640565
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.32606000015640546
====================
====================
iteration is  1
round is  1
accuracy is  0.3144800001564053
====================
________________________________
test distance is  tensor(4712.1133, device='cuda:2')
test similarity is  tensor(0.8000, device='cuda:2')
test acc is  0.3104200001564052
test loss is 1.7795531597283796
test entropy is  1.790469353308763
________________________________
cal_distance is  tensor(4507.4946, device='cuda:2')
cal_distance is  tensor(4311.7710, device='cuda:2')
cal_distance is  tensor(4124.5562, device='cuda:2')
________________________________
test distance is  tensor(4124.5562, device='cuda:2')
test similarity is  tensor(0.8359, device='cuda:2')
test acc is  0.32176000015640543
test loss is 1.7515606820735785
test entropy is  1.7851770575089223
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 37.46% 

Test Accuracy: 36.85% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(3767.3792, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(3777.2351, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(3878.7705, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(3754.4370, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(3760.8572, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(3687.3008, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(3613.3235, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(3744.0325, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(3946.0476, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(3524.9761, device='cuda:2')
compute similarity is  tensor(0.9945, device='cuda:2')
compute distance is  tensor(3659.5005, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(3609.4341, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
calculated distance threshold is  tensor(4367.1191, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.33126000015640567
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.31940000015640546
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.35222000015640603
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3427600001564059
====================
====================
iteration is  1
round is  1
accuracy is  0.34544000015640586
====================
________________________________
test distance is  tensor(4713.0913, device='cuda:2')
test similarity is  tensor(0.7793, device='cuda:2')
test acc is  0.31940000015640546
test loss is 1.783770043526769
test entropy is  1.8356500348776503
________________________________
cal_distance is  tensor(4537.0059, device='cuda:2')
cal_distance is  tensor(4367.5063, device='cuda:2')
cal_distance is  tensor(4204.3472, device='cuda:2')
________________________________
test distance is  tensor(4204.3472, device='cuda:2')
test similarity is  tensor(0.8126, device='cuda:2')
test acc is  0.33398000015640567
test loss is 1.750667863794605
test entropy is  1.8218064526157915
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 37.60% 

Test Accuracy: 38.18% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(3843.6045, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(4040.2634, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(4095.2734, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(3987.9646, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(4023.7002, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(3819.9912, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
compute distance is  tensor(3879.5649, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(3939.4370, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(4059.8257, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(3617.3479, device='cuda:2')
compute similarity is  tensor(0.9946, device='cuda:2')
compute distance is  tensor(4101.6768, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(3784.5381, device='cuda:2')
compute similarity is  tensor(0.9943, device='cuda:2')
calculated distance threshold is  tensor(4586.0059, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3249400001564055
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.31380000015640525
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3542800001564061
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3587400001564061
====================
====================
iteration is  1
round is  1
accuracy is  0.33270000015640566
====================
________________________________
test distance is  tensor(4723.6836, device='cuda:2')
test similarity is  tensor(0.7985, device='cuda:2')
test acc is  0.31380000015640525
test loss is 1.8459461784118887
test entropy is  1.8313917106069872
________________________________
cal_distance is  tensor(4654.4136, device='cuda:2')
cal_distance is  tensor(4586.1602, device='cuda:2')
cal_distance is  tensor(4518.9087, device='cuda:2')
________________________________
test distance is  tensor(4518.9082, device='cuda:2')
test similarity is  tensor(0.8110, device='cuda:2')
test acc is  0.3195000001564054
test loss is 1.8307653924693232
test entropy is  1.8274506367076084
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 38.79% 

Test Accuracy: 38.98% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(4301.9839, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(4226.8716, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(4406.3887, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(4288.9224, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(4219.1484, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(4196.4785, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(4179.9551, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(4162.9883, device='cuda:2')
compute similarity is  tensor(0.9938, device='cuda:2')
compute distance is  tensor(4224.8887, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(4021.4839, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(4314.5552, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(4113.5122, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
calculated distance threshold is  tensor(4791.2935, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.36386000015640624
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3580800001564061
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.35064000015640595
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3451800001564059
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3433600001564059
====================
succ_min + 1
________________________________
test distance is  tensor(4738.0098, device='cuda:2')
test similarity is  tensor(0.8123, device='cuda:2')
test acc is  0.3433600001564059
test loss is 1.7910337405436485
test entropy is  1.7185881765907074
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 39.11% 

Test Accuracy: 38.62% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(4212.3691, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(4508.4639, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(4576.8975, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(4548.0615, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(4468.0840, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(4344.7983, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(4230.4185, device='cuda:2')
compute similarity is  tensor(0.9942, device='cuda:2')
compute distance is  tensor(4504.7939, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(4435.9399, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(4176.5552, device='cuda:2')
compute similarity is  tensor(0.9944, device='cuda:2')
compute distance is  tensor(4534.7490, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(4395.6411, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
calculated distance threshold is  tensor(4977.2397, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.34984000015640593
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3602000001564062
====================
====================
iteration is  0
round is  2
accuracy is  0.3604800001564062
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.31684000015640534
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.36530000015640623
====================
________________________________
test distance is  tensor(4730.3379, device='cuda:2')
test similarity is  tensor(0.8260, device='cuda:2')
test acc is  0.31684000015640534
test loss is 1.9415521405237106
test entropy is  1.7032637762291658
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 39.35% 

Test Accuracy: 38.64% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(4331.6021, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(4797.2925, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(4598.1670, device='cuda:2')
compute similarity is  tensor(0.9930, device='cuda:2')
compute distance is  tensor(4674.6270, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(4689.3872, device='cuda:2')
compute similarity is  tensor(0.9930, device='cuda:2')
compute distance is  tensor(4423.4385, device='cuda:2')
compute similarity is  tensor(0.9934, device='cuda:2')
compute distance is  tensor(4374.6450, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(4485.1084, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(4718.6870, device='cuda:2')
compute similarity is  tensor(0.9930, device='cuda:2')
compute distance is  tensor(4268.9902, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(4727.8306, device='cuda:2')
compute similarity is  tensor(0.9924, device='cuda:2')
compute distance is  tensor(4632.6270, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
calculated distance threshold is  tensor(5325.5947, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3593000001564061
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34622000015640586
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.34990000015640593
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3569400001564061
====================
====================
iteration is  1
round is  1
accuracy is  0.29820000015640485
====================
succ_min + 1
________________________________
test distance is  tensor(4732.4448, device='cuda:2')
test similarity is  tensor(0.8197, device='cuda:2')
test acc is  0.29820000015640485
test loss is 1.9693078089248188
test entropy is  1.693693879467752
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 37.96% 

Test Accuracy: 37.61% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(4777.5347, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(5000.6484, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(5140.9282, device='cuda:2')
compute similarity is  tensor(0.9928, device='cuda:2')
compute distance is  tensor(4869.5972, device='cuda:2')
compute similarity is  tensor(0.9937, device='cuda:2')
compute distance is  tensor(4734.2100, device='cuda:2')
compute similarity is  tensor(0.9939, device='cuda:2')
compute distance is  tensor(4647.0317, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(4693.5503, device='cuda:2')
compute similarity is  tensor(0.9940, device='cuda:2')
compute distance is  tensor(4889.0171, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(4945.9497, device='cuda:2')
compute similarity is  tensor(0.9935, device='cuda:2')
compute distance is  tensor(4716.3198, device='cuda:2')
compute similarity is  tensor(0.9936, device='cuda:2')
compute distance is  tensor(4909.6284, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(5071.2764, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
calculated distance threshold is  tensor(5634.8247, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2946800001564048
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3192200001564054
====================
====================
iteration is  0
round is  2
accuracy is  0.3170000001564053
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.34066000015640574
====================
====================
iteration is  1
round is  1
accuracy is  0.31892000015640537
====================
________________________________
test distance is  tensor(4729.9727, device='cuda:2')
test similarity is  tensor(0.8455, device='cuda:2')
test acc is  0.2946800001564048
test loss is 2.0971967988002027
test entropy is  1.6326070877597154
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 41.19% 

Test Accuracy: 40.33% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(4743.6533, device='cuda:2')
compute similarity is  tensor(0.9930, device='cuda:2')
compute distance is  tensor(5052.7817, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(5056.9575, device='cuda:2')
compute similarity is  tensor(0.9923, device='cuda:2')
compute distance is  tensor(5167.6333, device='cuda:2')
compute similarity is  tensor(0.9923, device='cuda:2')
compute distance is  tensor(5164.2959, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(4923.5020, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(4923.0332, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(4959.1060, device='cuda:2')
compute similarity is  tensor(0.9925, device='cuda:2')
compute distance is  tensor(5229.5713, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(4787.4009, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(4865.5474, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(5190.4087, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
calculated distance threshold is  tensor(5715.4893, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3619800001564062
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.35086000015640595
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3924600001564067
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3182000001564053
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3211200001564054
====================
________________________________
test distance is  tensor(4730.3999, device='cuda:2')
test similarity is  tensor(0.8310, device='cuda:2')
test acc is  0.3182000001564053
test loss is 1.8834710570857347
test entropy is  1.6057736526059982
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 39.36% 

Test Accuracy: 39.99% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(5187.0703, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(5315.7485, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(5478.1230, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(5411.8242, device='cuda:2')
compute similarity is  tensor(0.9929, device='cuda:2')
compute distance is  tensor(5293.0532, device='cuda:2')
compute similarity is  tensor(0.9932, device='cuda:2')
compute distance is  tensor(5267.1338, device='cuda:2')
compute similarity is  tensor(0.9928, device='cuda:2')
compute distance is  tensor(5127.2544, device='cuda:2')
compute similarity is  tensor(0.9930, device='cuda:2')
compute distance is  tensor(5443.5684, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(5473.1309, device='cuda:2')
compute similarity is  tensor(0.9927, device='cuda:2')
compute distance is  tensor(5099.2842, device='cuda:2')
compute similarity is  tensor(0.9933, device='cuda:2')
compute distance is  tensor(5189.2646, device='cuda:2')
compute similarity is  tensor(0.9931, device='cuda:2')
compute distance is  tensor(5472.7808, device='cuda:2')
compute similarity is  tensor(0.9924, device='cuda:2')
calculated distance threshold is  tensor(5856.9619, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.34796000015640594
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.32406000015640546
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3847800001564065
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3324200001564056
====================
====================
iteration is  1
round is  1
accuracy is  0.34460000015640585
====================
________________________________
test distance is  tensor(4728.5898, device='cuda:2')
test similarity is  tensor(0.8537, device='cuda:2')
test acc is  0.32406000015640546
test loss is 1.8779861212081617
test entropy is  1.5872131454975098
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 42.48% 

Test Accuracy: 41.67% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(5155.2144, device='cuda:2')
compute similarity is  tensor(0.9928, device='cuda:2')
compute distance is  tensor(5656.9287, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(5835.1807, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(5785.7622, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(5481.3867, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(5267.0078, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(5279.4771, device='cuda:2')
compute similarity is  tensor(0.9923, device='cuda:2')
compute distance is  tensor(5373.7651, device='cuda:2')
compute similarity is  tensor(0.9925, device='cuda:2')
compute distance is  tensor(5620.6841, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(5464.8735, device='cuda:2')
compute similarity is  tensor(0.9920, device='cuda:2')
compute distance is  tensor(5659.6582, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(5488.9033, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
calculated distance threshold is  tensor(6515.1470, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3798000001564065
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3726800001564063
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.36764000015640624
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.36364000015640624
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.350260000156406
====================
succ_min + 1
________________________________
test distance is  tensor(4725.0459, device='cuda:2')
test similarity is  tensor(0.8456, device='cuda:2')
test acc is  0.350260000156406
test loss is 1.8546890925873272
test entropy is  1.6111974992105722
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 40.56% 

Test Accuracy: 40.36% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(5703.4209, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(5808.2866, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(5957.0127, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(5771.2549, device='cuda:2')
compute similarity is  tensor(0.9922, device='cuda:2')
compute distance is  tensor(5780.9780, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(5580.9458, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(5691.3530, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(5731.6362, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(5757.8584, device='cuda:2')
compute similarity is  tensor(0.9921, device='cuda:2')
compute distance is  tensor(5513.2461, device='cuda:2')
compute similarity is  tensor(0.9926, device='cuda:2')
compute distance is  tensor(5727.3027, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(6040.3276, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
calculated distance threshold is  tensor(6567.4092, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3599200001564062
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.35922000015640615
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.39766000015640685
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3685000001564063
====================
====================
iteration is  1
round is  1
accuracy is  0.35756000015640615
====================
succ_min + 1
________________________________
test distance is  tensor(4722.0894, device='cuda:2')
test similarity is  tensor(0.8564, device='cuda:2')
test acc is  0.35756000015640615
test loss is 1.835015829719241
test entropy is  1.5677203494874412
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 43.58% 

Test Accuracy: 43.80% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(5986.3091, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(6075.7422, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(5989.8213, device='cuda:2')
compute similarity is  tensor(0.9919, device='cuda:2')
compute distance is  tensor(6234.0093, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(6165.5908, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(6005.9053, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(6308.0864, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(6171.8032, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(6169.5410, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(6031.8657, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(5808.7603, device='cuda:2')
compute similarity is  tensor(0.9920, device='cuda:2')
compute distance is  tensor(6315.8315, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
calculated distance threshold is  tensor(6822.9028, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3738000001564064
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.39608000015640676
====================
====================
iteration is  0
round is  2
accuracy is  0.4077600001564069
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.40816000015640697
====================
====================
iteration is  1
round is  1
accuracy is  0.3975800001564068
====================
________________________________
test distance is  tensor(4706.4141, device='cuda:2')
test similarity is  tensor(0.8650, device='cuda:2')
test acc is  0.3738000001564064
test loss is 1.7802864953380106
test entropy is  1.4464738122032732
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 44.26% 

Test Accuracy: 43.87% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(5925.0732, device='cuda:2')
compute similarity is  tensor(0.9916, device='cuda:2')
compute distance is  tensor(6251.4199, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(6229.0654, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(6289.5977, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(6503.4062, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(6241.3462, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(6154.4922, device='cuda:2')
compute similarity is  tensor(0.9911, device='cuda:2')
compute distance is  tensor(6051.3135, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(6292.6543, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(6095.4404, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(6150.9170, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(6209.3140, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
calculated distance threshold is  tensor(7081.7393, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.413100000156407
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.39630000015640676
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.41292000015640706
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3998000001564069
====================
====================
iteration is  1
round is  1
accuracy is  0.3687200001564063
====================
succ_min + 1
________________________________
test distance is  tensor(4728.5049, device='cuda:2')
test similarity is  tensor(0.8626, device='cuda:2')
test acc is  0.3687200001564063
test loss is 1.8075570572367714
test entropy is  1.4631188371602226
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 45.74% 

Test Accuracy: 45.22% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(6335.4663, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(6483.0317, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(6409.4175, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(6698.5527, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(6801.8379, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(6355.5991, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(6822.2456, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(6387.0146, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(6631.1143, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(6299.0312, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(6279.0688, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(6401.1851, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
calculated distance threshold is  tensor(7365.4224, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4215000001564071
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4165600001564071
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.41652000015640706
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.45670000015640755
====================
====================
iteration is  1
round is  1
accuracy is  0.4405800001564074
====================
________________________________
test distance is  tensor(4730.4214, device='cuda:2')
test similarity is  tensor(0.8588, device='cuda:2')
test acc is  0.41652000015640706
test loss is 1.6135949289707272
test entropy is  1.400655117486139
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 44.89% 

Test Accuracy: 45.32% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(6757.2554, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(6723.9438, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(6833.5786, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(6473.3281, device='cuda:2')
compute similarity is  tensor(0.9917, device='cuda:2')
compute distance is  tensor(7001.0874, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(6519.5137, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(6528.5522, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(6760.3867, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(6767.2246, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(6587.2515, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(6465.0898, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(6876.4282, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
calculated distance threshold is  tensor(7537.0850, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4262200001564072
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.40378000015640697
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.39506000015640674
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4243200001564072
====================
====================
iteration is  1
round is  1
accuracy is  0.4259600001564071
====================
________________________________
test distance is  tensor(4720.2153, device='cuda:2')
test similarity is  tensor(0.8752, device='cuda:2')
test acc is  0.39506000015640674
test loss is 1.7324347441153758
test entropy is  1.4158373863800713
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 47.05% 

Test Accuracy: 46.77% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(6980.9990, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(6945.5249, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(6944.0972, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(7258.3945, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(7117.5327, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(6854.5015, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(7056.3325, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(6882.7900, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(6958.9370, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(7148.1260, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(6921.8062, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(7058.7031, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
calculated distance threshold is  tensor(7662.2876, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4406600001564074
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4245000001564072
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.45994000015640757
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4256600001564072
====================
====================
iteration is  1
round is  1
accuracy is  0.4526800001564075
====================
________________________________
test distance is  tensor(4733.8223, device='cuda:2')
test similarity is  tensor(0.8794, device='cuda:2')
test acc is  0.4245000001564072
test loss is 1.6725931585292377
test entropy is  1.2959102939461808
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 48.14% 

Test Accuracy: 47.66% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(7262.3833, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(7413.3652, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(7409.0562, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(7398.3765, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(7416.1250, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(7145.7759, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(7493.3032, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(7485.4805, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(7336.7622, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(7056.1519, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(7356.7510, device='cuda:2')
compute similarity is  tensor(0.9900, device='cuda:2')
compute distance is  tensor(7431.4019, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
calculated distance threshold is  tensor(7930.4546, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4246800001564071
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3991200001564068
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4406000001564074
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.45856000015640763
====================
====================
iteration is  1
round is  1
accuracy is  0.43436000015640736
====================
________________________________
test distance is  tensor(4717.7568, device='cuda:2')
test similarity is  tensor(0.8847, device='cuda:2')
test acc is  0.3991200001564068
test loss is 1.7967598078500888
test entropy is  1.2640526024886714
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 48.05% 

Test Accuracy: 47.93% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(7225.6943, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(7328.7471, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(7440.3364, device='cuda:2')
compute similarity is  tensor(0.9888, device='cuda:2')
compute distance is  tensor(7537.5830, device='cuda:2')
compute similarity is  tensor(0.9884, device='cuda:2')
compute distance is  tensor(7403.7734, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(7162.2251, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(7476.6689, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(7376.5361, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(7234.2993, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(7122.4321, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(7450.3618, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(7553.9751, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
calculated distance threshold is  tensor(7985.5181, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4711400001564077
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4786400001564078
====================
====================
iteration is  0
round is  2
accuracy is  0.4819000001564078
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.47954000015640774
====================
====================
iteration is  1
round is  1
accuracy is  0.4706000001564077
====================
succ_min + 1
________________________________
test distance is  tensor(4742.1421, device='cuda:2')
test similarity is  tensor(0.8764, device='cuda:2')
test acc is  0.4706000001564077
test loss is 1.5481473067227531
test entropy is  1.1323995026938445
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 49.02% 

Test Accuracy: 48.39% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(7453.1968, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(7819.5396, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(7596.8652, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(7654.3462, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(7672.7002, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(7231.8887, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(7450.8457, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(7730.6265, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(7601.3750, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(7463.7515, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(7441.9146, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(7641.6182, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
calculated distance threshold is  tensor(8407.1904, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4897800001564078
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4457000001564075
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4428400001564074
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4707200001564077
====================
====================
iteration is  1
round is  1
accuracy is  0.4622200001564076
====================
________________________________
test distance is  tensor(4719.0186, device='cuda:2')
test similarity is  tensor(0.8905, device='cuda:2')
test acc is  0.4428400001564074
test loss is 1.642806171608703
test entropy is  1.160571874102668
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 50.38% 

Test Accuracy: 49.64% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(7735.5107, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(7757.7695, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(7824.5991, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(7956.7827, device='cuda:2')
compute similarity is  tensor(0.9885, device='cuda:2')
compute distance is  tensor(7756.8315, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(7520.8794, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(7998.9404, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(7560.9692, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(7762.3999, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(7710.4507, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
compute distance is  tensor(7609.7026, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
compute distance is  tensor(7816.2295, device='cuda:2')
compute similarity is  tensor(0.9882, device='cuda:2')
calculated distance threshold is  tensor(8477.0020, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4639800001564076
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4644200001564076
====================
====================
iteration is  0
round is  2
accuracy is  0.45524000015640753
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.48910000015640787
====================
====================
iteration is  1
round is  1
accuracy is  0.47092000015640767
====================
________________________________
test distance is  tensor(4727.4741, device='cuda:2')
test similarity is  tensor(0.8835, device='cuda:2')
test acc is  0.45524000015640753
test loss is 1.6241129147427162
test entropy is  1.1699351695797326
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 48.82% 

Test Accuracy: 48.51% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(8047.6279, device='cuda:2')
compute similarity is  tensor(0.9896, device='cuda:2')
compute distance is  tensor(7813.4814, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(7831.1650, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(8043.5044, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(8084.7856, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(8014.4683, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(8584.5176, device='cuda:2')
compute similarity is  tensor(0.9879, device='cuda:2')
compute distance is  tensor(8006.8931, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(8213.3369, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(7925.4966, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(7880.2617, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(7920.9878, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
calculated distance threshold is  tensor(9355.5537, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4636400001564076
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.45298000015640755
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4623800001564076
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.42758000015640724
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.45388000015640756
====================
________________________________
test distance is  tensor(4740.6841, device='cuda:2')
test similarity is  tensor(0.8947, device='cuda:2')
test acc is  0.42758000015640724
test loss is 1.7884659123847553
test entropy is  1.115854590597665
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 49.90% 

Test Accuracy: 49.16% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(8010.5083, device='cuda:2')
compute similarity is  tensor(0.9895, device='cuda:2')
compute distance is  tensor(8137.2554, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(7751.9482, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(8012.6006, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(8132.5229, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(7978.8491, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(8112.9292, device='cuda:2')
compute similarity is  tensor(0.9890, device='cuda:2')
compute distance is  tensor(8364.7422, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
compute distance is  tensor(7858.0244, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(8040.3872, device='cuda:2')
compute similarity is  tensor(0.9896, device='cuda:2')
compute distance is  tensor(7735.8472, device='cuda:2')
compute similarity is  tensor(0.9901, device='cuda:2')
compute distance is  tensor(8273.1709, device='cuda:2')
compute similarity is  tensor(0.9886, device='cuda:2')
calculated distance threshold is  tensor(8993.6367, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4697200001564077
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4779000001564077
====================
====================
iteration is  0
round is  2
accuracy is  0.45818000015640764
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4905200001564079
====================
====================
iteration is  1
round is  1
accuracy is  0.47650000015640775
====================
________________________________
test distance is  tensor(4723.0146, device='cuda:2')
test similarity is  tensor(0.8940, device='cuda:2')
test acc is  0.45818000015640764
test loss is 1.6730647100816907
test entropy is  1.0706797553145366
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 51.73% 

Test Accuracy: 50.97% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(8292.3008, device='cuda:2')
compute similarity is  tensor(0.9881, device='cuda:2')
compute distance is  tensor(8145.2803, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(8088.3462, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(7970.4902, device='cuda:2')
compute similarity is  tensor(0.9894, device='cuda:2')
compute distance is  tensor(8542.6562, device='cuda:2')
compute similarity is  tensor(0.9883, device='cuda:2')
compute distance is  tensor(8169.7407, device='cuda:2')
compute similarity is  tensor(0.9887, device='cuda:2')
compute distance is  tensor(8329.6182, device='cuda:2')
compute similarity is  tensor(0.9892, device='cuda:2')
compute distance is  tensor(8241.9248, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(8202.4062, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
compute distance is  tensor(8007.5508, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(8108.0171, device='cuda:2')
compute similarity is  tensor(0.9893, device='cuda:2')
compute distance is  tensor(8118.4028, device='cuda:2')
compute similarity is  tensor(0.9891, device='cuda:2')
calculated distance threshold is  tensor(9114.8223, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.506700000156408
====================
====================
iteration is  0
round is  1
accuracy is  0.4706800001564077
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5016000001564079
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.36992000015640636
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.39566000015640673
====================
====================
iteration is  1
round is  2
accuracy is  0.3380000001564058
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.3672800001564063
====================
________________________________
test distance is  tensor(9461.1680, device='cuda:2')
test similarity is  tensor(0.7067, device='cuda:2')
test acc is  0.3380000001564058
test loss is 2.138413773625708
test entropy is  1.2604314396753336
________________________________
cal_distance is  tensor(9286.4775, device='cuda:2')
cal_distance is  tensor(9115.0156, device='cuda:2')
cal_distance is  tensor(8946.7197, device='cuda:2')
________________________________
test distance is  tensor(8946.7207, device='cuda:2')
test similarity is  tensor(0.7262, device='cuda:2')
test acc is  0.3533800001564061
test loss is 2.0702370065252493
test entropy is  1.2409703690377647
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 49.19% 

Test Accuracy: 48.66% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(8647.5322, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(8218.6816, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(8368.6992, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(8502.9609, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(8594.6455, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(8480.5312, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(8543.0869, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(8635.3291, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(8654.5020, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(8696.0703, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(8459.5830, device='cuda:2')
compute similarity is  tensor(0.9906, device='cuda:2')
compute distance is  tensor(8578.6504, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
calculated distance threshold is  tensor(9173.4590, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.45536000015640754
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4736400001564078
====================
====================
iteration is  0
round is  2
accuracy is  0.4645800001564076
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4666000001564077
====================
====================
iteration is  1
round is  1
accuracy is  0.46500000015640763
====================
________________________________
test distance is  tensor(4722.6704, device='cuda:2')
test similarity is  tensor(0.9137, device='cuda:2')
test acc is  0.45536000015640754
test loss is 1.6799213704855547
test entropy is  1.0591901158890151
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 51.24% 

Test Accuracy: 51.06% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(8904.4414, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(8175.0376, device='cuda:2')
compute similarity is  tensor(0.9918, device='cuda:2')
compute distance is  tensor(8518.5605, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(8676.7441, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(8665.7656, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(8838.9990, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(8819.2764, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(8602.4043, device='cuda:2')
compute similarity is  tensor(0.9916, device='cuda:2')
compute distance is  tensor(8606.4932, device='cuda:2')
compute similarity is  tensor(0.9916, device='cuda:2')
compute distance is  tensor(9196.9805, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(8699.7441, device='cuda:2')
compute similarity is  tensor(0.9910, device='cuda:2')
compute distance is  tensor(8757.1943, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
calculated distance threshold is  tensor(10218.9238, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.48792000015640785
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4643000001564076
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.48710000015640786
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.512800000156408
====================
====================
iteration is  1
round is  1
accuracy is  0.4959000001564079
====================
====================
iteration is  1
round is  2
accuracy is  0.4908000001564079
====================
________________________________
test distance is  tensor(4735.6709, device='cuda:2')
test similarity is  tensor(0.9200, device='cuda:2')
test acc is  0.4643000001564076
test loss is 1.6632232329119807
test entropy is  1.0233955404642598
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 53.71% 

Test Accuracy: 52.66% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(8581.3848, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(8199.5918, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
compute distance is  tensor(8413.0371, device='cuda:2')
compute similarity is  tensor(0.9902, device='cuda:2')
compute distance is  tensor(8580.4219, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(8606.4160, device='cuda:2')
compute similarity is  tensor(0.9897, device='cuda:2')
compute distance is  tensor(8574.9326, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(8785.1689, device='cuda:2')
compute similarity is  tensor(0.9898, device='cuda:2')
compute distance is  tensor(8363.9209, device='cuda:2')
compute similarity is  tensor(0.9905, device='cuda:2')
compute distance is  tensor(8364.2148, device='cuda:2')
compute similarity is  tensor(0.9904, device='cuda:2')
compute distance is  tensor(8388.9824, device='cuda:2')
compute similarity is  tensor(0.9903, device='cuda:2')
compute distance is  tensor(8505.2695, device='cuda:2')
compute similarity is  tensor(0.9899, device='cuda:2')
compute distance is  tensor(8788.1641, device='cuda:2')
compute similarity is  tensor(0.9889, device='cuda:2')
calculated distance threshold is  tensor(9376.7363, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5104200001564081
====================
====================
iteration is  0
round is  1
accuracy is  0.5327000001564082
====================
====================
iteration is  0
round is  2
accuracy is  0.5120600001564081
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3647000001564063
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.410620000156407
====================
====================
iteration is  1
round is  2
accuracy is  0.3851800001564066
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.4012400001564068
====================
====================
iteration is  2
round is  1
accuracy is  0.37718000015640646
====================
________________________________
test distance is  tensor(9444.6094, device='cuda:2')
test similarity is  tensor(0.7327, device='cuda:2')
test acc is  0.3647000001564063
test loss is 2.0152707869744364
test entropy is  1.2242839187002548
________________________________
cal_distance is  tensor(9410.6309, device='cuda:2')
cal_distance is  tensor(9376.7744, device='cuda:2')
cal_distance is  tensor(9343.0400, device='cuda:2')
________________________________
test distance is  tensor(9343.0400, device='cuda:2')
test similarity is  tensor(0.7364, device='cuda:2')
test acc is  0.3675800001564064
test loss is 2.0010600827843943
test entropy is  1.220015264837943
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 49.91% 

Test Accuracy: 49.00% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(9115.5205, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(8718.3389, device='cuda:2')
compute similarity is  tensor(0.9914, device='cuda:2')
compute distance is  tensor(8787.5127, device='cuda:2')
compute similarity is  tensor(0.9915, device='cuda:2')
compute distance is  tensor(9144.4365, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(8859.6250, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(8830.0410, device='cuda:2')
compute similarity is  tensor(0.9912, device='cuda:2')
compute distance is  tensor(8819.5654, device='cuda:2')
compute similarity is  tensor(0.9916, device='cuda:2')
compute distance is  tensor(8999.1758, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(9307.6289, device='cuda:2')
compute similarity is  tensor(0.9908, device='cuda:2')
compute distance is  tensor(8887.1455, device='cuda:2')
compute similarity is  tensor(0.9913, device='cuda:2')
compute distance is  tensor(9164.3867, device='cuda:2')
compute similarity is  tensor(0.9909, device='cuda:2')
compute distance is  tensor(9038.7656, device='cuda:2')
compute similarity is  tensor(0.9907, device='cuda:2')
calculated distance threshold is  tensor(9896.9189, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4792000001564078
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4671000001564077
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4738400001564077
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4470600001564074
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.48330000015640784
====================
________________________________
test distance is  tensor(4735.9077, device='cuda:2')
test similarity is  tensor(0.9234, device='cuda:2')
test acc is  0.4470600001564074
test loss is 1.7225129400067927
test entropy is  1.08220994998427
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 53.75% 

Test Accuracy: 52.52% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 53.75%
|----0th round Training Accuracy : 9.74%
|----1th round Training Accuracy : 9.74%
|----2th round Training Accuracy : 9.74%
|----3th round Training Accuracy : 9.74%
|----4th round Training Accuracy : 9.74%
|----5th round Training Accuracy : 9.74%
|----6th round Training Accuracy : 9.74%
|----7th round Training Accuracy : 16.23%
|----8th round Training Accuracy : 9.86%
|----9th round Training Accuracy : 17.87%
|----10th round Training Accuracy : 17.27%
|----11th round Training Accuracy : 18.97%
|----12th round Training Accuracy : 12.58%
|----13th round Training Accuracy : 24.69%
|----14th round Training Accuracy : 26.98%
|----15th round Training Accuracy : 28.89%
|----16th round Training Accuracy : 29.71%
|----17th round Training Accuracy : 31.64%
|----18th round Training Accuracy : 32.22%
|----19th round Training Accuracy : 32.38%
|----20th round Training Accuracy : 33.77%
|----21th round Training Accuracy : 34.35%
|----22th round Training Accuracy : 36.55%
|----23th round Training Accuracy : 37.46%
|----24th round Training Accuracy : 37.60%
|----25th round Training Accuracy : 38.79%
|----26th round Training Accuracy : 39.11%
|----27th round Training Accuracy : 39.35%
|----28th round Training Accuracy : 37.96%
|----29th round Training Accuracy : 41.19%
|----30th round Training Accuracy : 39.36%
|----31th round Training Accuracy : 42.48%
|----32th round Training Accuracy : 40.56%
|----33th round Training Accuracy : 43.58%
|----34th round Training Accuracy : 44.26%
|----35th round Training Accuracy : 45.74%
|----36th round Training Accuracy : 44.89%
|----37th round Training Accuracy : 47.05%
|----38th round Training Accuracy : 48.14%
|----39th round Training Accuracy : 48.05%
|----40th round Training Accuracy : 49.02%
|----41th round Training Accuracy : 50.38%
|----42th round Training Accuracy : 48.82%
|----43th round Training Accuracy : 49.90%
|----44th round Training Accuracy : 51.73%
|----45th round Training Accuracy : 49.19%
|----46th round Training Accuracy : 51.24%
|----47th round Training Accuracy : 53.71%
|----48th round Training Accuracy : 49.91%
|----49th round Training Accuracy : 53.75%
|----Final Test Accuracy: 52.52%
|----0th round Final Test Accuracy : 10.00%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 10.00%
|----3th round Final Test Accuracy : 10.00%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 10.00%
|----6th round Final Test Accuracy : 10.00%
|----7th round Final Test Accuracy : 16.21%
|----8th round Final Test Accuracy : 10.20%
|----9th round Final Test Accuracy : 18.25%
|----10th round Final Test Accuracy : 17.46%
|----11th round Final Test Accuracy : 18.92%
|----12th round Final Test Accuracy : 12.62%
|----13th round Final Test Accuracy : 25.08%
|----14th round Final Test Accuracy : 27.60%
|----15th round Final Test Accuracy : 28.62%
|----16th round Final Test Accuracy : 30.01%
|----17th round Final Test Accuracy : 31.78%
|----18th round Final Test Accuracy : 33.09%
|----19th round Final Test Accuracy : 33.08%
|----20th round Final Test Accuracy : 33.87%
|----21th round Final Test Accuracy : 34.30%
|----22th round Final Test Accuracy : 36.14%
|----23th round Final Test Accuracy : 36.85%
|----24th round Final Test Accuracy : 38.18%
|----25th round Final Test Accuracy : 38.98%
|----26th round Final Test Accuracy : 38.62%
|----27th round Final Test Accuracy : 38.64%
|----28th round Final Test Accuracy : 37.61%
|----29th round Final Test Accuracy : 40.33%
|----30th round Final Test Accuracy : 39.99%
|----31th round Final Test Accuracy : 41.67%
|----32th round Final Test Accuracy : 40.36%
|----33th round Final Test Accuracy : 43.80%
|----34th round Final Test Accuracy : 43.87%
|----35th round Final Test Accuracy : 45.22%
|----36th round Final Test Accuracy : 45.32%
|----37th round Final Test Accuracy : 46.77%
|----38th round Final Test Accuracy : 47.66%
|----39th round Final Test Accuracy : 47.93%
|----40th round Final Test Accuracy : 48.39%
|----41th round Final Test Accuracy : 49.64%
|----42th round Final Test Accuracy : 48.51%
|----43th round Final Test Accuracy : 49.16%
|----44th round Final Test Accuracy : 50.97%
|----45th round Final Test Accuracy : 48.66%
|----46th round Final Test Accuracy : 51.06%
|----47th round Final Test Accuracy : 52.66%
|----48th round Final Test Accuracy : 49.00%
|----49th round Final Test Accuracy : 52.52%

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 15946.4676
