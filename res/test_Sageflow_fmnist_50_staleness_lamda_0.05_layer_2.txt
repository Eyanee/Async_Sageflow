
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
poisoned accuracy threshold is  0.5
distance ratio is <class 'float'>
len of model dicts is  12
compute distance is  tensor(126.5624, device='cuda:2')
compute similarity is  tensor(0.6058, device='cuda:2')
compute distance is  tensor(126.4622, device='cuda:2')
compute similarity is  tensor(0.6034, device='cuda:2')
compute distance is  tensor(135.5401, device='cuda:2')
compute similarity is  tensor(0.5983, device='cuda:2')
compute distance is  tensor(120.3846, device='cuda:2')
compute similarity is  tensor(0.6175, device='cuda:2')
compute distance is  tensor(129.9514, device='cuda:2')
compute similarity is  tensor(0.6016, device='cuda:2')
compute distance is  tensor(122.5106, device='cuda:2')
compute similarity is  tensor(0.6191, device='cuda:2')
compute distance is  tensor(118.3275, device='cuda:2')
compute similarity is  tensor(0.6379, device='cuda:2')
compute distance is  tensor(129.1683, device='cuda:2')
compute similarity is  tensor(0.6107, device='cuda:2')
compute distance is  tensor(124.3689, device='cuda:2')
compute similarity is  tensor(0.6191, device='cuda:2')
compute distance is  tensor(124.6912, device='cuda:2')
compute similarity is  tensor(0.6179, device='cuda:2')
compute distance is  tensor(123.2523, device='cuda:2')
compute similarity is  tensor(0.6177, device='cuda:2')
compute distance is  tensor(130.8985, device='cuda:2')
compute similarity is  tensor(0.6019, device='cuda:2')
calculated distance threshold is  tensor(135.3680, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1665833334896678
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.14865000015633315
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.23411666682300442
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10331666682299863
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.102350000156332
====================
succ_min + 1
________________________________
test distance is  tensor(367.8098, device='cuda:2')
test similarity is  tensor(0.3235, device='cuda:2')
test acc is  0.102350000156332
test loss is 2.3756529321548525
test entropy is  2.093655595393069
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.093655595393069
avg test loss is  2.3756529321548525
avg accuracy is  0.102350000156332
compute_distance is  tensor(367.8098, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5066948634729203
avg test loss is  6.7682216807977476
avg accuracy is  0.09718333348966535
compute_distance is  tensor(295.7200, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(295.7200, device='cuda:2')
test similarity is  tensor(0.4034, device='cuda:2')
test acc is  0.09718333348966535
test loss is 6.7682216807977476
test entropy is  0.5066948634729203
________________________________
cal_distance is  tensor(200.0775, device='cuda:2')
cal_distance is  tensor(135.3679, device='cuda:2')
________________________________
test distance is  tensor(135.3679, device='cuda:2')
test similarity is  tensor(0.6889, device='cuda:2')
test acc is  0.09801666682299869
test loss is 2.691454673118429
test entropy is  1.7640597878742827
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 82.79% 

Test Accuracy: 82.08% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.6037247180938721
attack res is True
len of model dicts is  12
compute distance is  tensor(87.8323, device='cuda:2')
compute similarity is  tensor(0.8966, device='cuda:2')
compute distance is  tensor(88.6590, device='cuda:2')
compute similarity is  tensor(0.8995, device='cuda:2')
compute distance is  tensor(91.2553, device='cuda:2')
compute similarity is  tensor(0.8951, device='cuda:2')
compute distance is  tensor(90.5678, device='cuda:2')
compute similarity is  tensor(0.8894, device='cuda:2')
compute distance is  tensor(86.7632, device='cuda:2')
compute similarity is  tensor(0.9011, device='cuda:2')
compute distance is  tensor(92.7098, device='cuda:2')
compute similarity is  tensor(0.8874, device='cuda:2')
compute distance is  tensor(88.2131, device='cuda:2')
compute similarity is  tensor(0.8999, device='cuda:2')
compute distance is  tensor(89.4683, device='cuda:2')
compute similarity is  tensor(0.8981, device='cuda:2')
compute distance is  tensor(90.2306, device='cuda:2')
compute similarity is  tensor(0.8971, device='cuda:2')
compute distance is  tensor(86.5118, device='cuda:2')
compute similarity is  tensor(0.9025, device='cuda:2')
compute distance is  tensor(84.3111, device='cuda:2')
compute similarity is  tensor(0.9045, device='cuda:2')
compute distance is  tensor(87.2828, device='cuda:2')
compute similarity is  tensor(0.9000, device='cuda:2')
calculated distance threshold is  tensor(93.4573, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7394833334896617
====================
====================
iteration is  0
round is  1
accuracy is  0.7739333334896599
====================
====================
iteration is  0
round is  2
accuracy is  0.7757500001563267
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5339833334896756
====================
====================
iteration is  1
round is  1
accuracy is  0.4746333334896752
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.45510000015634167
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.48645000015634193
====================
====================
iteration is  2
round is  1
accuracy is  0.2824166668230058
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.24143333348967136
====================
succ_min + 1
________________________________
test distance is  tensor(1465.3016, device='cuda:2')
test similarity is  tensor(0.1336, device='cuda:2')
test acc is  0.24143333348967136
test loss is 9.064419548648761
test entropy is  0.1558160291059312
________________________________
cal_distance is  tensor(370.0589, device='cuda:2')
cal_distance is  tensor(93.4581, device='cuda:2')
cal_distance is  tensor(23.6032, device='cuda:2')
________________________________
test distance is  tensor(23.6032, device='cuda:2')
test similarity is  tensor(0.9930, device='cuda:2')
test acc is  0.8290166668229909
test loss is 0.49297852220057425
test entropy is  0.6252992556039204
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.6252992556039204
avg test loss is  0.49297852220057425
avg accuracy is  0.8290166668229909
compute_distance is  tensor(23.6032, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.27465393831099527
avg test loss is  5.27701798659652
avg accuracy is  0.2365666668230045
compute_distance is  tensor(31.0723, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(31.0723, device='cuda:2')
test similarity is  tensor(0.9855, device='cuda:2')
test acc is  0.2365666668230045
test loss is 5.27701798659652
test entropy is  0.27465393831099527
________________________________
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 85.81% 

Test Accuracy: 85.14% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.7969182133674622
attack res is True
len of model dicts is  12
compute distance is  tensor(83.9929, device='cuda:2')
compute similarity is  tensor(0.9150, device='cuda:2')
compute distance is  tensor(90.4248, device='cuda:2')
compute similarity is  tensor(0.9115, device='cuda:2')
compute distance is  tensor(87.9305, device='cuda:2')
compute similarity is  tensor(0.9097, device='cuda:2')
compute distance is  tensor(87.3999, device='cuda:2')
compute similarity is  tensor(0.9116, device='cuda:2')
compute distance is  tensor(83.9635, device='cuda:2')
compute similarity is  tensor(0.9160, device='cuda:2')
compute distance is  tensor(87.1457, device='cuda:2')
compute similarity is  tensor(0.9079, device='cuda:2')
compute distance is  tensor(86.2060, device='cuda:2')
compute similarity is  tensor(0.9165, device='cuda:2')
compute distance is  tensor(86.4346, device='cuda:2')
compute similarity is  tensor(0.9144, device='cuda:2')
compute distance is  tensor(86.0838, device='cuda:2')
compute similarity is  tensor(0.9137, device='cuda:2')
compute distance is  tensor(82.2716, device='cuda:2')
compute similarity is  tensor(0.9214, device='cuda:2')
compute distance is  tensor(82.9764, device='cuda:2')
compute similarity is  tensor(0.9176, device='cuda:2')
compute distance is  tensor(82.0926, device='cuda:2')
compute similarity is  tensor(0.9200, device='cuda:2')
calculated distance threshold is  tensor(92.0737, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8067833334896585
====================
====================
iteration is  0
round is  1
accuracy is  0.7631166668229938
====================
====================
iteration is  0
round is  2
accuracy is  0.7601833334896607
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4980666668230087
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5056833334896754
====================
====================
iteration is  1
round is  2
accuracy is  0.42455000015634137
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.21883333348967057
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.31381666682300646
====================
====================
iteration is  2
round is  2
accuracy is  0.42371666682300807
====================
________________________________
test distance is  tensor(1468.9280, device='cuda:2')
test similarity is  tensor(0.1485, device='cuda:2')
test acc is  0.21883333348967057
test loss is 15.515354933260854
test entropy is  0.06243356490936647
________________________________
cal_distance is  tensor(367.7637, device='cuda:2')
cal_distance is  tensor(92.0745, device='cuda:2')
cal_distance is  tensor(23.0525, device='cuda:2')
________________________________
test distance is  tensor(23.0525, device='cuda:2')
test similarity is  tensor(0.9947, device='cuda:2')
test acc is  0.8567666668229897
test loss is 0.4120859913766257
test entropy is  0.37696546273254383
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.37696546273254383
avg test loss is  0.4120859913766257
avg accuracy is  0.8567666668229897
compute_distance is  tensor(23.0525, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15823097565948074
avg test loss is  5.724951661726051
avg accuracy is  0.21238333348967026
compute_distance is  tensor(28.5291, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(28.5291, device='cuda:2')
test similarity is  tensor(0.9907, device='cuda:2')
test acc is  0.21238333348967026
test loss is 5.724951661726051
test entropy is  0.15823097565948074
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 86.92% 

Test Accuracy: 85.70% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.9275505542755127
attack res is True
len of model dicts is  12
compute distance is  tensor(84.7307, device='cuda:2')
compute similarity is  tensor(0.9203, device='cuda:2')
compute distance is  tensor(88.3145, device='cuda:2')
compute similarity is  tensor(0.9206, device='cuda:2')
compute distance is  tensor(84.7605, device='cuda:2')
compute similarity is  tensor(0.9232, device='cuda:2')
compute distance is  tensor(86.2007, device='cuda:2')
compute similarity is  tensor(0.9195, device='cuda:2')
compute distance is  tensor(82.2253, device='cuda:2')
compute similarity is  tensor(0.9270, device='cuda:2')
compute distance is  tensor(82.2318, device='cuda:2')
compute similarity is  tensor(0.9224, device='cuda:2')
compute distance is  tensor(87.6798, device='cuda:2')
compute similarity is  tensor(0.9200, device='cuda:2')
compute distance is  tensor(86.8170, device='cuda:2')
compute similarity is  tensor(0.9226, device='cuda:2')
compute distance is  tensor(84.4642, device='cuda:2')
compute similarity is  tensor(0.9254, device='cuda:2')
compute distance is  tensor(82.6463, device='cuda:2')
compute similarity is  tensor(0.9260, device='cuda:2')
compute distance is  tensor(86.8689, device='cuda:2')
compute similarity is  tensor(0.9187, device='cuda:2')
compute distance is  tensor(83.5756, device='cuda:2')
compute similarity is  tensor(0.9254, device='cuda:2')
calculated distance threshold is  tensor(90.2490, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7970000001563255
====================
====================
iteration is  0
round is  1
accuracy is  0.7994666668229921
====================
====================
iteration is  0
round is  2
accuracy is  0.7101333334896633
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5119000001563422
====================
====================
iteration is  1
round is  1
accuracy is  0.6475000001563339
====================
====================
iteration is  1
round is  2
accuracy is  0.5742166668230065
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2718333334896722
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3190000001563399
====================
====================
iteration is  2
round is  2
accuracy is  0.2098333334896702
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.453183333489675
====================
====================
iteration is  3
round is  1
accuracy is  0.21130000015633693
====================
________________________________
test distance is  tensor(1471.5128, device='cuda:2')
test similarity is  tensor(0.1614, device='cuda:2')
test acc is  0.2098333334896702
test loss is 15.615380468144854
test entropy is  0.08285224490534904
________________________________
cal_distance is  tensor(364.4215, device='cuda:2')
cal_distance is  tensor(90.2497, device='cuda:2')
cal_distance is  tensor(22.3510, device='cuda:2')
________________________________
test distance is  tensor(22.3510, device='cuda:2')
test similarity is  tensor(0.9956, device='cuda:2')
test acc is  0.8653166668229894
test loss is 0.38859511783191647
test entropy is  0.3197172920046839
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3197172920046839
avg test loss is  0.38859511783191647
avg accuracy is  0.8653166668229894
compute_distance is  tensor(22.3510, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2335051373838743
avg test loss is  5.067959588473793
avg accuracy is  0.20585000015633662
compute_distance is  tensor(29.6545, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(29.6545, device='cuda:2')
test similarity is  tensor(0.9915, device='cuda:2')
test acc is  0.20585000015633662
test loss is 5.067959588473793
test entropy is  0.2335051373838743
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.41% 

Test Accuracy: 86.31% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.0260884761810303
attack res is True
len of model dicts is  12
compute distance is  tensor(81.4837, device='cuda:2')
compute similarity is  tensor(0.9320, device='cuda:2')
compute distance is  tensor(88.0530, device='cuda:2')
compute similarity is  tensor(0.9266, device='cuda:2')
compute distance is  tensor(86.2258, device='cuda:2')
compute similarity is  tensor(0.9265, device='cuda:2')
compute distance is  tensor(85.2463, device='cuda:2')
compute similarity is  tensor(0.9264, device='cuda:2')
compute distance is  tensor(91.3142, device='cuda:2')
compute similarity is  tensor(0.9241, device='cuda:2')
compute distance is  tensor(83.6504, device='cuda:2')
compute similarity is  tensor(0.9267, device='cuda:2')
compute distance is  tensor(81.5609, device='cuda:2')
compute similarity is  tensor(0.9310, device='cuda:2')
compute distance is  tensor(83.3355, device='cuda:2')
compute similarity is  tensor(0.9299, device='cuda:2')
compute distance is  tensor(81.5571, device='cuda:2')
compute similarity is  tensor(0.9348, device='cuda:2')
compute distance is  tensor(84.9380, device='cuda:2')
compute similarity is  tensor(0.9298, device='cuda:2')
compute distance is  tensor(85.7901, device='cuda:2')
compute similarity is  tensor(0.9294, device='cuda:2')
compute distance is  tensor(81.9101, device='cuda:2')
compute similarity is  tensor(0.9319, device='cuda:2')
calculated distance threshold is  tensor(95.7327, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8051166668229919
====================
====================
iteration is  0
round is  1
accuracy is  0.7919333334896591
====================
====================
iteration is  0
round is  2
accuracy is  0.8149000001563248
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5364833334896757
====================
====================
iteration is  1
round is  1
accuracy is  0.5298333334896755
====================
====================
iteration is  1
round is  2
accuracy is  0.366933333489674
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.20708333348967004
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2371500001563379
====================
====================
iteration is  2
round is  2
accuracy is  0.20560000015633664
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.24153333348967132
====================
________________________________
test distance is  tensor(1479.0812, device='cuda:2')
test similarity is  tensor(0.1691, device='cuda:2')
test acc is  0.20560000015633664
test loss is 19.63659268706592
test entropy is  0.06642623637407732
________________________________
cal_distance is  tensor(376.2936, device='cuda:2')
cal_distance is  tensor(95.7334, device='cuda:2')
cal_distance is  tensor(24.3562, device='cuda:2')
________________________________
test distance is  tensor(24.3562, device='cuda:2')
test similarity is  tensor(0.9953, device='cuda:2')
test acc is  0.8709666668229892
test loss is 0.38131691284302965
test entropy is  0.28167486287701105
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.28167486287701105
avg test loss is  0.38131691284302965
avg accuracy is  0.8709666668229892
compute_distance is  tensor(24.3562, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20382164874628408
avg test loss is  5.87826253203695
avg accuracy is  0.19655000015633625
compute_distance is  tensor(30.1445, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(30.1445, device='cuda:2')
test similarity is  tensor(0.9913, device='cuda:2')
test acc is  0.19655000015633625
test loss is 5.87826253203695
test entropy is  0.20382164874628408
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.22% 

Test Accuracy: 86.41% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.1128989458084106
attack res is True
len of model dicts is  12
compute distance is  tensor(83.7130, device='cuda:2')
compute similarity is  tensor(0.9318, device='cuda:2')
compute distance is  tensor(91.8796, device='cuda:2')
compute similarity is  tensor(0.9264, device='cuda:2')
compute distance is  tensor(88.1702, device='cuda:2')
compute similarity is  tensor(0.9274, device='cuda:2')
compute distance is  tensor(90.4999, device='cuda:2')
compute similarity is  tensor(0.9218, device='cuda:2')
compute distance is  tensor(92.5862, device='cuda:2')
compute similarity is  tensor(0.9262, device='cuda:2')
compute distance is  tensor(90.5781, device='cuda:2')
compute similarity is  tensor(0.9236, device='cuda:2')
compute distance is  tensor(88.9996, device='cuda:2')
compute similarity is  tensor(0.9309, device='cuda:2')
compute distance is  tensor(84.6788, device='cuda:2')
compute similarity is  tensor(0.9332, device='cuda:2')
compute distance is  tensor(87.3239, device='cuda:2')
compute similarity is  tensor(0.9314, device='cuda:2')
compute distance is  tensor(84.0434, device='cuda:2')
compute similarity is  tensor(0.9370, device='cuda:2')
compute distance is  tensor(87.6280, device='cuda:2')
compute similarity is  tensor(0.9289, device='cuda:2')
compute distance is  tensor(81.4508, device='cuda:2')
compute similarity is  tensor(0.9377, device='cuda:2')
calculated distance threshold is  tensor(99.2052, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7331166668229954
====================
====================
iteration is  0
round is  1
accuracy is  0.7711333334896601
====================
====================
iteration is  0
round is  2
accuracy is  0.7820000001563262
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4477500001563416
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6024666668230041
====================
====================
iteration is  1
round is  2
accuracy is  0.37548333348967405
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2870833334896726
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.1757500001563351
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.24361666682300476
====================
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.1682, device='cuda:2')
test acc is  0.1757500001563351
test loss is 18.090066893522675
test entropy is  0.050035026667615785
________________________________
cal_distance is  tensor(381.7101, device='cuda:2')
cal_distance is  tensor(99.2059, device='cuda:2')
cal_distance is  tensor(25.7839, device='cuda:2')
________________________________
test distance is  tensor(25.7839, device='cuda:2')
test similarity is  tensor(0.9951, device='cuda:2')
test acc is  0.873466666822989
test loss is 0.38273340574841
test entropy is  0.26397741508128036
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.26397741508128036
avg test loss is  0.38273340574841
avg accuracy is  0.873466666822989
compute_distance is  tensor(25.7839, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13710972895500248
avg test loss is  5.374807191555942
avg accuracy is  0.15671666682300045
compute_distance is  tensor(29.9604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(29.9604, device='cuda:2')
test similarity is  tensor(0.9929, device='cuda:2')
test acc is  0.15671666682300045
test loss is 5.374807191555942
test entropy is  0.13710972895500248
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.84% 

Test Accuracy: 86.77% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.1812889575958252
attack res is True
len of model dicts is  12
compute distance is  tensor(84.4619, device='cuda:2')
compute similarity is  tensor(0.9337, device='cuda:2')
compute distance is  tensor(93.2555, device='cuda:2')
compute similarity is  tensor(0.9286, device='cuda:2')
compute distance is  tensor(92.4837, device='cuda:2')
compute similarity is  tensor(0.9276, device='cuda:2')
compute distance is  tensor(90.5304, device='cuda:2')
compute similarity is  tensor(0.9272, device='cuda:2')
compute distance is  tensor(89.2388, device='cuda:2')
compute similarity is  tensor(0.9334, device='cuda:2')
compute distance is  tensor(85.7768, device='cuda:2')
compute similarity is  tensor(0.9326, device='cuda:2')
compute distance is  tensor(86.8884, device='cuda:2')
compute similarity is  tensor(0.9333, device='cuda:2')
compute distance is  tensor(81.0297, device='cuda:2')
compute similarity is  tensor(0.9392, device='cuda:2')
compute distance is  tensor(80.0453, device='cuda:2')
compute similarity is  tensor(0.9420, device='cuda:2')
compute distance is  tensor(88.8933, device='cuda:2')
compute similarity is  tensor(0.9335, device='cuda:2')
compute distance is  tensor(86.0474, device='cuda:2')
compute similarity is  tensor(0.9331, device='cuda:2')
compute distance is  tensor(80.0391, device='cuda:2')
compute similarity is  tensor(0.9409, device='cuda:2')
calculated distance threshold is  tensor(103.2186, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8477833334896568
====================
====================
iteration is  0
round is  1
accuracy is  0.8080333334896583
====================
====================
iteration is  0
round is  2
accuracy is  0.8265333334896576
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6228000001563357
====================
====================
iteration is  1
round is  1
accuracy is  0.38338333348967424
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.4321500001563414
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2154833334896704
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.1532333334896668
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.24481666682300474
====================
________________________________
test distance is  tensor(1480.5072, device='cuda:2')
test similarity is  tensor(0.1751, device='cuda:2')
test acc is  0.1532333334896668
test loss is 25.88099290567166
test entropy is  0.05286669235394549
________________________________
cal_distance is  tensor(390.9173, device='cuda:2')
cal_distance is  tensor(103.2194, device='cuda:2')
cal_distance is  tensor(27.2549, device='cuda:2')
________________________________
test distance is  tensor(27.2549, device='cuda:2')
test similarity is  tensor(0.9948, device='cuda:2')
test acc is  0.8789166668229887
test loss is 0.3726560677419593
test entropy is  0.23747716011650272
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.23747716011650272
avg test loss is  0.3726560677419593
avg accuracy is  0.8789166668229887
compute_distance is  tensor(27.2549, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20247881066824583
avg test loss is  5.227821566656963
avg accuracy is  0.14333333348966587
compute_distance is  tensor(34.0498, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(34.0498, device='cuda:2')
test similarity is  tensor(0.9915, device='cuda:2')
test acc is  0.14333333348966587
test loss is 5.227821566656963
test entropy is  0.20247881066824583
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.94% 

Test Accuracy: 86.78% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.2353782653808594
attack res is True
len of model dicts is  12
compute distance is  tensor(80.6499, device='cuda:2')
compute similarity is  tensor(0.9413, device='cuda:2')
compute distance is  tensor(86.2558, device='cuda:2')
compute similarity is  tensor(0.9386, device='cuda:2')
compute distance is  tensor(90.1479, device='cuda:2')
compute similarity is  tensor(0.9301, device='cuda:2')
compute distance is  tensor(91.3708, device='cuda:2')
compute similarity is  tensor(0.9270, device='cuda:2')
compute distance is  tensor(89.1987, device='cuda:2')
compute similarity is  tensor(0.9369, device='cuda:2')
compute distance is  tensor(89.1449, device='cuda:2')
compute similarity is  tensor(0.9317, device='cuda:2')
compute distance is  tensor(91.8166, device='cuda:2')
compute similarity is  tensor(0.9337, device='cuda:2')
compute distance is  tensor(82.2058, device='cuda:2')
compute similarity is  tensor(0.9418, device='cuda:2')
compute distance is  tensor(83.5676, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(88.6996, device='cuda:2')
compute similarity is  tensor(0.9370, device='cuda:2')
compute distance is  tensor(87.9933, device='cuda:2')
compute similarity is  tensor(0.9344, device='cuda:2')
compute distance is  tensor(87.2346, device='cuda:2')
compute similarity is  tensor(0.9373, device='cuda:2')
calculated distance threshold is  tensor(102.1929, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8089666668229916
====================
====================
iteration is  0
round is  1
accuracy is  0.8142500001563248
====================
====================
iteration is  0
round is  2
accuracy is  0.758266666822994
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5939833334896714
====================
====================
iteration is  1
round is  1
accuracy is  0.5812000001563391
====================
====================
iteration is  1
round is  2
accuracy is  0.3320833334896734
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3995500001563411
====================
====================
iteration is  2
round is  1
accuracy is  0.16530000015633442
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.20720000015633672
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.19498333348966956
====================
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.1827, device='cuda:2')
test acc is  0.16530000015633442
test loss is 23.784548541884433
test entropy is  0.041229872714612946
________________________________
cal_distance is  tensor(386.2809, device='cuda:2')
cal_distance is  tensor(102.1937, device='cuda:2')
cal_distance is  tensor(27.0366, device='cuda:2')
________________________________
test distance is  tensor(27.0366, device='cuda:2')
test similarity is  tensor(0.9951, device='cuda:2')
test acc is  0.8787166668229888
test loss is 0.36934446591113423
test entropy is  0.24903355461003177
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24903355461003177
avg test loss is  0.36934446591113423
avg accuracy is  0.8787166668229888
compute_distance is  tensor(27.0366, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12538602563745177
avg test loss is  6.255245017598687
avg accuracy is  0.14915000015633306
compute_distance is  tensor(31.8664, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(31.8664, device='cuda:2')
test similarity is  tensor(0.9931, device='cuda:2')
test acc is  0.14915000015633306
test loss is 6.255245017598687
test entropy is  0.12538602563745177
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 87.83% 

Test Accuracy: 86.88% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.2951304912567139
attack res is True
len of model dicts is  12
compute distance is  tensor(77.4392, device='cuda:2')
compute similarity is  tensor(0.9450, device='cuda:2')
compute distance is  tensor(88.2678, device='cuda:2')
compute similarity is  tensor(0.9374, device='cuda:2')
compute distance is  tensor(87.9006, device='cuda:2')
compute similarity is  tensor(0.9372, device='cuda:2')
compute distance is  tensor(94.5658, device='cuda:2')
compute similarity is  tensor(0.9264, device='cuda:2')
compute distance is  tensor(86.8733, device='cuda:2')
compute similarity is  tensor(0.9398, device='cuda:2')
compute distance is  tensor(85.7393, device='cuda:2')
compute similarity is  tensor(0.9379, device='cuda:2')
compute distance is  tensor(84.2238, device='cuda:2')
compute similarity is  tensor(0.9424, device='cuda:2')
compute distance is  tensor(86.2279, device='cuda:2')
compute similarity is  tensor(0.9378, device='cuda:2')
compute distance is  tensor(85.8878, device='cuda:2')
compute similarity is  tensor(0.9409, device='cuda:2')
compute distance is  tensor(85.4717, device='cuda:2')
compute similarity is  tensor(0.9440, device='cuda:2')
compute distance is  tensor(85.2081, device='cuda:2')
compute similarity is  tensor(0.9398, device='cuda:2')
compute distance is  tensor(84.7421, device='cuda:2')
compute similarity is  tensor(0.9412, device='cuda:2')
calculated distance threshold is  tensor(113.7844, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7999333334896588
====================
====================
iteration is  0
round is  1
accuracy is  0.8301333334896575
====================
====================
iteration is  0
round is  2
accuracy is  0.7917666668229925
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5030166668230087
====================
====================
iteration is  1
round is  1
accuracy is  0.5167833334896755
====================
====================
iteration is  1
round is  2
accuracy is  0.5198500001563422
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.24116666682300467
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.16656666682300114
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.20253333348966981
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.20135000015633644
====================
====================
iteration is  3
round is  1
accuracy is  0.2808500001563391
====================
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.1856, device='cuda:2')
test acc is  0.16656666682300114
test loss is 18.679384951398315
test entropy is  0.05674279945145951
________________________________
cal_distance is  tensor(408.4535, device='cuda:2')
cal_distance is  tensor(113.7852, device='cuda:2')
cal_distance is  tensor(31.6982, device='cuda:2')
________________________________
test distance is  tensor(31.6982, device='cuda:2')
test similarity is  tensor(0.9937, device='cuda:2')
test acc is  0.8808000001563221
test loss is 0.37564563054615246
test entropy is  0.217808500234125
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.217808500234125
avg test loss is  0.37564563054615246
avg accuracy is  0.8808000001563221
compute_distance is  tensor(31.6982, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14119518644361098
avg test loss is  5.760177646364484
avg accuracy is  0.13306666682299859
compute_distance is  tensor(36.5780, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(36.5780, device='cuda:2')
test similarity is  tensor(0.9917, device='cuda:2')
test acc is  0.13306666682299859
test loss is 5.760177646364484
test entropy is  0.14119518644361098
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 88.10% 

Test Accuracy: 87.20% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.424047589302063
attack res is True
len of model dicts is  12
compute distance is  tensor(90.6275, device='cuda:2')
compute similarity is  tensor(0.9389, device='cuda:2')
compute distance is  tensor(95.4241, device='cuda:2')
compute similarity is  tensor(0.9357, device='cuda:2')
compute distance is  tensor(89.6565, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(94.9138, device='cuda:2')
compute similarity is  tensor(0.9333, device='cuda:2')
compute distance is  tensor(94.1215, device='cuda:2')
compute similarity is  tensor(0.9392, device='cuda:2')
compute distance is  tensor(88.5438, device='cuda:2')
compute similarity is  tensor(0.9411, device='cuda:2')
compute distance is  tensor(92.1173, device='cuda:2')
compute similarity is  tensor(0.9415, device='cuda:2')
compute distance is  tensor(88.1831, device='cuda:2')
compute similarity is  tensor(0.9422, device='cuda:2')
compute distance is  tensor(82.4225, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
compute distance is  tensor(91.2127, device='cuda:2')
compute similarity is  tensor(0.9397, device='cuda:2')
compute distance is  tensor(91.4946, device='cuda:2')
compute similarity is  tensor(0.9374, device='cuda:2')
compute distance is  tensor(94.8306, device='cuda:2')
compute similarity is  tensor(0.9341, device='cuda:2')
calculated distance threshold is  tensor(112.7729, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8094166668229917
====================
====================
iteration is  0
round is  1
accuracy is  0.84901666682299
====================
====================
iteration is  0
round is  2
accuracy is  0.8203166668229912
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.40550000015634113
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5059500001563421
====================
====================
iteration is  1
round is  2
accuracy is  0.619150000156336
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.23450000015633773
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.14806666682299968
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.15758333348966713
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2433333334896714
====================
________________________________
test distance is  tensor(1476.0420, device='cuda:2')
test similarity is  tensor(0.2007, device='cuda:2')
test acc is  0.14806666682299968
test loss is 20.012437497120676
test entropy is  0.08652089140427582
________________________________
cal_distance is  tensor(407.9926, device='cuda:2')
cal_distance is  tensor(112.7736, device='cuda:2')
cal_distance is  tensor(31.1723, device='cuda:2')
________________________________
test distance is  tensor(31.1723, device='cuda:2')
test similarity is  tensor(0.9945, device='cuda:2')
test acc is  0.8845333334896552
test loss is 0.3689265370146552
test entropy is  0.197729574178836
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.197729574178836
avg test loss is  0.3689265370146552
avg accuracy is  0.8845333334896552
compute_distance is  tensor(31.1723, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3337402596497841
avg test loss is  4.96482396913744
avg accuracy is  0.14830000015633304
compute_distance is  tensor(39.7902, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(39.7902, device='cuda:2')
test similarity is  tensor(0.9910, device='cuda:2')
test acc is  0.14830000015633304
test loss is 4.96482396913744
test entropy is  0.3337402596497841
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 87.50% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.504011631011963
attack res is True
len of model dicts is  12
compute distance is  tensor(84.2812, device='cuda:2')
compute similarity is  tensor(0.9459, device='cuda:2')
compute distance is  tensor(91.5877, device='cuda:2')
compute similarity is  tensor(0.9420, device='cuda:2')
compute distance is  tensor(90.4376, device='cuda:2')
compute similarity is  tensor(0.9443, device='cuda:2')
compute distance is  tensor(97.1325, device='cuda:2')
compute similarity is  tensor(0.9320, device='cuda:2')
compute distance is  tensor(94.1600, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(91.5066, device='cuda:2')
compute similarity is  tensor(0.9411, device='cuda:2')
compute distance is  tensor(91.1663, device='cuda:2')
compute similarity is  tensor(0.9413, device='cuda:2')
compute distance is  tensor(97.0164, device='cuda:2')
compute similarity is  tensor(0.9383, device='cuda:2')
compute distance is  tensor(89.9784, device='cuda:2')
compute similarity is  tensor(0.9430, device='cuda:2')
compute distance is  tensor(89.1141, device='cuda:2')
compute similarity is  tensor(0.9466, device='cuda:2')
compute distance is  tensor(95.8752, device='cuda:2')
compute similarity is  tensor(0.9371, device='cuda:2')
compute distance is  tensor(89.3643, device='cuda:2')
compute similarity is  tensor(0.9425, device='cuda:2')
calculated distance threshold is  tensor(117.2808, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8355333334896572
====================
====================
iteration is  0
round is  1
accuracy is  0.8566333334896563
====================
====================
iteration is  0
round is  2
accuracy is  0.8097166668229917
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7014500001563305
====================
====================
iteration is  1
round is  1
accuracy is  0.6049000001563372
====================
====================
iteration is  1
round is  2
accuracy is  0.6838500001563316
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.34416666682300706
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.1174166668229986
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.21666666682300384
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.25028333348967163
====================
====================
iteration is  3
round is  1
accuracy is  0.4304000001563414
====================
________________________________
test distance is  tensor(1476.9706, device='cuda:2')
test similarity is  tensor(0.1999, device='cuda:2')
test acc is  0.1174166668229986
test loss is 23.54646799864291
test entropy is  0.02021080529351266
________________________________
cal_distance is  tensor(416.1980, device='cuda:2')
cal_distance is  tensor(117.2816, device='cuda:2')
cal_distance is  tensor(33.0495, device='cuda:2')
________________________________
test distance is  tensor(33.0495, device='cuda:2')
test similarity is  tensor(0.9942, device='cuda:2')
test acc is  0.8869333334896552
test loss is 0.37944545728692625
test entropy is  0.17696161978820493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17696161978820493
avg test loss is  0.37944545728692625
avg accuracy is  0.8869333334896552
compute_distance is  tensor(33.0495, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11356207390012009
avg test loss is  5.173248768361138
avg accuracy is  0.10595000015633196
compute_distance is  tensor(37.2633, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(37.2633, device='cuda:2')
test similarity is  tensor(0.9930, device='cuda:2')
test acc is  0.10595000015633196
test loss is 5.173248768361138
test entropy is  0.11356207390012009
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.18% 

Test Accuracy: 87.23% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.6149555444717407
attack res is True
len of model dicts is  12
compute distance is  tensor(90.0177, device='cuda:2')
compute similarity is  tensor(0.9448, device='cuda:2')
compute distance is  tensor(97.8136, device='cuda:2')
compute similarity is  tensor(0.9403, device='cuda:2')
compute distance is  tensor(96.7778, device='cuda:2')
compute similarity is  tensor(0.9395, device='cuda:2')
compute distance is  tensor(103.0078, device='cuda:2')
compute similarity is  tensor(0.9333, device='cuda:2')
compute distance is  tensor(99.6323, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(92.9164, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(92.1729, device='cuda:2')
compute similarity is  tensor(0.9473, device='cuda:2')
compute distance is  tensor(90.9184, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(89.4642, device='cuda:2')
compute similarity is  tensor(0.9471, device='cuda:2')
compute distance is  tensor(97.1857, device='cuda:2')
compute similarity is  tensor(0.9441, device='cuda:2')
compute distance is  tensor(92.8034, device='cuda:2')
compute similarity is  tensor(0.9430, device='cuda:2')
compute distance is  tensor(94.5137, device='cuda:2')
compute similarity is  tensor(0.9429, device='cuda:2')
calculated distance threshold is  tensor(127.7191, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7957166668229924
====================
====================
iteration is  0
round is  1
accuracy is  0.7813000001563264
====================
====================
iteration is  0
round is  2
accuracy is  0.8538166668229897
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3913833334896743
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5891333334896718
====================
====================
iteration is  1
round is  2
accuracy is  0.4192500001563413
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.28781666682300594
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.18208333348966885
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.36446666682300727
====================
________________________________
test distance is  tensor(1464.3707, device='cuda:2')
test similarity is  tensor(0.2105, device='cuda:2')
test acc is  0.18208333348966885
test loss is 21.93305781553549
test entropy is  0.05606205637421784
________________________________
cal_distance is  tensor(432.4681, device='cuda:2')
cal_distance is  tensor(127.7199, device='cuda:2')
cal_distance is  tensor(37.7197, device='cuda:2')
________________________________
test distance is  tensor(37.7197, device='cuda:2')
test similarity is  tensor(0.9931, device='cuda:2')
test acc is  0.8864333334896553
test loss is 0.40234510344800667
test entropy is  0.16885174864899122
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16885174864899122
avg test loss is  0.40234510344800667
avg accuracy is  0.8864333334896553
compute_distance is  tensor(37.7197, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2147287336636835
avg test loss is  5.084388886687598
avg accuracy is  0.16550000015633443
compute_distance is  tensor(41.9846, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(41.9846, device='cuda:2')
test similarity is  tensor(0.9918, device='cuda:2')
test acc is  0.16550000015633443
test loss is 5.084388886687598
test entropy is  0.2147287336636835
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 88.58% 

Test Accuracy: 87.71% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.6314237117767334
attack res is True
len of model dicts is  12
compute distance is  tensor(89.4083, device='cuda:2')
compute similarity is  tensor(0.9467, device='cuda:2')
compute distance is  tensor(91.7335, device='cuda:2')
compute similarity is  tensor(0.9471, device='cuda:2')
compute distance is  tensor(94.1718, device='cuda:2')
compute similarity is  tensor(0.9457, device='cuda:2')
compute distance is  tensor(98.3978, device='cuda:2')
compute similarity is  tensor(0.9393, device='cuda:2')
compute distance is  tensor(101.9267, device='cuda:2')
compute similarity is  tensor(0.9384, device='cuda:2')
compute distance is  tensor(93.2264, device='cuda:2')
compute similarity is  tensor(0.9433, device='cuda:2')
compute distance is  tensor(97.9948, device='cuda:2')
compute similarity is  tensor(0.9404, device='cuda:2')
compute distance is  tensor(90.1730, device='cuda:2')
compute similarity is  tensor(0.9481, device='cuda:2')
compute distance is  tensor(88.3957, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(91.2492, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
compute distance is  tensor(90.9297, device='cuda:2')
compute similarity is  tensor(0.9465, device='cuda:2')
compute distance is  tensor(88.8981, device='cuda:2')
compute similarity is  tensor(0.9504, device='cuda:2')
calculated distance threshold is  tensor(130.4371, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8418666668229903
====================
====================
iteration is  0
round is  1
accuracy is  0.8379666668229904
====================
====================
iteration is  0
round is  2
accuracy is  0.837983333489657
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.665383333489666
====================
====================
iteration is  1
round is  1
accuracy is  0.504050000156342
====================
====================
iteration is  1
round is  2
accuracy is  0.6451833334896675
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.19970000015633638
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.21401666682300363
====================
====================
iteration is  2
round is  2
accuracy is  0.2100333334896702
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.25265000015633826
====================
====================
iteration is  3
round is  1
accuracy is  0.22791666682300427
====================
________________________________
test distance is  tensor(1474.9321, device='cuda:2')
test similarity is  tensor(0.2120, device='cuda:2')
test acc is  0.19970000015633638
test loss is 17.00253161590999
test entropy is  0.06503387195850487
________________________________
cal_distance is  tensor(438.6187, device='cuda:2')
cal_distance is  tensor(130.4378, device='cuda:2')
cal_distance is  tensor(38.7904, device='cuda:2')
________________________________
test distance is  tensor(38.7904, device='cuda:2')
test similarity is  tensor(0.9928, device='cuda:2')
test acc is  0.8891166668229884
test loss is 0.379228067892129
test entropy is  0.16812806149948634
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16812806149948634
avg test loss is  0.379228067892129
avg accuracy is  0.8891166668229884
compute_distance is  tensor(38.7904, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3227168489684428
avg test loss is  4.715165729970058
avg accuracy is  0.1946333334896695
compute_distance is  tensor(44.4104, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.4104, device='cuda:2')
test similarity is  tensor(0.9908, device='cuda:2')
test acc is  0.1946333334896695
test loss is 4.715165729970058
test entropy is  0.3227168489684428
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.17% 

Test Accuracy: 87.31% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.7453382015228271
attack res is True
len of model dicts is  12
compute distance is  tensor(88.4900, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
compute distance is  tensor(103.4040, device='cuda:2')
compute similarity is  tensor(0.9392, device='cuda:2')
compute distance is  tensor(98.5063, device='cuda:2')
compute similarity is  tensor(0.9437, device='cuda:2')
compute distance is  tensor(100.1397, device='cuda:2')
compute similarity is  tensor(0.9409, device='cuda:2')
compute distance is  tensor(99.2286, device='cuda:2')
compute similarity is  tensor(0.9449, device='cuda:2')
compute distance is  tensor(99.3583, device='cuda:2')
compute similarity is  tensor(0.9436, device='cuda:2')
compute distance is  tensor(96.2779, device='cuda:2')
compute similarity is  tensor(0.9462, device='cuda:2')
compute distance is  tensor(93.7034, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
compute distance is  tensor(92.3778, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
compute distance is  tensor(97.8819, device='cuda:2')
compute similarity is  tensor(0.9444, device='cuda:2')
compute distance is  tensor(96.7726, device='cuda:2')
compute similarity is  tensor(0.9448, device='cuda:2')
compute distance is  tensor(92.9324, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
calculated distance threshold is  tensor(139.4624, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8453166668229901
====================
====================
iteration is  0
round is  1
accuracy is  0.8398833334896569
====================
====================
iteration is  0
round is  2
accuracy is  0.8236833334896577
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6035333334896708
====================
====================
iteration is  1
round is  1
accuracy is  0.3331666668230067
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6591333334896664
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3277166668230067
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2232500001563374
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.24465000015633814
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2628166668230053
====================
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.2232, device='cuda:2')
test acc is  0.2232500001563374
test loss is 20.72403181844683
test entropy is  0.06758553445386861
________________________________
cal_distance is  tensor(451.8773, device='cuda:2')
cal_distance is  tensor(139.4632, device='cuda:2')
cal_distance is  tensor(43.0430, device='cuda:2')
________________________________
test distance is  tensor(43.0430, device='cuda:2')
test similarity is  tensor(0.9918, device='cuda:2')
test acc is  0.8870000001563219
test loss is 0.39908038959828523
test entropy is  0.1638841031790415
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1638841031790415
avg test loss is  0.39908038959828523
avg accuracy is  0.8870000001563219
compute_distance is  tensor(43.0430, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2858729554868456
avg test loss is  4.831528697949229
avg accuracy is  0.20941666682300347
compute_distance is  tensor(47.0519, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(47.0519, device='cuda:2')
test similarity is  tensor(0.9908, device='cuda:2')
test acc is  0.20941666682300347
test loss is 4.831528697949229
test entropy is  0.2858729554868456
________________________________
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 88.54% 

Test Accuracy: 87.56% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.7815693616867065
attack res is True
len of model dicts is  12
compute distance is  tensor(90.5590, device='cuda:2')
compute similarity is  tensor(0.9508, device='cuda:2')
compute distance is  tensor(103.2281, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(96.7858, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(98.7890, device='cuda:2')
compute similarity is  tensor(0.9423, device='cuda:2')
compute distance is  tensor(95.7603, device='cuda:2')
compute similarity is  tensor(0.9488, device='cuda:2')
compute distance is  tensor(96.6207, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(96.3339, device='cuda:2')
compute similarity is  tensor(0.9472, device='cuda:2')
compute distance is  tensor(91.6077, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(92.5825, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(105.0935, device='cuda:2')
compute similarity is  tensor(0.9409, device='cuda:2')
compute distance is  tensor(101.3399, device='cuda:2')
compute similarity is  tensor(0.9420, device='cuda:2')
compute distance is  tensor(92.3041, device='cuda:2')
compute similarity is  tensor(0.9482, device='cuda:2')
calculated distance threshold is  tensor(145.2016, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8074000001563251
====================
====================
iteration is  0
round is  1
accuracy is  0.8401166668229904
====================
====================
iteration is  0
round is  2
accuracy is  0.8374166668229903
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6422333334896677
====================
====================
iteration is  1
round is  1
accuracy is  0.6945500001563308
====================
====================
iteration is  1
round is  2
accuracy is  0.5275500001563422
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3621833334896739
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3025000001563396
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.23583333348967114
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.33245000015634013
====================
====================
iteration is  3
round is  1
accuracy is  0.40161666682300784
====================
________________________________
test distance is  tensor(1474.4319, device='cuda:2')
test similarity is  tensor(0.2198, device='cuda:2')
test acc is  0.23583333348967114
test loss is 22.209693791769716
test entropy is  0.06148102096538109
________________________________
cal_distance is  tensor(462.6990, device='cuda:2')
cal_distance is  tensor(145.2023, device='cuda:2')
cal_distance is  tensor(45.5672, device='cuda:2')
________________________________
test distance is  tensor(45.5672, device='cuda:2')
test similarity is  tensor(0.9911, device='cuda:2')
test acc is  0.8893500001563218
test loss is 0.39666306729446343
test entropy is  0.1509633114906961
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1509633114906961
avg test loss is  0.39666306729446343
avg accuracy is  0.8893500001563218
compute_distance is  tensor(45.5672, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.29637865590324786
avg test loss is  4.419775841078525
avg accuracy is  0.2281833334896708
compute_distance is  tensor(49.6980, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(49.6980, device='cuda:2')
test similarity is  tensor(0.9898, device='cuda:2')
test acc is  0.2281833334896708
test loss is 4.419775841078525
test entropy is  0.29637865590324786
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 88.37% 

Test Accuracy: 87.42% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.8222150802612305
attack res is True
len of model dicts is  12
compute distance is  tensor(92.3032, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(101.0200, device='cuda:2')
compute similarity is  tensor(0.9436, device='cuda:2')
compute distance is  tensor(96.5570, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
compute distance is  tensor(98.8176, device='cuda:2')
compute similarity is  tensor(0.9449, device='cuda:2')
compute distance is  tensor(106.2661, device='cuda:2')
compute similarity is  tensor(0.9436, device='cuda:2')
compute distance is  tensor(98.6322, device='cuda:2')
compute similarity is  tensor(0.9468, device='cuda:2')
compute distance is  tensor(99.3787, device='cuda:2')
compute similarity is  tensor(0.9449, device='cuda:2')
compute distance is  tensor(93.8463, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(95.4169, device='cuda:2')
compute similarity is  tensor(0.9488, device='cuda:2')
compute distance is  tensor(105.6122, device='cuda:2')
compute similarity is  tensor(0.9416, device='cuda:2')
compute distance is  tensor(100.7380, device='cuda:2')
compute similarity is  tensor(0.9448, device='cuda:2')
compute distance is  tensor(92.7028, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
calculated distance threshold is  tensor(150.0467, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8390333334896571
====================
====================
iteration is  0
round is  1
accuracy is  0.8449500001563236
====================
====================
iteration is  0
round is  2
accuracy is  0.832600000156324
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5230333334896755
====================
====================
iteration is  1
round is  1
accuracy is  0.498450000156342
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.44718333348967493
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2446166668230047
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.28028333348967244
====================
====================
iteration is  2
round is  2
accuracy is  0.2622166668230052
====================
________________________________
test distance is  tensor(1475.0065, device='cuda:2')
test similarity is  tensor(0.2215, device='cuda:2')
test acc is  0.2446166668230047
test loss is 20.684031129645895
test entropy is  0.061153116956678855
________________________________
cal_distance is  tensor(470.4470, device='cuda:2')
cal_distance is  tensor(150.0474, device='cuda:2')
cal_distance is  tensor(47.8574, device='cuda:2')
________________________________
test distance is  tensor(47.8574, device='cuda:2')
test similarity is  tensor(0.9904, device='cuda:2')
test acc is  0.8904500001563218
test loss is 0.3822479649726897
test entropy is  0.16215561812461565
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16215561812461565
avg test loss is  0.3822479649726897
avg accuracy is  0.8904500001563218
compute_distance is  tensor(47.8574, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2492417531894214
avg test loss is  4.336581224063312
avg accuracy is  0.23575000015633774
compute_distance is  tensor(51.2321, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(51.2321, device='cuda:2')
test similarity is  tensor(0.9897, device='cuda:2')
test acc is  0.23575000015633774
test loss is 4.336581224063312
test entropy is  0.2492417531894214
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 88.58% 

Test Accuracy: 87.72% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.851664662361145
attack res is True
len of model dicts is  12
compute distance is  tensor(93.1069, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(101.3389, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(93.9429, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(100.2571, device='cuda:2')
compute similarity is  tensor(0.9442, device='cuda:2')
compute distance is  tensor(97.6880, device='cuda:2')
compute similarity is  tensor(0.9509, device='cuda:2')
compute distance is  tensor(90.9972, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(99.5934, device='cuda:2')
compute similarity is  tensor(0.9458, device='cuda:2')
compute distance is  tensor(89.1120, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(86.1772, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(93.0749, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(96.7504, device='cuda:2')
compute similarity is  tensor(0.9491, device='cuda:2')
compute distance is  tensor(87.9577, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
calculated distance threshold is  tensor(155.1478, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8517333334896565
====================
====================
iteration is  0
round is  1
accuracy is  0.8640000001563227
====================
====================
iteration is  0
round is  2
accuracy is  0.8296166668229907
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6330666668230016
====================
====================
iteration is  1
round is  1
accuracy is  0.5209666668230089
====================
====================
iteration is  1
round is  2
accuracy is  0.4750666668230086
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.24943333348967156
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.254266666823005
====================
====================
iteration is  2
round is  2
accuracy is  0.20406666682300326
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.308383333489673
====================
________________________________
test distance is  tensor(1463.7548, device='cuda:2')
test similarity is  tensor(0.2343, device='cuda:2')
test acc is  0.20406666682300326
test loss is 23.645039586878536
test entropy is  0.04805985911474275
________________________________
cal_distance is  tensor(476.5489, device='cuda:2')
cal_distance is  tensor(155.1486, device='cuda:2')
cal_distance is  tensor(50.5116, device='cuda:2')
________________________________
test distance is  tensor(50.5116, device='cuda:2')
test similarity is  tensor(0.9895, device='cuda:2')
test acc is  0.8904500001563218
test loss is 0.38785104187471525
test entropy is  0.15727620891162328
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15727620891162328
avg test loss is  0.38785104187471525
avg accuracy is  0.8904500001563218
compute_distance is  tensor(50.5116, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20252930323706506
avg test loss is  4.662969046818422
avg accuracy is  0.1676333334896679
compute_distance is  tensor(51.1575, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(51.1575, device='cuda:2')
test similarity is  tensor(0.9899, device='cuda:2')
test acc is  0.1676333334896679
test loss is 4.662969046818422
test entropy is  0.20252930323706506
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 88.20% 

Test Accuracy: 87.45% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.9350367784500122
attack res is True
len of model dicts is  12
compute distance is  tensor(98.2248, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(107.9481, device='cuda:2')
compute similarity is  tensor(0.9424, device='cuda:2')
compute distance is  tensor(98.0280, device='cuda:2')
compute similarity is  tensor(0.9495, device='cuda:2')
compute distance is  tensor(116.4904, device='cuda:2')
compute similarity is  tensor(0.9337, device='cuda:2')
compute distance is  tensor(109.8355, device='cuda:2')
compute similarity is  tensor(0.9420, device='cuda:2')
compute distance is  tensor(108.3268, device='cuda:2')
compute similarity is  tensor(0.9411, device='cuda:2')
compute distance is  tensor(95.7584, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(91.5066, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(91.6027, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(104.0892, device='cuda:2')
compute similarity is  tensor(0.9493, device='cuda:2')
compute distance is  tensor(105.0728, device='cuda:2')
compute similarity is  tensor(0.9437, device='cuda:2')
compute distance is  tensor(99.8523, device='cuda:2')
compute similarity is  tensor(0.9492, device='cuda:2')
calculated distance threshold is  tensor(216.5234, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8170500001563247
====================
====================
iteration is  0
round is  1
accuracy is  0.8341500001563238
====================
====================
iteration is  0
round is  2
accuracy is  0.8302666668229908
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4761166668230085
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6578000001563333
====================
====================
iteration is  1
round is  2
accuracy is  0.5039833334896754
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.18790000015633573
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.17368333348966825
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.4692166668230084
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.1298500001563319
====================
succ_min + 1
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.2349, device='cuda:2')
test acc is  0.1298500001563319
test loss is 25.03322282477991
test entropy is  0.03335371634148226
________________________________
cal_distance is  tensor(563.9590, device='cuda:2')
cal_distance is  tensor(216.5241, device='cuda:2')
cal_distance is  tensor(83.1317, device='cuda:2')
________________________________
test distance is  tensor(83.1317, device='cuda:2')
test similarity is  tensor(0.9739, device='cuda:2')
test acc is  0.8881833334896551
test loss is 0.4199437248045956
test entropy is  0.15009784302128149
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15009784302128149
avg test loss is  0.4199437248045956
avg accuracy is  0.8881833334896551
compute_distance is  tensor(83.1317, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13237363118320894
avg test loss is  5.72963122518332
avg accuracy is  0.1206666668229986
compute_distance is  tensor(75.3789, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(75.3789, device='cuda:2')
test similarity is  tensor(0.9804, device='cuda:2')
test acc is  0.1206666668229986
test loss is 5.72963122518332
test entropy is  0.13237363118320894
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.60% 

Test Accuracy: 87.90% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.9666247367858887
attack res is True
len of model dicts is  12
compute distance is  tensor(94.9874, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(104.5955, device='cuda:2')
compute similarity is  tensor(0.9460, device='cuda:2')
compute distance is  tensor(97.5980, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(107.0928, device='cuda:2')
compute similarity is  tensor(0.9421, device='cuda:2')
compute distance is  tensor(101.8339, device='cuda:2')
compute similarity is  tensor(0.9484, device='cuda:2')
compute distance is  tensor(94.6980, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(104.6333, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(90.0405, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(90.8150, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(97.8844, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(105.5730, device='cuda:2')
compute similarity is  tensor(0.9454, device='cuda:2')
compute distance is  tensor(92.9231, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
calculated distance threshold is  tensor(183.9019, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8295833334896574
====================
====================
iteration is  0
round is  1
accuracy is  0.825166666822991
====================
====================
iteration is  0
round is  2
accuracy is  0.8252500001563243
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6188000001563361
====================
====================
iteration is  1
round is  1
accuracy is  0.43180000015634146
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.368183333489674
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.22096666682300395
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.18575000015633567
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3356666668230069
====================
________________________________
test distance is  tensor(1467.4282, device='cuda:2')
test similarity is  tensor(0.2401, device='cuda:2')
test acc is  0.18575000015633567
test loss is 27.256159581101016
test entropy is  0.054714406107260444
________________________________
cal_distance is  tensor(519.4838, device='cuda:2')
cal_distance is  tensor(183.9026, device='cuda:2')
cal_distance is  tensor(65.1038, device='cuda:2')
________________________________
test distance is  tensor(65.1038, device='cuda:2')
test similarity is  tensor(0.9840, device='cuda:2')
test acc is  0.891883333489655
test loss is 0.40791119237158346
test entropy is  0.1371153873135286
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1371153873135286
avg test loss is  0.40791119237158346
avg accuracy is  0.891883333489655
compute_distance is  tensor(65.1038, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24445948543261364
avg test loss is  5.5358711814067005
avg accuracy is  0.16791666682300121
compute_distance is  tensor(65.1379, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(65.1379, device='cuda:2')
test similarity is  tensor(0.9850, device='cuda:2')
test acc is  0.16791666682300121
test loss is 5.5358711814067005
test entropy is  0.24445948543261364
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.31% 

Test Accuracy: 87.24% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.0537827014923096
attack res is True
len of model dicts is  12
compute distance is  tensor(88.8117, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
compute distance is  tensor(111.2992, device='cuda:2')
compute similarity is  tensor(0.9435, device='cuda:2')
compute distance is  tensor(104.7340, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(107.6580, device='cuda:2')
compute similarity is  tensor(0.9449, device='cuda:2')
compute distance is  tensor(117.1688, device='cuda:2')
compute similarity is  tensor(0.9400, device='cuda:2')
compute distance is  tensor(93.9735, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(100.5126, device='cuda:2')
compute similarity is  tensor(0.9531, device='cuda:2')
compute distance is  tensor(104.1210, device='cuda:2')
compute similarity is  tensor(0.9509, device='cuda:2')
compute distance is  tensor(98.7983, device='cuda:2')
compute similarity is  tensor(0.9529, device='cuda:2')
compute distance is  tensor(102.9685, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(103.6496, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(102.7142, device='cuda:2')
compute similarity is  tensor(0.9507, device='cuda:2')
calculated distance threshold is  tensor(260.5070, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8402666668229903
====================
====================
iteration is  0
round is  1
accuracy is  0.8036166668229919
====================
====================
iteration is  0
round is  2
accuracy is  0.8236333334896576
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6705833334896658
====================
====================
iteration is  1
round is  1
accuracy is  0.6481166668230004
====================
====================
iteration is  1
round is  2
accuracy is  0.5953833334896713
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3097500001563398
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.19381666682300272
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.15371666682300017
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.4060000001563412
====================
====================
iteration is  3
round is  1
accuracy is  0.368983333489674
====================
________________________________
test distance is  tensor(1476.5106, device='cuda:2')
test similarity is  tensor(0.2424, device='cuda:2')
test acc is  0.15371666682300017
test loss is 28.642234611104545
test entropy is  0.0285222356237207
________________________________
cal_distance is  tensor(620.1951, device='cuda:2')
cal_distance is  tensor(260.5077, device='cuda:2')
cal_distance is  tensor(109.4243, device='cuda:2')
________________________________
test distance is  tensor(109.4243, device='cuda:2')
test similarity is  tensor(0.9590, device='cuda:2')
test acc is  0.8861000001563218
test loss is 0.43817762375624575
test entropy is  0.14332940796020824
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14332940796020824
avg test loss is  0.43817762375624575
avg accuracy is  0.8861000001563218
compute_distance is  tensor(109.4243, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1246976117843758
avg test loss is  5.325675373138395
avg accuracy is  0.1457333334896661
compute_distance is  tensor(96.2500, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(96.2500, device='cuda:2')
test similarity is  tensor(0.9704, device='cuda:2')
test acc is  0.1457333334896661
test loss is 5.325675373138395
test entropy is  0.1246976117843758
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.48% 

Test Accuracy: 87.81% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.0739219188690186
attack res is True
len of model dicts is  12
compute distance is  tensor(89.6698, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(105.1231, device='cuda:2')
compute similarity is  tensor(0.9467, device='cuda:2')
compute distance is  tensor(95.7900, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(102.0887, device='cuda:2')
compute similarity is  tensor(0.9504, device='cuda:2')
compute distance is  tensor(104.5361, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(97.4089, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(97.0341, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(95.9492, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(102.1167, device='cuda:2')
compute similarity is  tensor(0.9511, device='cuda:2')
compute distance is  tensor(98.7146, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(97.3750, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(94.0406, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
calculated distance threshold is  tensor(192.5923, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8470500001563235
====================
====================
iteration is  0
round is  1
accuracy is  0.8576333334896563
====================
====================
iteration is  0
round is  2
accuracy is  0.8464833334896568
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.693500000156331
====================
====================
iteration is  1
round is  1
accuracy is  0.2794166668230057
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5519333334896751
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.18971666682300253
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2174333334896705
====================
====================
iteration is  2
round is  2
accuracy is  0.3136666668230065
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.29301666682300603
====================
________________________________
test distance is  tensor(1467.3604, device='cuda:2')
test similarity is  tensor(0.2498, device='cuda:2')
test acc is  0.18971666682300253
test loss is 28.494370181931615
test entropy is  0.03768869218474099
________________________________
cal_distance is  tensor(531.6040, device='cuda:2')
cal_distance is  tensor(192.5930, device='cuda:2')
cal_distance is  tensor(69.7741, device='cuda:2')
________________________________
test distance is  tensor(69.7741, device='cuda:2')
test similarity is  tensor(0.9829, device='cuda:2')
test acc is  0.8929500001563216
test loss is 0.40966568254172675
test entropy is  0.1372496640162745
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1372496640162745
avg test loss is  0.40966568254172675
avg accuracy is  0.8929500001563216
compute_distance is  tensor(69.7741, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15597481387796433
avg test loss is  5.650998575092633
avg accuracy is  0.1795000001563353
compute_distance is  tensor(65.4758, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(65.4758, device='cuda:2')
test similarity is  tensor(0.9862, device='cuda:2')
test acc is  0.1795000001563353
test loss is 5.650998575092633
test entropy is  0.15597481387796433
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.60% 

Test Accuracy: 87.72% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.084979772567749
attack res is True
len of model dicts is  12
compute distance is  tensor(92.2360, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(98.1112, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(98.0990, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(107.4173, device='cuda:2')
compute similarity is  tensor(0.9462, device='cuda:2')
compute distance is  tensor(100.4126, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(96.8061, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(100.2868, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(100.2369, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(91.2823, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(100.7000, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(100.4536, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(105.0591, device='cuda:2')
compute similarity is  tensor(0.9492, device='cuda:2')
calculated distance threshold is  tensor(209.4913, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8484333334896567
====================
====================
iteration is  0
round is  1
accuracy is  0.8444166668229902
====================
====================
iteration is  0
round is  2
accuracy is  0.8512666668229899
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6051333334896705
====================
====================
iteration is  1
round is  1
accuracy is  0.6430333334896676
====================
====================
iteration is  1
round is  2
accuracy is  0.6997833334896639
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3287500001563401
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3961500001563411
====================
====================
iteration is  2
round is  2
accuracy is  0.1477166668229996
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.11848333348966528
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3165666668230065
====================
________________________________
test distance is  tensor(1461.9250, device='cuda:2')
test similarity is  tensor(0.2370, device='cuda:2')
test acc is  0.11848333348966528
test loss is 42.96338686505869
test entropy is  0.010131173941193453
________________________________
cal_distance is  tensor(553.4088, device='cuda:2')
cal_distance is  tensor(209.4921, device='cuda:2')
cal_distance is  tensor(79.3033, device='cuda:2')
________________________________
test distance is  tensor(79.3033, device='cuda:2')
test similarity is  tensor(0.9781, device='cuda:2')
test acc is  0.8922500001563216
test loss is 0.41321223631882464
test entropy is  0.13538421114195764
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13538421114195764
avg test loss is  0.41321223631882464
avg accuracy is  0.8922500001563216
compute_distance is  tensor(79.3033, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.05048321125043957
avg test loss is  7.093328145012927
avg accuracy is  0.1086833334896653
compute_distance is  tensor(72.1920, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(72.1920, device='cuda:2')
test similarity is  tensor(0.9834, device='cuda:2')
test acc is  0.1086833334896653
test loss is 7.093328145012927
test entropy is  0.05048321125043957
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.70% 

Test Accuracy: 87.77% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.122927188873291
attack res is True
len of model dicts is  12
compute distance is  tensor(95.9397, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(112.8188, device='cuda:2')
compute similarity is  tensor(0.9452, device='cuda:2')
compute distance is  tensor(113.1035, device='cuda:2')
compute similarity is  tensor(0.9437, device='cuda:2')
compute distance is  tensor(105.2074, device='cuda:2')
compute similarity is  tensor(0.9471, device='cuda:2')
compute distance is  tensor(101.8137, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(101.8234, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
compute distance is  tensor(103.0725, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(96.2598, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(100.9197, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(107.8563, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(98.2404, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(93.2050, device='cuda:2')
compute similarity is  tensor(0.9608, device='cuda:2')
calculated distance threshold is  tensor(253.5649, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8577833334896563
====================
====================
iteration is  0
round is  1
accuracy is  0.8061166668229919
====================
====================
iteration is  0
round is  2
accuracy is  0.8317833334896574
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5517500001563418
====================
====================
iteration is  1
round is  1
accuracy is  0.5139333334896755
====================
====================
iteration is  1
round is  2
accuracy is  0.4581500001563417
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4404000001563415
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.4503166668230083
====================
====================
iteration is  2
round is  2
accuracy is  0.2795666668230058
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.21178333348967024
====================
succ_min + 1
________________________________
test distance is  tensor(1472.9342, device='cuda:2')
test similarity is  tensor(0.2456, device='cuda:2')
test acc is  0.21178333348967024
test loss is 24.160419600350515
test entropy is  0.07452135027519294
________________________________
cal_distance is  tensor(611.1342, device='cuda:2')
cal_distance is  tensor(253.5655, device='cuda:2')
cal_distance is  tensor(105.2071, device='cuda:2')
________________________________
test distance is  tensor(105.2071, device='cuda:2')
test similarity is  tensor(0.9633, device='cuda:2')
test acc is  0.8901166668229884
test loss is 0.42394540410465015
test entropy is  0.1336574998737843
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1336574998737843
avg test loss is  0.42394540410465015
avg accuracy is  0.8901166668229884
compute_distance is  tensor(105.2071, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.31426965964755527
avg test loss is  4.990088403606212
avg accuracy is  0.1984500001563363
compute_distance is  tensor(95.4694, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(95.4694, device='cuda:2')
test similarity is  tensor(0.9721, device='cuda:2')
test acc is  0.1984500001563363
test loss is 4.990088403606212
test entropy is  0.31426965964755527
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.55% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.154258966445923
attack res is True
len of model dicts is  12
compute distance is  tensor(91.4602, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(110.9918, device='cuda:2')
compute similarity is  tensor(0.9453, device='cuda:2')
compute distance is  tensor(105.1521, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(107.5080, device='cuda:2')
compute similarity is  tensor(0.9485, device='cuda:2')
compute distance is  tensor(107.0009, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(108.6355, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(108.2408, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(101.8182, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(103.9899, device='cuda:2')
compute similarity is  tensor(0.9527, device='cuda:2')
compute distance is  tensor(107.7306, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(97.3172, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(101.7796, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
calculated distance threshold is  tensor(264.6025, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8384833334896571
====================
====================
iteration is  0
round is  1
accuracy is  0.8599333334896562
====================
====================
iteration is  0
round is  2
accuracy is  0.8558166668229897
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.46895000015634175
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6530333334896669
====================
====================
iteration is  1
round is  2
accuracy is  0.5271500001563422
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.11405000015633195
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.32845000015634007
====================
====================
iteration is  2
round is  2
accuracy is  0.26635000015633875
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.18993333348966926
====================
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.2515, device='cuda:2')
test acc is  0.11405000015633195
test loss is 35.297166978880796
test entropy is  0.02524695173725049
________________________________
cal_distance is  tensor(624.6842, device='cuda:2')
cal_distance is  tensor(264.6031, device='cuda:2')
cal_distance is  tensor(112.0806, device='cuda:2')
________________________________
test distance is  tensor(112.0806, device='cuda:2')
test similarity is  tensor(0.9596, device='cuda:2')
test acc is  0.8884666668229885
test loss is 0.4295200430261873
test entropy is  0.13580182461199095
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13580182461199095
avg test loss is  0.4295200430261873
avg accuracy is  0.8884666668229885
compute_distance is  tensor(112.0806, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1346331496141168
avg test loss is  6.742213161261097
avg accuracy is  0.10816666682299864
compute_distance is  tensor(99.0515, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(99.0515, device='cuda:2')
test similarity is  tensor(0.9705, device='cuda:2')
test acc is  0.10816666682299864
test loss is 6.742213161261097
test entropy is  0.1346331496141168
________________________________
num2 of attacker is  0
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.79% 

Test Accuracy: 87.97% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.1669390201568604
attack res is True
len of model dicts is  12
compute distance is  tensor(87.8655, device='cuda:2')
compute similarity is  tensor(0.9643, device='cuda:2')
compute distance is  tensor(101.6785, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(105.0234, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(107.3851, device='cuda:2')
compute similarity is  tensor(0.9484, device='cuda:2')
compute distance is  tensor(103.1658, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(102.5396, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(104.4076, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
compute distance is  tensor(92.9799, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(94.6807, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(100.1301, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(101.1699, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(102.2471, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
calculated distance threshold is  tensor(278.2060, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8480000001563234
====================
====================
iteration is  0
round is  1
accuracy is  0.8404833334896571
====================
====================
iteration is  0
round is  2
accuracy is  0.8473000001563235
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6850333334896649
====================
====================
iteration is  1
round is  1
accuracy is  0.5093500001563421
====================
====================
iteration is  1
round is  2
accuracy is  0.5761333334896729
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.24748333348967153
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2749333334896723
====================
====================
iteration is  2
round is  2
accuracy is  0.19301666682300275
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.41996666682300804
====================
====================
iteration is  3
round is  1
accuracy is  0.2609000001563386
====================
________________________________
test distance is  tensor(1470.2416, device='cuda:2')
test similarity is  tensor(0.2549, device='cuda:2')
test acc is  0.19301666682300275
test loss is 24.46062911548086
test entropy is  0.03758920556076292
________________________________
cal_distance is  tensor(639.5549, device='cuda:2')
cal_distance is  tensor(278.2066, device='cuda:2')
cal_distance is  tensor(121.0202, device='cuda:2')
________________________________
test distance is  tensor(121.0202, device='cuda:2')
test similarity is  tensor(0.9536, device='cuda:2')
test acc is  0.8899166668229884
test loss is 0.4320679973326385
test entropy is  0.1308971749606735
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1308971749606735
avg test loss is  0.4320679973326385
avg accuracy is  0.8899166668229884
compute_distance is  tensor(121.0202, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1701855774261931
avg test loss is  4.708520669418611
avg accuracy is  0.16951666682300134
compute_distance is  tensor(105.5935, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(105.5935, device='cuda:2')
test similarity is  tensor(0.9667, device='cuda:2')
test acc is  0.16951666682300134
test loss is 4.708520669418611
test entropy is  0.1701855774261931
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 87.83% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.1899702548980713
attack res is True
len of model dicts is  12
compute distance is  tensor(91.0589, device='cuda:2')
compute similarity is  tensor(0.9622, device='cuda:2')
compute distance is  tensor(105.9562, device='cuda:2')
compute similarity is  tensor(0.9535, device='cuda:2')
compute distance is  tensor(110.3109, device='cuda:2')
compute similarity is  tensor(0.9485, device='cuda:2')
compute distance is  tensor(114.7342, device='cuda:2')
compute similarity is  tensor(0.9437, device='cuda:2')
compute distance is  tensor(107.8760, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(101.9148, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(101.2315, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(93.9581, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(94.3123, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
compute distance is  tensor(103.8382, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(104.3596, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(99.6034, device='cuda:2')
compute similarity is  tensor(0.9556, device='cuda:2')
calculated distance threshold is  tensor(345.0091, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8460833334896568
====================
====================
iteration is  0
round is  1
accuracy is  0.8462000001563235
====================
====================
iteration is  0
round is  2
accuracy is  0.8343833334896573
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3283666668230067
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.606000000156337
====================
====================
iteration is  1
round is  2
accuracy is  0.4642333334896751
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2788666668230057
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.1807000001563354
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.23376666682300437
====================
________________________________
test distance is  tensor(1470.5564, device='cuda:2')
test similarity is  tensor(0.2610, device='cuda:2')
test acc is  0.1807000001563354
test loss is 32.68740597055919
test entropy is  0.031187594296467273
________________________________
cal_distance is  tensor(712.2892, device='cuda:2')
cal_distance is  tensor(345.0098, device='cuda:2')
cal_distance is  tensor(167.1117, device='cuda:2')
________________________________
test distance is  tensor(167.1117, device='cuda:2')
test similarity is  tensor(0.9182, device='cuda:2')
test acc is  0.8858000001563219
test loss is 0.4874894807158884
test entropy is  0.11982801188426867
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11982801188426867
avg test loss is  0.4874894807158884
avg accuracy is  0.8858000001563219
compute_distance is  tensor(167.1117, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16251623352516942
avg test loss is  5.8185304446515245
avg accuracy is  0.18218333348966878
compute_distance is  tensor(141.7724, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(141.7724, device='cuda:2')
test similarity is  tensor(0.9427, device='cuda:2')
test acc is  0.18218333348966878
test loss is 5.8185304446515245
test entropy is  0.16251623352516942
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.73% 

Test Accuracy: 87.85% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.219162702560425
attack res is True
len of model dicts is  12
compute distance is  tensor(102.2004, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(101.7007, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(102.7992, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(110.5272, device='cuda:2')
compute similarity is  tensor(0.9477, device='cuda:2')
compute distance is  tensor(109.3825, device='cuda:2')
compute similarity is  tensor(0.9521, device='cuda:2')
compute distance is  tensor(102.6023, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(105.3642, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(101.3664, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(104.2858, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(103.8906, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(114.5134, device='cuda:2')
compute similarity is  tensor(0.9455, device='cuda:2')
compute distance is  tensor(103.5961, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
calculated distance threshold is  tensor(256.4881, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8386000001563237
====================
====================
iteration is  0
round is  1
accuracy is  0.854950000156323
====================
====================
iteration is  0
round is  2
accuracy is  0.8497333334896566
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5560500001563414
====================
====================
iteration is  1
round is  1
accuracy is  0.45718333348967505
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6337333334896682
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2627666668230053
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.16095000015633412
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.41900000015634137
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2061166668230034
====================
________________________________
test distance is  tensor(1467.1898, device='cuda:2')
test similarity is  tensor(0.2600, device='cuda:2')
test acc is  0.16095000015633412
test loss is 30.077644309509537
test entropy is  0.03876503244705641
________________________________
cal_distance is  tensor(613.4470, device='cuda:2')
cal_distance is  tensor(256.4888, device='cuda:2')
cal_distance is  tensor(107.2410, device='cuda:2')
________________________________
test distance is  tensor(107.2410, device='cuda:2')
test similarity is  tensor(0.9642, device='cuda:2')
test acc is  0.892033333489655
test loss is 0.4421787631632423
test entropy is  0.11875733324110127
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11875733324110127
avg test loss is  0.4421787631632423
avg accuracy is  0.892033333489655
compute_distance is  tensor(107.2410, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.224792443374708
avg test loss is  5.5056618027595565
avg accuracy is  0.1513500001563333
compute_distance is  tensor(97.2125, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(97.2125, device='cuda:2')
test similarity is  tensor(0.9730, device='cuda:2')
test acc is  0.1513500001563333
test loss is 5.5056618027595565
test entropy is  0.224792443374708
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 88.73% 

Test Accuracy: 87.85% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.2444522380828857
attack res is True
len of model dicts is  12
compute distance is  tensor(92.7803, device='cuda:2')
compute similarity is  tensor(0.9621, device='cuda:2')
compute distance is  tensor(109.5837, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(104.6786, device='cuda:2')
compute similarity is  tensor(0.9531, device='cuda:2')
compute distance is  tensor(107.6312, device='cuda:2')
compute similarity is  tensor(0.9513, device='cuda:2')
compute distance is  tensor(112.5050, device='cuda:2')
compute similarity is  tensor(0.9495, device='cuda:2')
compute distance is  tensor(113.6849, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(104.4722, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(95.3839, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(98.0012, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(107.6509, device='cuda:2')
compute similarity is  tensor(0.9533, device='cuda:2')
compute distance is  tensor(107.1647, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
compute distance is  tensor(97.5458, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
calculated distance threshold is  tensor(364.0993, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8454833334896568
====================
====================
iteration is  0
round is  1
accuracy is  0.8515166668229899
====================
====================
iteration is  0
round is  2
accuracy is  0.8575833334896564
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.43606666682300815
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7124166668229965
====================
====================
iteration is  1
round is  2
accuracy is  0.43208333348967476
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.1525500001563334
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.16855000015633467
====================
====================
iteration is  2
round is  2
accuracy is  0.14058333348966565
====================
succ_min + 1
________________________________
test distance is  tensor(1474.4863, device='cuda:2')
test similarity is  tensor(0.2546, device='cuda:2')
test acc is  0.14058333348966565
test loss is 25.42069370050166
test entropy is  0.030313426012005498
________________________________
cal_distance is  tensor(732.7073, device='cuda:2')
cal_distance is  tensor(364.0998, device='cuda:2')
cal_distance is  tensor(180.9301, device='cuda:2')
________________________________
test distance is  tensor(180.9301, device='cuda:2')
test similarity is  tensor(0.9079, device='cuda:2')
test acc is  0.8880666668229885
test loss is 0.43853818989797694
test entropy is  0.13580586922082946
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13580586922082946
avg test loss is  0.43853818989797694
avg accuracy is  0.8880666668229885
compute_distance is  tensor(180.9301, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1475170362256229
avg test loss is  5.5986159381581775
avg accuracy is  0.12258333348966527
compute_distance is  tensor(152.1472, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(152.1472, device='cuda:2')
test similarity is  tensor(0.9357, device='cuda:2')
test acc is  0.12258333348966527
test loss is 5.5986159381581775
test entropy is  0.1475170362256229
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 87.86% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.267413377761841
attack res is True
len of model dicts is  12
compute distance is  tensor(102.3259, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(111.8714, device='cuda:2')
compute similarity is  tensor(0.9468, device='cuda:2')
compute distance is  tensor(104.2719, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(104.6558, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(107.3808, device='cuda:2')
compute similarity is  tensor(0.9535, device='cuda:2')
compute distance is  tensor(96.8916, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(110.9352, device='cuda:2')
compute similarity is  tensor(0.9506, device='cuda:2')
compute distance is  tensor(102.2843, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(95.8046, device='cuda:2')
compute similarity is  tensor(0.9625, device='cuda:2')
compute distance is  tensor(102.6046, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(102.9114, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(104.0239, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
calculated distance threshold is  tensor(325.1873, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.833650000156324
====================
====================
iteration is  0
round is  1
accuracy is  0.8613000001563229
====================
====================
iteration is  0
round is  2
accuracy is  0.8599666668229895
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6314000001563351
====================
====================
iteration is  1
round is  1
accuracy is  0.6651833334896662
====================
====================
iteration is  1
round is  2
accuracy is  0.6639333334896661
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.22958333348967092
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.36771666682300735
====================
====================
iteration is  2
round is  2
accuracy is  0.28728333348967255
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.18418333348966898
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3823666668230075
====================
________________________________
test distance is  tensor(1469.3538, device='cuda:2')
test similarity is  tensor(0.2632, device='cuda:2')
test acc is  0.18418333348966898
test loss is 28.756108351099467
test entropy is  0.041382305439996485
________________________________
cal_distance is  tensor(691.2421, device='cuda:2')
cal_distance is  tensor(325.1879, device='cuda:2')
cal_distance is  tensor(152.9816, device='cuda:2')
________________________________
test distance is  tensor(152.9816, device='cuda:2')
test similarity is  tensor(0.9326, device='cuda:2')
test acc is  0.8892500001563217
test loss is 0.45614722967227256
test entropy is  0.12171569539666939
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12171569539666939
avg test loss is  0.45614722967227256
avg accuracy is  0.8892500001563217
compute_distance is  tensor(152.9816, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20568233467876784
avg test loss is  4.9351094780700295
avg accuracy is  0.17085000015633472
compute_distance is  tensor(130.5764, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(130.5764, device='cuda:2')
test similarity is  tensor(0.9527, device='cuda:2')
test acc is  0.17085000015633472
test loss is 4.9351094780700295
test entropy is  0.20568233467876784
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.67% 

Test Accuracy: 87.91% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.2956714630126953
attack res is True
len of model dicts is  12
compute distance is  tensor(100.1599, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(109.3875, device='cuda:2')
compute similarity is  tensor(0.9525, device='cuda:2')
compute distance is  tensor(103.0464, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(112.2201, device='cuda:2')
compute similarity is  tensor(0.9477, device='cuda:2')
compute distance is  tensor(118.1710, device='cuda:2')
compute similarity is  tensor(0.9464, device='cuda:2')
compute distance is  tensor(99.3354, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(109.4984, device='cuda:2')
compute similarity is  tensor(0.9531, device='cuda:2')
compute distance is  tensor(104.3690, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(97.8840, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(100.2542, device='cuda:2')
compute similarity is  tensor(0.9608, device='cuda:2')
compute distance is  tensor(109.6190, device='cuda:2')
compute similarity is  tensor(0.9506, device='cuda:2')
compute distance is  tensor(102.6263, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
calculated distance threshold is  tensor(416.4810, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8478833334896567
====================
====================
iteration is  0
round is  1
accuracy is  0.8394333334896569
====================
====================
iteration is  0
round is  2
accuracy is  0.8514000001563232
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5827166668230056
====================
====================
iteration is  1
round is  1
accuracy is  0.5441000001563424
====================
====================
iteration is  1
round is  2
accuracy is  0.4903666668230086
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.15191666682299998
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.13598333348966524
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.16373333348966765
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2028500001563365
====================
________________________________
test distance is  tensor(1468.6365, device='cuda:2')
test similarity is  tensor(0.2577, device='cuda:2')
test acc is  0.13598333348966524
test loss is 32.04390582956993
test entropy is  0.016517508261265103
________________________________
cal_distance is  tensor(782.0868, device='cuda:2')
cal_distance is  tensor(416.4816, device='cuda:2')
cal_distance is  tensor(221.7874, device='cuda:2')
________________________________
test distance is  tensor(221.7874, device='cuda:2')
test similarity is  tensor(0.8733, device='cuda:2')
test acc is  0.8817333334896554
test loss is 0.4830754586437872
test entropy is  0.1354452875067494
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1354452875067494
avg test loss is  0.4830754586437872
avg accuracy is  0.8817333334896554
compute_distance is  tensor(221.7874, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.06593196290030853
avg test loss is  6.55550465654971
avg accuracy is  0.11948333348966528
compute_distance is  tensor(182.6297, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(182.6297, device='cuda:2')
test similarity is  tensor(0.9120, device='cuda:2')
test acc is  0.11948333348966528
test loss is 6.55550465654971
test entropy is  0.06593196290030853
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 88.87% 

Test Accuracy: 87.93% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.317044496536255
attack res is True
len of model dicts is  12
compute distance is  tensor(95.1058, device='cuda:2')
compute similarity is  tensor(0.9626, device='cuda:2')
compute distance is  tensor(107.4466, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(104.0557, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(109.5715, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
compute distance is  tensor(115.9359, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
compute distance is  tensor(107.3241, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(109.9546, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(103.3635, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(103.9641, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(104.9399, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(112.2606, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(102.9732, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
calculated distance threshold is  tensor(454.9451, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.84896666682299
====================
====================
iteration is  0
round is  1
accuracy is  0.8565833334896564
====================
====================
iteration is  0
round is  2
accuracy is  0.8520666668229899
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5874000001563386
====================
====================
iteration is  1
round is  1
accuracy is  0.6036000001563373
====================
====================
iteration is  1
round is  2
accuracy is  0.5148833334896755
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.27315000015633895
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.13685000015633195
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.14513333348966603
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.26143333348967196
====================
====================
iteration is  3
round is  1
accuracy is  0.1657166668230011
====================
________________________________
test distance is  tensor(1456.0988, device='cuda:2')
test similarity is  tensor(0.2575, device='cuda:2')
test acc is  0.13685000015633195
test loss is 26.476019182184867
test entropy is  0.033055024136399935
________________________________
cal_distance is  tensor(813.9077, device='cuda:2')
cal_distance is  tensor(454.9457, device='cuda:2')
cal_distance is  tensor(254.2988, device='cuda:2')
________________________________
test distance is  tensor(254.2988, device='cuda:2')
test similarity is  tensor(0.8429, device='cuda:2')
test acc is  0.8772666668229889
test loss is 0.49687934605710543
test entropy is  0.1335230553582279
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1335230553582279
avg test loss is  0.49687934605710543
avg accuracy is  0.8772666668229889
compute_distance is  tensor(254.2988, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1604980553851834
avg test loss is  5.718325394303052
avg accuracy is  0.1319666668229986
compute_distance is  tensor(211.0914, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(211.0914, device='cuda:2')
test similarity is  tensor(0.8875, device='cuda:2')
test acc is  0.1319666668229986
test loss is 5.718325394303052
test entropy is  0.1604980553851834
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.63% 

Test Accuracy: 87.86% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.348409414291382
attack res is True
len of model dicts is  12
compute distance is  tensor(99.2128, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(104.0148, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(106.5628, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(111.9757, device='cuda:2')
compute similarity is  tensor(0.9498, device='cuda:2')
compute distance is  tensor(114.4452, device='cuda:2')
compute similarity is  tensor(0.9506, device='cuda:2')
compute distance is  tensor(110.8227, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(106.1320, device='cuda:2')
compute similarity is  tensor(0.9576, device='cuda:2')
compute distance is  tensor(104.7646, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(97.3660, device='cuda:2')
compute similarity is  tensor(0.9612, device='cuda:2')
compute distance is  tensor(105.1309, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(104.4286, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(100.3223, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
calculated distance threshold is  tensor(421.9115, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8553000001563231
====================
====================
iteration is  0
round is  1
accuracy is  0.8504666668229899
====================
====================
iteration is  0
round is  2
accuracy is  0.842033333489657
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4958166668230087
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5911333334896717
====================
====================
iteration is  1
round is  2
accuracy is  0.5322666668230089
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.36065000015634063
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.18078333348966868
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.19498333348966948
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.20811666682300353
====================
________________________________
test distance is  tensor(1482.3743, device='cuda:2')
test similarity is  tensor(0.2599, device='cuda:2')
test acc is  0.18078333348966868
test loss is 26.491502340922732
test entropy is  0.024452190401595655
________________________________
cal_distance is  tensor(790.8422, device='cuda:2')
cal_distance is  tensor(421.9120, device='cuda:2')
cal_distance is  tensor(225.0890, device='cuda:2')
________________________________
test distance is  tensor(225.0890, device='cuda:2')
test similarity is  tensor(0.8734, device='cuda:2')
test acc is  0.8734333334896557
test loss is 0.5142726689132292
test entropy is  0.14430517650870625
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14430517650870625
avg test loss is  0.5142726689132292
avg accuracy is  0.8734333334896557
compute_distance is  tensor(225.0890, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.08808364879204901
avg test loss is  6.58885465959496
avg accuracy is  0.17111666682300142
compute_distance is  tensor(185.3758, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(185.3758, device='cuda:2')
test similarity is  tensor(0.9117, device='cuda:2')
test acc is  0.17111666682300142
test loss is 6.58885465959496
test entropy is  0.08808364879204901
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 88.79% 

Test Accuracy: 87.93% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.3642923831939697
attack res is True
len of model dicts is  12
compute distance is  tensor(98.1483, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(117.4196, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
compute distance is  tensor(109.4425, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(106.3002, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(108.5572, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(103.3358, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(112.4683, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(95.9206, device='cuda:2')
compute similarity is  tensor(0.9649, device='cuda:2')
compute distance is  tensor(99.2171, device='cuda:2')
compute similarity is  tensor(0.9625, device='cuda:2')
compute distance is  tensor(111.6487, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(104.0607, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(95.8553, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
calculated distance threshold is  tensor(546.6057, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8640500001563227
====================
====================
iteration is  0
round is  1
accuracy is  0.8463666668229901
====================
====================
iteration is  0
round is  2
accuracy is  0.8614500001563228
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4908166668230087
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6729333334896656
====================
====================
iteration is  1
round is  2
accuracy is  0.6738000001563322
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.32926666682300676
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.15820000015633387
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.33303333348967346
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.23398333348967107
====================
________________________________
test distance is  tensor(1459.0068, device='cuda:2')
test similarity is  tensor(0.2708, device='cuda:2')
test acc is  0.15820000015633387
test loss is 27.215945632218805
test entropy is  0.037414988449244485
________________________________
cal_distance is  tensor(893.0297, device='cuda:2')
cal_distance is  tensor(546.6062, device='cuda:2')
cal_distance is  tensor(334.5672, device='cuda:2')
________________________________
test distance is  tensor(334.5672, device='cuda:2')
test similarity is  tensor(0.7727, device='cuda:2')
test acc is  0.8527666668229898
test loss is 0.6969464402844403
test entropy is  0.1417314572684737
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1417314572684737
avg test loss is  0.6969464402844403
avg accuracy is  0.8527666668229898
compute_distance is  tensor(334.5672, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1273131189442901
avg test loss is  6.5299873641813235
avg accuracy is  0.14246666682299913
compute_distance is  tensor(273.3994, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(273.3994, device='cuda:2')
test similarity is  tensor(0.8330, device='cuda:2')
test acc is  0.14246666682299913
test loss is 6.5299873641813235
test entropy is  0.1273131189442901
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 88.70% 

Test Accuracy: 88.14% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.390977382659912
attack res is True
len of model dicts is  12
compute distance is  tensor(100.3286, device='cuda:2')
compute similarity is  tensor(0.9608, device='cuda:2')
compute distance is  tensor(104.4395, device='cuda:2')
compute similarity is  tensor(0.9593, device='cuda:2')
compute distance is  tensor(112.9542, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(114.9042, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(111.3385, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(103.0546, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(107.5191, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(106.0183, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(106.8955, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(104.2003, device='cuda:2')
compute similarity is  tensor(0.9593, device='cuda:2')
compute distance is  tensor(105.3219, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(104.7963, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
calculated distance threshold is  tensor(435.4634, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8618166668229895
====================
====================
iteration is  0
round is  1
accuracy is  0.8452166668229902
====================
====================
iteration is  0
round is  2
accuracy is  0.838233333489657
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6950666668229977
====================
====================
iteration is  1
round is  1
accuracy is  0.6277833334896686
====================
====================
iteration is  1
round is  2
accuracy is  0.47370000015634184
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.21513333348967034
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.20808333348967004
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.10698333348966531
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2630500001563387
====================
________________________________
test distance is  tensor(1467.8129, device='cuda:2')
test similarity is  tensor(0.2680, device='cuda:2')
test acc is  0.10698333348966531
test loss is 37.86213722920367
test entropy is  0.0072177929646363445
________________________________
cal_distance is  tensor(799.4870, device='cuda:2')
cal_distance is  tensor(435.4640, device='cuda:2')
cal_distance is  tensor(237.1884, device='cuda:2')
________________________________
test distance is  tensor(237.1884, device='cuda:2')
test similarity is  tensor(0.8651, device='cuda:2')
test acc is  0.876966666822989
test loss is 0.5129780868397974
test entropy is  0.13550129597152727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13550129597152727
avg test loss is  0.5129780868397974
avg accuracy is  0.876966666822989
compute_distance is  tensor(237.1884, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.03372086558951688
avg test loss is  7.664163370884812
avg accuracy is  0.10343333348966531
compute_distance is  tensor(194.6403, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(194.6403, device='cuda:2')
test similarity is  tensor(0.9062, device='cuda:2')
test acc is  0.10343333348966531
test loss is 7.664163370884812
test entropy is  0.03372086558951688
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 88.12% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.416126251220703
attack res is True
len of model dicts is  12
compute distance is  tensor(101.0116, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(108.9292, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(106.8190, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(116.0969, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(116.4529, device='cuda:2')
compute similarity is  tensor(0.9513, device='cuda:2')
compute distance is  tensor(104.8134, device='cuda:2')
compute similarity is  tensor(0.9596, device='cuda:2')
compute distance is  tensor(118.4981, device='cuda:2')
compute similarity is  tensor(0.9489, device='cuda:2')
compute distance is  tensor(99.1800, device='cuda:2')
compute similarity is  tensor(0.9612, device='cuda:2')
compute distance is  tensor(102.9146, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(112.7768, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(106.3604, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(102.0183, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
calculated distance threshold is  tensor(587.7776, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8434000001563235
====================
====================
iteration is  0
round is  1
accuracy is  0.8672166668229893
====================
====================
iteration is  0
round is  2
accuracy is  0.84826666682299
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6669166668229993
====================
====================
iteration is  1
round is  1
accuracy is  0.48231666682300856
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7218166668229961
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2408833334896713
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.17548333348966846
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.32665000015634
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2357666668230045
====================
________________________________
test distance is  tensor(1472.8862, device='cuda:2')
test similarity is  tensor(0.2757, device='cuda:2')
test acc is  0.17548333348966846
test loss is 24.6800325298106
test entropy is  0.05819216001925787
________________________________
cal_distance is  tensor(930.4462, device='cuda:2')
cal_distance is  tensor(587.7781, device='cuda:2')
cal_distance is  tensor(371.3091, device='cuda:2')
________________________________
test distance is  tensor(371.3091, device='cuda:2')
test similarity is  tensor(0.7449, device='cuda:2')
test acc is  0.8456333334896567
test loss is 0.7166068635737972
test entropy is  0.13968710655739694
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13968710655739694
avg test loss is  0.7166068635737972
avg accuracy is  0.8456333334896567
compute_distance is  tensor(371.3091, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1952421523169922
avg test loss is  6.3611260497493785
avg accuracy is  0.17386666682300164
compute_distance is  tensor(304.9975, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(304.9975, device='cuda:2')
test similarity is  tensor(0.8076, device='cuda:2')
test acc is  0.17386666682300164
test loss is 6.3611260497493785
test entropy is  0.1952421523169922
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 88.79% 

Test Accuracy: 87.96% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.431528329849243
attack res is True
len of model dicts is  12
compute distance is  tensor(105.8924, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(116.5876, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(115.6336, device='cuda:2')
compute similarity is  tensor(0.9498, device='cuda:2')
compute distance is  tensor(110.8119, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(112.2252, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(106.9853, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(103.6014, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(95.9975, device='cuda:2')
compute similarity is  tensor(0.9648, device='cuda:2')
compute distance is  tensor(100.4162, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(108.4066, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(101.5245, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(104.5319, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
calculated distance threshold is  tensor(668.8445, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8531166668229898
====================
====================
iteration is  0
round is  1
accuracy is  0.8609500001563228
====================
====================
iteration is  0
round is  2
accuracy is  0.8311833334896574
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4005500001563411
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4998166668230087
====================
====================
iteration is  1
round is  2
accuracy is  0.5972333334896711
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3390666668230068
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2276166668230042
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.17045000015633477
====================
succ_min + 1
________________________________
test distance is  tensor(1468.4832, device='cuda:2')
test similarity is  tensor(0.2764, device='cuda:2')
test acc is  0.17045000015633477
test loss is 30.35940258538545
test entropy is  0.030398018134416324
________________________________
cal_distance is  tensor(991.0536, device='cuda:2')
cal_distance is  tensor(668.8450, device='cuda:2')
cal_distance is  tensor(451.3920, device='cuda:2')
________________________________
test distance is  tensor(451.3920, device='cuda:2')
test similarity is  tensor(0.6781, device='cuda:2')
test acc is  0.8255333334896576
test loss is 0.9616058829909703
test entropy is  0.1359096325234945
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1359096325234945
avg test loss is  0.9616058829909703
avg accuracy is  0.8255333334896576
compute_distance is  tensor(451.3920, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.09177248865397754
avg test loss is  8.264110434538265
avg accuracy is  0.17031666682300142
compute_distance is  tensor(364.7620, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(364.7620, device='cuda:2')
test similarity is  tensor(0.7535, device='cuda:2')
test acc is  0.17031666682300142
test loss is 8.264110434538265
test entropy is  0.09177248865397754
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 88.94% 

Test Accuracy: 87.99% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.4513497352600098
attack res is True
len of model dicts is  12
compute distance is  tensor(95.4760, device='cuda:2')
compute similarity is  tensor(0.9639, device='cuda:2')
compute distance is  tensor(112.1300, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(111.2266, device='cuda:2')
compute similarity is  tensor(0.9542, device='cuda:2')
compute distance is  tensor(108.4813, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(110.4266, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(110.6519, device='cuda:2')
compute similarity is  tensor(0.9560, device='cuda:2')
compute distance is  tensor(116.7186, device='cuda:2')
compute similarity is  tensor(0.9525, device='cuda:2')
compute distance is  tensor(102.6431, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(105.8602, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(102.3929, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(104.8737, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(100.4241, device='cuda:2')
compute similarity is  tensor(0.9636, device='cuda:2')
calculated distance threshold is  tensor(745.5773, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8199166668229912
====================
====================
iteration is  0
round is  1
accuracy is  0.8544166668229898
====================
====================
iteration is  0
round is  2
accuracy is  0.8607333334896562
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6184166668230028
====================
====================
iteration is  1
round is  1
accuracy is  0.457383333489675
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.49365000015634203
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4308833334896748
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2996333334896728
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.15913333348966735
====================
succ_min + 1
________________________________
test distance is  tensor(1467.3906, device='cuda:2')
test similarity is  tensor(0.2642, device='cuda:2')
test acc is  0.15913333348966735
test loss is 27.58414500100272
test entropy is  0.03786482121363512
________________________________
cal_distance is  tensor(1045.9702, device='cuda:2')
cal_distance is  tensor(745.5777, device='cuda:2')
cal_distance is  tensor(531.4551, device='cuda:2')
________________________________
test distance is  tensor(531.4551, device='cuda:2')
test similarity is  tensor(0.6114, device='cuda:2')
test acc is  0.8061000001563252
test loss is 1.0893949107892478
test entropy is  0.13816111319974414
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13816111319974414
avg test loss is  1.0893949107892478
avg accuracy is  0.8061000001563252
compute_distance is  tensor(531.4551, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10168583728849634
avg test loss is  8.570943231013283
avg accuracy is  0.1538666668230002
compute_distance is  tensor(428.1290, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(428.1290, device='cuda:2')
test similarity is  tensor(0.6933, device='cuda:2')
test acc is  0.1538666668230002
test loss is 8.570943231013283
test entropy is  0.10168583728849634
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 87.92% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.4769115447998047
attack res is True
len of model dicts is  12
compute distance is  tensor(108.2412, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(105.1362, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(110.4679, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(114.7544, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(125.4967, device='cuda:2')
compute similarity is  tensor(0.9442, device='cuda:2')
compute distance is  tensor(112.4952, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(110.2101, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(108.0453, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(110.1410, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(112.8720, device='cuda:2')
compute similarity is  tensor(0.9560, device='cuda:2')
compute distance is  tensor(104.8563, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(108.4615, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
calculated distance threshold is  tensor(799.6950, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8557000001563231
====================
====================
iteration is  0
round is  1
accuracy is  0.855700000156323
====================
====================
iteration is  0
round is  2
accuracy is  0.8643500001563227
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.495850000156342
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6433833334896675
====================
====================
iteration is  1
round is  2
accuracy is  0.5204833334896756
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3838166668230075
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3738000001563408
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.28763333348967257
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.1345666668229986
====================
succ_min + 1
________________________________
test distance is  tensor(1477.8457, device='cuda:2')
test similarity is  tensor(0.2735, device='cuda:2')
test acc is  0.1345666668229986
test loss is 33.64982653782566
test entropy is  0.01262518712364753
________________________________
cal_distance is  tensor(1087.1184, device='cuda:2')
cal_distance is  tensor(799.6953, device='cuda:2')
cal_distance is  tensor(588.2641, device='cuda:2')
________________________________
test distance is  tensor(588.2642, device='cuda:2')
test similarity is  tensor(0.5806, device='cuda:2')
test acc is  0.6619166668229994
test loss is 2.2783902018690414
test entropy is  0.17068148158919583
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17068148158919583
avg test loss is  2.2783902018690414
avg accuracy is  0.6619166668229994
compute_distance is  tensor(588.2642, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.03083653541987758
avg test loss is  12.07596178095478
avg accuracy is  0.12770000015633193
compute_distance is  tensor(468.7259, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(468.7259, device='cuda:2')
test similarity is  tensor(0.6671, device='cuda:2')
test acc is  0.12770000015633193
test loss is 12.07596178095478
test entropy is  0.03083653541987758
________________________________
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 88.89% 

Test Accuracy: 87.93% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.504272222518921
attack res is True
len of model dicts is  12
compute distance is  tensor(95.0097, device='cuda:2')
compute similarity is  tensor(0.9674, device='cuda:2')
compute distance is  tensor(110.7303, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(110.9053, device='cuda:2')
compute similarity is  tensor(0.9560, device='cuda:2')
compute distance is  tensor(115.5206, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(114.3893, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(114.1469, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(117.9202, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(100.1938, device='cuda:2')
compute similarity is  tensor(0.9643, device='cuda:2')
compute distance is  tensor(101.4372, device='cuda:2')
compute similarity is  tensor(0.9618, device='cuda:2')
compute distance is  tensor(103.2955, device='cuda:2')
compute similarity is  tensor(0.9632, device='cuda:2')
compute distance is  tensor(109.8256, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(108.8496, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
calculated distance threshold is  tensor(943.3890, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8547166668229897
====================
====================
iteration is  0
round is  1
accuracy is  0.8700666668229893
====================
====================
iteration is  0
round is  2
accuracy is  0.8644666668229894
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5967000001563378
====================
====================
iteration is  1
round is  1
accuracy is  0.4640000001563418
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6357166668230015
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.11683333348966526
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.38613333348967427
====================
====================
iteration is  2
round is  2
accuracy is  0.12783333348966525
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.3135666668230065
====================
________________________________
test distance is  tensor(1478.0778, device='cuda:2')
test similarity is  tensor(0.2675, device='cuda:2')
test acc is  0.11683333348966526
test loss is 36.809444600331
test entropy is  0.01472538945174033
________________________________
cal_distance is  tensor(1180.8484, device='cuda:2')
cal_distance is  tensor(943.3893, device='cuda:2')
cal_distance is  tensor(753.6815, device='cuda:2')
________________________________
test distance is  tensor(753.6815, device='cuda:2')
test similarity is  tensor(0.4835, device='cuda:2')
test acc is  0.4059833334896745
test loss is 6.355516733137021
test entropy is  0.15353506716933332
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 88.72% 

Test Accuracy: 87.86% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.5509912967681885
attack res is True
len of model dicts is  12
compute distance is  tensor(97.1658, device='cuda:2')
compute similarity is  tensor(0.9658, device='cuda:2')
compute distance is  tensor(110.2896, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(114.3900, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(120.1247, device='cuda:2')
compute similarity is  tensor(0.9505, device='cuda:2')
compute distance is  tensor(111.7541, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(115.3309, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(117.2989, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(110.5471, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(104.1408, device='cuda:2')
compute similarity is  tensor(0.9618, device='cuda:2')
compute distance is  tensor(117.1203, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(111.2406, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(102.1330, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
calculated distance threshold is  tensor(1032.3589, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8548500001563231
====================
====================
iteration is  0
round is  1
accuracy is  0.8157500001563247
====================
====================
iteration is  0
round is  2
accuracy is  0.8549166668229897
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7556500001563274
====================
====================
iteration is  1
round is  1
accuracy is  0.5782333334896728
====================
====================
iteration is  1
round is  2
accuracy is  0.4980833334896754
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3417833334896736
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.15308333348966674
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.2349000001563378
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.33553333348967346
====================
________________________________
test distance is  tensor(1471.9059, device='cuda:2')
test similarity is  tensor(0.2797, device='cuda:2')
test acc is  0.15308333348966674
test loss is 31.81617259572564
test entropy is  0.05963899343332121
________________________________
cal_distance is  tensor(1232.6945, device='cuda:2')
cal_distance is  tensor(1032.3591, device='cuda:2')
cal_distance is  tensor(864.5821, device='cuda:2')
________________________________
test distance is  tensor(864.5821, device='cuda:2')
test similarity is  tensor(0.4441, device='cuda:2')
test acc is  0.368883333489674
test loss is 7.998470338931216
test entropy is  0.19696438068678893
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 88.97% 

Test Accuracy: 87.84% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.5640954971313477
attack res is True
len of model dicts is  12
compute distance is  tensor(102.5498, device='cuda:2')
compute similarity is  tensor(0.9623, device='cuda:2')
compute distance is  tensor(111.5960, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(108.6945, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(113.3497, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(118.8641, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(111.3072, device='cuda:2')
compute similarity is  tensor(0.9593, device='cuda:2')
compute distance is  tensor(108.4402, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(101.8376, device='cuda:2')
compute similarity is  tensor(0.9638, device='cuda:2')
compute distance is  tensor(113.3761, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(111.7726, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(106.5379, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(107.9658, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
calculated distance threshold is  tensor(864.7382, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8428500001563237
====================
====================
iteration is  0
round is  1
accuracy is  0.8625000001563229
====================
====================
iteration is  0
round is  2
accuracy is  0.8700833334896558
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.673650000156332
====================
====================
iteration is  1
round is  1
accuracy is  0.5978666668230045
====================
====================
iteration is  1
round is  2
accuracy is  0.7200333334896627
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2910500001563394
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.32280000015634
====================
====================
iteration is  2
round is  2
accuracy is  0.2875166668230059
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.29090000015633943
====================
====================
iteration is  3
round is  1
accuracy is  0.18858333348966916
====================
succ_min + 1
________________________________
test distance is  tensor(1463.8168, device='cuda:2')
test similarity is  tensor(0.2895, device='cuda:2')
test acc is  0.18858333348966916
test loss is 28.57112450182819
test entropy is  0.03379871209163461
________________________________
cal_distance is  tensor(1125.0861, device='cuda:2')
cal_distance is  tensor(864.7384, device='cuda:2')
cal_distance is  tensor(664.6359, device='cuda:2')
________________________________
test distance is  tensor(664.6360, device='cuda:2')
test similarity is  tensor(0.5479, device='cuda:2')
test acc is  0.6595166668229997
test loss is 2.5790253034405617
test entropy is  0.16724678631752793
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16724678631752793
avg test loss is  2.5790253034405617
avg accuracy is  0.6595166668229997
compute_distance is  tensor(664.6360, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.07989276907861487
avg test loss is  10.22925809553183
avg accuracy is  0.20048333348966976
compute_distance is  tensor(530.0775, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(530.0775, device='cuda:2')
test similarity is  tensor(0.6329, device='cuda:2')
test acc is  0.20048333348966976
test loss is 10.22925809553183
test entropy is  0.07989276907861487
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 87.87% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.5806097984313965
attack res is True
len of model dicts is  12
compute distance is  tensor(104.3139, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(112.9679, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(104.6544, device='cuda:2')
compute similarity is  tensor(0.9626, device='cuda:2')
compute distance is  tensor(115.5106, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(108.9471, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(110.1339, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(109.7835, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(104.7601, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(102.7400, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(111.9164, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(114.2891, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(111.3021, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
calculated distance threshold is  tensor(732.1718, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8635500001563228
====================
====================
iteration is  0
round is  1
accuracy is  0.8673166668229892
====================
====================
iteration is  0
round is  2
accuracy is  0.8670333334896559
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6632833334896663
====================
====================
iteration is  1
round is  1
accuracy is  0.636233333489668
====================
====================
iteration is  1
round is  2
accuracy is  0.6422500001563343
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.1670833334896679
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.22853333348967084
====================
====================
iteration is  2
round is  2
accuracy is  0.1957000001563362
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2240333334896707
====================
====================
iteration is  3
round is  1
accuracy is  0.23320000015633774
====================
________________________________
test distance is  tensor(1479.6971, device='cuda:2')
test similarity is  tensor(0.2753, device='cuda:2')
test acc is  0.1670833334896679
test loss is 34.6536981444369
test entropy is  0.03207685031958157
________________________________
cal_distance is  tensor(1040.8616, device='cuda:2')
cal_distance is  tensor(732.1722, device='cuda:2')
cal_distance is  tensor(515.0311, device='cuda:2')
________________________________
test distance is  tensor(515.0311, device='cuda:2')
test similarity is  tensor(0.6396, device='cuda:2')
test acc is  0.7888666668229926
test loss is 1.3145487128036109
test entropy is  0.1395445739917918
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1395445739917918
avg test loss is  1.3145487128036109
avg accuracy is  0.7888666668229926
compute_distance is  tensor(515.0311, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.09822759485797587
avg test loss is  10.408344973379107
avg accuracy is  0.17031666682300142
compute_distance is  tensor(414.4845, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(414.4845, device='cuda:2')
test similarity is  tensor(0.7197, device='cuda:2')
test acc is  0.17031666682300142
test loss is 10.408344973379107
test entropy is  0.09822759485797587
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 88.99% 

Test Accuracy: 87.92% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.5858590602874756
attack res is True
len of model dicts is  12
compute distance is  tensor(102.5225, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(114.2168, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(116.6328, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(114.8205, device='cuda:2')
compute similarity is  tensor(0.9532, device='cuda:2')
compute distance is  tensor(111.4319, device='cuda:2')
compute similarity is  tensor(0.9597, device='cuda:2')
compute distance is  tensor(104.8790, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(108.8546, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
compute distance is  tensor(105.1752, device='cuda:2')
compute similarity is  tensor(0.9631, device='cuda:2')
compute distance is  tensor(95.0335, device='cuda:2')
compute similarity is  tensor(0.9687, device='cuda:2')
compute distance is  tensor(112.5768, device='cuda:2')
compute similarity is  tensor(0.9576, device='cuda:2')
compute distance is  tensor(111.7956, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(112.4195, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
calculated distance threshold is  tensor(1266.0630, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.867783333489656
====================
====================
iteration is  0
round is  1
accuracy is  0.8610666668229895
====================
====================
iteration is  0
round is  2
accuracy is  0.8649833334896561
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6943666668229975
====================
====================
iteration is  1
round is  1
accuracy is  0.6355500001563348
====================
====================
iteration is  1
round is  2
accuracy is  0.6520000001563336
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3248333334896733
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.22450000015633748
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.22446666682300415
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.19883333348966972
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.21048333348967022
====================
________________________________
test distance is  tensor(1478.6414, device='cuda:2')
test similarity is  tensor(0.2760, device='cuda:2')
test acc is  0.19883333348966972
test loss is 24.50776911900242
test entropy is  0.0653208970133938
________________________________
cal_distance is  tensor(1368.2300, device='cuda:2')
cal_distance is  tensor(1266.0632, device='cuda:2')
cal_distance is  tensor(1171.5251, device='cuda:2')
________________________________
test distance is  tensor(1171.5251, device='cuda:2')
test similarity is  tensor(0.3418, device='cuda:2')
test acc is  0.2760666668230057
test loss is 13.767144498032039
test entropy is  0.10677573788982592
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 89.03% 

Test Accuracy: 88.05% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.600165843963623
attack res is True
len of model dicts is  12
compute distance is  tensor(105.8960, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(106.0268, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
compute distance is  tensor(115.2402, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(118.7594, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(110.6846, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(107.7693, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
compute distance is  tensor(101.9271, device='cuda:2')
compute similarity is  tensor(0.9661, device='cuda:2')
compute distance is  tensor(115.2727, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(98.8508, device='cuda:2')
compute similarity is  tensor(0.9667, device='cuda:2')
compute distance is  tensor(110.3404, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(116.8921, device='cuda:2')
compute similarity is  tensor(0.9525, device='cuda:2')
compute distance is  tensor(108.4946, device='cuda:2')
compute similarity is  tensor(0.9608, device='cuda:2')
calculated distance threshold is  tensor(1286.1501, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8573333334896563
====================
====================
iteration is  0
round is  1
accuracy is  0.85041666682299
====================
====================
iteration is  0
round is  2
accuracy is  0.8699166668229893
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5863000001563387
====================
====================
iteration is  1
round is  1
accuracy is  0.7209500001563293
====================
====================
iteration is  1
round is  2
accuracy is  0.5919000001563384
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.17395000015633502
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2956666668230061
====================
====================
iteration is  2
round is  2
accuracy is  0.12968333348966526
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.38001666682300755
====================
====================
iteration is  3
round is  1
accuracy is  0.17865000015633528
====================
________________________________
test distance is  tensor(1460.7107, device='cuda:2')
test similarity is  tensor(0.2820, device='cuda:2')
test acc is  0.12968333348966526
test loss is 31.670540443615618
test entropy is  0.01763987500362709
________________________________
cal_distance is  tensor(1370.6544, device='cuda:2')
cal_distance is  tensor(1286.1503, device='cuda:2')
cal_distance is  tensor(1206.8561, device='cuda:2')
________________________________
test distance is  tensor(1206.8560, device='cuda:2')
test similarity is  tensor(0.3357, device='cuda:2')
test acc is  0.148050000156333
test loss is 20.738958686145384
test entropy is  0.03589801115109456
________________________________
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 88.99% 

Test Accuracy: 87.92% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.612659215927124
attack res is True
len of model dicts is  12
compute distance is  tensor(97.8862, device='cuda:2')
compute similarity is  tensor(0.9667, device='cuda:2')
compute distance is  tensor(106.6193, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(107.4335, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(114.4771, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(115.7099, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(106.5330, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
compute distance is  tensor(111.5572, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(105.0326, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(102.9894, device='cuda:2')
compute similarity is  tensor(0.9645, device='cuda:2')
compute distance is  tensor(111.4694, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(110.1795, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(110.0193, device='cuda:2')
compute similarity is  tensor(0.9603, device='cuda:2')
calculated distance threshold is  tensor(1267.1523, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8666166668229894
====================
====================
iteration is  0
round is  1
accuracy is  0.8630666668229894
====================
====================
iteration is  0
round is  2
accuracy is  0.8698666668229893
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5787833334896727
====================
====================
iteration is  1
round is  1
accuracy is  0.5755833334896729
====================
====================
iteration is  1
round is  2
accuracy is  0.6651500001563326
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.37981666682300746
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.36498333348967393
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3858666668230076
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.17141666682300147
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2831500001563391
====================
________________________________
test distance is  tensor(1477.3110, device='cuda:2')
test similarity is  tensor(0.2815, device='cuda:2')
test acc is  0.17141666682300147
test loss is 27.757706593348782
test entropy is  0.03764723590525514
________________________________
cal_distance is  tensor(1368.2026, device='cuda:2')
cal_distance is  tensor(1267.1525, device='cuda:2')
cal_distance is  tensor(1173.5656, device='cuda:2')
________________________________
test distance is  tensor(1173.5654, device='cuda:2')
test similarity is  tensor(0.3466, device='cuda:2')
test acc is  0.25335000015633835
test loss is 15.495295839777379
test entropy is  0.07802901682116266
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 88.09% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.6257123947143555
attack res is True
len of model dicts is  12
compute distance is  tensor(97.8251, device='cuda:2')
compute similarity is  tensor(0.9665, device='cuda:2')
compute distance is  tensor(115.6007, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
compute distance is  tensor(116.2833, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(109.8892, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(112.0056, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(109.6232, device='cuda:2')
compute similarity is  tensor(0.9593, device='cuda:2')
compute distance is  tensor(111.0138, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(105.4239, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(107.9944, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(109.5374, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(108.6714, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(108.6592, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
calculated distance threshold is  tensor(1429.8021, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8544000001563231
====================
====================
iteration is  0
round is  1
accuracy is  0.874566666822989
====================
====================
iteration is  0
round is  2
accuracy is  0.8669000001563226
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6388333334896679
====================
====================
iteration is  1
round is  1
accuracy is  0.6570166668229999
====================
====================
iteration is  1
round is  2
accuracy is  0.5506666668230086
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.18025000015633533
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.16605000015633445
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.16185000015633422
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.21050000015633694
====================
====================
iteration is  3
round is  1
accuracy is  0.34598333348967364
====================
________________________________
test distance is  tensor(1473.0646, device='cuda:2')
test similarity is  tensor(0.2845, device='cuda:2')
test acc is  0.16185000015633422
test loss is 32.140694498253275
test entropy is  0.0377162485713584
________________________________
cal_distance is  tensor(1451.2723, device='cuda:2')
cal_distance is  tensor(1429.8022, device='cuda:2')
cal_distance is  tensor(1408.6499, device='cuda:2')
________________________________
test distance is  tensor(1408.6499, device='cuda:2')
test similarity is  tensor(0.2963, device='cuda:2')
test acc is  0.16985000015633475
test loss is 29.346058473404028
test entropy is  0.04202367205407097
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 89.04% 

Test Accuracy: 88.08% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.6384570598602295
attack res is True
len of model dicts is  12
compute distance is  tensor(96.2010, device='cuda:2')
compute similarity is  tensor(0.9676, device='cuda:2')
compute distance is  tensor(105.8553, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(120.2370, device='cuda:2')
compute similarity is  tensor(0.9523, device='cuda:2')
compute distance is  tensor(119.9805, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(112.8072, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(106.4856, device='cuda:2')
compute similarity is  tensor(0.9621, device='cuda:2')
compute distance is  tensor(107.7637, device='cuda:2')
compute similarity is  tensor(0.9617, device='cuda:2')
compute distance is  tensor(98.8294, device='cuda:2')
compute similarity is  tensor(0.9669, device='cuda:2')
compute distance is  tensor(113.7547, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(112.0120, device='cuda:2')
compute similarity is  tensor(0.9603, device='cuda:2')
compute distance is  tensor(110.6107, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(108.6371, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
calculated distance threshold is  tensor(2004.1282, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8614666668229896
====================
====================
iteration is  0
round is  1
accuracy is  0.8666166668229893
====================
====================
iteration is  0
round is  2
accuracy is  0.8641500001563227
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7061166668229969
====================
====================
iteration is  1
round is  1
accuracy is  0.6653000001563328
====================
====================
iteration is  1
round is  2
accuracy is  0.6550333334896667
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.24451666682300477
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.35231666682300716
====================
====================
iteration is  2
round is  2
accuracy is  0.2360833334896712
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.32455000015634
====================
====================
iteration is  3
round is  1
accuracy is  0.18350000015633552
====================
succ_min + 1
________________________________
test distance is  tensor(1454.8018, device='cuda:2')
test similarity is  tensor(0.2814, device='cuda:2')
test acc is  0.18350000015633552
test loss is 29.780110192451396
test entropy is  0.041700954923579
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 87.99% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.65177583694458
attack res is True
len of model dicts is  12
compute distance is  tensor(101.9504, device='cuda:2')
compute similarity is  tensor(0.9647, device='cuda:2')
compute distance is  tensor(120.7586, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(126.1338, device='cuda:2')
compute similarity is  tensor(0.9493, device='cuda:2')
compute distance is  tensor(110.1344, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(123.7522, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(111.5067, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
compute distance is  tensor(114.3707, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(106.0823, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
compute distance is  tensor(105.4188, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(116.9351, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
compute distance is  tensor(116.1280, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(115.5324, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
calculated distance threshold is  tensor(2213.5361, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.867833333489656
====================
====================
iteration is  0
round is  1
accuracy is  0.8632000001563228
====================
====================
iteration is  0
round is  2
accuracy is  0.869033333489656
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6433666668230009
====================
====================
iteration is  1
round is  1
accuracy is  0.6371000001563346
====================
====================
iteration is  1
round is  2
accuracy is  0.674450000156332
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.32445000015633996
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3263333334896733
====================
====================
iteration is  2
round is  2
accuracy is  0.2708833334896722
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.22521666682300412
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.35030000015634044
====================
________________________________
test distance is  tensor(1474.2266, device='cuda:2')
test similarity is  tensor(0.2880, device='cuda:2')
test acc is  0.22521666682300412
test loss is 23.257428150949703
test entropy is  0.05178048855253756
________________________________
num2 of attacker is  0
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 88.08% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.66076922416687
attack res is True
len of model dicts is  12
compute distance is  tensor(106.3680, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(107.4910, device='cuda:2')
compute similarity is  tensor(0.9628, device='cuda:2')
compute distance is  tensor(107.8776, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(123.6258, device='cuda:2')
compute similarity is  tensor(0.9485, device='cuda:2')
compute distance is  tensor(110.7379, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(109.4086, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(112.4624, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(103.1130, device='cuda:2')
compute similarity is  tensor(0.9652, device='cuda:2')
compute distance is  tensor(100.4076, device='cuda:2')
compute similarity is  tensor(0.9664, device='cuda:2')
compute distance is  tensor(111.9698, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(108.3685, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(109.1968, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
calculated distance threshold is  tensor(2330.4431, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8488833334896567
====================
====================
iteration is  0
round is  1
accuracy is  0.8600166668229895
====================
====================
iteration is  0
round is  2
accuracy is  0.8614500001563229
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5073666668230088
====================
====================
iteration is  1
round is  1
accuracy is  0.6384333334896679
====================
====================
iteration is  1
round is  2
accuracy is  0.6592000001563331
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.29955000015633954
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2929333334896727
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3118500001563398
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.29188333348967266
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3857166668230076
====================
________________________________
test distance is  tensor(1479.9604, device='cuda:2')
test similarity is  tensor(0.2881, device='cuda:2')
test acc is  0.29188333348967266
test loss is 17.979747369599494
test entropy is  0.07663253054562916
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 88.03% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.675095796585083
attack res is True
len of model dicts is  12
compute distance is  tensor(99.6911, device='cuda:2')
compute similarity is  tensor(0.9665, device='cuda:2')
compute distance is  tensor(115.8884, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(114.4362, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(117.9655, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(114.0352, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(116.7533, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(112.7307, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(105.9527, device='cuda:2')
compute similarity is  tensor(0.9644, device='cuda:2')
compute distance is  tensor(120.7890, device='cuda:2')
compute similarity is  tensor(0.9512, device='cuda:2')
compute distance is  tensor(111.3526, device='cuda:2')
compute similarity is  tensor(0.9623, device='cuda:2')
compute distance is  tensor(115.2996, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
compute distance is  tensor(109.6581, device='cuda:2')
compute similarity is  tensor(0.9612, device='cuda:2')
calculated distance threshold is  tensor(2328.7249, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8417166668229904
====================
====================
iteration is  0
round is  1
accuracy is  0.8595500001563229
====================
====================
iteration is  0
round is  2
accuracy is  0.8691666668229893
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7174333334896629
====================
====================
iteration is  1
round is  1
accuracy is  0.5883333334896719
====================
====================
iteration is  1
round is  2
accuracy is  0.7250500001563291
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3019833334896729
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2874833334896726
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.40730000015634116
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.39760000015634106
====================
====================
iteration is  3
round is  1
accuracy is  0.21535000015633698
====================
succ_min + 1
________________________________
test distance is  tensor(1469.0477, device='cuda:2')
test similarity is  tensor(0.2818, device='cuda:2')
test acc is  0.21535000015633698
test loss is 28.999156854300104
test entropy is  0.05211399690901388
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.00% 

Test Accuracy: 88.02% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.00%
|----0th round Training Accuracy : 82.79%
|----1th round Training Accuracy : 85.81%
|----2th round Training Accuracy : 86.92%
|----3th round Training Accuracy : 87.41%
|----4th round Training Accuracy : 87.22%
|----5th round Training Accuracy : 87.84%
|----6th round Training Accuracy : 87.94%
|----7th round Training Accuracy : 87.83%
|----8th round Training Accuracy : 88.10%
|----9th round Training Accuracy : 88.32%
|----10th round Training Accuracy : 88.18%
|----11th round Training Accuracy : 88.58%
|----12th round Training Accuracy : 88.17%
|----13th round Training Accuracy : 88.54%
|----14th round Training Accuracy : 88.37%
|----15th round Training Accuracy : 88.58%
|----16th round Training Accuracy : 88.20%
|----17th round Training Accuracy : 88.60%
|----18th round Training Accuracy : 88.31%
|----19th round Training Accuracy : 88.48%
|----20th round Training Accuracy : 88.60%
|----21th round Training Accuracy : 88.70%
|----22th round Training Accuracy : 88.43%
|----23th round Training Accuracy : 88.79%
|----24th round Training Accuracy : 88.82%
|----25th round Training Accuracy : 88.73%
|----26th round Training Accuracy : 88.73%
|----27th round Training Accuracy : 88.83%
|----28th round Training Accuracy : 88.67%
|----29th round Training Accuracy : 88.87%
|----30th round Training Accuracy : 88.63%
|----31th round Training Accuracy : 88.79%
|----32th round Training Accuracy : 88.70%
|----33th round Training Accuracy : 88.83%
|----34th round Training Accuracy : 88.79%
|----35th round Training Accuracy : 88.94%
|----36th round Training Accuracy : 88.88%
|----37th round Training Accuracy : 88.89%
|----38th round Training Accuracy : 88.72%
|----39th round Training Accuracy : 88.97%
|----40th round Training Accuracy : 88.93%
|----41th round Training Accuracy : 88.99%
|----42th round Training Accuracy : 89.03%
|----43th round Training Accuracy : 88.99%
|----44th round Training Accuracy : 88.98%
|----45th round Training Accuracy : 89.04%
|----46th round Training Accuracy : 88.98%
|----47th round Training Accuracy : 89.00%
|----48th round Training Accuracy : 88.88%
|----49th round Training Accuracy : 89.00%
|----Final Test Accuracy: 88.02%
|----0th round Final Test Accuracy : 82.08%
|----1th round Final Test Accuracy : 85.14%
|----2th round Final Test Accuracy : 85.70%
|----3th round Final Test Accuracy : 86.31%
|----4th round Final Test Accuracy : 86.41%
|----5th round Final Test Accuracy : 86.77%
|----6th round Final Test Accuracy : 86.78%
|----7th round Final Test Accuracy : 86.88%
|----8th round Final Test Accuracy : 87.20%
|----9th round Final Test Accuracy : 87.50%
|----10th round Final Test Accuracy : 87.23%
|----11th round Final Test Accuracy : 87.71%
|----12th round Final Test Accuracy : 87.31%
|----13th round Final Test Accuracy : 87.56%
|----14th round Final Test Accuracy : 87.42%
|----15th round Final Test Accuracy : 87.72%
|----16th round Final Test Accuracy : 87.45%
|----17th round Final Test Accuracy : 87.90%
|----18th round Final Test Accuracy : 87.24%
|----19th round Final Test Accuracy : 87.81%
|----20th round Final Test Accuracy : 87.72%
|----21th round Final Test Accuracy : 87.77%
|----22th round Final Test Accuracy : 87.55%
|----23th round Final Test Accuracy : 87.97%
|----24th round Final Test Accuracy : 87.83%
|----25th round Final Test Accuracy : 87.85%
|----26th round Final Test Accuracy : 87.85%
|----27th round Final Test Accuracy : 87.86%
|----28th round Final Test Accuracy : 87.91%
|----29th round Final Test Accuracy : 87.93%
|----30th round Final Test Accuracy : 87.86%
|----31th round Final Test Accuracy : 87.93%
|----32th round Final Test Accuracy : 88.14%
|----33th round Final Test Accuracy : 88.12%
|----34th round Final Test Accuracy : 87.96%
|----35th round Final Test Accuracy : 87.99%
|----36th round Final Test Accuracy : 87.92%
|----37th round Final Test Accuracy : 87.93%
|----38th round Final Test Accuracy : 87.86%
|----39th round Final Test Accuracy : 87.84%
|----40th round Final Test Accuracy : 87.87%
|----41th round Final Test Accuracy : 87.92%
|----42th round Final Test Accuracy : 88.05%
|----43th round Final Test Accuracy : 87.92%
|----44th round Final Test Accuracy : 88.09%
|----45th round Final Test Accuracy : 88.08%
|----46th round Final Test Accuracy : 87.99%
|----47th round Final Test Accuracy : 88.08%
|----48th round Final Test Accuracy : 88.03%
|----49th round Final Test Accuracy : 88.02%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 11281.7165
