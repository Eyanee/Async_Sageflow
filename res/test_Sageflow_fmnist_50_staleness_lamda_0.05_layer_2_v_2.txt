
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
poisoned accuracy threshold is  0.5
len of model dicts is  12
compute distance is  tensor(127.9875, device='cuda:2')
compute similarity is  tensor(0.6047, device='cuda:2')
compute distance is  tensor(125.7784, device='cuda:2')
compute similarity is  tensor(0.6057, device='cuda:2')
compute distance is  tensor(139.8005, device='cuda:2')
compute similarity is  tensor(0.5920, device='cuda:2')
compute distance is  tensor(122.0526, device='cuda:2')
compute similarity is  tensor(0.6119, device='cuda:2')
compute distance is  tensor(129.1455, device='cuda:2')
compute similarity is  tensor(0.6045, device='cuda:2')
compute distance is  tensor(122.5669, device='cuda:2')
compute similarity is  tensor(0.6214, device='cuda:2')
compute distance is  tensor(119.6597, device='cuda:2')
compute similarity is  tensor(0.6333, device='cuda:2')
compute distance is  tensor(133.5154, device='cuda:2')
compute similarity is  tensor(0.6067, device='cuda:2')
compute distance is  tensor(125.8410, device='cuda:2')
compute similarity is  tensor(0.6188, device='cuda:2')
compute distance is  tensor(126.6163, device='cuda:2')
compute similarity is  tensor(0.6137, device='cuda:2')
compute distance is  tensor(122.9006, device='cuda:2')
compute similarity is  tensor(0.6211, device='cuda:2')
compute distance is  tensor(131.0567, device='cuda:2')
compute similarity is  tensor(0.6031, device='cuda:2')
calculated distance threshold is  tensor(159.9413, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.1665833334896678
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.14865000015633315
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.23411666682300442
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.10331666682299863
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.102350000156332
====================
succ_min + 1
________________________________
test distance is  tensor(367.8098, device='cuda:2')
test similarity is  tensor(0.3235, device='cuda:2')
test acc is  0.102350000156332
test loss is 2.3756529321548525
test entropy is  2.093655595393069
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.093655595393069
avg test loss is  2.3756529321548525
avg accuracy is  0.102350000156332
compute_distance is  tensor(367.8098, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5067575523085686
avg test loss is  6.767753224891386
avg accuracy is  0.09720000015633201
compute_distance is  tensor(295.7177, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(295.7177, device='cuda:2')
test similarity is  tensor(0.4034, device='cuda:2')
test acc is  0.09720000015633201
test loss is 6.767753224891386
test entropy is  0.5067575523085686
________________________________
cal_distance is  tensor(217.4798, device='cuda:2')
cal_distance is  tensor(159.9413, device='cuda:2')
________________________________
test distance is  tensor(159.9413, device='cuda:2')
test similarity is  tensor(0.6276, device='cuda:2')
test acc is  0.09778333348966535
test loss is 3.0034057407745167
test entropy is  1.5124671708292037
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 82.77% 

Test Accuracy: 81.64% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(89.0554, device='cuda:2')
compute similarity is  tensor(0.8960, device='cuda:2')
compute distance is  tensor(87.1372, device='cuda:2')
compute similarity is  tensor(0.8990, device='cuda:2')
compute distance is  tensor(90.7542, device='cuda:2')
compute similarity is  tensor(0.8941, device='cuda:2')
compute distance is  tensor(88.2816, device='cuda:2')
compute similarity is  tensor(0.8931, device='cuda:2')
compute distance is  tensor(86.1553, device='cuda:2')
compute similarity is  tensor(0.9048, device='cuda:2')
compute distance is  tensor(90.2067, device='cuda:2')
compute similarity is  tensor(0.8884, device='cuda:2')
compute distance is  tensor(88.1893, device='cuda:2')
compute similarity is  tensor(0.9010, device='cuda:2')
compute distance is  tensor(86.1539, device='cuda:2')
compute similarity is  tensor(0.9005, device='cuda:2')
compute distance is  tensor(87.6146, device='cuda:2')
compute similarity is  tensor(0.8994, device='cuda:2')
compute distance is  tensor(88.9669, device='cuda:2')
compute similarity is  tensor(0.8996, device='cuda:2')
compute distance is  tensor(85.1681, device='cuda:2')
compute similarity is  tensor(0.9033, device='cuda:2')
compute distance is  tensor(88.6418, device='cuda:2')
compute similarity is  tensor(0.8985, device='cuda:2')
calculated distance threshold is  tensor(96.3404, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7500166668229945
====================
====================
iteration is  0
round is  1
accuracy is  0.7711833334896601
====================
====================
iteration is  0
round is  2
accuracy is  0.7928166668229925
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5382000001563423
====================
====================
iteration is  1
round is  1
accuracy is  0.538816666823009
====================
====================
iteration is  1
round is  2
accuracy is  0.4888166668230086
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4874666668230086
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.228383333489671
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.2412166668230047
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.42056666682300803
====================
________________________________
test distance is  tensor(1470.1229, device='cuda:2')
test similarity is  tensor(0.1389, device='cuda:2')
test acc is  0.228383333489671
test loss is 8.46799052193729
test entropy is  0.16467634656790223
________________________________
cal_distance is  tensor(376.3412, device='cuda:2')
cal_distance is  tensor(96.3411, device='cuda:2')
cal_distance is  tensor(24.6632, device='cuda:2')
________________________________
test distance is  tensor(24.6632, device='cuda:2')
test similarity is  tensor(0.9924, device='cuda:2')
test acc is  0.8267166668229908
test loss is 0.4987580435298907
test entropy is  0.6642568614055862
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.6642568614055862
avg test loss is  0.4987580435298907
avg accuracy is  0.8267166668229908
compute_distance is  tensor(24.6632, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3130723330766153
avg test loss is  4.3603246212005615
avg accuracy is  0.21268333348967028
compute_distance is  tensor(30.8951, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(30.8951, device='cuda:2')
test similarity is  tensor(0.9855, device='cuda:2')
test acc is  0.21268333348967028
test loss is 4.3603246212005615
test entropy is  0.3130723330766153
________________________________
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 85.73% 

Test Accuracy: 84.64% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(91.1439, device='cuda:2')
compute similarity is  tensor(0.9080, device='cuda:2')
compute distance is  tensor(86.3505, device='cuda:2')
compute similarity is  tensor(0.9167, device='cuda:2')
compute distance is  tensor(88.0182, device='cuda:2')
compute similarity is  tensor(0.9112, device='cuda:2')
compute distance is  tensor(85.7387, device='cuda:2')
compute similarity is  tensor(0.9090, device='cuda:2')
compute distance is  tensor(84.9602, device='cuda:2')
compute similarity is  tensor(0.9166, device='cuda:2')
compute distance is  tensor(83.4769, device='cuda:2')
compute similarity is  tensor(0.9130, device='cuda:2')
compute distance is  tensor(83.3174, device='cuda:2')
compute similarity is  tensor(0.9159, device='cuda:2')
compute distance is  tensor(89.0626, device='cuda:2')
compute similarity is  tensor(0.9119, device='cuda:2')
compute distance is  tensor(84.2381, device='cuda:2')
compute similarity is  tensor(0.9174, device='cuda:2')
compute distance is  tensor(85.3339, device='cuda:2')
compute similarity is  tensor(0.9146, device='cuda:2')
compute distance is  tensor(84.3985, device='cuda:2')
compute similarity is  tensor(0.9170, device='cuda:2')
compute distance is  tensor(85.4207, device='cuda:2')
compute similarity is  tensor(0.9157, device='cuda:2')
calculated distance threshold is  tensor(98.9705, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7569500001563275
====================
====================
iteration is  0
round is  1
accuracy is  0.7683000001563269
====================
====================
iteration is  0
round is  2
accuracy is  0.780116666822993
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5047000001563421
====================
====================
iteration is  1
round is  1
accuracy is  0.4427666668230082
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.4221500001563413
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3124666668230064
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3458000001563403
====================
====================
iteration is  2
round is  2
accuracy is  0.2255166668230041
====================
succ_min + 1
________________________________
test distance is  tensor(1476.1548, device='cuda:2')
test similarity is  tensor(0.1534, device='cuda:2')
test acc is  0.2255166668230041
test loss is 13.669813203913316
test entropy is  0.13808965196868758
________________________________
cal_distance is  tensor(382.2254, device='cuda:2')
cal_distance is  tensor(98.9712, device='cuda:2')
cal_distance is  tensor(25.6275, device='cuda:2')
________________________________
test distance is  tensor(25.6275, device='cuda:2')
test similarity is  tensor(0.9934, device='cuda:2')
test acc is  0.8552333334896565
test loss is 0.4102133119792572
test entropy is  0.4085385448484024
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.4085385448484024
avg test loss is  0.4102133119792572
avg accuracy is  0.8552333334896565
compute_distance is  tensor(25.6275, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.29652230082544434
avg test loss is  5.358806253242086
avg accuracy is  0.23536666682300447
compute_distance is  tensor(30.8350, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(30.8350, device='cuda:2')
test similarity is  tensor(0.9882, device='cuda:2')
test acc is  0.23536666682300447
test loss is 5.358806253242086
test entropy is  0.29652230082544434
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 86.83% 

Test Accuracy: 85.46% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(78.2422, device='cuda:2')
compute similarity is  tensor(0.9278, device='cuda:2')
compute distance is  tensor(88.4652, device='cuda:2')
compute similarity is  tensor(0.9235, device='cuda:2')
compute distance is  tensor(89.4218, device='cuda:2')
compute similarity is  tensor(0.9165, device='cuda:2')
compute distance is  tensor(84.2644, device='cuda:2')
compute similarity is  tensor(0.9228, device='cuda:2')
compute distance is  tensor(84.8127, device='cuda:2')
compute similarity is  tensor(0.9264, device='cuda:2')
compute distance is  tensor(85.8348, device='cuda:2')
compute similarity is  tensor(0.9191, device='cuda:2')
compute distance is  tensor(84.0761, device='cuda:2')
compute similarity is  tensor(0.9259, device='cuda:2')
compute distance is  tensor(85.2959, device='cuda:2')
compute similarity is  tensor(0.9229, device='cuda:2')
compute distance is  tensor(83.6117, device='cuda:2')
compute similarity is  tensor(0.9256, device='cuda:2')
compute distance is  tensor(83.9023, device='cuda:2')
compute similarity is  tensor(0.9247, device='cuda:2')
compute distance is  tensor(86.3374, device='cuda:2')
compute similarity is  tensor(0.9230, device='cuda:2')
compute distance is  tensor(84.0383, device='cuda:2')
compute similarity is  tensor(0.9254, device='cuda:2')
calculated distance threshold is  tensor(100.6013, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8103166668229916
====================
====================
iteration is  0
round is  1
accuracy is  0.7347666668229952
====================
====================
iteration is  0
round is  2
accuracy is  0.8046333334896586
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6563333334896667
====================
====================
iteration is  1
round is  1
accuracy is  0.5900833334896717
====================
====================
iteration is  1
round is  2
accuracy is  0.504100000156342
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3221666668230066
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.20791666682300344
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.4739500001563418
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2154500001563371
====================
====================
iteration is  3
round is  1
accuracy is  0.27795000015633897
====================
________________________________
test distance is  tensor(1471.5128, device='cuda:2')
test similarity is  tensor(0.1612, device='cuda:2')
test acc is  0.20791666682300344
test loss is 15.58489763507965
test entropy is  0.08408009736482967
________________________________
cal_distance is  tensor(384.7553, device='cuda:2')
cal_distance is  tensor(100.6021, device='cuda:2')
cal_distance is  tensor(26.3049, device='cuda:2')
________________________________
test distance is  tensor(26.3049, device='cuda:2')
test similarity is  tensor(0.9939, device='cuda:2')
test acc is  0.8647000001563228
test loss is 0.3933844262841287
test entropy is  0.3261031918465964
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3261031918465964
avg test loss is  0.3933844262841287
avg accuracy is  0.8647000001563228
compute_distance is  tensor(26.3049, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22025736236273608
avg test loss is  5.481052721487179
avg accuracy is  0.2042833334896699
compute_distance is  tensor(32.1764, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(32.1764, device='cuda:2')
test similarity is  tensor(0.9902, device='cuda:2')
test acc is  0.2042833334896699
test loss is 5.481052721487179
test entropy is  0.22025736236273608
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.13% 

Test Accuracy: 86.13% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(80.6379, device='cuda:2')
compute similarity is  tensor(0.9323, device='cuda:2')
compute distance is  tensor(86.5375, device='cuda:2')
compute similarity is  tensor(0.9289, device='cuda:2')
compute distance is  tensor(87.1806, device='cuda:2')
compute similarity is  tensor(0.9256, device='cuda:2')
compute distance is  tensor(86.6027, device='cuda:2')
compute similarity is  tensor(0.9233, device='cuda:2')
compute distance is  tensor(87.8641, device='cuda:2')
compute similarity is  tensor(0.9265, device='cuda:2')
compute distance is  tensor(83.2560, device='cuda:2')
compute similarity is  tensor(0.9288, device='cuda:2')
compute distance is  tensor(86.8745, device='cuda:2')
compute similarity is  tensor(0.9289, device='cuda:2')
compute distance is  tensor(84.1771, device='cuda:2')
compute similarity is  tensor(0.9296, device='cuda:2')
compute distance is  tensor(81.6491, device='cuda:2')
compute similarity is  tensor(0.9345, device='cuda:2')
compute distance is  tensor(82.9177, device='cuda:2')
compute similarity is  tensor(0.9335, device='cuda:2')
compute distance is  tensor(84.1486, device='cuda:2')
compute similarity is  tensor(0.9310, device='cuda:2')
compute distance is  tensor(81.4915, device='cuda:2')
compute similarity is  tensor(0.9328, device='cuda:2')
calculated distance threshold is  tensor(95.0904, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7956666668229921
====================
====================
iteration is  0
round is  1
accuracy is  0.8238500001563245
====================
====================
iteration is  0
round is  2
accuracy is  0.8161000001563247
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.541116666823009
====================
====================
iteration is  1
round is  1
accuracy is  0.39341666682300763
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.37076666682300735
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.23180000015633773
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.20813333348967009
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.23208333348967097
====================
________________________________
test distance is  tensor(1479.0812, device='cuda:2')
test similarity is  tensor(0.1690, device='cuda:2')
test acc is  0.20813333348967009
test loss is 18.69751243957324
test entropy is  0.06239295117398188
________________________________
cal_distance is  tensor(375.0292, device='cuda:2')
cal_distance is  tensor(95.0912, device='cuda:2')
cal_distance is  tensor(24.1115, device='cuda:2')
________________________________
test distance is  tensor(24.1115, device='cuda:2')
test similarity is  tensor(0.9954, device='cuda:2')
test acc is  0.8699666668229892
test loss is 0.3823146157856308
test entropy is  0.3049850837667105
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3049850837667105
avg test loss is  0.3823146157856308
avg accuracy is  0.8699666668229892
compute_distance is  tensor(24.1115, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1869583634584189
avg test loss is  6.318124077721699
avg accuracy is  0.20033333348966975
compute_distance is  tensor(30.0672, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(30.0672, device='cuda:2')
test similarity is  tensor(0.9914, device='cuda:2')
test acc is  0.20033333348966975
test loss is 6.318124077721699
test entropy is  0.1869583634584189
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.64% 

Test Accuracy: 86.35% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(80.6313, device='cuda:2')
compute similarity is  tensor(0.9368, device='cuda:2')
compute distance is  tensor(93.6450, device='cuda:2')
compute similarity is  tensor(0.9246, device='cuda:2')
compute distance is  tensor(89.1108, device='cuda:2')
compute similarity is  tensor(0.9264, device='cuda:2')
compute distance is  tensor(89.0773, device='cuda:2')
compute similarity is  tensor(0.9236, device='cuda:2')
compute distance is  tensor(90.9893, device='cuda:2')
compute similarity is  tensor(0.9281, device='cuda:2')
compute distance is  tensor(87.3724, device='cuda:2')
compute similarity is  tensor(0.9286, device='cuda:2')
compute distance is  tensor(86.3108, device='cuda:2')
compute similarity is  tensor(0.9318, device='cuda:2')
compute distance is  tensor(83.5148, device='cuda:2')
compute similarity is  tensor(0.9356, device='cuda:2')
compute distance is  tensor(82.8890, device='cuda:2')
compute similarity is  tensor(0.9351, device='cuda:2')
compute distance is  tensor(85.8818, device='cuda:2')
compute similarity is  tensor(0.9333, device='cuda:2')
compute distance is  tensor(87.8115, device='cuda:2')
compute similarity is  tensor(0.9308, device='cuda:2')
compute distance is  tensor(81.9418, device='cuda:2')
compute similarity is  tensor(0.9354, device='cuda:2')
calculated distance threshold is  tensor(106.6588, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7545333334896609
====================
====================
iteration is  0
round is  1
accuracy is  0.8042666668229919
====================
====================
iteration is  0
round is  2
accuracy is  0.7901500001563259
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4712166668230085
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6349166668230014
====================
====================
iteration is  1
round is  2
accuracy is  0.4392166668230082
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.280350000156339
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.17690000015633517
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.2625500001563386
====================
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.1684, device='cuda:2')
test acc is  0.17690000015633517
test loss is 17.958972903457024
test entropy is  0.04899580928800838
________________________________
cal_distance is  tensor(395.7900, device='cuda:2')
cal_distance is  tensor(106.6596, device='cuda:2')
cal_distance is  tensor(28.7436, device='cuda:2')
________________________________
test distance is  tensor(28.7436, device='cuda:2')
test similarity is  tensor(0.9939, device='cuda:2')
test acc is  0.8753833334896557
test loss is 0.3788114698615664
test entropy is  0.24995746293555954
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24995746293555954
avg test loss is  0.3788114698615664
avg accuracy is  0.8753833334896557
compute_distance is  tensor(28.7436, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13945958621180388
avg test loss is  5.305654915665259
avg accuracy is  0.15838333348966727
compute_distance is  tensor(32.4583, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(32.4583, device='cuda:2')
test similarity is  tensor(0.9921, device='cuda:2')
test acc is  0.15838333348966727
test loss is 5.305654915665259
test entropy is  0.13945958621180388
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.77% 

Test Accuracy: 86.76% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(81.8767, device='cuda:2')
compute similarity is  tensor(0.9379, device='cuda:2')
compute distance is  tensor(92.9857, device='cuda:2')
compute similarity is  tensor(0.9280, device='cuda:2')
compute distance is  tensor(90.4305, device='cuda:2')
compute similarity is  tensor(0.9289, device='cuda:2')
compute distance is  tensor(90.8552, device='cuda:2')
compute similarity is  tensor(0.9274, device='cuda:2')
compute distance is  tensor(87.7059, device='cuda:2')
compute similarity is  tensor(0.9343, device='cuda:2')
compute distance is  tensor(83.5246, device='cuda:2')
compute similarity is  tensor(0.9350, device='cuda:2')
compute distance is  tensor(84.7295, device='cuda:2')
compute similarity is  tensor(0.9358, device='cuda:2')
compute distance is  tensor(81.7519, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(79.9073, device='cuda:2')
compute similarity is  tensor(0.9420, device='cuda:2')
compute distance is  tensor(90.9627, device='cuda:2')
compute similarity is  tensor(0.9320, device='cuda:2')
compute distance is  tensor(81.9117, device='cuda:2')
compute similarity is  tensor(0.9383, device='cuda:2')
compute distance is  tensor(78.9525, device='cuda:2')
compute similarity is  tensor(0.9422, device='cuda:2')
calculated distance threshold is  tensor(107.0190, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8515333334896565
====================
====================
iteration is  0
round is  1
accuracy is  0.8161666668229913
====================
====================
iteration is  0
round is  2
accuracy is  0.835300000156324
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.618650000156336
====================
====================
iteration is  1
round is  1
accuracy is  0.36586666682300734
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.43213333348967475
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.20145000015633646
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.16128333348966747
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.21581666682300368
====================
________________________________
test distance is  tensor(1480.5072, device='cuda:2')
test similarity is  tensor(0.1758, device='cuda:2')
test acc is  0.16128333348966747
test loss is 28.366450466326814
test entropy is  0.04863788048699021
________________________________
cal_distance is  tensor(398.0489, device='cuda:2')
cal_distance is  tensor(107.0198, device='cuda:2')
cal_distance is  tensor(28.7739, device='cuda:2')
________________________________
test distance is  tensor(28.7739, device='cuda:2')
test similarity is  tensor(0.9943, device='cuda:2')
test acc is  0.8794666668229888
test loss is 0.36855716971573294
test entropy is  0.23993718050626803
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.23993718050626803
avg test loss is  0.36855716971573294
avg accuracy is  0.8794666668229888
compute_distance is  tensor(28.7739, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16661452219239684
avg test loss is  6.123001599871019
avg accuracy is  0.15265000015633337
compute_distance is  tensor(33.9391, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(33.9391, device='cuda:2')
test similarity is  tensor(0.9916, device='cuda:2')
test acc is  0.15265000015633337
test loss is 6.123001599871019
test entropy is  0.16661452219239684
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.91% 

Test Accuracy: 86.89% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(82.9698, device='cuda:2')
compute similarity is  tensor(0.9399, device='cuda:2')
compute distance is  tensor(87.7979, device='cuda:2')
compute similarity is  tensor(0.9355, device='cuda:2')
compute distance is  tensor(87.4454, device='cuda:2')
compute similarity is  tensor(0.9357, device='cuda:2')
compute distance is  tensor(91.2377, device='cuda:2')
compute similarity is  tensor(0.9293, device='cuda:2')
compute distance is  tensor(90.6321, device='cuda:2')
compute similarity is  tensor(0.9337, device='cuda:2')
compute distance is  tensor(86.7242, device='cuda:2')
compute similarity is  tensor(0.9363, device='cuda:2')
compute distance is  tensor(88.2697, device='cuda:2')
compute similarity is  tensor(0.9368, device='cuda:2')
compute distance is  tensor(82.9234, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(86.8750, device='cuda:2')
compute similarity is  tensor(0.9371, device='cuda:2')
compute distance is  tensor(88.2929, device='cuda:2')
compute similarity is  tensor(0.9384, device='cuda:2')
compute distance is  tensor(91.3154, device='cuda:2')
compute similarity is  tensor(0.9309, device='cuda:2')
compute distance is  tensor(88.7171, device='cuda:2')
compute similarity is  tensor(0.9361, device='cuda:2')
calculated distance threshold is  tensor(99.7073, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8153666668229913
====================
====================
iteration is  0
round is  1
accuracy is  0.8148000001563248
====================
====================
iteration is  0
round is  2
accuracy is  0.7954833334896589
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5655166668230073
====================
====================
iteration is  1
round is  1
accuracy is  0.5594166668230077
====================
====================
iteration is  1
round is  2
accuracy is  0.3651666668230073
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.39771666682300777
====================
====================
iteration is  2
round is  1
accuracy is  0.16466666682300105
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.20916666682300344
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.20971666682300355
====================
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.1834, device='cuda:2')
test acc is  0.16466666682300105
test loss is 25.535061584098507
test entropy is  0.0391096495953736
________________________________
cal_distance is  tensor(381.5542, device='cuda:2')
cal_distance is  tensor(99.7081, device='cuda:2')
cal_distance is  tensor(26.0563, device='cuda:2')
________________________________
test distance is  tensor(26.0563, device='cuda:2')
test similarity is  tensor(0.9955, device='cuda:2')
test acc is  0.8798000001563221
test loss is 0.3700409583461437
test entropy is  0.2406469991466384
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2406469991466384
avg test loss is  0.3700409583461437
avg accuracy is  0.8798000001563221
compute_distance is  tensor(26.0563, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11556999419114865
avg test loss is  6.815194192471535
avg accuracy is  0.15076666682299988
compute_distance is  tensor(31.3399, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(31.3399, device='cuda:2')
test similarity is  tensor(0.9932, device='cuda:2')
test acc is  0.15076666682299988
test loss is 6.815194192471535
test entropy is  0.11556999419114865
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 88.13% 

Test Accuracy: 87.05% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(83.2801, device='cuda:2')
compute similarity is  tensor(0.9408, device='cuda:2')
compute distance is  tensor(89.8565, device='cuda:2')
compute similarity is  tensor(0.9353, device='cuda:2')
compute distance is  tensor(87.4044, device='cuda:2')
compute similarity is  tensor(0.9365, device='cuda:2')
compute distance is  tensor(91.8524, device='cuda:2')
compute similarity is  tensor(0.9297, device='cuda:2')
compute distance is  tensor(88.4644, device='cuda:2')
compute similarity is  tensor(0.9380, device='cuda:2')
compute distance is  tensor(83.9464, device='cuda:2')
compute similarity is  tensor(0.9399, device='cuda:2')
compute distance is  tensor(84.5601, device='cuda:2')
compute similarity is  tensor(0.9426, device='cuda:2')
compute distance is  tensor(87.0252, device='cuda:2')
compute similarity is  tensor(0.9395, device='cuda:2')
compute distance is  tensor(85.5268, device='cuda:2')
compute similarity is  tensor(0.9410, device='cuda:2')
compute distance is  tensor(86.7430, device='cuda:2')
compute similarity is  tensor(0.9415, device='cuda:2')
compute distance is  tensor(88.6549, device='cuda:2')
compute similarity is  tensor(0.9365, device='cuda:2')
compute distance is  tensor(87.4352, device='cuda:2')
compute similarity is  tensor(0.9386, device='cuda:2')
calculated distance threshold is  tensor(100.4247, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7961500001563255
====================
====================
iteration is  0
round is  1
accuracy is  0.8345333334896573
====================
====================
iteration is  0
round is  2
accuracy is  0.8006833334896586
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5037333334896753
====================
====================
iteration is  1
round is  1
accuracy is  0.5241166668230088
====================
====================
iteration is  1
round is  2
accuracy is  0.49956666682300876
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.24285000015633804
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.1601166668230007
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.19263333348966938
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.20305000015633654
====================
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.1854, device='cuda:2')
test acc is  0.1601166668230007
test loss is 19.793287578167945
test entropy is  0.05155834479571215
________________________________
cal_distance is  tensor(383.7262, device='cuda:2')
cal_distance is  tensor(100.4254, device='cuda:2')
cal_distance is  tensor(26.2829, device='cuda:2')
________________________________
test distance is  tensor(26.2829, device='cuda:2')
test similarity is  tensor(0.9956, device='cuda:2')
test acc is  0.8822166668229887
test loss is 0.37254845174645057
test entropy is  0.2124960292011563
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2124960292011563
avg test loss is  0.37254845174645057
avg accuracy is  0.8822166668229887
compute_distance is  tensor(26.2829, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1341960984371555
avg test loss is  6.2691589459173205
avg accuracy is  0.14008333348966556
compute_distance is  tensor(32.3815, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(32.3815, device='cuda:2')
test similarity is  tensor(0.9932, device='cuda:2')
test acc is  0.14008333348966556
test loss is 6.2691589459173205
test entropy is  0.1341960984371555
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 87.94% 

Test Accuracy: 87.26% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(86.8373, device='cuda:2')
compute similarity is  tensor(0.9428, device='cuda:2')
compute distance is  tensor(86.8414, device='cuda:2')
compute similarity is  tensor(0.9428, device='cuda:2')
compute distance is  tensor(93.6439, device='cuda:2')
compute similarity is  tensor(0.9359, device='cuda:2')
compute distance is  tensor(96.0887, device='cuda:2')
compute similarity is  tensor(0.9319, device='cuda:2')
compute distance is  tensor(96.3549, device='cuda:2')
compute similarity is  tensor(0.9360, device='cuda:2')
compute distance is  tensor(86.6614, device='cuda:2')
compute similarity is  tensor(0.9433, device='cuda:2')
compute distance is  tensor(90.9053, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(86.4207, device='cuda:2')
compute similarity is  tensor(0.9458, device='cuda:2')
compute distance is  tensor(84.3893, device='cuda:2')
compute similarity is  tensor(0.9447, device='cuda:2')
compute distance is  tensor(91.5325, device='cuda:2')
compute similarity is  tensor(0.9412, device='cuda:2')
compute distance is  tensor(92.0960, device='cuda:2')
compute similarity is  tensor(0.9375, device='cuda:2')
compute distance is  tensor(82.2832, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
calculated distance threshold is  tensor(110.4267, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8359333334896571
====================
====================
iteration is  0
round is  1
accuracy is  0.8205666668229911
====================
====================
iteration is  0
round is  2
accuracy is  0.8430166668229903
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5166833334896755
====================
====================
iteration is  1
round is  1
accuracy is  0.42673333348967474
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5082833334896754
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.32290000015633996
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.26553333348967206
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.16045000015633407
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.17811666682300187
====================
________________________________
test distance is  tensor(1476.0421, device='cuda:2')
test similarity is  tensor(0.2003, device='cuda:2')
test acc is  0.16045000015633407
test loss is 19.882903085842823
test entropy is  0.0965299585512452
________________________________
cal_distance is  tensor(403.7263, device='cuda:2')
cal_distance is  tensor(110.4275, device='cuda:2')
cal_distance is  tensor(30.2046, device='cuda:2')
________________________________
test distance is  tensor(30.2046, device='cuda:2')
test similarity is  tensor(0.9949, device='cuda:2')
test acc is  0.8832166668229887
test loss is 0.3761529117139545
test entropy is  0.19159899280269518
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19159899280269518
avg test loss is  0.3761529117139545
avg accuracy is  0.8832166668229887
compute_distance is  tensor(30.2046, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.38168939296751897
avg test loss is  5.105810711378736
avg accuracy is  0.1704333334896681
compute_distance is  tensor(39.6944, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(39.6944, device='cuda:2')
test similarity is  tensor(0.9910, device='cuda:2')
test acc is  0.1704333334896681
test loss is 5.105810711378736
test entropy is  0.38168939296751897
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.07% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(85.8602, device='cuda:2')
compute similarity is  tensor(0.9472, device='cuda:2')
compute distance is  tensor(92.7092, device='cuda:2')
compute similarity is  tensor(0.9411, device='cuda:2')
compute distance is  tensor(92.1762, device='cuda:2')
compute similarity is  tensor(0.9426, device='cuda:2')
compute distance is  tensor(98.1757, device='cuda:2')
compute similarity is  tensor(0.9331, device='cuda:2')
compute distance is  tensor(92.6799, device='cuda:2')
compute similarity is  tensor(0.9424, device='cuda:2')
compute distance is  tensor(91.6208, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(91.4562, device='cuda:2')
compute similarity is  tensor(0.9429, device='cuda:2')
compute distance is  tensor(94.1667, device='cuda:2')
compute similarity is  tensor(0.9402, device='cuda:2')
compute distance is  tensor(83.3160, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(92.9858, device='cuda:2')
compute similarity is  tensor(0.9431, device='cuda:2')
compute distance is  tensor(89.5263, device='cuda:2')
compute similarity is  tensor(0.9450, device='cuda:2')
compute distance is  tensor(87.2296, device='cuda:2')
compute similarity is  tensor(0.9456, device='cuda:2')
calculated distance threshold is  tensor(113.0353, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8164666668229913
====================
====================
iteration is  0
round is  1
accuracy is  0.833600000156324
====================
====================
iteration is  0
round is  2
accuracy is  0.8560333334896564
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5245166668230089
====================
====================
iteration is  1
round is  1
accuracy is  0.7229500001563293
====================
====================
iteration is  1
round is  2
accuracy is  0.5816000001563391
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4271500001563414
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.35476666682300717
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.12133333348966527
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.1941333334896695
====================
====================
iteration is  3
round is  1
accuracy is  0.2378833334896713
====================
________________________________
test distance is  tensor(1476.9706, device='cuda:2')
test similarity is  tensor(0.1993, device='cuda:2')
test acc is  0.12133333348966527
test loss is 24.08854276132482
test entropy is  0.02481641343303039
________________________________
cal_distance is  tensor(408.5956, device='cuda:2')
cal_distance is  tensor(113.0361, device='cuda:2')
cal_distance is  tensor(31.2713, device='cuda:2')
________________________________
test distance is  tensor(31.2713, device='cuda:2')
test similarity is  tensor(0.9948, device='cuda:2')
test acc is  0.8863666668229886
test loss is 0.37611015724824437
test entropy is  0.17841615386481988
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17841615386481988
avg test loss is  0.37611015724824437
avg accuracy is  0.8863666668229886
compute_distance is  tensor(31.2713, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10824155419477141
avg test loss is  5.536169069916455
avg accuracy is  0.1048833334896653
compute_distance is  tensor(36.0773, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(36.0773, device='cuda:2')
test similarity is  tensor(0.9932, device='cuda:2')
test acc is  0.1048833334896653
test loss is 5.536169069916455
test entropy is  0.10824155419477141
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.10% 

Test Accuracy: 87.15% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(92.8546, device='cuda:2')
compute similarity is  tensor(0.9435, device='cuda:2')
compute distance is  tensor(107.0823, device='cuda:2')
compute similarity is  tensor(0.9332, device='cuda:2')
compute distance is  tensor(94.7834, device='cuda:2')
compute similarity is  tensor(0.9442, device='cuda:2')
compute distance is  tensor(102.8717, device='cuda:2')
compute similarity is  tensor(0.9348, device='cuda:2')
compute distance is  tensor(99.7776, device='cuda:2')
compute similarity is  tensor(0.9386, device='cuda:2')
compute distance is  tensor(95.6394, device='cuda:2')
compute similarity is  tensor(0.9424, device='cuda:2')
compute distance is  tensor(97.2499, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(93.1230, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(88.5453, device='cuda:2')
compute similarity is  tensor(0.9491, device='cuda:2')
compute distance is  tensor(99.0553, device='cuda:2')
compute similarity is  tensor(0.9436, device='cuda:2')
compute distance is  tensor(98.1992, device='cuda:2')
compute similarity is  tensor(0.9398, device='cuda:2')
compute distance is  tensor(96.0235, device='cuda:2')
compute similarity is  tensor(0.9439, device='cuda:2')
calculated distance threshold is  tensor(125.6194, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8563500001563231
====================
====================
iteration is  0
round is  1
accuracy is  0.8197833334896579
====================
====================
iteration is  0
round is  2
accuracy is  0.7963666668229923
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7152166668229963
====================
====================
iteration is  1
round is  1
accuracy is  0.4522166668230083
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6094666668230034
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.1677000001563346
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2948166668230061
====================
====================
iteration is  2
round is  2
accuracy is  0.18983333348966921
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.33151666682300673
====================
________________________________
test distance is  tensor(1476.0836, device='cuda:2')
test similarity is  tensor(0.2167, device='cuda:2')
test acc is  0.1677000001563346
test loss is 25.11087343586025
test entropy is  0.03969290516853555
________________________________
cal_distance is  tensor(430.6103, device='cuda:2')
cal_distance is  tensor(125.6201, device='cuda:2')
cal_distance is  tensor(36.6470, device='cuda:2')
________________________________
test distance is  tensor(36.6470, device='cuda:2')
test similarity is  tensor(0.9936, device='cuda:2')
test acc is  0.8836333334896553
test loss is 0.4027305697517863
test entropy is  0.17213011331268466
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17213011331268466
avg test loss is  0.4027305697517863
avg accuracy is  0.8836333334896553
compute_distance is  tensor(36.6470, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17396491926425556
avg test loss is  4.978447285034001
avg accuracy is  0.15880000015633394
compute_distance is  tensor(41.3832, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(41.3832, device='cuda:2')
test similarity is  tensor(0.9923, device='cuda:2')
test acc is  0.15880000015633394
test loss is 4.978447285034001
test entropy is  0.17396491926425556
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.56% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(90.0565, device='cuda:2')
compute similarity is  tensor(0.9477, device='cuda:2')
compute distance is  tensor(89.2761, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(93.4460, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(96.7049, device='cuda:2')
compute similarity is  tensor(0.9400, device='cuda:2')
compute distance is  tensor(96.9051, device='cuda:2')
compute similarity is  tensor(0.9438, device='cuda:2')
compute distance is  tensor(93.9098, device='cuda:2')
compute similarity is  tensor(0.9454, device='cuda:2')
compute distance is  tensor(97.5103, device='cuda:2')
compute similarity is  tensor(0.9407, device='cuda:2')
compute distance is  tensor(90.1546, device='cuda:2')
compute similarity is  tensor(0.9493, device='cuda:2')
compute distance is  tensor(84.8460, device='cuda:2')
compute similarity is  tensor(0.9521, device='cuda:2')
compute distance is  tensor(89.8592, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(89.3389, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(87.7137, device='cuda:2')
compute similarity is  tensor(0.9507, device='cuda:2')
calculated distance threshold is  tensor(110.1746, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8444666668229902
====================
====================
iteration is  0
round is  1
accuracy is  0.8421500001563237
====================
====================
iteration is  0
round is  2
accuracy is  0.8378500001563237
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6680666668229992
====================
====================
iteration is  1
round is  1
accuracy is  0.5413333334896757
====================
====================
iteration is  1
round is  2
accuracy is  0.6210500001563358
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.19906666682300306
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2435666668230047
====================
====================
iteration is  2
round is  2
accuracy is  0.22220000015633734
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2621666668230052
====================
====================
iteration is  3
round is  1
accuracy is  0.24108333348967134
====================
________________________________
test distance is  tensor(1474.9321, device='cuda:2')
test similarity is  tensor(0.2148, device='cuda:2')
test acc is  0.19906666682300306
test loss is 17.019798155786642
test entropy is  0.06360639675434973
________________________________
cal_distance is  tensor(403.1135, device='cuda:2')
cal_distance is  tensor(110.1753, device='cuda:2')
cal_distance is  tensor(30.1125, device='cuda:2')
________________________________
test distance is  tensor(30.1125, device='cuda:2')
test similarity is  tensor(0.9957, device='cuda:2')
test acc is  0.8883166668229885
test loss is 0.37757746768054934
test entropy is  0.1739059644642034
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1739059644642034
avg test loss is  0.37757746768054934
avg accuracy is  0.8883166668229885
compute_distance is  tensor(30.1125, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.31023504683521513
avg test loss is  4.422892342498308
avg accuracy is  0.18153333348966877
compute_distance is  tensor(37.9923, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(37.9923, device='cuda:2')
test similarity is  tensor(0.9928, device='cuda:2')
test acc is  0.18153333348966877
test loss is 4.422892342498308
test entropy is  0.31023504683521513
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.05% 

Test Accuracy: 87.18% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(90.8126, device='cuda:2')
compute similarity is  tensor(0.9479, device='cuda:2')
compute distance is  tensor(100.0246, device='cuda:2')
compute similarity is  tensor(0.9421, device='cuda:2')
compute distance is  tensor(96.0191, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(97.3254, device='cuda:2')
compute similarity is  tensor(0.9438, device='cuda:2')
compute distance is  tensor(99.8329, device='cuda:2')
compute similarity is  tensor(0.9433, device='cuda:2')
compute distance is  tensor(94.8394, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(98.7933, device='cuda:2')
compute similarity is  tensor(0.9444, device='cuda:2')
compute distance is  tensor(92.9532, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(93.9407, device='cuda:2')
compute similarity is  tensor(0.9489, device='cuda:2')
compute distance is  tensor(100.7231, device='cuda:2')
compute similarity is  tensor(0.9436, device='cuda:2')
compute distance is  tensor(96.1188, device='cuda:2')
compute similarity is  tensor(0.9446, device='cuda:2')
compute distance is  tensor(92.1228, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
calculated distance threshold is  tensor(110.6336, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8407000001563237
====================
====================
iteration is  0
round is  1
accuracy is  0.8475833334896566
====================
====================
iteration is  0
round is  2
accuracy is  0.8257000001563242
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5718166668230067
====================
====================
iteration is  1
round is  1
accuracy is  0.37225000015634074
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6563166668229999
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.31155000015633977
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2180833334896705
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.23011666682300433
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.25228333348967164
====================
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.2240, device='cuda:2')
test acc is  0.2180833334896705
test loss is 23.360146264277542
test entropy is  0.061433865745335436
________________________________
cal_distance is  tensor(402.4720, device='cuda:2')
cal_distance is  tensor(110.6344, device='cuda:2')
cal_distance is  tensor(30.4124, device='cuda:2')
________________________________
test distance is  tensor(30.4124, device='cuda:2')
test similarity is  tensor(0.9959, device='cuda:2')
test acc is  0.8864333334896553
test loss is 0.39344317432659776
test entropy is  0.1682054985687931
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1682054985687931
avg test loss is  0.39344317432659776
avg accuracy is  0.8864333334896553
compute_distance is  tensor(30.4124, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.26070321522859624
avg test loss is  5.086737757298484
avg accuracy is  0.2108000001563369
compute_distance is  tensor(37.4689, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(37.4689, device='cuda:2')
test similarity is  tensor(0.9939, device='cuda:2')
test acc is  0.2108000001563369
test loss is 5.086737757298484
test entropy is  0.26070321522859624
________________________________
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 88.38% 

Test Accuracy: 87.51% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(93.3648, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
compute distance is  tensor(98.2375, device='cuda:2')
compute similarity is  tensor(0.9455, device='cuda:2')
compute distance is  tensor(92.7675, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(98.3011, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(98.9008, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(96.7036, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(97.0336, device='cuda:2')
compute similarity is  tensor(0.9467, device='cuda:2')
compute distance is  tensor(90.4760, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(88.3862, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(99.6117, device='cuda:2')
compute similarity is  tensor(0.9442, device='cuda:2')
compute distance is  tensor(94.5132, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(95.5080, device='cuda:2')
compute similarity is  tensor(0.9472, device='cuda:2')
calculated distance threshold is  tensor(110.8371, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8189833334896579
====================
====================
iteration is  0
round is  1
accuracy is  0.8384666668229904
====================
====================
iteration is  0
round is  2
accuracy is  0.8354500001563239
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6699666668229991
====================
====================
iteration is  1
round is  1
accuracy is  0.6988000001563306
====================
====================
iteration is  1
round is  2
accuracy is  0.5670000001563404
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3659000001563406
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.31598333348967317
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.2632000001563387
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.31048333348967305
====================
====================
iteration is  3
round is  1
accuracy is  0.40663333348967456
====================
________________________________
test distance is  tensor(1474.4319, device='cuda:2')
test similarity is  tensor(0.2209, device='cuda:2')
test acc is  0.2632000001563387
test loss is 20.740273839629282
test entropy is  0.06431791610243336
________________________________
cal_distance is  tensor(404.2552, device='cuda:2')
cal_distance is  tensor(110.8379, device='cuda:2')
cal_distance is  tensor(30.3898, device='cuda:2')
________________________________
test distance is  tensor(30.3898, device='cuda:2')
test similarity is  tensor(0.9960, device='cuda:2')
test acc is  0.8897000001563218
test loss is 0.38971476820009604
test entropy is  0.15686971718457335
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15686971718457335
avg test loss is  0.38971476820009604
avg accuracy is  0.8897000001563218
compute_distance is  tensor(30.3898, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3163375667989381
avg test loss is  4.132495766001215
avg accuracy is  0.26596666682300535
compute_distance is  tensor(39.4272, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(39.4272, device='cuda:2')
test similarity is  tensor(0.9930, device='cuda:2')
test acc is  0.26596666682300535
test loss is 4.132495766001215
test entropy is  0.3163375667989381
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 88.52% 

Test Accuracy: 87.67% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(96.4133, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(98.7108, device='cuda:2')
compute similarity is  tensor(0.9467, device='cuda:2')
compute distance is  tensor(91.7083, device='cuda:2')
compute similarity is  tensor(0.9521, device='cuda:2')
compute distance is  tensor(107.6847, device='cuda:2')
compute similarity is  tensor(0.9354, device='cuda:2')
compute distance is  tensor(102.6028, device='cuda:2')
compute similarity is  tensor(0.9448, device='cuda:2')
compute distance is  tensor(98.8042, device='cuda:2')
compute similarity is  tensor(0.9454, device='cuda:2')
compute distance is  tensor(103.2851, device='cuda:2')
compute similarity is  tensor(0.9415, device='cuda:2')
compute distance is  tensor(93.2038, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(96.9929, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(99.4398, device='cuda:2')
compute similarity is  tensor(0.9454, device='cuda:2')
compute distance is  tensor(99.5032, device='cuda:2')
compute similarity is  tensor(0.9464, device='cuda:2')
compute distance is  tensor(95.9118, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
calculated distance threshold is  tensor(123.6612, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8514000001563232
====================
====================
iteration is  0
round is  1
accuracy is  0.8440333334896569
====================
====================
iteration is  0
round is  2
accuracy is  0.838933333489657
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5563333334896747
====================
====================
iteration is  1
round is  1
accuracy is  0.5262833334896756
====================
====================
iteration is  1
round is  2
accuracy is  0.46805000015634185
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.25201666682300494
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.29591666682300616
====================
====================
iteration is  2
round is  2
accuracy is  0.32390000015633996
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.21631666682300382
====================
succ_min + 1
________________________________
test distance is  tensor(1472.4968, device='cuda:2')
test similarity is  tensor(0.2211, device='cuda:2')
test acc is  0.21631666682300382
test loss is 23.323795796457386
test entropy is  0.06550931537658898
________________________________
cal_distance is  tensor(426.7214, device='cuda:2')
cal_distance is  tensor(123.6619, device='cuda:2')
cal_distance is  tensor(35.8370, device='cuda:2')
________________________________
test distance is  tensor(35.8370, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8905666668229885
test loss is 0.38857959496822436
test entropy is  0.15398895271869104
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15398895271869104
avg test loss is  0.38857959496822436
avg accuracy is  0.8905666668229885
compute_distance is  tensor(35.8370, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2707462253124475
avg test loss is  5.284735597781281
avg accuracy is  0.1906666668230026
compute_distance is  tensor(42.9362, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(42.9362, device='cuda:2')
test similarity is  tensor(0.9922, device='cuda:2')
test acc is  0.1906666668230026
test loss is 5.284735597781281
test entropy is  0.2707462253124475
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 88.57% 

Test Accuracy: 87.71% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(85.8156, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(99.0156, device='cuda:2')
compute similarity is  tensor(0.9457, device='cuda:2')
compute distance is  tensor(94.2469, device='cuda:2')
compute similarity is  tensor(0.9495, device='cuda:2')
compute distance is  tensor(98.1838, device='cuda:2')
compute similarity is  tensor(0.9472, device='cuda:2')
compute distance is  tensor(96.0903, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
compute distance is  tensor(89.9764, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(95.0969, device='cuda:2')
compute similarity is  tensor(0.9508, device='cuda:2')
compute distance is  tensor(91.2485, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(93.3645, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(102.5889, device='cuda:2')
compute similarity is  tensor(0.9443, device='cuda:2')
compute distance is  tensor(101.3703, device='cuda:2')
compute similarity is  tensor(0.9451, device='cuda:2')
compute distance is  tensor(93.4878, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
calculated distance threshold is  tensor(119.3622, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.863283333489656
====================
====================
iteration is  0
round is  1
accuracy is  0.8284166668229909
====================
====================
iteration is  0
round is  2
accuracy is  0.8554833334896564
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5747166668230064
====================
====================
iteration is  1
round is  1
accuracy is  0.5544166668230083
====================
====================
iteration is  1
round is  2
accuracy is  0.583250000156339
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2728333334896722
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.23486666682300444
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3201000001563399
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.1596666668230007
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.29255000015633936
====================
________________________________
test distance is  tensor(1472.4686, device='cuda:2')
test similarity is  tensor(0.2254, device='cuda:2')
test acc is  0.1596666668230007
test loss is 29.030403789935082
test entropy is  0.04160844409060893
________________________________
cal_distance is  tensor(419.2346, device='cuda:2')
cal_distance is  tensor(119.3630, device='cuda:2')
cal_distance is  tensor(33.9850, device='cuda:2')
________________________________
test distance is  tensor(33.9850, device='cuda:2')
test similarity is  tensor(0.9952, device='cuda:2')
test acc is  0.8913500001563216
test loss is 0.3825885226954021
test entropy is  0.157595279779452
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.157595279779452
avg test loss is  0.3825885226954021
avg accuracy is  0.8913500001563216
compute_distance is  tensor(33.9850, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17708624537184295
avg test loss is  5.417768693936151
avg accuracy is  0.14310000015633256
compute_distance is  tensor(40.0644, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(40.0644, device='cuda:2')
test similarity is  tensor(0.9935, device='cuda:2')
test acc is  0.14310000015633256
test loss is 5.417768693936151
test entropy is  0.17708624537184295
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 88.55% 

Test Accuracy: 87.34% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(90.2065, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(107.9491, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(99.3566, device='cuda:2')
compute similarity is  tensor(0.9505, device='cuda:2')
compute distance is  tensor(105.1263, device='cuda:2')
compute similarity is  tensor(0.9440, device='cuda:2')
compute distance is  tensor(103.2480, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(98.9455, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(101.4405, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(99.6584, device='cuda:2')
compute similarity is  tensor(0.9512, device='cuda:2')
compute distance is  tensor(99.5355, device='cuda:2')
compute similarity is  tensor(0.9498, device='cuda:2')
compute distance is  tensor(101.7598, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
compute distance is  tensor(100.2734, device='cuda:2')
compute similarity is  tensor(0.9493, device='cuda:2')
compute distance is  tensor(99.5187, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
calculated distance threshold is  tensor(125.6918, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8268166668229909
====================
====================
iteration is  0
round is  1
accuracy is  0.831900000156324
====================
====================
iteration is  0
round is  2
accuracy is  0.8408166668229904
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.594400000156338
====================
====================
iteration is  1
round is  1
accuracy is  0.5453833334896757
====================
====================
iteration is  1
round is  2
accuracy is  0.5079500001563422
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.48575000015634195
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.14041666682299894
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.20971666682300344
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.21995000015633728
====================
====================
iteration is  3
round is  1
accuracy is  0.17676666682300182
====================
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.2364, device='cuda:2')
test acc is  0.14041666682299894
test loss is 22.223376404247812
test entropy is  0.03865527285576693
________________________________
cal_distance is  tensor(429.6835, device='cuda:2')
cal_distance is  tensor(125.6925, device='cuda:2')
cal_distance is  tensor(36.7684, device='cuda:2')
________________________________
test distance is  tensor(36.7684, device='cuda:2')
test similarity is  tensor(0.9948, device='cuda:2')
test acc is  0.8904166668229885
test loss is 0.3903950006762611
test entropy is  0.1573285242197102
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1573285242197102
avg test loss is  0.3903950006762611
avg accuracy is  0.8904166668229885
compute_distance is  tensor(36.7684, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17980379049680126
avg test loss is  4.843587709134067
avg accuracy is  0.13000000015633192
compute_distance is  tensor(41.4249, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(41.4249, device='cuda:2')
test similarity is  tensor(0.9938, device='cuda:2')
test acc is  0.13000000015633192
test loss is 4.843587709134067
test entropy is  0.17980379049680126
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.68% 

Test Accuracy: 87.58% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(87.4024, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(97.3825, device='cuda:2')
compute similarity is  tensor(0.9513, device='cuda:2')
compute distance is  tensor(100.5776, device='cuda:2')
compute similarity is  tensor(0.9504, device='cuda:2')
compute distance is  tensor(100.6105, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(98.2510, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(94.9572, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(91.7843, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(97.3608, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(93.0181, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(104.5536, device='cuda:2')
compute similarity is  tensor(0.9491, device='cuda:2')
compute distance is  tensor(99.8146, device='cuda:2')
compute similarity is  tensor(0.9511, device='cuda:2')
compute distance is  tensor(91.8625, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
calculated distance threshold is  tensor(121.7049, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8457500001563235
====================
====================
iteration is  0
round is  1
accuracy is  0.8535500001563232
====================
====================
iteration is  0
round is  2
accuracy is  0.8303833334896574
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5788833334896728
====================
====================
iteration is  1
round is  1
accuracy is  0.5511166668230085
====================
====================
iteration is  1
round is  2
accuracy is  0.7104166668229966
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2966666668230061
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.16971666682300138
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.12786666682299858
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.3239166668230066
====================
====================
iteration is  3
round is  1
accuracy is  0.35876666682300723
====================
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.2391, device='cuda:2')
test acc is  0.12786666682299858
test loss is 26.403929767323962
test entropy is  0.023072982790056682
________________________________
cal_distance is  tensor(423.1020, device='cuda:2')
cal_distance is  tensor(121.7056, device='cuda:2')
cal_distance is  tensor(35.0091, device='cuda:2')
________________________________
test distance is  tensor(35.0091, device='cuda:2')
test similarity is  tensor(0.9953, device='cuda:2')
test acc is  0.8930166668229883
test loss is 0.38229696195262836
test entropy is  0.15101706928440503
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15101706928440503
avg test loss is  0.38229696195262836
avg accuracy is  0.8930166668229883
compute_distance is  tensor(35.0091, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1209038731052296
avg test loss is  4.930470364434378
avg accuracy is  0.11515000015633195
compute_distance is  tensor(40.3064, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(40.3064, device='cuda:2')
test similarity is  tensor(0.9942, device='cuda:2')
test acc is  0.11515000015633195
test loss is 4.930470364434378
test entropy is  0.1209038731052296
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.54% 

Test Accuracy: 87.30% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(90.0893, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(107.1590, device='cuda:2')
compute similarity is  tensor(0.9452, device='cuda:2')
compute distance is  tensor(103.8857, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(109.7806, device='cuda:2')
compute similarity is  tensor(0.9424, device='cuda:2')
compute distance is  tensor(108.1293, device='cuda:2')
compute similarity is  tensor(0.9473, device='cuda:2')
compute distance is  tensor(105.9582, device='cuda:2')
compute similarity is  tensor(0.9486, device='cuda:2')
compute distance is  tensor(96.8739, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(96.6477, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(94.7014, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(111.8133, device='cuda:2')
compute similarity is  tensor(0.9441, device='cuda:2')
compute distance is  tensor(101.5312, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(102.1502, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
calculated distance threshold is  tensor(133.5373, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8186333334896579
====================
====================
iteration is  0
round is  1
accuracy is  0.8529666668229897
====================
====================
iteration is  0
round is  2
accuracy is  0.8468833334896568
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4173833334896746
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6598833334896665
====================
====================
iteration is  1
round is  2
accuracy is  0.6537833334896669
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2813000001563391
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.28430000015633916
====================
====================
iteration is  2
round is  2
accuracy is  0.37468333348967414
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.30008333348967287
====================
________________________________
test distance is  tensor(1469.0900, device='cuda:2')
test similarity is  tensor(0.2517, device='cuda:2')
test acc is  0.2813000001563391
test loss is 21.371361577942935
test entropy is  0.04493513456503573
________________________________
cal_distance is  tensor(442.9208, device='cuda:2')
cal_distance is  tensor(133.5380, device='cuda:2')
cal_distance is  tensor(40.2613, device='cuda:2')
________________________________
test distance is  tensor(40.2613, device='cuda:2')
test similarity is  tensor(0.9942, device='cuda:2')
test acc is  0.8905000001563218
test loss is 0.4266980965691271
test entropy is  0.1333896506196464
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1333896506196464
avg test loss is  0.4266980965691271
avg accuracy is  0.8905000001563218
compute_distance is  tensor(40.2613, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24631064389941534
avg test loss is  4.039272777815618
avg accuracy is  0.28788333348967254
compute_distance is  tensor(46.3299, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(46.3299, device='cuda:2')
test similarity is  tensor(0.9926, device='cuda:2')
test acc is  0.28788333348967254
test loss is 4.039272777815618
test entropy is  0.24631064389941534
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.65% 

Test Accuracy: 87.67% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(95.2194, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(104.3537, device='cuda:2')
compute similarity is  tensor(0.9489, device='cuda:2')
compute distance is  tensor(100.7492, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(104.9117, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
compute distance is  tensor(105.3149, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(92.1759, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(97.5849, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(96.3517, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(94.7618, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(108.0882, device='cuda:2')
compute similarity is  tensor(0.9473, device='cuda:2')
compute distance is  tensor(101.9838, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(95.0635, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
calculated distance threshold is  tensor(124.0004, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7837000001563262
====================
====================
iteration is  0
round is  1
accuracy is  0.8321666668229906
====================
====================
iteration is  0
round is  2
accuracy is  0.8380500001563237
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.494750000156342
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6592333334896665
====================
====================
iteration is  1
round is  2
accuracy is  0.6939666668229977
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4297833334896748
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.27555000015633896
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.222616666823004
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.30908333348967304
====================
________________________________
test distance is  tensor(1473.5861, device='cuda:2')
test similarity is  tensor(0.2461, device='cuda:2')
test acc is  0.222616666823004
test loss is 19.537938457562216
test entropy is  0.06571375397639646
________________________________
cal_distance is  tensor(427.4644, device='cuda:2')
cal_distance is  tensor(124.0012, device='cuda:2')
cal_distance is  tensor(35.9713, device='cuda:2')
________________________________
test distance is  tensor(35.9713, device='cuda:2')
test similarity is  tensor(0.9953, device='cuda:2')
test acc is  0.893783333489655
test loss is 0.3873318187685918
test entropy is  0.14576535619525258
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14576535619525258
avg test loss is  0.3873318187685918
avg accuracy is  0.893783333489655
compute_distance is  tensor(35.9713, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2875939165827816
avg test loss is  4.115249299037177
avg accuracy is  0.1948666668230028
compute_distance is  tensor(42.5571, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(42.5571, device='cuda:2')
test similarity is  tensor(0.9936, device='cuda:2')
test acc is  0.1948666668230028
test loss is 4.115249299037177
test entropy is  0.2875939165827816
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.77% 

Test Accuracy: 87.73% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(98.1745, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(108.9264, device='cuda:2')
compute similarity is  tensor(0.9456, device='cuda:2')
compute distance is  tensor(99.7416, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(104.7531, device='cuda:2')
compute similarity is  tensor(0.9491, device='cuda:2')
compute distance is  tensor(102.1323, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(100.0493, device='cuda:2')
compute similarity is  tensor(0.9556, device='cuda:2')
compute distance is  tensor(107.0933, device='cuda:2')
compute similarity is  tensor(0.9479, device='cuda:2')
compute distance is  tensor(91.1090, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(98.4101, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(102.2273, device='cuda:2')
compute similarity is  tensor(0.9531, device='cuda:2')
compute distance is  tensor(99.7708, device='cuda:2')
compute similarity is  tensor(0.9535, device='cuda:2')
compute distance is  tensor(105.8970, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
calculated distance threshold is  tensor(126.7438, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8573666668229897
====================
====================
iteration is  0
round is  1
accuracy is  0.865333333489656
====================
====================
iteration is  0
round is  2
accuracy is  0.8593000001563229
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.671916666822999
====================
====================
iteration is  1
round is  1
accuracy is  0.39751666682300774
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.36733333348967395
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.29568333348967274
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.25966666682300527
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.1733166668230016
====================
succ_min + 1
________________________________
test distance is  tensor(1478.1119, device='cuda:2')
test similarity is  tensor(0.2442, device='cuda:2')
test acc is  0.1733166668230016
test loss is 29.54864754300636
test entropy is  0.04171757059626535
________________________________
cal_distance is  tensor(432.8303, device='cuda:2')
cal_distance is  tensor(126.7446, device='cuda:2')
cal_distance is  tensor(37.1147, device='cuda:2')
________________________________
test distance is  tensor(37.1147, device='cuda:2')
test similarity is  tensor(0.9951, device='cuda:2')
test acc is  0.8944666668229881
test loss is 0.3827536694848461
test entropy is  0.14899848044109243
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14899848044109243
avg test loss is  0.3827536694848461
avg accuracy is  0.8944666668229881
compute_distance is  tensor(37.1147, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2237944420435027
avg test loss is  4.8550543472456775
avg accuracy is  0.15345000015633345
compute_distance is  tensor(43.1542, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(43.1542, device='cuda:2')
test similarity is  tensor(0.9938, device='cuda:2')
test acc is  0.15345000015633345
test loss is 4.8550543472456775
test entropy is  0.2237944420435027
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.92% 

Test Accuracy: 87.77% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(94.8119, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(100.3331, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(107.4130, device='cuda:2')
compute similarity is  tensor(0.9457, device='cuda:2')
compute distance is  tensor(105.1297, device='cuda:2')
compute similarity is  tensor(0.9481, device='cuda:2')
compute distance is  tensor(102.1859, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(95.2804, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(101.1713, device='cuda:2')
compute similarity is  tensor(0.9533, device='cuda:2')
compute distance is  tensor(98.7929, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(97.8570, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(106.5918, device='cuda:2')
compute similarity is  tensor(0.9515, device='cuda:2')
compute distance is  tensor(103.8093, device='cuda:2')
compute similarity is  tensor(0.9495, device='cuda:2')
compute distance is  tensor(96.5959, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
calculated distance threshold is  tensor(120.0140, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8316166668229907
====================
====================
iteration is  0
round is  1
accuracy is  0.8425500001563235
====================
====================
iteration is  0
round is  2
accuracy is  0.8496000001563233
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.48018333348967523
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7350333334896619
====================
====================
iteration is  1
round is  2
accuracy is  0.7228333334896626
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2904000001563394
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2132333334896703
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.2722500001563389
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2989833334896728
====================
________________________________
test distance is  tensor(1472.9342, device='cuda:2')
test similarity is  tensor(0.2460, device='cuda:2')
test acc is  0.2132333334896703
test loss is 23.266512099105412
test entropy is  0.0875588707399489
________________________________
cal_distance is  tensor(420.4441, device='cuda:2')
cal_distance is  tensor(120.0148, device='cuda:2')
cal_distance is  tensor(34.2583, device='cuda:2')
________________________________
test distance is  tensor(34.2583, device='cuda:2')
test similarity is  tensor(0.9959, device='cuda:2')
test acc is  0.8948166668229883
test loss is 0.3904122417923738
test entropy is  0.14000734484700889
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14000734484700889
avg test loss is  0.3904122417923738
avg accuracy is  0.8948166668229883
compute_distance is  tensor(34.2583, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3822360245594338
avg test loss is  4.77347272342202
avg accuracy is  0.19266666682300265
compute_distance is  tensor(43.8754, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(43.8754, device='cuda:2')
test similarity is  tensor(0.9931, device='cuda:2')
test acc is  0.19266666682300265
test loss is 4.77347272342202
test entropy is  0.3822360245594338
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 88.71% 

Test Accuracy: 87.72% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(93.9084, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(110.3296, device='cuda:2')
compute similarity is  tensor(0.9459, device='cuda:2')
compute distance is  tensor(105.9388, device='cuda:2')
compute similarity is  tensor(0.9507, device='cuda:2')
compute distance is  tensor(112.7867, device='cuda:2')
compute similarity is  tensor(0.9425, device='cuda:2')
compute distance is  tensor(107.8487, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(101.4309, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(104.3477, device='cuda:2')
compute similarity is  tensor(0.9512, device='cuda:2')
compute distance is  tensor(98.7412, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(92.6209, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
compute distance is  tensor(112.1065, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(102.3585, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(98.0174, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
calculated distance threshold is  tensor(132.9526, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8595333334896562
====================
====================
iteration is  0
round is  1
accuracy is  0.8307000001563241
====================
====================
iteration is  0
round is  2
accuracy is  0.8485833334896566
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5640166668230073
====================
====================
iteration is  1
round is  1
accuracy is  0.37265000015634075
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6808500001563317
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2786333334896724
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.20680000015633665
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3013000001563396
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.1608666668230008
====================
succ_min + 1
________________________________
test distance is  tensor(1468.1860, device='cuda:2')
test similarity is  tensor(0.2510, device='cuda:2')
test acc is  0.1608666668230008
test loss is 30.805305358951788
test entropy is  0.044940077991379716
________________________________
cal_distance is  tensor(441.8140, device='cuda:2')
cal_distance is  tensor(132.9533, device='cuda:2')
cal_distance is  tensor(40.0095, device='cuda:2')
________________________________
test distance is  tensor(40.0095, device='cuda:2')
test similarity is  tensor(0.9945, device='cuda:2')
test acc is  0.8938166668229883
test loss is 0.4037482442854564
test entropy is  0.13645780968593
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13645780968593
avg test loss is  0.4037482442854564
avg accuracy is  0.8938166668229883
compute_distance is  tensor(40.0095, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23895880786467716
avg test loss is  5.492730877801045
avg accuracy is  0.14616666682299947
compute_distance is  tensor(45.8498, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(45.8498, device='cuda:2')
test similarity is  tensor(0.9931, device='cuda:2')
test acc is  0.14616666682299947
test loss is 5.492730877801045
test entropy is  0.23895880786467716
________________________________
num2 of attacker is  0
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 87.96% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(92.9963, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(104.0072, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(99.5323, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(113.9431, device='cuda:2')
compute similarity is  tensor(0.9426, device='cuda:2')
compute distance is  tensor(105.1856, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(94.7845, device='cuda:2')
compute similarity is  tensor(0.9597, device='cuda:2')
compute distance is  tensor(104.1353, device='cuda:2')
compute similarity is  tensor(0.9523, device='cuda:2')
compute distance is  tensor(100.4985, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(90.5892, device='cuda:2')
compute similarity is  tensor(0.9617, device='cuda:2')
compute distance is  tensor(104.8921, device='cuda:2')
compute similarity is  tensor(0.9556, device='cuda:2')
compute distance is  tensor(99.6148, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(95.2267, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
calculated distance threshold is  tensor(137.2969, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8470000001563235
====================
====================
iteration is  0
round is  1
accuracy is  0.8625833334896561
====================
====================
iteration is  0
round is  2
accuracy is  0.841083333489657
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5971333334896711
====================
====================
iteration is  1
round is  1
accuracy is  0.687316666822998
====================
====================
iteration is  1
round is  2
accuracy is  0.6484333334896671
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2178833334896705
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.45850000015634174
====================
====================
iteration is  2
round is  2
accuracy is  0.2603166668230052
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.24093333348967133
====================
====================
iteration is  3
round is  1
accuracy is  0.1659833334896678
====================
succ_min + 1
________________________________
test distance is  tensor(1467.8557, device='cuda:2')
test similarity is  tensor(0.2519, device='cuda:2')
test acc is  0.1659833334896678
test loss is 23.955083991418768
test entropy is  0.04942132815245046
________________________________
cal_distance is  tensor(448.9238, device='cuda:2')
cal_distance is  tensor(137.2977, device='cuda:2')
cal_distance is  tensor(41.9911, device='cuda:2')
________________________________
test distance is  tensor(41.9911, device='cuda:2')
test similarity is  tensor(0.9940, device='cuda:2')
test acc is  0.8958166668229882
test loss is 0.3885761236887115
test entropy is  0.13889021673070978
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13889021673070978
avg test loss is  0.3885761236887115
avg accuracy is  0.8958166668229882
compute_distance is  tensor(41.9911, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24062035428181386
avg test loss is  5.267390109836928
avg accuracy is  0.15513333348966696
compute_distance is  tensor(47.1318, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(47.1318, device='cuda:2')
test similarity is  tensor(0.9931, device='cuda:2')
test acc is  0.15513333348966696
test loss is 5.267390109836928
test entropy is  0.24062035428181386
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 87.90% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(99.5925, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(107.7094, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
compute distance is  tensor(100.6986, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(110.6611, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
compute distance is  tensor(107.9264, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(106.0255, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
compute distance is  tensor(105.0783, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
compute distance is  tensor(95.2705, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(96.5606, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(104.2436, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(97.1607, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(97.0817, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
calculated distance threshold is  tensor(126.0518, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8428666668229903
====================
====================
iteration is  0
round is  1
accuracy is  0.839383333489657
====================
====================
iteration is  0
round is  2
accuracy is  0.8395166668229904
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.49660000015634204
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6636666668229996
====================
====================
iteration is  1
round is  2
accuracy is  0.5492000001563421
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.25696666682300506
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.19716666682300293
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.274550000156339
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.14915000015633312
====================
succ_min + 1
________________________________
test distance is  tensor(1475.7837, device='cuda:2')
test similarity is  tensor(0.2518, device='cuda:2')
test acc is  0.14915000015633312
test loss is 28.42202085116779
test entropy is  0.026745839457986736
________________________________
cal_distance is  tensor(431.3069, device='cuda:2')
cal_distance is  tensor(126.0525, device='cuda:2')
cal_distance is  tensor(36.8401, device='cuda:2')
________________________________
test distance is  tensor(36.8401, device='cuda:2')
test similarity is  tensor(0.9954, device='cuda:2')
test acc is  0.8957833334896549
test loss is 0.39758450855641986
test entropy is  0.13479992296935908
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13479992296935908
avg test loss is  0.39758450855641986
avg accuracy is  0.8957833334896549
compute_distance is  tensor(36.8401, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1315148738083809
avg test loss is  5.901436168756058
avg accuracy is  0.13593333348966524
compute_distance is  tensor(42.0875, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(42.0875, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.13593333348966524
test loss is 5.901436168756058
test entropy is  0.1315148738083809
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 87.89% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(97.2071, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(107.3666, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(99.1383, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(111.4412, device='cuda:2')
compute similarity is  tensor(0.9469, device='cuda:2')
compute distance is  tensor(115.2868, device='cuda:2')
compute similarity is  tensor(0.9454, device='cuda:2')
compute distance is  tensor(98.3114, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(109.4131, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(94.8754, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(94.0348, device='cuda:2')
compute similarity is  tensor(0.9591, device='cuda:2')
compute distance is  tensor(105.6133, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(103.6175, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(103.8694, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
calculated distance threshold is  tensor(136.5387, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8581666668229897
====================
====================
iteration is  0
round is  1
accuracy is  0.8322833334896573
====================
====================
iteration is  0
round is  2
accuracy is  0.8543000001563231
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6133166668230032
====================
====================
iteration is  1
round is  1
accuracy is  0.49798333348967533
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6880333334896646
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.238650000156338
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2220000001563373
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.28390000015633915
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.32081666682300664
====================
________________________________
test distance is  tensor(1463.0166, device='cuda:2')
test similarity is  tensor(0.2516, device='cuda:2')
test acc is  0.2220000001563373
test loss is 22.274516750246224
test entropy is  0.06420177821991349
________________________________
cal_distance is  tensor(446.9440, device='cuda:2')
cal_distance is  tensor(136.5395, device='cuda:2')
cal_distance is  tensor(41.7126, device='cuda:2')
________________________________
test distance is  tensor(41.7126, device='cuda:2')
test similarity is  tensor(0.9943, device='cuda:2')
test acc is  0.8953500001563215
test loss is 0.4084527378500715
test entropy is  0.12883142936331377
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12883142936331377
avg test loss is  0.4084527378500715
avg accuracy is  0.8953500001563215
compute_distance is  tensor(41.7126, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3752987489644398
avg test loss is  3.90877715433076
avg accuracy is  0.2235833334896707
compute_distance is  tensor(48.7262, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(48.7262, device='cuda:2')
test similarity is  tensor(0.9925, device='cuda:2')
test acc is  0.2235833334896707
test loss is 3.90877715433076
test entropy is  0.3752987489644398
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 88.70% 

Test Accuracy: 87.79% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(96.0652, device='cuda:2')
compute similarity is  tensor(0.9597, device='cuda:2')
compute distance is  tensor(105.6046, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(103.3754, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(112.0091, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(104.0268, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(102.6601, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(106.2343, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(99.6917, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(88.1173, device='cuda:2')
compute similarity is  tensor(0.9663, device='cuda:2')
compute distance is  tensor(107.6677, device='cuda:2')
compute similarity is  tensor(0.9533, device='cuda:2')
compute distance is  tensor(96.8624, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(96.8672, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
calculated distance threshold is  tensor(135.9009, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8410500001563237
====================
====================
iteration is  0
round is  1
accuracy is  0.8572666668229897
====================
====================
iteration is  0
round is  2
accuracy is  0.827466666822991
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.42440000015634144
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5266833334896756
====================
====================
iteration is  1
round is  2
accuracy is  0.531116666823009
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.22856666682300417
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.34603333348967363
====================
====================
iteration is  2
round is  2
accuracy is  0.2122666668230036
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.26115000015633855
====================
________________________________
test distance is  tensor(1475.8156, device='cuda:2')
test similarity is  tensor(0.2622, device='cuda:2')
test acc is  0.2122666668230036
test loss is 24.657748840510973
test entropy is  0.052574438910716885
________________________________
cal_distance is  tensor(447.8451, device='cuda:2')
cal_distance is  tensor(135.9016, device='cuda:2')
cal_distance is  tensor(41.2407, device='cuda:2')
________________________________
test distance is  tensor(41.2407, device='cuda:2')
test similarity is  tensor(0.9945, device='cuda:2')
test acc is  0.8942666668229883
test loss is 0.4064585615767599
test entropy is  0.13168880261226631
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13168880261226631
avg test loss is  0.4064585615767599
avg accuracy is  0.8942666668229883
compute_distance is  tensor(41.2407, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22384988982031848
avg test loss is  4.778590466930414
avg accuracy is  0.20495000015633655
compute_distance is  tensor(44.9687, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.9687, device='cuda:2')
test similarity is  tensor(0.9939, device='cuda:2')
test acc is  0.20495000015633655
test loss is 4.778590466930414
test entropy is  0.22384988982031848
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 88.84% 

Test Accuracy: 88.05% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(100.8003, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(104.4843, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(102.4189, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(108.9460, device='cuda:2')
compute similarity is  tensor(0.9508, device='cuda:2')
compute distance is  tensor(109.7742, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(99.2715, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(100.9762, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(99.7423, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(95.1130, device='cuda:2')
compute similarity is  tensor(0.9623, device='cuda:2')
compute distance is  tensor(102.9563, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(97.2234, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(95.8890, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
calculated distance threshold is  tensor(124.4355, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8633666668229893
====================
====================
iteration is  0
round is  1
accuracy is  0.8563333334896563
====================
====================
iteration is  0
round is  2
accuracy is  0.8525333334896565
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7272833334896623
====================
====================
iteration is  1
round is  1
accuracy is  0.6582000001563332
====================
====================
iteration is  1
round is  2
accuracy is  0.5080000001563422
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4110166668230079
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3643000001563407
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.24538333348967145
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.21458333348967032
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2656000001563387
====================
________________________________
test distance is  tensor(1465.9562, device='cuda:2')
test similarity is  tensor(0.2643, device='cuda:2')
test acc is  0.21458333348967032
test loss is 23.329825811040426
test entropy is  0.05320348418843962
________________________________
cal_distance is  tensor(427.1036, device='cuda:2')
cal_distance is  tensor(124.4362, device='cuda:2')
cal_distance is  tensor(36.2548, device='cuda:2')
________________________________
test distance is  tensor(36.2548, device='cuda:2')
test similarity is  tensor(0.9958, device='cuda:2')
test acc is  0.8965666668229882
test loss is 0.3980506004523367
test entropy is  0.1306343964700188
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1306343964700188
avg test loss is  0.3980506004523367
avg accuracy is  0.8965666668229882
compute_distance is  tensor(36.2548, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2940044621033455
avg test loss is  4.347754787280361
avg accuracy is  0.21143333348967025
compute_distance is  tensor(44.1410, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.1410, device='cuda:2')
test similarity is  tensor(0.9938, device='cuda:2')
test acc is  0.21143333348967025
test loss is 4.347754787280361
test entropy is  0.2940044621033455
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.72% 

Test Accuracy: 87.72% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(103.9599, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(107.1594, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(107.1594, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(111.4141, device='cuda:2')
compute similarity is  tensor(0.9472, device='cuda:2')
compute distance is  tensor(114.7208, device='cuda:2')
compute similarity is  tensor(0.9484, device='cuda:2')
compute distance is  tensor(102.6330, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(104.8545, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(96.8117, device='cuda:2')
compute similarity is  tensor(0.9608, device='cuda:2')
compute distance is  tensor(97.6140, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(105.0845, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(106.0012, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(100.8668, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
calculated distance threshold is  tensor(132.6300, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8495333334896567
====================
====================
iteration is  0
round is  1
accuracy is  0.8371333334896571
====================
====================
iteration is  0
round is  2
accuracy is  0.8376333334896572
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5034833334896754
====================
====================
iteration is  1
round is  1
accuracy is  0.4734833334896752
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.49140000015634194
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2732166668230057
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.12968333348966526
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.19720000015633632
====================
________________________________
test distance is  tensor(1468.1500, device='cuda:2')
test similarity is  tensor(0.2568, device='cuda:2')
test acc is  0.12968333348966526
test loss is 30.07914008565549
test entropy is  0.022055238180909615
________________________________
cal_distance is  tensor(441.2723, device='cuda:2')
cal_distance is  tensor(132.6307, device='cuda:2')
cal_distance is  tensor(39.8645, device='cuda:2')
________________________________
test distance is  tensor(39.8645, device='cuda:2')
test similarity is  tensor(0.9950, device='cuda:2')
test acc is  0.8950333334896549
test loss is 0.411383566031578
test entropy is  0.12905116010703513
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12905116010703513
avg test loss is  0.411383566031578
avg accuracy is  0.8950333334896549
compute_distance is  tensor(39.8645, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10801049178517831
avg test loss is  5.924014792005137
avg accuracy is  0.11336666682299862
compute_distance is  tensor(44.4685, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.4685, device='cuda:2')
test similarity is  tensor(0.9943, device='cuda:2')
test acc is  0.11336666682299862
test loss is 5.924014792005137
test entropy is  0.10801049178517831
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 88.88% 

Test Accuracy: 88.10% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(101.5651, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
compute distance is  tensor(109.5004, device='cuda:2')
compute similarity is  tensor(0.9527, device='cuda:2')
compute distance is  tensor(100.5841, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(110.2446, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(104.0181, device='cuda:2')
compute similarity is  tensor(0.9576, device='cuda:2')
compute distance is  tensor(105.5250, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(109.2882, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(108.1012, device='cuda:2')
compute similarity is  tensor(0.9533, device='cuda:2')
compute distance is  tensor(100.6930, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(106.4265, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(99.8468, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(97.6317, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
calculated distance threshold is  tensor(122.8574, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8503333334896566
====================
====================
iteration is  0
round is  1
accuracy is  0.8580333334896563
====================
====================
iteration is  0
round is  2
accuracy is  0.8473500001563234
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6559500001563334
====================
====================
iteration is  1
round is  1
accuracy is  0.5505666668230087
====================
====================
iteration is  1
round is  2
accuracy is  0.45631666682300837
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.28853333348967264
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.17101666682300143
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.21521666682300375
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2721333334896722
====================
________________________________
test distance is  tensor(1465.6855, device='cuda:2')
test similarity is  tensor(0.2659, device='cuda:2')
test acc is  0.17101666682300143
test loss is 25.955474562736462
test entropy is  0.033121323179843815
________________________________
cal_distance is  tensor(424.3474, device='cuda:2')
cal_distance is  tensor(122.8581, device='cuda:2')
cal_distance is  tensor(35.5706, device='cuda:2')
________________________________
test distance is  tensor(35.5706, device='cuda:2')
test similarity is  tensor(0.9960, device='cuda:2')
test acc is  0.8961500001563215
test loss is 0.4084654470313904
test entropy is  0.12554046561294147
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12554046561294147
avg test loss is  0.4084654470313904
avg accuracy is  0.8961500001563215
compute_distance is  tensor(35.5706, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1362143409158439
avg test loss is  5.61779521523254
avg accuracy is  0.1400833334896656
compute_distance is  tensor(42.5003, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(42.5003, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.1400833334896656
test loss is 5.61779521523254
test entropy is  0.1362143409158439
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 87.84% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(95.0088, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(107.5439, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(111.3934, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(111.5254, device='cuda:2')
compute similarity is  tensor(0.9484, device='cuda:2')
compute distance is  tensor(104.6008, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(106.7044, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(109.2980, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(102.7413, device='cuda:2')
compute similarity is  tensor(0.9578, device='cuda:2')
compute distance is  tensor(100.5136, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(110.0369, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(104.4030, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(100.1492, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
calculated distance threshold is  tensor(128.0421, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8429500001563236
====================
====================
iteration is  0
round is  1
accuracy is  0.8562166668229898
====================
====================
iteration is  0
round is  2
accuracy is  0.8481833334896567
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.57330000015634
====================
====================
iteration is  1
round is  1
accuracy is  0.6611166668229997
====================
====================
iteration is  1
round is  2
accuracy is  0.49530000015634196
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2071666668230034
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.21991666682300398
====================
====================
iteration is  2
round is  2
accuracy is  0.4158666668230079
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.1706666668230014
====================
succ_min + 1
________________________________
test distance is  tensor(1464.7842, device='cuda:2')
test similarity is  tensor(0.2668, device='cuda:2')
test acc is  0.1706666668230014
test loss is 26.455850161977413
test entropy is  0.04105985620771962
________________________________
cal_distance is  tensor(433.0757, device='cuda:2')
cal_distance is  tensor(128.0428, device='cuda:2')
cal_distance is  tensor(37.8575, device='cuda:2')
________________________________
test distance is  tensor(37.8575, device='cuda:2')
test similarity is  tensor(0.9956, device='cuda:2')
test acc is  0.8954333334896549
test loss is 0.4212974816250966
test entropy is  0.12102648250456811
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12102648250456811
avg test loss is  0.4212974816250966
avg accuracy is  0.8954333334896549
compute_distance is  tensor(37.8575, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2443826781756588
avg test loss is  4.7564202435235226
avg accuracy is  0.14615000015633284
compute_distance is  tensor(44.3637, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.3637, device='cuda:2')
test similarity is  tensor(0.9942, device='cuda:2')
test acc is  0.14615000015633284
test loss is 4.7564202435235226
test entropy is  0.2443826781756588
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 88.91% 

Test Accuracy: 87.97% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(93.9518, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(109.4400, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(108.7925, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(108.2478, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(110.9387, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(110.5311, device='cuda:2')
compute similarity is  tensor(0.9525, device='cuda:2')
compute distance is  tensor(104.3145, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(100.3517, device='cuda:2')
compute similarity is  tensor(0.9597, device='cuda:2')
compute distance is  tensor(97.9816, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(106.9206, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(110.9247, device='cuda:2')
compute similarity is  tensor(0.9523, device='cuda:2')
compute distance is  tensor(102.9869, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
calculated distance threshold is  tensor(127.9255, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8600666668229895
====================
====================
iteration is  0
round is  1
accuracy is  0.8371666668229905
====================
====================
iteration is  0
round is  2
accuracy is  0.8644166668229895
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6835000001563316
====================
====================
iteration is  1
round is  1
accuracy is  0.6970000001563308
====================
====================
iteration is  1
round is  2
accuracy is  0.43441666682300806
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.32318333348967326
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.24731666682300488
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3274833334896734
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.18966666682300254
====================
succ_min + 1
________________________________
test distance is  tensor(1470.3372, device='cuda:2')
test similarity is  tensor(0.2665, device='cuda:2')
test acc is  0.18966666682300254
test loss is 31.147748717367012
test entropy is  0.04127494859566757
________________________________
cal_distance is  tensor(433.6982, device='cuda:2')
cal_distance is  tensor(127.9262, device='cuda:2')
cal_distance is  tensor(37.7343, device='cuda:2')
________________________________
test distance is  tensor(37.7343, device='cuda:2')
test similarity is  tensor(0.9956, device='cuda:2')
test acc is  0.8969166668229882
test loss is 0.4066927268791364
test entropy is  0.12351604775468042
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12351604775468042
avg test loss is  0.4066927268791364
avg accuracy is  0.8969166668229882
compute_distance is  tensor(37.7343, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22444741043454802
avg test loss is  5.308990957386204
avg accuracy is  0.1943500001563361
compute_distance is  tensor(44.7864, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.7864, device='cuda:2')
test similarity is  tensor(0.9941, device='cuda:2')
test acc is  0.1943500001563361
test loss is 5.308990957386204
test entropy is  0.22444741043454802
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 88.85% 

Test Accuracy: 88.05% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(99.1457, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(108.4768, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(103.3090, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(117.7979, device='cuda:2')
compute similarity is  tensor(0.9459, device='cuda:2')
compute distance is  tensor(107.5565, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(98.1348, device='cuda:2')
compute similarity is  tensor(0.9633, device='cuda:2')
compute distance is  tensor(114.8224, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(99.6983, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
compute distance is  tensor(92.1018, device='cuda:2')
compute similarity is  tensor(0.9650, device='cuda:2')
compute distance is  tensor(108.3276, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(103.4811, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(97.7898, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
calculated distance threshold is  tensor(143.4941, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.834350000156324
====================
====================
iteration is  0
round is  1
accuracy is  0.8597500001563229
====================
====================
iteration is  0
round is  2
accuracy is  0.84801666682299
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5047666668230087
====================
====================
iteration is  1
round is  1
accuracy is  0.6871166668229979
====================
====================
iteration is  1
round is  2
accuracy is  0.5614333334896743
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.11708333348966526
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.27471666682300566
====================
====================
iteration is  2
round is  2
accuracy is  0.191100000156336
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2945333334896728
====================
====================
iteration is  3
round is  1
accuracy is  0.24281666682300473
====================
________________________________
test distance is  tensor(1467.8129, device='cuda:2')
test similarity is  tensor(0.2685, device='cuda:2')
test acc is  0.11708333348966526
test loss is 34.56394263066208
test entropy is  0.01624890092788032
________________________________
cal_distance is  tensor(458.9368, device='cuda:2')
cal_distance is  tensor(143.4948, device='cuda:2')
cal_distance is  tensor(44.8666, device='cuda:2')
________________________________
test distance is  tensor(44.8666, device='cuda:2')
test similarity is  tensor(0.9939, device='cuda:2')
test acc is  0.8952333334896548
test loss is 0.4079758266586739
test entropy is  0.1282142756153335
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1282142756153335
avg test loss is  0.4079758266586739
avg accuracy is  0.8952333334896548
compute_distance is  tensor(44.8666, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0781379201924051
avg test loss is  6.400009556365674
avg accuracy is  0.1051833334896653
compute_distance is  tensor(48.4188, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(48.4188, device='cuda:2')
test similarity is  tensor(0.9936, device='cuda:2')
test acc is  0.1051833334896653
test loss is 6.400009556365674
test entropy is  0.0781379201924051
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 88.74% 

Test Accuracy: 87.90% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(99.4260, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(104.9822, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(106.5561, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(104.7120, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(109.4006, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(111.6125, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(105.1108, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(111.6036, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(96.9038, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(109.1373, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(104.9814, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(104.0848, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
calculated distance threshold is  tensor(126.3213, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8614833334896562
====================
====================
iteration is  0
round is  1
accuracy is  0.841583333489657
====================
====================
iteration is  0
round is  2
accuracy is  0.8621833334896561
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6464166668230007
====================
====================
iteration is  1
round is  1
accuracy is  0.5905333334896717
====================
====================
iteration is  1
round is  2
accuracy is  0.6163500001563363
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.26456666682300534
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.19471666682300284
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.22991666682300432
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.18365000015633554
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.1761166668230018
====================
succ_min + 1
________________________________
test distance is  tensor(1478.1135, device='cuda:2')
test similarity is  tensor(0.2652, device='cuda:2')
test acc is  0.1761166668230018
test loss is 35.633963021642366
test entropy is  0.040084893076267565
________________________________
cal_distance is  tensor(432.1085, device='cuda:2')
cal_distance is  tensor(126.3221, device='cuda:2')
cal_distance is  tensor(36.9293, device='cuda:2')
________________________________
test distance is  tensor(36.9293, device='cuda:2')
test similarity is  tensor(0.9959, device='cuda:2')
test acc is  0.8968000001563216
test loss is 0.4167186897526036
test entropy is  0.1196463836678691
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1196463836678691
avg test loss is  0.4167186897526036
avg accuracy is  0.8968000001563216
compute_distance is  tensor(36.9293, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22016057067874398
avg test loss is  5.830744208557519
avg accuracy is  0.1731000001563349
compute_distance is  tensor(44.8379, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.8379, device='cuda:2')
test similarity is  tensor(0.9943, device='cuda:2')
test acc is  0.1731000001563349
test loss is 5.830744208557519
test entropy is  0.22016057067874398
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 88.94% 

Test Accuracy: 87.94% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(97.0608, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(112.2294, device='cuda:2')
compute similarity is  tensor(0.9542, device='cuda:2')
compute distance is  tensor(109.7153, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(111.6110, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(117.9582, device='cuda:2')
compute similarity is  tensor(0.9498, device='cuda:2')
compute distance is  tensor(100.8301, device='cuda:2')
compute similarity is  tensor(0.9608, device='cuda:2')
compute distance is  tensor(104.0544, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(103.0493, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(100.2436, device='cuda:2')
compute similarity is  tensor(0.9618, device='cuda:2')
compute distance is  tensor(111.2246, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(107.3260, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(103.8374, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
calculated distance threshold is  tensor(138.8555, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8541666668229898
====================
====================
iteration is  0
round is  1
accuracy is  0.8458666668229902
====================
====================
iteration is  0
round is  2
accuracy is  0.867833333489656
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6321500001563349
====================
====================
iteration is  1
round is  1
accuracy is  0.5811833334896724
====================
====================
iteration is  1
round is  2
accuracy is  0.36011666682300725
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.25476666682300503
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.24416666682300472
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.34318333348967367
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.15001666682299983
====================
succ_min + 1
________________________________
test distance is  tensor(1465.8707, device='cuda:2')
test similarity is  tensor(0.2591, device='cuda:2')
test acc is  0.15001666682299983
test loss is 34.00240441629373
test entropy is  0.024971037675358
________________________________
cal_distance is  tensor(451.1594, device='cuda:2')
cal_distance is  tensor(138.8563, device='cuda:2')
cal_distance is  tensor(42.7371, device='cuda:2')
________________________________
test distance is  tensor(42.7371, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8967166668229882
test loss is 0.41534641918057064
test entropy is  0.12115908486010042
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12115908486010042
avg test loss is  0.41534641918057064
avg accuracy is  0.8967166668229882
compute_distance is  tensor(42.7371, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1292410695047648
avg test loss is  6.503652335229967
avg accuracy is  0.14470000015633264
compute_distance is  tensor(47.3794, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(47.3794, device='cuda:2')
test similarity is  tensor(0.9939, device='cuda:2')
test acc is  0.14470000015633264
test loss is 6.503652335229967
test entropy is  0.1292410695047648
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 89.04% 

Test Accuracy: 88.06% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(100.7439, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(121.1981, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(105.7454, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(111.8529, device='cuda:2')
compute similarity is  tensor(0.9523, device='cuda:2')
compute distance is  tensor(108.2609, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(102.1636, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(104.7183, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(103.1812, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(93.0438, device='cuda:2')
compute similarity is  tensor(0.9659, device='cuda:2')
compute distance is  tensor(114.4602, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(105.3865, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(105.0185, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
calculated distance threshold is  tensor(149.3523, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8437166668229902
====================
====================
iteration is  0
round is  1
accuracy is  0.8658333334896561
====================
====================
iteration is  0
round is  2
accuracy is  0.8704166668229891
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6378000001563346
====================
====================
iteration is  1
round is  1
accuracy is  0.6128166668230031
====================
====================
iteration is  1
round is  2
accuracy is  0.564033333489674
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.21091666682300358
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2255833334896708
====================
====================
iteration is  2
round is  2
accuracy is  0.27393333348967225
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.23883333348967123
====================
====================
iteration is  3
round is  1
accuracy is  0.4291000001563414
====================
________________________________
test distance is  tensor(1462.0220, device='cuda:2')
test similarity is  tensor(0.2707, device='cuda:2')
test acc is  0.21091666682300358
test loss is 22.107115165002817
test entropy is  0.054993873455130786
________________________________
cal_distance is  tensor(467.2867, device='cuda:2')
cal_distance is  tensor(149.3530, device='cuda:2')
cal_distance is  tensor(47.7362, device='cuda:2')
________________________________
test distance is  tensor(47.7362, device='cuda:2')
test similarity is  tensor(0.9934, device='cuda:2')
test acc is  0.8971666668229882
test loss is 0.4069028814861388
test entropy is  0.12124148457606973
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12124148457606973
avg test loss is  0.4069028814861388
avg accuracy is  0.8971666668229882
compute_distance is  tensor(47.7362, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.32275009493647355
avg test loss is  4.147028555748051
avg accuracy is  0.20963333348967017
compute_distance is  tensor(52.7719, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(52.7719, device='cuda:2')
test similarity is  tensor(0.9924, device='cuda:2')
test acc is  0.20963333348967017
test loss is 4.147028555748051
test entropy is  0.32275009493647355
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 87.99% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(99.8315, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(113.8418, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(112.7540, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(108.8156, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(109.2322, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(103.6241, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(108.9632, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(104.9407, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(103.5960, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(108.5987, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(106.1193, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(100.5449, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
calculated distance threshold is  tensor(127.8521, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.856700000156323
====================
====================
iteration is  0
round is  1
accuracy is  0.8550833334896565
====================
====================
iteration is  0
round is  2
accuracy is  0.8415166668229902
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5391500001563423
====================
====================
iteration is  1
round is  1
accuracy is  0.7103500001563299
====================
====================
iteration is  1
round is  2
accuracy is  0.6388000001563345
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.24265000015633806
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.14805000015633302
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3489833334896737
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.12673333348966526
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.41678333348967467
====================
________________________________
test distance is  tensor(1478.0778, device='cuda:2')
test similarity is  tensor(0.2619, device='cuda:2')
test acc is  0.12673333348966526
test loss is 34.58011401284224
test entropy is  0.023339796537415622
________________________________
cal_distance is  tensor(434.7136, device='cuda:2')
cal_distance is  tensor(127.8528, device='cuda:2')
cal_distance is  tensor(37.6030, device='cuda:2')
________________________________
test distance is  tensor(37.6030, device='cuda:2')
test similarity is  tensor(0.9959, device='cuda:2')
test acc is  0.8965000001563215
test loss is 0.4029576070368417
test entropy is  0.12921658049482526
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12921658049482526
avg test loss is  0.4029576070368417
avg accuracy is  0.8965000001563215
compute_distance is  tensor(37.6030, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13509347821190668
avg test loss is  6.312458336734569
avg accuracy is  0.12126666682299861
compute_distance is  tensor(43.6532, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(43.6532, device='cuda:2')
test similarity is  tensor(0.9948, device='cuda:2')
test acc is  0.12126666682299861
test loss is 6.312458336734569
test entropy is  0.13509347821190668
________________________________
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 88.03% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(105.3688, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(114.7972, device='cuda:2')
compute similarity is  tensor(0.9525, device='cuda:2')
compute distance is  tensor(106.4549, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(114.4667, device='cuda:2')
compute similarity is  tensor(0.9521, device='cuda:2')
compute distance is  tensor(113.9978, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(109.1708, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(110.3617, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(107.5690, device='cuda:2')
compute similarity is  tensor(0.9578, device='cuda:2')
compute distance is  tensor(100.6658, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(107.1917, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(106.4349, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(104.0449, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
calculated distance threshold is  tensor(128.9287, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8525833334896565
====================
====================
iteration is  0
round is  1
accuracy is  0.862033333489656
====================
====================
iteration is  0
round is  2
accuracy is  0.8549166668229897
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5190833334896755
====================
====================
iteration is  1
round is  1
accuracy is  0.5465166668230089
====================
====================
iteration is  1
round is  2
accuracy is  0.7135833334896631
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.17910000015633532
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.19071666682300256
====================
====================
iteration is  2
round is  2
accuracy is  0.3681500001563407
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.14905000015633307
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.23463333348967105
====================
________________________________
test distance is  tensor(1471.9059, device='cuda:2')
test similarity is  tensor(0.2719, device='cuda:2')
test acc is  0.14905000015633307
test loss is 37.33932843035472
test entropy is  0.052476381572749795
________________________________
cal_distance is  tensor(435.6276, device='cuda:2')
cal_distance is  tensor(128.9294, device='cuda:2')
cal_distance is  tensor(38.1586, device='cuda:2')
________________________________
test distance is  tensor(38.1586, device='cuda:2')
test similarity is  tensor(0.9958, device='cuda:2')
test acc is  0.8972666668229882
test loss is 0.41202390355977425
test entropy is  0.12197399753799189
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12197399753799189
avg test loss is  0.41202390355977425
avg accuracy is  0.8972666668229882
compute_distance is  tensor(38.1586, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23604022055419524
avg test loss is  6.837172354208127
avg accuracy is  0.14433333348966598
compute_distance is  tensor(46.2806, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(46.2806, device='cuda:2')
test similarity is  tensor(0.9941, device='cuda:2')
test acc is  0.14433333348966598
test loss is 6.837172354208127
test entropy is  0.23604022055419524
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 87.90% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(101.6470, device='cuda:2')
compute similarity is  tensor(0.9623, device='cuda:2')
compute distance is  tensor(108.3577, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(106.2244, device='cuda:2')
compute similarity is  tensor(0.9576, device='cuda:2')
compute distance is  tensor(111.7506, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(111.4253, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(111.0021, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(112.7850, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(102.0544, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(104.8967, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(110.7983, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(106.3908, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(102.9159, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
calculated distance threshold is  tensor(123.9230, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8711500001563225
====================
====================
iteration is  0
round is  1
accuracy is  0.8214500001563244
====================
====================
iteration is  0
round is  2
accuracy is  0.856550000156323
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7213666668229961
====================
====================
iteration is  1
round is  1
accuracy is  0.6176166668230028
====================
====================
iteration is  1
round is  2
accuracy is  0.6067666668230037
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.29888333348967294
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2654333334896721
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3240166668230066
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.30305000015633954
====================
====================
iteration is  3
round is  1
accuracy is  0.3332166668230069
====================
________________________________
test distance is  tensor(1475.8129, device='cuda:2')
test similarity is  tensor(0.2714, device='cuda:2')
test acc is  0.2654333334896721
test loss is 21.740267877639738
test entropy is  0.09702954019135884
________________________________
cal_distance is  tensor(427.6536, device='cuda:2')
cal_distance is  tensor(123.9237, device='cuda:2')
cal_distance is  tensor(35.9105, device='cuda:2')
________________________________
test distance is  tensor(35.9105, device='cuda:2')
test similarity is  tensor(0.9963, device='cuda:2')
test acc is  0.8971666668229882
test loss is 0.4176479200683614
test entropy is  0.1161645346207977
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1161645346207977
avg test loss is  0.4176479200683614
avg accuracy is  0.8971666668229882
compute_distance is  tensor(35.9105, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.511439941744052
avg test loss is  3.9602926623846675
avg accuracy is  0.24361666682300476
compute_distance is  tensor(47.6283, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(47.6283, device='cuda:2')
test similarity is  tensor(0.9936, device='cuda:2')
test acc is  0.24361666682300476
test loss is 3.9602926623846675
test entropy is  0.511439941744052
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 89.15% 

Test Accuracy: 88.12% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(99.4084, device='cuda:2')
compute similarity is  tensor(0.9633, device='cuda:2')
compute distance is  tensor(113.5757, device='cuda:2')
compute similarity is  tensor(0.9542, device='cuda:2')
compute distance is  tensor(111.0834, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(113.2978, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(109.6509, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(99.5129, device='cuda:2')
compute similarity is  tensor(0.9655, device='cuda:2')
compute distance is  tensor(108.9971, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
compute distance is  tensor(100.3004, device='cuda:2')
compute similarity is  tensor(0.9645, device='cuda:2')
compute distance is  tensor(97.1578, device='cuda:2')
compute similarity is  tensor(0.9659, device='cuda:2')
compute distance is  tensor(111.0610, device='cuda:2')
compute similarity is  tensor(0.9560, device='cuda:2')
compute distance is  tensor(99.1984, device='cuda:2')
compute similarity is  tensor(0.9635, device='cuda:2')
compute distance is  tensor(103.6972, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
calculated distance threshold is  tensor(129.9936, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8600666668229895
====================
====================
iteration is  0
round is  1
accuracy is  0.8513500001563232
====================
====================
iteration is  0
round is  2
accuracy is  0.8611166668229895
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.706466666822997
====================
====================
iteration is  1
round is  1
accuracy is  0.6393500001563345
====================
====================
iteration is  1
round is  2
accuracy is  0.625783333489669
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3035500001563396
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.1886000001563358
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.22966666682300424
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.20343333348966988
====================
====================
iteration is  3
round is  1
accuracy is  0.2509500001563383
====================
________________________________
test distance is  tensor(1479.6971, device='cuda:2')
test similarity is  tensor(0.2663, device='cuda:2')
test acc is  0.1886000001563358
test loss is 30.531475786969605
test entropy is  0.043237718587209074
________________________________
cal_distance is  tensor(438.5791, device='cuda:2')
cal_distance is  tensor(129.9943, device='cuda:2')
cal_distance is  tensor(38.5306, device='cuda:2')
________________________________
test distance is  tensor(38.5306, device='cuda:2')
test similarity is  tensor(0.9958, device='cuda:2')
test acc is  0.8988166668229881
test loss is 0.4002697603193237
test entropy is  0.12162726999981317
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12162726999981317
avg test loss is  0.4002697603193237
avg accuracy is  0.8988166668229881
compute_distance is  tensor(38.5306, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22658538719071253
avg test loss is  5.5799406240743865
avg accuracy is  0.17628333348966843
compute_distance is  tensor(45.4984, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(45.4984, device='cuda:2')
test similarity is  tensor(0.9944, device='cuda:2')
test acc is  0.17628333348966843
test loss is 5.5799406240743865
test entropy is  0.22658538719071253
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 89.07% 

Test Accuracy: 88.06% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(105.5770, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(112.6029, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(106.1053, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(116.9316, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(113.3781, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(105.1107, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(110.0241, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(105.9105, device='cuda:2')
compute similarity is  tensor(0.9591, device='cuda:2')
compute distance is  tensor(100.8805, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(110.9022, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
compute distance is  tensor(107.3712, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(108.4032, device='cuda:2')
compute similarity is  tensor(0.9576, device='cuda:2')
calculated distance threshold is  tensor(132.9827, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8522833334896566
====================
====================
iteration is  0
round is  1
accuracy is  0.8643833334896561
====================
====================
iteration is  0
round is  2
accuracy is  0.8630000001563227
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6720833334896656
====================
====================
iteration is  1
round is  1
accuracy is  0.6666666668229992
====================
====================
iteration is  1
round is  2
accuracy is  0.6179833334896694
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.19221666682300265
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.36868333348967397
====================
====================
iteration is  2
round is  2
accuracy is  0.20538333348967003
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2262000001563376
====================
====================
iteration is  3
round is  1
accuracy is  0.1946833334896695
====================
________________________________
test distance is  tensor(1462.4009, device='cuda:2')
test similarity is  tensor(0.2819, device='cuda:2')
test acc is  0.19221666682300265
test loss is 27.202150806435135
test entropy is  0.033552538372078805
________________________________
cal_distance is  tensor(440.9927, device='cuda:2')
cal_distance is  tensor(132.9835, device='cuda:2')
cal_distance is  tensor(40.1022, device='cuda:2')
________________________________
test distance is  tensor(40.1022, device='cuda:2')
test similarity is  tensor(0.9955, device='cuda:2')
test acc is  0.8986833334896548
test loss is 0.41118644863796006
test entropy is  0.11779657640119097
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11779657640119097
avg test loss is  0.41118644863796006
avg accuracy is  0.8986833334896548
compute_distance is  tensor(40.1022, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1841678314053936
avg test loss is  5.017846705308601
avg accuracy is  0.18796666682300248
compute_distance is  tensor(44.1716, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(44.1716, device='cuda:2')
test similarity is  tensor(0.9949, device='cuda:2')
test acc is  0.18796666682300248
test loss is 5.017846705308601
test entropy is  0.1841678314053936
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 89.09% 

Test Accuracy: 88.07% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(100.0923, device='cuda:2')
compute similarity is  tensor(0.9632, device='cuda:2')
compute distance is  tensor(110.0356, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(102.0442, device='cuda:2')
compute similarity is  tensor(0.9632, device='cuda:2')
compute distance is  tensor(120.8877, device='cuda:2')
compute similarity is  tensor(0.9471, device='cuda:2')
compute distance is  tensor(106.3470, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(107.9115, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(105.4043, device='cuda:2')
compute similarity is  tensor(0.9593, device='cuda:2')
compute distance is  tensor(103.1574, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
compute distance is  tensor(103.0365, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(105.2064, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(107.2157, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(101.5360, device='cuda:2')
compute similarity is  tensor(0.9631, device='cuda:2')
calculated distance threshold is  tensor(141.6830, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8514000001563232
====================
====================
iteration is  0
round is  1
accuracy is  0.8466166668229901
====================
====================
iteration is  0
round is  2
accuracy is  0.8479833334896567
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6404333334896677
====================
====================
iteration is  1
round is  1
accuracy is  0.5967166668230046
====================
====================
iteration is  1
round is  2
accuracy is  0.6926333334896643
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.31788333348967324
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.18168333348966878
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3238833334896733
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.15298333348966678
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.41100000015634125
====================
________________________________
test distance is  tensor(1460.7107, device='cuda:2')
test similarity is  tensor(0.2753, device='cuda:2')
test acc is  0.15298333348966678
test loss is 28.067344047367445
test entropy is  0.027454233919261647
________________________________
cal_distance is  tensor(454.9269, device='cuda:2')
cal_distance is  tensor(141.6838, device='cuda:2')
cal_distance is  tensor(44.1268, device='cuda:2')
________________________________
test distance is  tensor(44.1268, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8987000001563216
test loss is 0.4045262600281345
test entropy is  0.12104599928852719
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.12104599928852719
avg test loss is  0.4045262600281345
avg accuracy is  0.8987000001563216
compute_distance is  tensor(44.1268, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1781817771224325
avg test loss is  5.430062884206711
avg accuracy is  0.15538333348966699
compute_distance is  tensor(49.5454, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(49.5454, device='cuda:2')
test similarity is  tensor(0.9938, device='cuda:2')
test acc is  0.15538333348966699
test loss is 5.430062884206711
test entropy is  0.1781817771224325
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 89.05% 

Test Accuracy: 88.14% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(107.1709, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(110.4626, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(109.7234, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(111.0691, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(114.8307, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(107.8554, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(111.4399, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(114.0436, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(102.3332, device='cuda:2')
compute similarity is  tensor(0.9625, device='cuda:2')
compute distance is  tensor(108.3275, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(104.7007, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
compute distance is  tensor(110.6120, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
calculated distance threshold is  tensor(127.3282, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8493833334896567
====================
====================
iteration is  0
round is  1
accuracy is  0.8643333334896562
====================
====================
iteration is  0
round is  2
accuracy is  0.8583833334896563
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.701583333489664
====================
====================
iteration is  1
round is  1
accuracy is  0.5582833334896745
====================
====================
iteration is  1
round is  2
accuracy is  0.5520333334896752
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.25981666682300525
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.41318333348967456
====================
====================
iteration is  2
round is  2
accuracy is  0.344216666823007
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.3305833334896734
====================
====================
iteration is  3
round is  1
accuracy is  0.1707166668230014
====================
succ_min + 1
________________________________
test distance is  tensor(1477.3110, device='cuda:2')
test similarity is  tensor(0.2736, device='cuda:2')
test acc is  0.1707166668230014
test loss is 30.84034924415637
test entropy is  0.032700714629405596
________________________________
cal_distance is  tensor(433.7094, device='cuda:2')
cal_distance is  tensor(127.3290, device='cuda:2')
cal_distance is  tensor(37.3818, device='cuda:2')
________________________________
test distance is  tensor(37.3818, device='cuda:2')
test similarity is  tensor(0.9961, device='cuda:2')
test acc is  0.8985333334896547
test loss is 0.40787324538903197
test entropy is  0.11869302198592661
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11869302198592661
avg test loss is  0.40787324538903197
avg accuracy is  0.8985333334896547
compute_distance is  tensor(37.3818, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15044691848125794
avg test loss is  5.913248288351844
avg accuracy is  0.15471666682300023
compute_distance is  tensor(43.8516, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(43.8516, device='cuda:2')
test similarity is  tensor(0.9950, device='cuda:2')
test acc is  0.15471666682300023
test loss is 5.913248288351844
test entropy is  0.15044691848125794
________________________________
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 89.09% 

Test Accuracy: 88.23% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(110.0542, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(117.2594, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(109.5954, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(119.6201, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
compute distance is  tensor(120.2484, device='cuda:2')
compute similarity is  tensor(0.9508, device='cuda:2')
compute distance is  tensor(113.9196, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(108.0847, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(107.4022, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(98.8292, device='cuda:2')
compute similarity is  tensor(0.9641, device='cuda:2')
compute distance is  tensor(114.8839, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(105.0510, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(101.6757, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
calculated distance threshold is  tensor(141.6676, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8609333334896562
====================
====================
iteration is  0
round is  1
accuracy is  0.8508833334896565
====================
====================
iteration is  0
round is  2
accuracy is  0.868633333489656
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6956666668229975
====================
====================
iteration is  1
round is  1
accuracy is  0.6113000001563366
====================
====================
iteration is  1
round is  2
accuracy is  0.6452500001563342
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2629833334896719
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.19336666682300274
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.17188333348966814
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.17243333348966822
====================
====================
iteration is  3
round is  1
accuracy is  0.20223333348966985
====================
________________________________
test distance is  tensor(1473.4052, device='cuda:2')
test similarity is  tensor(0.2776, device='cuda:2')
test acc is  0.17188333348966814
test loss is 30.1334690610483
test entropy is  0.04896352532853895
________________________________
cal_distance is  tensor(456.8745, device='cuda:2')
cal_distance is  tensor(141.6684, device='cuda:2')
cal_distance is  tensor(43.9291, device='cuda:2')
________________________________
test distance is  tensor(43.9291, device='cuda:2')
test similarity is  tensor(0.9947, device='cuda:2')
test acc is  0.8990666668229881
test loss is 0.41105678677956053
test entropy is  0.11546005716503684
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11546005716503684
avg test loss is  0.41105678677956053
avg accuracy is  0.8990666668229881
compute_distance is  tensor(43.9291, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3394642659564262
avg test loss is  5.58482490419579
avg accuracy is  0.17568333348966844
compute_distance is  tensor(53.2834, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(53.2834, device='cuda:2')
test similarity is  tensor(0.9926, device='cuda:2')
test acc is  0.17568333348966844
test loss is 5.58482490419579
test entropy is  0.3394642659564262
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 89.02% 

Test Accuracy: 88.20% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(100.3618, device='cuda:2')
compute similarity is  tensor(0.9628, device='cuda:2')
compute distance is  tensor(111.4318, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(105.4763, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(116.8221, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
compute distance is  tensor(120.5124, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(104.8216, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
compute distance is  tensor(111.2780, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(110.4777, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(103.0979, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(115.3254, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(100.3166, device='cuda:2')
compute similarity is  tensor(0.9643, device='cuda:2')
compute distance is  tensor(104.4671, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
calculated distance threshold is  tensor(140.7082, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8630666668229895
====================
====================
iteration is  0
round is  1
accuracy is  0.8505500001563232
====================
====================
iteration is  0
round is  2
accuracy is  0.8651500001563227
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6613500001563329
====================
====================
iteration is  1
round is  1
accuracy is  0.6845666668229982
====================
====================
iteration is  1
round is  2
accuracy is  0.6396500001563346
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2704833334896722
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.25083333348967163
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.33916666682300695
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.30973333348967313
====================
====================
iteration is  3
round is  1
accuracy is  0.32710000015634005
====================
________________________________
test distance is  tensor(1464.8229, device='cuda:2')
test similarity is  tensor(0.2722, device='cuda:2')
test acc is  0.25083333348967163
test loss is 23.103744265875584
test entropy is  0.06253476727501686
________________________________
cal_distance is  tensor(453.9968, device='cuda:2')
cal_distance is  tensor(140.7089, device='cuda:2')
cal_distance is  tensor(43.6108, device='cuda:2')
________________________________
test distance is  tensor(43.6108, device='cuda:2')
test similarity is  tensor(0.9948, device='cuda:2')
test acc is  0.8980833334896549
test loss is 0.41244786008715884
test entropy is  0.116496511125393
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.116496511125393
avg test loss is  0.41244786008715884
avg accuracy is  0.8980833334896549
compute_distance is  tensor(43.6108, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3172414270418285
avg test loss is  4.449713236487496
avg accuracy is  0.2295666668230043
compute_distance is  tensor(48.7396, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(48.7396, device='cuda:2')
test similarity is  tensor(0.9937, device='cuda:2')
test acc is  0.2295666668230043
test loss is 4.449713236487496
test entropy is  0.3172414270418285
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 88.98% 

Test Accuracy: 88.18% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(100.0404, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(115.1970, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(107.2169, device='cuda:2')
compute similarity is  tensor(0.9597, device='cuda:2')
compute distance is  tensor(115.2776, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(112.5921, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
compute distance is  tensor(98.1566, device='cuda:2')
compute similarity is  tensor(0.9653, device='cuda:2')
compute distance is  tensor(111.4551, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(108.0208, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(97.9852, device='cuda:2')
compute similarity is  tensor(0.9654, device='cuda:2')
compute distance is  tensor(111.9914, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(118.9744, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(103.3355, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
calculated distance threshold is  tensor(139.9636, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8600500001563228
====================
====================
iteration is  0
round is  1
accuracy is  0.8664500001563226
====================
====================
iteration is  0
round is  2
accuracy is  0.8544833334896564
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7086166668229967
====================
====================
iteration is  1
round is  1
accuracy is  0.6100500001563368
====================
====================
iteration is  1
round is  2
accuracy is  0.5814166668230057
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.29271666682300607
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.34035000015634026
====================
====================
iteration is  2
round is  2
accuracy is  0.32335000015633997
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2843333334896725
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.22458333348967077
====================
succ_min + 1
________________________________
test distance is  tensor(1474.2266, device='cuda:2')
test similarity is  tensor(0.2783, device='cuda:2')
test acc is  0.22458333348967077
test loss is 24.222971531882216
test entropy is  0.05140711851854886
________________________________
cal_distance is  tensor(454.2450, device='cuda:2')
cal_distance is  tensor(139.9643, device='cuda:2')
cal_distance is  tensor(43.1269, device='cuda:2')
________________________________
test distance is  tensor(43.1269, device='cuda:2')
test similarity is  tensor(0.9949, device='cuda:2')
test acc is  0.8987333334896548
test loss is 0.411144432021992
test entropy is  0.11611820280806089
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11611820280806089
avg test loss is  0.411144432021992
avg accuracy is  0.8987333334896548
compute_distance is  tensor(43.1269, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.286529046783188
avg test loss is  4.666690928849584
avg accuracy is  0.21626666682300377
compute_distance is  tensor(47.8723, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(47.8723, device='cuda:2')
test similarity is  tensor(0.9940, device='cuda:2')
test acc is  0.21626666682300377
test loss is 4.666690928849584
test entropy is  0.286529046783188
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 88.06% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(102.8291, device='cuda:2')
compute similarity is  tensor(0.9631, device='cuda:2')
compute distance is  tensor(118.4439, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(115.6860, device='cuda:2')
compute similarity is  tensor(0.9521, device='cuda:2')
compute distance is  tensor(120.8436, device='cuda:2')
compute similarity is  tensor(0.9485, device='cuda:2')
compute distance is  tensor(115.0174, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(107.9928, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(108.1238, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(106.9714, device='cuda:2')
compute similarity is  tensor(0.9612, device='cuda:2')
compute distance is  tensor(102.0243, device='cuda:2')
compute similarity is  tensor(0.9631, device='cuda:2')
compute distance is  tensor(105.8065, device='cuda:2')
compute similarity is  tensor(0.9625, device='cuda:2')
compute distance is  tensor(111.4665, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(106.3859, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
calculated distance threshold is  tensor(139.6628, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8580166668229896
====================
====================
iteration is  0
round is  1
accuracy is  0.8388666668229904
====================
====================
iteration is  0
round is  2
accuracy is  0.8577833334896563
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6017333334896707
====================
====================
iteration is  1
round is  1
accuracy is  0.4817166668230086
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5815166668230057
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.31010000015633976
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3101666668230064
====================
====================
iteration is  2
round is  2
accuracy is  0.32171666682300665
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2723166668230056
====================
succ_min + 1
________________________________
test distance is  tensor(1470.8082, device='cuda:2')
test similarity is  tensor(0.2741, device='cuda:2')
test acc is  0.2723166668230056
test loss is 24.86227727698873
test entropy is  0.06115367660310858
________________________________
cal_distance is  tensor(453.2304, device='cuda:2')
cal_distance is  tensor(139.6636, device='cuda:2')
cal_distance is  tensor(43.0379, device='cuda:2')
________________________________
test distance is  tensor(43.0379, device='cuda:2')
test similarity is  tensor(0.9949, device='cuda:2')
test acc is  0.8982500001563215
test loss is 0.4206414875318247
test entropy is  0.11261513957511514
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11261513957511514
avg test loss is  0.4206414875318247
avg accuracy is  0.8982500001563215
compute_distance is  tensor(43.0379, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3687539462850038
avg test loss is  4.3560071975183385
avg accuracy is  0.2765333334896723
compute_distance is  tensor(50.1743, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(50.1743, device='cuda:2')
test similarity is  tensor(0.9935, device='cuda:2')
test acc is  0.2765333334896723
test loss is 4.3560071975183385
test entropy is  0.3687539462850038
________________________________
num2 of attacker is  0
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 89.06% 

Test Accuracy: 88.17% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(99.0195, device='cuda:2')
compute similarity is  tensor(0.9638, device='cuda:2')
compute distance is  tensor(111.9809, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(107.6956, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(114.7872, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(118.3964, device='cuda:2')
compute similarity is  tensor(0.9535, device='cuda:2')
compute distance is  tensor(98.5832, device='cuda:2')
compute similarity is  tensor(0.9662, device='cuda:2')
compute distance is  tensor(108.8221, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(113.9986, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(106.5329, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(108.7936, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(107.5482, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(107.1566, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
calculated distance threshold is  tensor(138.2095, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8523000001563232
====================
====================
iteration is  0
round is  1
accuracy is  0.8596000001563229
====================
====================
iteration is  0
round is  2
accuracy is  0.8193333334896579
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.680583333489665
====================
====================
iteration is  1
round is  1
accuracy is  0.5824000001563391
====================
====================
iteration is  1
round is  2
accuracy is  0.680783333489665
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.21603333348967044
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.25581666682300513
====================
====================
iteration is  2
round is  2
accuracy is  0.3029166668230063
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.2838166668230058
====================
====================
iteration is  3
round is  1
accuracy is  0.3688500001563407
====================
________________________________
test distance is  tensor(1476.6740, device='cuda:2')
test similarity is  tensor(0.2752, device='cuda:2')
test acc is  0.21603333348967044
test loss is 28.318021949166173
test entropy is  0.05931736540490154
________________________________
cal_distance is  tensor(451.7642, device='cuda:2')
cal_distance is  tensor(138.2103, device='cuda:2')
cal_distance is  tensor(42.2837, device='cuda:2')
________________________________
test distance is  tensor(42.2837, device='cuda:2')
test similarity is  tensor(0.9951, device='cuda:2')
test acc is  0.8986666668229882
test loss is 0.4114229605753602
test entropy is  0.11624114970360865
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11624114970360865
avg test loss is  0.4114229605753602
avg accuracy is  0.8986666668229882
compute_distance is  tensor(42.2837, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.37403730555638065
avg test loss is  4.773250196025824
avg accuracy is  0.22045000015633726
compute_distance is  tensor(50.8430, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(50.8430, device='cuda:2')
test similarity is  tensor(0.9932, device='cuda:2')
test acc is  0.22045000015633726
test loss is 4.773250196025824
test entropy is  0.37403730555638065
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 89.05% 

Test Accuracy: 88.17% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of model dicts is  12
compute distance is  tensor(114.1456, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(111.0360, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(107.7771, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(118.1895, device='cuda:2')
compute similarity is  tensor(0.9512, device='cuda:2')
compute distance is  tensor(115.7360, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(106.9353, device='cuda:2')
compute similarity is  tensor(0.9616, device='cuda:2')
compute distance is  tensor(106.1132, device='cuda:2')
compute similarity is  tensor(0.9617, device='cuda:2')
compute distance is  tensor(102.7601, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(113.5190, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(112.4131, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(111.6071, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(100.3632, device='cuda:2')
compute similarity is  tensor(0.9644, device='cuda:2')
calculated distance threshold is  tensor(136.0158, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8603500001563229
====================
====================
iteration is  0
round is  1
accuracy is  0.831000000156324
====================
====================
iteration is  0
round is  2
accuracy is  0.8506166668229899
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7063666668229969
====================
====================
iteration is  1
round is  1
accuracy is  0.6425000001563342
====================
====================
iteration is  1
round is  2
accuracy is  0.7075166668229969
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.36638333348967406
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.21590000015633715
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.28835000015633927
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.26875000015633876
====================
====================
iteration is  3
round is  1
accuracy is  0.21640000015633712
====================
________________________________
test distance is  tensor(1471.1802, device='cuda:2')
test similarity is  tensor(0.2787, device='cuda:2')
test acc is  0.21590000015633715
test loss is 24.600074603359328
test entropy is  0.06001633069098695
________________________________
cal_distance is  tensor(447.3301, device='cuda:2')
cal_distance is  tensor(136.0165, device='cuda:2')
cal_distance is  tensor(41.3579, device='cuda:2')
________________________________
test distance is  tensor(41.3579, device='cuda:2')
test similarity is  tensor(0.9954, device='cuda:2')
test acc is  0.8987000001563216
test loss is 0.4094911669609326
test entropy is  0.11764662583737867
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11764662583737867
avg test loss is  0.4094911669609326
avg accuracy is  0.8987000001563216
compute_distance is  tensor(41.3579, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.32002104199263076
avg test loss is  4.793478621602821
avg accuracy is  0.18310000015633554
compute_distance is  tensor(49.5279, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(49.5279, device='cuda:2')
test similarity is  tensor(0.9936, device='cuda:2')
test acc is  0.18310000015633554
test loss is 4.793478621602821
test entropy is  0.32002104199263076
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 89.11% 

Test Accuracy: 88.11% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 89.11%
|----0th round Training Accuracy : 82.77%
|----1th round Training Accuracy : 85.73%
|----2th round Training Accuracy : 86.83%
|----3th round Training Accuracy : 87.13%
|----4th round Training Accuracy : 87.64%
|----5th round Training Accuracy : 87.77%
|----6th round Training Accuracy : 87.91%
|----7th round Training Accuracy : 88.13%
|----8th round Training Accuracy : 87.94%
|----9th round Training Accuracy : 88.43%
|----10th round Training Accuracy : 88.10%
|----11th round Training Accuracy : 88.43%
|----12th round Training Accuracy : 88.05%
|----13th round Training Accuracy : 88.38%
|----14th round Training Accuracy : 88.52%
|----15th round Training Accuracy : 88.57%
|----16th round Training Accuracy : 88.55%
|----17th round Training Accuracy : 88.68%
|----18th round Training Accuracy : 88.54%
|----19th round Training Accuracy : 88.65%
|----20th round Training Accuracy : 88.77%
|----21th round Training Accuracy : 88.92%
|----22th round Training Accuracy : 88.71%
|----23th round Training Accuracy : 88.93%
|----24th round Training Accuracy : 88.98%
|----25th round Training Accuracy : 88.83%
|----26th round Training Accuracy : 88.70%
|----27th round Training Accuracy : 88.84%
|----28th round Training Accuracy : 88.72%
|----29th round Training Accuracy : 88.88%
|----30th round Training Accuracy : 88.82%
|----31th round Training Accuracy : 88.91%
|----32th round Training Accuracy : 88.85%
|----33th round Training Accuracy : 88.74%
|----34th round Training Accuracy : 88.94%
|----35th round Training Accuracy : 89.04%
|----36th round Training Accuracy : 88.93%
|----37th round Training Accuracy : 88.93%
|----38th round Training Accuracy : 89.02%
|----39th round Training Accuracy : 89.15%
|----40th round Training Accuracy : 89.07%
|----41th round Training Accuracy : 89.09%
|----42th round Training Accuracy : 89.05%
|----43th round Training Accuracy : 89.09%
|----44th round Training Accuracy : 89.02%
|----45th round Training Accuracy : 88.98%
|----46th round Training Accuracy : 88.93%
|----47th round Training Accuracy : 89.06%
|----48th round Training Accuracy : 89.05%
|----49th round Training Accuracy : 89.11%
|----Final Test Accuracy: 88.11%
|----0th round Final Test Accuracy : 81.64%
|----1th round Final Test Accuracy : 84.64%
|----2th round Final Test Accuracy : 85.46%
|----3th round Final Test Accuracy : 86.13%
|----4th round Final Test Accuracy : 86.35%
|----5th round Final Test Accuracy : 86.76%
|----6th round Final Test Accuracy : 86.89%
|----7th round Final Test Accuracy : 87.05%
|----8th round Final Test Accuracy : 87.26%
|----9th round Final Test Accuracy : 87.07%
|----10th round Final Test Accuracy : 87.15%
|----11th round Final Test Accuracy : 87.56%
|----12th round Final Test Accuracy : 87.18%
|----13th round Final Test Accuracy : 87.51%
|----14th round Final Test Accuracy : 87.67%
|----15th round Final Test Accuracy : 87.71%
|----16th round Final Test Accuracy : 87.34%
|----17th round Final Test Accuracy : 87.58%
|----18th round Final Test Accuracy : 87.30%
|----19th round Final Test Accuracy : 87.67%
|----20th round Final Test Accuracy : 87.73%
|----21th round Final Test Accuracy : 87.77%
|----22th round Final Test Accuracy : 87.72%
|----23th round Final Test Accuracy : 87.96%
|----24th round Final Test Accuracy : 87.90%
|----25th round Final Test Accuracy : 87.89%
|----26th round Final Test Accuracy : 87.79%
|----27th round Final Test Accuracy : 88.05%
|----28th round Final Test Accuracy : 87.72%
|----29th round Final Test Accuracy : 88.10%
|----30th round Final Test Accuracy : 87.84%
|----31th round Final Test Accuracy : 87.97%
|----32th round Final Test Accuracy : 88.05%
|----33th round Final Test Accuracy : 87.90%
|----34th round Final Test Accuracy : 87.94%
|----35th round Final Test Accuracy : 88.06%
|----36th round Final Test Accuracy : 87.99%
|----37th round Final Test Accuracy : 88.03%
|----38th round Final Test Accuracy : 87.90%
|----39th round Final Test Accuracy : 88.12%
|----40th round Final Test Accuracy : 88.06%
|----41th round Final Test Accuracy : 88.07%
|----42th round Final Test Accuracy : 88.14%
|----43th round Final Test Accuracy : 88.23%
|----44th round Final Test Accuracy : 88.20%
|----45th round Final Test Accuracy : 88.18%
|----46th round Final Test Accuracy : 88.06%
|----47th round Final Test Accuracy : 88.17%
|----48th round Final Test Accuracy : 88.17%
|----49th round Final Test Accuracy : 88.11%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 12640.6033
