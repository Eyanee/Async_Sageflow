
Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
Files already downloaded and verified
Files already downloaded and verified
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
 benign loss is  2.3173364911760603
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.00011092951172031462
 benign empirical indicaor res is  0.00011092951172031462
 benign loss is  2.3206257138933455
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.00036495181848295033
 benign empirical indicaor res is  0.00036495181848295033
 benign loss is  2.3226969752992903
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  9.87981038633734e-05
 benign empirical indicaor res is  9.87981038633734e-05
 benign loss is  2.300699063709804
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.00031199108343571424
 benign empirical indicaor res is  0.00031199108343571424
 benign loss is  2.3131715740476335
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 9.74% 

Test Accuracy: 10.00% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0009615220478735864
 benign empirical indicaor res is  0.0009615220478735864
 benign loss is  2.1833879266466414
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 10.26% 

Test Accuracy: 10.00% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.002298007719218731
 benign empirical indicaor res is  0.002298007719218731
 benign loss is  2.204250224999019
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 15.65% 

Test Accuracy: 15.49% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.014313092455267906
 benign empirical indicaor res is  0.014313092455267906
 benign loss is  2.022433911051069
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 16.84% 

Test Accuracy: 17.27% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0009658730123192072
 benign empirical indicaor res is  0.0009658730123192072
 benign loss is  1.9193257008280074
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 24.52% 

Test Accuracy: 24.99% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.018190914765000343
 benign empirical indicaor res is  0.018190914765000343
 benign loss is  2.0171368973595754
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 26.80% 

Test Accuracy: 26.88% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.002013503573834896
 benign empirical indicaor res is  0.002013503573834896
 benign loss is  2.0173762951578413
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 31.59% 

Test Accuracy: 32.00% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(4.4154, device='cuda:2')
diff2 is tensor(4.4154, device='cuda:2')
diff1 is tensor(-1.6943, device='cuda:2')
diff2 is tensor(-1.6943, device='cuda:2')
diff1 is tensor(-56.6368, device='cuda:2')
diff2 is tensor(-56.6368, device='cuda:2')
diff1 is tensor(-0.0246, device='cuda:2')
diff2 is tensor(-0.0246, device='cuda:2')
diff1 is tensor(-69.8492, device='cuda:2')
diff2 is tensor(-69.8492, device='cuda:2')
diff1 is tensor(0.3007, device='cuda:2')
diff2 is tensor(0.3007, device='cuda:2')
diff1 is tensor(-52.7135, device='cuda:2')
diff2 is tensor(-52.7135, device='cuda:2')
diff1 is tensor(0.1534, device='cuda:2')
diff2 is tensor(0.1534, device='cuda:2')
diff1 is tensor(-54.9379, device='cuda:2')
diff2 is tensor(-54.9379, device='cuda:2')
diff1 is tensor(-0.4787, device='cuda:2')
diff2 is tensor(-0.4787, device='cuda:2')
diff1 is tensor(-131.5343, device='cuda:2')
diff2 is tensor(-131.5343, device='cuda:2')
diff1 is tensor(-0.6963, device='cuda:2')
diff2 is tensor(-0.6963, device='cuda:2')
diff1 is tensor(-110.7042, device='cuda:2')
diff2 is tensor(-110.7042, device='cuda:2')
diff1 is tensor(-0.9159, device='cuda:2')
diff2 is tensor(-0.9159, device='cuda:2')
diff1 is tensor(-112.0373, device='cuda:2')
diff2 is tensor(-112.0373, device='cuda:2')
diff1 is tensor(-0.6733, device='cuda:2')
diff2 is tensor(-0.6733, device='cuda:2')
diff1 is tensor(-0.0090, device='cuda:2')
diff2 is tensor(-0.0090, device='cuda:2')
diff1 is tensor(-2.0862e-07, device='cuda:2')
diff2 is tensor(-2.0862e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(481.1654, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(480.0847, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(479.5522, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(480.3949, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(480.5008, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(480.5591, device='cuda:2')
compute similarity is  tensor(0.9873, device='cuda:2')
compute distance is  tensor(478.9427, device='cuda:2')
compute similarity is  tensor(0.9873, device='cuda:2')
compute distance is  tensor(480.4164, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(479.7540, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(478.3953, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(481.2268, device='cuda:2')
compute similarity is  tensor(0.9872, device='cuda:2')
compute distance is  tensor(480.0592, device='cuda:2')
compute similarity is  tensor(0.9871, device='cuda:2')
calculated distance threshold is  tensor(481.2268, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2557800001564036
inner product is  tensor(2.5096, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24428000015640325
inner product is  tensor(2.4838, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.22526000015640235
inner product is  tensor(2.3814, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.24078000015640308
inner product is  tensor(2.8836, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.24710000015640332
inner product is  tensor(2.3352, device='cuda:2')
====================
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1061.3771, device='cuda:2')
test similarity is  tensor(0.7029, device='cuda:2')
test acc is  0.22526000015640235
test loss is 1.9439392060879856
test entropy is  1.979388491881778
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.979388491881778
avg test loss is  1.9439392060879856
avg accuracy is  0.22526000015640235
compute_distance is  tensor(1061.3771, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 29.11% 

Test Accuracy: 29.56% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.9946, device='cuda:2')
diff2 is tensor(-0.9946, device='cuda:2')
diff1 is tensor(0.1310, device='cuda:2')
diff2 is tensor(0.1310, device='cuda:2')
diff1 is tensor(-50.1934, device='cuda:2')
diff2 is tensor(-50.1934, device='cuda:2')
diff1 is tensor(-1.4263, device='cuda:2')
diff2 is tensor(-1.4263, device='cuda:2')
diff1 is tensor(-47.2162, device='cuda:2')
diff2 is tensor(-47.2162, device='cuda:2')
diff1 is tensor(-0.2374, device='cuda:2')
diff2 is tensor(-0.2374, device='cuda:2')
diff1 is tensor(-2.5342, device='cuda:2')
diff2 is tensor(-2.5342, device='cuda:2')
diff1 is tensor(0.1853, device='cuda:2')
diff2 is tensor(0.1853, device='cuda:2')
diff1 is tensor(-29.5156, device='cuda:2')
diff2 is tensor(-29.5156, device='cuda:2')
diff1 is tensor(1.1370, device='cuda:2')
diff2 is tensor(1.1370, device='cuda:2')
diff1 is tensor(-30.5023, device='cuda:2')
diff2 is tensor(-30.5023, device='cuda:2')
diff1 is tensor(0.4071, device='cuda:2')
diff2 is tensor(0.4071, device='cuda:2')
diff1 is tensor(-20.4881, device='cuda:2')
diff2 is tensor(-20.4881, device='cuda:2')
diff1 is tensor(1.2462, device='cuda:2')
diff2 is tensor(1.2462, device='cuda:2')
diff1 is tensor(-20.4148, device='cuda:2')
diff2 is tensor(-20.4148, device='cuda:2')
diff1 is tensor(1.0484, device='cuda:2')
diff2 is tensor(1.0484, device='cuda:2')
diff1 is tensor(0.0104, device='cuda:2')
diff2 is tensor(0.0104, device='cuda:2')
diff1 is tensor(1.4901e-07, device='cuda:2')
diff2 is tensor(1.4901e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(779.7911, device='cuda:2')
compute similarity is  tensor(0.9226, device='cuda:2')
compute distance is  tensor(774.2888, device='cuda:2')
compute similarity is  tensor(0.9229, device='cuda:2')
compute distance is  tensor(774.8341, device='cuda:2')
compute similarity is  tensor(0.9232, device='cuda:2')
compute distance is  tensor(775.2411, device='cuda:2')
compute similarity is  tensor(0.9230, device='cuda:2')
compute distance is  tensor(779.2524, device='cuda:2')
compute similarity is  tensor(0.9229, device='cuda:2')
compute distance is  tensor(781.9490, device='cuda:2')
compute similarity is  tensor(0.9227, device='cuda:2')
compute distance is  tensor(768.6425, device='cuda:2')
compute similarity is  tensor(0.9232, device='cuda:2')
compute distance is  tensor(783.3984, device='cuda:2')
compute similarity is  tensor(0.9223, device='cuda:2')
compute distance is  tensor(771.0417, device='cuda:2')
compute similarity is  tensor(0.9231, device='cuda:2')
compute distance is  tensor(764.3647, device='cuda:2')
compute similarity is  tensor(0.9236, device='cuda:2')
compute distance is  tensor(785.7217, device='cuda:2')
compute similarity is  tensor(0.9222, device='cuda:2')
compute distance is  tensor(783.1393, device='cuda:2')
compute similarity is  tensor(0.9224, device='cuda:2')
calculated distance threshold is  tensor(785.7217, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.2739800001564042
inner product is  tensor(147.4892, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.26548000015640394
inner product is  tensor(148.3637, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.2319800001564027
inner product is  tensor(146.8862, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2187000001564021
inner product is  tensor(150.5661, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.26932000015640417
inner product is  tensor(149.6295, device='cuda:2')
====================
________________________________
test distance is  tensor(1061.4769, device='cuda:2')
test similarity is  tensor(0.7275, device='cuda:2')
test acc is  0.2187000001564021
test loss is 1.9488438070582612
test entropy is  2.003478759694892
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.003478759694892
avg test loss is  1.9488438070582612
avg accuracy is  0.2187000001564021
compute_distance is  tensor(1061.4769, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.616440352576468
avg test loss is  4.290493439835355
avg accuracy is  0.21626000015640198
compute_distance is  tensor(237.7810, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(237.7810, device='cuda:2')
test similarity is  tensor(0.9909, device='cuda:2')
test acc is  0.21626000015640198
test loss is 4.290493439835355
test entropy is  0.616440352576468
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 27.44% 

Test Accuracy: 27.54% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.3014, device='cuda:2')
diff2 is tensor(2.3014, device='cuda:2')
diff1 is tensor(-0.3102, device='cuda:2')
diff2 is tensor(-0.3102, device='cuda:2')
diff1 is tensor(2.0925, device='cuda:2')
diff2 is tensor(2.0925, device='cuda:2')
diff1 is tensor(0.4519, device='cuda:2')
diff2 is tensor(0.4519, device='cuda:2')
diff1 is tensor(20.6517, device='cuda:2')
diff2 is tensor(20.6517, device='cuda:2')
diff1 is tensor(0.6514, device='cuda:2')
diff2 is tensor(0.6514, device='cuda:2')
diff1 is tensor(-6.8652, device='cuda:2')
diff2 is tensor(-6.8652, device='cuda:2')
diff1 is tensor(0.0511, device='cuda:2')
diff2 is tensor(0.0511, device='cuda:2')
diff1 is tensor(13.5605, device='cuda:2')
diff2 is tensor(13.5605, device='cuda:2')
diff1 is tensor(0.2483, device='cuda:2')
diff2 is tensor(0.2483, device='cuda:2')
diff1 is tensor(36.0067, device='cuda:2')
diff2 is tensor(36.0067, device='cuda:2')
diff1 is tensor(-0.1531, device='cuda:2')
diff2 is tensor(-0.1531, device='cuda:2')
diff1 is tensor(-2.7657, device='cuda:2')
diff2 is tensor(-2.7657, device='cuda:2')
diff1 is tensor(-0.4924, device='cuda:2')
diff2 is tensor(-0.4924, device='cuda:2')
diff1 is tensor(-17.8059, device='cuda:2')
diff2 is tensor(-17.8059, device='cuda:2')
diff1 is tensor(-0.5577, device='cuda:2')
diff2 is tensor(-0.5577, device='cuda:2')
diff1 is tensor(-0.0092, device='cuda:2')
diff2 is tensor(-0.0092, device='cuda:2')
diff1 is tensor(-0.0001, device='cuda:2')
diff2 is tensor(-0.0001, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(800.5969, device='cuda:2')
compute similarity is  tensor(0.9203, device='cuda:2')
compute distance is  tensor(783.5462, device='cuda:2')
compute similarity is  tensor(0.9207, device='cuda:2')
compute distance is  tensor(802.1472, device='cuda:2')
compute similarity is  tensor(0.9203, device='cuda:2')
compute distance is  tensor(796.0283, device='cuda:2')
compute similarity is  tensor(0.9204, device='cuda:2')
compute distance is  tensor(807.3777, device='cuda:2')
compute similarity is  tensor(0.9198, device='cuda:2')
compute distance is  tensor(822.7303, device='cuda:2')
compute similarity is  tensor(0.9191, device='cuda:2')
compute distance is  tensor(801.2994, device='cuda:2')
compute similarity is  tensor(0.9197, device='cuda:2')
compute distance is  tensor(794.2315, device='cuda:2')
compute similarity is  tensor(0.9207, device='cuda:2')
compute distance is  tensor(799.5568, device='cuda:2')
compute similarity is  tensor(0.9200, device='cuda:2')
compute distance is  tensor(802.5447, device='cuda:2')
compute similarity is  tensor(0.9204, device='cuda:2')
compute distance is  tensor(862.5195, device='cuda:2')
compute similarity is  tensor(0.9163, device='cuda:2')
compute distance is  tensor(834.0328, device='cuda:2')
compute similarity is  tensor(0.9186, device='cuda:2')
calculated distance threshold is  tensor(862.5195, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.26262000015640385
inner product is  tensor(11.4855, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2218800001564022
inner product is  tensor(12.5387, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.22370000015640232
inner product is  tensor(12.2422, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.22396000015640236
inner product is  tensor(11.8332, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.23438000015640278
inner product is  tensor(12.1377, device='cuda:2')
====================
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1062.7948, device='cuda:2')
test similarity is  tensor(0.7291, device='cuda:2')
test acc is  0.2218800001564022
test loss is 3.0528294460852736
test entropy is  1.0232719426874615
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.0232719426874615
avg test loss is  3.0528294460852736
avg accuracy is  0.2218800001564022
compute_distance is  tensor(1062.7948, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 32.23% 

Test Accuracy: 32.64% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.1996, device='cuda:2')
diff2 is tensor(0.1996, device='cuda:2')
diff1 is tensor(-0.7797, device='cuda:2')
diff2 is tensor(-0.7797, device='cuda:2')
diff1 is tensor(-52.2806, device='cuda:2')
diff2 is tensor(-52.2806, device='cuda:2')
diff1 is tensor(0.3546, device='cuda:2')
diff2 is tensor(0.3546, device='cuda:2')
diff1 is tensor(-55.8995, device='cuda:2')
diff2 is tensor(-55.8995, device='cuda:2')
diff1 is tensor(-0.4855, device='cuda:2')
diff2 is tensor(-0.4855, device='cuda:2')
diff1 is tensor(-40.1287, device='cuda:2')
diff2 is tensor(-40.1287, device='cuda:2')
diff1 is tensor(-0.5954, device='cuda:2')
diff2 is tensor(-0.5954, device='cuda:2')
diff1 is tensor(-15.5835, device='cuda:2')
diff2 is tensor(-15.5835, device='cuda:2')
diff1 is tensor(-0.3943, device='cuda:2')
diff2 is tensor(-0.3943, device='cuda:2')
diff1 is tensor(-15.0595, device='cuda:2')
diff2 is tensor(-15.0595, device='cuda:2')
diff1 is tensor(-0.1565, device='cuda:2')
diff2 is tensor(-0.1565, device='cuda:2')
diff1 is tensor(-46.7494, device='cuda:2')
diff2 is tensor(-46.7494, device='cuda:2')
diff1 is tensor(-0.3987, device='cuda:2')
diff2 is tensor(-0.3987, device='cuda:2')
diff1 is tensor(-67.9740, device='cuda:2')
diff2 is tensor(-67.9740, device='cuda:2')
diff1 is tensor(-1.2262, device='cuda:2')
diff2 is tensor(-1.2262, device='cuda:2')
diff1 is tensor(0.0050, device='cuda:2')
diff2 is tensor(0.0050, device='cuda:2')
diff1 is tensor(2.8495e-05, device='cuda:2')
diff2 is tensor(2.8495e-05, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(981.6187, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(973.6581, device='cuda:2')
compute similarity is  tensor(0.8476, device='cuda:2')
compute distance is  tensor(979.5208, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(969.7358, device='cuda:2')
compute similarity is  tensor(0.8480, device='cuda:2')
compute distance is  tensor(970.8337, device='cuda:2')
compute similarity is  tensor(0.8480, device='cuda:2')
compute distance is  tensor(984.1934, device='cuda:2')
compute similarity is  tensor(0.8475, device='cuda:2')
compute distance is  tensor(979.0405, device='cuda:2')
compute similarity is  tensor(0.8475, device='cuda:2')
compute distance is  tensor(978.5428, device='cuda:2')
compute similarity is  tensor(0.8478, device='cuda:2')
compute distance is  tensor(975.6443, device='cuda:2')
compute similarity is  tensor(0.8475, device='cuda:2')
compute distance is  tensor(984.9627, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(979.1799, device='cuda:2')
compute similarity is  tensor(0.8475, device='cuda:2')
compute distance is  tensor(980.3283, device='cuda:2')
compute similarity is  tensor(0.8475, device='cuda:2')
calculated distance threshold is  tensor(984.9627, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3100600001564052
inner product is  tensor(238.7447, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2869200001564046
inner product is  tensor(242.3273, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.26448000015640394
inner product is  tensor(240.0332, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2700000001564041
inner product is  tensor(238.7659, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.2778800001564043
inner product is  tensor(238.3453, device='cuda:2')
====================
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1063.9883, device='cuda:2')
test similarity is  tensor(0.7579, device='cuda:2')
test acc is  0.26448000015640394
test loss is 1.9792730279285888
test entropy is  1.5831373097646573
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.5831373097646573
avg test loss is  1.9792730279285888
avg accuracy is  0.26448000015640394
compute_distance is  tensor(1063.9883, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 32.76% 

Test Accuracy: 33.12% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-4.3379, device='cuda:2')
diff2 is tensor(-4.3379, device='cuda:2')
diff1 is tensor(0.2565, device='cuda:2')
diff2 is tensor(0.2565, device='cuda:2')
diff1 is tensor(-14.0160, device='cuda:2')
diff2 is tensor(-14.0160, device='cuda:2')
diff1 is tensor(-0.7563, device='cuda:2')
diff2 is tensor(-0.7563, device='cuda:2')
diff1 is tensor(-19.5389, device='cuda:2')
diff2 is tensor(-19.5389, device='cuda:2')
diff1 is tensor(0.0078, device='cuda:2')
diff2 is tensor(0.0078, device='cuda:2')
diff1 is tensor(-31.5525, device='cuda:2')
diff2 is tensor(-31.5525, device='cuda:2')
diff1 is tensor(0.0212, device='cuda:2')
diff2 is tensor(0.0212, device='cuda:2')
diff1 is tensor(-20.7478, device='cuda:2')
diff2 is tensor(-20.7478, device='cuda:2')
diff1 is tensor(0.6022, device='cuda:2')
diff2 is tensor(0.6022, device='cuda:2')
diff1 is tensor(-73.6741, device='cuda:2')
diff2 is tensor(-73.6741, device='cuda:2')
diff1 is tensor(0.3797, device='cuda:2')
diff2 is tensor(0.3797, device='cuda:2')
diff1 is tensor(14.4600, device='cuda:2')
diff2 is tensor(14.4600, device='cuda:2')
diff1 is tensor(1.4008, device='cuda:2')
diff2 is tensor(1.4008, device='cuda:2')
diff1 is tensor(7.2603, device='cuda:2')
diff2 is tensor(7.2603, device='cuda:2')
diff1 is tensor(1.4001, device='cuda:2')
diff2 is tensor(1.4001, device='cuda:2')
diff1 is tensor(0.0089, device='cuda:2')
diff2 is tensor(0.0089, device='cuda:2')
diff1 is tensor(2.0307e-05, device='cuda:2')
diff2 is tensor(2.0307e-05, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1080.8358, device='cuda:2')
compute similarity is  tensor(0.8139, device='cuda:2')
compute distance is  tensor(1062.2576, device='cuda:2')
compute similarity is  tensor(0.8142, device='cuda:2')
compute distance is  tensor(1076.7339, device='cuda:2')
compute similarity is  tensor(0.8138, device='cuda:2')
compute distance is  tensor(1074.0114, device='cuda:2')
compute similarity is  tensor(0.8141, device='cuda:2')
compute distance is  tensor(1069.3953, device='cuda:2')
compute similarity is  tensor(0.8142, device='cuda:2')
compute distance is  tensor(1090.2825, device='cuda:2')
compute similarity is  tensor(0.8133, device='cuda:2')
compute distance is  tensor(1069.1786, device='cuda:2')
compute similarity is  tensor(0.8139, device='cuda:2')
compute distance is  tensor(1076.3041, device='cuda:2')
compute similarity is  tensor(0.8140, device='cuda:2')
compute distance is  tensor(1072.1854, device='cuda:2')
compute similarity is  tensor(0.8138, device='cuda:2')
compute distance is  tensor(1068.5231, device='cuda:2')
compute similarity is  tensor(0.8141, device='cuda:2')
compute distance is  tensor(1074.7769, device='cuda:2')
compute similarity is  tensor(0.8139, device='cuda:2')
compute distance is  tensor(1068.3239, device='cuda:2')
compute similarity is  tensor(0.8141, device='cuda:2')
calculated distance threshold is  tensor(1090.2825, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3006400001564049
inner product is  tensor(264.2796, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3066200001564051
inner product is  tensor(260.9903, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.31006000015640517
inner product is  tensor(263.9016, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.29836000015640485
inner product is  tensor(260.5641, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.29578000015640477
inner product is  tensor(261.1120, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1066.9506, device='cuda:2')
test similarity is  tensor(0.7687, device='cuda:2')
test acc is  0.29578000015640477
test loss is 1.7999244794211424
test entropy is  1.7504087131651467
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 33.81% 

Test Accuracy: 33.84% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.3036, device='cuda:2')
diff2 is tensor(0.3036, device='cuda:2')
diff1 is tensor(-1.0529, device='cuda:2')
diff2 is tensor(-1.0529, device='cuda:2')
diff1 is tensor(-11.0459, device='cuda:2')
diff2 is tensor(-11.0459, device='cuda:2')
diff1 is tensor(-1.0193, device='cuda:2')
diff2 is tensor(-1.0193, device='cuda:2')
diff1 is tensor(8.0582, device='cuda:2')
diff2 is tensor(8.0582, device='cuda:2')
diff1 is tensor(0.1379, device='cuda:2')
diff2 is tensor(0.1379, device='cuda:2')
diff1 is tensor(-5.3246, device='cuda:2')
diff2 is tensor(-5.3246, device='cuda:2')
diff1 is tensor(0.3883, device='cuda:2')
diff2 is tensor(0.3883, device='cuda:2')
diff1 is tensor(-1.7860, device='cuda:2')
diff2 is tensor(-1.7860, device='cuda:2')
diff1 is tensor(0.9613, device='cuda:2')
diff2 is tensor(0.9613, device='cuda:2')
diff1 is tensor(19.3358, device='cuda:2')
diff2 is tensor(19.3358, device='cuda:2')
diff1 is tensor(0.8093, device='cuda:2')
diff2 is tensor(0.8093, device='cuda:2')
diff1 is tensor(-13.6510, device='cuda:2')
diff2 is tensor(-13.6510, device='cuda:2')
diff1 is tensor(1.4524, device='cuda:2')
diff2 is tensor(1.4524, device='cuda:2')
diff1 is tensor(-34.2254, device='cuda:2')
diff2 is tensor(-34.2254, device='cuda:2')
diff1 is tensor(0.8787, device='cuda:2')
diff2 is tensor(0.8787, device='cuda:2')
diff1 is tensor(-0.0041, device='cuda:2')
diff2 is tensor(-0.0041, device='cuda:2')
diff1 is tensor(7.9125e-06, device='cuda:2')
diff2 is tensor(7.9125e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1064.8019, device='cuda:2')
compute similarity is  tensor(0.8134, device='cuda:2')
compute distance is  tensor(1059.4142, device='cuda:2')
compute similarity is  tensor(0.8134, device='cuda:2')
compute distance is  tensor(1062.3490, device='cuda:2')
compute similarity is  tensor(0.8134, device='cuda:2')
compute distance is  tensor(1081.3459, device='cuda:2')
compute similarity is  tensor(0.8131, device='cuda:2')
compute distance is  tensor(1048.5752, device='cuda:2')
compute similarity is  tensor(0.8137, device='cuda:2')
compute distance is  tensor(1070.0958, device='cuda:2')
compute similarity is  tensor(0.8132, device='cuda:2')
compute distance is  tensor(1060.0684, device='cuda:2')
compute similarity is  tensor(0.8135, device='cuda:2')
compute distance is  tensor(1071.0148, device='cuda:2')
compute similarity is  tensor(0.8131, device='cuda:2')
compute distance is  tensor(1065.6243, device='cuda:2')
compute similarity is  tensor(0.8132, device='cuda:2')
compute distance is  tensor(1047.0989, device='cuda:2')
compute similarity is  tensor(0.8138, device='cuda:2')
compute distance is  tensor(1064.6638, device='cuda:2')
compute similarity is  tensor(0.8135, device='cuda:2')
compute distance is  tensor(1052.4309, device='cuda:2')
compute similarity is  tensor(0.8135, device='cuda:2')
calculated distance threshold is  tensor(1081.3459, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.32478000015640557
inner product is  tensor(228.5557, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.33426000015640567
inner product is  tensor(226.3837, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.30444000015640504
inner product is  tensor(224.7250, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3049800001564051
inner product is  tensor(226.4063, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.2843200001564045
inner product is  tensor(226.5537, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1061.9928, device='cuda:2')
test similarity is  tensor(0.7722, device='cuda:2')
test acc is  0.2843200001564045
test loss is 1.853117050722127
test entropy is  1.8959395048563437
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 32.97% 

Test Accuracy: 32.87% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(3.4044, device='cuda:2')
diff2 is tensor(3.4044, device='cuda:2')
diff1 is tensor(0.0966, device='cuda:2')
diff2 is tensor(0.0966, device='cuda:2')
diff1 is tensor(-28.2145, device='cuda:2')
diff2 is tensor(-28.2145, device='cuda:2')
diff1 is tensor(-1.8221, device='cuda:2')
diff2 is tensor(-1.8221, device='cuda:2')
diff1 is tensor(-7.9808, device='cuda:2')
diff2 is tensor(-7.9808, device='cuda:2')
diff1 is tensor(0.5968, device='cuda:2')
diff2 is tensor(0.5968, device='cuda:2')
diff1 is tensor(-48.8080, device='cuda:2')
diff2 is tensor(-48.8080, device='cuda:2')
diff1 is tensor(-0.1875, device='cuda:2')
diff2 is tensor(-0.1875, device='cuda:2')
diff1 is tensor(-14.3997, device='cuda:2')
diff2 is tensor(-14.3997, device='cuda:2')
diff1 is tensor(-0.4180, device='cuda:2')
diff2 is tensor(-0.4180, device='cuda:2')
diff1 is tensor(-28.7413, device='cuda:2')
diff2 is tensor(-28.7413, device='cuda:2')
diff1 is tensor(-1.1690, device='cuda:2')
diff2 is tensor(-1.1690, device='cuda:2')
diff1 is tensor(54.2005, device='cuda:2')
diff2 is tensor(54.2005, device='cuda:2')
diff1 is tensor(0.4870, device='cuda:2')
diff2 is tensor(0.4870, device='cuda:2')
diff1 is tensor(3.0375, device='cuda:2')
diff2 is tensor(3.0375, device='cuda:2')
diff1 is tensor(0.1949, device='cuda:2')
diff2 is tensor(0.1949, device='cuda:2')
diff1 is tensor(-0.0013, device='cuda:2')
diff2 is tensor(-0.0013, device='cuda:2')
diff1 is tensor(3.5018e-07, device='cuda:2')
diff2 is tensor(3.5018e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1362.3356, device='cuda:2')
compute similarity is  tensor(0.7158, device='cuda:2')
compute distance is  tensor(1351.4602, device='cuda:2')
compute similarity is  tensor(0.7160, device='cuda:2')
compute distance is  tensor(1360.1084, device='cuda:2')
compute similarity is  tensor(0.7156, device='cuda:2')
compute distance is  tensor(1360.6158, device='cuda:2')
compute similarity is  tensor(0.7160, device='cuda:2')
compute distance is  tensor(1345.4934, device='cuda:2')
compute similarity is  tensor(0.7162, device='cuda:2')
compute distance is  tensor(1370.6154, device='cuda:2')
compute similarity is  tensor(0.7157, device='cuda:2')
compute distance is  tensor(1352.5757, device='cuda:2')
compute similarity is  tensor(0.7160, device='cuda:2')
compute distance is  tensor(1366.9369, device='cuda:2')
compute similarity is  tensor(0.7156, device='cuda:2')
compute distance is  tensor(1350.3098, device='cuda:2')
compute similarity is  tensor(0.7158, device='cuda:2')
compute distance is  tensor(1356.3551, device='cuda:2')
compute similarity is  tensor(0.7160, device='cuda:2')
compute distance is  tensor(1354.8855, device='cuda:2')
compute similarity is  tensor(0.7160, device='cuda:2')
compute distance is  tensor(1347.2985, device='cuda:2')
compute similarity is  tensor(0.7161, device='cuda:2')
calculated distance threshold is  tensor(1370.6154, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3318000001564056
inner product is  tensor(441.8669, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3400200001564058
inner product is  tensor(442.2028, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.3003200001564049
inner product is  tensor(439.4538, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2958200001564048
inner product is  tensor(441.4853, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3089600001564051
inner product is  tensor(442.9488, device='cuda:2')
====================
________________________________
test distance is  tensor(1065.8417, device='cuda:2')
test similarity is  tensor(0.8100, device='cuda:2')
test acc is  0.2958200001564048
test loss is 1.9010398462605294
test entropy is  1.8988227126238597
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 34.42% 

Test Accuracy: 33.85% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.1909, device='cuda:2')
diff2 is tensor(-1.1909, device='cuda:2')
diff1 is tensor(-0.0361, device='cuda:2')
diff2 is tensor(-0.0361, device='cuda:2')
diff1 is tensor(-32.3131, device='cuda:2')
diff2 is tensor(-32.3131, device='cuda:2')
diff1 is tensor(0.9077, device='cuda:2')
diff2 is tensor(0.9077, device='cuda:2')
diff1 is tensor(-37.6780, device='cuda:2')
diff2 is tensor(-37.6780, device='cuda:2')
diff1 is tensor(0.3007, device='cuda:2')
diff2 is tensor(0.3007, device='cuda:2')
diff1 is tensor(-17.4864, device='cuda:2')
diff2 is tensor(-17.4864, device='cuda:2')
diff1 is tensor(0.1182, device='cuda:2')
diff2 is tensor(0.1182, device='cuda:2')
diff1 is tensor(-53.7155, device='cuda:2')
diff2 is tensor(-53.7155, device='cuda:2')
diff1 is tensor(0.6616, device='cuda:2')
diff2 is tensor(0.6616, device='cuda:2')
diff1 is tensor(-15.3447, device='cuda:2')
diff2 is tensor(-15.3447, device='cuda:2')
diff1 is tensor(0.6966, device='cuda:2')
diff2 is tensor(0.6966, device='cuda:2')
diff1 is tensor(-90.9614, device='cuda:2')
diff2 is tensor(-90.9614, device='cuda:2')
diff1 is tensor(-0.1386, device='cuda:2')
diff2 is tensor(-0.1386, device='cuda:2')
diff1 is tensor(-45.3193, device='cuda:2')
diff2 is tensor(-45.3193, device='cuda:2')
diff1 is tensor(-0.1046, device='cuda:2')
diff2 is tensor(-0.1046, device='cuda:2')
diff1 is tensor(-0.0040, device='cuda:2')
diff2 is tensor(-0.0040, device='cuda:2')
diff1 is tensor(2.6077e-06, device='cuda:2')
diff2 is tensor(2.6077e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1252.9585, device='cuda:2')
compute similarity is  tensor(0.7502, device='cuda:2')
compute distance is  tensor(1251.7720, device='cuda:2')
compute similarity is  tensor(0.7500, device='cuda:2')
compute distance is  tensor(1265.1193, device='cuda:2')
compute similarity is  tensor(0.7495, device='cuda:2')
compute distance is  tensor(1263.0081, device='cuda:2')
compute similarity is  tensor(0.7500, device='cuda:2')
compute distance is  tensor(1287.5071, device='cuda:2')
compute similarity is  tensor(0.7495, device='cuda:2')
compute distance is  tensor(1259.0004, device='cuda:2')
compute similarity is  tensor(0.7501, device='cuda:2')
compute distance is  tensor(1237.5948, device='cuda:2')
compute similarity is  tensor(0.7504, device='cuda:2')
compute distance is  tensor(1259.5736, device='cuda:2')
compute similarity is  tensor(0.7496, device='cuda:2')
compute distance is  tensor(1255.6635, device='cuda:2')
compute similarity is  tensor(0.7498, device='cuda:2')
compute distance is  tensor(1251.1726, device='cuda:2')
compute similarity is  tensor(0.7502, device='cuda:2')
compute distance is  tensor(1261.4109, device='cuda:2')
compute similarity is  tensor(0.7499, device='cuda:2')
compute distance is  tensor(1253.0040, device='cuda:2')
compute similarity is  tensor(0.7502, device='cuda:2')
calculated distance threshold is  tensor(1287.5071, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.30872000015640516
inner product is  tensor(252.3282, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3244400001564055
inner product is  tensor(251.1622, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.31268000015640524
inner product is  tensor(252.3341, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.2714200001564041
inner product is  tensor(249.2576, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.31050000015640516
inner product is  tensor(251.5450, device='cuda:2')
====================
________________________________
test distance is  tensor(1065.5461, device='cuda:2')
test similarity is  tensor(0.7981, device='cuda:2')
test acc is  0.2714200001564041
test loss is 1.9706473004482592
test entropy is  1.9262165846422201
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 33.18% 

Test Accuracy: 33.39% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-4.8080, device='cuda:2')
diff2 is tensor(-4.8080, device='cuda:2')
diff1 is tensor(-0.7582, device='cuda:2')
diff2 is tensor(-0.7582, device='cuda:2')
diff1 is tensor(-22.0330, device='cuda:2')
diff2 is tensor(-22.0330, device='cuda:2')
diff1 is tensor(-2.0667, device='cuda:2')
diff2 is tensor(-2.0667, device='cuda:2')
diff1 is tensor(-72.8233, device='cuda:2')
diff2 is tensor(-72.8233, device='cuda:2')
diff1 is tensor(-0.4501, device='cuda:2')
diff2 is tensor(-0.4501, device='cuda:2')
diff1 is tensor(-101.3739, device='cuda:2')
diff2 is tensor(-101.3739, device='cuda:2')
diff1 is tensor(-0.5071, device='cuda:2')
diff2 is tensor(-0.5071, device='cuda:2')
diff1 is tensor(-58.5831, device='cuda:2')
diff2 is tensor(-58.5831, device='cuda:2')
diff1 is tensor(0.2974, device='cuda:2')
diff2 is tensor(0.2974, device='cuda:2')
diff1 is tensor(-105.6075, device='cuda:2')
diff2 is tensor(-105.6075, device='cuda:2')
diff1 is tensor(0.3054, device='cuda:2')
diff2 is tensor(0.3054, device='cuda:2')
diff1 is tensor(-61.3874, device='cuda:2')
diff2 is tensor(-61.3874, device='cuda:2')
diff1 is tensor(2.3222, device='cuda:2')
diff2 is tensor(2.3222, device='cuda:2')
diff1 is tensor(-45.9581, device='cuda:2')
diff2 is tensor(-45.9581, device='cuda:2')
diff1 is tensor(1.6634, device='cuda:2')
diff2 is tensor(1.6634, device='cuda:2')
diff1 is tensor(-0.0041, device='cuda:2')
diff2 is tensor(-0.0041, device='cuda:2')
diff1 is tensor(5.3644e-07, device='cuda:2')
diff2 is tensor(5.3644e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1484.1294, device='cuda:2')
compute similarity is  tensor(0.7011, device='cuda:2')
compute distance is  tensor(1480.3954, device='cuda:2')
compute similarity is  tensor(0.7014, device='cuda:2')
compute distance is  tensor(1487.9705, device='cuda:2')
compute similarity is  tensor(0.7010, device='cuda:2')
compute distance is  tensor(1499.0236, device='cuda:2')
compute similarity is  tensor(0.7009, device='cuda:2')
compute distance is  tensor(1498.1292, device='cuda:2')
compute similarity is  tensor(0.7009, device='cuda:2')
compute distance is  tensor(1489.1434, device='cuda:2')
compute similarity is  tensor(0.7011, device='cuda:2')
compute distance is  tensor(1467.4635, device='cuda:2')
compute similarity is  tensor(0.7016, device='cuda:2')
compute distance is  tensor(1492.1241, device='cuda:2')
compute similarity is  tensor(0.7009, device='cuda:2')
compute distance is  tensor(1490.2462, device='cuda:2')
compute similarity is  tensor(0.7011, device='cuda:2')
compute distance is  tensor(1478.3518, device='cuda:2')
compute similarity is  tensor(0.7012, device='cuda:2')
compute distance is  tensor(1475.1846, device='cuda:2')
compute similarity is  tensor(0.7014, device='cuda:2')
compute distance is  tensor(1497.2603, device='cuda:2')
compute similarity is  tensor(0.7006, device='cuda:2')
calculated distance threshold is  tensor(1499.0236, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3199200001564054
inner product is  tensor(446.9798, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3089800001564052
inner product is  tensor(448.0719, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.32696000015640553
inner product is  tensor(444.6711, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3402800001564058
inner product is  tensor(445.4308, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.3281800001564056
inner product is  tensor(449.3330, device='cuda:2')
====================
________________________________
test distance is  tensor(1063.3151, device='cuda:2')
test similarity is  tensor(0.8308, device='cuda:2')
test acc is  0.3089800001564052
test loss is 1.8503736201149728
test entropy is  1.850679652770157
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 37.67% 

Test Accuracy: 37.38% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(6.5079, device='cuda:2')
diff2 is tensor(6.5079, device='cuda:2')
diff1 is tensor(-0.3010, device='cuda:2')
diff2 is tensor(-0.3010, device='cuda:2')
diff1 is tensor(-44.6803, device='cuda:2')
diff2 is tensor(-44.6803, device='cuda:2')
diff1 is tensor(-0.0023, device='cuda:2')
diff2 is tensor(-0.0023, device='cuda:2')
diff1 is tensor(51.7435, device='cuda:2')
diff2 is tensor(51.7435, device='cuda:2')
diff1 is tensor(0.0503, device='cuda:2')
diff2 is tensor(0.0503, device='cuda:2')
diff1 is tensor(15.1540, device='cuda:2')
diff2 is tensor(15.1540, device='cuda:2')
diff1 is tensor(-0.0493, device='cuda:2')
diff2 is tensor(-0.0493, device='cuda:2')
diff1 is tensor(-2.6423, device='cuda:2')
diff2 is tensor(-2.6423, device='cuda:2')
diff1 is tensor(-0.0849, device='cuda:2')
diff2 is tensor(-0.0849, device='cuda:2')
diff1 is tensor(24.5772, device='cuda:2')
diff2 is tensor(24.5772, device='cuda:2')
diff1 is tensor(-0.5075, device='cuda:2')
diff2 is tensor(-0.5075, device='cuda:2')
diff1 is tensor(93.6306, device='cuda:2')
diff2 is tensor(93.6306, device='cuda:2')
diff1 is tensor(-0.8459, device='cuda:2')
diff2 is tensor(-0.8459, device='cuda:2')
diff1 is tensor(19.7734, device='cuda:2')
diff2 is tensor(19.7734, device='cuda:2')
diff1 is tensor(-0.8310, device='cuda:2')
diff2 is tensor(-0.8310, device='cuda:2')
diff1 is tensor(0.0022, device='cuda:2')
diff2 is tensor(0.0022, device='cuda:2')
diff1 is tensor(-2.7344e-06, device='cuda:2')
diff2 is tensor(-2.7344e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1386.0791, device='cuda:2')
compute similarity is  tensor(0.7362, device='cuda:2')
compute distance is  tensor(1384.6189, device='cuda:2')
compute similarity is  tensor(0.7362, device='cuda:2')
compute distance is  tensor(1394.5018, device='cuda:2')
compute similarity is  tensor(0.7359, device='cuda:2')
compute distance is  tensor(1388.3615, device='cuda:2')
compute similarity is  tensor(0.7362, device='cuda:2')
compute distance is  tensor(1395.3092, device='cuda:2')
compute similarity is  tensor(0.7361, device='cuda:2')
compute distance is  tensor(1391.4993, device='cuda:2')
compute similarity is  tensor(0.7363, device='cuda:2')
compute distance is  tensor(1387.2324, device='cuda:2')
compute similarity is  tensor(0.7360, device='cuda:2')
compute distance is  tensor(1398.2638, device='cuda:2')
compute similarity is  tensor(0.7359, device='cuda:2')
compute distance is  tensor(1389.7289, device='cuda:2')
compute similarity is  tensor(0.7360, device='cuda:2')
compute distance is  tensor(1392.1831, device='cuda:2')
compute similarity is  tensor(0.7362, device='cuda:2')
compute distance is  tensor(1389.5602, device='cuda:2')
compute similarity is  tensor(0.7363, device='cuda:2')
compute distance is  tensor(1385.7179, device='cuda:2')
compute similarity is  tensor(0.7360, device='cuda:2')
calculated distance threshold is  tensor(1398.2638, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.33340000015640564
inner product is  tensor(261.6315, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3416600001564058
inner product is  tensor(263.6833, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.3645600001564062
inner product is  tensor(261.4373, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3568200001564061
inner product is  tensor(263.1038, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.32728000015640557
inner product is  tensor(262.7173, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1067.2808, device='cuda:2')
test similarity is  tensor(0.8167, device='cuda:2')
test acc is  0.32728000015640557
test loss is 1.8514551316075922
test entropy is  1.7983469790814783
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 37.83% 

Test Accuracy: 37.66% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(3.2735, device='cuda:2')
diff2 is tensor(3.2735, device='cuda:2')
diff1 is tensor(0.2574, device='cuda:2')
diff2 is tensor(0.2574, device='cuda:2')
diff1 is tensor(2.8747, device='cuda:2')
diff2 is tensor(2.8747, device='cuda:2')
diff1 is tensor(-0.9620, device='cuda:2')
diff2 is tensor(-0.9620, device='cuda:2')
diff1 is tensor(-47.9344, device='cuda:2')
diff2 is tensor(-47.9344, device='cuda:2')
diff1 is tensor(0.1131, device='cuda:2')
diff2 is tensor(0.1131, device='cuda:2')
diff1 is tensor(-29.2996, device='cuda:2')
diff2 is tensor(-29.2996, device='cuda:2')
diff1 is tensor(-0.1532, device='cuda:2')
diff2 is tensor(-0.1532, device='cuda:2')
diff1 is tensor(39.7470, device='cuda:2')
diff2 is tensor(39.7470, device='cuda:2')
diff1 is tensor(0.3288, device='cuda:2')
diff2 is tensor(0.3288, device='cuda:2')
diff1 is tensor(26.3563, device='cuda:2')
diff2 is tensor(26.3563, device='cuda:2')
diff1 is tensor(-0.2163, device='cuda:2')
diff2 is tensor(-0.2163, device='cuda:2')
diff1 is tensor(16.1688, device='cuda:2')
diff2 is tensor(16.1688, device='cuda:2')
diff1 is tensor(0.0043, device='cuda:2')
diff2 is tensor(0.0043, device='cuda:2')
diff1 is tensor(-6.7166, device='cuda:2')
diff2 is tensor(-6.7166, device='cuda:2')
diff1 is tensor(0.4669, device='cuda:2')
diff2 is tensor(0.4669, device='cuda:2')
diff1 is tensor(0.0033, device='cuda:2')
diff2 is tensor(0.0033, device='cuda:2')
diff1 is tensor(-6.5565e-07, device='cuda:2')
diff2 is tensor(-6.5565e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1393.9229, device='cuda:2')
compute similarity is  tensor(0.7547, device='cuda:2')
compute distance is  tensor(1408.8231, device='cuda:2')
compute similarity is  tensor(0.7545, device='cuda:2')
compute distance is  tensor(1404.4364, device='cuda:2')
compute similarity is  tensor(0.7547, device='cuda:2')
compute distance is  tensor(1398.0557, device='cuda:2')
compute similarity is  tensor(0.7550, device='cuda:2')
compute distance is  tensor(1406.7468, device='cuda:2')
compute similarity is  tensor(0.7547, device='cuda:2')
compute distance is  tensor(1394.4796, device='cuda:2')
compute similarity is  tensor(0.7552, device='cuda:2')
compute distance is  tensor(1386.9233, device='cuda:2')
compute similarity is  tensor(0.7550, device='cuda:2')
compute distance is  tensor(1393.9658, device='cuda:2')
compute similarity is  tensor(0.7551, device='cuda:2')
compute distance is  tensor(1411.6599, device='cuda:2')
compute similarity is  tensor(0.7546, device='cuda:2')
compute distance is  tensor(1395.2858, device='cuda:2')
compute similarity is  tensor(0.7549, device='cuda:2')
compute distance is  tensor(1397.7542, device='cuda:2')
compute similarity is  tensor(0.7550, device='cuda:2')
compute distance is  tensor(1399.9359, device='cuda:2')
compute similarity is  tensor(0.7547, device='cuda:2')
calculated distance threshold is  tensor(1411.6599, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.33890000015640576
inner product is  tensor(284.0290, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2999200001564049
inner product is  tensor(290.2281, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3421600001564058
inner product is  tensor(288.1900, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.33496000015640565
inner product is  tensor(288.3065, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.3140000001564053
inner product is  tensor(287.5152, device='cuda:2')
====================
________________________________
test distance is  tensor(1065.3536, device='cuda:2')
test similarity is  tensor(0.8212, device='cuda:2')
test acc is  0.2999200001564049
test loss is 1.9019889220252366
test entropy is  1.804729617007858
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 38.10% 

Test Accuracy: 38.01% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-8.4663, device='cuda:2')
diff2 is tensor(-8.4663, device='cuda:2')
diff1 is tensor(-0.2890, device='cuda:2')
diff2 is tensor(-0.2890, device='cuda:2')
diff1 is tensor(-61.3496, device='cuda:2')
diff2 is tensor(-61.3496, device='cuda:2')
diff1 is tensor(-1.8007, device='cuda:2')
diff2 is tensor(-1.8007, device='cuda:2')
diff1 is tensor(-82.1493, device='cuda:2')
diff2 is tensor(-82.1493, device='cuda:2')
diff1 is tensor(-0.2128, device='cuda:2')
diff2 is tensor(-0.2128, device='cuda:2')
diff1 is tensor(-86.5259, device='cuda:2')
diff2 is tensor(-86.5259, device='cuda:2')
diff1 is tensor(0.0312, device='cuda:2')
diff2 is tensor(0.0312, device='cuda:2')
diff1 is tensor(-121.3851, device='cuda:2')
diff2 is tensor(-121.3851, device='cuda:2')
diff1 is tensor(-0.0924, device='cuda:2')
diff2 is tensor(-0.0924, device='cuda:2')
diff1 is tensor(-94.0110, device='cuda:2')
diff2 is tensor(-94.0110, device='cuda:2')
diff1 is tensor(0.0431, device='cuda:2')
diff2 is tensor(0.0431, device='cuda:2')
diff1 is tensor(-130.7287, device='cuda:2')
diff2 is tensor(-130.7287, device='cuda:2')
diff1 is tensor(1.3017, device='cuda:2')
diff2 is tensor(1.3017, device='cuda:2')
diff1 is tensor(-86.7796, device='cuda:2')
diff2 is tensor(-86.7796, device='cuda:2')
diff1 is tensor(1.1745, device='cuda:2')
diff2 is tensor(1.1745, device='cuda:2')
diff1 is tensor(0.0058, device='cuda:2')
diff2 is tensor(0.0058, device='cuda:2')
diff1 is tensor(-7.8231e-07, device='cuda:2')
diff2 is tensor(-7.8231e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1519.7405, device='cuda:2')
compute similarity is  tensor(0.7405, device='cuda:2')
compute distance is  tensor(1527.4424, device='cuda:2')
compute similarity is  tensor(0.7402, device='cuda:2')
compute distance is  tensor(1522.3333, device='cuda:2')
compute similarity is  tensor(0.7405, device='cuda:2')
compute distance is  tensor(1525.3375, device='cuda:2')
compute similarity is  tensor(0.7405, device='cuda:2')
compute distance is  tensor(1539.3610, device='cuda:2')
compute similarity is  tensor(0.7403, device='cuda:2')
compute distance is  tensor(1515.1655, device='cuda:2')
compute similarity is  tensor(0.7406, device='cuda:2')
compute distance is  tensor(1513.8429, device='cuda:2')
compute similarity is  tensor(0.7406, device='cuda:2')
compute distance is  tensor(1520.8876, device='cuda:2')
compute similarity is  tensor(0.7405, device='cuda:2')
compute distance is  tensor(1526.0876, device='cuda:2')
compute similarity is  tensor(0.7404, device='cuda:2')
compute distance is  tensor(1518.1958, device='cuda:2')
compute similarity is  tensor(0.7406, device='cuda:2')
compute distance is  tensor(1522.7220, device='cuda:2')
compute similarity is  tensor(0.7407, device='cuda:2')
compute distance is  tensor(1522.8674, device='cuda:2')
compute similarity is  tensor(0.7404, device='cuda:2')
calculated distance threshold is  tensor(1539.3610, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3572000001564061
inner product is  tensor(305.4942, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34572000015640586
inner product is  tensor(309.7325, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.32972000015640557
inner product is  tensor(302.7498, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3458000001564059
inner product is  tensor(307.4795, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.3143400001564053
inner product is  tensor(308.3869, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1061.8987, device='cuda:2')
test similarity is  tensor(0.8361, device='cuda:2')
test acc is  0.3143400001564053
test loss is 1.8888900834886009
test entropy is  1.7592447657719292
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 36.86% 

Test Accuracy: 36.45% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(4.7802, device='cuda:2')
diff2 is tensor(4.7802, device='cuda:2')
diff1 is tensor(-0.2556, device='cuda:2')
diff2 is tensor(-0.2556, device='cuda:2')
diff1 is tensor(-77.0340, device='cuda:2')
diff2 is tensor(-77.0340, device='cuda:2')
diff1 is tensor(-1.5303, device='cuda:2')
diff2 is tensor(-1.5303, device='cuda:2')
diff1 is tensor(-11.2783, device='cuda:2')
diff2 is tensor(-11.2783, device='cuda:2')
diff1 is tensor(0.3878, device='cuda:2')
diff2 is tensor(0.3878, device='cuda:2')
diff1 is tensor(-102.5122, device='cuda:2')
diff2 is tensor(-102.5122, device='cuda:2')
diff1 is tensor(-0.0977, device='cuda:2')
diff2 is tensor(-0.0977, device='cuda:2')
diff1 is tensor(-9.7448, device='cuda:2')
diff2 is tensor(-9.7448, device='cuda:2')
diff1 is tensor(1.1983, device='cuda:2')
diff2 is tensor(1.1983, device='cuda:2')
diff1 is tensor(-101.5884, device='cuda:2')
diff2 is tensor(-101.5884, device='cuda:2')
diff1 is tensor(-0.5166, device='cuda:2')
diff2 is tensor(-0.5166, device='cuda:2')
diff1 is tensor(-20.6840, device='cuda:2')
diff2 is tensor(-20.6840, device='cuda:2')
diff1 is tensor(0.1283, device='cuda:2')
diff2 is tensor(0.1283, device='cuda:2')
diff1 is tensor(6.0660, device='cuda:2')
diff2 is tensor(6.0660, device='cuda:2')
diff1 is tensor(-0.6330, device='cuda:2')
diff2 is tensor(-0.6330, device='cuda:2')
diff1 is tensor(-0.0113, device='cuda:2')
diff2 is tensor(-0.0113, device='cuda:2')
diff1 is tensor(-1.7136e-07, device='cuda:2')
diff2 is tensor(-1.7136e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1704.2673, device='cuda:2')
compute similarity is  tensor(0.7075, device='cuda:2')
compute distance is  tensor(1720.2134, device='cuda:2')
compute similarity is  tensor(0.7072, device='cuda:2')
compute distance is  tensor(1705.4073, device='cuda:2')
compute similarity is  tensor(0.7075, device='cuda:2')
compute distance is  tensor(1708.2385, device='cuda:2')
compute similarity is  tensor(0.7076, device='cuda:2')
compute distance is  tensor(1724.0898, device='cuda:2')
compute similarity is  tensor(0.7073, device='cuda:2')
compute distance is  tensor(1710.7094, device='cuda:2')
compute similarity is  tensor(0.7076, device='cuda:2')
compute distance is  tensor(1696.8790, device='cuda:2')
compute similarity is  tensor(0.7077, device='cuda:2')
compute distance is  tensor(1716.2529, device='cuda:2')
compute similarity is  tensor(0.7073, device='cuda:2')
compute distance is  tensor(1714.9089, device='cuda:2')
compute similarity is  tensor(0.7074, device='cuda:2')
compute distance is  tensor(1708.4579, device='cuda:2')
compute similarity is  tensor(0.7076, device='cuda:2')
compute distance is  tensor(1709.7272, device='cuda:2')
compute similarity is  tensor(0.7075, device='cuda:2')
compute distance is  tensor(1700.7911, device='cuda:2')
compute similarity is  tensor(0.7078, device='cuda:2')
calculated distance threshold is  tensor(1724.0898, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3449600001564059
inner product is  tensor(449.8194, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3201600001564054
inner product is  tensor(446.9014, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3099600001564052
inner product is  tensor(448.1602, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.31806000015640534
inner product is  tensor(449.0284, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.3348800001564057
inner product is  tensor(443.7017, device='cuda:2')
====================
________________________________
test distance is  tensor(1064.5059, device='cuda:2')
test similarity is  tensor(0.8571, device='cuda:2')
test acc is  0.3099600001564052
test loss is 1.8838372453094443
test entropy is  1.7206006582130862
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 39.62% 

Test Accuracy: 38.90% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.9242, device='cuda:2')
diff2 is tensor(-2.9242, device='cuda:2')
diff1 is tensor(-0.5449, device='cuda:2')
diff2 is tensor(-0.5449, device='cuda:2')
diff1 is tensor(-4.0132, device='cuda:2')
diff2 is tensor(-4.0132, device='cuda:2')
diff1 is tensor(1.1854, device='cuda:2')
diff2 is tensor(1.1854, device='cuda:2')
diff1 is tensor(-49.3905, device='cuda:2')
diff2 is tensor(-49.3905, device='cuda:2')
diff1 is tensor(-0.1120, device='cuda:2')
diff2 is tensor(-0.1120, device='cuda:2')
diff1 is tensor(11.3792, device='cuda:2')
diff2 is tensor(11.3792, device='cuda:2')
diff1 is tensor(0.3926, device='cuda:2')
diff2 is tensor(0.3926, device='cuda:2')
diff1 is tensor(-93.7986, device='cuda:2')
diff2 is tensor(-93.7986, device='cuda:2')
diff1 is tensor(0.5900, device='cuda:2')
diff2 is tensor(0.5900, device='cuda:2')
diff1 is tensor(2.8793, device='cuda:2')
diff2 is tensor(2.8793, device='cuda:2')
diff1 is tensor(0.2867, device='cuda:2')
diff2 is tensor(0.2867, device='cuda:2')
diff1 is tensor(-52.2391, device='cuda:2')
diff2 is tensor(-52.2391, device='cuda:2')
diff1 is tensor(0.4414, device='cuda:2')
diff2 is tensor(0.4414, device='cuda:2')
diff1 is tensor(-63.7039, device='cuda:2')
diff2 is tensor(-63.7039, device='cuda:2')
diff1 is tensor(0.4698, device='cuda:2')
diff2 is tensor(0.4698, device='cuda:2')
diff1 is tensor(-0.0062, device='cuda:2')
diff2 is tensor(-0.0062, device='cuda:2')
diff1 is tensor(1.0356e-06, device='cuda:2')
diff2 is tensor(1.0356e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1507.9686, device='cuda:2')
compute similarity is  tensor(0.7828, device='cuda:2')
compute distance is  tensor(1496.8419, device='cuda:2')
compute similarity is  tensor(0.7830, device='cuda:2')
compute distance is  tensor(1499.0197, device='cuda:2')
compute similarity is  tensor(0.7829, device='cuda:2')
compute distance is  tensor(1484.6134, device='cuda:2')
compute similarity is  tensor(0.7832, device='cuda:2')
compute distance is  tensor(1507.6239, device='cuda:2')
compute similarity is  tensor(0.7828, device='cuda:2')
compute distance is  tensor(1503.3042, device='cuda:2')
compute similarity is  tensor(0.7829, device='cuda:2')
compute distance is  tensor(1487.3379, device='cuda:2')
compute similarity is  tensor(0.7832, device='cuda:2')
compute distance is  tensor(1498.4207, device='cuda:2')
compute similarity is  tensor(0.7829, device='cuda:2')
compute distance is  tensor(1510.5598, device='cuda:2')
compute similarity is  tensor(0.7826, device='cuda:2')
compute distance is  tensor(1494.7273, device='cuda:2')
compute similarity is  tensor(0.7831, device='cuda:2')
compute distance is  tensor(1489.2618, device='cuda:2')
compute similarity is  tensor(0.7832, device='cuda:2')
compute distance is  tensor(1490.0851, device='cuda:2')
compute similarity is  tensor(0.7831, device='cuda:2')
calculated distance threshold is  tensor(1510.5598, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3716400001564063
inner product is  tensor(274.0113, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34234000015640587
inner product is  tensor(278.2646, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.35216000015640603
inner product is  tensor(273.5417, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.353140000156406
inner product is  tensor(274.8206, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.39840000015640675
inner product is  tensor(275.0561, device='cuda:2')
====================
________________________________
test distance is  tensor(1061.4948, device='cuda:2')
test similarity is  tensor(0.8352, device='cuda:2')
test acc is  0.34234000015640587
test loss is 1.7781769977811048
test entropy is  1.7107287000512224
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 39.22% 

Test Accuracy: 39.12% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.2765, device='cuda:2')
diff2 is tensor(-1.2765, device='cuda:2')
diff1 is tensor(-0.6721, device='cuda:2')
diff2 is tensor(-0.6721, device='cuda:2')
diff1 is tensor(-15.4646, device='cuda:2')
diff2 is tensor(-15.4646, device='cuda:2')
diff1 is tensor(-0.0740, device='cuda:2')
diff2 is tensor(-0.0740, device='cuda:2')
diff1 is tensor(-9.5514, device='cuda:2')
diff2 is tensor(-9.5514, device='cuda:2')
diff1 is tensor(-0.0666, device='cuda:2')
diff2 is tensor(-0.0666, device='cuda:2')
diff1 is tensor(17.2015, device='cuda:2')
diff2 is tensor(17.2015, device='cuda:2')
diff1 is tensor(-0.4150, device='cuda:2')
diff2 is tensor(-0.4150, device='cuda:2')
diff1 is tensor(126.6620, device='cuda:2')
diff2 is tensor(126.6620, device='cuda:2')
diff1 is tensor(0.3559, device='cuda:2')
diff2 is tensor(0.3559, device='cuda:2')
diff1 is tensor(88.1905, device='cuda:2')
diff2 is tensor(88.1905, device='cuda:2')
diff1 is tensor(-0.3451, device='cuda:2')
diff2 is tensor(-0.3451, device='cuda:2')
diff1 is tensor(86.8519, device='cuda:2')
diff2 is tensor(86.8519, device='cuda:2')
diff1 is tensor(0.2578, device='cuda:2')
diff2 is tensor(0.2578, device='cuda:2')
diff1 is tensor(67.7383, device='cuda:2')
diff2 is tensor(67.7383, device='cuda:2')
diff1 is tensor(0.2771, device='cuda:2')
diff2 is tensor(0.2771, device='cuda:2')
diff1 is tensor(0.0116, device='cuda:2')
diff2 is tensor(0.0116, device='cuda:2')
diff1 is tensor(-9.6858e-08, device='cuda:2')
diff2 is tensor(-9.6858e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1521.6686, device='cuda:2')
compute similarity is  tensor(0.7914, device='cuda:2')
compute distance is  tensor(1519.2966, device='cuda:2')
compute similarity is  tensor(0.7914, device='cuda:2')
compute distance is  tensor(1536.6813, device='cuda:2')
compute similarity is  tensor(0.7911, device='cuda:2')
compute distance is  tensor(1508.1730, device='cuda:2')
compute similarity is  tensor(0.7916, device='cuda:2')
compute distance is  tensor(1529.9250, device='cuda:2')
compute similarity is  tensor(0.7913, device='cuda:2')
compute distance is  tensor(1514.9517, device='cuda:2')
compute similarity is  tensor(0.7913, device='cuda:2')
compute distance is  tensor(1500.1807, device='cuda:2')
compute similarity is  tensor(0.7917, device='cuda:2')
compute distance is  tensor(1516.6550, device='cuda:2')
compute similarity is  tensor(0.7913, device='cuda:2')
compute distance is  tensor(1510.0126, device='cuda:2')
compute similarity is  tensor(0.7914, device='cuda:2')
compute distance is  tensor(1519.0304, device='cuda:2')
compute similarity is  tensor(0.7914, device='cuda:2')
compute distance is  tensor(1523.2373, device='cuda:2')
compute similarity is  tensor(0.7913, device='cuda:2')
compute distance is  tensor(1526.3837, device='cuda:2')
compute similarity is  tensor(0.7912, device='cuda:2')
calculated distance threshold is  tensor(1536.6813, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3863000001564066
inner product is  tensor(354.6116, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3392000001564057
inner product is  tensor(350.2833, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.34488000015640585
inner product is  tensor(355.7047, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3668800001564063
inner product is  tensor(358.1871, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.34954000015640596
inner product is  tensor(350.8541, device='cuda:2')
====================
________________________________
test distance is  tensor(1064.6965, device='cuda:2')
test similarity is  tensor(0.8471, device='cuda:2')
test acc is  0.3392000001564057
test loss is 1.824725361126463
test entropy is  1.655798428656195
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 40.60% 

Test Accuracy: 39.83% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(5.8985, device='cuda:2')
diff2 is tensor(5.8985, device='cuda:2')
diff1 is tensor(0.2970, device='cuda:2')
diff2 is tensor(0.2970, device='cuda:2')
diff1 is tensor(-39.2753, device='cuda:2')
diff2 is tensor(-39.2753, device='cuda:2')
diff1 is tensor(0.5142, device='cuda:2')
diff2 is tensor(0.5142, device='cuda:2')
diff1 is tensor(-55.9986, device='cuda:2')
diff2 is tensor(-55.9986, device='cuda:2')
diff1 is tensor(0.1147, device='cuda:2')
diff2 is tensor(0.1147, device='cuda:2')
diff1 is tensor(-87.5025, device='cuda:2')
diff2 is tensor(-87.5025, device='cuda:2')
diff1 is tensor(0.1702, device='cuda:2')
diff2 is tensor(0.1702, device='cuda:2')
diff1 is tensor(-125.7166, device='cuda:2')
diff2 is tensor(-125.7166, device='cuda:2')
diff1 is tensor(0.6918, device='cuda:2')
diff2 is tensor(0.6918, device='cuda:2')
diff1 is tensor(-89.2138, device='cuda:2')
diff2 is tensor(-89.2138, device='cuda:2')
diff1 is tensor(-0.1121, device='cuda:2')
diff2 is tensor(-0.1121, device='cuda:2')
diff1 is tensor(18.5308, device='cuda:2')
diff2 is tensor(18.5308, device='cuda:2')
diff1 is tensor(0.7795, device='cuda:2')
diff2 is tensor(0.7795, device='cuda:2')
diff1 is tensor(-7.8960, device='cuda:2')
diff2 is tensor(-7.8960, device='cuda:2')
diff1 is tensor(0.4212, device='cuda:2')
diff2 is tensor(0.4212, device='cuda:2')
diff1 is tensor(-0.0076, device='cuda:2')
diff2 is tensor(-0.0076, device='cuda:2')
diff1 is tensor(6.1840e-07, device='cuda:2')
diff2 is tensor(6.1840e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1691.3441, device='cuda:2')
compute similarity is  tensor(0.7681, device='cuda:2')
compute distance is  tensor(1672.0072, device='cuda:2')
compute similarity is  tensor(0.7683, device='cuda:2')
compute distance is  tensor(1691.2786, device='cuda:2')
compute similarity is  tensor(0.7681, device='cuda:2')
compute distance is  tensor(1694.7709, device='cuda:2')
compute similarity is  tensor(0.7680, device='cuda:2')
compute distance is  tensor(1682.9059, device='cuda:2')
compute similarity is  tensor(0.7681, device='cuda:2')
compute distance is  tensor(1674.5192, device='cuda:2')
compute similarity is  tensor(0.7683, device='cuda:2')
compute distance is  tensor(1677.8119, device='cuda:2')
compute similarity is  tensor(0.7682, device='cuda:2')
compute distance is  tensor(1680.4525, device='cuda:2')
compute similarity is  tensor(0.7681, device='cuda:2')
compute distance is  tensor(1692.7721, device='cuda:2')
compute similarity is  tensor(0.7681, device='cuda:2')
compute distance is  tensor(1677.0015, device='cuda:2')
compute similarity is  tensor(0.7683, device='cuda:2')
compute distance is  tensor(1691.7222, device='cuda:2')
compute similarity is  tensor(0.7682, device='cuda:2')
compute distance is  tensor(1689.1144, device='cuda:2')
compute similarity is  tensor(0.7682, device='cuda:2')
calculated distance threshold is  tensor(1694.7709, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.35672000015640615
inner product is  tensor(314.8500, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.348360000156406
inner product is  tensor(312.6968, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3338800001564057
inner product is  tensor(315.4026, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.34086000015640583
inner product is  tensor(315.1562, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.34016000015640574
inner product is  tensor(311.7076, device='cuda:2')
====================
________________________________
test distance is  tensor(1062.2122, device='cuda:2')
test similarity is  tensor(0.8565, device='cuda:2')
test acc is  0.3338800001564057
test loss is 1.9114341220587416
test entropy is  1.567703124507309
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 40.85% 

Test Accuracy: 39.73% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-4.6673, device='cuda:2')
diff2 is tensor(-4.6673, device='cuda:2')
diff1 is tensor(0.1652, device='cuda:2')
diff2 is tensor(0.1652, device='cuda:2')
diff1 is tensor(-27.0817, device='cuda:2')
diff2 is tensor(-27.0817, device='cuda:2')
diff1 is tensor(-1.0895, device='cuda:2')
diff2 is tensor(-1.0895, device='cuda:2')
diff1 is tensor(34.3455, device='cuda:2')
diff2 is tensor(34.3455, device='cuda:2')
diff1 is tensor(0.1259, device='cuda:2')
diff2 is tensor(0.1259, device='cuda:2')
diff1 is tensor(-71.2028, device='cuda:2')
diff2 is tensor(-71.2028, device='cuda:2')
diff1 is tensor(-0.8453, device='cuda:2')
diff2 is tensor(-0.8453, device='cuda:2')
diff1 is tensor(-28.8260, device='cuda:2')
diff2 is tensor(-28.8260, device='cuda:2')
diff1 is tensor(-0.3736, device='cuda:2')
diff2 is tensor(-0.3736, device='cuda:2')
diff1 is tensor(-46.5561, device='cuda:2')
diff2 is tensor(-46.5561, device='cuda:2')
diff1 is tensor(-1.5036, device='cuda:2')
diff2 is tensor(-1.5036, device='cuda:2')
diff1 is tensor(-13.8598, device='cuda:2')
diff2 is tensor(-13.8598, device='cuda:2')
diff1 is tensor(0.7544, device='cuda:2')
diff2 is tensor(0.7544, device='cuda:2')
diff1 is tensor(-32.9527, device='cuda:2')
diff2 is tensor(-32.9527, device='cuda:2')
diff1 is tensor(0.4308, device='cuda:2')
diff2 is tensor(0.4308, device='cuda:2')
diff1 is tensor(0.0017, device='cuda:2')
diff2 is tensor(0.0017, device='cuda:2')
diff1 is tensor(-1.1697e-06, device='cuda:2')
diff2 is tensor(-1.1697e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1690.5388, device='cuda:2')
compute similarity is  tensor(0.7839, device='cuda:2')
compute distance is  tensor(1679.7198, device='cuda:2')
compute similarity is  tensor(0.7839, device='cuda:2')
compute distance is  tensor(1691.7775, device='cuda:2')
compute similarity is  tensor(0.7835, device='cuda:2')
compute distance is  tensor(1682.2415, device='cuda:2')
compute similarity is  tensor(0.7841, device='cuda:2')
compute distance is  tensor(1683.0552, device='cuda:2')
compute similarity is  tensor(0.7840, device='cuda:2')
compute distance is  tensor(1677.8123, device='cuda:2')
compute similarity is  tensor(0.7841, device='cuda:2')
compute distance is  tensor(1680.3739, device='cuda:2')
compute similarity is  tensor(0.7841, device='cuda:2')
compute distance is  tensor(1684.3236, device='cuda:2')
compute similarity is  tensor(0.7838, device='cuda:2')
compute distance is  tensor(1680.7596, device='cuda:2')
compute similarity is  tensor(0.7841, device='cuda:2')
compute distance is  tensor(1679.2728, device='cuda:2')
compute similarity is  tensor(0.7840, device='cuda:2')
compute distance is  tensor(1694.3765, device='cuda:2')
compute similarity is  tensor(0.7838, device='cuda:2')
compute distance is  tensor(1695.7717, device='cuda:2')
compute similarity is  tensor(0.7838, device='cuda:2')
calculated distance threshold is  tensor(1695.7717, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.3880600001564066
inner product is  tensor(341.4523, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.36110000015640614
inner product is  tensor(338.1140, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3563400001564061
inner product is  tensor(340.4038, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.38138000015640644
inner product is  tensor(334.9624, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.36110000015640614
inner product is  tensor(338.0388, device='cuda:2')
====================
________________________________
test distance is  tensor(1064.6840, device='cuda:2')
test similarity is  tensor(0.8633, device='cuda:2')
test acc is  0.3563400001564061
test loss is 1.7971712632862198
test entropy is  1.5353265339151367
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 44.08% 

Test Accuracy: 43.38% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(4.0211, device='cuda:2')
diff2 is tensor(4.0211, device='cuda:2')
diff1 is tensor(-0.4714, device='cuda:2')
diff2 is tensor(-0.4714, device='cuda:2')
diff1 is tensor(-29.9701, device='cuda:2')
diff2 is tensor(-29.9701, device='cuda:2')
diff1 is tensor(-0.1194, device='cuda:2')
diff2 is tensor(-0.1194, device='cuda:2')
diff1 is tensor(-83.5213, device='cuda:2')
diff2 is tensor(-83.5213, device='cuda:2')
diff1 is tensor(0.2120, device='cuda:2')
diff2 is tensor(0.2120, device='cuda:2')
diff1 is tensor(-96.9157, device='cuda:2')
diff2 is tensor(-96.9157, device='cuda:2')
diff1 is tensor(0.6228, device='cuda:2')
diff2 is tensor(0.6228, device='cuda:2')
diff1 is tensor(-62.9590, device='cuda:2')
diff2 is tensor(-62.9590, device='cuda:2')
diff1 is tensor(1.1379, device='cuda:2')
diff2 is tensor(1.1379, device='cuda:2')
diff1 is tensor(-2.0887, device='cuda:2')
diff2 is tensor(-2.0887, device='cuda:2')
diff1 is tensor(0.7288, device='cuda:2')
diff2 is tensor(0.7288, device='cuda:2')
diff1 is tensor(-33.1624, device='cuda:2')
diff2 is tensor(-33.1624, device='cuda:2')
diff1 is tensor(0.5314, device='cuda:2')
diff2 is tensor(0.5314, device='cuda:2')
diff1 is tensor(-3.1792, device='cuda:2')
diff2 is tensor(-3.1792, device='cuda:2')
diff1 is tensor(0.6354, device='cuda:2')
diff2 is tensor(0.6354, device='cuda:2')
diff1 is tensor(0.0036, device='cuda:2')
diff2 is tensor(0.0036, device='cuda:2')
diff1 is tensor(1.9744e-07, device='cuda:2')
diff2 is tensor(1.9744e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1569.6323, device='cuda:2')
compute similarity is  tensor(0.8221, device='cuda:2')
compute distance is  tensor(1578.6807, device='cuda:2')
compute similarity is  tensor(0.8219, device='cuda:2')
compute distance is  tensor(1586.7667, device='cuda:2')
compute similarity is  tensor(0.8219, device='cuda:2')
compute distance is  tensor(1594.2096, device='cuda:2')
compute similarity is  tensor(0.8216, device='cuda:2')
compute distance is  tensor(1590.5190, device='cuda:2')
compute similarity is  tensor(0.8218, device='cuda:2')
compute distance is  tensor(1583.7396, device='cuda:2')
compute similarity is  tensor(0.8220, device='cuda:2')
compute distance is  tensor(1570.4512, device='cuda:2')
compute similarity is  tensor(0.8220, device='cuda:2')
compute distance is  tensor(1597.0635, device='cuda:2')
compute similarity is  tensor(0.8216, device='cuda:2')
compute distance is  tensor(1568.7697, device='cuda:2')
compute similarity is  tensor(0.8222, device='cuda:2')
compute distance is  tensor(1583.4282, device='cuda:2')
compute similarity is  tensor(0.8219, device='cuda:2')
compute distance is  tensor(1589.8132, device='cuda:2')
compute similarity is  tensor(0.8218, device='cuda:2')
compute distance is  tensor(1585.3752, device='cuda:2')
compute similarity is  tensor(0.8218, device='cuda:2')
calculated distance threshold is  tensor(1597.0635, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.37276000015640637
inner product is  tensor(256.6886, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3870000001564066
inner product is  tensor(257.9567, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.39042000015640677
inner product is  tensor(254.7466, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.40894000015640697
inner product is  tensor(256.1626, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.3812800001564065
inner product is  tensor(256.0723, device='cuda:2')
====================
________________________________
test distance is  tensor(1066.0021, device='cuda:2')
test similarity is  tensor(0.8583, device='cuda:2')
test acc is  0.37276000015640637
test loss is 1.7386893787042563
test entropy is  1.5201838960123184
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 42.79% 

Test Accuracy: 42.48% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-3.1836, device='cuda:2')
diff2 is tensor(-3.1836, device='cuda:2')
diff1 is tensor(-1.0043, device='cuda:2')
diff2 is tensor(-1.0043, device='cuda:2')
diff1 is tensor(-2.4887, device='cuda:2')
diff2 is tensor(-2.4887, device='cuda:2')
diff1 is tensor(-2.4028, device='cuda:2')
diff2 is tensor(-2.4028, device='cuda:2')
diff1 is tensor(-69.2714, device='cuda:2')
diff2 is tensor(-69.2714, device='cuda:2')
diff1 is tensor(-0.4914, device='cuda:2')
diff2 is tensor(-0.4914, device='cuda:2')
diff1 is tensor(-75.8575, device='cuda:2')
diff2 is tensor(-75.8575, device='cuda:2')
diff1 is tensor(-1.0559, device='cuda:2')
diff2 is tensor(-1.0559, device='cuda:2')
diff1 is tensor(-175.1755, device='cuda:2')
diff2 is tensor(-175.1755, device='cuda:2')
diff1 is tensor(0.1660, device='cuda:2')
diff2 is tensor(0.1660, device='cuda:2')
diff1 is tensor(-205.4825, device='cuda:2')
diff2 is tensor(-205.4825, device='cuda:2')
diff1 is tensor(-0.9738, device='cuda:2')
diff2 is tensor(-0.9738, device='cuda:2')
diff1 is tensor(-141.4381, device='cuda:2')
diff2 is tensor(-141.4381, device='cuda:2')
diff1 is tensor(-1.3263, device='cuda:2')
diff2 is tensor(-1.3263, device='cuda:2')
diff1 is tensor(-105.7922, device='cuda:2')
diff2 is tensor(-105.7922, device='cuda:2')
diff1 is tensor(-0.5929, device='cuda:2')
diff2 is tensor(-0.5929, device='cuda:2')
diff1 is tensor(0.0009, device='cuda:2')
diff2 is tensor(0.0009, device='cuda:2')
diff1 is tensor(-7.4506e-08, device='cuda:2')
diff2 is tensor(-7.4506e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1802.4877, device='cuda:2')
compute similarity is  tensor(0.7798, device='cuda:2')
compute distance is  tensor(1803.6877, device='cuda:2')
compute similarity is  tensor(0.7796, device='cuda:2')
compute distance is  tensor(1831.8345, device='cuda:2')
compute similarity is  tensor(0.7793, device='cuda:2')
compute distance is  tensor(1819.1530, device='cuda:2')
compute similarity is  tensor(0.7795, device='cuda:2')
compute distance is  tensor(1824.9688, device='cuda:2')
compute similarity is  tensor(0.7793, device='cuda:2')
compute distance is  tensor(1817.2720, device='cuda:2')
compute similarity is  tensor(0.7795, device='cuda:2')
compute distance is  tensor(1813.1445, device='cuda:2')
compute similarity is  tensor(0.7796, device='cuda:2')
compute distance is  tensor(1823.8066, device='cuda:2')
compute similarity is  tensor(0.7794, device='cuda:2')
compute distance is  tensor(1829.1309, device='cuda:2')
compute similarity is  tensor(0.7794, device='cuda:2')
compute distance is  tensor(1814.1639, device='cuda:2')
compute similarity is  tensor(0.7796, device='cuda:2')
compute distance is  tensor(1829.9077, device='cuda:2')
compute similarity is  tensor(0.7794, device='cuda:2')
compute distance is  tensor(1825.3145, device='cuda:2')
compute similarity is  tensor(0.7792, device='cuda:2')
calculated distance threshold is  tensor(1831.8345, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.36394000015640626
inner product is  tensor(464.0313, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3887800001564066
inner product is  tensor(466.9755, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.37682000015640643
inner product is  tensor(466.8681, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3672600001564063
inner product is  tensor(465.0737, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.34764000015640595
inner product is  tensor(464.5924, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1065.2396, device='cuda:2')
test similarity is  tensor(0.8752, device='cuda:2')
test acc is  0.34764000015640595
test loss is 1.8351592230979743
test entropy is  1.4338820436421562
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 46.63% 

Test Accuracy: 45.68% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.9268, device='cuda:2')
diff2 is tensor(-2.9268, device='cuda:2')
diff1 is tensor(0.3646, device='cuda:2')
diff2 is tensor(0.3646, device='cuda:2')
diff1 is tensor(-4.0889, device='cuda:2')
diff2 is tensor(-4.0889, device='cuda:2')
diff1 is tensor(0.6929, device='cuda:2')
diff2 is tensor(0.6929, device='cuda:2')
diff1 is tensor(-16.7821, device='cuda:2')
diff2 is tensor(-16.7821, device='cuda:2')
diff1 is tensor(0.5276, device='cuda:2')
diff2 is tensor(0.5276, device='cuda:2')
diff1 is tensor(-58.7333, device='cuda:2')
diff2 is tensor(-58.7333, device='cuda:2')
diff1 is tensor(0.5780, device='cuda:2')
diff2 is tensor(0.5780, device='cuda:2')
diff1 is tensor(44.2926, device='cuda:2')
diff2 is tensor(44.2926, device='cuda:2')
diff1 is tensor(0.9175, device='cuda:2')
diff2 is tensor(0.9175, device='cuda:2')
diff1 is tensor(65.2398, device='cuda:2')
diff2 is tensor(65.2398, device='cuda:2')
diff1 is tensor(1.2016, device='cuda:2')
diff2 is tensor(1.2016, device='cuda:2')
diff1 is tensor(56.7514, device='cuda:2')
diff2 is tensor(56.7514, device='cuda:2')
diff1 is tensor(3.7804, device='cuda:2')
diff2 is tensor(3.7804, device='cuda:2')
diff1 is tensor(23.5978, device='cuda:2')
diff2 is tensor(23.5978, device='cuda:2')
diff1 is tensor(1.3223, device='cuda:2')
diff2 is tensor(1.3223, device='cuda:2')
diff1 is tensor(-0.0017, device='cuda:2')
diff2 is tensor(-0.0017, device='cuda:2')
diff1 is tensor(-2.8312e-07, device='cuda:2')
diff2 is tensor(-2.8312e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1712.1907, device='cuda:2')
compute similarity is  tensor(0.8204, device='cuda:2')
compute distance is  tensor(1688.8933, device='cuda:2')
compute similarity is  tensor(0.8207, device='cuda:2')
compute distance is  tensor(1724.1926, device='cuda:2')
compute similarity is  tensor(0.8203, device='cuda:2')
compute distance is  tensor(1729.8617, device='cuda:2')
compute similarity is  tensor(0.8203, device='cuda:2')
compute distance is  tensor(1714.4546, device='cuda:2')
compute similarity is  tensor(0.8205, device='cuda:2')
compute distance is  tensor(1698.0771, device='cuda:2')
compute similarity is  tensor(0.8206, device='cuda:2')
compute distance is  tensor(1727.0172, device='cuda:2')
compute similarity is  tensor(0.8205, device='cuda:2')
compute distance is  tensor(1712.2034, device='cuda:2')
compute similarity is  tensor(0.8205, device='cuda:2')
compute distance is  tensor(1715.7214, device='cuda:2')
compute similarity is  tensor(0.8204, device='cuda:2')
compute distance is  tensor(1714.0090, device='cuda:2')
compute similarity is  tensor(0.8203, device='cuda:2')
compute distance is  tensor(1712.0565, device='cuda:2')
compute similarity is  tensor(0.8206, device='cuda:2')
compute distance is  tensor(1722.8967, device='cuda:2')
compute similarity is  tensor(0.8203, device='cuda:2')
calculated distance threshold is  tensor(1729.8617, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4476800001564074
inner product is  tensor(272.2306, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.41200000015640703
inner product is  tensor(273.2361, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3859200001564066
inner product is  tensor(274.3106, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4278800001564072
inner product is  tensor(268.6619, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.42994000015640726
inner product is  tensor(272.7636, device='cuda:2')
====================
________________________________
test distance is  tensor(1061.2493, device='cuda:2')
test similarity is  tensor(0.8663, device='cuda:2')
test acc is  0.3859200001564066
test loss is 1.766915649861631
test entropy is  1.4005696944263586
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 45.11% 

Test Accuracy: 44.07% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(4.5930, device='cuda:2')
diff2 is tensor(4.5930, device='cuda:2')
diff1 is tensor(-0.7372, device='cuda:2')
diff2 is tensor(-0.7372, device='cuda:2')
diff1 is tensor(-15.9120, device='cuda:2')
diff2 is tensor(-15.9120, device='cuda:2')
diff1 is tensor(-1.6641, device='cuda:2')
diff2 is tensor(-1.6641, device='cuda:2')
diff1 is tensor(-48.1273, device='cuda:2')
diff2 is tensor(-48.1273, device='cuda:2')
diff1 is tensor(-0.3441, device='cuda:2')
diff2 is tensor(-0.3441, device='cuda:2')
diff1 is tensor(-114.8271, device='cuda:2')
diff2 is tensor(-114.8271, device='cuda:2')
diff1 is tensor(-0.6448, device='cuda:2')
diff2 is tensor(-0.6448, device='cuda:2')
diff1 is tensor(-78.1200, device='cuda:2')
diff2 is tensor(-78.1200, device='cuda:2')
diff1 is tensor(-0.3158, device='cuda:2')
diff2 is tensor(-0.3158, device='cuda:2')
diff1 is tensor(-22.3965, device='cuda:2')
diff2 is tensor(-22.3965, device='cuda:2')
diff1 is tensor(-1.4843, device='cuda:2')
diff2 is tensor(-1.4843, device='cuda:2')
diff1 is tensor(14.6021, device='cuda:2')
diff2 is tensor(14.6021, device='cuda:2')
diff1 is tensor(-0.6948, device='cuda:2')
diff2 is tensor(-0.6948, device='cuda:2')
diff1 is tensor(4.3476, device='cuda:2')
diff2 is tensor(4.3476, device='cuda:2')
diff1 is tensor(-0.3124, device='cuda:2')
diff2 is tensor(-0.3124, device='cuda:2')
diff1 is tensor(0.0025, device='cuda:2')
diff2 is tensor(0.0025, device='cuda:2')
diff1 is tensor(6.7800e-07, device='cuda:2')
diff2 is tensor(6.7800e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1832.2076, device='cuda:2')
compute similarity is  tensor(0.8055, device='cuda:2')
compute distance is  tensor(1827.9036, device='cuda:2')
compute similarity is  tensor(0.8057, device='cuda:2')
compute distance is  tensor(1816.9916, device='cuda:2')
compute similarity is  tensor(0.8059, device='cuda:2')
compute distance is  tensor(1825.1880, device='cuda:2')
compute similarity is  tensor(0.8059, device='cuda:2')
compute distance is  tensor(1846.0135, device='cuda:2')
compute similarity is  tensor(0.8055, device='cuda:2')
compute distance is  tensor(1833.9563, device='cuda:2')
compute similarity is  tensor(0.8056, device='cuda:2')
compute distance is  tensor(1833.1515, device='cuda:2')
compute similarity is  tensor(0.8057, device='cuda:2')
compute distance is  tensor(1819.8850, device='cuda:2')
compute similarity is  tensor(0.8059, device='cuda:2')
compute distance is  tensor(1835.6162, device='cuda:2')
compute similarity is  tensor(0.8056, device='cuda:2')
compute distance is  tensor(1838.6290, device='cuda:2')
compute similarity is  tensor(0.8055, device='cuda:2')
compute distance is  tensor(1831.8193, device='cuda:2')
compute similarity is  tensor(0.8056, device='cuda:2')
compute distance is  tensor(1841.4209, device='cuda:2')
compute similarity is  tensor(0.8053, device='cuda:2')
calculated distance threshold is  tensor(1846.0135, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.41244000015640697
inner product is  tensor(462.6920, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.39598000015640683
inner product is  tensor(461.0506, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3595400001564061
inner product is  tensor(463.9523, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.39586000015640677
inner product is  tensor(465.0740, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.4211400001564071
inner product is  tensor(460.6258, device='cuda:2')
====================
________________________________
test distance is  tensor(1065.9574, device='cuda:2')
test similarity is  tensor(0.8804, device='cuda:2')
test acc is  0.3595400001564061
test loss is 1.8967577545234309
test entropy is  1.3896079552752891
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 46.54% 

Test Accuracy: 45.55% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-7.4040, device='cuda:2')
diff2 is tensor(-7.4040, device='cuda:2')
diff1 is tensor(-0.8161, device='cuda:2')
diff2 is tensor(-0.8161, device='cuda:2')
diff1 is tensor(-14.5279, device='cuda:2')
diff2 is tensor(-14.5279, device='cuda:2')
diff1 is tensor(-0.7806, device='cuda:2')
diff2 is tensor(-0.7806, device='cuda:2')
diff1 is tensor(-59.7399, device='cuda:2')
diff2 is tensor(-59.7399, device='cuda:2')
diff1 is tensor(-0.1308, device='cuda:2')
diff2 is tensor(-0.1308, device='cuda:2')
diff1 is tensor(-8.2444, device='cuda:2')
diff2 is tensor(-8.2444, device='cuda:2')
diff1 is tensor(0.4486, device='cuda:2')
diff2 is tensor(0.4486, device='cuda:2')
diff1 is tensor(-10.9429, device='cuda:2')
diff2 is tensor(-10.9429, device='cuda:2')
diff1 is tensor(1.6852, device='cuda:2')
diff2 is tensor(1.6852, device='cuda:2')
diff1 is tensor(-6.7082, device='cuda:2')
diff2 is tensor(-6.7082, device='cuda:2')
diff1 is tensor(-0.0489, device='cuda:2')
diff2 is tensor(-0.0489, device='cuda:2')
diff1 is tensor(-13.5636, device='cuda:2')
diff2 is tensor(-13.5636, device='cuda:2')
diff1 is tensor(0.5072, device='cuda:2')
diff2 is tensor(0.5072, device='cuda:2')
diff1 is tensor(-54.4375, device='cuda:2')
diff2 is tensor(-54.4375, device='cuda:2')
diff1 is tensor(-0.0676, device='cuda:2')
diff2 is tensor(-0.0676, device='cuda:2')
diff1 is tensor(0.0022, device='cuda:2')
diff2 is tensor(0.0022, device='cuda:2')
diff1 is tensor(-1.7881e-07, device='cuda:2')
diff2 is tensor(-1.7881e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1711.0229, device='cuda:2')
compute similarity is  tensor(0.8384, device='cuda:2')
compute distance is  tensor(1752.9558, device='cuda:2')
compute similarity is  tensor(0.8375, device='cuda:2')
compute distance is  tensor(1733.8621, device='cuda:2')
compute similarity is  tensor(0.8380, device='cuda:2')
compute distance is  tensor(1728.5859, device='cuda:2')
compute similarity is  tensor(0.8382, device='cuda:2')
compute distance is  tensor(1744.7018, device='cuda:2')
compute similarity is  tensor(0.8378, device='cuda:2')
compute distance is  tensor(1733.0964, device='cuda:2')
compute similarity is  tensor(0.8381, device='cuda:2')
compute distance is  tensor(1738.6121, device='cuda:2')
compute similarity is  tensor(0.8380, device='cuda:2')
compute distance is  tensor(1728.4088, device='cuda:2')
compute similarity is  tensor(0.8383, device='cuda:2')
compute distance is  tensor(1740.2084, device='cuda:2')
compute similarity is  tensor(0.8380, device='cuda:2')
compute distance is  tensor(1710.6171, device='cuda:2')
compute similarity is  tensor(0.8384, device='cuda:2')
compute distance is  tensor(1729.2776, device='cuda:2')
compute similarity is  tensor(0.8382, device='cuda:2')
compute distance is  tensor(1748.1603, device='cuda:2')
compute similarity is  tensor(0.8377, device='cuda:2')
calculated distance threshold is  tensor(1752.9558, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.40958000015640694
inner product is  tensor(284.9435, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.40342000015640683
inner product is  tensor(282.8323, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.41744000015640703
inner product is  tensor(286.2877, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.42006000015640704
inner product is  tensor(281.0609, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.42556000015640716
inner product is  tensor(287.0708, device='cuda:2')
====================
________________________________
test distance is  tensor(1064.9812, device='cuda:2')
test similarity is  tensor(0.8747, device='cuda:2')
test acc is  0.40342000015640683
test loss is 1.6963582802611543
test entropy is  1.3049851700168131
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 46.88% 

Test Accuracy: 45.89% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(6.0300, device='cuda:2')
diff2 is tensor(6.0300, device='cuda:2')
diff1 is tensor(0.2822, device='cuda:2')
diff2 is tensor(0.2822, device='cuda:2')
diff1 is tensor(-10.3008, device='cuda:2')
diff2 is tensor(-10.3008, device='cuda:2')
diff1 is tensor(0.1603, device='cuda:2')
diff2 is tensor(0.1603, device='cuda:2')
diff1 is tensor(-91.0815, device='cuda:2')
diff2 is tensor(-91.0815, device='cuda:2')
diff1 is tensor(0.2106, device='cuda:2')
diff2 is tensor(0.2106, device='cuda:2')
diff1 is tensor(-134.1213, device='cuda:2')
diff2 is tensor(-134.1213, device='cuda:2')
diff1 is tensor(-0.4401, device='cuda:2')
diff2 is tensor(-0.4401, device='cuda:2')
diff1 is tensor(-111.9081, device='cuda:2')
diff2 is tensor(-111.9081, device='cuda:2')
diff1 is tensor(0.5263, device='cuda:2')
diff2 is tensor(0.5263, device='cuda:2')
diff1 is tensor(-60.3214, device='cuda:2')
diff2 is tensor(-60.3214, device='cuda:2')
diff1 is tensor(0.4834, device='cuda:2')
diff2 is tensor(0.4834, device='cuda:2')
diff1 is tensor(18.0993, device='cuda:2')
diff2 is tensor(18.0993, device='cuda:2')
diff1 is tensor(0.4712, device='cuda:2')
diff2 is tensor(0.4712, device='cuda:2')
diff1 is tensor(39.9587, device='cuda:2')
diff2 is tensor(39.9587, device='cuda:2')
diff1 is tensor(0.9264, device='cuda:2')
diff2 is tensor(0.9264, device='cuda:2')
diff1 is tensor(-7.3524e-05, device='cuda:2')
diff2 is tensor(-7.3524e-05, device='cuda:2')
diff1 is tensor(-2.0303e-07, device='cuda:2')
diff2 is tensor(-2.0303e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1841.6447, device='cuda:2')
compute similarity is  tensor(0.8289, device='cuda:2')
compute distance is  tensor(1856.3645, device='cuda:2')
compute similarity is  tensor(0.8285, device='cuda:2')
compute distance is  tensor(1847.8530, device='cuda:2')
compute similarity is  tensor(0.8286, device='cuda:2')
compute distance is  tensor(1846.8862, device='cuda:2')
compute similarity is  tensor(0.8289, device='cuda:2')
compute distance is  tensor(1850.9431, device='cuda:2')
compute similarity is  tensor(0.8286, device='cuda:2')
compute distance is  tensor(1833.1088, device='cuda:2')
compute similarity is  tensor(0.8290, device='cuda:2')
compute distance is  tensor(1851.3762, device='cuda:2')
compute similarity is  tensor(0.8286, device='cuda:2')
compute distance is  tensor(1850.9723, device='cuda:2')
compute similarity is  tensor(0.8287, device='cuda:2')
compute distance is  tensor(1851.3444, device='cuda:2')
compute similarity is  tensor(0.8287, device='cuda:2')
compute distance is  tensor(1845.1653, device='cuda:2')
compute similarity is  tensor(0.8287, device='cuda:2')
compute distance is  tensor(1818.3789, device='cuda:2')
compute similarity is  tensor(0.8294, device='cuda:2')
compute distance is  tensor(1849.2533, device='cuda:2')
compute similarity is  tensor(0.8286, device='cuda:2')
calculated distance threshold is  tensor(1856.3645, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.41926000015640713
inner product is  tensor(349.6479, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.42076000015640713
inner product is  tensor(356.2632, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.4326200001564073
inner product is  tensor(351.5888, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.39542000015640677
inner product is  tensor(357.3155, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.42806000015640727
inner product is  tensor(354.4197, device='cuda:2')
====================
________________________________
test distance is  tensor(1066.4554, device='cuda:2')
test similarity is  tensor(0.8812, device='cuda:2')
test acc is  0.39542000015640677
test loss is 1.7807471456430148
test entropy is  1.311319746782103
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 46.92% 

Test Accuracy: 46.54% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.4699, device='cuda:2')
diff2 is tensor(-2.4699, device='cuda:2')
diff1 is tensor(-0.0605, device='cuda:2')
diff2 is tensor(-0.0605, device='cuda:2')
diff1 is tensor(-50.3363, device='cuda:2')
diff2 is tensor(-50.3363, device='cuda:2')
diff1 is tensor(-1.4296, device='cuda:2')
diff2 is tensor(-1.4296, device='cuda:2')
diff1 is tensor(16.7332, device='cuda:2')
diff2 is tensor(16.7332, device='cuda:2')
diff1 is tensor(0.3017, device='cuda:2')
diff2 is tensor(0.3017, device='cuda:2')
diff1 is tensor(-103.8997, device='cuda:2')
diff2 is tensor(-103.8997, device='cuda:2')
diff1 is tensor(0.1538, device='cuda:2')
diff2 is tensor(0.1538, device='cuda:2')
diff1 is tensor(-179.4458, device='cuda:2')
diff2 is tensor(-179.4458, device='cuda:2')
diff1 is tensor(-0.3515, device='cuda:2')
diff2 is tensor(-0.3515, device='cuda:2')
diff1 is tensor(-89.5754, device='cuda:2')
diff2 is tensor(-89.5754, device='cuda:2')
diff1 is tensor(-0.0364, device='cuda:2')
diff2 is tensor(-0.0364, device='cuda:2')
diff1 is tensor(22.8311, device='cuda:2')
diff2 is tensor(22.8311, device='cuda:2')
diff1 is tensor(1.3437, device='cuda:2')
diff2 is tensor(1.3437, device='cuda:2')
diff1 is tensor(-34.3753, device='cuda:2')
diff2 is tensor(-34.3753, device='cuda:2')
diff1 is tensor(0.8426, device='cuda:2')
diff2 is tensor(0.8426, device='cuda:2')
diff1 is tensor(0.0036, device='cuda:2')
diff2 is tensor(0.0036, device='cuda:2')
diff1 is tensor(-2.9802e-07, device='cuda:2')
diff2 is tensor(-2.9802e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1942.5323, device='cuda:2')
compute similarity is  tensor(0.8211, device='cuda:2')
compute distance is  tensor(1972.9967, device='cuda:2')
compute similarity is  tensor(0.8206, device='cuda:2')
compute distance is  tensor(1946.1648, device='cuda:2')
compute similarity is  tensor(0.8210, device='cuda:2')
compute distance is  tensor(1963.6115, device='cuda:2')
compute similarity is  tensor(0.8210, device='cuda:2')
compute distance is  tensor(1944.1031, device='cuda:2')
compute similarity is  tensor(0.8213, device='cuda:2')
compute distance is  tensor(1942.9974, device='cuda:2')
compute similarity is  tensor(0.8214, device='cuda:2')
compute distance is  tensor(1968.1333, device='cuda:2')
compute similarity is  tensor(0.8210, device='cuda:2')
compute distance is  tensor(1945.3772, device='cuda:2')
compute similarity is  tensor(0.8212, device='cuda:2')
compute distance is  tensor(1951.6066, device='cuda:2')
compute similarity is  tensor(0.8211, device='cuda:2')
compute distance is  tensor(1944.3816, device='cuda:2')
compute similarity is  tensor(0.8213, device='cuda:2')
compute distance is  tensor(1941.9835, device='cuda:2')
compute similarity is  tensor(0.8214, device='cuda:2')
compute distance is  tensor(1983.8164, device='cuda:2')
compute similarity is  tensor(0.8204, device='cuda:2')
calculated distance threshold is  tensor(1983.8164, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4426000001564074
inner product is  tensor(349.6515, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4219000001564071
inner product is  tensor(346.2533, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4509000001564076
inner product is  tensor(344.9226, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.43322000015640727
inner product is  tensor(348.6346, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.415100000156407
inner product is  tensor(346.6453, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1066.0649, device='cuda:2')
test similarity is  tensor(0.8868, device='cuda:2')
test acc is  0.415100000156407
test loss is 1.7741517151713067
test entropy is  1.2345883070355486
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 48.70% 

Test Accuracy: 48.28% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-3.8113, device='cuda:2')
diff2 is tensor(-3.8113, device='cuda:2')
diff1 is tensor(0.4376, device='cuda:2')
diff2 is tensor(0.4376, device='cuda:2')
diff1 is tensor(-20.6791, device='cuda:2')
diff2 is tensor(-20.6791, device='cuda:2')
diff1 is tensor(0.5489, device='cuda:2')
diff2 is tensor(0.5489, device='cuda:2')
diff1 is tensor(-56.2176, device='cuda:2')
diff2 is tensor(-56.2176, device='cuda:2')
diff1 is tensor(-0.3003, device='cuda:2')
diff2 is tensor(-0.3003, device='cuda:2')
diff1 is tensor(-84.7848, device='cuda:2')
diff2 is tensor(-84.7848, device='cuda:2')
diff1 is tensor(-0.6824, device='cuda:2')
diff2 is tensor(-0.6824, device='cuda:2')
diff1 is tensor(-20.8734, device='cuda:2')
diff2 is tensor(-20.8734, device='cuda:2')
diff1 is tensor(0.8298, device='cuda:2')
diff2 is tensor(0.8298, device='cuda:2')
diff1 is tensor(-107.8776, device='cuda:2')
diff2 is tensor(-107.8776, device='cuda:2')
diff1 is tensor(-1.0507, device='cuda:2')
diff2 is tensor(-1.0507, device='cuda:2')
diff1 is tensor(-166.9228, device='cuda:2')
diff2 is tensor(-166.9228, device='cuda:2')
diff1 is tensor(-1.0824, device='cuda:2')
diff2 is tensor(-1.0824, device='cuda:2')
diff1 is tensor(-116.3143, device='cuda:2')
diff2 is tensor(-116.3143, device='cuda:2')
diff1 is tensor(-1.4365, device='cuda:2')
diff2 is tensor(-1.4365, device='cuda:2')
diff1 is tensor(-0.0072, device='cuda:2')
diff2 is tensor(-0.0072, device='cuda:2')
diff1 is tensor(-3.1292e-07, device='cuda:2')
diff2 is tensor(-3.1292e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1838.3257, device='cuda:2')
compute similarity is  tensor(0.8523, device='cuda:2')
compute distance is  tensor(1853.7930, device='cuda:2')
compute similarity is  tensor(0.8520, device='cuda:2')
compute distance is  tensor(1841.4496, device='cuda:2')
compute similarity is  tensor(0.8524, device='cuda:2')
compute distance is  tensor(1843.9575, device='cuda:2')
compute similarity is  tensor(0.8525, device='cuda:2')
compute distance is  tensor(1858.1654, device='cuda:2')
compute similarity is  tensor(0.8521, device='cuda:2')
compute distance is  tensor(1843.8503, device='cuda:2')
compute similarity is  tensor(0.8522, device='cuda:2')
compute distance is  tensor(1819.8789, device='cuda:2')
compute similarity is  tensor(0.8530, device='cuda:2')
compute distance is  tensor(1852.3022, device='cuda:2')
compute similarity is  tensor(0.8522, device='cuda:2')
compute distance is  tensor(1832.7231, device='cuda:2')
compute similarity is  tensor(0.8527, device='cuda:2')
compute distance is  tensor(1820.5505, device='cuda:2')
compute similarity is  tensor(0.8527, device='cuda:2')
compute distance is  tensor(1822.9796, device='cuda:2')
compute similarity is  tensor(0.8527, device='cuda:2')
compute distance is  tensor(1872.5380, device='cuda:2')
compute similarity is  tensor(0.8518, device='cuda:2')
calculated distance threshold is  tensor(1872.5380, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4171400001564071
inner product is  tensor(358.4277, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.39442000015640677
inner product is  tensor(357.7273, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4671400001564076
inner product is  tensor(359.2907, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.42418000015640717
inner product is  tensor(356.2002, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.4397400001564074
inner product is  tensor(359.8697, device='cuda:2')
====================
________________________________
test distance is  tensor(1062.1405, device='cuda:2')
test similarity is  tensor(0.8869, device='cuda:2')
test acc is  0.39442000015640677
test loss is 1.8977198173932712
test entropy is  1.2064223269672345
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 49.72% 

Test Accuracy: 48.88% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.6975, device='cuda:2')
diff2 is tensor(2.6975, device='cuda:2')
diff1 is tensor(-0.3390, device='cuda:2')
diff2 is tensor(-0.3390, device='cuda:2')
diff1 is tensor(8.9984, device='cuda:2')
diff2 is tensor(8.9984, device='cuda:2')
diff1 is tensor(0.3306, device='cuda:2')
diff2 is tensor(0.3306, device='cuda:2')
diff1 is tensor(-64.7624, device='cuda:2')
diff2 is tensor(-64.7624, device='cuda:2')
diff1 is tensor(-0.0741, device='cuda:2')
diff2 is tensor(-0.0741, device='cuda:2')
diff1 is tensor(-34.1796, device='cuda:2')
diff2 is tensor(-34.1796, device='cuda:2')
diff1 is tensor(0.3037, device='cuda:2')
diff2 is tensor(0.3037, device='cuda:2')
diff1 is tensor(-104.7270, device='cuda:2')
diff2 is tensor(-104.7270, device='cuda:2')
diff1 is tensor(-0.5639, device='cuda:2')
diff2 is tensor(-0.5639, device='cuda:2')
diff1 is tensor(12.4143, device='cuda:2')
diff2 is tensor(12.4143, device='cuda:2')
diff1 is tensor(-0.1209, device='cuda:2')
diff2 is tensor(-0.1209, device='cuda:2')
diff1 is tensor(47.8453, device='cuda:2')
diff2 is tensor(47.8453, device='cuda:2')
diff1 is tensor(0.9695, device='cuda:2')
diff2 is tensor(0.9695, device='cuda:2')
diff1 is tensor(89.7152, device='cuda:2')
diff2 is tensor(89.7152, device='cuda:2')
diff1 is tensor(1.2898, device='cuda:2')
diff2 is tensor(1.2898, device='cuda:2')
diff1 is tensor(-0.0030, device='cuda:2')
diff2 is tensor(-0.0030, device='cuda:2')
diff1 is tensor(7.5996e-07, device='cuda:2')
diff2 is tensor(7.5996e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1824.2709, device='cuda:2')
compute similarity is  tensor(0.8661, device='cuda:2')
compute distance is  tensor(1875.2283, device='cuda:2')
compute similarity is  tensor(0.8652, device='cuda:2')
compute distance is  tensor(1837.0270, device='cuda:2')
compute similarity is  tensor(0.8659, device='cuda:2')
compute distance is  tensor(1824.7240, device='cuda:2')
compute similarity is  tensor(0.8663, device='cuda:2')
compute distance is  tensor(1847.7155, device='cuda:2')
compute similarity is  tensor(0.8658, device='cuda:2')
compute distance is  tensor(1823.0709, device='cuda:2')
compute similarity is  tensor(0.8660, device='cuda:2')
compute distance is  tensor(1853.6418, device='cuda:2')
compute similarity is  tensor(0.8658, device='cuda:2')
compute distance is  tensor(1855.7361, device='cuda:2')
compute similarity is  tensor(0.8658, device='cuda:2')
compute distance is  tensor(1854.0725, device='cuda:2')
compute similarity is  tensor(0.8657, device='cuda:2')
compute distance is  tensor(1818.6110, device='cuda:2')
compute similarity is  tensor(0.8661, device='cuda:2')
compute distance is  tensor(1820.3979, device='cuda:2')
compute similarity is  tensor(0.8662, device='cuda:2')
compute distance is  tensor(1866.2101, device='cuda:2')
compute similarity is  tensor(0.8654, device='cuda:2')
calculated distance threshold is  tensor(1875.2283, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4717200001564077
inner product is  tensor(258.9479, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.43290000015640734
inner product is  tensor(257.3925, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4706000001564077
inner product is  tensor(256.0043, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.48294000015640787
inner product is  tensor(259.5165, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.43852000015640735
inner product is  tensor(258.9299, device='cuda:2')
====================
________________________________
test distance is  tensor(1062.8241, device='cuda:2')
test similarity is  tensor(0.8844, device='cuda:2')
test acc is  0.43290000015640734
test loss is 1.7275769683101294
test entropy is  1.1608488241882275
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 48.62% 

Test Accuracy: 47.72% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.5284, device='cuda:2')
diff2 is tensor(1.5284, device='cuda:2')
diff1 is tensor(-1.0988, device='cuda:2')
diff2 is tensor(-1.0988, device='cuda:2')
diff1 is tensor(-56.6302, device='cuda:2')
diff2 is tensor(-56.6302, device='cuda:2')
diff1 is tensor(-1.6496, device='cuda:2')
diff2 is tensor(-1.6496, device='cuda:2')
diff1 is tensor(22.7137, device='cuda:2')
diff2 is tensor(22.7137, device='cuda:2')
diff1 is tensor(0.3679, device='cuda:2')
diff2 is tensor(0.3679, device='cuda:2')
diff1 is tensor(-112.2842, device='cuda:2')
diff2 is tensor(-112.2842, device='cuda:2')
diff1 is tensor(-0.3351, device='cuda:2')
diff2 is tensor(-0.3351, device='cuda:2')
diff1 is tensor(-96.3004, device='cuda:2')
diff2 is tensor(-96.3004, device='cuda:2')
diff1 is tensor(0.6573, device='cuda:2')
diff2 is tensor(0.6573, device='cuda:2')
diff1 is tensor(-106.6467, device='cuda:2')
diff2 is tensor(-106.6467, device='cuda:2')
diff1 is tensor(-0.5496, device='cuda:2')
diff2 is tensor(-0.5496, device='cuda:2')
diff1 is tensor(-8.0341, device='cuda:2')
diff2 is tensor(-8.0341, device='cuda:2')
diff1 is tensor(0.6651, device='cuda:2')
diff2 is tensor(0.6651, device='cuda:2')
diff1 is tensor(-45.2009, device='cuda:2')
diff2 is tensor(-45.2009, device='cuda:2')
diff1 is tensor(0.3453, device='cuda:2')
diff2 is tensor(0.3453, device='cuda:2')
diff1 is tensor(0.0009, device='cuda:2')
diff2 is tensor(0.0009, device='cuda:2')
diff1 is tensor(-9.6112e-07, device='cuda:2')
diff2 is tensor(-9.6112e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1969.1842, device='cuda:2')
compute similarity is  tensor(0.8471, device='cuda:2')
compute distance is  tensor(1989.2295, device='cuda:2')
compute similarity is  tensor(0.8465, device='cuda:2')
compute distance is  tensor(1978.2844, device='cuda:2')
compute similarity is  tensor(0.8468, device='cuda:2')
compute distance is  tensor(2028.4454, device='cuda:2')
compute similarity is  tensor(0.8459, device='cuda:2')
compute distance is  tensor(1983.0155, device='cuda:2')
compute similarity is  tensor(0.8466, device='cuda:2')
compute distance is  tensor(1966.7328, device='cuda:2')
compute similarity is  tensor(0.8470, device='cuda:2')
compute distance is  tensor(2016.6772, device='cuda:2')
compute similarity is  tensor(0.8463, device='cuda:2')
compute distance is  tensor(1960.8241, device='cuda:2')
compute similarity is  tensor(0.8472, device='cuda:2')
compute distance is  tensor(1986.9977, device='cuda:2')
compute similarity is  tensor(0.8468, device='cuda:2')
compute distance is  tensor(1948.4816, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(1981.8401, device='cuda:2')
compute similarity is  tensor(0.8469, device='cuda:2')
compute distance is  tensor(2013.2391, device='cuda:2')
compute similarity is  tensor(0.8460, device='cuda:2')
calculated distance threshold is  tensor(2028.4454, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4633800001564076
inner product is  tensor(490.0418, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4479400001564075
inner product is  tensor(489.4828, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4476600001564075
inner product is  tensor(492.4823, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.44862000015640746
inner product is  tensor(487.6543, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.4182400001564071
inner product is  tensor(487.0696, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1066.0375, device='cuda:2')
test similarity is  tensor(0.8950, device='cuda:2')
test acc is  0.4182400001564071
test loss is 1.8189677140292
test entropy is  1.1236262325283206
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 50.37% 

Test Accuracy: 49.39% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(4.2197, device='cuda:2')
diff2 is tensor(4.2197, device='cuda:2')
diff1 is tensor(-0.1861, device='cuda:2')
diff2 is tensor(-0.1861, device='cuda:2')
diff1 is tensor(-45.6776, device='cuda:2')
diff2 is tensor(-45.6776, device='cuda:2')
diff1 is tensor(-0.2046, device='cuda:2')
diff2 is tensor(-0.2046, device='cuda:2')
diff1 is tensor(-136.6248, device='cuda:2')
diff2 is tensor(-136.6248, device='cuda:2')
diff1 is tensor(-0.4361, device='cuda:2')
diff2 is tensor(-0.4361, device='cuda:2')
diff1 is tensor(-115.3090, device='cuda:2')
diff2 is tensor(-115.3090, device='cuda:2')
diff1 is tensor(-1.4177, device='cuda:2')
diff2 is tensor(-1.4177, device='cuda:2')
diff1 is tensor(-53.7146, device='cuda:2')
diff2 is tensor(-53.7146, device='cuda:2')
diff1 is tensor(0.0111, device='cuda:2')
diff2 is tensor(0.0111, device='cuda:2')
diff1 is tensor(17.1180, device='cuda:2')
diff2 is tensor(17.1180, device='cuda:2')
diff1 is tensor(-0.0067, device='cuda:2')
diff2 is tensor(-0.0067, device='cuda:2')
diff1 is tensor(-108.8693, device='cuda:2')
diff2 is tensor(-108.8693, device='cuda:2')
diff1 is tensor(-0.7695, device='cuda:2')
diff2 is tensor(-0.7695, device='cuda:2')
diff1 is tensor(-58.1115, device='cuda:2')
diff2 is tensor(-58.1115, device='cuda:2')
diff1 is tensor(-0.4289, device='cuda:2')
diff2 is tensor(-0.4289, device='cuda:2')
diff1 is tensor(-0.0032, device='cuda:2')
diff2 is tensor(-0.0032, device='cuda:2')
diff1 is tensor(2.6822e-07, device='cuda:2')
diff2 is tensor(2.6822e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2091.4299, device='cuda:2')
compute similarity is  tensor(0.8320, device='cuda:2')
compute distance is  tensor(2141.5232, device='cuda:2')
compute similarity is  tensor(0.8311, device='cuda:2')
compute distance is  tensor(2137.3167, device='cuda:2')
compute similarity is  tensor(0.8314, device='cuda:2')
compute distance is  tensor(2113.8501, device='cuda:2')
compute similarity is  tensor(0.8319, device='cuda:2')
compute distance is  tensor(2146.6672, device='cuda:2')
compute similarity is  tensor(0.8310, device='cuda:2')
compute distance is  tensor(2129.9033, device='cuda:2')
compute similarity is  tensor(0.8313, device='cuda:2')
compute distance is  tensor(2142.0229, device='cuda:2')
compute similarity is  tensor(0.8314, device='cuda:2')
compute distance is  tensor(2124.7837, device='cuda:2')
compute similarity is  tensor(0.8316, device='cuda:2')
compute distance is  tensor(2147.7251, device='cuda:2')
compute similarity is  tensor(0.8311, device='cuda:2')
compute distance is  tensor(2113.5679, device='cuda:2')
compute similarity is  tensor(0.8318, device='cuda:2')
compute distance is  tensor(2104.8169, device='cuda:2')
compute similarity is  tensor(0.8319, device='cuda:2')
compute distance is  tensor(2125.9922, device='cuda:2')
compute similarity is  tensor(0.8313, device='cuda:2')
calculated distance threshold is  tensor(2147.7251, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.45480000015640754
inner product is  tensor(360.0729, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4704600001564077
inner product is  tensor(363.7376, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.4718200001564077
inner product is  tensor(360.9899, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4354000001564073
inner product is  tensor(359.1476, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4704400001564077
inner product is  tensor(360.6028, device='cuda:2')
====================
________________________________
test distance is  tensor(1064.1671, device='cuda:2')
test similarity is  tensor(0.8990, device='cuda:2')
test acc is  0.4354000001564073
test loss is 1.8321628515677684
test entropy is  1.039764181655996
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 50.45% 

Test Accuracy: 48.86% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-5.7067, device='cuda:2')
diff2 is tensor(-5.7067, device='cuda:2')
diff1 is tensor(-0.2984, device='cuda:2')
diff2 is tensor(-0.2984, device='cuda:2')
diff1 is tensor(5.9452, device='cuda:2')
diff2 is tensor(5.9452, device='cuda:2')
diff1 is tensor(-0.3805, device='cuda:2')
diff2 is tensor(-0.3805, device='cuda:2')
diff1 is tensor(-6.2009, device='cuda:2')
diff2 is tensor(-6.2009, device='cuda:2')
diff1 is tensor(0.3293, device='cuda:2')
diff2 is tensor(0.3293, device='cuda:2')
diff1 is tensor(-14.4708, device='cuda:2')
diff2 is tensor(-14.4708, device='cuda:2')
diff1 is tensor(0.8776, device='cuda:2')
diff2 is tensor(0.8776, device='cuda:2')
diff1 is tensor(-107.4743, device='cuda:2')
diff2 is tensor(-107.4743, device='cuda:2')
diff1 is tensor(0.5474, device='cuda:2')
diff2 is tensor(0.5474, device='cuda:2')
diff1 is tensor(-101.3594, device='cuda:2')
diff2 is tensor(-101.3594, device='cuda:2')
diff1 is tensor(-1.2484, device='cuda:2')
diff2 is tensor(-1.2484, device='cuda:2')
diff1 is tensor(98.4418, device='cuda:2')
diff2 is tensor(98.4418, device='cuda:2')
diff1 is tensor(0.8413, device='cuda:2')
diff2 is tensor(0.8413, device='cuda:2')
diff1 is tensor(63.7552, device='cuda:2')
diff2 is tensor(63.7552, device='cuda:2')
diff1 is tensor(0.0291, device='cuda:2')
diff2 is tensor(0.0291, device='cuda:2')
diff1 is tensor(0.0043, device='cuda:2')
diff2 is tensor(0.0043, device='cuda:2')
diff1 is tensor(8.1211e-07, device='cuda:2')
diff2 is tensor(8.1211e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2119.1306, device='cuda:2')
compute similarity is  tensor(0.8424, device='cuda:2')
compute distance is  tensor(2133.1184, device='cuda:2')
compute similarity is  tensor(0.8424, device='cuda:2')
compute distance is  tensor(2126.5522, device='cuda:2')
compute similarity is  tensor(0.8424, device='cuda:2')
compute distance is  tensor(2169.1638, device='cuda:2')
compute similarity is  tensor(0.8415, device='cuda:2')
compute distance is  tensor(2138.0474, device='cuda:2')
compute similarity is  tensor(0.8419, device='cuda:2')
compute distance is  tensor(2115.7991, device='cuda:2')
compute similarity is  tensor(0.8425, device='cuda:2')
compute distance is  tensor(2100.6868, device='cuda:2')
compute similarity is  tensor(0.8428, device='cuda:2')
compute distance is  tensor(2148.4080, device='cuda:2')
compute similarity is  tensor(0.8420, device='cuda:2')
compute distance is  tensor(2155.4182, device='cuda:2')
compute similarity is  tensor(0.8417, device='cuda:2')
compute distance is  tensor(2113.7668, device='cuda:2')
compute similarity is  tensor(0.8425, device='cuda:2')
compute distance is  tensor(2105.6482, device='cuda:2')
compute similarity is  tensor(0.8427, device='cuda:2')
compute distance is  tensor(2140.0137, device='cuda:2')
compute similarity is  tensor(0.8421, device='cuda:2')
calculated distance threshold is  tensor(2169.1638, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.49068000015640784
inner product is  tensor(393.7196, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4839000001564078
inner product is  tensor(390.2474, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4702200001564077
inner product is  tensor(391.5679, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4600400001564076
inner product is  tensor(392.5554, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.47866000015640775
inner product is  tensor(390.4316, device='cuda:2')
====================
________________________________
test distance is  tensor(1066.2201, device='cuda:2')
test similarity is  tensor(0.9020, device='cuda:2')
test acc is  0.4600400001564076
test loss is 1.701094265179256
test entropy is  1.0143330994316988
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 53.07% 

Test Accuracy: 51.27% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.5570, device='cuda:2')
diff2 is tensor(0.5570, device='cuda:2')
diff1 is tensor(0.4672, device='cuda:2')
diff2 is tensor(0.4672, device='cuda:2')
diff1 is tensor(-7.5379, device='cuda:2')
diff2 is tensor(-7.5379, device='cuda:2')
diff1 is tensor(0.3619, device='cuda:2')
diff2 is tensor(0.3619, device='cuda:2')
diff1 is tensor(-28.6175, device='cuda:2')
diff2 is tensor(-28.6175, device='cuda:2')
diff1 is tensor(-0.1314, device='cuda:2')
diff2 is tensor(-0.1314, device='cuda:2')
diff1 is tensor(-3.4690, device='cuda:2')
diff2 is tensor(-3.4690, device='cuda:2')
diff1 is tensor(0.0745, device='cuda:2')
diff2 is tensor(0.0745, device='cuda:2')
diff1 is tensor(62.8094, device='cuda:2')
diff2 is tensor(62.8094, device='cuda:2')
diff1 is tensor(1.0787, device='cuda:2')
diff2 is tensor(1.0787, device='cuda:2')
diff1 is tensor(51.0424, device='cuda:2')
diff2 is tensor(51.0424, device='cuda:2')
diff1 is tensor(1.0256, device='cuda:2')
diff2 is tensor(1.0256, device='cuda:2')
diff1 is tensor(38.2359, device='cuda:2')
diff2 is tensor(38.2359, device='cuda:2')
diff1 is tensor(0.7493, device='cuda:2')
diff2 is tensor(0.7493, device='cuda:2')
diff1 is tensor(4.7287, device='cuda:2')
diff2 is tensor(4.7287, device='cuda:2')
diff1 is tensor(0.8096, device='cuda:2')
diff2 is tensor(0.8096, device='cuda:2')
diff1 is tensor(0.0072, device='cuda:2')
diff2 is tensor(0.0072, device='cuda:2')
diff1 is tensor(-4.3213e-07, device='cuda:2')
diff2 is tensor(-4.3213e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1982.8545, device='cuda:2')
compute similarity is  tensor(0.8791, device='cuda:2')
compute distance is  tensor(1936.0483, device='cuda:2')
compute similarity is  tensor(0.8800, device='cuda:2')
compute distance is  tensor(1966.5005, device='cuda:2')
compute similarity is  tensor(0.8797, device='cuda:2')
compute distance is  tensor(1943.9653, device='cuda:2')
compute similarity is  tensor(0.8802, device='cuda:2')
compute distance is  tensor(1960.2397, device='cuda:2')
compute similarity is  tensor(0.8796, device='cuda:2')
compute distance is  tensor(1956.2737, device='cuda:2')
compute similarity is  tensor(0.8798, device='cuda:2')
compute distance is  tensor(1959.7083, device='cuda:2')
compute similarity is  tensor(0.8799, device='cuda:2')
compute distance is  tensor(1975.0022, device='cuda:2')
compute similarity is  tensor(0.8796, device='cuda:2')
compute distance is  tensor(1966.6395, device='cuda:2')
compute similarity is  tensor(0.8797, device='cuda:2')
compute distance is  tensor(1928.8118, device='cuda:2')
compute similarity is  tensor(0.8803, device='cuda:2')
compute distance is  tensor(1940.1921, device='cuda:2')
compute similarity is  tensor(0.8802, device='cuda:2')
compute distance is  tensor(1972.9883, device='cuda:2')
compute similarity is  tensor(0.8794, device='cuda:2')
calculated distance threshold is  tensor(1982.8545, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4922600001564079
inner product is  tensor(294.8741, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.507460000156408
inner product is  tensor(294.2530, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5029400001564079
inner product is  tensor(291.6574, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5031600001564079
inner product is  tensor(292.2097, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.4733600001564077
inner product is  tensor(295.9272, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1063.0873, device='cuda:2')
test similarity is  tensor(0.8975, device='cuda:2')
test acc is  0.4733600001564077
test loss is 1.672933163087996
test entropy is  0.9724876651221224
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 51.72% 

Test Accuracy: 50.41% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.6234, device='cuda:2')
diff2 is tensor(0.6234, device='cuda:2')
diff1 is tensor(-0.7972, device='cuda:2')
diff2 is tensor(-0.7972, device='cuda:2')
diff1 is tensor(-48.0357, device='cuda:2')
diff2 is tensor(-48.0357, device='cuda:2')
diff1 is tensor(-1.0797, device='cuda:2')
diff2 is tensor(-1.0797, device='cuda:2')
diff1 is tensor(29.1606, device='cuda:2')
diff2 is tensor(29.1606, device='cuda:2')
diff1 is tensor(0.0851, device='cuda:2')
diff2 is tensor(0.0851, device='cuda:2')
diff1 is tensor(-137.0042, device='cuda:2')
diff2 is tensor(-137.0042, device='cuda:2')
diff1 is tensor(0.0373, device='cuda:2')
diff2 is tensor(0.0373, device='cuda:2')
diff1 is tensor(-172.0076, device='cuda:2')
diff2 is tensor(-172.0076, device='cuda:2')
diff1 is tensor(-0.8604, device='cuda:2')
diff2 is tensor(-0.8604, device='cuda:2')
diff1 is tensor(-196.8055, device='cuda:2')
diff2 is tensor(-196.8055, device='cuda:2')
diff1 is tensor(-1.3852, device='cuda:2')
diff2 is tensor(-1.3852, device='cuda:2')
diff1 is tensor(-44.5092, device='cuda:2')
diff2 is tensor(-44.5092, device='cuda:2')
diff1 is tensor(0.3145, device='cuda:2')
diff2 is tensor(0.3145, device='cuda:2')
diff1 is tensor(-106.3370, device='cuda:2')
diff2 is tensor(-106.3370, device='cuda:2')
diff1 is tensor(-0.7303, device='cuda:2')
diff2 is tensor(-0.7303, device='cuda:2')
diff1 is tensor(-0.0030, device='cuda:2')
diff2 is tensor(-0.0030, device='cuda:2')
diff1 is tensor(5.8115e-07, device='cuda:2')
diff2 is tensor(5.8115e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2206.8838, device='cuda:2')
compute similarity is  tensor(0.8472, device='cuda:2')
compute distance is  tensor(2190.8335, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(2190.1177, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(2193.1406, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(2224.6975, device='cuda:2')
compute similarity is  tensor(0.8469, device='cuda:2')
compute distance is  tensor(2176.7480, device='cuda:2')
compute similarity is  tensor(0.8477, device='cuda:2')
compute distance is  tensor(2214.5754, device='cuda:2')
compute similarity is  tensor(0.8472, device='cuda:2')
compute distance is  tensor(2174.4241, device='cuda:2')
compute similarity is  tensor(0.8479, device='cuda:2')
compute distance is  tensor(2202.3960, device='cuda:2')
compute similarity is  tensor(0.8474, device='cuda:2')
compute distance is  tensor(2179.0859, device='cuda:2')
compute similarity is  tensor(0.8476, device='cuda:2')
compute distance is  tensor(2166.7588, device='cuda:2')
compute similarity is  tensor(0.8479, device='cuda:2')
compute distance is  tensor(2190.2175, device='cuda:2')
compute similarity is  tensor(0.8476, device='cuda:2')
calculated distance threshold is  tensor(2224.6975, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.499500000156408
inner product is  tensor(498.0626, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4941200001564079
inner product is  tensor(497.0465, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5056000001564079
inner product is  tensor(496.8464, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5082000001564081
inner product is  tensor(496.7790, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.4699000001564077
inner product is  tensor(501.8672, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1064.3883, device='cuda:2')
test similarity is  tensor(0.9063, device='cuda:2')
test acc is  0.4699000001564077
test loss is 1.646111273857029
test entropy is  1.0526788628772092
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 53.06% 

Test Accuracy: 51.97% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.0282, device='cuda:2')
diff2 is tensor(-1.0282, device='cuda:2')
diff1 is tensor(0.2936, device='cuda:2')
diff2 is tensor(0.2936, device='cuda:2')
diff1 is tensor(32.4880, device='cuda:2')
diff2 is tensor(32.4880, device='cuda:2')
diff1 is tensor(-0.8697, device='cuda:2')
diff2 is tensor(-0.8697, device='cuda:2')
diff1 is tensor(-41.3308, device='cuda:2')
diff2 is tensor(-41.3308, device='cuda:2')
diff1 is tensor(0.1156, device='cuda:2')
diff2 is tensor(0.1156, device='cuda:2')
diff1 is tensor(-43.6231, device='cuda:2')
diff2 is tensor(-43.6231, device='cuda:2')
diff1 is tensor(0.2896, device='cuda:2')
diff2 is tensor(0.2896, device='cuda:2')
diff1 is tensor(-19.0006, device='cuda:2')
diff2 is tensor(-19.0006, device='cuda:2')
diff1 is tensor(0.8700, device='cuda:2')
diff2 is tensor(0.8700, device='cuda:2')
diff1 is tensor(69.9375, device='cuda:2')
diff2 is tensor(69.9375, device='cuda:2')
diff1 is tensor(0.5756, device='cuda:2')
diff2 is tensor(0.5756, device='cuda:2')
diff1 is tensor(-26.4990, device='cuda:2')
diff2 is tensor(-26.4990, device='cuda:2')
diff1 is tensor(0.3839, device='cuda:2')
diff2 is tensor(0.3839, device='cuda:2')
diff1 is tensor(6.7767, device='cuda:2')
diff2 is tensor(6.7767, device='cuda:2')
diff1 is tensor(0.6273, device='cuda:2')
diff2 is tensor(0.6273, device='cuda:2')
diff1 is tensor(0.0004, device='cuda:2')
diff2 is tensor(0.0004, device='cuda:2')
diff1 is tensor(-3.2037e-07, device='cuda:2')
diff2 is tensor(-3.2037e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2013.1412, device='cuda:2')
compute similarity is  tensor(0.8891, device='cuda:2')
compute distance is  tensor(2026.3148, device='cuda:2')
compute similarity is  tensor(0.8888, device='cuda:2')
compute distance is  tensor(2005.3983, device='cuda:2')
compute similarity is  tensor(0.8893, device='cuda:2')
compute distance is  tensor(1987.1700, device='cuda:2')
compute similarity is  tensor(0.8897, device='cuda:2')
compute distance is  tensor(1985.2485, device='cuda:2')
compute similarity is  tensor(0.8895, device='cuda:2')
compute distance is  tensor(1964.2404, device='cuda:2')
compute similarity is  tensor(0.8898, device='cuda:2')
compute distance is  tensor(1985.4183, device='cuda:2')
compute similarity is  tensor(0.8899, device='cuda:2')
compute distance is  tensor(1972.7517, device='cuda:2')
compute similarity is  tensor(0.8901, device='cuda:2')
compute distance is  tensor(1962.3364, device='cuda:2')
compute similarity is  tensor(0.8901, device='cuda:2')
compute distance is  tensor(1957.1377, device='cuda:2')
compute similarity is  tensor(0.8901, device='cuda:2')
compute distance is  tensor(1992.9763, device='cuda:2')
compute similarity is  tensor(0.8895, device='cuda:2')
compute distance is  tensor(1986.2811, device='cuda:2')
compute similarity is  tensor(0.8896, device='cuda:2')
calculated distance threshold is  tensor(2026.3148, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5221800001564082
inner product is  tensor(311.4122, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5178200001564082
inner product is  tensor(310.8434, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5133000001564081
inner product is  tensor(313.2596, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4944000001564079
inner product is  tensor(311.9238, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.510780000156408
inner product is  tensor(310.4962, device='cuda:2')
====================
________________________________
test distance is  tensor(1063.1987, device='cuda:2')
test similarity is  tensor(0.9015, device='cuda:2')
test acc is  0.4944000001564079
test loss is 1.5945190009863481
test entropy is  0.9766479210018197
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 52.59% 

Test Accuracy: 51.65% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(4.1266, device='cuda:2')
diff2 is tensor(4.1266, device='cuda:2')
diff1 is tensor(0.1394, device='cuda:2')
diff2 is tensor(0.1394, device='cuda:2')
diff1 is tensor(-49.4034, device='cuda:2')
diff2 is tensor(-49.4034, device='cuda:2')
diff1 is tensor(-1.3513, device='cuda:2')
diff2 is tensor(-1.3513, device='cuda:2')
diff1 is tensor(-44.4739, device='cuda:2')
diff2 is tensor(-44.4739, device='cuda:2')
diff1 is tensor(-0.0116, device='cuda:2')
diff2 is tensor(-0.0116, device='cuda:2')
diff1 is tensor(-56.3739, device='cuda:2')
diff2 is tensor(-56.3739, device='cuda:2')
diff1 is tensor(-0.3401, device='cuda:2')
diff2 is tensor(-0.3401, device='cuda:2')
diff1 is tensor(-145.7865, device='cuda:2')
diff2 is tensor(-145.7865, device='cuda:2')
diff1 is tensor(-0.8193, device='cuda:2')
diff2 is tensor(-0.8193, device='cuda:2')
diff1 is tensor(-41.6128, device='cuda:2')
diff2 is tensor(-41.6128, device='cuda:2')
diff1 is tensor(-0.6459, device='cuda:2')
diff2 is tensor(-0.6459, device='cuda:2')
diff1 is tensor(-13.5724, device='cuda:2')
diff2 is tensor(-13.5724, device='cuda:2')
diff1 is tensor(1.4927, device='cuda:2')
diff2 is tensor(1.4927, device='cuda:2')
diff1 is tensor(12.3432, device='cuda:2')
diff2 is tensor(12.3432, device='cuda:2')
diff1 is tensor(0.7214, device='cuda:2')
diff2 is tensor(0.7214, device='cuda:2')
diff1 is tensor(0.0023, device='cuda:2')
diff2 is tensor(0.0023, device='cuda:2')
diff1 is tensor(2.1607e-07, device='cuda:2')
diff2 is tensor(2.1607e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2195.4221, device='cuda:2')
compute similarity is  tensor(0.8639, device='cuda:2')
compute distance is  tensor(2179.9370, device='cuda:2')
compute similarity is  tensor(0.8643, device='cuda:2')
compute distance is  tensor(2160.4438, device='cuda:2')
compute similarity is  tensor(0.8646, device='cuda:2')
compute distance is  tensor(2175.5896, device='cuda:2')
compute similarity is  tensor(0.8643, device='cuda:2')
compute distance is  tensor(2149.8948, device='cuda:2')
compute similarity is  tensor(0.8647, device='cuda:2')
compute distance is  tensor(2176.2229, device='cuda:2')
compute similarity is  tensor(0.8641, device='cuda:2')
compute distance is  tensor(2183.6116, device='cuda:2')
compute similarity is  tensor(0.8642, device='cuda:2')
compute distance is  tensor(2189.2698, device='cuda:2')
compute similarity is  tensor(0.8641, device='cuda:2')
compute distance is  tensor(2179.9363, device='cuda:2')
compute similarity is  tensor(0.8641, device='cuda:2')
compute distance is  tensor(2187.4045, device='cuda:2')
compute similarity is  tensor(0.8638, device='cuda:2')
compute distance is  tensor(2163.7852, device='cuda:2')
compute similarity is  tensor(0.8643, device='cuda:2')
compute distance is  tensor(2192.5247, device='cuda:2')
compute similarity is  tensor(0.8637, device='cuda:2')
calculated distance threshold is  tensor(2195.4221, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5172200001564081
inner product is  tensor(510.0024, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5094000001564081
inner product is  tensor(510.3552, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5006000001564079
inner product is  tensor(508.2868, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.505620000156408
inner product is  tensor(508.3456, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.501100000156408
inner product is  tensor(510.5634, device='cuda:2')
====================
________________________________
test distance is  tensor(1062.7426, device='cuda:2')
test similarity is  tensor(0.9099, device='cuda:2')
test acc is  0.5006000001564079
test loss is 1.588169737850004
test entropy is  0.9181352204374035
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 54.37% 

Test Accuracy: 53.89% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.4103, device='cuda:2')
diff2 is tensor(-2.4103, device='cuda:2')
diff1 is tensor(-1.1819, device='cuda:2')
diff2 is tensor(-1.1819, device='cuda:2')
diff1 is tensor(-50.7323, device='cuda:2')
diff2 is tensor(-50.7323, device='cuda:2')
diff1 is tensor(0.9433, device='cuda:2')
diff2 is tensor(0.9433, device='cuda:2')
diff1 is tensor(-21.8544, device='cuda:2')
diff2 is tensor(-21.8544, device='cuda:2')
diff1 is tensor(-0.1110, device='cuda:2')
diff2 is tensor(-0.1110, device='cuda:2')
diff1 is tensor(-164.2549, device='cuda:2')
diff2 is tensor(-164.2549, device='cuda:2')
diff1 is tensor(-0.2248, device='cuda:2')
diff2 is tensor(-0.2248, device='cuda:2')
diff1 is tensor(-167.1062, device='cuda:2')
diff2 is tensor(-167.1062, device='cuda:2')
diff1 is tensor(0.4226, device='cuda:2')
diff2 is tensor(0.4226, device='cuda:2')
diff1 is tensor(-145.9948, device='cuda:2')
diff2 is tensor(-145.9948, device='cuda:2')
diff1 is tensor(-0.3036, device='cuda:2')
diff2 is tensor(-0.3036, device='cuda:2')
diff1 is tensor(-217.6434, device='cuda:2')
diff2 is tensor(-217.6434, device='cuda:2')
diff1 is tensor(-1.9771, device='cuda:2')
diff2 is tensor(-1.9771, device='cuda:2')
diff1 is tensor(-97.0691, device='cuda:2')
diff2 is tensor(-97.0691, device='cuda:2')
diff1 is tensor(-0.9958, device='cuda:2')
diff2 is tensor(-0.9958, device='cuda:2')
diff1 is tensor(-0.0032, device='cuda:2')
diff2 is tensor(-0.0032, device='cuda:2')
diff1 is tensor(-1.1772e-06, device='cuda:2')
diff2 is tensor(-1.1772e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2210.7605, device='cuda:2')
compute similarity is  tensor(0.8670, device='cuda:2')
compute distance is  tensor(2226.0576, device='cuda:2')
compute similarity is  tensor(0.8669, device='cuda:2')
compute distance is  tensor(2240.0518, device='cuda:2')
compute similarity is  tensor(0.8667, device='cuda:2')
compute distance is  tensor(2194.4282, device='cuda:2')
compute similarity is  tensor(0.8672, device='cuda:2')
compute distance is  tensor(2231.4758, device='cuda:2')
compute similarity is  tensor(0.8667, device='cuda:2')
compute distance is  tensor(2184.8213, device='cuda:2')
compute similarity is  tensor(0.8675, device='cuda:2')
compute distance is  tensor(2202.1750, device='cuda:2')
compute similarity is  tensor(0.8673, device='cuda:2')
compute distance is  tensor(2196.4099, device='cuda:2')
compute similarity is  tensor(0.8674, device='cuda:2')
compute distance is  tensor(2181.5408, device='cuda:2')
compute similarity is  tensor(0.8676, device='cuda:2')
compute distance is  tensor(2178.5398, device='cuda:2')
compute similarity is  tensor(0.8676, device='cuda:2')
compute distance is  tensor(2226.7661, device='cuda:2')
compute similarity is  tensor(0.8667, device='cuda:2')
compute distance is  tensor(2201.4919, device='cuda:2')
compute similarity is  tensor(0.8671, device='cuda:2')
calculated distance threshold is  tensor(2240.0518, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5332800001564083
inner product is  tensor(337.4664, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5235600001564081
inner product is  tensor(335.7437, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5523800001564084
inner product is  tensor(338.2127, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5187800001564081
inner product is  tensor(339.6042, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5204200001564081
inner product is  tensor(338.8200, device='cuda:2')
====================
________________________________
test distance is  tensor(1065.7495, device='cuda:2')
test similarity is  tensor(0.9091, device='cuda:2')
test acc is  0.5187800001564081
test loss is 1.521275102329986
test entropy is  0.8899733086528681
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 54.73% 

Test Accuracy: 53.96% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.4048, device='cuda:2')
diff2 is tensor(1.4048, device='cuda:2')
diff1 is tensor(0.9153, device='cuda:2')
diff2 is tensor(0.9153, device='cuda:2')
diff1 is tensor(27.7032, device='cuda:2')
diff2 is tensor(27.7032, device='cuda:2')
diff1 is tensor(-0.3435, device='cuda:2')
diff2 is tensor(-0.3435, device='cuda:2')
diff1 is tensor(-74.0140, device='cuda:2')
diff2 is tensor(-74.0140, device='cuda:2')
diff1 is tensor(0.1307, device='cuda:2')
diff2 is tensor(0.1307, device='cuda:2')
diff1 is tensor(58.8503, device='cuda:2')
diff2 is tensor(58.8503, device='cuda:2')
diff1 is tensor(-0.4498, device='cuda:2')
diff2 is tensor(-0.4498, device='cuda:2')
diff1 is tensor(46.8207, device='cuda:2')
diff2 is tensor(46.8207, device='cuda:2')
diff1 is tensor(-0.4603, device='cuda:2')
diff2 is tensor(-0.4603, device='cuda:2')
diff1 is tensor(-45.3927, device='cuda:2')
diff2 is tensor(-45.3927, device='cuda:2')
diff1 is tensor(-0.2583, device='cuda:2')
diff2 is tensor(-0.2583, device='cuda:2')
diff1 is tensor(204.2097, device='cuda:2')
diff2 is tensor(204.2097, device='cuda:2')
diff1 is tensor(1.7939, device='cuda:2')
diff2 is tensor(1.7939, device='cuda:2')
diff1 is tensor(87.9684, device='cuda:2')
diff2 is tensor(87.9684, device='cuda:2')
diff1 is tensor(1.1973, device='cuda:2')
diff2 is tensor(1.1973, device='cuda:2')
diff1 is tensor(-0.0022, device='cuda:2')
diff2 is tensor(-0.0022, device='cuda:2')
diff1 is tensor(1.4007e-06, device='cuda:2')
diff2 is tensor(1.4007e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2211.8984, device='cuda:2')
compute similarity is  tensor(0.8801, device='cuda:2')
compute distance is  tensor(2163.5400, device='cuda:2')
compute similarity is  tensor(0.8811, device='cuda:2')
compute distance is  tensor(2132.3813, device='cuda:2')
compute similarity is  tensor(0.8816, device='cuda:2')
compute distance is  tensor(2172.2375, device='cuda:2')
compute similarity is  tensor(0.8807, device='cuda:2')
compute distance is  tensor(2165.6646, device='cuda:2')
compute similarity is  tensor(0.8811, device='cuda:2')
compute distance is  tensor(2160.0879, device='cuda:2')
compute similarity is  tensor(0.8809, device='cuda:2')
compute distance is  tensor(2162.8130, device='cuda:2')
compute similarity is  tensor(0.8812, device='cuda:2')
compute distance is  tensor(2161.0684, device='cuda:2')
compute similarity is  tensor(0.8814, device='cuda:2')
compute distance is  tensor(2186.7622, device='cuda:2')
compute similarity is  tensor(0.8805, device='cuda:2')
compute distance is  tensor(2156.2761, device='cuda:2')
compute similarity is  tensor(0.8811, device='cuda:2')
compute distance is  tensor(2177.5159, device='cuda:2')
compute similarity is  tensor(0.8808, device='cuda:2')
compute distance is  tensor(2195.5198, device='cuda:2')
compute similarity is  tensor(0.8804, device='cuda:2')
calculated distance threshold is  tensor(2211.8984, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5324200001564082
inner product is  tensor(359.4914, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5379000001564083
inner product is  tensor(359.3973, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5488800001564085
inner product is  tensor(357.1530, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5482400001564084
inner product is  tensor(357.0492, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5379400001564083
inner product is  tensor(359.5453, device='cuda:2')
====================
________________________________
test distance is  tensor(1060.2100, device='cuda:2')
test similarity is  tensor(0.9100, device='cuda:2')
test acc is  0.5324200001564082
test loss is 1.4484190789177596
test entropy is  0.9038966002366732
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 55.05% 

Test Accuracy: 54.88% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.4789, device='cuda:2')
diff2 is tensor(-2.4789, device='cuda:2')
diff1 is tensor(-0.6210, device='cuda:2')
diff2 is tensor(-0.6210, device='cuda:2')
diff1 is tensor(2.2571, device='cuda:2')
diff2 is tensor(2.2571, device='cuda:2')
diff1 is tensor(-0.4790, device='cuda:2')
diff2 is tensor(-0.4790, device='cuda:2')
diff1 is tensor(-36.0052, device='cuda:2')
diff2 is tensor(-36.0052, device='cuda:2')
diff1 is tensor(0.0436, device='cuda:2')
diff2 is tensor(0.0436, device='cuda:2')
diff1 is tensor(-104.7053, device='cuda:2')
diff2 is tensor(-104.7053, device='cuda:2')
diff1 is tensor(0.2917, device='cuda:2')
diff2 is tensor(0.2917, device='cuda:2')
diff1 is tensor(-120.7149, device='cuda:2')
diff2 is tensor(-120.7149, device='cuda:2')
diff1 is tensor(0.9768, device='cuda:2')
diff2 is tensor(0.9768, device='cuda:2')
diff1 is tensor(5.0915, device='cuda:2')
diff2 is tensor(5.0915, device='cuda:2')
diff1 is tensor(0.2396, device='cuda:2')
diff2 is tensor(0.2396, device='cuda:2')
diff1 is tensor(-61.6412, device='cuda:2')
diff2 is tensor(-61.6412, device='cuda:2')
diff1 is tensor(0.0949, device='cuda:2')
diff2 is tensor(0.0949, device='cuda:2')
diff1 is tensor(-72.7223, device='cuda:2')
diff2 is tensor(-72.7223, device='cuda:2')
diff1 is tensor(-0.1520, device='cuda:2')
diff2 is tensor(-0.1520, device='cuda:2')
diff1 is tensor(8.9398e-05, device='cuda:2')
diff2 is tensor(8.9398e-05, device='cuda:2')
diff1 is tensor(-1.1399e-06, device='cuda:2')
diff2 is tensor(-1.1399e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2276.2151, device='cuda:2')
compute similarity is  tensor(0.8717, device='cuda:2')
compute distance is  tensor(2226.6953, device='cuda:2')
compute similarity is  tensor(0.8726, device='cuda:2')
compute distance is  tensor(2260.5308, device='cuda:2')
compute similarity is  tensor(0.8720, device='cuda:2')
compute distance is  tensor(2270.5540, device='cuda:2')
compute similarity is  tensor(0.8717, device='cuda:2')
compute distance is  tensor(2292.7686, device='cuda:2')
compute similarity is  tensor(0.8714, device='cuda:2')
compute distance is  tensor(2285.9634, device='cuda:2')
compute similarity is  tensor(0.8715, device='cuda:2')
compute distance is  tensor(2300.2537, device='cuda:2')
compute similarity is  tensor(0.8712, device='cuda:2')
compute distance is  tensor(2262.1777, device='cuda:2')
compute similarity is  tensor(0.8719, device='cuda:2')
compute distance is  tensor(2298.9788, device='cuda:2')
compute similarity is  tensor(0.8713, device='cuda:2')
compute distance is  tensor(2263.8577, device='cuda:2')
compute similarity is  tensor(0.8718, device='cuda:2')
compute distance is  tensor(2250.1206, device='cuda:2')
compute similarity is  tensor(0.8720, device='cuda:2')
compute distance is  tensor(2274.7073, device='cuda:2')
compute similarity is  tensor(0.8715, device='cuda:2')
calculated distance threshold is  tensor(2300.2537, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5360200001564083
inner product is  tensor(379.3380, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5393600001564084
inner product is  tensor(375.8297, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5306400001564082
inner product is  tensor(377.6124, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5435600001564084
inner product is  tensor(377.8741, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5439400001564083
inner product is  tensor(377.5458, device='cuda:2')
====================
________________________________
test distance is  tensor(1062.4729, device='cuda:2')
test similarity is  tensor(0.9141, device='cuda:2')
test acc is  0.5306400001564082
test loss is 1.530285753328782
test entropy is  0.8055795024880363
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 54.24% 

Test Accuracy: 53.72% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.0848, device='cuda:2')
diff2 is tensor(-0.0848, device='cuda:2')
diff1 is tensor(-0.3418, device='cuda:2')
diff2 is tensor(-0.3418, device='cuda:2')
diff1 is tensor(-90.5552, device='cuda:2')
diff2 is tensor(-90.5552, device='cuda:2')
diff1 is tensor(-1.6466, device='cuda:2')
diff2 is tensor(-1.6466, device='cuda:2')
diff1 is tensor(61.7561, device='cuda:2')
diff2 is tensor(61.7561, device='cuda:2')
diff1 is tensor(0.4341, device='cuda:2')
diff2 is tensor(0.4341, device='cuda:2')
diff1 is tensor(-119.7515, device='cuda:2')
diff2 is tensor(-119.7515, device='cuda:2')
diff1 is tensor(-0.0729, device='cuda:2')
diff2 is tensor(-0.0729, device='cuda:2')
diff1 is tensor(-123.2333, device='cuda:2')
diff2 is tensor(-123.2333, device='cuda:2')
diff1 is tensor(0.1711, device='cuda:2')
diff2 is tensor(0.1711, device='cuda:2')
diff1 is tensor(-133.3596, device='cuda:2')
diff2 is tensor(-133.3596, device='cuda:2')
diff1 is tensor(-0.5943, device='cuda:2')
diff2 is tensor(-0.5943, device='cuda:2')
diff1 is tensor(-43.9514, device='cuda:2')
diff2 is tensor(-43.9514, device='cuda:2')
diff1 is tensor(-0.4154, device='cuda:2')
diff2 is tensor(-0.4154, device='cuda:2')
diff1 is tensor(-40.0092, device='cuda:2')
diff2 is tensor(-40.0092, device='cuda:2')
diff1 is tensor(0.0587, device='cuda:2')
diff2 is tensor(0.0587, device='cuda:2')
diff1 is tensor(0.0061, device='cuda:2')
diff2 is tensor(0.0061, device='cuda:2')
diff1 is tensor(1.1846e-06, device='cuda:2')
diff2 is tensor(1.1846e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2414.0637, device='cuda:2')
compute similarity is  tensor(0.8540, device='cuda:2')
compute distance is  tensor(2395.2915, device='cuda:2')
compute similarity is  tensor(0.8544, device='cuda:2')
compute distance is  tensor(2372.8508, device='cuda:2')
compute similarity is  tensor(0.8547, device='cuda:2')
compute distance is  tensor(2433.0391, device='cuda:2')
compute similarity is  tensor(0.8537, device='cuda:2')
compute distance is  tensor(2429.1355, device='cuda:2')
compute similarity is  tensor(0.8537, device='cuda:2')
compute distance is  tensor(2403.5693, device='cuda:2')
compute similarity is  tensor(0.8541, device='cuda:2')
compute distance is  tensor(2455.3926, device='cuda:2')
compute similarity is  tensor(0.8533, device='cuda:2')
compute distance is  tensor(2379.9934, device='cuda:2')
compute similarity is  tensor(0.8548, device='cuda:2')
compute distance is  tensor(2433.8530, device='cuda:2')
compute similarity is  tensor(0.8537, device='cuda:2')
compute distance is  tensor(2452.9680, device='cuda:2')
compute similarity is  tensor(0.8533, device='cuda:2')
compute distance is  tensor(2401.2002, device='cuda:2')
compute similarity is  tensor(0.8543, device='cuda:2')
compute distance is  tensor(2406.0994, device='cuda:2')
compute similarity is  tensor(0.8541, device='cuda:2')
calculated distance threshold is  tensor(2455.3926, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5172400001564081
inner product is  tensor(509.6415, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5231800001564082
inner product is  tensor(513.7734, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5295800001564082
inner product is  tensor(515.3747, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5467600001564084
inner product is  tensor(516.5685, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5351600001564082
inner product is  tensor(515.4148, device='cuda:2')
====================
________________________________
test distance is  tensor(1067.2565, device='cuda:2')
test similarity is  tensor(0.9202, device='cuda:2')
test acc is  0.5172400001564081
test loss is 1.5962388998712116
test entropy is  0.8398548533849399
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 55.72% 

Test Accuracy: 55.38% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(3.1167, device='cuda:2')
diff2 is tensor(3.1167, device='cuda:2')
diff1 is tensor(1.1799, device='cuda:2')
diff2 is tensor(1.1799, device='cuda:2')
diff1 is tensor(25.1495, device='cuda:2')
diff2 is tensor(25.1495, device='cuda:2')
diff1 is tensor(0.6922, device='cuda:2')
diff2 is tensor(0.6922, device='cuda:2')
diff1 is tensor(-32.4178, device='cuda:2')
diff2 is tensor(-32.4178, device='cuda:2')
diff1 is tensor(0.1227, device='cuda:2')
diff2 is tensor(0.1227, device='cuda:2')
diff1 is tensor(35.2014, device='cuda:2')
diff2 is tensor(35.2014, device='cuda:2')
diff1 is tensor(0.1189, device='cuda:2')
diff2 is tensor(0.1189, device='cuda:2')
diff1 is tensor(118.9947, device='cuda:2')
diff2 is tensor(118.9947, device='cuda:2')
diff1 is tensor(0.4789, device='cuda:2')
diff2 is tensor(0.4789, device='cuda:2')
diff1 is tensor(1.6654, device='cuda:2')
diff2 is tensor(1.6654, device='cuda:2')
diff1 is tensor(0.3989, device='cuda:2')
diff2 is tensor(0.3989, device='cuda:2')
diff1 is tensor(98.3359, device='cuda:2')
diff2 is tensor(98.3359, device='cuda:2')
diff1 is tensor(0.6784, device='cuda:2')
diff2 is tensor(0.6784, device='cuda:2')
diff1 is tensor(48.3795, device='cuda:2')
diff2 is tensor(48.3795, device='cuda:2')
diff1 is tensor(0.7947, device='cuda:2')
diff2 is tensor(0.7947, device='cuda:2')
diff1 is tensor(-0.0079, device='cuda:2')
diff2 is tensor(-0.0079, device='cuda:2')
diff1 is tensor(1.3411e-07, device='cuda:2')
diff2 is tensor(1.3411e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2210.3672, device='cuda:2')
compute similarity is  tensor(0.8932, device='cuda:2')
compute distance is  tensor(2193.0781, device='cuda:2')
compute similarity is  tensor(0.8937, device='cuda:2')
compute distance is  tensor(2204.7598, device='cuda:2')
compute similarity is  tensor(0.8934, device='cuda:2')
compute distance is  tensor(2198.4255, device='cuda:2')
compute similarity is  tensor(0.8933, device='cuda:2')
compute distance is  tensor(2213.9336, device='cuda:2')
compute similarity is  tensor(0.8931, device='cuda:2')
compute distance is  tensor(2184.4312, device='cuda:2')
compute similarity is  tensor(0.8936, device='cuda:2')
compute distance is  tensor(2163.3704, device='cuda:2')
compute similarity is  tensor(0.8941, device='cuda:2')
compute distance is  tensor(2160.3489, device='cuda:2')
compute similarity is  tensor(0.8942, device='cuda:2')
compute distance is  tensor(2201.5881, device='cuda:2')
compute similarity is  tensor(0.8935, device='cuda:2')
compute distance is  tensor(2170.5818, device='cuda:2')
compute similarity is  tensor(0.8939, device='cuda:2')
compute distance is  tensor(2142.9680, device='cuda:2')
compute similarity is  tensor(0.8942, device='cuda:2')
compute distance is  tensor(2168.1060, device='cuda:2')
compute similarity is  tensor(0.8940, device='cuda:2')
calculated distance threshold is  tensor(2213.9336, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5546800001564084
inner product is  tensor(353.4989, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5658200001564085
inner product is  tensor(352.3015, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5525400001564085
inner product is  tensor(350.6329, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5643600001564085
inner product is  tensor(351.0458, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5678000001564085
inner product is  tensor(352.7130, device='cuda:2')
====================
________________________________
test distance is  tensor(1062.1797, device='cuda:2')
test similarity is  tensor(0.9139, device='cuda:2')
test acc is  0.5525400001564085
test loss is 1.456801745516565
test entropy is  0.8118530956223188
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 55.71% 

Test Accuracy: 55.47% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.4068, device='cuda:2')
diff2 is tensor(-2.4068, device='cuda:2')
diff1 is tensor(-0.9479, device='cuda:2')
diff2 is tensor(-0.9479, device='cuda:2')
diff1 is tensor(-49.9114, device='cuda:2')
diff2 is tensor(-49.9114, device='cuda:2')
diff1 is tensor(1.2689, device='cuda:2')
diff2 is tensor(1.2689, device='cuda:2')
diff1 is tensor(-9.6872, device='cuda:2')
diff2 is tensor(-9.6872, device='cuda:2')
diff1 is tensor(-0.1355, device='cuda:2')
diff2 is tensor(-0.1355, device='cuda:2')
diff1 is tensor(-63.9149, device='cuda:2')
diff2 is tensor(-63.9149, device='cuda:2')
diff1 is tensor(-0.6467, device='cuda:2')
diff2 is tensor(-0.6467, device='cuda:2')
diff1 is tensor(-128.8624, device='cuda:2')
diff2 is tensor(-128.8624, device='cuda:2')
diff1 is tensor(-0.9060, device='cuda:2')
diff2 is tensor(-0.9060, device='cuda:2')
diff1 is tensor(-13.9580, device='cuda:2')
diff2 is tensor(-13.9580, device='cuda:2')
diff1 is tensor(-0.5608, device='cuda:2')
diff2 is tensor(-0.5608, device='cuda:2')
diff1 is tensor(-123.6998, device='cuda:2')
diff2 is tensor(-123.6998, device='cuda:2')
diff1 is tensor(-0.3731, device='cuda:2')
diff2 is tensor(-0.3731, device='cuda:2')
diff1 is tensor(-25.1383, device='cuda:2')
diff2 is tensor(-25.1383, device='cuda:2')
diff1 is tensor(-0.1673, device='cuda:2')
diff2 is tensor(-0.1673, device='cuda:2')
diff1 is tensor(0.0037, device='cuda:2')
diff2 is tensor(0.0037, device='cuda:2')
diff1 is tensor(-1.2619e-06, device='cuda:2')
diff2 is tensor(-1.2619e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(2214.3545, device='cuda:2')
compute similarity is  tensor(0.8970, device='cuda:2')
compute distance is  tensor(2166.6450, device='cuda:2')
compute similarity is  tensor(0.8978, device='cuda:2')
compute distance is  tensor(2184.1848, device='cuda:2')
compute similarity is  tensor(0.8976, device='cuda:2')
compute distance is  tensor(2205.6414, device='cuda:2')
compute similarity is  tensor(0.8974, device='cuda:2')
compute distance is  tensor(2203.4729, device='cuda:2')
compute similarity is  tensor(0.8973, device='cuda:2')
compute distance is  tensor(2179.5381, device='cuda:2')
compute similarity is  tensor(0.8975, device='cuda:2')
compute distance is  tensor(2166.8767, device='cuda:2')
compute similarity is  tensor(0.8980, device='cuda:2')
compute distance is  tensor(2158.4216, device='cuda:2')
compute similarity is  tensor(0.8981, device='cuda:2')
compute distance is  tensor(2174.0410, device='cuda:2')
compute similarity is  tensor(0.8977, device='cuda:2')
compute distance is  tensor(2163.7524, device='cuda:2')
compute similarity is  tensor(0.8980, device='cuda:2')
compute distance is  tensor(2146.6621, device='cuda:2')
compute similarity is  tensor(0.8982, device='cuda:2')
compute distance is  tensor(2161.5930, device='cuda:2')
compute similarity is  tensor(0.8981, device='cuda:2')
calculated distance threshold is  tensor(2214.3545, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5451400001564084
inner product is  tensor(427.8262, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5714400001564086
inner product is  tensor(428.6757, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5606000001564085
inner product is  tensor(428.7854, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5575600001564084
inner product is  tensor(429.7273, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5663600001564085
inner product is  tensor(432.3190, device='cuda:2')
====================
________________________________
test distance is  tensor(1064.0454, device='cuda:2')
test similarity is  tensor(0.9168, device='cuda:2')
test acc is  0.5451400001564084
test loss is 1.4652289282482909
test entropy is  0.8316941506722394
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 56.59% 

Test Accuracy: 56.14% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 56.59%
|----0th round Training Accuracy : 9.74%
|----1th round Training Accuracy : 9.74%
|----2th round Training Accuracy : 9.74%
|----3th round Training Accuracy : 9.74%
|----4th round Training Accuracy : 9.74%
|----5th round Training Accuracy : 10.26%
|----6th round Training Accuracy : 15.65%
|----7th round Training Accuracy : 16.84%
|----8th round Training Accuracy : 24.52%
|----9th round Training Accuracy : 26.80%
|----10th round Training Accuracy : 31.59%
|----11th round Training Accuracy : 29.11%
|----12th round Training Accuracy : 27.44%
|----13th round Training Accuracy : 32.23%
|----14th round Training Accuracy : 32.76%
|----15th round Training Accuracy : 33.81%
|----16th round Training Accuracy : 32.97%
|----17th round Training Accuracy : 34.42%
|----18th round Training Accuracy : 33.18%
|----19th round Training Accuracy : 37.67%
|----20th round Training Accuracy : 37.83%
|----21th round Training Accuracy : 38.10%
|----22th round Training Accuracy : 36.86%
|----23th round Training Accuracy : 39.62%
|----24th round Training Accuracy : 39.22%
|----25th round Training Accuracy : 40.60%
|----26th round Training Accuracy : 40.85%
|----27th round Training Accuracy : 44.08%
|----28th round Training Accuracy : 42.79%
|----29th round Training Accuracy : 46.63%
|----30th round Training Accuracy : 45.11%
|----31th round Training Accuracy : 46.54%
|----32th round Training Accuracy : 46.88%
|----33th round Training Accuracy : 46.92%
|----34th round Training Accuracy : 48.70%
|----35th round Training Accuracy : 49.72%
|----36th round Training Accuracy : 48.62%
|----37th round Training Accuracy : 50.37%
|----38th round Training Accuracy : 50.45%
|----39th round Training Accuracy : 53.07%
|----40th round Training Accuracy : 51.72%
|----41th round Training Accuracy : 53.06%
|----42th round Training Accuracy : 52.59%
|----43th round Training Accuracy : 54.37%
|----44th round Training Accuracy : 54.73%
|----45th round Training Accuracy : 55.05%
|----46th round Training Accuracy : 54.24%
|----47th round Training Accuracy : 55.72%
|----48th round Training Accuracy : 55.71%
|----49th round Training Accuracy : 56.59%
|----Final Test Accuracy: 56.14%
|----0th round Final Test Accuracy : 10.00%
|----1th round Final Test Accuracy : 10.00%
|----2th round Final Test Accuracy : 10.00%
|----3th round Final Test Accuracy : 10.00%
|----4th round Final Test Accuracy : 10.00%
|----5th round Final Test Accuracy : 10.00%
|----6th round Final Test Accuracy : 15.49%
|----7th round Final Test Accuracy : 17.27%
|----8th round Final Test Accuracy : 24.99%
|----9th round Final Test Accuracy : 26.88%
|----10th round Final Test Accuracy : 32.00%
|----11th round Final Test Accuracy : 29.56%
|----12th round Final Test Accuracy : 27.54%
|----13th round Final Test Accuracy : 32.64%
|----14th round Final Test Accuracy : 33.12%
|----15th round Final Test Accuracy : 33.84%
|----16th round Final Test Accuracy : 32.87%
|----17th round Final Test Accuracy : 33.85%
|----18th round Final Test Accuracy : 33.39%
|----19th round Final Test Accuracy : 37.38%
|----20th round Final Test Accuracy : 37.66%
|----21th round Final Test Accuracy : 38.01%
|----22th round Final Test Accuracy : 36.45%
|----23th round Final Test Accuracy : 38.90%
|----24th round Final Test Accuracy : 39.12%
|----25th round Final Test Accuracy : 39.83%
|----26th round Final Test Accuracy : 39.73%
|----27th round Final Test Accuracy : 43.38%
|----28th round Final Test Accuracy : 42.48%
|----29th round Final Test Accuracy : 45.68%
|----30th round Final Test Accuracy : 44.07%
|----31th round Final Test Accuracy : 45.55%
|----32th round Final Test Accuracy : 45.89%
|----33th round Final Test Accuracy : 46.54%
|----34th round Final Test Accuracy : 48.28%
|----35th round Final Test Accuracy : 48.88%
|----36th round Final Test Accuracy : 47.72%
|----37th round Final Test Accuracy : 49.39%
|----38th round Final Test Accuracy : 48.86%
|----39th round Final Test Accuracy : 51.27%
|----40th round Final Test Accuracy : 50.41%
|----41th round Final Test Accuracy : 51.97%
|----42th round Final Test Accuracy : 51.65%
|----43th round Final Test Accuracy : 53.89%
|----44th round Final Test Accuracy : 53.96%
|----45th round Final Test Accuracy : 54.88%
|----46th round Final Test Accuracy : 53.72%
|----47th round Final Test Accuracy : 55.38%
|----48th round Final Test Accuracy : 55.47%
|----49th round Final Test Accuracy : 56.14%

Experimental details:
    Dataset     : cifar
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 10202.0930
