
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
 benign loss is  0.7023146580904722
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 83.05% 

Test Accuracy: 82.56% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.5670495629310608
 benign empirical indicaor res is  0.5670495629310608
 benign loss is  0.905798900872469
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 86.11% 

Test Accuracy: 85.20% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.15854573249816895
 benign empirical indicaor res is  0.15854573249816895
 benign loss is  0.48340181820094585
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.22% 

Test Accuracy: 85.99% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.07832986861467361
 benign empirical indicaor res is  0.07832986861467361
 benign loss is  0.6206543911248446
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.43% 

Test Accuracy: 86.05% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.00993407517671585
 benign empirical indicaor res is  0.00993407517671585
 benign loss is  0.5570255294442177
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.45% 

Test Accuracy: 86.14% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0013841538457199931
 benign empirical indicaor res is  0.0013841538457199931
 benign loss is  0.600329257780686
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.99% 

Test Accuracy: 86.59% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.047350987792015076
 benign empirical indicaor res is  0.047350987792015076
 benign loss is  0.6126020904630423
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.55% 

Test Accuracy: 86.46% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.009077238850295544
 benign empirical indicaor res is  0.009077238850295544
 benign loss is  0.516267079859972
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 87.99% 

Test Accuracy: 86.79% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.040024030953645706
 benign empirical indicaor res is  0.040024030953645706
 benign loss is  0.5247951447963715
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 88.62% 

Test Accuracy: 87.31% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.07900937646627426
 benign empirical indicaor res is  0.07900937646627426
 benign loss is  0.5712751243263483
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.56% 

Test Accuracy: 87.19% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.023661579936742783
 benign empirical indicaor res is  0.023661579936742783
 benign loss is  0.5204615411348641
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.12% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.9292, device='cuda:2')
diff2 is tensor(-0.9292, device='cuda:2')
diff1 is tensor(-0.5089, device='cuda:2')
diff2 is tensor(-0.5089, device='cuda:2')
diff1 is tensor(0.9649, device='cuda:2')
diff2 is tensor(0.9649, device='cuda:2')
diff1 is tensor(0.0815, device='cuda:2')
diff2 is tensor(0.0815, device='cuda:2')
diff1 is tensor(-0.0026, device='cuda:2')
diff2 is tensor(-0.0026, device='cuda:2')
diff1 is tensor(-2.7940e-08, device='cuda:2')
diff2 is tensor(-2.7940e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(102.9260, device='cuda:2')
compute similarity is  tensor(0.9031, device='cuda:2')
compute distance is  tensor(109.2500, device='cuda:2')
compute similarity is  tensor(0.8978, device='cuda:2')
compute distance is  tensor(108.5349, device='cuda:2')
compute similarity is  tensor(0.8966, device='cuda:2')
compute distance is  tensor(111.2508, device='cuda:2')
compute similarity is  tensor(0.8934, device='cuda:2')
compute distance is  tensor(107.1352, device='cuda:2')
compute similarity is  tensor(0.8999, device='cuda:2')
compute distance is  tensor(105.9307, device='cuda:2')
compute similarity is  tensor(0.8996, device='cuda:2')
compute distance is  tensor(107.4553, device='cuda:2')
compute similarity is  tensor(0.9000, device='cuda:2')
compute distance is  tensor(104.0196, device='cuda:2')
compute similarity is  tensor(0.9051, device='cuda:2')
compute distance is  tensor(103.2423, device='cuda:2')
compute similarity is  tensor(0.9073, device='cuda:2')
compute distance is  tensor(107.8672, device='cuda:2')
compute similarity is  tensor(0.9018, device='cuda:2')
compute distance is  tensor(106.9424, device='cuda:2')
compute similarity is  tensor(0.9021, device='cuda:2')
compute distance is  tensor(105.8978, device='cuda:2')
compute similarity is  tensor(0.9020, device='cuda:2')
calculated distance threshold is  tensor(111.2508, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.816233333489658
inner product is  tensor(6.2735, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8292333334896576
inner product is  tensor(6.2325, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8434500001563234
inner product is  tensor(6.2848, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5921666668230049
inner product is  tensor(5.1181, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5490000001563421
inner product is  tensor(5.7213, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.557216666823008
inner product is  tensor(5.6504, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.6642500001563328
inner product is  tensor(6.6772, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.6364000001563346
inner product is  tensor(6.3005, device='cuda:2')
====================
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3948, device='cuda:2')
test acc is  0.5490000001563421
test loss is 2.9520221516521756
test entropy is  0.22952835592252613
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22952835592252613
avg test loss is  2.9520221516521756
avg accuracy is  0.5490000001563421
compute_distance is  tensor(735.6187, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 87.26% 

Test Accuracy: 86.65% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-3.5235, device='cuda:2')
diff2 is tensor(-3.5235, device='cuda:2')
diff1 is tensor(-0.6587, device='cuda:2')
diff2 is tensor(-0.6587, device='cuda:2')
diff1 is tensor(-75.7414, device='cuda:2')
diff2 is tensor(-75.7414, device='cuda:2')
diff1 is tensor(-1.3100, device='cuda:2')
diff2 is tensor(-1.3100, device='cuda:2')
diff1 is tensor(-0.0055, device='cuda:2')
diff2 is tensor(-0.0055, device='cuda:2')
diff1 is tensor(7.0781e-08, device='cuda:2')
diff2 is tensor(7.0781e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(317.9491, device='cuda:2')
compute similarity is  tensor(0.6784, device='cuda:2')
compute distance is  tensor(318.8988, device='cuda:2')
compute similarity is  tensor(0.6751, device='cuda:2')
compute distance is  tensor(320.6967, device='cuda:2')
compute similarity is  tensor(0.6737, device='cuda:2')
compute distance is  tensor(322.3134, device='cuda:2')
compute similarity is  tensor(0.6693, device='cuda:2')
compute distance is  tensor(319.9663, device='cuda:2')
compute similarity is  tensor(0.6748, device='cuda:2')
compute distance is  tensor(321.2546, device='cuda:2')
compute similarity is  tensor(0.6705, device='cuda:2')
compute distance is  tensor(319.4224, device='cuda:2')
compute similarity is  tensor(0.6773, device='cuda:2')
compute distance is  tensor(319.4850, device='cuda:2')
compute similarity is  tensor(0.6744, device='cuda:2')
compute distance is  tensor(316.6336, device='cuda:2')
compute similarity is  tensor(0.6799, device='cuda:2')
compute distance is  tensor(321.4914, device='cuda:2')
compute similarity is  tensor(0.6721, device='cuda:2')
compute distance is  tensor(319.2785, device='cuda:2')
compute similarity is  tensor(0.6765, device='cuda:2')
compute distance is  tensor(320.1679, device='cuda:2')
compute similarity is  tensor(0.6761, device='cuda:2')
calculated distance threshold is  tensor(322.3134, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8287333334896575
inner product is  tensor(105.2719, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8069833334896583
inner product is  tensor(106.6156, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8331833334896572
inner product is  tensor(103.1720, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7270666668229957
inner product is  tensor(103.4978, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5551333334896749
inner product is  tensor(105.8248, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5617666668230075
inner product is  tensor(103.6451, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4962666668230087
inner product is  tensor(113.0801, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.2879500001563392
inner product is  tensor(93.9236, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3548500001563405
inner product is  tensor(105.2543, device='cuda:2')
====================
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1465.9076, device='cuda:2')
test similarity is  tensor(0.2698, device='cuda:2')
test acc is  0.2879500001563392
test loss is 15.95009322867973
test entropy is  0.09043702673413224
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09043702673413224
avg test loss is  15.95009322867973
avg accuracy is  0.2879500001563392
compute_distance is  tensor(1465.9076, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 47.61% 

Test Accuracy: 46.74% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-78.4809, device='cuda:2')
diff2 is tensor(-78.4809, device='cuda:2')
diff1 is tensor(-5.6678, device='cuda:2')
diff2 is tensor(-5.6678, device='cuda:2')
diff1 is tensor(-449.7643, device='cuda:2')
diff2 is tensor(-449.7643, device='cuda:2')
diff1 is tensor(-4.7754, device='cuda:2')
diff2 is tensor(-4.7754, device='cuda:2')
diff1 is tensor(-0.1043, device='cuda:2')
diff2 is tensor(-0.1043, device='cuda:2')
diff1 is tensor(-4.4703e-08, device='cuda:2')
diff2 is tensor(-4.4703e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1039.9061, device='cuda:2')
compute similarity is  tensor(0.2840, device='cuda:2')
compute distance is  tensor(1041.5415, device='cuda:2')
compute similarity is  tensor(0.2796, device='cuda:2')
compute distance is  tensor(1040.3954, device='cuda:2')
compute similarity is  tensor(0.2826, device='cuda:2')
compute distance is  tensor(1042.7137, device='cuda:2')
compute similarity is  tensor(0.2781, device='cuda:2')
compute distance is  tensor(1040.8899, device='cuda:2')
compute similarity is  tensor(0.2800, device='cuda:2')
compute distance is  tensor(1043.7311, device='cuda:2')
compute similarity is  tensor(0.2757, device='cuda:2')
compute distance is  tensor(1041.1313, device='cuda:2')
compute similarity is  tensor(0.2831, device='cuda:2')
compute distance is  tensor(1040.1938, device='cuda:2')
compute similarity is  tensor(0.2770, device='cuda:2')
compute distance is  tensor(1037.6808, device='cuda:2')
compute similarity is  tensor(0.2859, device='cuda:2')
compute distance is  tensor(1043.6931, device='cuda:2')
compute similarity is  tensor(0.2791, device='cuda:2')
compute distance is  tensor(1042.3441, device='cuda:2')
compute similarity is  tensor(0.2779, device='cuda:2')
compute distance is  tensor(1040.1606, device='cuda:2')
compute similarity is  tensor(0.2822, device='cuda:2')
calculated distance threshold is  tensor(1043.7311, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.43000000015634143
inner product is  tensor(1200.3246, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.44863333348967493
inner product is  tensor(1198.0654, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.4424833334896749
inner product is  tensor(1209.6281, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.4641833334896751
inner product is  tensor(1205.5643, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.48593333348967527
inner product is  tensor(1191.9321, device='cuda:2')
====================
________________________________
test distance is  tensor(369.4971, device='cuda:2')
test similarity is  tensor(0.9447, device='cuda:2')
test acc is  0.43000000015634143
test loss is 6.619186099404211
test entropy is  0.17595684669737113
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 79.26% 

Test Accuracy: 79.26% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(56.1511, device='cuda:2')
diff2 is tensor(56.1511, device='cuda:2')
diff1 is tensor(2.5536, device='cuda:2')
diff2 is tensor(2.5536, device='cuda:2')
diff1 is tensor(304.5003, device='cuda:2')
diff2 is tensor(304.5003, device='cuda:2')
diff1 is tensor(0.9797, device='cuda:2')
diff2 is tensor(0.9797, device='cuda:2')
diff1 is tensor(0.1192, device='cuda:2')
diff2 is tensor(0.1192, device='cuda:2')
diff1 is tensor(8.9407e-08, device='cuda:2')
diff2 is tensor(8.9407e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(809.5709, device='cuda:2')
compute similarity is  tensor(0.3558, device='cuda:2')
compute distance is  tensor(809.7762, device='cuda:2')
compute similarity is  tensor(0.3566, device='cuda:2')
compute distance is  tensor(808.6493, device='cuda:2')
compute similarity is  tensor(0.3567, device='cuda:2')
compute distance is  tensor(810.3215, device='cuda:2')
compute similarity is  tensor(0.3549, device='cuda:2')
compute distance is  tensor(808.5051, device='cuda:2')
compute similarity is  tensor(0.3546, device='cuda:2')
compute distance is  tensor(812.1501, device='cuda:2')
compute similarity is  tensor(0.3552, device='cuda:2')
compute distance is  tensor(808.4552, device='cuda:2')
compute similarity is  tensor(0.3589, device='cuda:2')
compute distance is  tensor(812.0465, device='cuda:2')
compute similarity is  tensor(0.3550, device='cuda:2')
compute distance is  tensor(808.3619, device='cuda:2')
compute similarity is  tensor(0.3600, device='cuda:2')
compute distance is  tensor(811.6517, device='cuda:2')
compute similarity is  tensor(0.3530, device='cuda:2')
compute distance is  tensor(811.3129, device='cuda:2')
compute similarity is  tensor(0.3542, device='cuda:2')
compute distance is  tensor(810.5277, device='cuda:2')
compute similarity is  tensor(0.3568, device='cuda:2')
calculated distance threshold is  tensor(812.1501, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.779316666822993
inner product is  tensor(278.0114, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7899333334896591
inner product is  tensor(276.3706, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7784500001563263
inner product is  tensor(275.6431, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5700833334896734
inner product is  tensor(273.9640, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.561250000156341
inner product is  tensor(277.0800, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6853166668229982
inner product is  tensor(274.6584, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.5498833334896752
inner product is  tensor(273.6369, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6586500001563331
inner product is  tensor(276.1481, device='cuda:2')
====================
________________________________
test distance is  tensor(732.8439, device='cuda:2')
test similarity is  tensor(0.7550, device='cuda:2')
test acc is  0.5498833334896752
test loss is 2.494730008817685
test entropy is  0.24651845228443267
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 81.87% 

Test Accuracy: 80.90% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(6.5789, device='cuda:2')
diff2 is tensor(6.5789, device='cuda:2')
diff1 is tensor(1.3843, device='cuda:2')
diff2 is tensor(1.3843, device='cuda:2')
diff1 is tensor(36.6185, device='cuda:2')
diff2 is tensor(36.6185, device='cuda:2')
diff1 is tensor(0.2585, device='cuda:2')
diff2 is tensor(0.2585, device='cuda:2')
diff1 is tensor(-0.0432, device='cuda:2')
diff2 is tensor(-0.0432, device='cuda:2')
diff1 is tensor(-6.2771e-07, device='cuda:2')
diff2 is tensor(-6.2771e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(726.3332, device='cuda:2')
compute similarity is  tensor(0.3938, device='cuda:2')
compute distance is  tensor(728.4561, device='cuda:2')
compute similarity is  tensor(0.3912, device='cuda:2')
compute distance is  tensor(726.4415, device='cuda:2')
compute similarity is  tensor(0.3919, device='cuda:2')
compute distance is  tensor(725.8445, device='cuda:2')
compute similarity is  tensor(0.3939, device='cuda:2')
compute distance is  tensor(726.5651, device='cuda:2')
compute similarity is  tensor(0.3931, device='cuda:2')
compute distance is  tensor(728.0724, device='cuda:2')
compute similarity is  tensor(0.3927, device='cuda:2')
compute distance is  tensor(725.0024, device='cuda:2')
compute similarity is  tensor(0.3990, device='cuda:2')
compute distance is  tensor(726.8320, device='cuda:2')
compute similarity is  tensor(0.3938, device='cuda:2')
compute distance is  tensor(723.3959, device='cuda:2')
compute similarity is  tensor(0.3991, device='cuda:2')
compute distance is  tensor(727.6749, device='cuda:2')
compute similarity is  tensor(0.3949, device='cuda:2')
compute distance is  tensor(728.6379, device='cuda:2')
compute similarity is  tensor(0.3917, device='cuda:2')
compute distance is  tensor(725.7853, device='cuda:2')
compute similarity is  tensor(0.3967, device='cuda:2')
calculated distance threshold is  tensor(728.6379, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7958666668229922
inner product is  tensor(230.3347, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7585833334896607
inner product is  tensor(225.4225, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8014500001563253
inner product is  tensor(233.3999, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6243333334896689
inner product is  tensor(234.2848, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.70990000015633
inner product is  tensor(234.4473, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.6560833334896667
inner product is  tensor(228.2072, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.2199000001563372
inner product is  tensor(228.0246, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.3503500001563404
inner product is  tensor(224.6207, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.40050000015634113
inner product is  tensor(223.4415, device='cuda:2')
====================
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.4747, device='cuda:2')
test similarity is  tensor(0.4687, device='cuda:2')
test acc is  0.2199000001563372
test loss is 11.723100579877906
test entropy is  0.08088899746751671
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08088899746751671
avg test loss is  11.723100579877906
avg accuracy is  0.2199000001563372
compute_distance is  tensor(1471.4747, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 78.30% 

Test Accuracy: 77.45% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-6.5718, device='cuda:2')
diff2 is tensor(-6.5718, device='cuda:2')
diff1 is tensor(-2.8921, device='cuda:2')
diff2 is tensor(-2.8921, device='cuda:2')
diff1 is tensor(-124.6387, device='cuda:2')
diff2 is tensor(-124.6387, device='cuda:2')
diff1 is tensor(-3.4868, device='cuda:2')
diff2 is tensor(-3.4868, device='cuda:2')
diff1 is tensor(0.0092, device='cuda:2')
diff2 is tensor(0.0092, device='cuda:2')
diff1 is tensor(5.9232e-07, device='cuda:2')
diff2 is tensor(5.9232e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(893.7062, device='cuda:2')
compute similarity is  tensor(0.3348, device='cuda:2')
compute distance is  tensor(895.4529, device='cuda:2')
compute similarity is  tensor(0.3301, device='cuda:2')
compute distance is  tensor(894.6886, device='cuda:2')
compute similarity is  tensor(0.3295, device='cuda:2')
compute distance is  tensor(895.2981, device='cuda:2')
compute similarity is  tensor(0.3306, device='cuda:2')
compute distance is  tensor(896.5276, device='cuda:2')
compute similarity is  tensor(0.3300, device='cuda:2')
compute distance is  tensor(895.5576, device='cuda:2')
compute similarity is  tensor(0.3302, device='cuda:2')
compute distance is  tensor(893.6530, device='cuda:2')
compute similarity is  tensor(0.3346, device='cuda:2')
compute distance is  tensor(893.7119, device='cuda:2')
compute similarity is  tensor(0.3326, device='cuda:2')
compute distance is  tensor(894.6053, device='cuda:2')
compute similarity is  tensor(0.3318, device='cuda:2')
compute distance is  tensor(896.6212, device='cuda:2')
compute similarity is  tensor(0.3312, device='cuda:2')
compute distance is  tensor(896.0865, device='cuda:2')
compute similarity is  tensor(0.3288, device='cuda:2')
compute distance is  tensor(896.2352, device='cuda:2')
compute similarity is  tensor(0.3300, device='cuda:2')
calculated distance threshold is  tensor(896.6212, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7178333334896627
inner product is  tensor(558.8223, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6577166668229998
inner product is  tensor(560.7325, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.6711000001563324
inner product is  tensor(557.9448, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5547833334896749
inner product is  tensor(558.6454, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5692166668230069
inner product is  tensor(554.0845, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.29780000015633945
inner product is  tensor(560.1409, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(734.3269, device='cuda:2')
test similarity is  tensor(0.7828, device='cuda:2')
test acc is  0.29780000015633945
test loss is 5.941967809632389
test entropy is  0.1721978580900855
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 75.69% 

Test Accuracy: 75.03% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-8.7624, device='cuda:2')
diff2 is tensor(-8.7624, device='cuda:2')
diff1 is tensor(0.2975, device='cuda:2')
diff2 is tensor(0.2975, device='cuda:2')
diff1 is tensor(12.8949, device='cuda:2')
diff2 is tensor(12.8949, device='cuda:2')
diff1 is tensor(-1.9795, device='cuda:2')
diff2 is tensor(-1.9795, device='cuda:2')
diff1 is tensor(0.0224, device='cuda:2')
diff2 is tensor(0.0224, device='cuda:2')
diff1 is tensor(-9.6858e-08, device='cuda:2')
diff2 is tensor(-9.6858e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1021.4427, device='cuda:2')
compute similarity is  tensor(0.3011, device='cuda:2')
compute distance is  tensor(1024.3481, device='cuda:2')
compute similarity is  tensor(0.2968, device='cuda:2')
compute distance is  tensor(1023.7287, device='cuda:2')
compute similarity is  tensor(0.2957, device='cuda:2')
compute distance is  tensor(1022.4535, device='cuda:2')
compute similarity is  tensor(0.2969, device='cuda:2')
compute distance is  tensor(1023.6829, device='cuda:2')
compute similarity is  tensor(0.2947, device='cuda:2')
compute distance is  tensor(1023.4838, device='cuda:2')
compute similarity is  tensor(0.2982, device='cuda:2')
compute distance is  tensor(1020.3151, device='cuda:2')
compute similarity is  tensor(0.3007, device='cuda:2')
compute distance is  tensor(1025.0312, device='cuda:2')
compute similarity is  tensor(0.2950, device='cuda:2')
compute distance is  tensor(1022.7736, device='cuda:2')
compute similarity is  tensor(0.2981, device='cuda:2')
compute distance is  tensor(1024.6252, device='cuda:2')
compute similarity is  tensor(0.2924, device='cuda:2')
compute distance is  tensor(1026.3574, device='cuda:2')
compute similarity is  tensor(0.2927, device='cuda:2')
compute distance is  tensor(1021.4355, device='cuda:2')
compute similarity is  tensor(0.2990, device='cuda:2')
calculated distance threshold is  tensor(1026.3574, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6879333334896646
inner product is  tensor(344.0598, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7370000001563284
inner product is  tensor(342.2786, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.778666666822993
inner product is  tensor(345.4036, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7003666668229973
inner product is  tensor(344.2561, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.43913333348967487
inner product is  tensor(346.2782, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5677666668230071
inner product is  tensor(349.0747, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.18818333348966912
inner product is  tensor(346.8732, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.22726666682300417
inner product is  tensor(340.2420, device='cuda:2')
====================
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.6946, device='cuda:2')
test similarity is  tensor(0.5748, device='cuda:2')
test acc is  0.18818333348966912
test loss is 12.739170181217478
test entropy is  0.07249995298894134
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07249995298894134
avg test loss is  12.739170181217478
avg accuracy is  0.18818333348966912
compute_distance is  tensor(1468.6946, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 79.14% 

Test Accuracy: 78.68% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(7.7444, device='cuda:2')
diff2 is tensor(7.7444, device='cuda:2')
diff1 is tensor(-0.2057, device='cuda:2')
diff2 is tensor(-0.2057, device='cuda:2')
diff1 is tensor(-26.0142, device='cuda:2')
diff2 is tensor(-26.0142, device='cuda:2')
diff1 is tensor(2.1200, device='cuda:2')
diff2 is tensor(2.1200, device='cuda:2')
diff1 is tensor(-0.0339, device='cuda:2')
diff2 is tensor(-0.0339, device='cuda:2')
diff1 is tensor(-2.7195e-07, device='cuda:2')
diff2 is tensor(-2.7195e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1051.7736, device='cuda:2')
compute similarity is  tensor(0.2936, device='cuda:2')
compute distance is  tensor(1051.5956, device='cuda:2')
compute similarity is  tensor(0.2921, device='cuda:2')
compute distance is  tensor(1053.0846, device='cuda:2')
compute similarity is  tensor(0.2916, device='cuda:2')
compute distance is  tensor(1052.6984, device='cuda:2')
compute similarity is  tensor(0.2897, device='cuda:2')
compute distance is  tensor(1055.1089, device='cuda:2')
compute similarity is  tensor(0.2873, device='cuda:2')
compute distance is  tensor(1052.9779, device='cuda:2')
compute similarity is  tensor(0.2917, device='cuda:2')
compute distance is  tensor(1051.8102, device='cuda:2')
compute similarity is  tensor(0.2926, device='cuda:2')
compute distance is  tensor(1052.9102, device='cuda:2')
compute similarity is  tensor(0.2929, device='cuda:2')
compute distance is  tensor(1053.4730, device='cuda:2')
compute similarity is  tensor(0.2921, device='cuda:2')
compute distance is  tensor(1053.8589, device='cuda:2')
compute similarity is  tensor(0.2876, device='cuda:2')
compute distance is  tensor(1053.1647, device='cuda:2')
compute similarity is  tensor(0.2882, device='cuda:2')
compute distance is  tensor(1052.0089, device='cuda:2')
compute similarity is  tensor(0.2925, device='cuda:2')
calculated distance threshold is  tensor(1055.1089, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7512166668229945
inner product is  tensor(575.7896, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7613166668229939
inner product is  tensor(578.6551, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7746666668229932
inner product is  tensor(579.2413, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6277500001563353
inner product is  tensor(576.8091, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6066000001563371
inner product is  tensor(566.7695, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5703500001563401
inner product is  tensor(581.4297, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.6127833334896698
inner product is  tensor(572.0546, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.540066666823009
inner product is  tensor(570.4990, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(740.2542, device='cuda:2')
test similarity is  tensor(0.8214, device='cuda:2')
test acc is  0.540066666823009
test loss is 3.026653665596488
test entropy is  0.24608803850247155
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 78.82% 

Test Accuracy: 77.84% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-6.5345, device='cuda:2')
diff2 is tensor(-6.5345, device='cuda:2')
diff1 is tensor(-0.3254, device='cuda:2')
diff2 is tensor(-0.3254, device='cuda:2')
diff1 is tensor(-20.9158, device='cuda:2')
diff2 is tensor(-20.9158, device='cuda:2')
diff1 is tensor(0.0782, device='cuda:2')
diff2 is tensor(0.0782, device='cuda:2')
diff1 is tensor(0.0059, device='cuda:2')
diff2 is tensor(0.0059, device='cuda:2')
diff1 is tensor(-7.9721e-07, device='cuda:2')
diff2 is tensor(-7.9721e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1138.1570, device='cuda:2')
compute similarity is  tensor(0.3322, device='cuda:2')
compute distance is  tensor(1139.1428, device='cuda:2')
compute similarity is  tensor(0.3327, device='cuda:2')
compute distance is  tensor(1138.4229, device='cuda:2')
compute similarity is  tensor(0.3340, device='cuda:2')
compute distance is  tensor(1139.3313, device='cuda:2')
compute similarity is  tensor(0.3315, device='cuda:2')
compute distance is  tensor(1137.7538, device='cuda:2')
compute similarity is  tensor(0.3314, device='cuda:2')
compute distance is  tensor(1137.1926, device='cuda:2')
compute similarity is  tensor(0.3330, device='cuda:2')
compute distance is  tensor(1138.5427, device='cuda:2')
compute similarity is  tensor(0.3331, device='cuda:2')
compute distance is  tensor(1136.5278, device='cuda:2')
compute similarity is  tensor(0.3342, device='cuda:2')
compute distance is  tensor(1137.1024, device='cuda:2')
compute similarity is  tensor(0.3331, device='cuda:2')
compute distance is  tensor(1137.7751, device='cuda:2')
compute similarity is  tensor(0.3329, device='cuda:2')
compute distance is  tensor(1138.1282, device='cuda:2')
compute similarity is  tensor(0.3342, device='cuda:2')
compute distance is  tensor(1140.8245, device='cuda:2')
compute similarity is  tensor(0.3321, device='cuda:2')
calculated distance threshold is  tensor(1140.8245, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7635000001563271
inner product is  tensor(330.0718, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7755833334896598
inner product is  tensor(327.4125, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7517833334896611
inner product is  tensor(328.7830, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7266333334896623
inner product is  tensor(327.4856, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7577833334896606
inner product is  tensor(332.0124, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.6885833334896647
inner product is  tensor(325.8141, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.26235000015633864
inner product is  tensor(320.4954, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.533366666823009
inner product is  tensor(328.7887, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.26126666682300526
inner product is  tensor(329.7493, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.30753333348967293
inner product is  tensor(337.8613, device='cuda:2')
====================
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1460.1050, device='cuda:2')
test similarity is  tensor(0.6297, device='cuda:2')
test acc is  0.26126666682300526
test loss is 8.315535139681687
test entropy is  0.13048101484235416
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.13048101484235416
avg test loss is  8.315535139681687
avg accuracy is  0.26126666682300526
compute_distance is  tensor(1460.1050, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 81.45% 

Test Accuracy: 80.44% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.0408, device='cuda:2')
diff2 is tensor(-1.0408, device='cuda:2')
diff1 is tensor(0.4929, device='cuda:2')
diff2 is tensor(0.4929, device='cuda:2')
diff1 is tensor(18.8426, device='cuda:2')
diff2 is tensor(18.8426, device='cuda:2')
diff1 is tensor(-1.9937, device='cuda:2')
diff2 is tensor(-1.9937, device='cuda:2')
diff1 is tensor(-0.0230, device='cuda:2')
diff2 is tensor(-0.0230, device='cuda:2')
diff1 is tensor(1.1921e-07, device='cuda:2')
diff2 is tensor(1.1921e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1277.5195, device='cuda:2')
compute similarity is  tensor(0.4572, device='cuda:2')
compute distance is  tensor(1250.6661, device='cuda:2')
compute similarity is  tensor(0.4641, device='cuda:2')
compute distance is  tensor(1264.8961, device='cuda:2')
compute similarity is  tensor(0.4561, device='cuda:2')
compute distance is  tensor(1254.4403, device='cuda:2')
compute similarity is  tensor(0.4598, device='cuda:2')
compute distance is  tensor(1251.5001, device='cuda:2')
compute similarity is  tensor(0.4631, device='cuda:2')
compute distance is  tensor(1257.5034, device='cuda:2')
compute similarity is  tensor(0.4626, device='cuda:2')
compute distance is  tensor(1247.3518, device='cuda:2')
compute similarity is  tensor(0.4640, device='cuda:2')
compute distance is  tensor(1276.9885, device='cuda:2')
compute similarity is  tensor(0.4571, device='cuda:2')
compute distance is  tensor(1270.0145, device='cuda:2')
compute similarity is  tensor(0.4575, device='cuda:2')
compute distance is  tensor(1252.8734, device='cuda:2')
compute similarity is  tensor(0.4638, device='cuda:2')
compute distance is  tensor(1237.9573, device='cuda:2')
compute similarity is  tensor(0.4662, device='cuda:2')
compute distance is  tensor(1270.4276, device='cuda:2')
compute similarity is  tensor(0.4581, device='cuda:2')
calculated distance threshold is  tensor(1277.5195, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7901666668229925
inner product is  tensor(588.1031, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8189833334896579
inner product is  tensor(588.4723, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8061500001563252
inner product is  tensor(591.6043, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6803333334896651
inner product is  tensor(595.5605, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7952166668229923
inner product is  tensor(577.0619, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.5950666668230046
inner product is  tensor(578.8661, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6066166668230037
inner product is  tensor(596.5675, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.5584500001563413
inner product is  tensor(600.4716, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.5025833334896754
inner product is  tensor(592.1059, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1466.2263, device='cuda:2')
test similarity is  tensor(0.6360, device='cuda:2')
test acc is  0.5025833334896754
test loss is 4.241895532048842
test entropy is  0.253971176980528
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.253971176980528
avg test loss is  4.241895532048842
avg accuracy is  0.5025833334896754
compute_distance is  tensor(1466.2263, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 80.62% 

Test Accuracy: 80.27% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(3.1483, device='cuda:2')
diff2 is tensor(3.1483, device='cuda:2')
diff1 is tensor(-0.0658, device='cuda:2')
diff2 is tensor(-0.0658, device='cuda:2')
diff1 is tensor(-18.9197, device='cuda:2')
diff2 is tensor(-18.9197, device='cuda:2')
diff1 is tensor(-0.8229, device='cuda:2')
diff2 is tensor(-0.8229, device='cuda:2')
diff1 is tensor(0.0046, device='cuda:2')
diff2 is tensor(0.0046, device='cuda:2')
diff1 is tensor(-2.9802e-08, device='cuda:2')
diff2 is tensor(-2.9802e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1095.3623, device='cuda:2')
compute similarity is  tensor(0.5106, device='cuda:2')
compute distance is  tensor(1101.1447, device='cuda:2')
compute similarity is  tensor(0.5094, device='cuda:2')
compute distance is  tensor(1097.7949, device='cuda:2')
compute similarity is  tensor(0.5101, device='cuda:2')
compute distance is  tensor(1100.8351, device='cuda:2')
compute similarity is  tensor(0.5093, device='cuda:2')
compute distance is  tensor(1097.6493, device='cuda:2')
compute similarity is  tensor(0.5090, device='cuda:2')
compute distance is  tensor(1099.8152, device='cuda:2')
compute similarity is  tensor(0.5093, device='cuda:2')
compute distance is  tensor(1098.9685, device='cuda:2')
compute similarity is  tensor(0.5100, device='cuda:2')
compute distance is  tensor(1097.4165, device='cuda:2')
compute similarity is  tensor(0.5106, device='cuda:2')
compute distance is  tensor(1098.9399, device='cuda:2')
compute similarity is  tensor(0.5094, device='cuda:2')
compute distance is  tensor(1097.4318, device='cuda:2')
compute similarity is  tensor(0.5107, device='cuda:2')
compute distance is  tensor(1095.8291, device='cuda:2')
compute similarity is  tensor(0.5105, device='cuda:2')
compute distance is  tensor(1100.1417, device='cuda:2')
compute similarity is  tensor(0.5092, device='cuda:2')
calculated distance threshold is  tensor(1101.1447, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7944166668229923
inner product is  tensor(198.9269, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7989666668229921
inner product is  tensor(198.9338, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7934666668229923
inner product is  tensor(198.0831, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7710833334896602
inner product is  tensor(196.0921, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7717500001563268
inner product is  tensor(198.9437, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7082333334896634
inner product is  tensor(191.6427, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5026500001563421
inner product is  tensor(196.5545, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6835166668229983
inner product is  tensor(185.6425, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.4189333334896746
inner product is  tensor(198.2914, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5217833334896755
inner product is  tensor(208.5457, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.48490000015634194
inner product is  tensor(195.6823, device='cuda:2')
====================
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.3485, device='cuda:2')
test similarity is  tensor(0.6376, device='cuda:2')
test acc is  0.4189333334896746
test loss is 4.730546541813848
test entropy is  0.17547689203514474
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17547689203514474
avg test loss is  4.730546541813848
avg accuracy is  0.4189333334896746
compute_distance is  tensor(1474.3485, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 82.26% 

Test Accuracy: 81.33% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.7557, device='cuda:2')
diff2 is tensor(-1.7557, device='cuda:2')
diff1 is tensor(-0.1240, device='cuda:2')
diff2 is tensor(-0.1240, device='cuda:2')
diff1 is tensor(-17.0628, device='cuda:2')
diff2 is tensor(-17.0628, device='cuda:2')
diff1 is tensor(0.3629, device='cuda:2')
diff2 is tensor(0.3629, device='cuda:2')
diff1 is tensor(-0.0052, device='cuda:2')
diff2 is tensor(-0.0052, device='cuda:2')
diff1 is tensor(-1.9744e-07, device='cuda:2')
diff2 is tensor(-1.9744e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1123.7058, device='cuda:2')
compute similarity is  tensor(0.5166, device='cuda:2')
compute distance is  tensor(1122.1993, device='cuda:2')
compute similarity is  tensor(0.5168, device='cuda:2')
compute distance is  tensor(1124.5103, device='cuda:2')
compute similarity is  tensor(0.5170, device='cuda:2')
compute distance is  tensor(1121.9181, device='cuda:2')
compute similarity is  tensor(0.5169, device='cuda:2')
compute distance is  tensor(1121.2773, device='cuda:2')
compute similarity is  tensor(0.5173, device='cuda:2')
compute distance is  tensor(1122.8314, device='cuda:2')
compute similarity is  tensor(0.5177, device='cuda:2')
compute distance is  tensor(1119.9869, device='cuda:2')
compute similarity is  tensor(0.5177, device='cuda:2')
compute distance is  tensor(1126.3595, device='cuda:2')
compute similarity is  tensor(0.5163, device='cuda:2')
compute distance is  tensor(1128.3282, device='cuda:2')
compute similarity is  tensor(0.5151, device='cuda:2')
compute distance is  tensor(1126.7216, device='cuda:2')
compute similarity is  tensor(0.5149, device='cuda:2')
compute distance is  tensor(1122.5946, device='cuda:2')
compute similarity is  tensor(0.5170, device='cuda:2')
compute distance is  tensor(1123.4233, device='cuda:2')
compute similarity is  tensor(0.5165, device='cuda:2')
calculated distance threshold is  tensor(1128.3282, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8124666668229915
inner product is  tensor(220.4574, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.814833333489658
inner product is  tensor(223.4294, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8211166668229912
inner product is  tensor(222.6019, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7839166668229929
inner product is  tensor(220.5179, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.6996000001563306
inner product is  tensor(222.1197, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.800666666822992
inner product is  tensor(218.0078, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6188833334896695
inner product is  tensor(215.0934, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6745333334896654
inner product is  tensor(222.3124, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.4283166668230081
inner product is  tensor(232.5631, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5563000001563414
inner product is  tensor(222.3600, device='cuda:2')
====================
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1471.7271, device='cuda:2')
test similarity is  tensor(0.6539, device='cuda:2')
test acc is  0.4283166668230081
test loss is 4.759694206180857
test entropy is  0.1812349582658902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1812349582658902
avg test loss is  4.759694206180857
avg accuracy is  0.4283166668230081
compute_distance is  tensor(1471.7271, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 79.97% 

Test Accuracy: 79.52% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-4.2532, device='cuda:2')
diff2 is tensor(-4.2532, device='cuda:2')
diff1 is tensor(-1.1016, device='cuda:2')
diff2 is tensor(-1.1016, device='cuda:2')
diff1 is tensor(-54.9942, device='cuda:2')
diff2 is tensor(-54.9942, device='cuda:2')
diff1 is tensor(-0.9941, device='cuda:2')
diff2 is tensor(-0.9941, device='cuda:2')
diff1 is tensor(0.0283, device='cuda:2')
diff2 is tensor(0.0283, device='cuda:2')
diff1 is tensor(1.9744e-07, device='cuda:2')
diff2 is tensor(1.9744e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1162.6058, device='cuda:2')
compute similarity is  tensor(0.5725, device='cuda:2')
compute distance is  tensor(1158.0482, device='cuda:2')
compute similarity is  tensor(0.5757, device='cuda:2')
compute distance is  tensor(1154.9751, device='cuda:2')
compute similarity is  tensor(0.5771, device='cuda:2')
compute distance is  tensor(1156.5328, device='cuda:2')
compute similarity is  tensor(0.5772, device='cuda:2')
compute distance is  tensor(1155.8911, device='cuda:2')
compute similarity is  tensor(0.5765, device='cuda:2')
compute distance is  tensor(1152.1177, device='cuda:2')
compute similarity is  tensor(0.5777, device='cuda:2')
compute distance is  tensor(1152.8109, device='cuda:2')
compute similarity is  tensor(0.5767, device='cuda:2')
compute distance is  tensor(1154.6838, device='cuda:2')
compute similarity is  tensor(0.5767, device='cuda:2')
compute distance is  tensor(1157.5594, device='cuda:2')
compute similarity is  tensor(0.5750, device='cuda:2')
compute distance is  tensor(1154.9701, device='cuda:2')
compute similarity is  tensor(0.5765, device='cuda:2')
compute distance is  tensor(1152.6827, device='cuda:2')
compute similarity is  tensor(0.5774, device='cuda:2')
compute distance is  tensor(1151.9403, device='cuda:2')
compute similarity is  tensor(0.5773, device='cuda:2')
calculated distance threshold is  tensor(1162.6058, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7923833334896591
inner product is  tensor(318.7788, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7954333334896588
inner product is  tensor(320.7347, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7849333334896594
inner product is  tensor(317.5331, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7848833334896593
inner product is  tensor(318.4078, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7525833334896609
inner product is  tensor(323.3188, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7868166668229927
inner product is  tensor(317.4535, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.500150000156342
inner product is  tensor(318.1994, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5150166668230088
inner product is  tensor(316.9477, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.3167166668230065
inner product is  tensor(317.7743, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.4550500001563417
inner product is  tensor(303.7839, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.5911500001563382
inner product is  tensor(308.2656, device='cuda:2')
====================
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1476.0837, device='cuda:2')
test similarity is  tensor(0.6766, device='cuda:2')
test acc is  0.3167166668230065
test loss is 7.529312201908657
test entropy is  0.16353895924270534
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16353895924270534
avg test loss is  7.529312201908657
avg accuracy is  0.3167166668230065
compute_distance is  tensor(1476.0837, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 81.97% 

Test Accuracy: 80.99% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.6608, device='cuda:2')
diff2 is tensor(0.6608, device='cuda:2')
diff1 is tensor(0.1468, device='cuda:2')
diff2 is tensor(0.1468, device='cuda:2')
diff1 is tensor(9.2540, device='cuda:2')
diff2 is tensor(9.2540, device='cuda:2')
diff1 is tensor(-0.3771, device='cuda:2')
diff2 is tensor(-0.3771, device='cuda:2')
diff1 is tensor(-0.0413, device='cuda:2')
diff2 is tensor(-0.0413, device='cuda:2')
diff1 is tensor(-2.0117e-07, device='cuda:2')
diff2 is tensor(-2.0117e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1079.7773, device='cuda:2')
compute similarity is  tensor(0.6240, device='cuda:2')
compute distance is  tensor(1075.7251, device='cuda:2')
compute similarity is  tensor(0.6238, device='cuda:2')
compute distance is  tensor(1080.8700, device='cuda:2')
compute similarity is  tensor(0.6236, device='cuda:2')
compute distance is  tensor(1079.2200, device='cuda:2')
compute similarity is  tensor(0.6238, device='cuda:2')
compute distance is  tensor(1081.1239, device='cuda:2')
compute similarity is  tensor(0.6233, device='cuda:2')
compute distance is  tensor(1078.1196, device='cuda:2')
compute similarity is  tensor(0.6235, device='cuda:2')
compute distance is  tensor(1077.4819, device='cuda:2')
compute similarity is  tensor(0.6237, device='cuda:2')
compute distance is  tensor(1079.1407, device='cuda:2')
compute similarity is  tensor(0.6235, device='cuda:2')
compute distance is  tensor(1080.0168, device='cuda:2')
compute similarity is  tensor(0.6232, device='cuda:2')
compute distance is  tensor(1076.0339, device='cuda:2')
compute similarity is  tensor(0.6236, device='cuda:2')
compute distance is  tensor(1080.6594, device='cuda:2')
compute similarity is  tensor(0.6230, device='cuda:2')
compute distance is  tensor(1077.4817, device='cuda:2')
compute similarity is  tensor(0.6232, device='cuda:2')
calculated distance threshold is  tensor(1081.1239, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8212333334896578
inner product is  tensor(135.3030, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8242833334896577
inner product is  tensor(134.3496, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8143666668229914
inner product is  tensor(132.2482, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7919833334896591
inner product is  tensor(133.0175, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7420166668229948
inner product is  tensor(135.8838, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7721333334896601
inner product is  tensor(133.7560, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6861833334896648
inner product is  tensor(124.6066, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5183833334896756
inner product is  tensor(128.4834, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6019833334896707
inner product is  tensor(141.6223, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5423833334896757
inner product is  tensor(134.2004, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.2855333334896725
inner product is  tensor(131.1540, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.8578, device='cuda:2')
test similarity is  tensor(0.6631, device='cuda:2')
test acc is  0.2855333334896725
test loss is 10.22449595384252
test entropy is  0.1097422288393161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1097422288393161
avg test loss is  10.22449595384252
avg accuracy is  0.2855333334896725
compute_distance is  tensor(1474.8578, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 79.14% 

Test Accuracy: 79.00% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.1781, device='cuda:2')
diff2 is tensor(0.1781, device='cuda:2')
diff1 is tensor(-0.6058, device='cuda:2')
diff2 is tensor(-0.6058, device='cuda:2')
diff1 is tensor(-32.3124, device='cuda:2')
diff2 is tensor(-32.3124, device='cuda:2')
diff1 is tensor(-0.2303, device='cuda:2')
diff2 is tensor(-0.2303, device='cuda:2')
diff1 is tensor(0.0304, device='cuda:2')
diff2 is tensor(0.0304, device='cuda:2')
diff1 is tensor(-1.0431e-07, device='cuda:2')
diff2 is tensor(-1.0431e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1003.1792, device='cuda:2')
compute similarity is  tensor(0.7020, device='cuda:2')
compute distance is  tensor(1006.9948, device='cuda:2')
compute similarity is  tensor(0.7019, device='cuda:2')
compute distance is  tensor(1004.3314, device='cuda:2')
compute similarity is  tensor(0.7024, device='cuda:2')
compute distance is  tensor(1007.4652, device='cuda:2')
compute similarity is  tensor(0.7015, device='cuda:2')
compute distance is  tensor(1002.7095, device='cuda:2')
compute similarity is  tensor(0.7030, device='cuda:2')
compute distance is  tensor(998.0512, device='cuda:2')
compute similarity is  tensor(0.7036, device='cuda:2')
compute distance is  tensor(1002.1691, device='cuda:2')
compute similarity is  tensor(0.7026, device='cuda:2')
compute distance is  tensor(1000.6069, device='cuda:2')
compute similarity is  tensor(0.7034, device='cuda:2')
compute distance is  tensor(1004.4359, device='cuda:2')
compute similarity is  tensor(0.7029, device='cuda:2')
compute distance is  tensor(1001.3173, device='cuda:2')
compute similarity is  tensor(0.7037, device='cuda:2')
compute distance is  tensor(999.2779, device='cuda:2')
compute similarity is  tensor(0.7024, device='cuda:2')
compute distance is  tensor(1006.0588, device='cuda:2')
compute similarity is  tensor(0.7022, device='cuda:2')
calculated distance threshold is  tensor(1007.4652, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7303500001563288
inner product is  tensor(252.7421, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7667333334896603
inner product is  tensor(247.7266, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7606166668229939
inner product is  tensor(251.9405, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7484000001563278
inner product is  tensor(249.8335, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7207500001563294
inner product is  tensor(249.4944, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.727450000156329
inner product is  tensor(251.7193, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4531666668230083
inner product is  tensor(250.6662, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.651533333489667
inner product is  tensor(255.2371, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.45255000015634167
inner product is  tensor(260.0806, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5363000001563423
inner product is  tensor(258.6955, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.46968333348967517
inner product is  tensor(235.7077, device='cuda:2')
====================
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1464.1404, device='cuda:2')
test similarity is  tensor(0.6828, device='cuda:2')
test acc is  0.45255000015634167
test loss is 4.614951434165938
test entropy is  0.18470907668823372
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18470907668823372
avg test loss is  4.614951434165938
avg accuracy is  0.45255000015634167
compute_distance is  tensor(1464.1404, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 81.46% 

Test Accuracy: 80.42% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-5.4982, device='cuda:2')
diff2 is tensor(-5.4982, device='cuda:2')
diff1 is tensor(0.5962, device='cuda:2')
diff2 is tensor(0.5962, device='cuda:2')
diff1 is tensor(-15.3496, device='cuda:2')
diff2 is tensor(-15.3496, device='cuda:2')
diff1 is tensor(-1.5087, device='cuda:2')
diff2 is tensor(-1.5087, device='cuda:2')
diff1 is tensor(-0.0184, device='cuda:2')
diff2 is tensor(-0.0184, device='cuda:2')
diff1 is tensor(1.6391e-07, device='cuda:2')
diff2 is tensor(1.6391e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1057.7812, device='cuda:2')
compute similarity is  tensor(0.6968, device='cuda:2')
compute distance is  tensor(1061.1084, device='cuda:2')
compute similarity is  tensor(0.6967, device='cuda:2')
compute distance is  tensor(1056.3345, device='cuda:2')
compute similarity is  tensor(0.6974, device='cuda:2')
compute distance is  tensor(1057.9386, device='cuda:2')
compute similarity is  tensor(0.6972, device='cuda:2')
compute distance is  tensor(1056.9447, device='cuda:2')
compute similarity is  tensor(0.6983, device='cuda:2')
compute distance is  tensor(1054.2183, device='cuda:2')
compute similarity is  tensor(0.6978, device='cuda:2')
compute distance is  tensor(1059.1505, device='cuda:2')
compute similarity is  tensor(0.6969, device='cuda:2')
compute distance is  tensor(1058.6348, device='cuda:2')
compute similarity is  tensor(0.6974, device='cuda:2')
compute distance is  tensor(1056.0062, device='cuda:2')
compute similarity is  tensor(0.6972, device='cuda:2')
compute distance is  tensor(1056.5604, device='cuda:2')
compute similarity is  tensor(0.6978, device='cuda:2')
compute distance is  tensor(1056.2502, device='cuda:2')
compute similarity is  tensor(0.6974, device='cuda:2')
compute distance is  tensor(1062.5664, device='cuda:2')
compute similarity is  tensor(0.6967, device='cuda:2')
calculated distance threshold is  tensor(1062.5664, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7938166668229923
inner product is  tensor(211.5670, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8102333334896584
inner product is  tensor(214.9095, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7752500001563265
inner product is  tensor(215.5974, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7560833334896608
inner product is  tensor(212.4039, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7197166668229961
inner product is  tensor(214.9273, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7851833334896595
inner product is  tensor(213.9149, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5116166668230088
inner product is  tensor(212.7526, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.28963333348967263
inner product is  tensor(206.7893, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6214500001563358
inner product is  tensor(217.3964, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.7160166668229964
inner product is  tensor(217.6193, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.5801166668230058
inner product is  tensor(208.0087, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.25150000015633833
inner product is  tensor(214.0181, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1473.0261, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.25150000015633833
test loss is 8.519657707417698
test entropy is  0.11468927067781944
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11468927067781944
avg test loss is  8.519657707417698
avg accuracy is  0.25150000015633833
compute_distance is  tensor(1473.0261, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 81.48% 

Test Accuracy: 80.51% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.6725, device='cuda:2')
diff2 is tensor(1.6725, device='cuda:2')
diff1 is tensor(-0.3854, device='cuda:2')
diff2 is tensor(-0.3854, device='cuda:2')
diff1 is tensor(-7.6392, device='cuda:2')
diff2 is tensor(-7.6392, device='cuda:2')
diff1 is tensor(-0.8857, device='cuda:2')
diff2 is tensor(-0.8857, device='cuda:2')
diff1 is tensor(0.0204, device='cuda:2')
diff2 is tensor(0.0204, device='cuda:2')
diff1 is tensor(2.6077e-08, device='cuda:2')
diff2 is tensor(2.6077e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(941.0569, device='cuda:2')
compute similarity is  tensor(0.7774, device='cuda:2')
compute distance is  tensor(939.2222, device='cuda:2')
compute similarity is  tensor(0.7781, device='cuda:2')
compute distance is  tensor(940.7381, device='cuda:2')
compute similarity is  tensor(0.7775, device='cuda:2')
compute distance is  tensor(942.8035, device='cuda:2')
compute similarity is  tensor(0.7776, device='cuda:2')
compute distance is  tensor(937.5854, device='cuda:2')
compute similarity is  tensor(0.7782, device='cuda:2')
compute distance is  tensor(947.0627, device='cuda:2')
compute similarity is  tensor(0.7762, device='cuda:2')
compute distance is  tensor(939.7799, device='cuda:2')
compute similarity is  tensor(0.7775, device='cuda:2')
compute distance is  tensor(942.0444, device='cuda:2')
compute similarity is  tensor(0.7770, device='cuda:2')
compute distance is  tensor(942.8237, device='cuda:2')
compute similarity is  tensor(0.7777, device='cuda:2')
compute distance is  tensor(946.3821, device='cuda:2')
compute similarity is  tensor(0.7770, device='cuda:2')
compute distance is  tensor(937.4492, device='cuda:2')
compute similarity is  tensor(0.7776, device='cuda:2')
compute distance is  tensor(941.2203, device='cuda:2')
compute similarity is  tensor(0.7775, device='cuda:2')
calculated distance threshold is  tensor(947.0627, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7758666668229932
inner product is  tensor(235.6668, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8075666668229917
inner product is  tensor(234.0303, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8054666668229918
inner product is  tensor(230.5544, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7185166668229961
inner product is  tensor(232.8689, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.6843833334896648
inner product is  tensor(231.8662, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7802500001563264
inner product is  tensor(237.0216, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.38478333348967425
inner product is  tensor(244.9486, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.46278333348967504
inner product is  tensor(243.4576, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.46835000015634176
inner product is  tensor(240.4336, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5391833334896756
inner product is  tensor(234.2036, device='cuda:2')
====================
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1467.8671, device='cuda:2')
test similarity is  tensor(0.7054, device='cuda:2')
test acc is  0.38478333348967425
test loss is 5.580149442402284
test entropy is  0.22852420306472637
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22852420306472637
avg test loss is  5.580149442402284
avg accuracy is  0.38478333348967425
compute_distance is  tensor(1467.8671, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 84.25% 

Test Accuracy: 83.09% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.7200, device='cuda:2')
diff2 is tensor(-1.7200, device='cuda:2')
diff1 is tensor(0.3419, device='cuda:2')
diff2 is tensor(0.3419, device='cuda:2')
diff1 is tensor(-10.7482, device='cuda:2')
diff2 is tensor(-10.7482, device='cuda:2')
diff1 is tensor(-0.5040, device='cuda:2')
diff2 is tensor(-0.5040, device='cuda:2')
diff1 is tensor(-0.0213, device='cuda:2')
diff2 is tensor(-0.0213, device='cuda:2')
diff1 is tensor(-2.6077e-08, device='cuda:2')
diff2 is tensor(-2.6077e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(883.5753, device='cuda:2')
compute similarity is  tensor(0.8057, device='cuda:2')
compute distance is  tensor(882.1260, device='cuda:2')
compute similarity is  tensor(0.8062, device='cuda:2')
compute distance is  tensor(882.5090, device='cuda:2')
compute similarity is  tensor(0.8062, device='cuda:2')
compute distance is  tensor(883.8000, device='cuda:2')
compute similarity is  tensor(0.8056, device='cuda:2')
compute distance is  tensor(882.3130, device='cuda:2')
compute similarity is  tensor(0.8064, device='cuda:2')
compute distance is  tensor(881.4534, device='cuda:2')
compute similarity is  tensor(0.8066, device='cuda:2')
compute distance is  tensor(880.6031, device='cuda:2')
compute similarity is  tensor(0.8063, device='cuda:2')
compute distance is  tensor(880.1174, device='cuda:2')
compute similarity is  tensor(0.8063, device='cuda:2')
compute distance is  tensor(879.1225, device='cuda:2')
compute similarity is  tensor(0.8067, device='cuda:2')
compute distance is  tensor(877.9724, device='cuda:2')
compute similarity is  tensor(0.8069, device='cuda:2')
compute distance is  tensor(881.6601, device='cuda:2')
compute similarity is  tensor(0.8062, device='cuda:2')
compute distance is  tensor(881.1444, device='cuda:2')
compute similarity is  tensor(0.8065, device='cuda:2')
calculated distance threshold is  tensor(883.8000, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.815133333489658
inner product is  tensor(158.9861, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.834350000156324
inner product is  tensor(158.9269, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8337833334896573
inner product is  tensor(160.8869, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.695833333489664
inner product is  tensor(155.6517, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7955333334896589
inner product is  tensor(157.4645, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7884333334896593
inner product is  tensor(158.0560, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.61323333348967
inner product is  tensor(158.6387, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.733133333489662
inner product is  tensor(160.4915, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.5978166668230045
inner product is  tensor(167.7370, device='cuda:2')
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.41921666682300796
inner product is  tensor(166.7132, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.30926666682300635
inner product is  tensor(155.7540, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2959.0479, device='cuda:2')
test similarity is  tensor(0.4419, device='cuda:2')
test acc is  0.30926666682300635
test loss is 19.851672399272797
test entropy is  0.09889119590666376
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09889119590666376
avg test loss is  19.851672399272797
avg accuracy is  0.30926666682300635
compute_distance is  tensor(2959.0479, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 73.00% 

Test Accuracy: 71.42% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-7.5624, device='cuda:2')
diff2 is tensor(-7.5624, device='cuda:2')
diff1 is tensor(-3.4815, device='cuda:2')
diff2 is tensor(-3.4815, device='cuda:2')
diff1 is tensor(-124.1547, device='cuda:2')
diff2 is tensor(-124.1547, device='cuda:2')
diff1 is tensor(-1.8091, device='cuda:2')
diff2 is tensor(-1.8091, device='cuda:2')
diff1 is tensor(-0.0161, device='cuda:2')
diff2 is tensor(-0.0161, device='cuda:2')
diff1 is tensor(6.4541e-07, device='cuda:2')
diff2 is tensor(6.4541e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1294.4523, device='cuda:2')
compute similarity is  tensor(0.6921, device='cuda:2')
compute distance is  tensor(1296.1874, device='cuda:2')
compute similarity is  tensor(0.6917, device='cuda:2')
compute distance is  tensor(1297.6156, device='cuda:2')
compute similarity is  tensor(0.6919, device='cuda:2')
compute distance is  tensor(1295.8370, device='cuda:2')
compute similarity is  tensor(0.6917, device='cuda:2')
compute distance is  tensor(1298.0402, device='cuda:2')
compute similarity is  tensor(0.6918, device='cuda:2')
compute distance is  tensor(1299.9156, device='cuda:2')
compute similarity is  tensor(0.6916, device='cuda:2')
compute distance is  tensor(1293.3940, device='cuda:2')
compute similarity is  tensor(0.6917, device='cuda:2')
compute distance is  tensor(1295.0991, device='cuda:2')
compute similarity is  tensor(0.6915, device='cuda:2')
compute distance is  tensor(1292.6173, device='cuda:2')
compute similarity is  tensor(0.6927, device='cuda:2')
compute distance is  tensor(1300.4247, device='cuda:2')
compute similarity is  tensor(0.6909, device='cuda:2')
compute distance is  tensor(1296.1101, device='cuda:2')
compute similarity is  tensor(0.6922, device='cuda:2')
compute distance is  tensor(1298.2089, device='cuda:2')
compute similarity is  tensor(0.6918, device='cuda:2')
calculated distance threshold is  tensor(1300.4247, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7143500001563298
inner product is  tensor(1239.7477, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6819500001563317
inner product is  tensor(1240.9757, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.7401000001563283
inner product is  tensor(1243.0791, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6910666668229978
inner product is  tensor(1241.6947, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.6776000001563318
inner product is  tensor(1239.7847, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.703116666822997
inner product is  tensor(1242.4247, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5274833334896756
inner product is  tensor(1236.7611, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5551000001563415
inner product is  tensor(1229.6248, device='cuda:2')
====================
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1468.8905, device='cuda:2')
test similarity is  tensor(0.7641, device='cuda:2')
test acc is  0.5274833334896756
test loss is 3.956683183529738
test entropy is  0.225354368403268
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.225354368403268
avg test loss is  3.956683183529738
avg accuracy is  0.5274833334896756
compute_distance is  tensor(1468.8905, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 80.54% 

Test Accuracy: 78.92% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(3.0814, device='cuda:2')
diff2 is tensor(3.0814, device='cuda:2')
diff1 is tensor(1.7503, device='cuda:2')
diff2 is tensor(1.7503, device='cuda:2')
diff1 is tensor(10.2159, device='cuda:2')
diff2 is tensor(10.2159, device='cuda:2')
diff1 is tensor(-1.0066, device='cuda:2')
diff2 is tensor(-1.0066, device='cuda:2')
diff1 is tensor(0.0572, device='cuda:2')
diff2 is tensor(0.0572, device='cuda:2')
diff1 is tensor(-7.1153e-07, device='cuda:2')
diff2 is tensor(-7.1153e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1104.2998, device='cuda:2')
compute similarity is  tensor(0.7606, device='cuda:2')
compute distance is  tensor(1104.7469, device='cuda:2')
compute similarity is  tensor(0.7611, device='cuda:2')
compute distance is  tensor(1109.2241, device='cuda:2')
compute similarity is  tensor(0.7602, device='cuda:2')
compute distance is  tensor(1111.7152, device='cuda:2')
compute similarity is  tensor(0.7599, device='cuda:2')
compute distance is  tensor(1106.6805, device='cuda:2')
compute similarity is  tensor(0.7611, device='cuda:2')
compute distance is  tensor(1107.1110, device='cuda:2')
compute similarity is  tensor(0.7605, device='cuda:2')
compute distance is  tensor(1105.7009, device='cuda:2')
compute similarity is  tensor(0.7606, device='cuda:2')
compute distance is  tensor(1113.2314, device='cuda:2')
compute similarity is  tensor(0.7592, device='cuda:2')
compute distance is  tensor(1102.7617, device='cuda:2')
compute similarity is  tensor(0.7610, device='cuda:2')
compute distance is  tensor(1111.1663, device='cuda:2')
compute similarity is  tensor(0.7598, device='cuda:2')
compute distance is  tensor(1108.7722, device='cuda:2')
compute similarity is  tensor(0.7605, device='cuda:2')
compute distance is  tensor(1107.0853, device='cuda:2')
compute similarity is  tensor(0.7608, device='cuda:2')
calculated distance threshold is  tensor(1113.2314, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7960333334896589
inner product is  tensor(190.2908, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7733833334896599
inner product is  tensor(190.1573, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.799516666822992
inner product is  tensor(191.7339, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.754933333489661
inner product is  tensor(187.0387, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7709166668229934
inner product is  tensor(189.4594, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7661333334896603
inner product is  tensor(192.8267, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.536216666823009
inner product is  tensor(196.9221, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.574133333489673
inner product is  tensor(190.1972, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.5851833334896722
inner product is  tensor(184.6669, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5898833334896718
inner product is  tensor(192.3177, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.4783000001563419
inner product is  tensor(190.3994, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.8926, device='cuda:2')
test similarity is  tensor(0.7485, device='cuda:2')
test acc is  0.4783000001563419
test loss is 3.634694359195766
test entropy is  0.255574435917045
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.255574435917045
avg test loss is  3.634694359195766
avg accuracy is  0.4783000001563419
compute_distance is  tensor(1470.8926, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 80.93% 

Test Accuracy: 79.56% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.6916, device='cuda:2')
diff2 is tensor(-0.6916, device='cuda:2')
diff1 is tensor(-0.8711, device='cuda:2')
diff2 is tensor(-0.8711, device='cuda:2')
diff1 is tensor(-32.9700, device='cuda:2')
diff2 is tensor(-32.9700, device='cuda:2')
diff1 is tensor(-0.5274, device='cuda:2')
diff2 is tensor(-0.5274, device='cuda:2')
diff1 is tensor(-0.0750, device='cuda:2')
diff2 is tensor(-0.0750, device='cuda:2')
diff1 is tensor(-2.4587e-07, device='cuda:2')
diff2 is tensor(-2.4587e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1176.1714, device='cuda:2')
compute similarity is  tensor(0.7464, device='cuda:2')
compute distance is  tensor(1172.6068, device='cuda:2')
compute similarity is  tensor(0.7466, device='cuda:2')
compute distance is  tensor(1178.9496, device='cuda:2')
compute similarity is  tensor(0.7459, device='cuda:2')
compute distance is  tensor(1177.6622, device='cuda:2')
compute similarity is  tensor(0.7465, device='cuda:2')
compute distance is  tensor(1173.9740, device='cuda:2')
compute similarity is  tensor(0.7473, device='cuda:2')
compute distance is  tensor(1177.6418, device='cuda:2')
compute similarity is  tensor(0.7464, device='cuda:2')
compute distance is  tensor(1173.4435, device='cuda:2')
compute similarity is  tensor(0.7470, device='cuda:2')
compute distance is  tensor(1178.0353, device='cuda:2')
compute similarity is  tensor(0.7460, device='cuda:2')
compute distance is  tensor(1174.6177, device='cuda:2')
compute similarity is  tensor(0.7467, device='cuda:2')
compute distance is  tensor(1178.3290, device='cuda:2')
compute similarity is  tensor(0.7461, device='cuda:2')
compute distance is  tensor(1174.8405, device='cuda:2')
compute similarity is  tensor(0.7469, device='cuda:2')
compute distance is  tensor(1176.9150, device='cuda:2')
compute similarity is  tensor(0.7463, device='cuda:2')
calculated distance threshold is  tensor(1178.9496, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8005000001563254
inner product is  tensor(328.2654, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8121000001563248
inner product is  tensor(329.8657, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8015833334896586
inner product is  tensor(328.3522, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7374833334896618
inner product is  tensor(338.7244, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7991833334896588
inner product is  tensor(338.2980, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.776316666822993
inner product is  tensor(333.0527, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6199166668230027
inner product is  tensor(346.4034, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6813666668229984
inner product is  tensor(324.8452, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.5829833334896725
inner product is  tensor(328.1262, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.7351166668229953
inner product is  tensor(316.4796, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.7247333334896624
inner product is  tensor(337.1768, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.4829166668230086
inner product is  tensor(318.3330, device='cuda:2')
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.2196000001563373
inner product is  tensor(321.4559, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2939.7676, device='cuda:2')
test similarity is  tensor(0.4979, device='cuda:2')
test acc is  0.2196000001563373
test loss is 25.20930251078819
test entropy is  0.08463923971472519
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08463923971472519
avg test loss is  25.20930251078819
avg accuracy is  0.2196000001563373
compute_distance is  tensor(2939.7676, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 79.47% 

Test Accuracy: 77.78% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.7663, device='cuda:2')
diff2 is tensor(2.7663, device='cuda:2')
diff1 is tensor(-0.2540, device='cuda:2')
diff2 is tensor(-0.2540, device='cuda:2')
diff1 is tensor(15.9632, device='cuda:2')
diff2 is tensor(15.9632, device='cuda:2')
diff1 is tensor(0.5828, device='cuda:2')
diff2 is tensor(0.5828, device='cuda:2')
diff1 is tensor(0.0311, device='cuda:2')
diff2 is tensor(0.0311, device='cuda:2')
diff1 is tensor(4.4703e-07, device='cuda:2')
diff2 is tensor(4.4703e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1216.6121, device='cuda:2')
compute similarity is  tensor(0.7406, device='cuda:2')
compute distance is  tensor(1217.8162, device='cuda:2')
compute similarity is  tensor(0.7408, device='cuda:2')
compute distance is  tensor(1220.5284, device='cuda:2')
compute similarity is  tensor(0.7408, device='cuda:2')
compute distance is  tensor(1214.8252, device='cuda:2')
compute similarity is  tensor(0.7412, device='cuda:2')
compute distance is  tensor(1219.7692, device='cuda:2')
compute similarity is  tensor(0.7403, device='cuda:2')
compute distance is  tensor(1220.9349, device='cuda:2')
compute similarity is  tensor(0.7401, device='cuda:2')
compute distance is  tensor(1222.0593, device='cuda:2')
compute similarity is  tensor(0.7400, device='cuda:2')
compute distance is  tensor(1220.1876, device='cuda:2')
compute similarity is  tensor(0.7400, device='cuda:2')
compute distance is  tensor(1214.9799, device='cuda:2')
compute similarity is  tensor(0.7413, device='cuda:2')
compute distance is  tensor(1223.0236, device='cuda:2')
compute similarity is  tensor(0.7397, device='cuda:2')
compute distance is  tensor(1216.1357, device='cuda:2')
compute similarity is  tensor(0.7408, device='cuda:2')
compute distance is  tensor(1219.5264, device='cuda:2')
compute similarity is  tensor(0.7403, device='cuda:2')
calculated distance threshold is  tensor(1223.0236, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7565000001563275
inner product is  tensor(566.3423, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7566500001563273
inner product is  tensor(563.7699, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.800416666822992
inner product is  tensor(562.7379, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6868000001563315
inner product is  tensor(561.2703, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7873666668229927
inner product is  tensor(560.9052, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.8070333334896583
inner product is  tensor(570.9600, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5128000001563421
inner product is  tensor(583.9604, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5550666668230082
inner product is  tensor(558.9835, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.6391833334896679
inner product is  tensor(535.6877, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.6019833334896707
inner product is  tensor(546.8242, device='cuda:2')
====================
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1472.3744, device='cuda:2')
test similarity is  tensor(0.7726, device='cuda:2')
test acc is  0.5128000001563421
test loss is 4.451729839798738
test entropy is  0.25814854275824417
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.25814854275824417
avg test loss is  4.451729839798738
avg accuracy is  0.5128000001563421
compute_distance is  tensor(1472.3744, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 81.48% 

Test Accuracy: 80.24% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.5653, device='cuda:2')
diff2 is tensor(-0.5653, device='cuda:2')
diff1 is tensor(0.7143, device='cuda:2')
diff2 is tensor(0.7143, device='cuda:2')
diff1 is tensor(4.3513, device='cuda:2')
diff2 is tensor(4.3513, device='cuda:2')
diff1 is tensor(-1.0841, device='cuda:2')
diff2 is tensor(-1.0841, device='cuda:2')
diff1 is tensor(0.0003, device='cuda:2')
diff2 is tensor(0.0003, device='cuda:2')
diff1 is tensor(-6.9849e-07, device='cuda:2')
diff2 is tensor(-6.9849e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1226.3568, device='cuda:2')
compute similarity is  tensor(0.7470, device='cuda:2')
compute distance is  tensor(1230.7123, device='cuda:2')
compute similarity is  tensor(0.7476, device='cuda:2')
compute distance is  tensor(1222.5605, device='cuda:2')
compute similarity is  tensor(0.7475, device='cuda:2')
compute distance is  tensor(1224.2206, device='cuda:2')
compute similarity is  tensor(0.7477, device='cuda:2')
compute distance is  tensor(1225.7910, device='cuda:2')
compute similarity is  tensor(0.7479, device='cuda:2')
compute distance is  tensor(1228.0449, device='cuda:2')
compute similarity is  tensor(0.7473, device='cuda:2')
compute distance is  tensor(1230.8578, device='cuda:2')
compute similarity is  tensor(0.7471, device='cuda:2')
compute distance is  tensor(1229.9355, device='cuda:2')
compute similarity is  tensor(0.7475, device='cuda:2')
compute distance is  tensor(1226.9672, device='cuda:2')
compute similarity is  tensor(0.7475, device='cuda:2')
compute distance is  tensor(1222.7666, device='cuda:2')
compute similarity is  tensor(0.7481, device='cuda:2')
compute distance is  tensor(1228.9736, device='cuda:2')
compute similarity is  tensor(0.7468, device='cuda:2')
compute distance is  tensor(1230.5598, device='cuda:2')
compute similarity is  tensor(0.7470, device='cuda:2')
calculated distance threshold is  tensor(1230.8578, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8130833334896581
inner product is  tensor(237.5766, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8094666668229916
inner product is  tensor(237.4705, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8004833334896587
inner product is  tensor(237.5971, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7038833334896636
inner product is  tensor(238.4417, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7248166668229958
inner product is  tensor(232.7430, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7879000001563259
inner product is  tensor(238.7268, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7666166668229937
inner product is  tensor(229.5223, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.5738166668230065
inner product is  tensor(239.1927, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6888666668229979
inner product is  tensor(240.1738, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.20715000015633672
inner product is  tensor(243.3163, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2865000001563393
inner product is  tensor(230.8763, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.25340000015633835
inner product is  tensor(240.7655, device='cuda:2')
====================
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2941.6138, device='cuda:2')
test similarity is  tensor(0.5285, device='cuda:2')
test acc is  0.20715000015633672
test loss is 20.919755507633884
test entropy is  0.09831933693876907
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.09831933693876907
avg test loss is  20.919755507633884
avg accuracy is  0.20715000015633672
compute_distance is  tensor(2941.6138, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 75.47% 

Test Accuracy: 74.19% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-9.2711, device='cuda:2')
diff2 is tensor(-9.2711, device='cuda:2')
diff1 is tensor(-1.4546, device='cuda:2')
diff2 is tensor(-1.4546, device='cuda:2')
diff1 is tensor(-99.0040, device='cuda:2')
diff2 is tensor(-99.0040, device='cuda:2')
diff1 is tensor(-0.0870, device='cuda:2')
diff2 is tensor(-0.0870, device='cuda:2')
diff1 is tensor(1.9312e-05, device='cuda:2')
diff2 is tensor(1.9312e-05, device='cuda:2')
diff1 is tensor(-1.0431e-07, device='cuda:2')
diff2 is tensor(-1.0431e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1428.8800, device='cuda:2')
compute similarity is  tensor(0.7047, device='cuda:2')
compute distance is  tensor(1425.2972, device='cuda:2')
compute similarity is  tensor(0.7049, device='cuda:2')
compute distance is  tensor(1426.8076, device='cuda:2')
compute similarity is  tensor(0.7048, device='cuda:2')
compute distance is  tensor(1424.4423, device='cuda:2')
compute similarity is  tensor(0.7048, device='cuda:2')
compute distance is  tensor(1428.1718, device='cuda:2')
compute similarity is  tensor(0.7044, device='cuda:2')
compute distance is  tensor(1427.9111, device='cuda:2')
compute similarity is  tensor(0.7042, device='cuda:2')
compute distance is  tensor(1427.4117, device='cuda:2')
compute similarity is  tensor(0.7043, device='cuda:2')
compute distance is  tensor(1426.6788, device='cuda:2')
compute similarity is  tensor(0.7047, device='cuda:2')
compute distance is  tensor(1426.1016, device='cuda:2')
compute similarity is  tensor(0.7051, device='cuda:2')
compute distance is  tensor(1421.9949, device='cuda:2')
compute similarity is  tensor(0.7053, device='cuda:2')
compute distance is  tensor(1427.3265, device='cuda:2')
compute similarity is  tensor(0.7047, device='cuda:2')
compute distance is  tensor(1428.5243, device='cuda:2')
compute similarity is  tensor(0.7043, device='cuda:2')
calculated distance threshold is  tensor(1428.8800, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7260333334896625
inner product is  tensor(814.6569, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7641666668229937
inner product is  tensor(816.2510, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.734383333489662
inner product is  tensor(811.6997, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6331500001563349
inner product is  tensor(813.0194, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6683333334896658
inner product is  tensor(819.5653, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.6780333334896653
inner product is  tensor(812.7479, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.7097833334896634
inner product is  tensor(810.8817, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.7067833334896635
inner product is  tensor(807.0955, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.7182166668229962
inner product is  tensor(806.6070, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5997000001563376
inner product is  tensor(825.8550, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.5710500001563401
inner product is  tensor(812.6450, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1474.7776, device='cuda:2')
test similarity is  tensor(0.7996, device='cuda:2')
test acc is  0.5710500001563401
test loss is 2.8966133274249177
test entropy is  0.24336547626933056
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24336547626933056
avg test loss is  2.8966133274249177
avg accuracy is  0.5710500001563401
compute_distance is  tensor(1474.7776, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 80.64% 

Test Accuracy: 79.29% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(7.0887, device='cuda:2')
diff2 is tensor(7.0887, device='cuda:2')
diff1 is tensor(0.4334, device='cuda:2')
diff2 is tensor(0.4334, device='cuda:2')
diff1 is tensor(32.3212, device='cuda:2')
diff2 is tensor(32.3212, device='cuda:2')
diff1 is tensor(-0.0862, device='cuda:2')
diff2 is tensor(-0.0862, device='cuda:2')
diff1 is tensor(0.0128, device='cuda:2')
diff2 is tensor(0.0128, device='cuda:2')
diff1 is tensor(6.3702e-07, device='cuda:2')
diff2 is tensor(6.3702e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1338.0182, device='cuda:2')
compute similarity is  tensor(0.7339, device='cuda:2')
compute distance is  tensor(1335.0885, device='cuda:2')
compute similarity is  tensor(0.7342, device='cuda:2')
compute distance is  tensor(1338.0248, device='cuda:2')
compute similarity is  tensor(0.7339, device='cuda:2')
compute distance is  tensor(1337.9514, device='cuda:2')
compute similarity is  tensor(0.7340, device='cuda:2')
compute distance is  tensor(1339.7325, device='cuda:2')
compute similarity is  tensor(0.7333, device='cuda:2')
compute distance is  tensor(1334.4078, device='cuda:2')
compute similarity is  tensor(0.7338, device='cuda:2')
compute distance is  tensor(1338.3719, device='cuda:2')
compute similarity is  tensor(0.7343, device='cuda:2')
compute distance is  tensor(1333.3044, device='cuda:2')
compute similarity is  tensor(0.7344, device='cuda:2')
compute distance is  tensor(1336.1293, device='cuda:2')
compute similarity is  tensor(0.7341, device='cuda:2')
compute distance is  tensor(1334.3899, device='cuda:2')
compute similarity is  tensor(0.7342, device='cuda:2')
compute distance is  tensor(1333.6240, device='cuda:2')
compute similarity is  tensor(0.7343, device='cuda:2')
compute distance is  tensor(1337.2249, device='cuda:2')
compute similarity is  tensor(0.7340, device='cuda:2')
calculated distance threshold is  tensor(1339.7325, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8064000001563252
inner product is  tensor(234.0172, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8050166668229918
inner product is  tensor(234.0962, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7822333334896596
inner product is  tensor(234.3418, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.760566666822994
inner product is  tensor(237.8664, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.752333333489661
inner product is  tensor(236.1759, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.6451333334896675
inner product is  tensor(231.0893, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.542466666823009
inner product is  tensor(227.4882, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.32165000015633993
inner product is  tensor(236.4575, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6099666668230034
inner product is  tensor(241.9309, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.6278000001563353
inner product is  tensor(229.8868, device='cuda:2')
====================
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1470.0154, device='cuda:2')
test similarity is  tensor(0.7936, device='cuda:2')
test acc is  0.32165000015633993
test loss is 7.35412030738554
test entropy is  0.19755132155600133
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19755132155600133
avg test loss is  7.35412030738554
avg accuracy is  0.32165000015633993
compute_distance is  tensor(1470.0154, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 82.66% 

Test Accuracy: 81.64% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.6371, device='cuda:2')
diff2 is tensor(-2.6371, device='cuda:2')
diff1 is tensor(-0.1628, device='cuda:2')
diff2 is tensor(-0.1628, device='cuda:2')
diff1 is tensor(14.5330, device='cuda:2')
diff2 is tensor(14.5330, device='cuda:2')
diff1 is tensor(0.4061, device='cuda:2')
diff2 is tensor(0.4061, device='cuda:2')
diff1 is tensor(0.0091, device='cuda:2')
diff2 is tensor(0.0091, device='cuda:2')
diff1 is tensor(-1.6019e-07, device='cuda:2')
diff2 is tensor(-1.6019e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1141.7070, device='cuda:2')
compute similarity is  tensor(0.8198, device='cuda:2')
compute distance is  tensor(1144.7927, device='cuda:2')
compute similarity is  tensor(0.8196, device='cuda:2')
compute distance is  tensor(1148.4434, device='cuda:2')
compute similarity is  tensor(0.8186, device='cuda:2')
compute distance is  tensor(1139.0316, device='cuda:2')
compute similarity is  tensor(0.8199, device='cuda:2')
compute distance is  tensor(1141.9158, device='cuda:2')
compute similarity is  tensor(0.8198, device='cuda:2')
compute distance is  tensor(1139.7816, device='cuda:2')
compute similarity is  tensor(0.8200, device='cuda:2')
compute distance is  tensor(1149.5376, device='cuda:2')
compute similarity is  tensor(0.8189, device='cuda:2')
compute distance is  tensor(1145.0892, device='cuda:2')
compute similarity is  tensor(0.8189, device='cuda:2')
compute distance is  tensor(1145.3547, device='cuda:2')
compute similarity is  tensor(0.8191, device='cuda:2')
compute distance is  tensor(1142.0638, device='cuda:2')
compute similarity is  tensor(0.8196, device='cuda:2')
compute distance is  tensor(1145.4307, device='cuda:2')
compute similarity is  tensor(0.8194, device='cuda:2')
compute distance is  tensor(1138.2339, device='cuda:2')
compute similarity is  tensor(0.8201, device='cuda:2')
calculated distance threshold is  tensor(1149.5376, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8139500001563248
inner product is  tensor(143.3278, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8273166668229909
inner product is  tensor(145.1349, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8274333334896575
inner product is  tensor(144.3055, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8083833334896584
inner product is  tensor(145.2660, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.8003000001563254
inner product is  tensor(140.5284, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7992000001563254
inner product is  tensor(143.4600, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7167000001563296
inner product is  tensor(143.7098, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.57160000015634
inner product is  tensor(139.0299, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.45565000015634166
inner product is  tensor(155.6117, device='cuda:2')
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3853166668230075
inner product is  tensor(131.7374, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2676666668230054
inner product is  tensor(158.4958, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.38475000015634087
inner product is  tensor(132.8599, device='cuda:2')
====================
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.7126, device='cuda:2')
test similarity is  tensor(0.5440, device='cuda:2')
test acc is  0.2676666668230054
test loss is 17.337169549612604
test entropy is  0.08389179195080802
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.08389179195080802
avg test loss is  17.337169549612604
avg accuracy is  0.2676666668230054
compute_distance is  tensor(2927.7126, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 80.95% 

Test Accuracy: 79.81% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-6.4220, device='cuda:2')
diff2 is tensor(-6.4220, device='cuda:2')
diff1 is tensor(-1.9526, device='cuda:2')
diff2 is tensor(-1.9526, device='cuda:2')
diff1 is tensor(-60.9035, device='cuda:2')
diff2 is tensor(-60.9035, device='cuda:2')
diff1 is tensor(-0.5154, device='cuda:2')
diff2 is tensor(-0.5154, device='cuda:2')
diff1 is tensor(-0.0413, device='cuda:2')
diff2 is tensor(-0.0413, device='cuda:2')
diff1 is tensor(-5.5507e-07, device='cuda:2')
diff2 is tensor(-5.5507e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1458.4941, device='cuda:2')
compute similarity is  tensor(0.7441, device='cuda:2')
compute distance is  tensor(1458.1187, device='cuda:2')
compute similarity is  tensor(0.7443, device='cuda:2')
compute distance is  tensor(1460.2144, device='cuda:2')
compute similarity is  tensor(0.7444, device='cuda:2')
compute distance is  tensor(1455.2140, device='cuda:2')
compute similarity is  tensor(0.7449, device='cuda:2')
compute distance is  tensor(1461.6472, device='cuda:2')
compute similarity is  tensor(0.7443, device='cuda:2')
compute distance is  tensor(1457.0372, device='cuda:2')
compute similarity is  tensor(0.7447, device='cuda:2')
compute distance is  tensor(1455.9539, device='cuda:2')
compute similarity is  tensor(0.7449, device='cuda:2')
compute distance is  tensor(1463.8514, device='cuda:2')
compute similarity is  tensor(0.7438, device='cuda:2')
compute distance is  tensor(1455.0957, device='cuda:2')
compute similarity is  tensor(0.7446, device='cuda:2')
compute distance is  tensor(1455.6515, device='cuda:2')
compute similarity is  tensor(0.7448, device='cuda:2')
compute distance is  tensor(1454.4293, device='cuda:2')
compute similarity is  tensor(0.7449, device='cuda:2')
compute distance is  tensor(1461.2787, device='cuda:2')
compute similarity is  tensor(0.7443, device='cuda:2')
calculated distance threshold is  tensor(1463.8514, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8103666668229917
inner product is  tensor(1215.9467, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7927000001563258
inner product is  tensor(1212.2013, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7822500001563263
inner product is  tensor(1212.5322, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7070166668229968
inner product is  tensor(1197.8757, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7683666668229936
inner product is  tensor(1221.4316, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7897666668229926
inner product is  tensor(1215.0913, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6535166668230002
inner product is  tensor(1236.3153, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5832333334896723
inner product is  tensor(1243.9503, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.7206833334896626
inner product is  tensor(1243.0293, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.4572166668230084
inner product is  tensor(1270.4283, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.21306666682300363
inner product is  tensor(1186.6765, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.37515000015634076
inner product is  tensor(1228.6068, device='cuda:2')
====================
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2930.9368, device='cuda:2')
test similarity is  tensor(0.5895, device='cuda:2')
test acc is  0.21306666682300363
test loss is 20.379881494843374
test entropy is  0.11396060690188459
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11396060690188459
avg test loss is  20.379881494843374
avg accuracy is  0.21306666682300363
compute_distance is  tensor(2930.9368, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 78.83% 

Test Accuracy: 77.79% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.3575, device='cuda:2')
diff2 is tensor(1.3575, device='cuda:2')
diff1 is tensor(-0.4457, device='cuda:2')
diff2 is tensor(-0.4457, device='cuda:2')
diff1 is tensor(-88.3921, device='cuda:2')
diff2 is tensor(-88.3921, device='cuda:2')
diff1 is tensor(-1.9836, device='cuda:2')
diff2 is tensor(-1.9836, device='cuda:2')
diff1 is tensor(-0.0155, device='cuda:2')
diff2 is tensor(-0.0155, device='cuda:2')
diff1 is tensor(3.7998e-07, device='cuda:2')
diff2 is tensor(3.7998e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1580.8467, device='cuda:2')
compute similarity is  tensor(0.7237, device='cuda:2')
compute distance is  tensor(1578.4456, device='cuda:2')
compute similarity is  tensor(0.7239, device='cuda:2')
compute distance is  tensor(1580.5002, device='cuda:2')
compute similarity is  tensor(0.7237, device='cuda:2')
compute distance is  tensor(1579.9003, device='cuda:2')
compute similarity is  tensor(0.7240, device='cuda:2')
compute distance is  tensor(1574.3186, device='cuda:2')
compute similarity is  tensor(0.7243, device='cuda:2')
compute distance is  tensor(1580.2100, device='cuda:2')
compute similarity is  tensor(0.7234, device='cuda:2')
compute distance is  tensor(1585.9447, device='cuda:2')
compute similarity is  tensor(0.7229, device='cuda:2')
compute distance is  tensor(1582.6824, device='cuda:2')
compute similarity is  tensor(0.7237, device='cuda:2')
compute distance is  tensor(1582.9498, device='cuda:2')
compute similarity is  tensor(0.7235, device='cuda:2')
compute distance is  tensor(1577.7130, device='cuda:2')
compute similarity is  tensor(0.7239, device='cuda:2')
compute distance is  tensor(1581.9507, device='cuda:2')
compute similarity is  tensor(0.7235, device='cuda:2')
compute distance is  tensor(1585.5271, device='cuda:2')
compute similarity is  tensor(0.7231, device='cuda:2')
calculated distance threshold is  tensor(1585.9447, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7749000001563267
inner product is  tensor(825.5878, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7855333334896595
inner product is  tensor(827.5115, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7869000001563261
inner product is  tensor(828.5876, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7363000001563285
inner product is  tensor(840.0601, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7061500001563301
inner product is  tensor(825.7645, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7314000001563288
inner product is  tensor(832.1352, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6738666668229989
inner product is  tensor(801.9861, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6475666668230006
inner product is  tensor(817.8419, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.3559333334896738
inner product is  tensor(843.2458, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5423500001563423
inner product is  tensor(827.0943, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.6998500001563306
inner product is  tensor(817.1263, device='cuda:2')
====================
________________________________
test distance is  tensor(1462.2211, device='cuda:2')
test similarity is  tensor(0.8365, device='cuda:2')
test acc is  0.3559333334896738
test loss is 8.42754824939313
test entropy is  0.18253065978508515
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 79.75% 

Test Accuracy: 78.51% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.1988, device='cuda:2')
diff2 is tensor(2.1988, device='cuda:2')
diff1 is tensor(-0.1940, device='cuda:2')
diff2 is tensor(-0.1940, device='cuda:2')
diff1 is tensor(39.4262, device='cuda:2')
diff2 is tensor(39.4262, device='cuda:2')
diff1 is tensor(0.1500, device='cuda:2')
diff2 is tensor(0.1500, device='cuda:2')
diff1 is tensor(0.0321, device='cuda:2')
diff2 is tensor(0.0321, device='cuda:2')
diff1 is tensor(-3.3528e-08, device='cuda:2')
diff2 is tensor(-3.3528e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1465.8557, device='cuda:2')
compute similarity is  tensor(0.7654, device='cuda:2')
compute distance is  tensor(1465.4313, device='cuda:2')
compute similarity is  tensor(0.7654, device='cuda:2')
compute distance is  tensor(1468.7131, device='cuda:2')
compute similarity is  tensor(0.7652, device='cuda:2')
compute distance is  tensor(1466.2084, device='cuda:2')
compute similarity is  tensor(0.7654, device='cuda:2')
compute distance is  tensor(1468.3215, device='cuda:2')
compute similarity is  tensor(0.7651, device='cuda:2')
compute distance is  tensor(1468.0125, device='cuda:2')
compute similarity is  tensor(0.7651, device='cuda:2')
compute distance is  tensor(1475.9686, device='cuda:2')
compute similarity is  tensor(0.7647, device='cuda:2')
compute distance is  tensor(1471.9015, device='cuda:2')
compute similarity is  tensor(0.7653, device='cuda:2')
compute distance is  tensor(1469.9941, device='cuda:2')
compute similarity is  tensor(0.7646, device='cuda:2')
compute distance is  tensor(1462.5306, device='cuda:2')
compute similarity is  tensor(0.7656, device='cuda:2')
compute distance is  tensor(1464.8948, device='cuda:2')
compute similarity is  tensor(0.7656, device='cuda:2')
compute distance is  tensor(1466.3260, device='cuda:2')
compute similarity is  tensor(0.7652, device='cuda:2')
calculated distance threshold is  tensor(1475.9686, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7941666668229923
inner product is  tensor(264.0462, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7863500001563262
inner product is  tensor(264.5592, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.810050000156325
inner product is  tensor(264.0868, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7723666668229934
inner product is  tensor(267.4168, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7562166668229942
inner product is  tensor(269.3609, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7532000001563276
inner product is  tensor(263.5982, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5449166668230091
inner product is  tensor(270.9576, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6325833334896683
inner product is  tensor(256.0148, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.6710833334896656
inner product is  tensor(269.8470, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5498666668230087
inner product is  tensor(262.8144, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.4932333334896753
inner product is  tensor(258.7935, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(1465.9562, device='cuda:2')
test similarity is  tensor(0.8354, device='cuda:2')
test acc is  0.4932333334896753
test loss is 4.161771935440584
test entropy is  0.2618176093551396
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 82.38% 

Test Accuracy: 81.40% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.2088, device='cuda:2')
diff2 is tensor(-0.2088, device='cuda:2')
diff1 is tensor(1.0917, device='cuda:2')
diff2 is tensor(1.0917, device='cuda:2')
diff1 is tensor(23.0773, device='cuda:2')
diff2 is tensor(23.0773, device='cuda:2')
diff1 is tensor(1.5406, device='cuda:2')
diff2 is tensor(1.5406, device='cuda:2')
diff1 is tensor(-0.0081, device='cuda:2')
diff2 is tensor(-0.0081, device='cuda:2')
diff1 is tensor(-3.6135e-07, device='cuda:2')
diff2 is tensor(-3.6135e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1322.2963, device='cuda:2')
compute similarity is  tensor(0.8027, device='cuda:2')
compute distance is  tensor(1319.3911, device='cuda:2')
compute similarity is  tensor(0.8030, device='cuda:2')
compute distance is  tensor(1324.4717, device='cuda:2')
compute similarity is  tensor(0.8022, device='cuda:2')
compute distance is  tensor(1322.4666, device='cuda:2')
compute similarity is  tensor(0.8029, device='cuda:2')
compute distance is  tensor(1324.9071, device='cuda:2')
compute similarity is  tensor(0.8023, device='cuda:2')
compute distance is  tensor(1322.8180, device='cuda:2')
compute similarity is  tensor(0.8019, device='cuda:2')
compute distance is  tensor(1320.3246, device='cuda:2')
compute similarity is  tensor(0.8027, device='cuda:2')
compute distance is  tensor(1323.3557, device='cuda:2')
compute similarity is  tensor(0.8025, device='cuda:2')
compute distance is  tensor(1320.0027, device='cuda:2')
compute similarity is  tensor(0.8028, device='cuda:2')
compute distance is  tensor(1328.3915, device='cuda:2')
compute similarity is  tensor(0.8021, device='cuda:2')
compute distance is  tensor(1328.0697, device='cuda:2')
compute similarity is  tensor(0.8022, device='cuda:2')
compute distance is  tensor(1324.3175, device='cuda:2')
compute similarity is  tensor(0.8025, device='cuda:2')
calculated distance threshold is  tensor(1328.3915, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8213000001563244
inner product is  tensor(175.6962, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8213166668229911
inner product is  tensor(175.1345, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8203500001563245
inner product is  tensor(176.4074, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7964000001563255
inner product is  tensor(174.8233, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.8132166668229915
inner product is  tensor(171.6310, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.8059000001563251
inner product is  tensor(177.2410, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.687066666822998
inner product is  tensor(178.9744, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6255166668230022
inner product is  tensor(170.6016, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.553333333489675
inner product is  tensor(174.3114, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.5395500001563424
inner product is  tensor(165.2831, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.7262000001563291
inner product is  tensor(175.3359, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.6925833334896644
inner product is  tensor(164.2164, device='cuda:2')
====================
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(1469.3451, device='cuda:2')
test similarity is  tensor(0.8262, device='cuda:2')
test acc is  0.5395500001563424
test loss is 3.352657966903532
test entropy is  0.22996692964707866
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22996692964707866
avg test loss is  3.352657966903532
avg accuracy is  0.5395500001563424
compute_distance is  tensor(1469.3451, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 82.33% 

Test Accuracy: 81.30% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.4066, device='cuda:2')
diff2 is tensor(2.4066, device='cuda:2')
diff1 is tensor(-0.2460, device='cuda:2')
diff2 is tensor(-0.2460, device='cuda:2')
diff1 is tensor(-12.1085, device='cuda:2')
diff2 is tensor(-12.1085, device='cuda:2')
diff1 is tensor(-0.7772, device='cuda:2')
diff2 is tensor(-0.7772, device='cuda:2')
diff1 is tensor(0.0149, device='cuda:2')
diff2 is tensor(0.0149, device='cuda:2')
diff1 is tensor(2.5332e-07, device='cuda:2')
diff2 is tensor(2.5332e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1210.8046, device='cuda:2')
compute similarity is  tensor(0.8427, device='cuda:2')
compute distance is  tensor(1207.5704, device='cuda:2')
compute similarity is  tensor(0.8431, device='cuda:2')
compute distance is  tensor(1218.5135, device='cuda:2')
compute similarity is  tensor(0.8415, device='cuda:2')
compute distance is  tensor(1211.3569, device='cuda:2')
compute similarity is  tensor(0.8425, device='cuda:2')
compute distance is  tensor(1218.3372, device='cuda:2')
compute similarity is  tensor(0.8420, device='cuda:2')
compute distance is  tensor(1215.1459, device='cuda:2')
compute similarity is  tensor(0.8421, device='cuda:2')
compute distance is  tensor(1214.7052, device='cuda:2')
compute similarity is  tensor(0.8421, device='cuda:2')
compute distance is  tensor(1221.3441, device='cuda:2')
compute similarity is  tensor(0.8414, device='cuda:2')
compute distance is  tensor(1217.2229, device='cuda:2')
compute similarity is  tensor(0.8421, device='cuda:2')
compute distance is  tensor(1208.6484, device='cuda:2')
compute similarity is  tensor(0.8428, device='cuda:2')
compute distance is  tensor(1209.2076, device='cuda:2')
compute similarity is  tensor(0.8426, device='cuda:2')
compute distance is  tensor(1207.5845, device='cuda:2')
compute similarity is  tensor(0.8428, device='cuda:2')
calculated distance threshold is  tensor(1221.3441, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8145666668229915
inner product is  tensor(92.6792, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8214500001563244
inner product is  tensor(92.8117, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8166000001563247
inner product is  tensor(93.5034, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7582500001563274
inner product is  tensor(93.0484, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.8118166668229916
inner product is  tensor(94.9300, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7504500001563278
inner product is  tensor(93.0686, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6352666668230014
inner product is  tensor(91.3449, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5269333334896756
inner product is  tensor(87.9797, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6338500001563349
inner product is  tensor(90.5053, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.7613333334896606
inner product is  tensor(96.5155, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.715083333489663
inner product is  tensor(90.6319, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.6839166668229982
inner product is  tensor(90.3051, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.3075666668230064
inner product is  tensor(93.8884, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.0962, device='cuda:2')
test similarity is  tensor(0.5920, device='cuda:2')
test acc is  0.3075666668230064
test loss is 14.376776757270797
test entropy is  0.166473915601876
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.166473915601876
avg test loss is  14.376776757270797
avg accuracy is  0.3075666668230064
compute_distance is  tensor(2934.0962, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 83.16% 

Test Accuracy: 81.95% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.9388, device='cuda:2')
diff2 is tensor(-1.9388, device='cuda:2')
diff1 is tensor(0.6058, device='cuda:2')
diff2 is tensor(0.6058, device='cuda:2')
diff1 is tensor(3.7775, device='cuda:2')
diff2 is tensor(3.7775, device='cuda:2')
diff1 is tensor(0.7617, device='cuda:2')
diff2 is tensor(0.7617, device='cuda:2')
diff1 is tensor(-0.0341, device='cuda:2')
diff2 is tensor(-0.0341, device='cuda:2')
diff1 is tensor(-5.9605e-07, device='cuda:2')
diff2 is tensor(-5.9605e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1154.6796, device='cuda:2')
compute similarity is  tensor(0.8561, device='cuda:2')
compute distance is  tensor(1155.1438, device='cuda:2')
compute similarity is  tensor(0.8560, device='cuda:2')
compute distance is  tensor(1158.5696, device='cuda:2')
compute similarity is  tensor(0.8555, device='cuda:2')
compute distance is  tensor(1154.2518, device='cuda:2')
compute similarity is  tensor(0.8561, device='cuda:2')
compute distance is  tensor(1155.6691, device='cuda:2')
compute similarity is  tensor(0.8561, device='cuda:2')
compute distance is  tensor(1153.8760, device='cuda:2')
compute similarity is  tensor(0.8557, device='cuda:2')
compute distance is  tensor(1160.3145, device='cuda:2')
compute similarity is  tensor(0.8549, device='cuda:2')
compute distance is  tensor(1159.0197, device='cuda:2')
compute similarity is  tensor(0.8555, device='cuda:2')
compute distance is  tensor(1157.3938, device='cuda:2')
compute similarity is  tensor(0.8558, device='cuda:2')
compute distance is  tensor(1152.1160, device='cuda:2')
compute similarity is  tensor(0.8557, device='cuda:2')
compute distance is  tensor(1151.3971, device='cuda:2')
compute similarity is  tensor(0.8563, device='cuda:2')
compute distance is  tensor(1155.5695, device='cuda:2')
compute similarity is  tensor(0.8560, device='cuda:2')
calculated distance threshold is  tensor(1160.3145, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8295333334896575
inner product is  tensor(129.3584, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8140000001563248
inner product is  tensor(129.5379, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8216000001563244
inner product is  tensor(129.1527, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8037000001563253
inner product is  tensor(127.7088, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.795333333489659
inner product is  tensor(128.5230, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.8111333334896582
inner product is  tensor(133.2364, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5955333334896713
inner product is  tensor(130.6631, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.7137166668229964
inner product is  tensor(136.3962, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.6514000001563337
inner product is  tensor(136.8344, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.4547166668230084
inner product is  tensor(134.9283, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.19056666682300258
inner product is  tensor(137.6336, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.5569166668230081
inner product is  tensor(147.7499, device='cuda:2')
====================
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.0132, device='cuda:2')
test similarity is  tensor(0.5975, device='cuda:2')
test acc is  0.19056666682300258
test loss is 22.01386342323157
test entropy is  0.1501321577822476
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1501321577822476
avg test loss is  22.01386342323157
avg accuracy is  0.19056666682300258
compute_distance is  tensor(2918.0132, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 81.50% 

Test Accuracy: 79.60% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.2418, device='cuda:2')
diff2 is tensor(-0.2418, device='cuda:2')
diff1 is tensor(-0.6313, device='cuda:2')
diff2 is tensor(-0.6313, device='cuda:2')
diff1 is tensor(-33.4975, device='cuda:2')
diff2 is tensor(-33.4975, device='cuda:2')
diff1 is tensor(-1.9655, device='cuda:2')
diff2 is tensor(-1.9655, device='cuda:2')
diff1 is tensor(0.0078, device='cuda:2')
diff2 is tensor(0.0078, device='cuda:2')
diff1 is tensor(5.0664e-07, device='cuda:2')
diff2 is tensor(5.0664e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1215.9484, device='cuda:2')
compute similarity is  tensor(0.8454, device='cuda:2')
compute distance is  tensor(1215.2113, device='cuda:2')
compute similarity is  tensor(0.8454, device='cuda:2')
compute distance is  tensor(1214.5242, device='cuda:2')
compute similarity is  tensor(0.8456, device='cuda:2')
compute distance is  tensor(1212.5570, device='cuda:2')
compute similarity is  tensor(0.8459, device='cuda:2')
compute distance is  tensor(1213.8741, device='cuda:2')
compute similarity is  tensor(0.8456, device='cuda:2')
compute distance is  tensor(1213.2026, device='cuda:2')
compute similarity is  tensor(0.8456, device='cuda:2')
compute distance is  tensor(1220.4828, device='cuda:2')
compute similarity is  tensor(0.8447, device='cuda:2')
compute distance is  tensor(1220.8497, device='cuda:2')
compute similarity is  tensor(0.8449, device='cuda:2')
compute distance is  tensor(1215.1677, device='cuda:2')
compute similarity is  tensor(0.8453, device='cuda:2')
compute distance is  tensor(1209.7056, device='cuda:2')
compute similarity is  tensor(0.8459, device='cuda:2')
compute distance is  tensor(1215.3184, device='cuda:2')
compute similarity is  tensor(0.8457, device='cuda:2')
compute distance is  tensor(1222.8325, device='cuda:2')
compute similarity is  tensor(0.8451, device='cuda:2')
calculated distance threshold is  tensor(1222.8325, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8079333334896583
inner product is  tensor(314.4307, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.804116666822992
inner product is  tensor(313.4180, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8140000001563248
inner product is  tensor(318.7525, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7287166668229956
inner product is  tensor(314.7439, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7991666668229921
inner product is  tensor(316.6081, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.8073666668229919
inner product is  tensor(307.7129, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.48180000015634195
inner product is  tensor(327.9839, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.7049666668229969
inner product is  tensor(299.7705, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.7257000001563291
inner product is  tensor(318.7108, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.26851666682300546
inner product is  tensor(284.8543, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3033500001563396
inner product is  tensor(319.0955, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.22200000015633736
inner product is  tensor(288.7356, device='cuda:2')
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.32200000015633995
inner product is  tensor(311.7215, device='cuda:2')
====================
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2931.1165, device='cuda:2')
test similarity is  tensor(0.6019, device='cuda:2')
test acc is  0.22200000015633736
test loss is 20.249459250395233
test entropy is  0.16289270309401727
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16289270309401727
avg test loss is  20.249459250395233
avg accuracy is  0.22200000015633736
compute_distance is  tensor(2931.1165, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 81.16% 

Test Accuracy: 79.87% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.1904, device='cuda:2')
diff2 is tensor(2.1904, device='cuda:2')
diff1 is tensor(0.2130, device='cuda:2')
diff2 is tensor(0.2130, device='cuda:2')
diff1 is tensor(32.4209, device='cuda:2')
diff2 is tensor(32.4209, device='cuda:2')
diff1 is tensor(0.0065, device='cuda:2')
diff2 is tensor(0.0065, device='cuda:2')
diff1 is tensor(-0.0134, device='cuda:2')
diff2 is tensor(-0.0134, device='cuda:2')
diff1 is tensor(-7.0781e-08, device='cuda:2')
diff2 is tensor(-7.0781e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(1097.8567, device='cuda:2')
compute similarity is  tensor(0.8827, device='cuda:2')
compute distance is  tensor(1100.4270, device='cuda:2')
compute similarity is  tensor(0.8823, device='cuda:2')
compute distance is  tensor(1106.0133, device='cuda:2')
compute similarity is  tensor(0.8815, device='cuda:2')
compute distance is  tensor(1096.5150, device='cuda:2')
compute similarity is  tensor(0.8828, device='cuda:2')
compute distance is  tensor(1102.6635, device='cuda:2')
compute similarity is  tensor(0.8817, device='cuda:2')
compute distance is  tensor(1109.2793, device='cuda:2')
compute similarity is  tensor(0.8816, device='cuda:2')
compute distance is  tensor(1113.6346, device='cuda:2')
compute similarity is  tensor(0.8804, device='cuda:2')
compute distance is  tensor(1112.8884, device='cuda:2')
compute similarity is  tensor(0.8805, device='cuda:2')
compute distance is  tensor(1097.8947, device='cuda:2')
compute similarity is  tensor(0.8826, device='cuda:2')
compute distance is  tensor(1102.4856, device='cuda:2')
compute similarity is  tensor(0.8820, device='cuda:2')
compute distance is  tensor(1103.6466, device='cuda:2')
compute similarity is  tensor(0.8820, device='cuda:2')
compute distance is  tensor(1101.2697, device='cuda:2')
compute similarity is  tensor(0.8823, device='cuda:2')
calculated distance threshold is  tensor(1113.6346, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8089000001563249
inner product is  tensor(176.8958, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.808850000156325
inner product is  tensor(178.5523, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8138500001563248
inner product is  tensor(176.3932, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8093500001563251
inner product is  tensor(176.9793, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7812500001563264
inner product is  tensor(177.3443, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7913500001563257
inner product is  tensor(174.2722, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.671716666822999
inner product is  tensor(183.0903, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6773333334896653
inner product is  tensor(183.7965, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.5565000001563414
inner product is  tensor(179.2097, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.6098666668230034
inner product is  tensor(177.1175, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.7130333334896632
inner product is  tensor(165.9497, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.702966666822997
inner product is  tensor(176.2401, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.1830500001563355
inner product is  tensor(160.6421, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2918.6453, device='cuda:2')
test similarity is  tensor(0.6123, device='cuda:2')
test acc is  0.1830500001563355
test loss is 28.63629723611925
test entropy is  0.1793737830494894
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1793737830494894
avg test loss is  28.63629723611925
avg accuracy is  0.1830500001563355
compute_distance is  tensor(2918.6453, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 79.88% 

Test Accuracy: 78.76% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-4.0286, device='cuda:2')
diff2 is tensor(-4.0286, device='cuda:2')
diff1 is tensor(-0.8811, device='cuda:2')
diff2 is tensor(-0.8811, device='cuda:2')
diff1 is tensor(-26.2463, device='cuda:2')
diff2 is tensor(-26.2463, device='cuda:2')
diff1 is tensor(-1.4281, device='cuda:2')
diff2 is tensor(-1.4281, device='cuda:2')
diff1 is tensor(0.0184, device='cuda:2')
diff2 is tensor(0.0184, device='cuda:2')
diff1 is tensor(-3.0547e-07, device='cuda:2')
diff2 is tensor(-3.0547e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(936.1115, device='cuda:2')
compute similarity is  tensor(0.9197, device='cuda:2')
compute distance is  tensor(930.3383, device='cuda:2')
compute similarity is  tensor(0.9207, device='cuda:2')
compute distance is  tensor(937.7870, device='cuda:2')
compute similarity is  tensor(0.9195, device='cuda:2')
compute distance is  tensor(938.8853, device='cuda:2')
compute similarity is  tensor(0.9197, device='cuda:2')
compute distance is  tensor(953.0283, device='cuda:2')
compute similarity is  tensor(0.9174, device='cuda:2')
compute distance is  tensor(950.1600, device='cuda:2')
compute similarity is  tensor(0.9179, device='cuda:2')
compute distance is  tensor(936.3721, device='cuda:2')
compute similarity is  tensor(0.9197, device='cuda:2')
compute distance is  tensor(946.3547, device='cuda:2')
compute similarity is  tensor(0.9182, device='cuda:2')
compute distance is  tensor(936.2347, device='cuda:2')
compute similarity is  tensor(0.9197, device='cuda:2')
compute distance is  tensor(933.5051, device='cuda:2')
compute similarity is  tensor(0.9200, device='cuda:2')
compute distance is  tensor(946.6284, device='cuda:2')
compute similarity is  tensor(0.9186, device='cuda:2')
compute distance is  tensor(935.0167, device='cuda:2')
compute similarity is  tensor(0.9203, device='cuda:2')
calculated distance threshold is  tensor(953.0283, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7716666668229935
inner product is  tensor(184.7282, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8019500001563253
inner product is  tensor(184.8075, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7683666668229935
inner product is  tensor(184.5063, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7600833334896605
inner product is  tensor(186.5469, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.8025166668229919
inner product is  tensor(188.8615, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7639666668229937
inner product is  tensor(184.2366, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6196333334896693
inner product is  tensor(184.7633, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6689500001563324
inner product is  tensor(187.1544, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.6275500001563354
inner product is  tensor(189.5327, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  3
round is  0
accuracy is  0.6836166668229982
inner product is  tensor(186.3473, device='cuda:2')
====================
====================
iteration is  3
round is  1
accuracy is  0.7167166668229963
inner product is  tensor(188.9721, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.7357000001563285
inner product is  tensor(188.1573, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.16350000015633429
inner product is  tensor(192.2713, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2934.7808, device='cuda:2')
test similarity is  tensor(0.6032, device='cuda:2')
test acc is  0.16350000015633429
test loss is 23.3502644638517
test entropy is  0.16537209041019493
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16537209041019493
avg test loss is  23.3502644638517
avg accuracy is  0.16350000015633429
compute_distance is  tensor(2934.7808, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 80.33% 

Test Accuracy: 79.04% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(3.0786, device='cuda:2')
diff2 is tensor(3.0786, device='cuda:2')
diff1 is tensor(0.8325, device='cuda:2')
diff2 is tensor(0.8325, device='cuda:2')
diff1 is tensor(-5.1171, device='cuda:2')
diff2 is tensor(-5.1171, device='cuda:2')
diff1 is tensor(-0.1885, device='cuda:2')
diff2 is tensor(-0.1885, device='cuda:2')
diff1 is tensor(-0.0176, device='cuda:2')
diff2 is tensor(-0.0176, device='cuda:2')
diff1 is tensor(4.0233e-07, device='cuda:2')
diff2 is tensor(4.0233e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(937.1821, device='cuda:2')
compute similarity is  tensor(0.9199, device='cuda:2')
compute distance is  tensor(929.7784, device='cuda:2')
compute similarity is  tensor(0.9205, device='cuda:2')
compute distance is  tensor(940.1891, device='cuda:2')
compute similarity is  tensor(0.9196, device='cuda:2')
compute distance is  tensor(931.1732, device='cuda:2')
compute similarity is  tensor(0.9206, device='cuda:2')
compute distance is  tensor(935.9048, device='cuda:2')
compute similarity is  tensor(0.9201, device='cuda:2')
compute distance is  tensor(943.5488, device='cuda:2')
compute similarity is  tensor(0.9187, device='cuda:2')
compute distance is  tensor(934.5830, device='cuda:2')
compute similarity is  tensor(0.9202, device='cuda:2')
compute distance is  tensor(943.4524, device='cuda:2')
compute similarity is  tensor(0.9190, device='cuda:2')
compute distance is  tensor(936.4109, device='cuda:2')
compute similarity is  tensor(0.9198, device='cuda:2')
compute distance is  tensor(937.2865, device='cuda:2')
compute similarity is  tensor(0.9200, device='cuda:2')
compute distance is  tensor(944.4583, device='cuda:2')
compute similarity is  tensor(0.9193, device='cuda:2')
compute distance is  tensor(934.5002, device='cuda:2')
compute similarity is  tensor(0.9203, device='cuda:2')
calculated distance threshold is  tensor(944.4583, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.786450000156326
inner product is  tensor(216.2966, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7883500001563258
inner product is  tensor(216.3689, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8135000001563248
inner product is  tensor(216.8496, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7394500001563283
inner product is  tensor(224.4662, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7624666668229939
inner product is  tensor(218.5806, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.6118500001563367
inner product is  tensor(211.1180, device='cuda:2')
====================
succ_min + 1
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.682483333489665
inner product is  tensor(221.0449, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.740966666822995
inner product is  tensor(228.1401, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.6855833334896648
inner product is  tensor(217.1940, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.13873333348966546
inner product is  tensor(232.3774, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.1504166668229999
inner product is  tensor(226.7323, device='cuda:2')
====================
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2955.6909, device='cuda:2')
test similarity is  tensor(0.6142, device='cuda:2')
test acc is  0.13873333348966546
test loss is 26.837401231468867
test entropy is  0.053747180073377074
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.053747180073377074
avg test loss is  26.837401231468867
avg accuracy is  0.13873333348966546
compute_distance is  tensor(2955.6909, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 80.87% 

Test Accuracy: 80.09% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.8107, device='cuda:2')
diff2 is tensor(-0.8107, device='cuda:2')
diff1 is tensor(-1.3212, device='cuda:2')
diff2 is tensor(-1.3212, device='cuda:2')
diff1 is tensor(-26.5064, device='cuda:2')
diff2 is tensor(-26.5064, device='cuda:2')
diff1 is tensor(-0.6029, device='cuda:2')
diff2 is tensor(-0.6029, device='cuda:2')
diff1 is tensor(0.0214, device='cuda:2')
diff2 is tensor(0.0214, device='cuda:2')
diff1 is tensor(-6.5193e-07, device='cuda:2')
diff2 is tensor(-6.5193e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(994.6079, device='cuda:2')
compute similarity is  tensor(0.9102, device='cuda:2')
compute distance is  tensor(996.1035, device='cuda:2')
compute similarity is  tensor(0.9103, device='cuda:2')
compute distance is  tensor(1001.5158, device='cuda:2')
compute similarity is  tensor(0.9098, device='cuda:2')
compute distance is  tensor(1001.8723, device='cuda:2')
compute similarity is  tensor(0.9098, device='cuda:2')
compute distance is  tensor(1002.5029, device='cuda:2')
compute similarity is  tensor(0.9098, device='cuda:2')
compute distance is  tensor(1002.6325, device='cuda:2')
compute similarity is  tensor(0.9098, device='cuda:2')
compute distance is  tensor(1008.8321, device='cuda:2')
compute similarity is  tensor(0.9090, device='cuda:2')
compute distance is  tensor(1003.7698, device='cuda:2')
compute similarity is  tensor(0.9095, device='cuda:2')
compute distance is  tensor(999.2226, device='cuda:2')
compute similarity is  tensor(0.9101, device='cuda:2')
compute distance is  tensor(999.0593, device='cuda:2')
compute similarity is  tensor(0.9100, device='cuda:2')
compute distance is  tensor(999.2007, device='cuda:2')
compute similarity is  tensor(0.9100, device='cuda:2')
compute distance is  tensor(1011.9338, device='cuda:2')
compute similarity is  tensor(0.9088, device='cuda:2')
calculated distance threshold is  tensor(1011.9338, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.801016666822992
inner product is  tensor(327.5451, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7979166668229922
inner product is  tensor(325.5160, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8163500001563246
inner product is  tensor(327.7066, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7590500001563274
inner product is  tensor(332.0782, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.8198000001563246
inner product is  tensor(328.9928, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.7878166668229926
inner product is  tensor(325.3896, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4553666668230083
inner product is  tensor(338.0552, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.7747500001563267
inner product is  tensor(331.5226, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.704666666822997
inner product is  tensor(314.2257, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.09653333348966534
inner product is  tensor(351.7513, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.20488333348966994
inner product is  tensor(326.1128, device='cuda:2')
====================
====================
iteration is  3
round is  2
accuracy is  0.13150000015633193
inner product is  tensor(326.4238, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.32600000015634
inner product is  tensor(323.3423, device='cuda:2')
====================
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2928.8604, device='cuda:2')
test similarity is  tensor(0.6267, device='cuda:2')
test acc is  0.09653333348966534
test loss is 29.925463121328782
test entropy is  0.07796228058072233
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07796228058072233
avg test loss is  29.925463121328782
avg accuracy is  0.09653333348966534
compute_distance is  tensor(2928.8604, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 81.87% 

Test Accuracy: 81.32% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.5467, device='cuda:2')
diff2 is tensor(0.5467, device='cuda:2')
diff1 is tensor(-0.0083, device='cuda:2')
diff2 is tensor(-0.0083, device='cuda:2')
diff1 is tensor(-15.0543, device='cuda:2')
diff2 is tensor(-15.0543, device='cuda:2')
diff1 is tensor(0.8344, device='cuda:2')
diff2 is tensor(0.8344, device='cuda:2')
diff1 is tensor(-0.0080, device='cuda:2')
diff2 is tensor(-0.0080, device='cuda:2')
diff1 is tensor(9.6858e-08, device='cuda:2')
diff2 is tensor(9.6858e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(961.5890, device='cuda:2')
compute similarity is  tensor(0.9167, device='cuda:2')
compute distance is  tensor(955.3940, device='cuda:2')
compute similarity is  tensor(0.9173, device='cuda:2')
compute distance is  tensor(964.4931, device='cuda:2')
compute similarity is  tensor(0.9163, device='cuda:2')
compute distance is  tensor(960.1898, device='cuda:2')
compute similarity is  tensor(0.9168, device='cuda:2')
compute distance is  tensor(961.4133, device='cuda:2')
compute similarity is  tensor(0.9170, device='cuda:2')
compute distance is  tensor(962.9756, device='cuda:2')
compute similarity is  tensor(0.9167, device='cuda:2')
compute distance is  tensor(963.6714, device='cuda:2')
compute similarity is  tensor(0.9165, device='cuda:2')
compute distance is  tensor(962.0115, device='cuda:2')
compute similarity is  tensor(0.9170, device='cuda:2')
compute distance is  tensor(961.8793, device='cuda:2')
compute similarity is  tensor(0.9168, device='cuda:2')
compute distance is  tensor(958.4774, device='cuda:2')
compute similarity is  tensor(0.9172, device='cuda:2')
compute distance is  tensor(967.4184, device='cuda:2')
compute similarity is  tensor(0.9163, device='cuda:2')
compute distance is  tensor(961.8875, device='cuda:2')
compute similarity is  tensor(0.9168, device='cuda:2')
calculated distance threshold is  tensor(967.4184, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8169500001563247
inner product is  tensor(114.9281, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8123000001563249
inner product is  tensor(115.5378, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8054666668229918
inner product is  tensor(116.2285, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7956666668229924
inner product is  tensor(117.3307, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.7998500001563255
inner product is  tensor(117.7210, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.8025166668229919
inner product is  tensor(115.8300, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.658800000156333
inner product is  tensor(112.2122, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.7461166668229946
inner product is  tensor(125.0100, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.5212666668230088
inner product is  tensor(119.2372, device='cuda:2')
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3837666668230076
inner product is  tensor(133.3044, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.18943333348966923
inner product is  tensor(121.2733, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.23611666682300447
inner product is  tensor(110.4240, device='cuda:2')
====================
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2946.5146, device='cuda:2')
test similarity is  tensor(0.6175, device='cuda:2')
test acc is  0.18943333348966923
test loss is 21.16803985363893
test entropy is  0.11708797355180484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11708797355180484
avg test loss is  21.16803985363893
avg accuracy is  0.18943333348966923
compute_distance is  tensor(2946.5146, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 81.78% 

Test Accuracy: 81.07% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-4.6545, device='cuda:2')
diff2 is tensor(-4.6545, device='cuda:2')
diff1 is tensor(0.1442, device='cuda:2')
diff2 is tensor(0.1442, device='cuda:2')
diff1 is tensor(-3.4367, device='cuda:2')
diff2 is tensor(-3.4367, device='cuda:2')
diff1 is tensor(-0.5392, device='cuda:2')
diff2 is tensor(-0.5392, device='cuda:2')
diff1 is tensor(0.0230, device='cuda:2')
diff2 is tensor(0.0230, device='cuda:2')
diff1 is tensor(1.0431e-07, device='cuda:2')
diff2 is tensor(1.0431e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(998.1013, device='cuda:2')
compute similarity is  tensor(0.9117, device='cuda:2')
compute distance is  tensor(994.3332, device='cuda:2')
compute similarity is  tensor(0.9123, device='cuda:2')
compute distance is  tensor(1002.0347, device='cuda:2')
compute similarity is  tensor(0.9112, device='cuda:2')
compute distance is  tensor(995.2174, device='cuda:2')
compute similarity is  tensor(0.9119, device='cuda:2')
compute distance is  tensor(1002.7056, device='cuda:2')
compute similarity is  tensor(0.9112, device='cuda:2')
compute distance is  tensor(999.3646, device='cuda:2')
compute similarity is  tensor(0.9116, device='cuda:2')
compute distance is  tensor(1001.1308, device='cuda:2')
compute similarity is  tensor(0.9114, device='cuda:2')
compute distance is  tensor(1004.2356, device='cuda:2')
compute similarity is  tensor(0.9111, device='cuda:2')
compute distance is  tensor(999.5609, device='cuda:2')
compute similarity is  tensor(0.9113, device='cuda:2')
compute distance is  tensor(996.7371, device='cuda:2')
compute similarity is  tensor(0.9118, device='cuda:2')
compute distance is  tensor(1003.3237, device='cuda:2')
compute similarity is  tensor(0.9114, device='cuda:2')
compute distance is  tensor(1005.0095, device='cuda:2')
compute similarity is  tensor(0.9110, device='cuda:2')
calculated distance threshold is  tensor(1005.0095, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8113666668229916
inner product is  tensor(264.3412, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8112166668229915
inner product is  tensor(263.9556, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8078166668229917
inner product is  tensor(262.3463, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7935500001563256
inner product is  tensor(261.6001, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.8094666668229917
inner product is  tensor(268.1976, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.8019166668229919
inner product is  tensor(265.2425, device='cuda:2')
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7394333334896617
inner product is  tensor(273.8223, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.7329000001563287
inner product is  tensor(260.5032, device='cuda:2')
====================
====================
iteration is  2
round is  2
accuracy is  0.47486666682300854
inner product is  tensor(262.6112, device='cuda:2')
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3236333334896733
inner product is  tensor(278.3693, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2714333334896722
inner product is  tensor(254.6680, device='cuda:2')
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.32705000015634
inner product is  tensor(267.9028, device='cuda:2')
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.35436666682300716
inner product is  tensor(271.9712, device='cuda:2')
====================
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(2927.5740, device='cuda:2')
test similarity is  tensor(0.6292, device='cuda:2')
test acc is  0.2714333334896722
test loss is 17.113442374190797
test entropy is  0.10880867765148057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.10880867765148057
avg test loss is  17.113442374190797
avg accuracy is  0.2714333334896722
compute_distance is  tensor(2927.5740, device='cuda:2')
++++++++++++++++++++
reach max round
optimization failed
new distance ratio is 1
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 81.75% 

Test Accuracy: 80.94% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 81.75%
|----0th round Training Accuracy : 83.05%
|----1th round Training Accuracy : 86.11%
|----2th round Training Accuracy : 87.22%
|----3th round Training Accuracy : 87.43%
|----4th round Training Accuracy : 87.45%
|----5th round Training Accuracy : 87.99%
|----6th round Training Accuracy : 87.55%
|----7th round Training Accuracy : 87.99%
|----8th round Training Accuracy : 88.62%
|----9th round Training Accuracy : 88.56%
|----10th round Training Accuracy : 88.34%
|----11th round Training Accuracy : 87.26%
|----12th round Training Accuracy : 47.61%
|----13th round Training Accuracy : 79.26%
|----14th round Training Accuracy : 81.87%
|----15th round Training Accuracy : 78.30%
|----16th round Training Accuracy : 75.69%
|----17th round Training Accuracy : 79.14%
|----18th round Training Accuracy : 78.82%
|----19th round Training Accuracy : 81.45%
|----20th round Training Accuracy : 80.62%
|----21th round Training Accuracy : 82.26%
|----22th round Training Accuracy : 79.97%
|----23th round Training Accuracy : 81.97%
|----24th round Training Accuracy : 79.14%
|----25th round Training Accuracy : 81.46%
|----26th round Training Accuracy : 81.48%
|----27th round Training Accuracy : 84.25%
|----28th round Training Accuracy : 73.00%
|----29th round Training Accuracy : 80.54%
|----30th round Training Accuracy : 80.93%
|----31th round Training Accuracy : 79.47%
|----32th round Training Accuracy : 81.48%
|----33th round Training Accuracy : 75.47%
|----34th round Training Accuracy : 80.64%
|----35th round Training Accuracy : 82.66%
|----36th round Training Accuracy : 80.95%
|----37th round Training Accuracy : 78.83%
|----38th round Training Accuracy : 79.75%
|----39th round Training Accuracy : 82.38%
|----40th round Training Accuracy : 82.33%
|----41th round Training Accuracy : 83.16%
|----42th round Training Accuracy : 81.50%
|----43th round Training Accuracy : 81.16%
|----44th round Training Accuracy : 79.88%
|----45th round Training Accuracy : 80.33%
|----46th round Training Accuracy : 80.87%
|----47th round Training Accuracy : 81.87%
|----48th round Training Accuracy : 81.78%
|----49th round Training Accuracy : 81.75%
|----Final Test Accuracy: 80.94%
|----0th round Final Test Accuracy : 82.56%
|----1th round Final Test Accuracy : 85.20%
|----2th round Final Test Accuracy : 85.99%
|----3th round Final Test Accuracy : 86.05%
|----4th round Final Test Accuracy : 86.14%
|----5th round Final Test Accuracy : 86.59%
|----6th round Final Test Accuracy : 86.46%
|----7th round Final Test Accuracy : 86.79%
|----8th round Final Test Accuracy : 87.31%
|----9th round Final Test Accuracy : 87.19%
|----10th round Final Test Accuracy : 87.12%
|----11th round Final Test Accuracy : 86.65%
|----12th round Final Test Accuracy : 46.74%
|----13th round Final Test Accuracy : 79.26%
|----14th round Final Test Accuracy : 80.90%
|----15th round Final Test Accuracy : 77.45%
|----16th round Final Test Accuracy : 75.03%
|----17th round Final Test Accuracy : 78.68%
|----18th round Final Test Accuracy : 77.84%
|----19th round Final Test Accuracy : 80.44%
|----20th round Final Test Accuracy : 80.27%
|----21th round Final Test Accuracy : 81.33%
|----22th round Final Test Accuracy : 79.52%
|----23th round Final Test Accuracy : 80.99%
|----24th round Final Test Accuracy : 79.00%
|----25th round Final Test Accuracy : 80.42%
|----26th round Final Test Accuracy : 80.51%
|----27th round Final Test Accuracy : 83.09%
|----28th round Final Test Accuracy : 71.42%
|----29th round Final Test Accuracy : 78.92%
|----30th round Final Test Accuracy : 79.56%
|----31th round Final Test Accuracy : 77.78%
|----32th round Final Test Accuracy : 80.24%
|----33th round Final Test Accuracy : 74.19%
|----34th round Final Test Accuracy : 79.29%
|----35th round Final Test Accuracy : 81.64%
|----36th round Final Test Accuracy : 79.81%
|----37th round Final Test Accuracy : 77.79%
|----38th round Final Test Accuracy : 78.51%
|----39th round Final Test Accuracy : 81.40%
|----40th round Final Test Accuracy : 81.30%
|----41th round Final Test Accuracy : 81.95%
|----42th round Final Test Accuracy : 79.60%
|----43th round Final Test Accuracy : 79.87%
|----44th round Final Test Accuracy : 78.76%
|----45th round Final Test Accuracy : 79.04%
|----46th round Final Test Accuracy : 80.09%
|----47th round Final Test Accuracy : 81.32%
|----48th round Final Test Accuracy : 81.07%
|----49th round Final Test Accuracy : 80.94%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 15133.2710
