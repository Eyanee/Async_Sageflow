
Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 2, 4, 5, 6, 7, 41, 42, 43, 44, 45, 46, 47, 48]
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 41.23% 

Test Accuracy: 47.47% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.011748901568353176
 benign empirical indicaor res is  0.011748901568353176
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 41, 42, 43, 44, 45, 46, 47, 48, 8, 10, 11, 12, 13, 15]
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 61.86% 

Test Accuracy: 64.54% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.011394990608096123
 benign empirical indicaor res is  0.011394990608096123
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 2, 3, 4, 5, 6, 40, 41, 43, 44, 45, 46, 47, 48, 49, 17, 18, 19, 20, 21, 23]
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.65% 

Test Accuracy: 88.66% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.004200058523565531
 benign empirical indicaor res is  0.004200058523565531
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 28, 29, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 91.32% 

Test Accuracy: 91.72% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.010899018496274948
 benign empirical indicaor res is  0.010899018496274948
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 36, 39]
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.59% 

Test Accuracy: 88.13% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.005141901317983866
 benign empirical indicaor res is  0.005141901317983866
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 21, 8, 9, 10, 11, 12, 15]
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 91.56% 

Test Accuracy: 91.20% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.007116741966456175
 benign empirical indicaor res is  0.007116741966456175
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.86% 

Test Accuracy: 88.58% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.007081455085426569
 benign empirical indicaor res is  0.007081455085426569
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 48, 24, 25, 26, 28, 29, 30, 31, 8, 9, 11, 12, 14, 15]
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 90.47% 

Test Accuracy: 90.49% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0008011796162463725
 benign empirical indicaor res is  0.0008011796162463725
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 21]
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 92.69% 

Test Accuracy: 92.97% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0026243524625897408
 benign empirical indicaor res is  0.0026243524625897408
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 34, 36, 39, 9, 11, 12, 13, 14, 15]
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 95.10% 

Test Accuracy: 95.02% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0028135953471064568
 benign empirical indicaor res is  0.0028135953471064568
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 94.35% 

Test Accuracy: 94.75% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0042109182104468346
 benign empirical indicaor res is  0.0042109182104468346
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 7, 40, 41, 43, 44, 45, 46, 47, 49, 24, 25, 26, 27, 28, 29, 30, 31, 17, 18, 19, 20, 21, 23, 8, 9, 10, 11, 12, 14]
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 94.97% 

Test Accuracy: 94.92% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  1.0634358659444842e-05
 benign empirical indicaor res is  1.0634358659444842e-05
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 95.03% 

Test Accuracy: 95.30% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.003935697954148054
 benign empirical indicaor res is  0.003935697954148054
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 2, 4, 5, 6, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 11, 12, 14, 15]
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 96.43% 

Test Accuracy: 96.42% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.003187155816704035
 benign empirical indicaor res is  0.003187155816704035
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 34, 36, 37, 38, 39, 16, 17, 18, 19, 21]
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 96.04% 

Test Accuracy: 96.31% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0003246862906962633
 benign empirical indicaor res is  0.0003246862906962633
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 24, 26, 27, 28, 29, 30, 31, 8, 11, 12, 14, 15]
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 95.82% 

Test Accuracy: 95.87% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.00208554626442492
 benign empirical indicaor res is  0.00208554626442492
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 43, 44, 45, 46, 47, 49]
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 96.03% 

Test Accuracy: 96.12% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.00302311684936285
 benign empirical indicaor res is  0.00302311684936285
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49, 16, 17, 18, 19, 20, 21, 23, 8, 9, 11, 12, 14, 15]
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 96.80% 

Test Accuracy: 96.71% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0011960669653490186
 benign empirical indicaor res is  0.0011960669653490186
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49]
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 94.79% 

Test Accuracy: 94.96% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
compare_res is  0.0030772732570767403
 benign empirical indicaor res is  0.0030772732570767403
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 49, 32, 34, 35, 36, 37, 39, 24, 25, 26, 27, 28, 29, 30, 31, 9, 11, 12, 14, 15]
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 96.75% 

Test Accuracy: 96.73% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
poisoned accuracy threshold is  0.8173000001570008
distance ratio is <class 'float'>
len of model dicts is  10
compute distance is  tensor(23.1837, device='cuda:3')
compute distance is  tensor(25.2042, device='cuda:3')
compute distance is  tensor(54.3719, device='cuda:3')
compute distance is  tensor(31.3904, device='cuda:3')
compute distance is  tensor(34.3111, device='cuda:3')
compute distance is  tensor(30.3715, device='cuda:3')
compute distance is  tensor(56.1034, device='cuda:3')
compute distance is  tensor(25.5030, device='cuda:3')
compute distance is  tensor(80.2994, device='cuda:3')
compute distance is  tensor(74.2467, device='cuda:3')
calculated distance threshold is  tensor(68.8763, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.37916666682300754
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2818666668230058
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.28113333348967245
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.32070000015633987
====================
====================
iteration is  1
round is  1
accuracy is  0.33323333348967354
====================
________________________________
test distance is  tensor(4282.1143, device='cuda:3')
test acc is  0.28113333348967245
test entropy is  0.31451975911665064
________________________________
diff is  tensor(43.7041, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3096, device='cuda:3', dtype=torch.float64)
diff is  tensor(572.5710, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4773, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.5702, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0199, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3022, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1599, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4213.2378, device='cuda:3')
sum is tensor(0.1599, device='cuda:3', dtype=torch.float64)
sum is tensor(0.4694, device='cuda:3', dtype=torch.float64)
sum is tensor(0.9467, device='cuda:3', dtype=torch.float64)
sum is tensor(2.9666, device='cuda:3', dtype=torch.float64)
sum is tensor(23.2688, device='cuda:3', dtype=torch.float64)
sum is tensor(66.9729, device='cuda:3', dtype=torch.float64)
sum is tensor(639.5439, device='cuda:3', dtype=torch.float64)
sum is tensor(4282.1141, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0189, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.5702, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.7041, device='cuda:3')
discard
cal diff is tensor(0.3096, device='cuda:3')
discard
cal diff is tensor(572.5710, device='cuda:3')
discard
cal diff is tensor(0.4773, device='cuda:3')
discard
cal diff is tensor(3642.5703, device='cuda:3')
clipping
cal diff is tensor(2.0199, device='cuda:3')
discard
cal diff is tensor(20.3022, device='cuda:3')
discard
cal diff is tensor(0.1599, device='cuda:3')
discard
________________________________
test distance is  tensor(68.8865, device='cuda:3')
test acc is  0.9659500001563193
test entropy is  0.17921377376897502
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(68.8763, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0102, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
ratio is tensor(0.0004, device='cuda:3')
threshold is tensor(0.0091, device='cuda:3')
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
clipping
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(68.8763, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0752, device='cuda:3')
test acc is  0.9659333334896526
test entropy is  0.17875700343106346
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17875700343106346
avg test loss is  0.11435520218840159
avg accuracy is  0.9659333334896526
compute_distance is  tensor(0.0752, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3230533195234565
avg test loss is  6.000647215955039
avg accuracy is  0.2872166668230059
compute_distance is  tensor(93.7027, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(93.7027, device='cuda:3')
test acc is  0.2872166668230059
test entropy is  0.3230533195234565
________________________________
diff is  tensor(0.7006, device='cuda:3')
diff is  tensor(0.0079, device='cuda:3')
diff is  tensor(15.0428, device='cuda:3')
diff is  tensor(0.0153, device='cuda:3')
diff is  tensor(77.4242, device='cuda:3')
diff is  tensor(0.0355, device='cuda:3')
diff is  tensor(0.4574, device='cuda:3')
diff is  tensor(0.0031, device='cuda:3')
threshold is  tensor(24.8264, device='cuda:3')
sum is tensor(0.0031, device='cuda:3')
sum is tensor(0.0110, device='cuda:3')
sum is tensor(0.0263, device='cuda:3')
sum is tensor(0.0618, device='cuda:3')
sum is tensor(0.5192, device='cuda:3')
sum is tensor(1.2199, device='cuda:3')
sum is tensor(16.2626, device='cuda:3')
sum is tensor(93.6868, device='cuda:3')
ratio is tensor(0.8894, device='cuda:3')
threshold is tensor(77.4242, device='cuda:3')
cal diff is tensor(0.7006, device='cuda:3')
discard
cal diff is tensor(0.0079, device='cuda:3')
discard
cal diff is tensor(15.0428, device='cuda:3')
discard
cal diff is tensor(0.0153, device='cuda:3')
discard
cal diff is tensor(77.4242, device='cuda:3')
clipping
cal diff is tensor(0.0355, device='cuda:3')
discard
cal diff is tensor(0.4574, device='cuda:3')
discard
cal diff is tensor(0.0031, device='cuda:3')
discard
________________________________
test distance is  tensor(68.8734, device='cuda:3')
test acc is  0.6824833334896652
test entropy is  0.4347832324757759
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 17, 18, 19, 21]
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 79.12% 

Test Accuracy: 74.28% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.006042417138814926
len of model dicts is  10
compute distance is  tensor(33.8205, device='cuda:3')
compute distance is  tensor(64.7882, device='cuda:3')
compute distance is  tensor(61.9707, device='cuda:3')
compute distance is  tensor(113.7116, device='cuda:3')
compute distance is  tensor(100.5697, device='cuda:3')
compute distance is  tensor(64.1117, device='cuda:3')
compute distance is  tensor(96.6341, device='cuda:3')
compute distance is  tensor(63.5617, device='cuda:3')
compute distance is  tensor(94.1499, device='cuda:3')
compute distance is  tensor(10.1657, device='cuda:3')
calculated distance threshold is  tensor(93.0024, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.2698500001563388
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3429333334896737
====================
====================
iteration is  0
round is  2
accuracy is  0.29841666682300616
====================
====================
iteration is  1
round is  0
accuracy is  0.30625000015633963
====================
====================
iteration is  1
round is  1
accuracy is  0.1920666668230026
====================
succ_min + 1
________________________________
test distance is  tensor(4281.8457, device='cuda:3')
test acc is  0.1920666668230026
test entropy is  0.27172528502783544
________________________________
diff is  tensor(44.7948, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2929, device='cuda:3', dtype=torch.float64)
diff is  tensor(570.9380, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5041, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.7832, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0289, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3142, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4188.8433, device='cuda:3')
sum is tensor(0.1901, device='cuda:3', dtype=torch.float64)
sum is tensor(0.4831, device='cuda:3', dtype=torch.float64)
sum is tensor(0.9871, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0160, device='cuda:3', dtype=torch.float64)
sum is tensor(23.3302, device='cuda:3', dtype=torch.float64)
sum is tensor(68.1250, device='cuda:3', dtype=torch.float64)
sum is tensor(639.0630, device='cuda:3', dtype=torch.float64)
sum is tensor(4281.8462, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0255, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.7832, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.7948, device='cuda:3')
discard
cal diff is tensor(0.2929, device='cuda:3')
discard
cal diff is tensor(570.9380, device='cuda:3')
discard
cal diff is tensor(0.5041, device='cuda:3')
discard
cal diff is tensor(3642.7832, device='cuda:3')
clipping
cal diff is tensor(2.0289, device='cuda:3')
discard
cal diff is tensor(20.3142, device='cuda:3')
discard
cal diff is tensor(0.1901, device='cuda:3')
discard
________________________________
test distance is  tensor(93.0132, device='cuda:3')
test acc is  0.739566666822995
test entropy is  0.28169933704933375
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(93.0029, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0108, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
sum is tensor(93.0132, device='cuda:3')
ratio is tensor(1.0000, device='cuda:3', dtype=torch.float64)
threshold is tensor(93.0029, device='cuda:3', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
discard
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(93.0029, device='cuda:3')
clipping
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(93.0126, device='cuda:3')
test acc is  0.739566666822995
test entropy is  0.2816994349235919
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(93.0024, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0102, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
sum is tensor(93.0126, device='cuda:3')
ratio is tensor(1.0000, device='cuda:3', dtype=torch.float64)
threshold is tensor(93.0024, device='cuda:3', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
discard
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(93.0024, device='cuda:3')
discard
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.7392833334896617
test entropy is  0.2800298975125305
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 11, 12, 14]
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.30% 

Test Accuracy: 84.36% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.007130354642868042
len of model dicts is  10
compute distance is  tensor(33.0208, device='cuda:3')
compute distance is  tensor(68.7476, device='cuda:3')
compute distance is  tensor(84.2660, device='cuda:3')
compute distance is  tensor(104.0245, device='cuda:3')
compute distance is  tensor(68.0123, device='cuda:3')
compute distance is  tensor(51.8830, device='cuda:3')
compute distance is  tensor(86.0277, device='cuda:3')
compute distance is  tensor(59.8721, device='cuda:3')
compute distance is  tensor(73.6214, device='cuda:3')
compute distance is  tensor(11.8691, device='cuda:3')
calculated distance threshold is  tensor(85.5934, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.32745000015634007
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24513333348967148
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3547166668230071
====================
====================
iteration is  1
round is  0
accuracy is  0.36615000015634064
====================
====================
iteration is  1
round is  1
accuracy is  0.17451666682300157
====================
succ_min + 1
________________________________
test distance is  tensor(4281.7632, device='cuda:3')
test acc is  0.17451666682300157
test entropy is  0.1021235599510197
________________________________
diff is  tensor(44.1419, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4088, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.1321, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4969, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.0505, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0374, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2842, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2109, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4196.1699, device='cuda:3')
sum is tensor(0.2109, device='cuda:3', dtype=torch.float64)
sum is tensor(0.6198, device='cuda:3', dtype=torch.float64)
sum is tensor(1.1167, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1541, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4383, device='cuda:3', dtype=torch.float64)
sum is tensor(67.5802, device='cuda:3', dtype=torch.float64)
sum is tensor(640.7123, device='cuda:3', dtype=torch.float64)
sum is tensor(4281.7628, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0235, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.0505, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.1419, device='cuda:3')
discard
cal diff is tensor(0.4088, device='cuda:3')
discard
cal diff is tensor(573.1321, device='cuda:3')
discard
cal diff is tensor(0.4969, device='cuda:3')
discard
cal diff is tensor(3641.0505, device='cuda:3')
discard
cal diff is tensor(2.0374, device='cuda:3')
discard
cal diff is tensor(20.2842, device='cuda:3')
discard
cal diff is tensor(0.2109, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.8485666668229901
test entropy is  0.2157192089156047
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2157192089156047
avg test loss is  0.4997759277680154
avg accuracy is  0.8485666668229901
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.08398219660075425
avg test loss is  9.492978187512232
avg accuracy is  0.1676333334896678
compute_distance is  tensor(85.5216, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(85.5216, device='cuda:3')
test acc is  0.1676333334896678
test entropy is  0.08398219660075425
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 83.83% 

Test Accuracy: 79.89% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.009131130762398243
len of model dicts is  10
compute distance is  tensor(39.1972, device='cuda:3')
compute distance is  tensor(82.4769, device='cuda:3')
compute distance is  tensor(97.5623, device='cuda:3')
compute distance is  tensor(88.6472, device='cuda:3')
compute distance is  tensor(92.1014, device='cuda:3')
compute distance is  tensor(49.5771, device='cuda:3')
compute distance is  tensor(115.9785, device='cuda:3')
compute distance is  tensor(68.2965, device='cuda:3')
compute distance is  tensor(67.9370, device='cuda:3')
compute distance is  tensor(5.5356, device='cuda:3')
calculated distance threshold is  tensor(93.8899, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.23960000015633795
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.27693333348967236
====================
====================
iteration is  0
round is  2
accuracy is  0.2500000001563383
====================
====================
iteration is  1
round is  0
accuracy is  0.3108666668230064
====================
====================
iteration is  1
round is  1
accuracy is  0.3137666668230065
====================
________________________________
test distance is  tensor(4282.6172, device='cuda:3')
test acc is  0.23960000015633795
test entropy is  0.18455441049071772
________________________________
diff is  tensor(43.3553, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3872, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.8495, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5272, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.9505, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0349, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3360, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1768, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4188.7271, device='cuda:3')
sum is tensor(0.1768, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5640, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0911, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1261, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4620, device='cuda:3', dtype=torch.float64)
sum is tensor(66.8174, device='cuda:3', dtype=torch.float64)
sum is tensor(640.6668, device='cuda:3', dtype=torch.float64)
sum is tensor(4282.6173, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0258, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.9505, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.3553, device='cuda:3')
discard
cal diff is tensor(0.3872, device='cuda:3')
discard
cal diff is tensor(573.8494, device='cuda:3')
discard
cal diff is tensor(0.5272, device='cuda:3')
discard
cal diff is tensor(3641.9504, device='cuda:3')
discard
cal diff is tensor(2.0349, device='cuda:3')
discard
cal diff is tensor(20.3360, device='cuda:3')
discard
cal diff is tensor(0.1768, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.7958500001563256
test entropy is  0.18753212663347024
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 17, 19, 21, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 92.48% 

Test Accuracy: 90.76% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.008063772693276405
len of model dicts is  10
compute distance is  tensor(26.1343, device='cuda:3')
compute distance is  tensor(51.0300, device='cuda:3')
compute distance is  tensor(66.8233, device='cuda:3')
compute distance is  tensor(69.1654, device='cuda:3')
compute distance is  tensor(35.9024, device='cuda:3')
compute distance is  tensor(38.5520, device='cuda:3')
compute distance is  tensor(67.4385, device='cuda:3')
compute distance is  tensor(49.8968, device='cuda:3')
compute distance is  tensor(91.8474, device='cuda:3')
compute distance is  tensor(14.4767, device='cuda:3')
calculated distance threshold is  tensor(76.3733, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.11958333348966528
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3806500001563409
====================
====================
iteration is  0
round is  2
accuracy is  0.224966666823004
====================
====================
iteration is  1
round is  0
accuracy is  0.4259500001563415
====================
====================
iteration is  1
round is  1
accuracy is  0.4140500001563413
====================
________________________________
test distance is  tensor(4284.0562, device='cuda:3')
test acc is  0.11958333348966528
test entropy is  0.06876442118931109
________________________________
diff is  tensor(43.9839, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3850, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.4999, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5362, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.0559, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0340, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3441, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2166, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4207.6831, device='cuda:3')
sum is tensor(0.2166, device='cuda:3', dtype=torch.float64)
sum is tensor(0.6016, device='cuda:3', dtype=torch.float64)
sum is tensor(1.1378, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1718, device='cuda:3', dtype=torch.float64)
sum is tensor(23.5160, device='cuda:3', dtype=torch.float64)
sum is tensor(67.4998, device='cuda:3', dtype=torch.float64)
sum is tensor(641.9997, device='cuda:3', dtype=torch.float64)
sum is tensor(4284.0556, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0210, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.0559, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.9839, device='cuda:3')
discard
cal diff is tensor(0.3850, device='cuda:3')
discard
cal diff is tensor(574.4999, device='cuda:3')
discard
cal diff is tensor(0.5362, device='cuda:3')
discard
cal diff is tensor(3642.0557, device='cuda:3')
discard
cal diff is tensor(2.0340, device='cuda:3')
discard
cal diff is tensor(20.3441, device='cuda:3')
discard
cal diff is tensor(0.2166, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9079166668229877
test entropy is  0.19054777272887577
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19054777272887577
avg test loss is  0.24752182921549595
avg accuracy is  0.9079166668229877
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.062459132415172994
avg test loss is  9.97311537352198
avg accuracy is  0.11376666682299863
compute_distance is  tensor(85.0201, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(85.0201, device='cuda:3')
test acc is  0.11376666682299863
test entropy is  0.062459132415172994
________________________________
diff is  tensor(0.7086, device='cuda:3')
diff is  tensor(0.0064, device='cuda:3')
diff is  tensor(11.6207, device='cuda:3')
diff is  tensor(0.0129, device='cuda:3')
diff is  tensor(72.1893, device='cuda:3')
diff is  tensor(0.0378, device='cuda:3')
diff is  tensor(0.4338, device='cuda:3')
diff is  tensor(0.0032, device='cuda:3')
threshold is  tensor(8.6468, device='cuda:3')
sum is tensor(0.0032, device='cuda:3')
sum is tensor(0.0096, device='cuda:3')
sum is tensor(0.0225, device='cuda:3')
sum is tensor(0.0603, device='cuda:3')
sum is tensor(0.4941, device='cuda:3')
sum is tensor(1.2027, device='cuda:3')
sum is tensor(12.8234, device='cuda:3')
ratio is tensor(0.3594, device='cuda:3')
threshold is tensor(11.6207, device='cuda:3')
cal diff is tensor(0.7086, device='cuda:3')
discard
cal diff is tensor(0.0064, device='cuda:3')
discard
cal diff is tensor(11.6207, device='cuda:3')
clipping
cal diff is tensor(0.0129, device='cuda:3')
discard
cal diff is tensor(72.1893, device='cuda:3')
clipping
cal diff is tensor(0.0378, device='cuda:3')
discard
cal diff is tensor(0.4338, device='cuda:3')
discard
cal diff is tensor(0.0032, device='cuda:3')
discard
________________________________
test distance is  tensor(30.1281, device='cuda:3')
test acc is  0.7889666668229927
test entropy is  0.238851043103791
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39]
left index is  [0, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 34, 36, 37, 39]
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 89.51% 

Test Accuracy: 87.28% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.008041647262871265
len of model dicts is  10
compute distance is  tensor(36.6270, device='cuda:3')
compute distance is  tensor(72.8098, device='cuda:3')
compute distance is  tensor(80.4825, device='cuda:3')
compute distance is  tensor(75.7515, device='cuda:3')
compute distance is  tensor(70.9147, device='cuda:3')
compute distance is  tensor(45.9963, device='cuda:3')
compute distance is  tensor(97.9732, device='cuda:3')
compute distance is  tensor(59.5642, device='cuda:3')
compute distance is  tensor(96.5351, device='cuda:3')
compute distance is  tensor(11.6750, device='cuda:3')
calculated distance threshold is  tensor(80.7136, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.2929000001563393
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3224333334896733
====================
====================
iteration is  0
round is  2
accuracy is  0.47155000015634185
====================
====================
iteration is  1
round is  0
accuracy is  0.3720500001563407
====================
====================
iteration is  1
round is  1
accuracy is  0.4181833334896747
====================
________________________________
test distance is  tensor(4282.9814, device='cuda:3')
test acc is  0.2929000001563393
test entropy is  0.24341658459924687
________________________________
diff is  tensor(44.2954, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3673, device='cuda:3', dtype=torch.float64)
diff is  tensor(573.2111, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4773, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.9841, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0465, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3914, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2078, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4202.2681, device='cuda:3')
sum is tensor(0.2078, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5751, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0524, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0989, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4902, device='cuda:3', dtype=torch.float64)
sum is tensor(67.7856, device='cuda:3', dtype=torch.float64)
sum is tensor(640.9967, device='cuda:3', dtype=torch.float64)
sum is tensor(4282.9808, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0222, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.9841, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.2954, device='cuda:3')
discard
cal diff is tensor(0.3673, device='cuda:3')
discard
cal diff is tensor(573.2111, device='cuda:3')
discard
cal diff is tensor(0.4773, device='cuda:3')
discard
cal diff is tensor(3641.9839, device='cuda:3')
discard
cal diff is tensor(2.0465, device='cuda:3')
discard
cal diff is tensor(20.3914, device='cuda:3')
discard
cal diff is tensor(0.2078, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.8714833334896558
test entropy is  0.18425193399603942
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18425193399603942
avg test loss is  0.3591392031991914
avg accuracy is  0.8714833334896558
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2708699509565002
avg test loss is  7.4620719083082445
avg accuracy is  0.2961666668230061
compute_distance is  tensor(97.0712, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(97.0712, device='cuda:3')
test acc is  0.2961666668230061
test entropy is  0.2708699509565002
________________________________
diff is  tensor(0.6965, device='cuda:3')
diff is  tensor(0.0069, device='cuda:3')
diff is  tensor(14.8459, device='cuda:3')
diff is  tensor(0.0144, device='cuda:3')
diff is  tensor(80.9973, device='cuda:3')
diff is  tensor(0.0385, device='cuda:3')
diff is  tensor(0.4579, device='cuda:3')
diff is  tensor(0.0036, device='cuda:3')
threshold is  tensor(16.3576, device='cuda:3')
sum is tensor(0.0036, device='cuda:3')
sum is tensor(0.0105, device='cuda:3')
sum is tensor(0.0250, device='cuda:3')
sum is tensor(0.0635, device='cuda:3')
sum is tensor(0.5213, device='cuda:3')
sum is tensor(1.2178, device='cuda:3')
sum is tensor(16.0637, device='cuda:3')
sum is tensor(97.0610, device='cuda:3')
ratio is tensor(0.9964, device='cuda:3')
threshold is tensor(80.9973, device='cuda:3')
cal diff is tensor(0.6965, device='cuda:3')
discard
cal diff is tensor(0.0069, device='cuda:3')
discard
cal diff is tensor(14.8459, device='cuda:3')
discard
cal diff is tensor(0.0144, device='cuda:3')
discard
cal diff is tensor(80.9973, device='cuda:3')
clipping
cal diff is tensor(0.0385, device='cuda:3')
discard
cal diff is tensor(0.4579, device='cuda:3')
discard
cal diff is tensor(0.0036, device='cuda:3')
discard
________________________________
test distance is  tensor(80.7111, device='cuda:3')
test acc is  0.4777833334896752
test entropy is  0.43432155334110706
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 11, 12, 14]
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 84.52% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.010434847325086594
len of model dicts is  10
compute distance is  tensor(39.3692, device='cuda:3')
compute distance is  tensor(63.3344, device='cuda:3')
compute distance is  tensor(117.7022, device='cuda:3')
compute distance is  tensor(92.7539, device='cuda:3')
compute distance is  tensor(67.1549, device='cuda:3')
compute distance is  tensor(53.4139, device='cuda:3')
compute distance is  tensor(81.5679, device='cuda:3')
compute distance is  tensor(70.8766, device='cuda:3')
compute distance is  tensor(110.3830, device='cuda:3')
compute distance is  tensor(7.7166, device='cuda:3')
calculated distance threshold is  tensor(95.7051, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.3394333334896736
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2818333334896724
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3092666668230063
====================
====================
iteration is  1
round is  0
accuracy is  0.3230166668230066
====================
====================
iteration is  1
round is  1
accuracy is  0.29648333348967276
====================
________________________________
test distance is  tensor(4283.1128, device='cuda:3')
test acc is  0.2818333334896724
test entropy is  0.1849859317720953
________________________________
diff is  tensor(43.8952, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3543, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.0347, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5404, device='cuda:3', dtype=torch.float64)
diff is  tensor(3641.7530, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0597, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3048, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1707, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4187.4077, device='cuda:3')
sum is tensor(0.1707, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5250, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0654, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1251, device='cuda:3', dtype=torch.float64)
sum is tensor(23.4299, device='cuda:3', dtype=torch.float64)
sum is tensor(67.3251, device='cuda:3', dtype=torch.float64)
sum is tensor(641.3598, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.1128, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0263, device='cuda:3', dtype=torch.float64)
threshold is tensor(3641.7530, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.8952, device='cuda:3')
discard
cal diff is tensor(0.3543, device='cuda:3')
discard
cal diff is tensor(574.0347, device='cuda:3')
discard
cal diff is tensor(0.5404, device='cuda:3')
discard
cal diff is tensor(3641.7532, device='cuda:3')
clipping
cal diff is tensor(2.0597, device='cuda:3')
discard
cal diff is tensor(20.3048, device='cuda:3')
discard
cal diff is tensor(0.1707, device='cuda:3')
discard
________________________________
test distance is  tensor(95.7153, device='cuda:3')
test acc is  0.8486500001563233
test entropy is  0.16730054618834433
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(95.7052, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0102, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
sum is tensor(95.7154, device='cuda:3')
ratio is tensor(1.0000, device='cuda:3', dtype=torch.float64)
threshold is tensor(95.7052, device='cuda:3', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
discard
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(95.7052, device='cuda:3')
discard
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.84896666682299
test entropy is  0.16757398566552825
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16757398566552825
avg test loss is  0.5054530795655652
avg accuracy is  0.84896666682299
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19010480616424383
avg test loss is  7.195506995674898
avg accuracy is  0.2991000001563395
compute_distance is  tensor(86.6602, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(86.6602, device='cuda:3')
test acc is  0.2991000001563395
test entropy is  0.19010480616424383
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 17, 18, 19, 20, 21, 22]
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 88.83% 

Test Accuracy: 85.02% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.011366719380021095
len of model dicts is  10
compute distance is  tensor(40.3231, device='cuda:3')
compute distance is  tensor(51.4494, device='cuda:3')
compute distance is  tensor(84.7558, device='cuda:3')
compute distance is  tensor(81.3541, device='cuda:3')
compute distance is  tensor(91.5333, device='cuda:3')
compute distance is  tensor(60.2569, device='cuda:3')
compute distance is  tensor(97.1406, device='cuda:3')
compute distance is  tensor(55.1330, device='cuda:3')
compute distance is  tensor(75.3200, device='cuda:3')
compute distance is  tensor(9.7138, device='cuda:3')
calculated distance threshold is  tensor(79.6553, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.4251500001563414
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.28381666682300577
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.3200833334896732
====================
====================
iteration is  1
round is  0
accuracy is  0.3553833334896738
====================
====================
iteration is  1
round is  1
accuracy is  0.3021833334896729
====================
________________________________
test distance is  tensor(4280.4082, device='cuda:3')
test acc is  0.28381666682300577
test entropy is  0.24558836007232604
________________________________
diff is  tensor(44.3457, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3458, device='cuda:3', dtype=torch.float64)
diff is  tensor(571.8583, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.5557, device='cuda:3', dtype=torch.float64)
diff is  tensor(3640.8941, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0201, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2073, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1812, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4200.7529, device='cuda:3')
sum is tensor(0.1812, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5270, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0827, device='cuda:3', dtype=torch.float64)
sum is tensor(3.1029, device='cuda:3', dtype=torch.float64)
sum is tensor(23.3101, device='cuda:3', dtype=torch.float64)
sum is tensor(67.6559, device='cuda:3', dtype=torch.float64)
sum is tensor(639.5141, device='cuda:3', dtype=torch.float64)
sum is tensor(4280.4082, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0219, device='cuda:3', dtype=torch.float64)
threshold is tensor(3640.8941, device='cuda:3', dtype=torch.float64)
cal diff is tensor(44.3457, device='cuda:3')
discard
cal diff is tensor(0.3458, device='cuda:3')
discard
cal diff is tensor(571.8583, device='cuda:3')
discard
cal diff is tensor(0.5557, device='cuda:3')
discard
cal diff is tensor(3640.8940, device='cuda:3')
discard
cal diff is tensor(2.0201, device='cuda:3')
discard
cal diff is tensor(20.2073, device='cuda:3')
discard
cal diff is tensor(0.1812, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.8552000001563231
test entropy is  0.15802649630984264
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15802649630984264
avg test loss is  0.5264224961940159
avg accuracy is  0.8552000001563231
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2776528077720325
avg test loss is  6.640005848300991
avg accuracy is  0.28788333348967254
compute_distance is  tensor(84.4054, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(84.4054, device='cuda:3')
test acc is  0.28788333348967254
test entropy is  0.2776528077720325
________________________________
diff is  tensor(0.6397, device='cuda:3')
diff is  tensor(0.0059, device='cuda:3')
diff is  tensor(12.6027, device='cuda:3')
diff is  tensor(0.0137, device='cuda:3')
diff is  tensor(70.6841, device='cuda:3')
diff is  tensor(0.0344, device='cuda:3')
diff is  tensor(0.4118, device='cuda:3')
diff is  tensor(0.0030, device='cuda:3')
threshold is  tensor(4.7501, device='cuda:3')
sum is tensor(0.0030, device='cuda:3')
sum is tensor(0.0088, device='cuda:3')
sum is tensor(0.0225, device='cuda:3')
sum is tensor(0.0569, device='cuda:3')
sum is tensor(0.4687, device='cuda:3')
sum is tensor(1.1084, device='cuda:3')
sum is tensor(13.7110, device='cuda:3')
ratio is tensor(0.7110, device='cuda:3')
threshold is tensor(12.6027, device='cuda:3')
cal diff is tensor(0.6397, device='cuda:3')
discard
cal diff is tensor(0.0059, device='cuda:3')
discard
cal diff is tensor(12.6027, device='cuda:3')
clipping
cal diff is tensor(0.0137, device='cuda:3')
discard
cal diff is tensor(70.6841, device='cuda:3')
clipping
cal diff is tensor(0.0344, device='cuda:3')
discard
cal diff is tensor(0.4118, device='cuda:3')
discard
cal diff is tensor(0.0030, device='cuda:3')
discard
________________________________
test distance is  tensor(59.2296, device='cuda:3')
test acc is  0.5847500001563388
test entropy is  0.3347242330945631
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 31, 8, 11, 12, 14, 15]
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 93.71% 

Test Accuracy: 92.76% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.012045460753142834
len of model dicts is  10
compute distance is  tensor(33.5613, device='cuda:3')
compute distance is  tensor(68.7904, device='cuda:3')
compute distance is  tensor(92.4289, device='cuda:3')
compute distance is  tensor(66.0914, device='cuda:3')
compute distance is  tensor(49.0334, device='cuda:3')
compute distance is  tensor(79.5153, device='cuda:3')
compute distance is  tensor(60.6717, device='cuda:3')
compute distance is  tensor(57.5821, device='cuda:3')
compute distance is  tensor(78.7935, device='cuda:3')
compute distance is  tensor(11.9279, device='cuda:3')
calculated distance threshold is  tensor(76.3287, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.32678333348967337
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.23480000015633778
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.44093333348967484
====================
====================
iteration is  1
round is  0
accuracy is  0.4665500001563418
====================
====================
iteration is  1
round is  1
accuracy is  0.3499833334896737
====================
________________________________
test distance is  tensor(4283.1401, device='cuda:3')
test acc is  0.23480000015633778
test entropy is  0.19213040698089326
________________________________
diff is  tensor(42.6063, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4002, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.8458, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4836, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.3844, device='cuda:3', dtype=torch.float64)
diff is  tensor(2.0114, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.2196, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.1888, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4206.8115, device='cuda:3')
sum is tensor(0.1888, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5890, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0726, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0841, device='cuda:3', dtype=torch.float64)
sum is tensor(23.3037, device='cuda:3', dtype=torch.float64)
sum is tensor(65.9100, device='cuda:3', dtype=torch.float64)
sum is tensor(640.7558, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.1402, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0210, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.3844, device='cuda:3', dtype=torch.float64)
cal diff is tensor(42.6063, device='cuda:3')
discard
cal diff is tensor(0.4002, device='cuda:3')
discard
cal diff is tensor(574.8458, device='cuda:3')
discard
cal diff is tensor(0.4836, device='cuda:3')
discard
cal diff is tensor(3642.3845, device='cuda:3')
clipping
cal diff is tensor(2.0114, device='cuda:3')
discard
cal diff is tensor(20.2196, device='cuda:3')
discard
cal diff is tensor(0.1888, device='cuda:3')
discard
________________________________
test distance is  tensor(76.3389, device='cuda:3')
test acc is  0.9253666668229871
test entropy is  0.16925537248235395
________________________________
diff is  tensor(0.0008, device='cuda:3')
diff is  tensor(5.6569e-06, device='cuda:3')
diff is  tensor(0.0091, device='cuda:3')
diff is  tensor(8.0000e-06, device='cuda:3')
diff is  tensor(76.3287, device='cuda:3', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:3')
diff is  tensor(0.0003, device='cuda:3')
diff is  tensor(3.1623e-06, device='cuda:3')
threshold is  tensor(0.0102, device='cuda:3')
sum is tensor(3.1623e-06, device='cuda:3')
sum is tensor(8.8191e-06, device='cuda:3')
sum is tensor(1.6819e-05, device='cuda:3')
sum is tensor(4.8819e-05, device='cuda:3')
sum is tensor(0.0004, device='cuda:3')
sum is tensor(0.0012, device='cuda:3')
sum is tensor(0.0102, device='cuda:3')
sum is tensor(76.3389, device='cuda:3')
ratio is tensor(1.0000, device='cuda:3', dtype=torch.float64)
threshold is tensor(76.3287, device='cuda:3', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:3')
discard
cal diff is tensor(5.6569e-06, device='cuda:3')
discard
cal diff is tensor(0.0091, device='cuda:3')
discard
cal diff is tensor(8.0000e-06, device='cuda:3')
discard
cal diff is tensor(76.3287, device='cuda:3')
discard
cal diff is tensor(3.2000e-05, device='cuda:3')
discard
cal diff is tensor(0.0003, device='cuda:3')
discard
cal diff is tensor(3.1623e-06, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.9266500001563205
test entropy is  0.1685576069154846
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1685576069154846
avg test loss is  0.20529745775324576
avg accuracy is  0.9266500001563205
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2321000906513698
avg test loss is  11.444829986547864
avg accuracy is  0.25208333348967166
compute_distance is  tensor(95.8457, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(95.8457, device='cuda:3')
test acc is  0.25208333348967166
test entropy is  0.2321000906513698
________________________________
diff is  tensor(0.7020, device='cuda:3')
diff is  tensor(0.0075, device='cuda:3')
diff is  tensor(14.0924, device='cuda:3')
diff is  tensor(0.0160, device='cuda:3')
diff is  tensor(80.5065, device='cuda:3')
diff is  tensor(0.0409, device='cuda:3')
diff is  tensor(0.4628, device='cuda:3')
diff is  tensor(0.0035, device='cuda:3')
threshold is  tensor(19.5170, device='cuda:3')
sum is tensor(0.0035, device='cuda:3')
sum is tensor(0.0110, device='cuda:3')
sum is tensor(0.0270, device='cuda:3')
sum is tensor(0.0679, device='cuda:3')
sum is tensor(0.5308, device='cuda:3')
sum is tensor(1.2327, device='cuda:3')
sum is tensor(15.3251, device='cuda:3')
sum is tensor(95.8316, device='cuda:3')
ratio is tensor(0.9479, device='cuda:3')
threshold is tensor(80.5065, device='cuda:3')
cal diff is tensor(0.7020, device='cuda:3')
discard
cal diff is tensor(0.0075, device='cuda:3')
discard
cal diff is tensor(14.0924, device='cuda:3')
discard
cal diff is tensor(0.0160, device='cuda:3')
discard
cal diff is tensor(80.5065, device='cuda:3')
clipping
cal diff is tensor(0.0409, device='cuda:3')
discard
cal diff is tensor(0.4628, device='cuda:3')
discard
cal diff is tensor(0.0035, device='cuda:3')
discard
________________________________
test distance is  tensor(76.3262, device='cuda:3')
test acc is  0.3166166668230065
test entropy is  0.37824693417498295
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 87.48% 

Test Accuracy: 83.82% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.013923360034823418
len of model dicts is  10
compute distance is  tensor(44.0751, device='cuda:3')
compute distance is  tensor(55.1714, device='cuda:3')
compute distance is  tensor(94.1788, device='cuda:3')
compute distance is  tensor(118.6262, device='cuda:3')
compute distance is  tensor(62.2485, device='cuda:3')
compute distance is  tensor(86.4305, device='cuda:3')
compute distance is  tensor(111.8231, device='cuda:3')
compute distance is  tensor(66.9253, device='cuda:3')
compute distance is  tensor(101.7607, device='cuda:3')
compute distance is  tensor(4.8609, device='cuda:3')
calculated distance threshold is  tensor(95.8732, device='cuda:3')
pinned_accuracy threshold is  0.8173000001570008
====================
iteration is  0
round is  0
accuracy is  0.36073333348967396
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34438333348967365
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.2999666668230062
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.4320333334896748
====================
====================
iteration is  1
round is  1
accuracy is  0.27860000015633907
====================
succ_min + 1
________________________________
test distance is  tensor(4283.1558, device='cuda:3')
test acc is  0.27860000015633907
test entropy is  0.3620286449186329
________________________________
diff is  tensor(43.0145, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.3346, device='cuda:3', dtype=torch.float64)
diff is  tensor(574.5915, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.4368, device='cuda:3', dtype=torch.float64)
diff is  tensor(3642.2417, device='cuda:3', dtype=torch.float64)
diff is  tensor(1.9898, device='cuda:3', dtype=torch.float64)
diff is  tensor(20.3040, device='cuda:3', dtype=torch.float64)
diff is  tensor(0.2427, device='cuda:3', dtype=torch.float64)
threshold is  tensor(4187.2827, device='cuda:3')
sum is tensor(0.2427, device='cuda:3', dtype=torch.float64)
sum is tensor(0.5773, device='cuda:3', dtype=torch.float64)
sum is tensor(1.0141, device='cuda:3', dtype=torch.float64)
sum is tensor(3.0038, device='cuda:3', dtype=torch.float64)
sum is tensor(23.3079, device='cuda:3', dtype=torch.float64)
sum is tensor(66.3224, device='cuda:3', dtype=torch.float64)
sum is tensor(640.9139, device='cuda:3', dtype=torch.float64)
sum is tensor(4283.1556, device='cuda:3', dtype=torch.float64)
ratio is tensor(0.0263, device='cuda:3', dtype=torch.float64)
threshold is tensor(3642.2417, device='cuda:3', dtype=torch.float64)
cal diff is tensor(43.0145, device='cuda:3')
discard
cal diff is tensor(0.3346, device='cuda:3')
discard
cal diff is tensor(574.5915, device='cuda:3')
discard
cal diff is tensor(0.4368, device='cuda:3')
discard
cal diff is tensor(3642.2417, device='cuda:3')
discard
cal diff is tensor(1.9898, device='cuda:3')
discard
cal diff is tensor(20.3040, device='cuda:3')
discard
cal diff is tensor(0.2427, device='cuda:3')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:3')
test acc is  0.8402000001563237
test entropy is  0.1645086295704153
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1645086295704153
avg test loss is  0.5423583218029567
avg accuracy is  0.8402000001563237
compute_distance is  tensor(0.0676, device='cuda:3')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3770201196834477
avg test loss is  4.802524341957401
avg accuracy is  0.34003333348967363
compute_distance is  tensor(92.6671, device='cuda:3')
++++++++++++++++++++
________________________________
test distance is  tensor(92.6671, device='cuda:3')
test acc is  0.34003333348967363
test entropy is  0.3770201196834477
________________________________
new distance ratio is 0.8
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 34, 36, 37, 39, 17, 18, 19, 20, 21, 22, 8, 9, 11, 12, 13, 14, 15]
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 92.95% 

Test Accuracy: 91.04% 

 
 Results after 30 global rounds of training:
|---- Avg testing Accuracy across each device's data: 92.95%
|----0th round Training Accuracy : 41.23%
|----1th round Training Accuracy : 61.86%
|----2th round Training Accuracy : 87.65%
|----3th round Training Accuracy : 91.32%
|----4th round Training Accuracy : 87.59%
|----5th round Training Accuracy : 91.56%
|----6th round Training Accuracy : 87.86%
|----7th round Training Accuracy : 90.47%
|----8th round Training Accuracy : 92.69%
|----9th round Training Accuracy : 95.10%
|----10th round Training Accuracy : 94.35%
|----11th round Training Accuracy : 94.97%
|----12th round Training Accuracy : 95.03%
|----13th round Training Accuracy : 96.43%
|----14th round Training Accuracy : 96.04%
|----15th round Training Accuracy : 95.82%
|----16th round Training Accuracy : 96.03%
|----17th round Training Accuracy : 96.80%
|----18th round Training Accuracy : 94.79%
|----19th round Training Accuracy : 96.75%
|----20th round Training Accuracy : 79.12%
|----21th round Training Accuracy : 88.30%
|----22th round Training Accuracy : 83.83%
|----23th round Training Accuracy : 92.48%
|----24th round Training Accuracy : 89.51%
|----25th round Training Accuracy : 88.32%
|----26th round Training Accuracy : 88.83%
|----27th round Training Accuracy : 93.71%
|----28th round Training Accuracy : 87.48%
|----29th round Training Accuracy : 92.95%
|----Final Test Accuracy: 91.04%
|----0th round Final Test Accuracy : 47.47%
|----1th round Final Test Accuracy : 64.54%
|----2th round Final Test Accuracy : 88.66%
|----3th round Final Test Accuracy : 91.72%
|----4th round Final Test Accuracy : 88.13%
|----5th round Final Test Accuracy : 91.20%
|----6th round Final Test Accuracy : 88.58%
|----7th round Final Test Accuracy : 90.49%
|----8th round Final Test Accuracy : 92.97%
|----9th round Final Test Accuracy : 95.02%
|----10th round Final Test Accuracy : 94.75%
|----11th round Final Test Accuracy : 94.92%
|----12th round Final Test Accuracy : 95.30%
|----13th round Final Test Accuracy : 96.42%
|----14th round Final Test Accuracy : 96.31%
|----15th round Final Test Accuracy : 95.87%
|----16th round Final Test Accuracy : 96.12%
|----17th round Final Test Accuracy : 96.71%
|----18th round Final Test Accuracy : 94.96%
|----19th round Final Test Accuracy : 96.73%
|----20th round Final Test Accuracy : 74.28%
|----21th round Final Test Accuracy : 84.36%
|----22th round Final Test Accuracy : 79.89%
|----23th round Final Test Accuracy : 90.76%
|----24th round Final Test Accuracy : 87.28%
|----25th round Final Test Accuracy : 84.52%
|----26th round Final Test Accuracy : 85.02%
|----27th round Final Test Accuracy : 92.76%
|----28th round Final Test Accuracy : 83.82%
|----29th round Final Test Accuracy : 91.04%

Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 30

    Federated parameters:
    Non-IID with common data
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 3027.5830
