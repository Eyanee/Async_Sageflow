
Experimental details:
    Dataset     : mnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 100

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  10
 t is  8
attack_user is [40 41 42 43 44 45 46 47 48 49]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
poisoned accuracy threshold is  0.85
distance ratio is <class 'float'>
len of model dicts is  10
compute distance is  tensor(316.8159, device='cuda:2')
compute distance is  tensor(296.9469, device='cuda:2')
compute distance is  tensor(306.2711, device='cuda:2')
compute distance is  tensor(307.3632, device='cuda:2')
compute distance is  tensor(306.8425, device='cuda:2')
compute distance is  tensor(320.2509, device='cuda:2')
compute distance is  tensor(298.2002, device='cuda:2')
compute distance is  tensor(303.3837, device='cuda:2')
compute distance is  tensor(302.9174, device='cuda:2')
compute distance is  tensor(317.0440, device='cuda:2')
calculated distance threshold is  tensor(320.0179, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.08095000015633208
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10606666682299862
====================
====================
iteration is  0
round is  2
accuracy is  0.1397000001563322
====================
====================
iteration is  1
round is  0
accuracy is  0.08926666682299868
====================
====================
iteration is  1
round is  1
accuracy is  0.0793166668229987
====================
succ_min + 1
________________________________
test distance is  tensor(4281.5747, device='cuda:2')
test acc is  0.0793166668229987
test loss is 9.757143368344826
test entropy is  0.3591723048578956
________________________________
diff is  tensor(43.3795, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3489, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.0903, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4771, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.6456, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0639, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3601, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2095, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3961.5569, device='cuda:2')
sum is tensor(0.2095, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5584, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0355, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0995, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4596, device='cuda:2', dtype=torch.float64)
sum is tensor(66.8391, device='cuda:2', dtype=torch.float64)
sum is tensor(639.9294, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.5749, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0879, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.6456, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.3795, device='cuda:2')
discard
cal diff is tensor(0.3489, device='cuda:2')
discard
cal diff is tensor(573.0903, device='cuda:2')
discard
cal diff is tensor(0.4771, device='cuda:2')
discard
cal diff is tensor(3641.6455, device='cuda:2')
discard
cal diff is tensor(2.0639, device='cuda:2')
discard
cal diff is tensor(20.3601, device='cuda:2')
discard
cal diff is tensor(0.2095, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.07978333348966539
test loss is 2.3051291622841026
test entropy is  2.298197515737782
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.298197515737782
avg test loss is  2.3051291622841026
avg accuracy is  0.07978333348966539
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5225665277636635
avg test loss is  6.346123046712326
avg accuracy is  0.08993333348966533
compute_distance is  tensor(79.5574, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(79.5574, device='cuda:2')
test acc is  0.08993333348966533
test loss is 6.346123046712326
test entropy is  0.5225665277636635
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 59.08% 

Test Accuracy: 60.42% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.013107950799167156
attack res is True
len of model dicts is  10
compute distance is  tensor(258.5812, device='cuda:2')
compute distance is  tensor(253.3261, device='cuda:2')
compute distance is  tensor(251.9702, device='cuda:2')
compute distance is  tensor(236.0005, device='cuda:2')
compute distance is  tensor(225.7189, device='cuda:2')
compute distance is  tensor(272.3593, device='cuda:2')
compute distance is  tensor(276.2996, device='cuda:2')
compute distance is  tensor(239.9527, device='cuda:2')
compute distance is  tensor(229.7247, device='cuda:2')
compute distance is  tensor(261.7560, device='cuda:2')
calculated distance threshold is  tensor(280.8013, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.1420500001563324
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.11783333348966527
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.1296000001563319
====================
====================
iteration is  1
round is  0
accuracy is  0.1030333334896653
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.21288333348967012
====================
________________________________
test distance is  tensor(4282.5415, device='cuda:2')
test acc is  0.1030333334896653
test loss is 12.56021570091817
test entropy is  0.5521776522718259
________________________________
diff is  tensor(44.4735, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3373, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.5757, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5279, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.0581, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0715, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3077, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1901, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4001.7402, device='cuda:2')
sum is tensor(0.1901, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5275, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0554, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1269, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4346, device='cuda:2', dtype=torch.float64)
sum is tensor(67.9081, device='cuda:2', dtype=torch.float64)
sum is tensor(641.4838, device='cuda:2', dtype=torch.float64)
sum is tensor(4282.5419, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0771, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.0581, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.4735, device='cuda:2')
discard
cal diff is tensor(0.3373, device='cuda:2')
discard
cal diff is tensor(573.5757, device='cuda:2')
discard
cal diff is tensor(0.5279, device='cuda:2')
discard
cal diff is tensor(3641.0581, device='cuda:2')
clipping
cal diff is tensor(2.0715, device='cuda:2')
discard
cal diff is tensor(20.3077, device='cuda:2')
discard
cal diff is tensor(0.1901, device='cuda:2')
discard
________________________________
test distance is  tensor(280.8119, device='cuda:2')
test acc is  0.6024833334896709
test loss is 1.3200027618581043
test entropy is  1.8610999164804976
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(280.8017, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0106, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(280.8119, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(280.8017, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(280.8017, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(280.8115, device='cuda:2')
test acc is  0.6024833334896709
test loss is 1.3200029302507574
test entropy is  1.8611000110345608
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(280.8014, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(280.8116, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(280.8014, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(280.8014, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.5947666668230049
test loss is 1.3221952267038797
test entropy is  1.8548565293425945
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 11, 14]
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 96.46% 

Test Accuracy: 96.57% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.06118690222501755
attack res is True
len of model dicts is  10
compute distance is  tensor(175.4349, device='cuda:2')
compute distance is  tensor(185.0412, device='cuda:2')
compute distance is  tensor(140.8572, device='cuda:2')
compute distance is  tensor(167.7683, device='cuda:2')
compute distance is  tensor(165.4324, device='cuda:2')
compute distance is  tensor(176.8085, device='cuda:2')
compute distance is  tensor(194.8385, device='cuda:2')
compute distance is  tensor(186.9267, device='cuda:2')
compute distance is  tensor(163.7951, device='cuda:2')
compute distance is  tensor(192.6374, device='cuda:2')
calculated distance threshold is  tensor(205.5214, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.2237500001563374
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2774000001563389
====================
====================
iteration is  0
round is  2
accuracy is  0.25636666682300496
====================
====================
iteration is  1
round is  0
accuracy is  0.3529000001563405
====================
====================
iteration is  1
round is  1
accuracy is  0.408366666823008
====================
________________________________
test distance is  tensor(4282.9165, device='cuda:2')
test acc is  0.2237500001563374
test loss is 4.970932792753045
test entropy is  0.400319167291686
________________________________
diff is  tensor(44.5496, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3422, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.7659, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4936, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.1458, device='cuda:2', dtype=torch.float64)
diff is  tensor(1.9710, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4915, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1565, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4077.3950, device='cuda:2')
sum is tensor(0.1565, device='cuda:2', dtype=torch.float64)
sum is tensor(0.4986, device='cuda:2', dtype=torch.float64)
sum is tensor(0.9922, device='cuda:2', dtype=torch.float64)
sum is tensor(2.9633, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4547, device='cuda:2', dtype=torch.float64)
sum is tensor(68.0044, device='cuda:2', dtype=torch.float64)
sum is tensor(641.7703, device='cuda:2', dtype=torch.float64)
sum is tensor(4282.9161, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0564, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.1458, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.5496, device='cuda:2')
discard
cal diff is tensor(0.3422, device='cuda:2')
discard
cal diff is tensor(573.7659, device='cuda:2')
discard
cal diff is tensor(0.4936, device='cuda:2')
discard
cal diff is tensor(3641.1458, device='cuda:2')
discard
cal diff is tensor(1.9710, device='cuda:2')
discard
cal diff is tensor(20.4915, device='cuda:2')
discard
cal diff is tensor(0.1565, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9650500001563193
test loss is 0.22088284031160352
test entropy is  0.5712587106138912
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.5712587106138912
avg test loss is  0.22088284031160352
avg accuracy is  0.9650500001563193
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.6168706188959353
avg test loss is  2.796812886368237
avg accuracy is  0.1916666668230026
compute_distance is  tensor(85.1799, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(85.1799, device='cuda:2')
test acc is  0.1916666668230026
test loss is 2.796812886368237
test entropy is  0.6168706188959353
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 17, 20, 22]
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 95.29% 

Test Accuracy: 95.49% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.08664041757583618
attack res is True
len of model dicts is  10
compute distance is  tensor(130.6095, device='cuda:2')
compute distance is  tensor(130.8224, device='cuda:2')
compute distance is  tensor(144.0994, device='cuda:2')
compute distance is  tensor(137.5465, device='cuda:2')
compute distance is  tensor(133.5322, device='cuda:2')
compute distance is  tensor(149.4274, device='cuda:2')
compute distance is  tensor(148.1210, device='cuda:2')
compute distance is  tensor(157.7362, device='cuda:2')
compute distance is  tensor(123.0562, device='cuda:2')
compute distance is  tensor(130.2185, device='cuda:2')
calculated distance threshold is  tensor(168.7537, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.47426666682300844
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5290500001563423
====================
====================
iteration is  0
round is  2
accuracy is  0.32316666682300654
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.18871666682300253
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.41006666682300785
====================
________________________________
test distance is  tensor(4283.1914, device='cuda:2')
test acc is  0.18871666682300253
test loss is 9.392147913162134
test entropy is  0.12845928496770512
________________________________
diff is  tensor(43.5091, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3460, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.3508, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4965, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.9340, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0125, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3599, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1820, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4114.4375, device='cuda:2')
sum is tensor(0.1820, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5280, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0246, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0370, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3970, device='cuda:2', dtype=torch.float64)
sum is tensor(66.9061, device='cuda:2', dtype=torch.float64)
sum is tensor(640.2569, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.1909, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0463, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.9340, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.5091, device='cuda:2')
discard
cal diff is tensor(0.3460, device='cuda:2')
discard
cal diff is tensor(573.3508, device='cuda:2')
discard
cal diff is tensor(0.4965, device='cuda:2')
discard
cal diff is tensor(3642.9341, device='cuda:2')
clipping
cal diff is tensor(2.0125, device='cuda:2')
discard
cal diff is tensor(20.3599, device='cuda:2')
discard
cal diff is tensor(0.1820, device='cuda:2')
discard
________________________________
test distance is  tensor(168.7636, device='cuda:2')
test acc is  0.9505166668229864
test loss is 0.17268623610231668
test entropy is  0.29517173170566813
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(168.7534, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0099, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0316, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(168.7534, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(5.3488, device='cuda:2')
test acc is  0.9514166668229862
test loss is 0.1695715542981969
test entropy is  0.29261449675983203
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.29261449675983203
avg test loss is  0.1695715542981969
avg accuracy is  0.9514166668229862
compute_distance is  tensor(5.3488, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2177387891309475
avg test loss is  4.143147121614485
avg accuracy is  0.1776666668230019
compute_distance is  tensor(75.6791, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(75.6791, device='cuda:2')
test acc is  0.1776666668230019
test loss is 4.143147121614485
test entropy is  0.2177387891309475
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 27, 29, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 96.55% 

Test Accuracy: 96.90% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.10909748077392578
attack res is True
len of model dicts is  10
compute distance is  tensor(143.9998, device='cuda:2')
compute distance is  tensor(145.1269, device='cuda:2')
compute distance is  tensor(101.2046, device='cuda:2')
compute distance is  tensor(133.2003, device='cuda:2')
compute distance is  tensor(114.8351, device='cuda:2')
compute distance is  tensor(125.1341, device='cuda:2')
compute distance is  tensor(146.6483, device='cuda:2')
compute distance is  tensor(155.5820, device='cuda:2')
compute distance is  tensor(107.9107, device='cuda:2')
compute distance is  tensor(137.1387, device='cuda:2')
calculated distance threshold is  tensor(180.0224, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.4303833334896747
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5273000001563423
====================
====================
iteration is  0
round is  2
accuracy is  0.5482500001563421
====================
====================
iteration is  1
round is  0
accuracy is  0.49133333348967534
====================
====================
iteration is  1
round is  1
accuracy is  0.4864833334896753
====================
________________________________
test distance is  tensor(4284.2290, device='cuda:2')
test acc is  0.4303833334896747
test loss is 4.36692541227666
test entropy is  0.3850627889288768
________________________________
diff is  tensor(45.3600, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3704, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.4912, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4484, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.9308, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0186, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3737, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2359, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4104.2065, device='cuda:2')
sum is tensor(0.2359, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6063, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0547, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0733, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4470, device='cuda:2', dtype=torch.float64)
sum is tensor(68.8071, device='cuda:2', dtype=torch.float64)
sum is tensor(642.2983, device='cuda:2', dtype=torch.float64)
sum is tensor(4284.2291, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0494, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.9308, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.3600, device='cuda:2')
discard
cal diff is tensor(0.3704, device='cuda:2')
discard
cal diff is tensor(573.4912, device='cuda:2')
discard
cal diff is tensor(0.4484, device='cuda:2')
discard
cal diff is tensor(3641.9307, device='cuda:2')
discard
cal diff is tensor(2.0186, device='cuda:2')
discard
cal diff is tensor(20.3737, device='cuda:2')
discard
cal diff is tensor(0.2359, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9656166668229857
test loss is 0.10737670099857682
test entropy is  0.11224676690983779
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.11224676690983779
avg test loss is  0.10737670099857682
avg accuracy is  0.9656166668229857
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.7696603928674767
avg test loss is  1.77279375674628
avg accuracy is  0.49648333348967527
compute_distance is  tensor(81.0012, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(81.0012, device='cuda:2')
test acc is  0.49648333348967527
test loss is 1.77279375674628
test entropy is  0.7696603928674767
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 38]
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 96.86% 

Test Accuracy: 97.12% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.11821647733449936
attack res is True
len of model dicts is  10
compute distance is  tensor(139.5326, device='cuda:2')
compute distance is  tensor(151.0739, device='cuda:2')
compute distance is  tensor(101.0781, device='cuda:2')
compute distance is  tensor(106.8663, device='cuda:2')
compute distance is  tensor(115.2149, device='cuda:2')
compute distance is  tensor(117.2409, device='cuda:2')
compute distance is  tensor(121.8279, device='cuda:2')
compute distance is  tensor(142.8944, device='cuda:2')
compute distance is  tensor(110.5097, device='cuda:2')
compute distance is  tensor(108.9326, device='cuda:2')
calculated distance threshold is  tensor(180.7916, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5381000001563423
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5569000001563414
====================
====================
iteration is  0
round is  2
accuracy is  0.48175000015634195
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.4269000001563414
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3571833334896739
====================
succ_min + 1
________________________________
test distance is  tensor(4278.7300, device='cuda:2')
test acc is  0.3571833334896739
test loss is 5.611005255154201
test entropy is  0.32358561904191463
________________________________
diff is  tensor(43.6225, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3820, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.2956, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4736, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.4733, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0410, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2901, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1517, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4097.9385, device='cuda:2')
sum is tensor(0.1517, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5337, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0072, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0482, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3383, device='cuda:2', dtype=torch.float64)
sum is tensor(66.9608, device='cuda:2', dtype=torch.float64)
sum is tensor(638.2564, device='cuda:2', dtype=torch.float64)
sum is tensor(4278.7297, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0497, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.4733, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.6225, device='cuda:2')
discard
cal diff is tensor(0.3820, device='cuda:2')
discard
cal diff is tensor(571.2956, device='cuda:2')
discard
cal diff is tensor(0.4736, device='cuda:2')
discard
cal diff is tensor(3640.4731, device='cuda:2')
discard
cal diff is tensor(2.0410, device='cuda:2')
discard
cal diff is tensor(20.2901, device='cuda:2')
discard
cal diff is tensor(0.1517, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9684166668229858
test loss is 0.10427244801619358
test entropy is  0.14368109579291394
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14368109579291394
avg test loss is  0.10427244801619358
avg accuracy is  0.9684166668229858
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.531027656310657
avg test loss is  2.828948273968849
avg accuracy is  0.3808833334896742
compute_distance is  tensor(71.7660, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(71.7660, device='cuda:2')
test acc is  0.3808833334896742
test loss is 2.828948273968849
test entropy is  0.531027656310657
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 17, 20, 21, 23, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 97.63% 

Test Accuracy: 97.63% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.12962010502815247
attack res is True
len of model dicts is  10
compute distance is  tensor(107.4746, device='cuda:2')
compute distance is  tensor(136.6283, device='cuda:2')
compute distance is  tensor(112.2230, device='cuda:2')
compute distance is  tensor(142.2081, device='cuda:2')
compute distance is  tensor(118.8755, device='cuda:2')
compute distance is  tensor(102.8794, device='cuda:2')
compute distance is  tensor(120.2442, device='cuda:2')
compute distance is  tensor(140.0897, device='cuda:2')
compute distance is  tensor(103.1291, device='cuda:2')
compute distance is  tensor(120.7155, device='cuda:2')
calculated distance threshold is  tensor(171.8558, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.4691500001563418
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.4129500001563413
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.7040833334896638
====================
====================
iteration is  1
round is  0
accuracy is  0.3908833334896743
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5744333334896732
====================
________________________________
test distance is  tensor(4281.9858, device='cuda:2')
test acc is  0.3908833334896743
test loss is 6.259137192260482
test entropy is  0.3008076651518279
________________________________
diff is  tensor(44.5200, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3724, device='cuda:2', dtype=torch.float64)
diff is  tensor(572.5195, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5398, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.4157, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0252, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4308, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1624, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4110.1299, device='cuda:2')
sum is tensor(0.1624, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5349, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0746, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0998, device='cuda:2', dtype=torch.float64)
sum is tensor(23.5306, device='cuda:2', dtype=torch.float64)
sum is tensor(68.0506, device='cuda:2', dtype=torch.float64)
sum is tensor(640.5701, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.9858, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0472, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.4157, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.5200, device='cuda:2')
discard
cal diff is tensor(0.3724, device='cuda:2')
discard
cal diff is tensor(572.5195, device='cuda:2')
discard
cal diff is tensor(0.5398, device='cuda:2')
discard
cal diff is tensor(3641.4155, device='cuda:2')
discard
cal diff is tensor(2.0252, device='cuda:2')
discard
cal diff is tensor(20.4308, device='cuda:2')
discard
cal diff is tensor(0.1624, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9760000001563188
test loss is 0.07623776055595427
test entropy is  0.06724363969721353
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.06724363969721353
avg test loss is  0.07623776055595427
avg accuracy is  0.9760000001563188
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.6018994644697286
avg test loss is  3.0150540712545677
avg accuracy is  0.40708333348967457
compute_distance is  tensor(74.7232, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(74.7232, device='cuda:2')
test acc is  0.40708333348967457
test loss is 3.0150540712545677
test entropy is  0.6018994644697286
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 89.26% 

Test Accuracy: 89.87% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.13240817189216614
attack res is True
len of model dicts is  10
compute distance is  tensor(106.1080, device='cuda:2')
compute distance is  tensor(112.6098, device='cuda:2')
compute distance is  tensor(152.1105, device='cuda:2')
compute distance is  tensor(152.4691, device='cuda:2')
compute distance is  tensor(123.5747, device='cuda:2')
compute distance is  tensor(143.8085, device='cuda:2')
compute distance is  tensor(124.2432, device='cuda:2')
compute distance is  tensor(131.7946, device='cuda:2')
compute distance is  tensor(120.0037, device='cuda:2')
compute distance is  tensor(160.0777, device='cuda:2')
calculated distance threshold is  tensor(210.2279, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.3298833334896734
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3001666668230062
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.27138333348967214
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.32695000015634007
====================
====================
iteration is  1
round is  1
accuracy is  0.42863333348967475
====================
________________________________
test distance is  tensor(4280.8530, device='cuda:2')
test acc is  0.27138333348967214
test loss is 12.70694390644651
test entropy is  0.2445448139456035
________________________________
diff is  tensor(45.5021, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3499, device='cuda:2', dtype=torch.float64)
diff is  tensor(570.6293, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4951, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.4200, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0249, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.1990, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2326, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4070.6252, device='cuda:2')
sum is tensor(0.2326, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5825, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0776, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1025, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3015, device='cuda:2', dtype=torch.float64)
sum is tensor(68.8036, device='cuda:2', dtype=torch.float64)
sum is tensor(639.4328, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.8528, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0577, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.4200, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.5021, device='cuda:2')
discard
cal diff is tensor(0.3499, device='cuda:2')
discard
cal diff is tensor(570.6293, device='cuda:2')
discard
cal diff is tensor(0.4951, device='cuda:2')
discard
cal diff is tensor(3641.4199, device='cuda:2')
discard
cal diff is tensor(2.0249, device='cuda:2')
discard
cal diff is tensor(20.1990, device='cuda:2')
discard
cal diff is tensor(0.2326, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.8881666668229884
test loss is 0.3509962784011227
test entropy is  0.2607334383380121
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2607334383380121
avg test loss is  0.3509962784011227
avg accuracy is  0.8881666668229884
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5024903732449261
avg test loss is  4.646113572344343
avg accuracy is  0.29696666682300615
compute_distance is  tensor(64.5638, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(64.5638, device='cuda:2')
test acc is  0.29696666682300615
test loss is 4.646113572344343
test entropy is  0.5024903732449261
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 29, 30, 31, 8, 9, 10, 11, 13, 14, 15]
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 97.83% 

Test Accuracy: 98.06% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.14125120639801025
attack res is True
len of model dicts is  10
compute distance is  tensor(106.0131, device='cuda:2')
compute distance is  tensor(122.8956, device='cuda:2')
compute distance is  tensor(104.0898, device='cuda:2')
compute distance is  tensor(117.0630, device='cuda:2')
compute distance is  tensor(113.5859, device='cuda:2')
compute distance is  tensor(100.0790, device='cuda:2')
compute distance is  tensor(120.6776, device='cuda:2')
compute distance is  tensor(150.4673, device='cuda:2')
compute distance is  tensor(99.7146, device='cuda:2')
compute distance is  tensor(106.5032, device='cuda:2')
calculated distance threshold is  tensor(207.4197, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5401000001563423
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5502166668230085
====================
====================
iteration is  0
round is  2
accuracy is  0.5059666668230087
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.6167333334896697
====================
====================
iteration is  1
round is  1
accuracy is  0.5311500001563423
====================
________________________________
test distance is  tensor(4278.7773, device='cuda:2')
test acc is  0.5059666668230087
test loss is 3.752380897749716
test entropy is  0.34559658222170525
________________________________
diff is  tensor(43.8764, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3598, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.3548, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4505, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.0123, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0390, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4894, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1947, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4071.3577, device='cuda:2')
sum is tensor(0.1947, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5545, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0050, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0440, device='cuda:2', dtype=torch.float64)
sum is tensor(23.5335, device='cuda:2', dtype=torch.float64)
sum is tensor(67.4098, device='cuda:2', dtype=torch.float64)
sum is tensor(638.7646, device='cuda:2', dtype=torch.float64)
sum is tensor(4278.7769, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0570, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.0123, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.8764, device='cuda:2')
discard
cal diff is tensor(0.3598, device='cuda:2')
discard
cal diff is tensor(571.3547, device='cuda:2')
discard
cal diff is tensor(0.4505, device='cuda:2')
discard
cal diff is tensor(3640.0125, device='cuda:2')
clipping
cal diff is tensor(2.0390, device='cuda:2')
discard
cal diff is tensor(20.4894, device='cuda:2')
discard
cal diff is tensor(0.1947, device='cuda:2')
discard
________________________________
test distance is  tensor(207.4295, device='cuda:2')
test acc is  0.9794500001563188
test loss is 0.06557949248421838
test entropy is  0.05524170731501118
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(207.4193, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0098, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0451, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(207.4193, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(9.3693, device='cuda:2')
test acc is  0.9794333334896521
test loss is 0.06597429510763363
test entropy is  0.05530715022466457
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05530715022466457
avg test loss is  0.06597429510763363
avg accuracy is  0.9794333334896521
compute_distance is  tensor(9.3693, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.7021101210862081
avg test loss is  1.9303442702364566
avg accuracy is  0.5524000001563418
compute_distance is  tensor(76.5904, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(76.5904, device='cuda:2')
test acc is  0.5524000001563418
test loss is 1.9303442702364566
test entropy is  0.7021101210862081
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 20, 22, 23]
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 97.52% 

Test Accuracy: 97.82% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.146318718791008
attack res is True
len of model dicts is  10
compute distance is  tensor(112.7117, device='cuda:2')
compute distance is  tensor(131.8729, device='cuda:2')
compute distance is  tensor(77.3969, device='cuda:2')
compute distance is  tensor(115.7699, device='cuda:2')
compute distance is  tensor(100.0019, device='cuda:2')
compute distance is  tensor(104.3188, device='cuda:2')
compute distance is  tensor(127.0163, device='cuda:2')
compute distance is  tensor(155.6904, device='cuda:2')
compute distance is  tensor(84.8058, device='cuda:2')
compute distance is  tensor(93.6990, device='cuda:2')
calculated distance threshold is  tensor(260.1629, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.4705833334896752
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.724766666822996
====================
====================
iteration is  0
round is  2
accuracy is  0.5481500001563422
====================
====================
iteration is  1
round is  0
accuracy is  0.5562833334896747
====================
====================
iteration is  1
round is  1
accuracy is  0.3634833334896739
====================
succ_min + 1
________________________________
test distance is  tensor(4280.4775, device='cuda:2')
test acc is  0.3634833334896739
test loss is 5.063705335802107
test entropy is  0.35042813704656894
________________________________
diff is  tensor(42.9892, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3466, device='cuda:2', dtype=torch.float64)
diff is  tensor(572.3624, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4672, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.8457, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0091, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2819, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1752, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4020.3147, device='cuda:2')
sum is tensor(0.1752, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5219, device='cuda:2', dtype=torch.float64)
sum is tensor(0.9891, device='cuda:2', dtype=torch.float64)
sum is tensor(2.9983, device='cuda:2', dtype=torch.float64)
sum is tensor(23.2802, device='cuda:2', dtype=torch.float64)
sum is tensor(66.2694, device='cuda:2', dtype=torch.float64)
sum is tensor(638.6318, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.4775, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0714, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.8457, device='cuda:2', dtype=torch.float64)
cal diff is tensor(42.9892, device='cuda:2')
discard
cal diff is tensor(0.3466, device='cuda:2')
discard
cal diff is tensor(572.3624, device='cuda:2')
discard
cal diff is tensor(0.4672, device='cuda:2')
discard
cal diff is tensor(3641.8457, device='cuda:2')
clipping
cal diff is tensor(2.0091, device='cuda:2')
discard
cal diff is tensor(20.2819, device='cuda:2')
discard
cal diff is tensor(0.1752, device='cuda:2')
discard
________________________________
test distance is  tensor(260.1730, device='cuda:2')
test acc is  0.9772500001563189
test loss is 0.0728872838169134
test entropy is  0.07730992625840803
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(260.1629, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0101, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0097, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(260.1628, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(2.5389, device='cuda:2')
test acc is  0.9774000001563188
test loss is 0.07252469828162691
test entropy is  0.07793996501331732
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.07793996501331732
avg test loss is  0.07252469828162691
avg accuracy is  0.9774000001563188
compute_distance is  tensor(2.5389, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.7182355267660958
avg test loss is  2.3025841301183965
avg accuracy is  0.37895000015634084
compute_distance is  tensor(69.8535, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(69.8535, device='cuda:2')
test acc is  0.37895000015634084
test loss is 2.3025841301183965
test entropy is  0.7182355267660958
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 38, 8, 9, 10, 11, 13, 14, 15]
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 98.23% 

Test Accuracy: 98.31% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.15313032269477844
attack res is True
len of model dicts is  10
compute distance is  tensor(91.2727, device='cuda:2')
compute distance is  tensor(100.4417, device='cuda:2')
compute distance is  tensor(81.5163, device='cuda:2')
compute distance is  tensor(103.4318, device='cuda:2')
compute distance is  tensor(107.0228, device='cuda:2')
compute distance is  tensor(118.7145, device='cuda:2')
compute distance is  tensor(137.0281, device='cuda:2')
compute distance is  tensor(126.4725, device='cuda:2')
compute distance is  tensor(88.6394, device='cuda:2')
compute distance is  tensor(126.5132, device='cuda:2')
calculated distance threshold is  tensor(224.0597, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5160500001563422
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3472333334896738
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.6244333334896691
====================
====================
iteration is  1
round is  0
accuracy is  0.5269500001563423
====================
====================
iteration is  1
round is  1
accuracy is  0.5530166668230083
====================
________________________________
test distance is  tensor(4283.7754, device='cuda:2')
test acc is  0.3472333334896738
test loss is 4.799276016414293
test entropy is  0.2453029529054536
________________________________
diff is  tensor(44.2814, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3551, device='cuda:2', dtype=torch.float64)
diff is  tensor(574.7388, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5508, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.0432, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0882, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.5312, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1864, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4059.7156, device='cuda:2')
sum is tensor(0.1864, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5415, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0922, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1805, device='cuda:2', dtype=torch.float64)
sum is tensor(23.7117, device='cuda:2', dtype=torch.float64)
sum is tensor(67.9932, device='cuda:2', dtype=torch.float64)
sum is tensor(642.7320, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.7752, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0615, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.0432, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.2814, device='cuda:2')
discard
cal diff is tensor(0.3551, device='cuda:2')
discard
cal diff is tensor(574.7388, device='cuda:2')
discard
cal diff is tensor(0.5508, device='cuda:2')
discard
cal diff is tensor(3641.0432, device='cuda:2')
clipping
cal diff is tensor(2.0882, device='cuda:2')
discard
cal diff is tensor(20.5312, device='cuda:2')
discard
cal diff is tensor(0.1864, device='cuda:2')
discard
________________________________
test distance is  tensor(224.0698, device='cuda:2')
test acc is  0.9831833334896519
test loss is 0.05491553355193567
test entropy is  0.04882035348743105
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(224.0596, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0101, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0181, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(224.0596, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(4.0765, device='cuda:2')
test acc is  0.9829000001563186
test loss is 0.05518749238897315
test entropy is  0.049553543204073805
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.049553543204073805
avg test loss is  0.05518749238897315
avg accuracy is  0.9829000001563186
compute_distance is  tensor(4.0765, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5002665864760434
avg test loss is  2.519235555424111
avg accuracy is  0.3361666668230069
compute_distance is  tensor(65.6180, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(65.6180, device='cuda:2')
test acc is  0.3361666668230069
test loss is 2.519235555424111
test entropy is  0.5002665864760434
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 2, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 93.66% 

Test Accuracy: 93.87% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.15619149804115295
attack res is True
len of model dicts is  10
compute distance is  tensor(104.4540, device='cuda:2')
compute distance is  tensor(115.8900, device='cuda:2')
compute distance is  tensor(97.6023, device='cuda:2')
compute distance is  tensor(103.4144, device='cuda:2')
compute distance is  tensor(136.3486, device='cuda:2')
compute distance is  tensor(112.3185, device='cuda:2')
compute distance is  tensor(128.2238, device='cuda:2')
compute distance is  tensor(138.3234, device='cuda:2')
compute distance is  tensor(86.3482, device='cuda:2')
compute distance is  tensor(111.6247, device='cuda:2')
calculated distance threshold is  tensor(233.1565, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.2990000001563395
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.12005000015633192
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.22223333348967078
====================
====================
iteration is  1
round is  0
accuracy is  0.2569500001563384
====================
====================
iteration is  1
round is  1
accuracy is  0.2598000001563386
====================
________________________________
test distance is  tensor(4280.9619, device='cuda:2')
test acc is  0.12005000015633192
test loss is 10.81463070261453
test entropy is  0.10849721679714189
________________________________
diff is  tensor(43.4416, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4065, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.6575, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5064, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.4519, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0387, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2511, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2083, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4047.8054, device='cuda:2')
sum is tensor(0.2083, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6148, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1212, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1599, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4109, device='cuda:2', dtype=torch.float64)
sum is tensor(66.8526, device='cuda:2', dtype=torch.float64)
sum is tensor(638.5101, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.9620, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0640, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.4519, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.4416, device='cuda:2')
discard
cal diff is tensor(0.4065, device='cuda:2')
discard
cal diff is tensor(571.6575, device='cuda:2')
discard
cal diff is tensor(0.5064, device='cuda:2')
discard
cal diff is tensor(3642.4517, device='cuda:2')
discard
cal diff is tensor(2.0387, device='cuda:2')
discard
cal diff is tensor(20.2510, device='cuda:2')
discard
cal diff is tensor(0.2083, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9383666668229868
test loss is 0.18687983952474588
test entropy is  0.18339295627902757
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18339295627902757
avg test loss is  0.18687983952474588
avg accuracy is  0.9383666668229868
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17742818041142625
avg test loss is  5.442709108913885
avg accuracy is  0.10541666682299863
compute_distance is  tensor(54.9877, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(54.9877, device='cuda:2')
test acc is  0.10541666682299863
test loss is 5.442709108913885
test entropy is  0.17742818041142625
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 25, 26, 28, 29, 30, 16, 17, 19, 20, 22, 23, 8, 10, 11, 13, 14, 15]
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 98.37% 

Test Accuracy: 98.47% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.16128668189048767
attack res is True
len of model dicts is  10
compute distance is  tensor(141.8175, device='cuda:2')
compute distance is  tensor(134.4444, device='cuda:2')
compute distance is  tensor(112.1524, device='cuda:2')
compute distance is  tensor(115.0497, device='cuda:2')
compute distance is  tensor(130.9113, device='cuda:2')
compute distance is  tensor(120.7467, device='cuda:2')
compute distance is  tensor(114.7697, device='cuda:2')
compute distance is  tensor(123.3715, device='cuda:2')
compute distance is  tensor(104.1074, device='cuda:2')
compute distance is  tensor(110.4581, device='cuda:2')
calculated distance threshold is  tensor(221.2742, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5637833334896741
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5099000001563422
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4341333334896748
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.6935333334896644
====================
====================
iteration is  1
round is  1
accuracy is  0.28733333348967255
====================
succ_min + 1
________________________________
test distance is  tensor(4282.6294, device='cuda:2')
test acc is  0.28733333348967255
test loss is 8.453994539500808
test entropy is  0.21758977330124962
________________________________
diff is  tensor(44.4589, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3999, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.7398, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4698, device='cuda:2', dtype=torch.float64)
diff is  tensor(3643.1080, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0315, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2373, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1839, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4061.3552, device='cuda:2')
sum is tensor(0.1839, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5838, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0536, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0851, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3225, device='cuda:2', dtype=torch.float64)
sum is tensor(67.7814, device='cuda:2', dtype=torch.float64)
sum is tensor(639.5212, device='cuda:2', dtype=torch.float64)
sum is tensor(4282.6291, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0607, device='cuda:2', dtype=torch.float64)
threshold is tensor(3643.1080, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.4589, device='cuda:2')
discard
cal diff is tensor(0.3999, device='cuda:2')
discard
cal diff is tensor(571.7397, device='cuda:2')
discard
cal diff is tensor(0.4698, device='cuda:2')
discard
cal diff is tensor(3643.1079, device='cuda:2')
discard
cal diff is tensor(2.0315, device='cuda:2')
discard
cal diff is tensor(20.2373, device='cuda:2')
discard
cal diff is tensor(0.1839, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9843500001563186
test loss is 0.05208124228626511
test entropy is  0.03699670851278776
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03699670851278776
avg test loss is  0.05208124228626511
avg accuracy is  0.9843500001563186
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.39476007007078323
avg test loss is  4.148215362003872
avg accuracy is  0.28858333348967263
compute_distance is  tensor(75.0146, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(75.0146, device='cuda:2')
test acc is  0.28858333348967263
test loss is 4.148215362003872
test entropy is  0.39476007007078323
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 90.19% 

Test Accuracy: 91.19% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.1640654355287552
attack res is True
len of model dicts is  10
compute distance is  tensor(120.6867, device='cuda:2')
compute distance is  tensor(99.4501, device='cuda:2')
compute distance is  tensor(100.6431, device='cuda:2')
compute distance is  tensor(115.6759, device='cuda:2')
compute distance is  tensor(106.1174, device='cuda:2')
compute distance is  tensor(115.1336, device='cuda:2')
compute distance is  tensor(149.5925, device='cuda:2')
compute distance is  tensor(130.4228, device='cuda:2')
compute distance is  tensor(108.0247, device='cuda:2')
compute distance is  tensor(140.8990, device='cuda:2')
calculated distance threshold is  tensor(270.8243, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.2529833334896717
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2595333334896719
====================
====================
iteration is  0
round is  2
accuracy is  0.2294500001563376
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.18833333348966902
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2862000001563393
====================
________________________________
test distance is  tensor(4284.3560, device='cuda:2')
test acc is  0.18833333348966902
test loss is 14.370584472664383
test entropy is  0.14430893631949862
________________________________
diff is  tensor(45.3581, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3327, device='cuda:2', dtype=torch.float64)
diff is  tensor(574.1679, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5245, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.2653, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0255, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4584, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2235, device='cuda:2', dtype=torch.float64)
threshold is  tensor(4013.5317, device='cuda:2')
sum is tensor(0.2235, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5562, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0806, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1062, device='cuda:2', dtype=torch.float64)
sum is tensor(23.5646, device='cuda:2', dtype=torch.float64)
sum is tensor(68.9227, device='cuda:2', dtype=torch.float64)
sum is tensor(643.0905, device='cuda:2', dtype=torch.float64)
sum is tensor(4284.3559, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0744, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.2653, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.3581, device='cuda:2')
discard
cal diff is tensor(0.3327, device='cuda:2')
discard
cal diff is tensor(574.1678, device='cuda:2')
discard
cal diff is tensor(0.5245, device='cuda:2')
discard
cal diff is tensor(3641.2651, device='cuda:2')
discard
cal diff is tensor(2.0255, device='cuda:2')
discard
cal diff is tensor(20.4584, device='cuda:2')
discard
cal diff is tensor(0.2235, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9040333334896545
test loss is 0.29892411857628937
test entropy is  0.1979926127884815
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1979926127884815
avg test loss is  0.29892411857628937
avg accuracy is  0.9040333334896545
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.31046747842005323
avg test loss is  5.530848226313398
avg accuracy is  0.18738333348966896
compute_distance is  tensor(58.9437, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(58.9437, device='cuda:2')
test acc is  0.18738333348966896
test loss is 5.530848226313398
test entropy is  0.31046747842005323
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 14]
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 97.62% 

Test Accuracy: 97.67% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.16874746978282928
attack res is True
len of model dicts is  10
compute distance is  tensor(102.7044, device='cuda:2')
compute distance is  tensor(111.6277, device='cuda:2')
compute distance is  tensor(92.3018, device='cuda:2')
compute distance is  tensor(108.0180, device='cuda:2')
compute distance is  tensor(88.1941, device='cuda:2')
compute distance is  tensor(91.2992, device='cuda:2')
compute distance is  tensor(120.5172, device='cuda:2')
compute distance is  tensor(146.0529, device='cuda:2')
compute distance is  tensor(88.9954, device='cuda:2')
compute distance is  tensor(107.0207, device='cuda:2')
calculated distance threshold is  tensor(305.7158, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5350833334896756
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.24766666682300478
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4341000001563415
====================
====================
iteration is  1
round is  0
accuracy is  0.3589333334896739
====================
====================
iteration is  1
round is  1
accuracy is  0.34916666682300707
====================
________________________________
test distance is  tensor(4279.8066, device='cuda:2')
test acc is  0.24766666682300478
test loss is 8.318957521463
test entropy is  0.20573970433999736
________________________________
diff is  tensor(42.1977, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3217, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.0142, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5384, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.3964, device='cuda:2', dtype=torch.float64)
diff is  tensor(1.9971, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.1807, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1607, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3974.0908, device='cuda:2')
sum is tensor(0.1607, device='cuda:2', dtype=torch.float64)
sum is tensor(0.4825, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0209, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0180, device='cuda:2', dtype=torch.float64)
sum is tensor(23.1987, device='cuda:2', dtype=torch.float64)
sum is tensor(65.3963, device='cuda:2', dtype=torch.float64)
sum is tensor(638.4105, device='cuda:2', dtype=torch.float64)
sum is tensor(4279.8069, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0840, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.3964, device='cuda:2', dtype=torch.float64)
cal diff is tensor(42.1977, device='cuda:2')
discard
cal diff is tensor(0.3217, device='cuda:2')
discard
cal diff is tensor(573.0142, device='cuda:2')
discard
cal diff is tensor(0.5384, device='cuda:2')
discard
cal diff is tensor(3641.3965, device='cuda:2')
clipping
cal diff is tensor(1.9971, device='cuda:2')
discard
cal diff is tensor(20.1807, device='cuda:2')
discard
cal diff is tensor(0.1607, device='cuda:2')
discard
________________________________
test distance is  tensor(305.7263, device='cuda:2')
test acc is  0.9778666668229855
test loss is 0.07140567546801842
test entropy is  0.05622697763640418
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(305.7161, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0105, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(305.7263, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(305.7161, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(305.7161, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(305.7260, device='cuda:2')
test acc is  0.9778666668229855
test loss is 0.07140563750899072
test entropy is  0.05622695798852614
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(305.7159, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(305.7261, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(305.7159, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(305.7159, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9779166668229855
test loss is 0.07194607980421006
test entropy is  0.05721464255816742
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05721464255816742
avg test loss is  0.07194607980421006
avg accuracy is  0.9779166668229855
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.389803985987645
avg test loss is  3.93351649933024
avg accuracy is  0.2261000001563374
compute_distance is  tensor(64.7561, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(64.7561, device='cuda:2')
test acc is  0.2261000001563374
test loss is 3.93351649933024
test entropy is  0.389803985987645
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 37, 16, 17, 18, 19, 20, 22, 23]
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 98.11% 

Test Accuracy: 98.15% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.17238539457321167
attack res is True
len of model dicts is  10
compute distance is  tensor(129.5768, device='cuda:2')
compute distance is  tensor(111.2618, device='cuda:2')
compute distance is  tensor(87.2089, device='cuda:2')
compute distance is  tensor(101.4520, device='cuda:2')
compute distance is  tensor(93.0960, device='cuda:2')
compute distance is  tensor(98.9488, device='cuda:2')
compute distance is  tensor(127.4630, device='cuda:2')
compute distance is  tensor(141.3249, device='cuda:2')
compute distance is  tensor(108.4624, device='cuda:2')
compute distance is  tensor(114.4491, device='cuda:2')
calculated distance threshold is  tensor(311.0045, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.2584666668230052
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.34706666682300696
====================
====================
iteration is  0
round is  2
accuracy is  0.5301833334896756
====================
====================
iteration is  1
round is  0
accuracy is  0.487000000156342
====================
====================
iteration is  1
round is  1
accuracy is  0.4225833334896747
====================
________________________________
test distance is  tensor(4279.4194, device='cuda:2')
test acc is  0.2584666668230052
test loss is 7.502901448369789
test entropy is  0.21044989120064259
________________________________
diff is  tensor(44.4492, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3495, device='cuda:2', dtype=torch.float64)
diff is  tensor(569.9521, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4859, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.6619, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0273, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2835, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2100, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3968.4150, device='cuda:2')
sum is tensor(0.2100, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5595, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0454, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0728, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3563, device='cuda:2', dtype=torch.float64)
sum is tensor(67.8054, device='cuda:2', dtype=torch.float64)
sum is tensor(637.7575, device='cuda:2', dtype=torch.float64)
sum is tensor(4279.4195, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0854, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.6619, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.4492, device='cuda:2')
discard
cal diff is tensor(0.3495, device='cuda:2')
discard
cal diff is tensor(569.9520, device='cuda:2')
discard
cal diff is tensor(0.4859, device='cuda:2')
discard
cal diff is tensor(3641.6619, device='cuda:2')
discard
cal diff is tensor(2.0273, device='cuda:2')
discard
cal diff is tensor(20.2835, device='cuda:2')
discard
cal diff is tensor(0.2100, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9823666668229855
test loss is 0.05671950529005644
test entropy is  0.04291403380319176
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04291403380319176
avg test loss is  0.05671950529005644
avg accuracy is  0.9823666668229855
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3955257974231421
avg test loss is  4.2879408826706
avg accuracy is  0.25840000015633846
compute_distance is  tensor(67.2350, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(67.2350, device='cuda:2')
test acc is  0.25840000015633846
test loss is 4.2879408826706
test entropy is  0.3955257974231421
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 25, 26, 29, 31, 8, 9, 10, 12, 13, 14, 15]
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 98.34% 

Test Accuracy: 98.46% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.17781007289886475
attack res is True
len of model dicts is  10
compute distance is  tensor(97.7845, device='cuda:2')
compute distance is  tensor(91.6544, device='cuda:2')
compute distance is  tensor(84.5390, device='cuda:2')
compute distance is  tensor(91.8291, device='cuda:2')
compute distance is  tensor(110.1467, device='cuda:2')
compute distance is  tensor(99.6749, device='cuda:2')
compute distance is  tensor(93.2806, device='cuda:2')
compute distance is  tensor(143.0879, device='cuda:2')
compute distance is  tensor(114.5162, device='cuda:2')
compute distance is  tensor(100.5967, device='cuda:2')
calculated distance threshold is  tensor(350.8790, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.3225333334896733
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.33436666682300686
====================
====================
iteration is  0
round is  2
accuracy is  0.36305000015634065
====================
====================
iteration is  1
round is  0
accuracy is  0.33220000015634016
====================
====================
iteration is  1
round is  1
accuracy is  0.3199333334896733
====================
succ_min + 1
________________________________
test distance is  tensor(4280.2778, device='cuda:2')
test acc is  0.3199333334896733
test loss is 7.7920348262990204
test entropy is  0.20921615689103282
________________________________
diff is  tensor(43.1726, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3422, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.1332, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4827, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.7456, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0175, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.1821, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2024, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3929.3989, device='cuda:2')
sum is tensor(0.2024, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5446, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0273, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0448, device='cuda:2', dtype=torch.float64)
sum is tensor(23.2269, device='cuda:2', dtype=torch.float64)
sum is tensor(66.3994, device='cuda:2', dtype=torch.float64)
sum is tensor(637.5326, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.2782, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0963, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.7456, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.1726, device='cuda:2')
discard
cal diff is tensor(0.3422, device='cuda:2')
discard
cal diff is tensor(571.1332, device='cuda:2')
discard
cal diff is tensor(0.4827, device='cuda:2')
discard
cal diff is tensor(3642.7456, device='cuda:2')
clipping
cal diff is tensor(2.0175, device='cuda:2')
discard
cal diff is tensor(20.1821, device='cuda:2')
discard
cal diff is tensor(0.2024, device='cuda:2')
discard
________________________________
test distance is  tensor(350.8895, device='cuda:2')
test acc is  0.9843000001563186
test loss is 0.0511167142371543
test entropy is  0.03935474676700226
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(350.8793, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0104, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(350.8895, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(350.8793, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(350.8793, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(350.8893, device='cuda:2')
test acc is  0.9843000001563186
test loss is 0.051116720891645845
test entropy is  0.03935473864107628
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(350.8791, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(350.8893, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(350.8791, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(350.8790, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9844500001563186
test loss is 0.05089961785028391
test entropy is  0.03882612871517589
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.03882612871517589
avg test loss is  0.05089961785028391
avg accuracy is  0.9844500001563186
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3927989275470726
avg test loss is  3.391806667039135
avg accuracy is  0.3146333334896732
compute_distance is  tensor(64.8728, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(64.8728, device='cuda:2')
test acc is  0.3146333334896732
test loss is 3.391806667039135
test entropy is  0.3927989275470726
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 92.73% 

Test Accuracy: 93.22% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.18165619671344757
attack res is True
len of model dicts is  10
compute distance is  tensor(161.1598, device='cuda:2')
compute distance is  tensor(122.7666, device='cuda:2')
compute distance is  tensor(85.8355, device='cuda:2')
compute distance is  tensor(100.0379, device='cuda:2')
compute distance is  tensor(111.9947, device='cuda:2')
compute distance is  tensor(111.1709, device='cuda:2')
compute distance is  tensor(166.2364, device='cuda:2')
compute distance is  tensor(151.2761, device='cuda:2')
compute distance is  tensor(86.7595, device='cuda:2')
compute distance is  tensor(128.9672, device='cuda:2')
calculated distance threshold is  tensor(488.1557, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.2687333334896721
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2325500001563377
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.13308333348966525
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.27493333348967225
====================
====================
iteration is  1
round is  1
accuracy is  0.20358333348966987
====================
________________________________
test distance is  tensor(4280.9697, device='cuda:2')
test acc is  0.13308333348966525
test loss is 15.559332920798361
test entropy is  0.1215085981489181
________________________________
diff is  tensor(42.6931, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4053, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.6519, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5020, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.9915, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0764, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4236, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2249, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3792.8140, device='cuda:2')
sum is tensor(0.2249, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6302, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1322, device='cuda:2', dtype=torch.float64)
sum is tensor(3.2086, device='cuda:2', dtype=torch.float64)
sum is tensor(23.6322, device='cuda:2', dtype=torch.float64)
sum is tensor(66.3253, device='cuda:2', dtype=torch.float64)
sum is tensor(639.9772, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.9688, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1341, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.9915, device='cuda:2', dtype=torch.float64)
cal diff is tensor(42.6931, device='cuda:2')
discard
cal diff is tensor(0.4053, device='cuda:2')
discard
cal diff is tensor(573.6519, device='cuda:2')
discard
cal diff is tensor(0.5020, device='cuda:2')
discard
cal diff is tensor(3640.9917, device='cuda:2')
clipping
cal diff is tensor(2.0764, device='cuda:2')
discard
cal diff is tensor(20.4236, device='cuda:2')
discard
cal diff is tensor(0.2249, device='cuda:2')
discard
________________________________
test distance is  tensor(488.1650, device='cuda:2')
test acc is  0.9327500001563201
test loss is 0.20893502299701655
test entropy is  0.13902670520939617
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(488.1547, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0094, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0940, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(488.1547, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(45.9022, device='cuda:2')
test acc is  0.9293000001563203
test loss is 0.22154218118006327
test entropy is  0.14773794459198902
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14773794459198902
avg test loss is  0.22154218118006327
avg accuracy is  0.9293000001563203
compute_distance is  tensor(45.9022, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.21970343267294898
avg test loss is  5.996867148352584
avg accuracy is  0.1383833334896655
compute_distance is  tensor(74.5627, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(74.5627, device='cuda:2')
test acc is  0.1383833334896655
test loss is 5.996867148352584
test entropy is  0.21970343267294898
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 20, 22, 23, 9, 10, 11, 12, 13, 14]
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 98.42% 

Test Accuracy: 98.48% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.18655262887477875
attack res is True
len of model dicts is  10
compute distance is  tensor(98.6453, device='cuda:2')
compute distance is  tensor(129.7750, device='cuda:2')
compute distance is  tensor(84.2733, device='cuda:2')
compute distance is  tensor(100.2129, device='cuda:2')
compute distance is  tensor(93.7563, device='cuda:2')
compute distance is  tensor(96.3521, device='cuda:2')
compute distance is  tensor(114.0341, device='cuda:2')
compute distance is  tensor(128.5573, device='cuda:2')
compute distance is  tensor(99.4397, device='cuda:2')
compute distance is  tensor(108.8409, device='cuda:2')
calculated distance threshold is  tensor(334.7290, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.32853333348967345
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5389833334896756
====================
====================
iteration is  0
round is  2
accuracy is  0.36188333348967394
====================
====================
iteration is  1
round is  0
accuracy is  0.39468333348967444
====================
====================
iteration is  1
round is  1
accuracy is  0.3213833334896733
====================
succ_min + 1
________________________________
test distance is  tensor(4281.3652, device='cuda:2')
test acc is  0.3213833334896733
test loss is 5.872203367605392
test entropy is  0.23392223952802768
________________________________
diff is  tensor(43.4964, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3347, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.5065, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5511, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.9605, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0022, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3033, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2105, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3946.6362, device='cuda:2')
sum is tensor(0.2105, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5452, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0963, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0985, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4019, device='cuda:2', dtype=torch.float64)
sum is tensor(66.8982, device='cuda:2', dtype=torch.float64)
sum is tensor(640.4047, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.3652, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0919, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.9605, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.4964, device='cuda:2')
discard
cal diff is tensor(0.3347, device='cuda:2')
discard
cal diff is tensor(573.5065, device='cuda:2')
discard
cal diff is tensor(0.5511, device='cuda:2')
discard
cal diff is tensor(3640.9604, device='cuda:2')
discard
cal diff is tensor(2.0022, device='cuda:2')
discard
cal diff is tensor(20.3033, device='cuda:2')
discard
cal diff is tensor(0.2105, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9850500001563186
test loss is 0.04848547014563649
test entropy is  0.038412098887687755
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.038412098887687755
avg test loss is  0.04848547014563649
avg accuracy is  0.9850500001563186
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3829461097844374
avg test loss is  3.61636786216866
avg accuracy is  0.3244166668230067
compute_distance is  tensor(65.1222, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(65.1222, device='cuda:2')
test acc is  0.3244166668230067
test loss is 3.61636786216866
test entropy is  0.3829461097844374
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [1, 2, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 91.29% 

Test Accuracy: 91.64% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.1896141916513443
attack res is True
len of model dicts is  10
compute distance is  tensor(115.8872, device='cuda:2')
compute distance is  tensor(141.1436, device='cuda:2')
compute distance is  tensor(107.9535, device='cuda:2')
compute distance is  tensor(108.9887, device='cuda:2')
compute distance is  tensor(135.2554, device='cuda:2')
compute distance is  tensor(105.9505, device='cuda:2')
compute distance is  tensor(119.5307, device='cuda:2')
compute distance is  tensor(162.8795, device='cuda:2')
compute distance is  tensor(113.6331, device='cuda:2')
compute distance is  tensor(114.1357, device='cuda:2')
calculated distance threshold is  tensor(450.6414, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.17445000015633505
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.1805666668230019
====================
====================
iteration is  0
round is  2
accuracy is  0.10561666682299864
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.18431666682300224
====================
====================
iteration is  1
round is  1
accuracy is  0.1564833334896669
====================
________________________________
test distance is  tensor(4279.2612, device='cuda:2')
test acc is  0.10561666682299864
test loss is 23.956986187363484
test entropy is  0.02430850523250944
________________________________
diff is  tensor(43.9881, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3883, device='cuda:2', dtype=torch.float64)
diff is  tensor(570.8510, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5143, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.9676, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0657, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3495, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1371, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3828.6199, device='cuda:2')
sum is tensor(0.1371, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5254, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0397, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1054, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4549, device='cuda:2', dtype=torch.float64)
sum is tensor(67.4430, device='cuda:2', dtype=torch.float64)
sum is tensor(638.2940, device='cuda:2', dtype=torch.float64)
sum is tensor(4279.2617, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1238, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.9676, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.9881, device='cuda:2')
discard
cal diff is tensor(0.3883, device='cuda:2')
discard
cal diff is tensor(570.8510, device='cuda:2')
discard
cal diff is tensor(0.5143, device='cuda:2')
discard
cal diff is tensor(3640.9675, device='cuda:2')
discard
cal diff is tensor(2.0657, device='cuda:2')
discard
cal diff is tensor(20.3495, device='cuda:2')
discard
cal diff is tensor(0.1371, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9128500001563208
test loss is 0.2688975381081118
test entropy is  0.17457679593200875
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17457679593200875
avg test loss is  0.2688975381081118
avg accuracy is  0.9128500001563208
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.04381689678694902
avg test loss is  7.491906596145141
avg accuracy is  0.10281666682299863
compute_distance is  tensor(52.0708, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(52.0708, device='cuda:2')
test acc is  0.10281666682299863
test loss is 7.491906596145141
test entropy is  0.04381689678694902
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 34, 39, 25, 26, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 98.59% 

Test Accuracy: 98.52% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.19261369109153748
attack res is True
len of model dicts is  10
compute distance is  tensor(88.6521, device='cuda:2')
compute distance is  tensor(109.2887, device='cuda:2')
compute distance is  tensor(88.9735, device='cuda:2')
compute distance is  tensor(98.5769, device='cuda:2')
compute distance is  tensor(111.8468, device='cuda:2')
compute distance is  tensor(89.4350, device='cuda:2')
compute distance is  tensor(116.4105, device='cuda:2')
compute distance is  tensor(140.4150, device='cuda:2')
compute distance is  tensor(90.5986, device='cuda:2')
compute distance is  tensor(88.3119, device='cuda:2')
calculated distance threshold is  tensor(435.3303, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5332500001563423
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.43058333348967476
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.34381666682300704
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.2589333334896718
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.620916666823003
====================
________________________________
test distance is  tensor(4281.4756, device='cuda:2')
test acc is  0.2589333334896718
test loss is 6.349450676934297
test entropy is  0.297231627679837
________________________________
diff is  tensor(45.2233, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3097, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.0618, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5086, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.8971, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0124, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2587, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2041, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3846.1453, device='cuda:2')
sum is tensor(0.2041, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5138, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0225, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0348, device='cuda:2', dtype=torch.float64)
sum is tensor(23.2935, device='cuda:2', dtype=torch.float64)
sum is tensor(68.5168, device='cuda:2', dtype=torch.float64)
sum is tensor(639.5786, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.4757, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1195, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.8971, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.2233, device='cuda:2')
discard
cal diff is tensor(0.3097, device='cuda:2')
discard
cal diff is tensor(571.0618, device='cuda:2')
discard
cal diff is tensor(0.5086, device='cuda:2')
discard
cal diff is tensor(3641.8972, device='cuda:2')
clipping
cal diff is tensor(2.0124, device='cuda:2')
discard
cal diff is tensor(20.2587, device='cuda:2')
discard
cal diff is tensor(0.2041, device='cuda:2')
discard
________________________________
test distance is  tensor(435.3407, device='cuda:2')
test acc is  0.9863333334896518
test loss is 0.045605030416507104
test entropy is  0.03160605929326018
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(435.3304, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0104, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(435.3407, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(435.3304, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(435.3304, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(435.3405, device='cuda:2')
test acc is  0.9863333334896518
test loss is 0.04560503737980022
test entropy is  0.03160605460729526
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(435.3302, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(435.3405, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(435.3302, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(435.3302, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(435.3405, device='cuda:2')
test acc is  0.9863333334896518
test loss is 0.04560504938198487
test entropy is  0.03160604755870744
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(435.3302, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0030, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(435.3302, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(1.3061, device='cuda:2')
test acc is  0.9869333334896518
test loss is 0.04419537697440959
test entropy is  0.030837762579382675
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.030837762579382675
avg test loss is  0.04419537697440959
avg accuracy is  0.9869333334896518
compute_distance is  tensor(1.3061, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5168050584444868
avg test loss is  3.607201948603079
avg accuracy is  0.24288333348967134
compute_distance is  tensor(72.1294, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(72.1294, device='cuda:2')
test acc is  0.24288333348967134
test loss is 3.607201948603079
test entropy is  0.5168050584444868
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 19, 20, 22]
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 97.68% 

Test Accuracy: 97.94% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.19509203732013702
attack res is True
len of model dicts is  10
compute distance is  tensor(104.9222, device='cuda:2')
compute distance is  tensor(97.0673, device='cuda:2')
compute distance is  tensor(77.5235, device='cuda:2')
compute distance is  tensor(104.6980, device='cuda:2')
compute distance is  tensor(97.6647, device='cuda:2')
compute distance is  tensor(93.7634, device='cuda:2')
compute distance is  tensor(126.9087, device='cuda:2')
compute distance is  tensor(131.3220, device='cuda:2')
compute distance is  tensor(115.6831, device='cuda:2')
compute distance is  tensor(98.7643, device='cuda:2')
calculated distance threshold is  tensor(471.6647, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.2484000001563382
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.20433333348966976
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.22400000015633742
====================
====================
iteration is  1
round is  0
accuracy is  0.12730000015633192
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.43800000015634155
====================
________________________________
test distance is  tensor(4280.7061, device='cuda:2')
test acc is  0.12730000015633192
test loss is 15.089251183751804
test entropy is  0.053558142603571605
________________________________
diff is  tensor(44.5108, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3906, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.9811, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4430, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.7288, device='cuda:2', dtype=torch.float64)
diff is  tensor(1.9870, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4526, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2126, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3809.0413, device='cuda:2')
sum is tensor(0.2126, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6032, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0462, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0331, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4858, device='cuda:2', dtype=torch.float64)
sum is tensor(67.9966, device='cuda:2', dtype=torch.float64)
sum is tensor(639.9777, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.7065, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1296, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.7288, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.5108, device='cuda:2')
discard
cal diff is tensor(0.3906, device='cuda:2')
discard
cal diff is tensor(571.9811, device='cuda:2')
discard
cal diff is tensor(0.4430, device='cuda:2')
discard
cal diff is tensor(3640.7288, device='cuda:2')
discard
cal diff is tensor(1.9870, device='cuda:2')
discard
cal diff is tensor(20.4526, device='cuda:2')
discard
cal diff is tensor(0.2126, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9797333334896521
test loss is 0.06538671470701887
test entropy is  0.05785003727597834
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05785003727597834
avg test loss is  0.06538671470701887
avg accuracy is  0.9797333334896521
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10197744356480234
avg test loss is  6.292329943764693
avg accuracy is  0.11580000015633195
compute_distance is  tensor(58.1493, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(58.1493, device='cuda:2')
test acc is  0.11580000015633195
test loss is 6.292329943764693
test entropy is  0.10197744356480234
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [1, 2, 3, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 9, 10, 12, 14, 15]
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 97.35% 

Test Accuracy: 97.55% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.19833023846149445
attack res is True
len of model dicts is  10
compute distance is  tensor(112.6687, device='cuda:2')
compute distance is  tensor(129.9910, device='cuda:2')
compute distance is  tensor(84.3336, device='cuda:2')
compute distance is  tensor(92.8754, device='cuda:2')
compute distance is  tensor(127.1768, device='cuda:2')
compute distance is  tensor(93.4921, device='cuda:2')
compute distance is  tensor(126.9328, device='cuda:2')
compute distance is  tensor(148.1143, device='cuda:2')
compute distance is  tensor(79.5374, device='cuda:2')
compute distance is  tensor(126.4900, device='cuda:2')
calculated distance threshold is  tensor(632.1898, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.2763333334896723
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2924666668230061
====================
====================
iteration is  0
round is  2
accuracy is  0.23010000015633758
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.180466666823002
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.13658333348966525
====================
succ_min + 1
________________________________
test distance is  tensor(4283.9102, device='cuda:2')
test acc is  0.13658333348966525
test loss is 16.400640932990036
test entropy is  0.054708767960320655
________________________________
diff is  tensor(43.9272, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3580, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.7871, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5555, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.7314, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0419, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3228, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1856, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3651.7202, device='cuda:2')
sum is tensor(0.1856, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5436, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0991, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1410, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4638, device='cuda:2', dtype=torch.float64)
sum is tensor(67.3910, device='cuda:2', dtype=torch.float64)
sum is tensor(641.1781, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.9096, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1735, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.7314, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.9272, device='cuda:2')
discard
cal diff is tensor(0.3580, device='cuda:2')
discard
cal diff is tensor(573.7871, device='cuda:2')
discard
cal diff is tensor(0.5555, device='cuda:2')
discard
cal diff is tensor(3642.7314, device='cuda:2')
clipping
cal diff is tensor(2.0419, device='cuda:2')
discard
cal diff is tensor(20.3228, device='cuda:2')
discard
cal diff is tensor(0.1856, device='cuda:2')
discard
________________________________
test distance is  tensor(632.1996, device='cuda:2')
test acc is  0.9742500001563189
test loss is 0.08308644330898883
test entropy is  0.05467581536783688
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(632.1893, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0098, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0434, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(632.1893, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(27.4693, device='cuda:2')
test acc is  0.9760333334896522
test loss is 0.07722531374192239
test entropy is  0.054561396639770283
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.054561396639770283
avg test loss is  0.07722531374192239
avg accuracy is  0.9760333334896522
compute_distance is  tensor(27.4693, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.09674180687061631
avg test loss is  6.181875023506343
avg accuracy is  0.1189666668229986
compute_distance is  tensor(62.8084, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(62.8084, device='cuda:2')
test acc is  0.1189666668229986
test loss is 6.181875023506343
test entropy is  0.09674180687061631
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 4, 5, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 91.04% 

Test Accuracy: 91.25% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.2026536762714386
attack res is True
len of model dicts is  10
compute distance is  tensor(126.3611, device='cuda:2')
compute distance is  tensor(109.7266, device='cuda:2')
compute distance is  tensor(106.7261, device='cuda:2')
compute distance is  tensor(108.7761, device='cuda:2')
compute distance is  tensor(118.8665, device='cuda:2')
compute distance is  tensor(120.6620, device='cuda:2')
compute distance is  tensor(127.3815, device='cuda:2')
compute distance is  tensor(134.1132, device='cuda:2')
compute distance is  tensor(117.6600, device='cuda:2')
compute distance is  tensor(128.2179, device='cuda:2')
calculated distance threshold is  tensor(349.5062, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.1021833334896653
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10890000015633196
====================
====================
iteration is  0
round is  2
accuracy is  0.10465000015633197
====================
====================
iteration is  1
round is  0
accuracy is  0.1778166668230019
====================
====================
iteration is  1
round is  1
accuracy is  0.10826666682299864
====================
________________________________
test distance is  tensor(4282.4409, device='cuda:2')
test acc is  0.1021833334896653
test loss is 28.22630713895948
test entropy is  3.671055078700683e-05
________________________________
diff is  tensor(43.8331, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3346, device='cuda:2', dtype=torch.float64)
diff is  tensor(574.1004, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5091, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.0807, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0179, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3251, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2396, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3932.9346, device='cuda:2')
sum is tensor(0.2396, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5742, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0834, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1013, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4264, device='cuda:2', dtype=torch.float64)
sum is tensor(67.2594, device='cuda:2', dtype=torch.float64)
sum is tensor(641.3598, device='cuda:2', dtype=torch.float64)
sum is tensor(4282.4405, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.0960, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.0807, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.8331, device='cuda:2')
discard
cal diff is tensor(0.3346, device='cuda:2')
discard
cal diff is tensor(574.1005, device='cuda:2')
discard
cal diff is tensor(0.5091, device='cuda:2')
discard
cal diff is tensor(3641.0808, device='cuda:2')
clipping
cal diff is tensor(2.0179, device='cuda:2')
discard
cal diff is tensor(20.3251, device='cuda:2')
discard
cal diff is tensor(0.2396, device='cuda:2')
discard
________________________________
test distance is  tensor(349.5162, device='cuda:2')
test acc is  0.9076833334896544
test loss is 0.29578230436593456
test entropy is  0.14206781124533302
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(349.5059, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0100, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0266, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(349.5059, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(9.2989, device='cuda:2')
test acc is  0.9122666668229876
test loss is 0.28117804379581707
test entropy is  0.14034627282471734
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14034627282471734
avg test loss is  0.28117804379581707
avg accuracy is  0.9122666668229876
compute_distance is  tensor(9.2989, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.012150050125279421
avg test loss is  8.83814002760946
avg accuracy is  0.10226666682299863
compute_distance is  tensor(51.3357, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(51.3357, device='cuda:2')
test acc is  0.10226666682299863
test loss is 8.83814002760946
test entropy is  0.012150050125279421
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 25, 29, 31, 16, 17, 19, 20, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 98.65% 

Test Accuracy: 98.76% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.20509465038776398
attack res is True
len of model dicts is  10
compute distance is  tensor(110.6644, device='cuda:2')
compute distance is  tensor(114.6213, device='cuda:2')
compute distance is  tensor(93.4822, device='cuda:2')
compute distance is  tensor(104.3895, device='cuda:2')
compute distance is  tensor(121.0258, device='cuda:2')
compute distance is  tensor(83.7659, device='cuda:2')
compute distance is  tensor(103.5340, device='cuda:2')
compute distance is  tensor(108.1427, device='cuda:2')
compute distance is  tensor(92.7341, device='cuda:2')
compute distance is  tensor(104.5220, device='cuda:2')
calculated distance threshold is  tensor(447.0952, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.4002666668230077
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.33065000015634005
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.542816666823009
====================
====================
iteration is  1
round is  0
accuracy is  0.3355166668230068
====================
====================
iteration is  1
round is  1
accuracy is  0.24233333348967134
====================
succ_min + 1
________________________________
test distance is  tensor(4280.2515, device='cuda:2')
test acc is  0.24233333348967134
test loss is 7.670834203772961
test entropy is  0.25737106528427045
________________________________
diff is  tensor(42.9319, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3106, device='cuda:2', dtype=torch.float64)
diff is  tensor(572.8410, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4380, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.2418, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0554, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2467, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1865, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3833.1562, device='cuda:2')
sum is tensor(0.1865, device='cuda:2', dtype=torch.float64)
sum is tensor(0.4971, device='cuda:2', dtype=torch.float64)
sum is tensor(0.9351, device='cuda:2', dtype=torch.float64)
sum is tensor(2.9905, device='cuda:2', dtype=torch.float64)
sum is tensor(23.2372, device='cuda:2', dtype=torch.float64)
sum is tensor(66.1692, device='cuda:2', dtype=torch.float64)
sum is tensor(639.0101, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.2519, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1228, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.2418, device='cuda:2', dtype=torch.float64)
cal diff is tensor(42.9319, device='cuda:2')
discard
cal diff is tensor(0.3106, device='cuda:2')
discard
cal diff is tensor(572.8409, device='cuda:2')
discard
cal diff is tensor(0.4380, device='cuda:2')
discard
cal diff is tensor(3641.2419, device='cuda:2')
clipping
cal diff is tensor(2.0554, device='cuda:2')
discard
cal diff is tensor(20.2467, device='cuda:2')
discard
cal diff is tensor(0.1865, device='cuda:2')
discard
________________________________
test distance is  tensor(447.1059, device='cuda:2')
test acc is  0.9878333334896519
test loss is 0.04162115039569448
test entropy is  0.027899701391977356
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(447.0957, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0107, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(447.1059, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(447.0957, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(447.0957, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(447.1055, device='cuda:2')
test acc is  0.9878333334896519
test loss is 0.04162114999562347
test entropy is  0.027899692445054965
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(447.0952, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(447.1054, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(447.0952, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(447.0952, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(447.1054, device='cuda:2')
test acc is  0.9878333334896519
test loss is 0.04162114624779167
test entropy is  0.027899690073356517
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(447.0952, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0030, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(447.0952, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(1.3410, device='cuda:2')
test acc is  0.9881833334896518
test loss is 0.04128974653048199
test entropy is  0.02773287752360877
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02773287752360877
avg test loss is  0.04128974653048199
avg accuracy is  0.9881833334896518
compute_distance is  tensor(1.3410, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4611714065456187
avg test loss is  4.040387234962317
avg accuracy is  0.2445666668230047
compute_distance is  tensor(80.3134, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(80.3134, device='cuda:2')
test acc is  0.2445666668230047
test loss is 4.040387234962317
test entropy is  0.4611714065456187
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 35]
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 97.87% 

Test Accuracy: 98.05% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.20491968095302582
attack res is True
len of model dicts is  10
compute distance is  tensor(116.1986, device='cuda:2')
compute distance is  tensor(128.7338, device='cuda:2')
compute distance is  tensor(83.5408, device='cuda:2')
compute distance is  tensor(101.7000, device='cuda:2')
compute distance is  tensor(108.2820, device='cuda:2')
compute distance is  tensor(85.0939, device='cuda:2')
compute distance is  tensor(141.2302, device='cuda:2')
compute distance is  tensor(142.7996, device='cuda:2')
compute distance is  tensor(122.0582, device='cuda:2')
compute distance is  tensor(95.2815, device='cuda:2')
calculated distance threshold is  tensor(719.1722, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.3760166668230076
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3352500001563402
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.257116666823005
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.2859500001563391
====================
====================
iteration is  1
round is  1
accuracy is  0.39985000015634103
====================
________________________________
test distance is  tensor(4282.5854, device='cuda:2')
test acc is  0.257116666823005
test loss is 11.084828982221039
test entropy is  0.25078701509087326
________________________________
diff is  tensor(43.4018, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3600, device='cuda:2', dtype=torch.float64)
diff is  tensor(574.1509, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5139, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.6271, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0581, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2770, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1968, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3563.4131, device='cuda:2')
sum is tensor(0.1968, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5568, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0707, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1288, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4058, device='cuda:2', dtype=torch.float64)
sum is tensor(66.8077, device='cuda:2', dtype=torch.float64)
sum is tensor(640.9586, device='cuda:2', dtype=torch.float64)
sum is tensor(4282.5857, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1975, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.6271, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.4018, device='cuda:2')
discard
cal diff is tensor(0.3600, device='cuda:2')
discard
cal diff is tensor(574.1509, device='cuda:2')
discard
cal diff is tensor(0.5139, device='cuda:2')
discard
cal diff is tensor(3641.6270, device='cuda:2')
discard
cal diff is tensor(2.0581, device='cuda:2')
discard
cal diff is tensor(20.2770, device='cuda:2')
discard
cal diff is tensor(0.1968, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9816833334896521
test loss is 0.059388650785487176
test entropy is  0.049928019993004204
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.049928019993004204
avg test loss is  0.059388650785487176
avg accuracy is  0.9816833334896521
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5622742687588307
avg test loss is  4.001256556144909
avg accuracy is  0.2600666668230051
compute_distance is  tensor(71.4782, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(71.4782, device='cuda:2')
test acc is  0.2600666668230051
test loss is 4.001256556144909
test entropy is  0.5622742687588307
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 10, 11, 13, 14]
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 98.18% 

Test Accuracy: 98.24% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.20889201760292053
attack res is True
len of model dicts is  10
compute distance is  tensor(122.2845, device='cuda:2')
compute distance is  tensor(118.4378, device='cuda:2')
compute distance is  tensor(108.0419, device='cuda:2')
compute distance is  tensor(94.5648, device='cuda:2')
compute distance is  tensor(88.0368, device='cuda:2')
compute distance is  tensor(113.4212, device='cuda:2')
compute distance is  tensor(129.0583, device='cuda:2')
compute distance is  tensor(146.5100, device='cuda:2')
compute distance is  tensor(94.0149, device='cuda:2')
compute distance is  tensor(128.4161, device='cuda:2')
calculated distance threshold is  tensor(777.9622, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.1398666668229989
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.12066666682299859
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.31515000015633987
====================
====================
iteration is  1
round is  0
accuracy is  0.22970000015633754
====================
====================
iteration is  1
round is  1
accuracy is  0.19500000015633595
====================
________________________________
test distance is  tensor(4284.8120, device='cuda:2')
test acc is  0.12066666682299859
test loss is 16.14347316054647
test entropy is  0.08195313158582078
________________________________
diff is  tensor(44.2939, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3455, device='cuda:2', dtype=torch.float64)
diff is  tensor(574.0512, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4590, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.9749, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0106, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4664, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2111, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3506.8499, device='cuda:2')
sum is tensor(0.2111, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5566, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0156, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0262, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4927, device='cuda:2', dtype=torch.float64)
sum is tensor(67.7865, device='cuda:2', dtype=torch.float64)
sum is tensor(641.8377, device='cuda:2', dtype=torch.float64)
sum is tensor(4284.8125, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.2136, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.9749, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.2939, device='cuda:2')
discard
cal diff is tensor(0.3455, device='cuda:2')
discard
cal diff is tensor(574.0511, device='cuda:2')
discard
cal diff is tensor(0.4590, device='cuda:2')
discard
cal diff is tensor(3642.9749, device='cuda:2')
discard
cal diff is tensor(2.0106, device='cuda:2')
discard
cal diff is tensor(20.4664, device='cuda:2')
discard
cal diff is tensor(0.2111, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9844333334896519
test loss is 0.05145943715455639
test entropy is  0.04567466130560097
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.04567466130560097
avg test loss is  0.05145943715455639
avg accuracy is  0.9844333334896519
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.13230714023208567
avg test loss is  7.120368086198754
avg accuracy is  0.11836666682299861
compute_distance is  tensor(61.2835, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(61.2835, device='cuda:2')
test acc is  0.11836666682299861
test loss is 7.120368086198754
test entropy is  0.13230714023208567
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 20, 22, 23]
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 97.62% 

Test Accuracy: 97.94% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.21363431215286255
attack res is True
len of model dicts is  10
compute distance is  tensor(117.1192, device='cuda:2')
compute distance is  tensor(102.4841, device='cuda:2')
compute distance is  tensor(118.8448, device='cuda:2')
compute distance is  tensor(100.8994, device='cuda:2')
compute distance is  tensor(84.7316, device='cuda:2')
compute distance is  tensor(90.9523, device='cuda:2')
compute distance is  tensor(131.7160, device='cuda:2')
compute distance is  tensor(118.8128, device='cuda:2')
compute distance is  tensor(83.5424, device='cuda:2')
compute distance is  tensor(100.3518, device='cuda:2')
calculated distance threshold is  tensor(708.7823, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.1342500001563319
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.1185666668229986
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.13588333348966525
====================
====================
iteration is  1
round is  0
accuracy is  0.10301666682299863
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.11368333348966529
====================
________________________________
test distance is  tensor(4278.8579, device='cuda:2')
test acc is  0.10301666682299863
test loss is 21.665559984219353
test entropy is  0.004098995518441987
________________________________
diff is  tensor(43.2951, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2874, device='cuda:2', dtype=torch.float64)
diff is  tensor(570.7922, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4899, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.4296, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0439, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3062, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2140, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3570.0757, device='cuda:2')
sum is tensor(0.2140, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5014, device='cuda:2', dtype=torch.float64)
sum is tensor(0.9913, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0352, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3414, device='cuda:2', dtype=torch.float64)
sum is tensor(66.6366, device='cuda:2', dtype=torch.float64)
sum is tensor(637.4287, device='cuda:2', dtype=torch.float64)
sum is tensor(4278.8583, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.1946, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.4296, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.2951, device='cuda:2')
discard
cal diff is tensor(0.2874, device='cuda:2')
discard
cal diff is tensor(570.7921, device='cuda:2')
discard
cal diff is tensor(0.4899, device='cuda:2')
discard
cal diff is tensor(3641.4297, device='cuda:2')
clipping
cal diff is tensor(2.0439, device='cuda:2')
discard
cal diff is tensor(20.3062, device='cuda:2')
discard
cal diff is tensor(0.2140, device='cuda:2')
discard
________________________________
test distance is  tensor(708.7929, device='cuda:2')
test acc is  0.9785666668229855
test loss is 0.06862658856200553
test entropy is  0.04953283521231077
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(708.7826, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0106, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(708.7928, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(708.7826, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(708.7826, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(708.7925, device='cuda:2')
test acc is  0.9785666668229855
test loss is 0.06862666218240968
test entropy is  0.04953286172298373
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(708.7822, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0102, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0030, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(708.7822, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(2.1187, device='cuda:2')
test acc is  0.9800500001563187
test loss is 0.06461561306295402
test entropy is  0.05082793794842914
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.05082793794842914
avg test loss is  0.06461561306295402
avg accuracy is  0.9800500001563187
compute_distance is  tensor(2.1187, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.019444387127607585
avg test loss is  8.561295524589035
avg accuracy is  0.1023333334896653
compute_distance is  tensor(56.5039, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(56.5039, device='cuda:2')
test acc is  0.1023333334896653
test loss is 8.561295524589035
test entropy is  0.019444387127607585
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 26, 30, 31, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 98.54% 

Test Accuracy: 98.68% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.21672366559505463
attack res is True
len of model dicts is  10
compute distance is  tensor(96.3517, device='cuda:2')
compute distance is  tensor(91.6816, device='cuda:2')
compute distance is  tensor(137.0933, device='cuda:2')
compute distance is  tensor(102.6485, device='cuda:2')
compute distance is  tensor(99.5766, device='cuda:2')
compute distance is  tensor(90.9493, device='cuda:2')
compute distance is  tensor(116.8761, device='cuda:2')
compute distance is  tensor(139.4550, device='cuda:2')
compute distance is  tensor(100.0904, device='cuda:2')
compute distance is  tensor(126.6483, device='cuda:2')
calculated distance threshold is  tensor(783.4542, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.23256666682300434
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.19935000015633633
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.11165000015633195
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.2360166668230044
====================
====================
iteration is  1
round is  1
accuracy is  0.34110000015634023
====================
________________________________
test distance is  tensor(4279.5981, device='cuda:2')
test acc is  0.11165000015633195
test loss is 17.98015799247888
test entropy is  0.03047000600508715
________________________________
diff is  tensor(43.1544, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3561, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.4814, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5111, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.5535, device='cuda:2', dtype=torch.float64)
diff is  tensor(1.9879, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3875, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1662, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3496.1440, device='cuda:2')
sum is tensor(0.1662, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5223, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0334, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0212, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4087, device='cuda:2', dtype=torch.float64)
sum is tensor(66.5631, device='cuda:2', dtype=torch.float64)
sum is tensor(638.0445, device='cuda:2', dtype=torch.float64)
sum is tensor(4279.5980, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.2151, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.5535, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.1544, device='cuda:2')
discard
cal diff is tensor(0.3561, device='cuda:2')
discard
cal diff is tensor(571.4814, device='cuda:2')
discard
cal diff is tensor(0.5111, device='cuda:2')
discard
cal diff is tensor(3641.5532, device='cuda:2')
discard
cal diff is tensor(1.9879, device='cuda:2')
discard
cal diff is tensor(20.3875, device='cuda:2')
discard
cal diff is tensor(0.1662, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9878500001563185
test loss is 0.04190968563014623
test entropy is  0.029046546363216918
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.029046546363216918
avg test loss is  0.04190968563014623
avg accuracy is  0.9878500001563185
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.06101281860315088
avg test loss is  7.0798107344966965
avg accuracy is  0.10710000015633196
compute_distance is  tensor(63.6403, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(63.6403, device='cuda:2')
test acc is  0.10710000015633196
test loss is 7.0798107344966965
test entropy is  0.06101281860315088
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 2, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 89.68% 

Test Accuracy: 90.38% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.22116944193840027
attack res is True
len of model dicts is  10
compute distance is  tensor(127.4091, device='cuda:2')
compute distance is  tensor(132.3089, device='cuda:2')
compute distance is  tensor(94.6119, device='cuda:2')
compute distance is  tensor(130.4319, device='cuda:2')
compute distance is  tensor(152.6547, device='cuda:2')
compute distance is  tensor(113.2110, device='cuda:2')
compute distance is  tensor(144.5260, device='cuda:2')
compute distance is  tensor(158.0285, device='cuda:2')
compute distance is  tensor(127.0807, device='cuda:2')
compute distance is  tensor(130.2891, device='cuda:2')
calculated distance threshold is  tensor(1090.5363, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.10605000015633197
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.1021833334896653
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.10220000015633197
====================
====================
iteration is  1
round is  0
accuracy is  0.10460000015633197
====================
====================
iteration is  1
round is  1
accuracy is  0.1855333334896689
====================
________________________________
test distance is  tensor(4284.1123, device='cuda:2')
test acc is  0.1021833334896653
test loss is 37.170513106307496
test entropy is  3.120593594928364e-05
________________________________
diff is  tensor(44.2460, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4032, device='cuda:2', dtype=torch.float64)
diff is  tensor(574.1235, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5504, device='cuda:2', dtype=torch.float64)
diff is  tensor(3642.3795, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0241, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.1629, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2227, device='cuda:2', dtype=torch.float64)
threshold is  tensor(3193.5762, device='cuda:2')
sum is tensor(0.2227, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6258, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1762, device='cuda:2', dtype=torch.float64)
sum is tensor(3.2003, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3632, device='cuda:2', dtype=torch.float64)
sum is tensor(67.6092, device='cuda:2', dtype=torch.float64)
sum is tensor(641.7327, device='cuda:2', dtype=torch.float64)
sum is tensor(4284.1122, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.2994, device='cuda:2', dtype=torch.float64)
threshold is tensor(3642.3795, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.2460, device='cuda:2')
discard
cal diff is tensor(0.4032, device='cuda:2')
discard
cal diff is tensor(574.1235, device='cuda:2')
discard
cal diff is tensor(0.5504, device='cuda:2')
discard
cal diff is tensor(3642.3794, device='cuda:2')
discard
cal diff is tensor(2.0241, device='cuda:2')
discard
cal diff is tensor(20.1629, device='cuda:2')
discard
cal diff is tensor(0.2227, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.8995500001563214
test loss is 0.3282169810394997
test entropy is  0.14293410246973354
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14293410246973354
avg test loss is  0.3282169810394997
avg accuracy is  0.8995500001563214
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.011679726092071374
avg test loss is  9.1670294799276
avg accuracy is  0.10225000015633197
compute_distance is  tensor(54.1532, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(54.1532, device='cuda:2')
test acc is  0.10225000015633197
test loss is 9.1670294799276
test entropy is  0.011679726092071374
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 34, 35, 38, 16, 18, 19, 20, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 98.68% 

Test Accuracy: 98.83% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.22274360060691833
attack res is True
len of model dicts is  10
compute distance is  tensor(95.3112, device='cuda:2')
compute distance is  tensor(111.6331, device='cuda:2')
compute distance is  tensor(67.3315, device='cuda:2')
compute distance is  tensor(104.5799, device='cuda:2')
compute distance is  tensor(92.1512, device='cuda:2')
compute distance is  tensor(85.7352, device='cuda:2')
compute distance is  tensor(164.8958, device='cuda:2')
compute distance is  tensor(150.9804, device='cuda:2')
compute distance is  tensor(70.0909, device='cuda:2')
compute distance is  tensor(94.2884, device='cuda:2')
calculated distance threshold is  tensor(1752.7460, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.36470000015634063
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2032000001563364
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.14053333348966562
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.1960166668230027
====================
====================
iteration is  1
round is  1
accuracy is  0.3035166668230064
====================
________________________________
test distance is  tensor(4281.3540, device='cuda:2')
test acc is  0.14053333348966562
test loss is 14.899305407680682
test entropy is  0.07942149021835533
________________________________
diff is  tensor(43.1594, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3782, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.6985, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5045, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.0722, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0441, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2808, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2164, device='cuda:2', dtype=torch.float64)
threshold is  tensor(2528.6079, device='cuda:2')
sum is tensor(0.2164, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5946, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0991, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1431, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4240, device='cuda:2', dtype=torch.float64)
sum is tensor(66.5834, device='cuda:2', dtype=torch.float64)
sum is tensor(640.2819, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.3541, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.4814, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.0722, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.1594, device='cuda:2')
discard
cal diff is tensor(0.3782, device='cuda:2')
discard
cal diff is tensor(573.6985, device='cuda:2')
discard
cal diff is tensor(0.5045, device='cuda:2')
discard
cal diff is tensor(3641.0723, device='cuda:2')
clipping
cal diff is tensor(2.0441, device='cuda:2')
discard
cal diff is tensor(20.2808, device='cuda:2')
discard
cal diff is tensor(0.2164, device='cuda:2')
discard
________________________________
test distance is  tensor(1752.7565, device='cuda:2')
test acc is  0.984983333489652
test loss is 0.051812744775519885
test entropy is  0.028536674676660406
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(1752.7462, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0105, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(1752.7563, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(1752.7462, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(1752.7461, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9893166668229851
test loss is 0.03775825189769529
test entropy is  0.02471340976534848
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02471340976534848
avg test loss is  0.03775825189769529
avg accuracy is  0.9893166668229851
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12404862562142836
avg test loss is  6.902242761176787
avg accuracy is  0.1228666668229986
compute_distance is  tensor(98.5331, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(98.5331, device='cuda:2')
test acc is  0.1228666668229986
test loss is 6.902242761176787
test entropy is  0.12404862562142836
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 89.08% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.21562279760837555
attack res is True
len of model dicts is  10
compute distance is  tensor(109.3497, device='cuda:2')
compute distance is  tensor(135.4189, device='cuda:2')
compute distance is  tensor(121.5283, device='cuda:2')
compute distance is  tensor(110.5404, device='cuda:2')
compute distance is  tensor(108.0286, device='cuda:2')
compute distance is  tensor(128.0595, device='cuda:2')
compute distance is  tensor(150.6259, device='cuda:2')
compute distance is  tensor(174.2196, device='cuda:2')
compute distance is  tensor(114.8903, device='cuda:2')
compute distance is  tensor(140.9887, device='cuda:2')
calculated distance threshold is  tensor(1365.8162, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.10295000015633197
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10240000015633197
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.10246666682299864
====================
====================
iteration is  1
round is  0
accuracy is  0.10231666682299863
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.1030333334896653
====================
________________________________
test distance is  tensor(4278.5488, device='cuda:2')
test acc is  0.10231666682299863
test loss is 33.72474052656943
test entropy is  0.004918480391741368
________________________________
diff is  tensor(44.2277, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3960, device='cuda:2', dtype=torch.float64)
diff is  tensor(570.4288, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5444, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.5098, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0529, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2085, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1807, device='cuda:2', dtype=torch.float64)
threshold is  tensor(2912.7327, device='cuda:2')
sum is tensor(0.1807, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5767, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1211, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1740, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3825, device='cuda:2', dtype=torch.float64)
sum is tensor(67.6102, device='cuda:2', dtype=torch.float64)
sum is tensor(638.0390, device='cuda:2', dtype=torch.float64)
sum is tensor(4278.5488, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.3752, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.5098, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.2277, device='cuda:2')
discard
cal diff is tensor(0.3960, device='cuda:2')
discard
cal diff is tensor(570.4288, device='cuda:2')
discard
cal diff is tensor(0.5444, device='cuda:2')
discard
cal diff is tensor(3640.5098, device='cuda:2')
discard
cal diff is tensor(2.0529, device='cuda:2')
discard
cal diff is tensor(20.2085, device='cuda:2')
discard
cal diff is tensor(0.1807, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.8873666668229885
test loss is 0.39384882474071914
test entropy is  0.14214140487743465
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.14214140487743465
avg test loss is  0.39384882474071914
avg accuracy is  0.8873666668229885
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.01409346227502343
avg test loss is  9.682298056352368
avg accuracy is  0.1022833334896653
compute_distance is  tensor(72.7231, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(72.7231, device='cuda:2')
test acc is  0.1022833334896653
test loss is 9.682298056352368
test entropy is  0.01409346227502343
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 26, 28, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 98.50% 

Test Accuracy: 98.67% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.21842974424362183
attack res is True
len of model dicts is  10
compute distance is  tensor(116.5567, device='cuda:2')
compute distance is  tensor(119.6760, device='cuda:2')
compute distance is  tensor(84.7089, device='cuda:2')
compute distance is  tensor(75.3340, device='cuda:2')
compute distance is  tensor(91.8118, device='cuda:2')
compute distance is  tensor(109.5227, device='cuda:2')
compute distance is  tensor(163.9432, device='cuda:2')
compute distance is  tensor(124.1710, device='cuda:2')
compute distance is  tensor(91.3506, device='cuda:2')
compute distance is  tensor(117.8864, device='cuda:2')
calculated distance threshold is  tensor(1927.5007, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.3026833334896729
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.15113333348966657
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.26131666682300525
====================
====================
iteration is  1
round is  0
accuracy is  0.16610000015633442
====================
====================
iteration is  1
round is  1
accuracy is  0.12918333348966526
====================
succ_min + 1
________________________________
test distance is  tensor(4280.1289, device='cuda:2')
test acc is  0.12918333348966526
test loss is 15.091946228734974
test entropy is  0.047537157372601314
________________________________
diff is  tensor(43.6592, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3926, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.6295, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4951, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.4033, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0381, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3093, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2024, device='cuda:2', dtype=torch.float64)
threshold is  tensor(2352.6282, device='cuda:2')
sum is tensor(0.2024, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5949, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0900, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1281, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4374, device='cuda:2', dtype=torch.float64)
sum is tensor(67.0966, device='cuda:2', dtype=torch.float64)
sum is tensor(638.7261, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.1294, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.5293, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.4033, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.6592, device='cuda:2')
discard
cal diff is tensor(0.3926, device='cuda:2')
discard
cal diff is tensor(571.6295, device='cuda:2')
discard
cal diff is tensor(0.4951, device='cuda:2')
discard
cal diff is tensor(3641.4033, device='cuda:2')
clipping
cal diff is tensor(2.0381, device='cuda:2')
discard
cal diff is tensor(20.3093, device='cuda:2')
discard
cal diff is tensor(0.2024, device='cuda:2')
discard
________________________________
test distance is  tensor(1927.5115, device='cuda:2')
test acc is  0.985583333489652
test loss is 0.05195031066879314
test entropy is  0.02728334566650594
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(1927.5012, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0107, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(1927.5115, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(1927.5012, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(1927.5012, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9876000001563185
test loss is 0.04214724196659956
test entropy is  0.02751502102559697
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.02751502102559697
avg test loss is  0.04214724196659956
avg accuracy is  0.9876000001563185
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.06433290364478887
avg test loss is  7.5525989074951045
avg accuracy is  0.12260000015633193
compute_distance is  tensor(96.4164, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(96.4164, device='cuda:2')
test acc is  0.12260000015633193
test loss is 7.5525989074951045
test entropy is  0.06433290364478887
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 17, 22, 23]
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 96.90% 

Test Accuracy: 97.25% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.21601346135139465
attack res is True
len of model dicts is  10
compute distance is  tensor(105.6769, device='cuda:2')
compute distance is  tensor(142.3456, device='cuda:2')
compute distance is  tensor(97.0078, device='cuda:2')
compute distance is  tensor(109.6941, device='cuda:2')
compute distance is  tensor(103.1004, device='cuda:2')
compute distance is  tensor(100.7754, device='cuda:2')
compute distance is  tensor(115.8289, device='cuda:2')
compute distance is  tensor(122.7634, device='cuda:2')
compute distance is  tensor(78.3018, device='cuda:2')
compute distance is  tensor(146.1937, device='cuda:2')
calculated distance threshold is  tensor(1639.3340, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.1258666668229986
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.21481666682300374
====================
====================
iteration is  0
round is  2
accuracy is  0.15518333348966695
====================
====================
iteration is  1
round is  0
accuracy is  0.11310000015633195
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.11018333348966529
====================
succ_min + 1
________________________________
test distance is  tensor(4280.4497, device='cuda:2')
test acc is  0.11018333348966529
test loss is 23.355478199306074
test entropy is  0.017670143522223635
________________________________
diff is  tensor(45.0661, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3168, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.1117, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4242, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.0429, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0576, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2219, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2086, device='cuda:2', dtype=torch.float64)
threshold is  tensor(2641.1157, device='cuda:2')
sum is tensor(0.2086, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5254, device='cuda:2', dtype=torch.float64)
sum is tensor(0.9497, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0073, device='cuda:2', dtype=torch.float64)
sum is tensor(23.2292, device='cuda:2', dtype=torch.float64)
sum is tensor(68.2953, device='cuda:2', dtype=torch.float64)
sum is tensor(639.4070, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.4499, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.4502, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.0429, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.0661, device='cuda:2')
discard
cal diff is tensor(0.3168, device='cuda:2')
discard
cal diff is tensor(571.1118, device='cuda:2')
discard
cal diff is tensor(0.4242, device='cuda:2')
discard
cal diff is tensor(3641.0430, device='cuda:2')
clipping
cal diff is tensor(2.0576, device='cuda:2')
discard
cal diff is tensor(20.2219, device='cuda:2')
discard
cal diff is tensor(0.2086, device='cuda:2')
discard
________________________________
test distance is  tensor(1639.3445, device='cuda:2')
test acc is  0.9709166668229856
test loss is 0.09203919834074582
test entropy is  0.05295003337590997
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(1639.3342, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0105, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(1639.3445, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(1639.3342, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(1639.3342, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(1639.3442, device='cuda:2')
test acc is  0.9709166668229856
test loss is 0.09203932466800076
test entropy is  0.05295006336241182
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(1639.3340, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(1639.3442, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(1639.3340, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(1639.3340, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9727666668229856
test loss is 0.08940039054560252
test entropy is  0.051942514760026544
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.051942514760026544
avg test loss is  0.08940039054560252
avg accuracy is  0.9727666668229856
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.03527368132426127
avg test loss is  8.266174445020111
avg accuracy is  0.10741666682299864
compute_distance is  tensor(78.2437, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(78.2437, device='cuda:2')
test acc is  0.10741666682299864
test loss is 8.266174445020111
test entropy is  0.03527368132426127
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 9, 10, 14, 15]
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 97.47% 

Test Accuracy: 97.75% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.21765488386154175
attack res is True
len of model dicts is  10
compute distance is  tensor(134.1912, device='cuda:2')
compute distance is  tensor(130.6308, device='cuda:2')
compute distance is  tensor(104.4364, device='cuda:2')
compute distance is  tensor(97.4236, device='cuda:2')
compute distance is  tensor(77.4812, device='cuda:2')
compute distance is  tensor(91.1787, device='cuda:2')
compute distance is  tensor(100.4663, device='cuda:2')
compute distance is  tensor(142.8507, device='cuda:2')
compute distance is  tensor(81.0751, device='cuda:2')
compute distance is  tensor(156.3696, device='cuda:2')
calculated distance threshold is  tensor(2072.7417, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.10285000015633197
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10421666682299864
====================
====================
iteration is  0
round is  2
accuracy is  0.1477500001563329
====================
====================
iteration is  1
round is  0
accuracy is  0.11088333348966528
====================
====================
iteration is  1
round is  1
accuracy is  0.24853333348967155
====================
________________________________
test distance is  tensor(4283.9141, device='cuda:2')
test acc is  0.10285000015633197
test loss is 20.364767715112485
test entropy is  0.004438544191029876
________________________________
diff is  tensor(46.0111, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3637, device='cuda:2', dtype=torch.float64)
diff is  tensor(574.0939, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3799, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.3688, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0786, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4133, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2050, device='cuda:2', dtype=torch.float64)
threshold is  tensor(2211.1724, device='cuda:2')
sum is tensor(0.2050, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5687, device='cuda:2', dtype=torch.float64)
sum is tensor(0.9486, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0271, device='cuda:2', dtype=torch.float64)
sum is tensor(23.4404, device='cuda:2', dtype=torch.float64)
sum is tensor(69.4515, device='cuda:2', dtype=torch.float64)
sum is tensor(643.5454, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.9142, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.5694, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.3688, device='cuda:2', dtype=torch.float64)
cal diff is tensor(46.0111, device='cuda:2')
discard
cal diff is tensor(0.3637, device='cuda:2')
discard
cal diff is tensor(574.0939, device='cuda:2')
discard
cal diff is tensor(0.3799, device='cuda:2')
discard
cal diff is tensor(3640.3689, device='cuda:2')
clipping
cal diff is tensor(2.0786, device='cuda:2')
discard
cal diff is tensor(20.4133, device='cuda:2')
discard
cal diff is tensor(0.2050, device='cuda:2')
discard
________________________________
test distance is  tensor(2072.7520, device='cuda:2')
test acc is  0.9766000001563189
test loss is 0.08113721436300282
test entropy is  0.04282420926934867
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(2072.7419, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(2072.7522, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(2072.7419, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(2072.7417, device='cuda:2')
discard
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9790166668229854
test loss is 0.06933877817947257
test entropy is  0.041949699406632714
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.041949699406632714
avg test loss is  0.06933877817947257
avg accuracy is  0.9790166668229854
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.006263382853875592
avg test loss is  10.641278511425579
avg accuracy is  0.10221666682299864
compute_distance is  tensor(74.4884, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(74.4884, device='cuda:2')
test acc is  0.10221666682299864
test loss is 10.641278511425579
test entropy is  0.006263382853875592
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 35, 38]
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 97.36% 

Test Accuracy: 97.68% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.2187773436307907
attack res is True
len of model dicts is  10
compute distance is  tensor(122.8307, device='cuda:2')
compute distance is  tensor(135.5020, device='cuda:2')
compute distance is  tensor(89.8772, device='cuda:2')
compute distance is  tensor(85.0359, device='cuda:2')
compute distance is  tensor(121.4924, device='cuda:2')
compute distance is  tensor(133.2759, device='cuda:2')
compute distance is  tensor(134.1050, device='cuda:2')
compute distance is  tensor(145.7074, device='cuda:2')
compute distance is  tensor(91.0146, device='cuda:2')
compute distance is  tensor(133.7310, device='cuda:2')
calculated distance threshold is  tensor(1773.0040, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.14230000015633243
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.11505000015633193
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.11500000015633195
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.10666666682299863
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.10868333348966529
====================
________________________________
test distance is  tensor(4283.6631, device='cuda:2')
test acc is  0.10666666682299863
test loss is 21.945658624807656
test entropy is  0.10613318727310024
________________________________
diff is  tensor(43.8035, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3188, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.4492, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4923, device='cuda:2', dtype=torch.float64)
diff is  tensor(3643.0260, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0538, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3251, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1944, device='cuda:2', dtype=torch.float64)
threshold is  tensor(2510.6592, device='cuda:2')
sum is tensor(0.1944, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5132, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0056, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0594, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3844, device='cuda:2', dtype=torch.float64)
sum is tensor(67.1880, device='cuda:2', dtype=torch.float64)
sum is tensor(640.6372, device='cuda:2', dtype=torch.float64)
sum is tensor(4283.6632, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.4867, device='cuda:2', dtype=torch.float64)
threshold is tensor(3643.0260, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.8035, device='cuda:2')
discard
cal diff is tensor(0.3188, device='cuda:2')
discard
cal diff is tensor(573.4492, device='cuda:2')
discard
cal diff is tensor(0.4923, device='cuda:2')
discard
cal diff is tensor(3643.0259, device='cuda:2')
discard
cal diff is tensor(2.0538, device='cuda:2')
discard
cal diff is tensor(20.3251, device='cuda:2')
discard
cal diff is tensor(0.1944, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9780166668229855
test loss is 0.07266657806863021
test entropy is  0.044002764836586175
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.044002764836586175
avg test loss is  0.07266657806863021
avg accuracy is  0.9780166668229855
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16407690966116595
avg test loss is  7.91793202286336
avg accuracy is  0.1038833334896653
compute_distance is  tensor(75.9081, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(75.9081, device='cuda:2')
test acc is  0.1038833334896653
test loss is 7.91793202286336
test entropy is  0.16407690966116595
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 26, 29, 31, 16, 17, 18, 19, 20, 22, 23, 8, 9, 11, 13, 14, 15]
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 98.83% 

Test Accuracy: 98.90% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.22432100772857666
attack res is True
len of model dicts is  10
compute distance is  tensor(129.6955, device='cuda:2')
compute distance is  tensor(94.0611, device='cuda:2')
compute distance is  tensor(87.1704, device='cuda:2')
compute distance is  tensor(93.8729, device='cuda:2')
compute distance is  tensor(107.8231, device='cuda:2')
compute distance is  tensor(78.4127, device='cuda:2')
compute distance is  tensor(117.3330, device='cuda:2')
compute distance is  tensor(151.1332, device='cuda:2')
compute distance is  tensor(110.2036, device='cuda:2')
compute distance is  tensor(107.6900, device='cuda:2')
calculated distance threshold is  tensor(2303.9185, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.3793166668230075
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.2585666668230052
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.23758333348967123
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.22638333348967074
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.30065000015633964
====================
________________________________
test distance is  tensor(4286.0825, device='cuda:2')
test acc is  0.22638333348967074
test loss is 15.831743204771582
test entropy is  0.22676325097743635
________________________________
diff is  tensor(45.4675, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3308, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.9794, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5022, device='cuda:2', dtype=torch.float64)
diff is  tensor(3643.0991, device='cuda:2', dtype=torch.float64)
diff is  tensor(1.9919, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4746, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2372, device='cuda:2', dtype=torch.float64)
threshold is  tensor(1982.1641, device='cuda:2')
sum is tensor(0.2372, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5679, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0702, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0621, device='cuda:2', dtype=torch.float64)
sum is tensor(23.5367, device='cuda:2', dtype=torch.float64)
sum is tensor(69.0042, device='cuda:2', dtype=torch.float64)
sum is tensor(642.9836, device='cuda:2', dtype=torch.float64)
sum is tensor(4286.0827, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.6324, device='cuda:2', dtype=torch.float64)
threshold is tensor(3643.0991, device='cuda:2', dtype=torch.float64)
cal diff is tensor(45.4675, device='cuda:2')
discard
cal diff is tensor(0.3308, device='cuda:2')
discard
cal diff is tensor(573.9794, device='cuda:2')
discard
cal diff is tensor(0.5022, device='cuda:2')
discard
cal diff is tensor(3643.0991, device='cuda:2')
clipping
cal diff is tensor(1.9919, device='cuda:2')
discard
cal diff is tensor(20.4746, device='cuda:2')
discard
cal diff is tensor(0.2372, device='cuda:2')
discard
________________________________
test distance is  tensor(2303.9285, device='cuda:2')
test acc is  0.9842666668229852
test loss is 0.057115354630255744
test entropy is  0.029036115018313248
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(2303.9186, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0100, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0232, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(2303.9185, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(53.4709, device='cuda:2')
test acc is  0.990516666822985
test loss is 0.033609949761446635
test entropy is  0.022073956974100997
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.022073956974100997
avg test loss is  0.033609949761446635
avg accuracy is  0.990516666822985
compute_distance is  tensor(53.4709, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4306266175658464
avg test loss is  5.16160545826975
avg accuracy is  0.2250000001563374
compute_distance is  tensor(99.9468, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(99.9468, device='cuda:2')
test acc is  0.2250000001563374
test loss is 5.16160545826975
test entropy is  0.4306266175658464
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 92.30% 

Test Accuracy: 92.71% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.22594159841537476
attack res is True
len of model dicts is  10
compute distance is  tensor(124.6316, device='cuda:2')
compute distance is  tensor(135.1021, device='cuda:2')
compute distance is  tensor(108.9118, device='cuda:2')
compute distance is  tensor(102.8828, device='cuda:2')
compute distance is  tensor(118.1620, device='cuda:2')
compute distance is  tensor(138.5486, device='cuda:2')
compute distance is  tensor(139.7699, device='cuda:2')
compute distance is  tensor(150.2409, device='cuda:2')
compute distance is  tensor(107.1788, device='cuda:2')
compute distance is  tensor(152.9358, device='cuda:2')
calculated distance threshold is  tensor(1787.8646, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.1176666668229986
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.21851666682300377
====================
====================
iteration is  0
round is  2
accuracy is  0.1348000001563319
====================
====================
iteration is  1
round is  0
accuracy is  0.10505000015633197
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.11305000015633196
====================
________________________________
test distance is  tensor(4281.5908, device='cuda:2')
test acc is  0.10505000015633197
test loss is 28.264740498589553
test entropy is  0.020830490788606715
________________________________
diff is  tensor(43.1930, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3446, device='cuda:2', dtype=torch.float64)
diff is  tensor(573.8698, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5024, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.1895, device='cuda:2', dtype=torch.float64)
diff is  tensor(1.9939, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2809, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2168, device='cuda:2', dtype=torch.float64)
threshold is  tensor(2493.7261, device='cuda:2')
sum is tensor(0.2168, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5614, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0638, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0577, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3386, device='cuda:2', dtype=torch.float64)
sum is tensor(66.5316, device='cuda:2', dtype=torch.float64)
sum is tensor(640.4014, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.5909, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.4910, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.1895, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.1930, device='cuda:2')
discard
cal diff is tensor(0.3446, device='cuda:2')
discard
cal diff is tensor(573.8699, device='cuda:2')
discard
cal diff is tensor(0.5024, device='cuda:2')
discard
cal diff is tensor(3641.1895, device='cuda:2')
discard
cal diff is tensor(1.9939, device='cuda:2')
discard
cal diff is tensor(20.2809, device='cuda:2')
discard
cal diff is tensor(0.2168, device='cuda:2')
discard
________________________________
test distance is  tensor(0.0676, device='cuda:2')
test acc is  0.9251833334896538
test loss is 0.2448093691688857
test entropy is  0.15738344609713567
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15738344609713567
avg test loss is  0.2448093691688857
avg accuracy is  0.9251833334896538
compute_distance is  tensor(0.0676, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.03691030707635255
avg test loss is  8.766843036293729
avg accuracy is  0.10256666682299863
compute_distance is  tensor(63.7225, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(63.7225, device='cuda:2')
test acc is  0.10256666682299863
test loss is 8.766843036293729
test entropy is  0.03691030707635255
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [1, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 9, 10, 12, 14, 15]
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 98.27% 

Test Accuracy: 98.52% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.22566628456115723
attack res is True
len of model dicts is  10
compute distance is  tensor(133.3378, device='cuda:2')
compute distance is  tensor(111.8603, device='cuda:2')
compute distance is  tensor(81.3467, device='cuda:2')
compute distance is  tensor(112.3109, device='cuda:2')
compute distance is  tensor(83.6884, device='cuda:2')
compute distance is  tensor(94.7453, device='cuda:2')
compute distance is  tensor(110.5379, device='cuda:2')
compute distance is  tensor(124.9291, device='cuda:2')
compute distance is  tensor(72.4951, device='cuda:2')
compute distance is  tensor(106.5578, device='cuda:2')
calculated distance threshold is  tensor(2325.5195, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.11495000015633194
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.17980000015633527
====================
====================
iteration is  0
round is  2
accuracy is  0.13915000015633217
====================
====================
iteration is  1
round is  0
accuracy is  0.18855000015633577
====================
====================
iteration is  1
round is  1
accuracy is  0.16510000015633425
====================
________________________________
test distance is  tensor(4280.7095, device='cuda:2')
test acc is  0.11495000015633194
test loss is 18.664135916655
test entropy is  0.08454611377000237
________________________________
diff is  tensor(43.3952, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3609, device='cuda:2', dtype=torch.float64)
diff is  tensor(572.9014, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5197, device='cuda:2', dtype=torch.float64)
diff is  tensor(3640.8051, device='cuda:2', dtype=torch.float64)
diff is  tensor(1.9986, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.4928, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2358, device='cuda:2', dtype=torch.float64)
threshold is  tensor(1955.1899, device='cuda:2')
sum is tensor(0.2358, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5966, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1164, device='cuda:2', dtype=torch.float64)
sum is tensor(3.1149, device='cuda:2', dtype=torch.float64)
sum is tensor(23.6078, device='cuda:2', dtype=torch.float64)
sum is tensor(67.0030, device='cuda:2', dtype=torch.float64)
sum is tensor(639.9043, device='cuda:2', dtype=torch.float64)
sum is tensor(4280.7095, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.6387, device='cuda:2', dtype=torch.float64)
threshold is tensor(3640.8051, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.3952, device='cuda:2')
discard
cal diff is tensor(0.3609, device='cuda:2')
discard
cal diff is tensor(572.9014, device='cuda:2')
discard
cal diff is tensor(0.5197, device='cuda:2')
discard
cal diff is tensor(3640.8052, device='cuda:2')
clipping
cal diff is tensor(1.9986, device='cuda:2')
discard
cal diff is tensor(20.4928, device='cuda:2')
discard
cal diff is tensor(0.2358, device='cuda:2')
discard
________________________________
test distance is  tensor(2325.5295, device='cuda:2')
test acc is  0.9847000001563186
test loss is 0.052543691005999975
test entropy is  0.030743196825791304
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(2325.5195, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0100, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.0232, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(2325.5195, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(53.9721, device='cuda:2')
test acc is  0.9861166668229852
test loss is 0.04685254120045538
test entropy is  0.0322267177307561
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.0322267177307561
avg test loss is  0.04685254120045538
avg accuracy is  0.9861166668229852
compute_distance is  tensor(53.9721, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1331025624016264
avg test loss is  8.07664910054156
avg accuracy is  0.10908333348966529
compute_distance is  tensor(107.0070, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(107.0070, device='cuda:2')
test acc is  0.10908333348966529
test loss is 8.07664910054156
test entropy is  0.1331025624016264
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 20, 22]
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 97.40% 

Test Accuracy: 97.62% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.22346079349517822
attack res is True
len of model dicts is  10
compute distance is  tensor(127.1400, device='cuda:2')
compute distance is  tensor(106.5683, device='cuda:2')
compute distance is  tensor(157.0559, device='cuda:2')
compute distance is  tensor(84.3694, device='cuda:2')
compute distance is  tensor(137.7693, device='cuda:2')
compute distance is  tensor(104.7209, device='cuda:2')
compute distance is  tensor(131.1843, device='cuda:2')
compute distance is  tensor(113.7580, device='cuda:2')
compute distance is  tensor(82.6920, device='cuda:2')
compute distance is  tensor(117.6356, device='cuda:2')
calculated distance threshold is  tensor(3111.7825, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.137250000156332
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10300000015633197
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.10220000015633197
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.19895000015633627
====================
====================
iteration is  1
round is  1
accuracy is  0.15698333348966695
====================
________________________________
test distance is  tensor(4281.0845, device='cuda:2')
test acc is  0.10220000015633197
test loss is 33.058298167897696
test entropy is  0.0001571644531548003
________________________________
diff is  tensor(44.8394, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3500, device='cuda:2', dtype=torch.float64)
diff is  tensor(571.2996, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.4774, device='cuda:2', dtype=torch.float64)
diff is  tensor(3641.6308, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0137, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.2855, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.1874, device='cuda:2', dtype=torch.float64)
threshold is  tensor(1169.3020, device='cuda:2')
sum is tensor(0.1874, device='cuda:2', dtype=torch.float64)
sum is tensor(0.5374, device='cuda:2', dtype=torch.float64)
sum is tensor(1.0148, device='cuda:2', dtype=torch.float64)
sum is tensor(3.0286, device='cuda:2', dtype=torch.float64)
sum is tensor(23.3141, device='cuda:2', dtype=torch.float64)
sum is tensor(68.1535, device='cuda:2', dtype=torch.float64)
sum is tensor(639.4530, device='cuda:2', dtype=torch.float64)
sum is tensor(4281.0838, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.8545, device='cuda:2', dtype=torch.float64)
threshold is tensor(3641.6308, device='cuda:2', dtype=torch.float64)
cal diff is tensor(44.8394, device='cuda:2')
discard
cal diff is tensor(0.3500, device='cuda:2')
discard
cal diff is tensor(571.2996, device='cuda:2')
discard
cal diff is tensor(0.4774, device='cuda:2')
discard
cal diff is tensor(3641.6309, device='cuda:2')
clipping
cal diff is tensor(2.0137, device='cuda:2')
discard
cal diff is tensor(20.2855, device='cuda:2')
discard
cal diff is tensor(0.1874, device='cuda:2')
discard
________________________________
test distance is  tensor(3111.7917, device='cuda:2')
test acc is  0.9709000001563189
test loss is 0.1041218067003627
test entropy is  0.04831006262810833
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3111.7818, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0093, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
ratio is tensor(0.1041, device='cuda:2')
threshold is tensor(0.0091, device='cuda:2')
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
clipping
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3111.7817, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(324.0280, device='cuda:2')
test acc is  0.9776500001563189
test loss is 0.07444525861911025
test entropy is  0.049839189431361
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.049839189431361
avg test loss is  0.07444525861911025
avg accuracy is  0.9776500001563189
compute_distance is  tensor(324.0280, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.017233225596901863
avg test loss is  9.551890014839579
avg accuracy is  0.10255000015633196
compute_distance is  tensor(313.8277, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(313.8277, device='cuda:2')
test acc is  0.10255000015633196
test loss is 9.551890014839579
test entropy is  0.017233225596901863
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 98.75% 

Test Accuracy: 98.96% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  0.2326141893863678
attack res is True
len of model dicts is  10
compute distance is  tensor(104.0175, device='cuda:2')
compute distance is  tensor(79.8556, device='cuda:2')
compute distance is  tensor(86.0301, device='cuda:2')
compute distance is  tensor(74.4772, device='cuda:2')
compute distance is  tensor(65.6868, device='cuda:2')
compute distance is  tensor(96.4999, device='cuda:2')
compute distance is  tensor(116.1976, device='cuda:2')
compute distance is  tensor(131.5388, device='cuda:2')
compute distance is  tensor(86.6282, device='cuda:2')
compute distance is  tensor(108.2926, device='cuda:2')
calculated distance threshold is  tensor(3016.2957, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5562500001563413
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3304833334896734
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.18411666682300218
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.36635000015634067
====================
====================
iteration is  1
round is  1
accuracy is  0.4960166668230087
====================
________________________________
test distance is  tensor(4282.3652, device='cuda:2')
test acc is  0.18411666682300218
test loss is 9.94631464649111
test entropy is  0.24324435051252594
________________________________
diff is  tensor(43.2756, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.3574, device='cuda:2', dtype=torch.float64)
diff is  tensor(572.4969, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.5649, device='cuda:2', dtype=torch.float64)
diff is  tensor(3643.0136, device='cuda:2', dtype=torch.float64)
diff is  tensor(2.0676, device='cuda:2', dtype=torch.float64)
diff is  tensor(20.3410, device='cuda:2', dtype=torch.float64)
diff is  tensor(0.2484, device='cuda:2', dtype=torch.float64)
threshold is  tensor(1266.0696, device='cuda:2')
sum is tensor(0.2484, device='cuda:2', dtype=torch.float64)
sum is tensor(0.6058, device='cuda:2', dtype=torch.float64)
sum is tensor(1.1707, device='cuda:2', dtype=torch.float64)
sum is tensor(3.2383, device='cuda:2', dtype=torch.float64)
sum is tensor(23.5793, device='cuda:2', dtype=torch.float64)
sum is tensor(66.8549, device='cuda:2', dtype=torch.float64)
sum is tensor(639.3518, device='cuda:2', dtype=torch.float64)
sum is tensor(4282.3654, device='cuda:2', dtype=torch.float64)
ratio is tensor(0.8280, device='cuda:2', dtype=torch.float64)
threshold is tensor(3643.0136, device='cuda:2', dtype=torch.float64)
cal diff is tensor(43.2756, device='cuda:2')
discard
cal diff is tensor(0.3574, device='cuda:2')
discard
cal diff is tensor(572.4969, device='cuda:2')
discard
cal diff is tensor(0.5649, device='cuda:2')
discard
cal diff is tensor(3643.0137, device='cuda:2')
clipping
cal diff is tensor(2.0676, device='cuda:2')
discard
cal diff is tensor(20.3410, device='cuda:2')
discard
cal diff is tensor(0.2484, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425737615442
test entropy is  0.026403435629185443
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1.0000, device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
________________________________
test distance is  tensor(3016.3059, device='cuda:2')
test acc is  0.9825166668229854
test loss is 0.06416425590875356
test entropy is  0.026403437743990423
________________________________
diff is  tensor(0.0008, device='cuda:2')
diff is  tensor(5.6569e-06, device='cuda:2')
diff is  tensor(0.0091, device='cuda:2')
diff is  tensor(8.0000e-06, device='cuda:2')
diff is  tensor(3016.2959, device='cuda:2', dtype=torch.float64)
diff is  tensor(3.2000e-05, device='cuda:2')
diff is  tensor(0.0003, device='cuda:2')
diff is  tensor(3.1623e-06, device='cuda:2')
threshold is  tensor(0.0103, device='cuda:2')
sum is tensor(3.1623e-06, device='cuda:2')
sum is tensor(8.8191e-06, device='cuda:2')
sum is tensor(1.6819e-05, device='cuda:2')
sum is tensor(4.8819e-05, device='cuda:2')
sum is tensor(0.0004, device='cuda:2')
sum is tensor(0.0012, device='cuda:2')
sum is tensor(0.0102, device='cuda:2')
sum is tensor(3016.3062, device='cuda:2')
ratio is tensor(1., device='cuda:2', dtype=torch.float64)
threshold is tensor(3016.2959, device='cuda:2', dtype=torch.float64)
cal diff is tensor(0.0008, device='cuda:2')
discard
cal diff is tensor(5.6569e-06, device='cuda:2')
discard
cal diff is tensor(0.0091, device='cuda:2')
discard
cal diff is tensor(8.0000e-06, device='cuda:2')
discard
cal diff is tensor(3016.2959, device='cuda:2')
clipping
cal diff is tensor(3.2000e-05, device='cuda:2')
discard
cal diff is tensor(0.0003, device='cuda:2')
discard
cal diff is tensor(3.1623e-06, device='cuda:2')
discard
reach max round
new distance ratio is 40.73333001135848
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 98.53% 

Test Accuracy: 98.80% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  1.8393442630767822
attack res is True
len of model dicts is  10
compute distance is  tensor(189.2999, device='cuda:2')
compute distance is  tensor(195.2933, device='cuda:2')
compute distance is  tensor(130.0977, device='cuda:2')
compute distance is  tensor(141.0734, device='cuda:2')
compute distance is  tensor(257.7744, device='cuda:2')
compute distance is  tensor(115.0001, device='cuda:2')
compute distance is  tensor(200.2941, device='cuda:2')
compute distance is  tensor(208.5773, device='cuda:2')
compute distance is  tensor(224.1693, device='cuda:2')
compute distance is  tensor(162.8574, device='cuda:2')
calculated distance threshold is  tensor(6512.2412, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.42380000015634134
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.27296666682300563
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.43730000015634146
====================
====================
iteration is  1
round is  0
accuracy is  0.3933833334896743
====================
====================
iteration is  1
round is  1
accuracy is  0.3737500001563408
====================
________________________________
test distance is  tensor(4282.6411, device='cuda:2')
test acc is  0.27296666682300563
test loss is 6.297936394524727
test entropy is  0.2970481846155897
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 20, 23, 9, 10, 11, 13, 14, 15]
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 98.44% 

Test Accuracy: 98.77% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  1.7607693672180176
attack res is True
len of model dicts is  10
compute distance is  tensor(147.7686, device='cuda:2')
compute distance is  tensor(137.6266, device='cuda:2')
compute distance is  tensor(96.0547, device='cuda:2')
compute distance is  tensor(105.2259, device='cuda:2')
compute distance is  tensor(128.8605, device='cuda:2')
compute distance is  tensor(142.1676, device='cuda:2')
compute distance is  tensor(226.9921, device='cuda:2')
compute distance is  tensor(217.5382, device='cuda:2')
compute distance is  tensor(182.8813, device='cuda:2')
compute distance is  tensor(194.8561, device='cuda:2')
calculated distance threshold is  tensor(6549.6099, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5763833334896731
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.1207666668229986
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.42605000015634137
====================
====================
iteration is  1
round is  0
accuracy is  0.5474666668230089
====================
====================
iteration is  1
round is  1
accuracy is  0.4626833334896751
====================
________________________________
test distance is  tensor(4282.4146, device='cuda:2')
test acc is  0.1207666668229986
test loss is 13.789777244331994
test entropy is  0.08859536109138717
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [1, 2, 4, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 91.47% 

Test Accuracy: 91.48% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  3.2362234592437744
attack res is True
len of model dicts is  10
compute distance is  tensor(455.0240, device='cuda:2')
compute distance is  tensor(510.3209, device='cuda:2')
compute distance is  tensor(441.8309, device='cuda:2')
compute distance is  tensor(552.6793, device='cuda:2')
compute distance is  tensor(549.6853, device='cuda:2')
compute distance is  tensor(395.7965, device='cuda:2')
compute distance is  tensor(493.5719, device='cuda:2')
compute distance is  tensor(452.7741, device='cuda:2')
compute distance is  tensor(421.3543, device='cuda:2')
compute distance is  tensor(434.0905, device='cuda:2')
calculated distance threshold is  tensor(8901.3662, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.19633333348966933
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.27425000015633894
====================
====================
iteration is  0
round is  2
accuracy is  0.20130000015633634
====================
====================
iteration is  1
round is  0
accuracy is  0.38911666682300766
====================
====================
iteration is  1
round is  1
accuracy is  0.30618333348967297
====================
________________________________
test distance is  tensor(4279.8179, device='cuda:2')
test acc is  0.19633333348966933
test loss is 14.91561199200433
test entropy is  0.0996325785504666
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 26, 30, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 98.02% 

Test Accuracy: 98.38% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  2.781691789627075
attack res is True
len of model dicts is  10
compute distance is  tensor(174.8532, device='cuda:2')
compute distance is  tensor(244.8433, device='cuda:2')
compute distance is  tensor(168.0663, device='cuda:2')
compute distance is  tensor(205.0708, device='cuda:2')
compute distance is  tensor(172.5485, device='cuda:2')
compute distance is  tensor(148.0523, device='cuda:2')
compute distance is  tensor(288.8866, device='cuda:2')
compute distance is  tensor(216.4413, device='cuda:2')
compute distance is  tensor(240.0793, device='cuda:2')
compute distance is  tensor(192.3379, device='cuda:2')
calculated distance threshold is  tensor(8547.0830, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8328166668229907
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7950666668229923
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.7756166668229934
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.7803666668229932
====================
====================
iteration is  1
round is  1
accuracy is  0.7869000001563261
====================
________________________________
test distance is  tensor(4281.9004, device='cuda:2')
test acc is  0.7756166668229934
test loss is 1.5498846624769382
test entropy is  0.17011885554678657
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 34, 35, 16, 17, 18, 19, 20, 21, 22, 23]
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 98.21% 

Test Accuracy: 98.42% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  2.5449254512786865
attack res is True
len of model dicts is  10
compute distance is  tensor(185.9390, device='cuda:2')
compute distance is  tensor(164.5106, device='cuda:2')
compute distance is  tensor(193.8545, device='cuda:2')
compute distance is  tensor(108.8150, device='cuda:2')
compute distance is  tensor(274.7702, device='cuda:2')
compute distance is  tensor(182.3497, device='cuda:2')
compute distance is  tensor(181.6636, device='cuda:2')
compute distance is  tensor(216.9631, device='cuda:2')
compute distance is  tensor(150.9359, device='cuda:2')
compute distance is  tensor(171.6059, device='cuda:2')
calculated distance threshold is  tensor(10995.7139, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.7674000001563271
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8213666668229912
====================
====================
iteration is  0
round is  2
accuracy is  0.8765000001563222
====================
====================
iteration is  1
round is  0
accuracy is  0.6764000001563322
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7101666668229968
====================
====================
iteration is  1
round is  2
accuracy is  0.6975833334896643
====================
________________________________
test distance is  tensor(4711.0195, device='cuda:2')
test acc is  0.6764000001563322
test loss is 1.5803011844534356
test entropy is  0.3100247555640715
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 12, 13, 14]
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 98.33% 

Test Accuracy: 98.40% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  3.324298620223999
attack res is True
len of model dicts is  10
compute distance is  tensor(263.2622, device='cuda:2')
compute distance is  tensor(289.1385, device='cuda:2')
compute distance is  tensor(351.9493, device='cuda:2')
compute distance is  tensor(253.6680, device='cuda:2')
compute distance is  tensor(357.9760, device='cuda:2')
compute distance is  tensor(293.4312, device='cuda:2')
compute distance is  tensor(334.8885, device='cuda:2')
compute distance is  tensor(361.6853, device='cuda:2')
compute distance is  tensor(386.0880, device='cuda:2')
compute distance is  tensor(339.7804, device='cuda:2')
calculated distance threshold is  tensor(9809.2988, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.7477333334896615
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.754383333489661
====================
====================
iteration is  0
round is  2
accuracy is  0.8116333334896583
====================
====================
iteration is  1
round is  0
accuracy is  0.7164833334896632
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.689916666822998
====================
succ_min + 1
________________________________
test distance is  tensor(4279.3374, device='cuda:2')
test acc is  0.689916666822998
test loss is 1.6160813645958139
test entropy is  0.2728469036598958
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [1, 2, 3, 4, 6, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 97.15% 

Test Accuracy: 97.68% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  4.377339839935303
attack res is True
len of model dicts is  10
compute distance is  tensor(520.2395, device='cuda:2')
compute distance is  tensor(799.1885, device='cuda:2')
compute distance is  tensor(850.1580, device='cuda:2')
compute distance is  tensor(710.8594, device='cuda:2')
compute distance is  tensor(997.8737, device='cuda:2')
compute distance is  tensor(1037.6482, device='cuda:2')
compute distance is  tensor(644.7258, device='cuda:2')
compute distance is  tensor(625.5034, device='cuda:2')
compute distance is  tensor(769.1082, device='cuda:2')
compute distance is  tensor(684.7515, device='cuda:2')
calculated distance threshold is  tensor(41590.9688, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.7049166668229971
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.6577166668230001
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.6607000001563332
====================
====================
iteration is  1
round is  0
accuracy is  0.6941333334896644
====================
====================
iteration is  1
round is  1
accuracy is  0.6185500001563363
====================
succ_min + 1
________________________________
test distance is  tensor(4282.9570, device='cuda:2')
test acc is  0.6185500001563363
test loss is 2.518618579485269
test entropy is  0.2378788041963633
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 97.37% 

Test Accuracy: 97.91% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  3.625559091567993
attack res is True
len of model dicts is  10
compute distance is  tensor(138.5938, device='cuda:2')
compute distance is  tensor(136.4731, device='cuda:2')
compute distance is  tensor(102.3678, device='cuda:2')
compute distance is  tensor(127.1894, device='cuda:2')
compute distance is  tensor(126.3020, device='cuda:2')
compute distance is  tensor(167.9109, device='cuda:2')
compute distance is  tensor(155.9526, device='cuda:2')
compute distance is  tensor(191.0350, device='cuda:2')
compute distance is  tensor(110.8279, device='cuda:2')
compute distance is  tensor(196.0571, device='cuda:2')
calculated distance threshold is  tensor(8282.8955, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9461500001563197
====================
====================
iteration is  0
round is  1
accuracy is  0.9502000001563197
====================
====================
iteration is  0
round is  2
accuracy is  0.9256833334896539
====================
====================
iteration is  1
round is  0
accuracy is  0.8789000001563223
====================
====================
iteration is  1
round is  1
accuracy is  0.9273833334896537
====================
====================
iteration is  1
round is  2
accuracy is  0.9262833334896539
====================
====================
iteration is  2
round is  0
accuracy is  0.8533333334896566
====================
====================
iteration is  2
round is  1
accuracy is  0.8404666668229904
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.8845166668229886
====================
====================
iteration is  3
round is  0
accuracy is  0.6866500001563316
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.7126500001563302
====================
====================
iteration is  3
round is  2
accuracy is  0.8076500001563252
====================
====================
iteration is  4
round is  0
accuracy is  0.7787833334896598
====================
________________________________
test distance is  tensor(5700.8359, device='cuda:2')
test acc is  0.6866500001563316
test loss is 1.6141314925288341
test entropy is  0.2528734482459422
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 1, 3, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 95.12% 

Test Accuracy: 96.04% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  5.276528835296631
attack res is True
len of model dicts is  10
compute distance is  tensor(949.2620, device='cuda:2')
compute distance is  tensor(682.9309, device='cuda:2')
compute distance is  tensor(737.6890, device='cuda:2')
compute distance is  tensor(1031.9701, device='cuda:2')
compute distance is  tensor(885.0732, device='cuda:2')
compute distance is  tensor(873.9579, device='cuda:2')
compute distance is  tensor(1064.6071, device='cuda:2')
compute distance is  tensor(791.3246, device='cuda:2')
compute distance is  tensor(963.2964, device='cuda:2')
compute distance is  tensor(794.5557, device='cuda:2')
calculated distance threshold is  tensor(37341.8008, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8071666668229919
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.582216666823006
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8300666668229909
====================
====================
iteration is  1
round is  0
accuracy is  0.677616666822999
====================
====================
iteration is  1
round is  1
accuracy is  0.7633333334896607
====================
________________________________
test distance is  tensor(4282.6055, device='cuda:2')
test acc is  0.582216666823006
test loss is 3.076176403491482
test entropy is  0.18342876281025314
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 95.84% 

Test Accuracy: 96.20% 


 | Global Training Round : 51 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  4.568964958190918
attack res is True
len of model dicts is  10
compute distance is  tensor(129.1210, device='cuda:2')
compute distance is  tensor(185.4653, device='cuda:2')
compute distance is  tensor(125.0625, device='cuda:2')
compute distance is  tensor(174.9005, device='cuda:2')
compute distance is  tensor(203.0218, device='cuda:2')
compute distance is  tensor(124.9199, device='cuda:2')
compute distance is  tensor(166.9918, device='cuda:2')
compute distance is  tensor(221.0236, device='cuda:2')
compute distance is  tensor(145.9807, device='cuda:2')
compute distance is  tensor(145.3244, device='cuda:2')
calculated distance threshold is  tensor(10278.4443, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9185166668229874
====================
====================
iteration is  0
round is  1
accuracy is  0.9368833334896534
====================
====================
iteration is  0
round is  2
accuracy is  0.8791000001563223
====================
====================
iteration is  1
round is  0
accuracy is  0.8760500001563224
====================
====================
iteration is  1
round is  1
accuracy is  0.8856166668229887
====================
====================
iteration is  1
round is  2
accuracy is  0.8132666668229915
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.829466666822991
====================
====================
iteration is  2
round is  1
accuracy is  0.7445333334896617
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.7833333334896596
====================
====================
iteration is  3
round is  0
accuracy is  0.8129500001563249
====================
________________________________
test distance is  tensor(5182.2173, device='cuda:2')
test acc is  0.7445333334896617
test loss is 0.7713716304156063
test entropy is  0.47817575041927507
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 20, 23]
 
Avg Training Stats after 51 global rounds:
Train Accuracy: 97.15% 

Test Accuracy: 97.52% 


 | Global Training Round : 52 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  4.995991230010986
attack res is True
len of model dicts is  10
compute distance is  tensor(313.7458, device='cuda:2')
compute distance is  tensor(229.6484, device='cuda:2')
compute distance is  tensor(163.7590, device='cuda:2')
compute distance is  tensor(194.7291, device='cuda:2')
compute distance is  tensor(182.7236, device='cuda:2')
compute distance is  tensor(165.1751, device='cuda:2')
compute distance is  tensor(228.0229, device='cuda:2')
compute distance is  tensor(235.7772, device='cuda:2')
compute distance is  tensor(401.1583, device='cuda:2')
compute distance is  tensor(265.4883, device='cuda:2')
calculated distance threshold is  tensor(27753.5703, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9257166668229871
====================
====================
iteration is  0
round is  1
accuracy is  0.9341000001563202
====================
====================
iteration is  0
round is  2
accuracy is  0.8919666668229884
====================
====================
iteration is  1
round is  0
accuracy is  0.9198166668229873
====================
====================
iteration is  1
round is  1
accuracy is  0.8999833334896546
====================
====================
iteration is  1
round is  2
accuracy is  0.84856666682299
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.8643500001563229
====================
====================
iteration is  2
round is  1
accuracy is  0.7445833334896619
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.8652000001563227
====================
====================
iteration is  3
round is  0
accuracy is  0.7548833334896612
====================
====================
iteration is  3
round is  1
accuracy is  0.8628666668229895
====================
====================
iteration is  3
round is  2
accuracy is  0.5867666668230055
====================
succ_min + 1
====================
iteration is  4
round is  0
accuracy is  0.6753000001563323
====================
________________________________
test distance is  tensor(5703.1675, device='cuda:2')
test acc is  0.5867666668230055
test loss is 2.1851071224792173
test entropy is  0.3021297159352536
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 29, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 52 global rounds:
Train Accuracy: 97.43% 

Test Accuracy: 97.82% 


 | Global Training Round : 53 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  5.045036315917969
attack res is True
len of model dicts is  10
compute distance is  tensor(380.1197, device='cuda:2')
compute distance is  tensor(279.1126, device='cuda:2')
compute distance is  tensor(287.4803, device='cuda:2')
compute distance is  tensor(206.8687, device='cuda:2')
compute distance is  tensor(109.7138, device='cuda:2')
compute distance is  tensor(246.3204, device='cuda:2')
compute distance is  tensor(337.3870, device='cuda:2')
compute distance is  tensor(232.7150, device='cuda:2')
compute distance is  tensor(208.5511, device='cuda:2')
compute distance is  tensor(215.4862, device='cuda:2')
calculated distance threshold is  tensor(34678.0312, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9500666668229863
====================
====================
iteration is  0
round is  1
accuracy is  0.9427000001563199
====================
====================
iteration is  0
round is  2
accuracy is  0.94145000015632
====================
====================
iteration is  1
round is  0
accuracy is  0.9043333334896546
====================
====================
iteration is  1
round is  1
accuracy is  0.9101000001563211
====================
====================
iteration is  1
round is  2
accuracy is  0.8987000001563216
====================
====================
iteration is  2
round is  0
accuracy is  0.8188666668229914
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.8753500001563224
====================
====================
iteration is  2
round is  2
accuracy is  0.9151000001563208
====================
====================
iteration is  3
round is  0
accuracy is  0.7659500001563272
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.8516333334896568
====================
====================
iteration is  3
round is  2
accuracy is  0.758133333489661
====================
succ_min + 1
====================
iteration is  4
round is  0
accuracy is  0.8052500001563253
====================
====================
iteration is  4
round is  1
accuracy is  0.8342666668229908
====================
________________________________
test distance is  tensor(5700.6929, device='cuda:2')
test acc is  0.758133333489661
test loss is 1.2141706030378971
test entropy is  0.16567337252835093
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 2, 3, 5, 6, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 53 global rounds:
Train Accuracy: 96.95% 

Test Accuracy: 97.21% 


 | Global Training Round : 54 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  6.378920078277588
attack res is True
len of model dicts is  10
compute distance is  tensor(930.0386, device='cuda:2')
compute distance is  tensor(1164.3964, device='cuda:2')
compute distance is  tensor(1138.6018, device='cuda:2')
compute distance is  tensor(892.2062, device='cuda:2')
compute distance is  tensor(1293.3544, device='cuda:2')
compute distance is  tensor(1098.5455, device='cuda:2')
compute distance is  tensor(1132.7880, device='cuda:2')
compute distance is  tensor(868.4260, device='cuda:2')
compute distance is  tensor(1473.0703, device='cuda:2')
compute distance is  tensor(917.6891, device='cuda:2')
calculated distance threshold is  tensor(85895.0156, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8408166668229904
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8355333334896573
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8871833334896552
====================
====================
iteration is  1
round is  0
accuracy is  0.8096166668229917
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.7933500001563257
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.8551500001563231
====================
====================
iteration is  2
round is  0
accuracy is  0.8093166668229919
====================
________________________________
test distance is  tensor(4709.8447, device='cuda:2')
test acc is  0.7933500001563257
test loss is 1.1545732381787381
test entropy is  0.1527283973991871
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 21, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 54 global rounds:
Train Accuracy: 92.93% 

Test Accuracy: 93.74% 


 | Global Training Round : 55 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  5.909399509429932
attack res is True
len of model dicts is  10
compute distance is  tensor(201.1251, device='cuda:2')
compute distance is  tensor(277.5621, device='cuda:2')
compute distance is  tensor(125.8614, device='cuda:2')
compute distance is  tensor(146.5365, device='cuda:2')
compute distance is  tensor(176.6536, device='cuda:2')
compute distance is  tensor(183.7746, device='cuda:2')
compute distance is  tensor(235.7268, device='cuda:2')
compute distance is  tensor(257.9520, device='cuda:2')
compute distance is  tensor(179.4110, device='cuda:2')
compute distance is  tensor(196.9884, device='cuda:2')
calculated distance threshold is  tensor(23591.6484, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8932666668229883
====================
====================
iteration is  0
round is  1
accuracy is  0.8815000001563221
====================
====================
iteration is  0
round is  2
accuracy is  0.9235166668229873
====================
====================
iteration is  1
round is  0
accuracy is  0.859950000156323
====================
====================
iteration is  1
round is  1
accuracy is  0.8443166668229901
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.8485333334896566
====================
====================
iteration is  2
round is  0
accuracy is  0.8476833334896567
====================
====================
iteration is  2
round is  1
accuracy is  0.7686666668229938
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.8595666668229895
====================
====================
iteration is  3
round is  0
accuracy is  0.8180000001563247
====================
________________________________
test distance is  tensor(5177.3862, device='cuda:2')
test acc is  0.7686666668229938
test loss is 0.7568159571398042
test entropy is  0.8256627717760326
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 36, 37, 39]
 
Avg Training Stats after 55 global rounds:
Train Accuracy: 97.10% 

Test Accuracy: 97.60% 


 | Global Training Round : 56 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  6.114676475524902
attack res is True
len of model dicts is  10
compute distance is  tensor(311.8153, device='cuda:2')
compute distance is  tensor(437.4462, device='cuda:2')
compute distance is  tensor(744.0650, device='cuda:2')
compute distance is  tensor(289.5478, device='cuda:2')
compute distance is  tensor(109.4696, device='cuda:2')
compute distance is  tensor(401.1309, device='cuda:2')
compute distance is  tensor(338.7723, device='cuda:2')
compute distance is  tensor(423.6533, device='cuda:2')
compute distance is  tensor(412.6947, device='cuda:2')
compute distance is  tensor(165.6435, device='cuda:2')
calculated distance threshold is  tensor(108087.9219, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9297000001563203
====================
====================
iteration is  0
round is  1
accuracy is  0.9399666668229866
====================
====================
iteration is  0
round is  2
accuracy is  0.9335500001563202
====================
====================
iteration is  1
round is  0
accuracy is  0.921733333489654
====================
====================
iteration is  1
round is  1
accuracy is  0.9234666668229872
====================
====================
iteration is  1
round is  2
accuracy is  0.9139166668229876
====================
====================
iteration is  2
round is  0
accuracy is  0.8887000001563218
====================
====================
iteration is  2
round is  1
accuracy is  0.9064166668229878
====================
====================
iteration is  2
round is  2
accuracy is  0.909000000156321
====================
====================
iteration is  3
round is  0
accuracy is  0.8909166668229884
====================
====================
iteration is  3
round is  1
accuracy is  0.843383333489657
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.8531833334896565
====================
====================
iteration is  4
round is  0
accuracy is  0.8285500001563242
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.7965666668229925
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.826216666822991
====================
====================
iteration is  5
round is  0
accuracy is  0.6962500001563311
====================
succ_min + 1
________________________________
test distance is  tensor(6269.2163, device='cuda:2')
test acc is  0.6962500001563311
test loss is 1.9488523637435076
test entropy is  0.2062569852513291
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 25, 31, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 56 global rounds:
Train Accuracy: 97.53% 

Test Accuracy: 98.02% 


 | Global Training Round : 57 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  6.271518707275391
attack res is True
len of model dicts is  10
compute distance is  tensor(182.9346, device='cuda:2')
compute distance is  tensor(311.4960, device='cuda:2')
compute distance is  tensor(167.8281, device='cuda:2')
compute distance is  tensor(828.5732, device='cuda:2')
compute distance is  tensor(406.9276, device='cuda:2')
compute distance is  tensor(163.4412, device='cuda:2')
compute distance is  tensor(491.5734, device='cuda:2')
compute distance is  tensor(456.3806, device='cuda:2')
compute distance is  tensor(1013.9492, device='cuda:2')
compute distance is  tensor(234.7617, device='cuda:2')
calculated distance threshold is  tensor(159351.7969, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9563166668229861
====================
====================
iteration is  0
round is  1
accuracy is  0.9521833334896529
====================
====================
iteration is  0
round is  2
accuracy is  0.9672666668229858
====================
====================
iteration is  1
round is  0
accuracy is  0.9620500001563194
====================
====================
iteration is  1
round is  1
accuracy is  0.9468666668229864
====================
====================
iteration is  1
round is  2
accuracy is  0.9416166668229866
====================
====================
iteration is  2
round is  0
accuracy is  0.93890000015632
====================
====================
iteration is  2
round is  1
accuracy is  0.9525166668229863
====================
====================
iteration is  2
round is  2
accuracy is  0.9385833334896534
====================
====================
iteration is  3
round is  0
accuracy is  0.8844166668229887
====================
====================
iteration is  3
round is  1
accuracy is  0.9185833334896542
====================
====================
iteration is  3
round is  2
accuracy is  0.9327166668229868
====================
====================
iteration is  4
round is  0
accuracy is  0.8258833334896578
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.8385333334896572
====================
====================
iteration is  4
round is  2
accuracy is  0.7750500001563266
====================
succ_min + 1
====================
iteration is  5
round is  0
accuracy is  0.8911666668229884
====================
====================
iteration is  5
round is  1
accuracy is  0.8842166668229887
====================
====================
iteration is  5
round is  2
accuracy is  0.845683333489657
====================
====================
iteration is  6
round is  0
accuracy is  0.8537000001563232
====================
====================
iteration is  6
round is  1
accuracy is  0.7694833334896605
====================
succ_min + 1
________________________________
test distance is  tensor(6897.3164, device='cuda:2')
test acc is  0.7694833334896605
test loss is 1.6539465481443192
test entropy is  0.14174358976849996
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 19]
 
Avg Training Stats after 57 global rounds:
Train Accuracy: 96.31% 

Test Accuracy: 96.80% 


 | Global Training Round : 58 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  7.052867412567139
attack res is True
len of model dicts is  10
compute distance is  tensor(2551.4575, device='cuda:2')
compute distance is  tensor(958.6826, device='cuda:2')
compute distance is  tensor(2088.4980, device='cuda:2')
compute distance is  tensor(797.3218, device='cuda:2')
compute distance is  tensor(1777.2245, device='cuda:2')
compute distance is  tensor(961.7069, device='cuda:2')
compute distance is  tensor(664.0628, device='cuda:2')
compute distance is  tensor(1019.2197, device='cuda:2')
compute distance is  tensor(1462.4470, device='cuda:2')
compute distance is  tensor(1135.2343, device='cuda:2')
calculated distance threshold is  tensor(389251.0938, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9433166668229865
====================
====================
iteration is  0
round is  1
accuracy is  0.894733333489655
====================
====================
iteration is  0
round is  2
accuracy is  0.922083333489654
====================
====================
iteration is  1
round is  0
accuracy is  0.8987333334896549
====================
====================
iteration is  1
round is  1
accuracy is  0.9152833334896542
====================
====================
iteration is  1
round is  2
accuracy is  0.9010333334896546
====================
====================
iteration is  2
round is  0
accuracy is  0.6637333334896665
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.8733833334896557
====================
====================
iteration is  2
round is  2
accuracy is  0.8542166668229899
====================
====================
iteration is  3
round is  0
accuracy is  0.8497333334896566
====================
====================
iteration is  3
round is  1
accuracy is  0.8113000001563251
====================
====================
iteration is  3
round is  2
accuracy is  0.7566666668229945
====================
====================
iteration is  4
round is  0
accuracy is  0.8681833334896559
====================
====================
iteration is  4
round is  1
accuracy is  0.8574833334896564
====================
====================
iteration is  4
round is  2
accuracy is  0.8730500001563225
====================
====================
iteration is  5
round is  0
accuracy is  0.7666000001563272
====================
________________________________
test distance is  tensor(5186.6851, device='cuda:2')
test acc is  0.6637333334896665
test loss is 1.561149321067562
test entropy is  0.34439195160354885
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 14, 15]
 
Avg Training Stats after 58 global rounds:
Train Accuracy: 91.22% 

Test Accuracy: 92.29% 


 | Global Training Round : 59 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  7.289318561553955
attack res is True
len of model dicts is  10
compute distance is  tensor(1121.2498, device='cuda:2')
compute distance is  tensor(760.2548, device='cuda:2')
compute distance is  tensor(322.6315, device='cuda:2')
compute distance is  tensor(494.5273, device='cuda:2')
compute distance is  tensor(627.5955, device='cuda:2')
compute distance is  tensor(916.5452, device='cuda:2')
compute distance is  tensor(469.2979, device='cuda:2')
compute distance is  tensor(895.5672, device='cuda:2')
compute distance is  tensor(239.1176, device='cuda:2')
compute distance is  tensor(320.4443, device='cuda:2')
calculated distance threshold is  tensor(200019.0781, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9032000001563214
====================
====================
iteration is  0
round is  1
accuracy is  0.8186000001563247
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8237166668229909
====================
====================
iteration is  1
round is  0
accuracy is  0.8408166668229903
====================
====================
iteration is  1
round is  1
accuracy is  0.8412500001563237
====================
====================
iteration is  1
round is  2
accuracy is  0.8409000001563237
====================
________________________________
test distance is  tensor(4282.7051, device='cuda:2')
test acc is  0.8186000001563247
test loss is 0.5858264007865747
test entropy is  0.6859691637093579
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 59 global rounds:
Train Accuracy: 92.72% 

Test Accuracy: 93.67% 


 | Global Training Round : 60 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  7.898453712463379
attack res is True
len of model dicts is  10
compute distance is  tensor(1166.3195, device='cuda:2')
compute distance is  tensor(1222.1322, device='cuda:2')
compute distance is  tensor(358.3031, device='cuda:2')
compute distance is  tensor(1569.6208, device='cuda:2')
compute distance is  tensor(447.5326, device='cuda:2')
compute distance is  tensor(841.7495, device='cuda:2')
compute distance is  tensor(937.8917, device='cuda:2')
compute distance is  tensor(835.8221, device='cuda:2')
compute distance is  tensor(1339.0957, device='cuda:2')
compute distance is  tensor(305.0739, device='cuda:2')
calculated distance threshold is  tensor(315330.6562, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8543166668229898
====================
====================
iteration is  0
round is  1
accuracy is  0.9019500001563213
====================
====================
iteration is  0
round is  2
accuracy is  0.903266666822988
====================
====================
iteration is  1
round is  0
accuracy is  0.8475333334896569
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.8286000001563242
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.8533333334896566
====================
====================
iteration is  2
round is  0
accuracy is  0.8303166668229909
====================
====================
iteration is  2
round is  1
accuracy is  0.8808666668229888
====================
====================
iteration is  2
round is  2
accuracy is  0.7956166668229925
====================
succ_min + 1
====================
iteration is  3
round is  0
accuracy is  0.8635000001563229
====================
====================
iteration is  3
round is  1
accuracy is  0.8098333334896584
====================
________________________________
test distance is  tensor(5178.6992, device='cuda:2')
test acc is  0.7956166668229925
test loss is 0.7465637581530156
test entropy is  0.4674837513646083
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 60 global rounds:
Train Accuracy: 52.68% 

Test Accuracy: 52.46% 


 | Global Training Round : 61 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  6.887688636779785
attack res is True
len of model dicts is  10
compute distance is  tensor(173.9948, device='cuda:2')
compute distance is  tensor(214.9669, device='cuda:2')
compute distance is  tensor(198.8187, device='cuda:2')
compute distance is  tensor(182.3565, device='cuda:2')
compute distance is  tensor(169.8630, device='cuda:2')
compute distance is  tensor(177.2887, device='cuda:2')
compute distance is  tensor(171.2758, device='cuda:2')
compute distance is  tensor(158.0591, device='cuda:2')
compute distance is  tensor(144.4958, device='cuda:2')
compute distance is  tensor(171.9142, device='cuda:2')
calculated distance threshold is  tensor(19455.9121, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.5171833334896756
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.491250000156342
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5216666668230089
====================
====================
iteration is  1
round is  0
accuracy is  0.4563666668230084
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.44683333348967497
====================
succ_min + 1
________________________________
test distance is  tensor(4283.8989, device='cuda:2')
test acc is  0.44683333348967497
test loss is 1.6863817806437071
test entropy is  1.9624900350184329
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [0, 2, 3, 5, 6, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 61 global rounds:
Train Accuracy: 88.93% 

Test Accuracy: 89.65% 


 | Global Training Round : 62 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  7.5142130851745605
attack res is True
len of model dicts is  10
compute distance is  tensor(187.1929, device='cuda:2')
compute distance is  tensor(209.4261, device='cuda:2')
compute distance is  tensor(195.8862, device='cuda:2')
compute distance is  tensor(170.2608, device='cuda:2')
compute distance is  tensor(185.3486, device='cuda:2')
compute distance is  tensor(188.6090, device='cuda:2')
compute distance is  tensor(503.6142, device='cuda:2')
compute distance is  tensor(157.1616, device='cuda:2')
compute distance is  tensor(240.2742, device='cuda:2')
compute distance is  tensor(175.5509, device='cuda:2')
calculated distance threshold is  tensor(104590.7266, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8602333334896561
====================
====================
iteration is  0
round is  1
accuracy is  0.8568166668229896
====================
====================
iteration is  0
round is  2
accuracy is  0.8090833334896583
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.8363833334896572
====================
====================
iteration is  1
round is  1
accuracy is  0.8380333334896571
====================
====================
iteration is  1
round is  2
accuracy is  0.8009500001563256
====================
succ_min + 1
====================
iteration is  2
round is  0
accuracy is  0.8413833334896569
====================
________________________________
test distance is  tensor(4709.3354, device='cuda:2')
test acc is  0.8009500001563256
test loss is 0.6861389195486935
test entropy is  0.8057659762119179
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 9, 10, 14]
 
Avg Training Stats after 62 global rounds:
Train Accuracy: 96.19% 

Test Accuracy: 96.60% 


 | Global Training Round : 63 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  7.722084999084473
attack res is True
len of model dicts is  10
compute distance is  tensor(155.7388, device='cuda:2')
compute distance is  tensor(252.5255, device='cuda:2')
compute distance is  tensor(128.3111, device='cuda:2')
compute distance is  tensor(141.8393, device='cuda:2')
compute distance is  tensor(130.2472, device='cuda:2')
compute distance is  tensor(205.2722, device='cuda:2')
compute distance is  tensor(176.0497, device='cuda:2')
compute distance is  tensor(181.7468, device='cuda:2')
compute distance is  tensor(141.6276, device='cuda:2')
compute distance is  tensor(130.0247, device='cuda:2')
calculated distance threshold is  tensor(41315.3594, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9526666668229863
====================
====================
iteration is  0
round is  1
accuracy is  0.9389166668229867
====================
====================
iteration is  0
round is  2
accuracy is  0.9465666668229865
====================
====================
iteration is  1
round is  0
accuracy is  0.9445666668229865
====================
====================
iteration is  1
round is  1
accuracy is  0.9528666668229863
====================
====================
iteration is  1
round is  2
accuracy is  0.9521500001563197
====================
====================
iteration is  2
round is  0
accuracy is  0.9350166668229869
====================
====================
iteration is  2
round is  1
accuracy is  0.9326166668229869
====================
====================
iteration is  2
round is  2
accuracy is  0.9419166668229866
====================
====================
iteration is  3
round is  0
accuracy is  0.918733333489654
====================
====================
iteration is  3
round is  1
accuracy is  0.9149000001563209
====================
====================
iteration is  3
round is  2
accuracy is  0.9245166668229872
====================
====================
iteration is  4
round is  0
accuracy is  0.8465333334896568
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.8779333334896556
====================
====================
iteration is  4
round is  2
accuracy is  0.9068500001563211
====================
====================
iteration is  5
round is  0
accuracy is  0.9002333334896547
====================
====================
iteration is  5
round is  1
accuracy is  0.8471666668229901
====================
====================
iteration is  5
round is  2
accuracy is  0.8543500001563232
====================
====================
iteration is  6
round is  0
accuracy is  0.7609500001563274
====================
succ_min + 1
====================
iteration is  6
round is  1
accuracy is  0.7939333334896591
====================
====================
iteration is  6
round is  2
accuracy is  0.8645500001563228
====================
====================
iteration is  7
round is  0
accuracy is  0.7371166668229954
====================
succ_min + 1
________________________________
test distance is  tensor(8346.1152, device='cuda:2')
test acc is  0.7371166668229954
test loss is 1.5404677700672322
test entropy is  0.20626786880211026
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 20, 21]
 
Avg Training Stats after 63 global rounds:
Train Accuracy: 96.38% 

Test Accuracy: 96.85% 


 | Global Training Round : 64 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  8.601057052612305
attack res is True
len of model dicts is  10
compute distance is  tensor(953.3642, device='cuda:2')
compute distance is  tensor(1013.9200, device='cuda:2')
compute distance is  tensor(439.6676, device='cuda:2')
compute distance is  tensor(824.2296, device='cuda:2')
compute distance is  tensor(1601.3076, device='cuda:2')
compute distance is  tensor(1262.6998, device='cuda:2')
compute distance is  tensor(558.1387, device='cuda:2')
compute distance is  tensor(545.4590, device='cuda:2')
compute distance is  tensor(1450.7092, device='cuda:2')
compute distance is  tensor(1014.8595, device='cuda:2')
calculated distance threshold is  tensor(424134.5625, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9484666668229864
====================
====================
iteration is  0
round is  1
accuracy is  0.9424333334896533
====================
====================
iteration is  0
round is  2
accuracy is  0.948783333489653
====================
====================
iteration is  1
round is  0
accuracy is  0.9248166668229872
====================
====================
iteration is  1
round is  1
accuracy is  0.9407333334896533
====================
====================
iteration is  1
round is  2
accuracy is  0.9253000001563205
====================
====================
iteration is  2
round is  0
accuracy is  0.9400333334896532
====================
====================
iteration is  2
round is  1
accuracy is  0.93785000015632
====================
====================
iteration is  2
round is  2
accuracy is  0.9055833334896546
====================
====================
iteration is  3
round is  0
accuracy is  0.9012500001563214
====================
====================
iteration is  3
round is  1
accuracy is  0.9093500001563211
====================
====================
iteration is  3
round is  2
accuracy is  0.8761333334896557
====================
====================
iteration is  4
round is  0
accuracy is  0.8742500001563224
====================
====================
iteration is  4
round is  1
accuracy is  0.869733333489656
====================
====================
iteration is  4
round is  2
accuracy is  0.8830833334896554
====================
====================
iteration is  5
round is  0
accuracy is  0.8452333334896569
====================
succ_min + 1
====================
iteration is  5
round is  1
accuracy is  0.8440833334896569
====================
succ_min + 1
====================
iteration is  5
round is  2
accuracy is  0.7825333334896598
====================
succ_min + 1
====================
iteration is  6
round is  0
accuracy is  0.8906666668229885
====================
====================
iteration is  6
round is  1
accuracy is  0.7960666668229923
====================
====================
iteration is  6
round is  2
accuracy is  0.7416500001563286
====================
succ_min + 1
________________________________
test distance is  tensor(6897.2671, device='cuda:2')
test acc is  0.7416500001563286
test loss is 1.8730298343307175
test entropy is  0.15595198558893666
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 30, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 64 global rounds:
Train Accuracy: 94.97% 

Test Accuracy: 95.56% 


 | Global Training Round : 65 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  8.395951271057129
attack res is True
len of model dicts is  10
compute distance is  tensor(177.9466, device='cuda:2')
compute distance is  tensor(173.1995, device='cuda:2')
compute distance is  tensor(135.1273, device='cuda:2')
compute distance is  tensor(182.9868, device='cuda:2')
compute distance is  tensor(195.4125, device='cuda:2')
compute distance is  tensor(181.3504, device='cuda:2')
compute distance is  tensor(135.5681, device='cuda:2')
compute distance is  tensor(180.9082, device='cuda:2')
compute distance is  tensor(131.7317, device='cuda:2')
compute distance is  tensor(222.0215, device='cuda:2')
calculated distance threshold is  tensor(36357.1289, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9350833334896537
====================
====================
iteration is  0
round is  1
accuracy is  0.9258333334896539
====================
====================
iteration is  0
round is  2
accuracy is  0.9373500001563202
====================
====================
iteration is  1
round is  0
accuracy is  0.931416666822987
====================
====================
iteration is  1
round is  1
accuracy is  0.9291666668229871
====================
====================
iteration is  1
round is  2
accuracy is  0.9279166668229871
====================
====================
iteration is  2
round is  0
accuracy is  0.9128000001563209
====================
====================
iteration is  2
round is  1
accuracy is  0.9384666668229867
====================
====================
iteration is  2
round is  2
accuracy is  0.913300000156321
====================
====================
iteration is  3
round is  0
accuracy is  0.9044500001563213
====================
====================
iteration is  3
round is  1
accuracy is  0.9066000001563211
====================
====================
iteration is  3
round is  2
accuracy is  0.907316666822988
====================
====================
iteration is  4
round is  0
accuracy is  0.8830000001563222
====================
====================
iteration is  4
round is  1
accuracy is  0.8133666668229917
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.887200000156322
====================
====================
iteration is  5
round is  0
accuracy is  0.877166666822989
====================
====================
iteration is  5
round is  1
accuracy is  0.8285000001563242
====================
====================
iteration is  5
round is  2
accuracy is  0.8790000001563222
====================
====================
iteration is  6
round is  0
accuracy is  0.8079166668229919
====================
succ_min + 1
====================
iteration is  6
round is  1
accuracy is  0.7531166668229945
====================
succ_min + 1
====================
iteration is  6
round is  2
accuracy is  0.7873500001563262
====================
________________________________
test distance is  tensor(7587.2812, device='cuda:2')
test acc is  0.7531166668229945
test loss is 1.295256719946353
test entropy is  0.2477565873215702
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 35, 37, 39]
 
Avg Training Stats after 65 global rounds:
Train Accuracy: 96.24% 

Test Accuracy: 96.70% 


 | Global Training Round : 66 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  32 5
current submit client idx and staleness is  33 5
current submit client idx and staleness is  34 5
current submit client idx and staleness is  35 5
current submit client idx and staleness is  36 5
current submit client idx and staleness is  37 5
current submit client idx and staleness is  38 5
current submit client idx and staleness is  39 5
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  8.890314102172852
attack res is True
len of model dicts is  10
compute distance is  tensor(840.7236, device='cuda:2')
compute distance is  tensor(887.3677, device='cuda:2')
compute distance is  tensor(709.1059, device='cuda:2')
compute distance is  tensor(309.9825, device='cuda:2')
compute distance is  tensor(292.5025, device='cuda:2')
compute distance is  tensor(1163.0752, device='cuda:2')
compute distance is  tensor(339.8645, device='cuda:2')
compute distance is  tensor(223.9514, device='cuda:2')
compute distance is  tensor(180.2387, device='cuda:2')
compute distance is  tensor(355.5157, device='cuda:2')
calculated distance threshold is  tensor(433939.0625, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.9355333334896535
====================
====================
iteration is  0
round is  1
accuracy is  0.9476500001563198
====================
====================
iteration is  0
round is  2
accuracy is  0.9479666668229865
====================
====================
iteration is  1
round is  0
accuracy is  0.9293666668229871
====================
====================
iteration is  1
round is  1
accuracy is  0.9408833334896533
====================
====================
iteration is  1
round is  2
accuracy is  0.9367833334896535
====================
====================
iteration is  2
round is  0
accuracy is  0.9386000001563201
====================
====================
iteration is  2
round is  1
accuracy is  0.9062500001563213
====================
====================
iteration is  2
round is  2
accuracy is  0.9246500001563207
====================
====================
iteration is  3
round is  0
accuracy is  0.9135666668229876
====================
====================
iteration is  3
round is  1
accuracy is  0.9191000001563207
====================
====================
iteration is  3
round is  2
accuracy is  0.9343000001563202
====================
====================
iteration is  4
round is  0
accuracy is  0.8872166668229886
====================
====================
iteration is  4
round is  1
accuracy is  0.8928166668229884
====================
====================
iteration is  4
round is  2
accuracy is  0.8967666668229883
====================
====================
iteration is  5
round is  0
accuracy is  0.8684333334896559
====================
====================
iteration is  5
round is  1
accuracy is  0.8396333334896571
====================
succ_min + 1
====================
iteration is  5
round is  2
accuracy is  0.871933333489656
====================
====================
iteration is  6
round is  0
accuracy is  0.807016666822992
====================
succ_min + 1
====================
iteration is  6
round is  1
accuracy is  0.8080000001563251
====================
====================
iteration is  6
round is  2
accuracy is  0.6786833334896655
====================
succ_min + 1
====================
iteration is  7
round is  0
accuracy is  0.7509833334896613
====================
________________________________
test distance is  tensor(7582.5942, device='cuda:2')
test acc is  0.6786833334896655
test loss is 2.388036437189655
test entropy is  0.1761372093675233
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 16, 17, 18, 19, 20, 21, 22, 23, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 66 global rounds:
Train Accuracy: 86.86% 

Test Accuracy: 88.00% 


 | Global Training Round : 67 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  8.394946098327637
attack res is True
len of model dicts is  10
compute distance is  tensor(128.4624, device='cuda:2')
compute distance is  tensor(178.5263, device='cuda:2')
compute distance is  tensor(141.2904, device='cuda:2')
compute distance is  tensor(114.1304, device='cuda:2')
compute distance is  tensor(150.7865, device='cuda:2')
compute distance is  tensor(127.3453, device='cuda:2')
compute distance is  tensor(127.9650, device='cuda:2')
compute distance is  tensor(160.9404, device='cuda:2')
compute distance is  tensor(133.8405, device='cuda:2')
compute distance is  tensor(157.8427, device='cuda:2')
calculated distance threshold is  tensor(31376.2246, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8551000001563231
====================
====================
iteration is  0
round is  1
accuracy is  0.843833333489657
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8156500001563248
====================
succ_min + 1
====================
iteration is  1
round is  0
accuracy is  0.819733333489658
====================
====================
iteration is  1
round is  1
accuracy is  0.7833500001563264
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.7624833334896607
====================
succ_min + 1
________________________________
test distance is  tensor(4710.6514, device='cuda:2')
test acc is  0.7624833334896607
test loss is 0.760524775427796
test entropy is  0.9490376183473225
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
left index is  [2, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49]
 
Avg Training Stats after 67 global rounds:
Train Accuracy: 93.20% 

Test Accuracy: 94.03% 


 | Global Training Round : 68 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  9.033905029296875
attack res is True
len of model dicts is  10
compute distance is  tensor(197.9585, device='cuda:2')
compute distance is  tensor(169.8563, device='cuda:2')
compute distance is  tensor(182.8040, device='cuda:2')
compute distance is  tensor(180.1835, device='cuda:2')
compute distance is  tensor(157.5226, device='cuda:2')
compute distance is  tensor(184.9706, device='cuda:2')
compute distance is  tensor(153.8297, device='cuda:2')
compute distance is  tensor(197.6368, device='cuda:2')
compute distance is  tensor(188.6448, device='cuda:2')
compute distance is  tensor(181.7623, device='cuda:2')
calculated distance threshold is  tensor(23719.2227, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.8875333334896552
====================
====================
iteration is  0
round is  1
accuracy is  0.9235500001563207
====================
====================
iteration is  0
round is  2
accuracy is  0.9275000001563204
====================
====================
iteration is  1
round is  0
accuracy is  0.8921666668229883
====================
====================
iteration is  1
round is  1
accuracy is  0.8903500001563218
====================
====================
iteration is  1
round is  2
accuracy is  0.8930000001563216
====================
====================
iteration is  2
round is  0
accuracy is  0.8865333334896552
====================
====================
iteration is  2
round is  1
accuracy is  0.8667166668229893
====================
====================
iteration is  2
round is  2
accuracy is  0.8978666668229881
====================
====================
iteration is  3
round is  0
accuracy is  0.8978500001563215
====================
====================
iteration is  3
round is  1
accuracy is  0.8905166668229885
====================
====================
iteration is  3
round is  2
accuracy is  0.8987833334896548
====================
====================
iteration is  4
round is  0
accuracy is  0.8248500001563245
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.8605000001563229
====================
====================
iteration is  4
round is  2
accuracy is  0.8341500001563239
====================
====================
iteration is  5
round is  0
accuracy is  0.7864000001563262
====================
succ_min + 1
====================
iteration is  5
round is  1
accuracy is  0.8973166668229882
====================
====================
iteration is  5
round is  2
accuracy is  0.8011000001563254
====================
====================
iteration is  6
round is  0
accuracy is  0.7094833334896636
====================
succ_min + 1
________________________________
test distance is  tensor(7585.2378, device='cuda:2')
test acc is  0.7094833334896636
test loss is 1.1724742763459302
test entropy is  0.46922936136407384
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 24, 25, 26, 27, 28, 29, 30, 31, 8, 9, 10, 11, 12, 13, 14, 15]
 
Avg Training Stats after 68 global rounds:
Train Accuracy: 97.41% 

Test Accuracy: 97.96% 


 | Global Training Round : 69 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 2
current submit client idx and staleness is  13 2
current submit client idx and staleness is  14 2
current submit client idx and staleness is  15 2
current submit client idx and staleness is  24 4
current submit client idx and staleness is  25 4
current submit client idx and staleness is  26 4
current submit client idx and staleness is  27 4
current submit client idx and staleness is  28 4
current submit client idx and staleness is  29 4
current submit client idx and staleness is  30 4
current submit client idx and staleness is  31 4
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  8.432990074157715
attack res is True
len of model dicts is  10
compute distance is  tensor(146.8307, device='cuda:2')
compute distance is  tensor(167.5270, device='cuda:2')
compute distance is  tensor(108.0473, device='cuda:2')
compute distance is  tensor(107.2204, device='cuda:2')
compute distance is  tensor(125.6591, device='cuda:2')
compute distance is  tensor(95.6934, device='cuda:2')
compute distance is  tensor(150.9414, device='cuda:2')
compute distance is  tensor(145.9442, device='cuda:2')
compute distance is  tensor(151.8511, device='cuda:2')
compute distance is  tensor(131.6543, device='cuda:2')
calculated distance threshold is  tensor(42291.8672, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.973200000156319
====================
====================
iteration is  0
round is  1
accuracy is  0.9733333334896523
====================
====================
iteration is  0
round is  2
accuracy is  0.9717333334896523
====================
====================
iteration is  1
round is  0
accuracy is  0.9721833334896524
====================
====================
iteration is  1
round is  1
accuracy is  0.972450000156319
====================
====================
iteration is  1
round is  2
accuracy is  0.972150000156319
====================
====================
iteration is  2
round is  0
accuracy is  0.9685166668229858
====================
====================
iteration is  2
round is  1
accuracy is  0.9684333334896524
====================
====================
iteration is  2
round is  2
accuracy is  0.9640000001563193
====================
====================
iteration is  3
round is  0
accuracy is  0.9672500001563191
====================
====================
iteration is  3
round is  1
accuracy is  0.9613000001563193
====================
====================
iteration is  3
round is  2
accuracy is  0.9586833334896528
====================
====================
iteration is  4
round is  0
accuracy is  0.9589166668229862
====================
====================
iteration is  4
round is  1
accuracy is  0.9585833334896527
====================
====================
iteration is  4
round is  2
accuracy is  0.9567833334896528
====================
====================
iteration is  5
round is  0
accuracy is  0.9366833334896535
====================
====================
iteration is  5
round is  1
accuracy is  0.9436000001563198
====================
====================
iteration is  5
round is  2
accuracy is  0.9467333334896532
====================
====================
iteration is  6
round is  0
accuracy is  0.9233500001563206
====================
====================
iteration is  6
round is  1
accuracy is  0.9204666668229874
====================
====================
iteration is  6
round is  2
accuracy is  0.9333666668229869
====================
====================
iteration is  7
round is  0
accuracy is  0.8981666668229881
====================
====================
iteration is  7
round is  1
accuracy is  0.892883333489655
====================
====================
iteration is  7
round is  2
accuracy is  0.8966500001563217
====================
====================
iteration is  8
round is  0
accuracy is  0.8762000001563224
====================
====================
iteration is  8
round is  1
accuracy is  0.6515666668230007
====================
succ_min + 1
====================
iteration is  8
round is  2
accuracy is  0.8063833334896587
====================
====================
iteration is  9
round is  0
accuracy is  0.6177000001563364
====================
succ_min + 1
====================
iteration is  9
round is  1
accuracy is  0.6782000001563321
====================
====================
iteration is  9
round is  2
accuracy is  0.6085333334896706
====================
succ_min + 1
________________________________
test distance is  tensor(10096.7588, device='cuda:2')
test acc is  0.6085333334896706
test loss is 4.42985110509116
test entropy is  0.15370965893986002
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 17, 18, 19, 20, 21, 22, 23]
left index is  [0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 16, 18, 20]
 
Avg Training Stats after 69 global rounds:
Train Accuracy: 96.71% 

Test Accuracy: 96.71% 


 | Global Training Round : 70 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 1
current submit client idx and staleness is  7 1
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 3
current submit client idx and staleness is  19 3
current submit client idx and staleness is  20 3
current submit client idx and staleness is  21 3
current submit client idx and staleness is  22 3
current submit client idx and staleness is  23 3
current submit client idx and staleness is  40 1
current submit client idx and staleness is  41 1
current submit client idx and staleness is  42 1
current submit client idx and staleness is  43 1
current submit client idx and staleness is  44 1
current submit client idx and staleness is  45 1
current submit client idx and staleness is  46 1
current submit client idx and staleness is  47 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
distance ratio is <class 'float'>
compare_res is  9.856428146362305
attack res is True
len of model dicts is  10
compute distance is  tensor(1284.3600, device='cuda:2')
compute distance is  tensor(2725.6235, device='cuda:2')
compute distance is  tensor(2356.5371, device='cuda:2')
compute distance is  tensor(1681.1996, device='cuda:2')
compute distance is  tensor(5239.9580, device='cuda:2')
compute distance is  tensor(3950.8889, device='cuda:2')
compute distance is  tensor(626.2299, device='cuda:2')
compute distance is  tensor(926.9561, device='cuda:2')
compute distance is  tensor(3444.0369, device='cuda:2')
compute distance is  tensor(2132.9805, device='cuda:2')
calculated distance threshold is  tensor(2981817.2500, device='cuda:2')
pinned_accuracy threshold is  0.85
====================
iteration is  0
round is  0
accuracy is  0.952683333489653
====================
====================
iteration is  0
round is  1
accuracy is  0.9435166668229866
====================
====================
iteration is  0
round is  2
accuracy is  0.9545500001563196
====================
====================
iteration is  1
round is  0
accuracy is  0.9449333334896531
====================
====================
iteration is  1
round is  1
accuracy is  0.9375000001563201
====================
====================
iteration is  1
round is  2
accuracy is  0.9410833334896532
====================
====================
iteration is  2
round is  0
accuracy is  0.9225166668229874
====================
====================
iteration is  2
round is  1
accuracy is  0.9204166668229874
====================
====================
iteration is  2
round is  2
accuracy is  0.9465666668229865
====================
====================
iteration is  3
round is  0
accuracy is  0.9172166668229874
====================
====================
iteration is  3
round is  1
accuracy is  0.9320000001563203
====================
====================
iteration is  3
round is  2
accuracy is  0.9010333334896548
====================
====================
iteration is  4
round is  0
accuracy is  0.8795500001563222
====================
====================
iteration is  4
round is  1
accuracy is  0.8935666668229884
====================
====================
iteration is  4
round is  2
accuracy is  0.8749166668229891
====================
====================
iteration is  5
round is  0
accuracy is  0.8225166668229912
====================
succ_min + 1
====================
iteration is  5
round is  1
accuracy is  0.8523333334896567
====================
====================
iteration is  5
round is  2
accuracy is  0.8291833334896577
====================
====================
iteration is  6
round is  0
accuracy is  0.8163500001563248
====================
succ_min + 1
====================
iteration is  6
round is  1
accuracy is  0.8640666668229894
====================
====================
iteration is  6
round is  2
accuracy is  0.6704500001563328
====================
succ_min + 1
====================
iteration is  7
round is  0
accuracy is  0.6280666668230024
====================
succ_min + 1
________________________________
test distance is  tensor(8340.8896, device='cuda:2')
test acc is  0.6280666668230024
test loss is 4.360515770627491
test entropy is  0.1277702455518088
________________________________
[0, 1, 2, 3, 4, 5, 6, 7, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 32, 33, 34, 35, 36, 37, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15]
