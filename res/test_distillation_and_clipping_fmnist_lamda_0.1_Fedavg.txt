
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
 benign loss is  0.6880226954817772
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 83.22% 

Test Accuracy: 82.25% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.5686096549034119
 benign empirical indicaor res is  0.5686096549034119
 benign loss is  0.693304568529129
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 86.18% 

Test Accuracy: 85.06% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.15725500881671906
 benign empirical indicaor res is  0.15725500881671906
 benign loss is  0.4993735011667013
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.12% 

Test Accuracy: 85.90% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.07865705341100693
 benign empirical indicaor res is  0.07865705341100693
 benign loss is  0.546130957081914
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.36% 

Test Accuracy: 86.12% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0101303830742836
 benign empirical indicaor res is  0.0101303830742836
 benign loss is  0.5378842698410153
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.40% 

Test Accuracy: 85.98% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.002447816776111722
 benign empirical indicaor res is  0.002447816776111722
 benign loss is  0.576918626204133
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 88.05% 

Test Accuracy: 86.76% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.04567672312259674
 benign empirical indicaor res is  0.04567672312259674
 benign loss is  0.5222756825387478
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.65% 

Test Accuracy: 86.38% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.007454999722540379
 benign empirical indicaor res is  0.007454999722540379
 benign loss is  0.5142655968666077
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 87.99% 

Test Accuracy: 86.99% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.04044210538268089
 benign empirical indicaor res is  0.04044210538268089
 benign loss is  0.5306998528540134
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 88.56% 

Test Accuracy: 87.33% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.07729660719633102
 benign empirical indicaor res is  0.07729660719633102
 benign loss is  0.5206940500065684
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.18% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.02313954196870327
 benign empirical indicaor res is  0.02313954196870327
 benign loss is  0.5251196324825287
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.53% 

Test Accuracy: 87.61% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-3.1572, device='cuda:2')
diff2 is tensor(-3.1572, device='cuda:2')
diff1 is tensor(-0.5856, device='cuda:2')
diff2 is tensor(-0.5856, device='cuda:2')
diff1 is tensor(-16.1081, device='cuda:2')
diff2 is tensor(-16.1081, device='cuda:2')
diff1 is tensor(-0.3458, device='cuda:2')
diff2 is tensor(-0.3458, device='cuda:2')
diff1 is tensor(-0.0056, device='cuda:2')
diff2 is tensor(-0.0056, device='cuda:2')
diff1 is tensor(-3.1106e-07, device='cuda:2')
diff2 is tensor(-3.1106e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(102.7293, device='cuda:2')
compute similarity is  tensor(0.9017, device='cuda:2')
compute distance is  tensor(107.7810, device='cuda:2')
compute similarity is  tensor(0.8996, device='cuda:2')
compute distance is  tensor(108.5980, device='cuda:2')
compute similarity is  tensor(0.8971, device='cuda:2')
compute distance is  tensor(110.2539, device='cuda:2')
compute similarity is  tensor(0.8936, device='cuda:2')
compute distance is  tensor(108.1458, device='cuda:2')
compute similarity is  tensor(0.8976, device='cuda:2')
compute distance is  tensor(105.0459, device='cuda:2')
compute similarity is  tensor(0.9004, device='cuda:2')
compute distance is  tensor(104.5634, device='cuda:2')
compute similarity is  tensor(0.9044, device='cuda:2')
compute distance is  tensor(105.1086, device='cuda:2')
compute similarity is  tensor(0.9023, device='cuda:2')
compute distance is  tensor(103.8222, device='cuda:2')
compute similarity is  tensor(0.9043, device='cuda:2')
compute distance is  tensor(107.6918, device='cuda:2')
compute similarity is  tensor(0.9027, device='cuda:2')
compute distance is  tensor(105.9013, device='cuda:2')
compute similarity is  tensor(0.9038, device='cuda:2')
compute distance is  tensor(105.6044, device='cuda:2')
compute similarity is  tensor(0.9023, device='cuda:2')
calculated distance threshold is  tensor(110.2539, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8145666668229914
inner product is  tensor(6.4806, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8282000001563242
inner product is  tensor(6.5454, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8312333334896574
inner product is  tensor(6.4905, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5810833334896726
inner product is  tensor(6.4261, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5690000001563402
inner product is  tensor(6.4085, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5546000001563416
inner product is  tensor(5.6687, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.6644000001563328
inner product is  tensor(6.1980, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.6440000001563342
inner product is  tensor(5.8216, device='cuda:2')
====================
________________________________
test distance is  tensor(739.1971, device='cuda:2')
test similarity is  tensor(0.3846, device='cuda:2')
test acc is  0.5546000001563416
test loss is 3.1978734541041
test entropy is  0.22564966112438803
________________________________
cal_distance is  tensor(282.6266, device='cuda:2')
cal_distance is  tensor(108.0605, device='cuda:2')
________________________________
test distance is  tensor(108.0605, device='cuda:2')
test similarity is  tensor(0.9437, device='cuda:2')
test acc is  0.8830333334896553
test loss is 0.4020667949687443
test entropy is  0.16194049246720413
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16194049246720413
avg test loss is  0.4020667949687443
avg accuracy is  0.8830333334896553
compute_distance is  tensor(108.0605, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.37146364230273377
avg test loss is  1.73267478456121
avg accuracy is  0.5776000001563394
compute_distance is  tensor(77.9110, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(77.9110, device='cuda:2')
test similarity is  tensor(0.9715, device='cuda:2')
test acc is  0.5776000001563394
test loss is 1.73267478456121
test entropy is  0.37146364230273377
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 87.85% 

Test Accuracy: 87.14% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.6823, device='cuda:2')
diff2 is tensor(0.6823, device='cuda:2')
diff1 is tensor(0.2646, device='cuda:2')
diff2 is tensor(0.2646, device='cuda:2')
diff1 is tensor(-6.7435, device='cuda:2')
diff2 is tensor(-6.7435, device='cuda:2')
diff1 is tensor(0.0174, device='cuda:2')
diff2 is tensor(0.0174, device='cuda:2')
diff1 is tensor(0.0060, device='cuda:2')
diff2 is tensor(0.0060, device='cuda:2')
diff1 is tensor(6.2410e-06, device='cuda:2')
diff2 is tensor(6.2410e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(98.8051, device='cuda:2')
compute similarity is  tensor(0.9161, device='cuda:2')
compute distance is  tensor(103.2384, device='cuda:2')
compute similarity is  tensor(0.9121, device='cuda:2')
compute distance is  tensor(102.3417, device='cuda:2')
compute similarity is  tensor(0.9147, device='cuda:2')
compute distance is  tensor(105.4355, device='cuda:2')
compute similarity is  tensor(0.9077, device='cuda:2')
compute distance is  tensor(103.6279, device='cuda:2')
compute similarity is  tensor(0.9124, device='cuda:2')
compute distance is  tensor(102.1386, device='cuda:2')
compute similarity is  tensor(0.9111, device='cuda:2')
compute distance is  tensor(100.6044, device='cuda:2')
compute similarity is  tensor(0.9162, device='cuda:2')
compute distance is  tensor(100.5397, device='cuda:2')
compute similarity is  tensor(0.9154, device='cuda:2')
compute distance is  tensor(98.5871, device='cuda:2')
compute similarity is  tensor(0.9180, device='cuda:2')
compute distance is  tensor(105.7657, device='cuda:2')
compute similarity is  tensor(0.9097, device='cuda:2')
compute distance is  tensor(102.3440, device='cuda:2')
compute similarity is  tensor(0.9143, device='cuda:2')
compute distance is  tensor(102.7480, device='cuda:2')
compute similarity is  tensor(0.9127, device='cuda:2')
calculated distance threshold is  tensor(105.7657, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8155833334896581
inner product is  tensor(7.8111, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7540666668229943
inner product is  tensor(7.3286, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8075500001563252
inner product is  tensor(7.3622, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5459833334896758
inner product is  tensor(8.4824, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4024500001563411
inner product is  tensor(8.6779, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.4778833334896752
inner product is  tensor(7.5745, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.5389500001563423
inner product is  tensor(9.0255, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.42615000015634136
inner product is  tensor(8.1363, device='cuda:2')
====================
________________________________
test distance is  tensor(735.0619, device='cuda:2')
test similarity is  tensor(0.3885, device='cuda:2')
test acc is  0.4024500001563411
test loss is 5.47668834866237
test entropy is  0.23197058467532017
________________________________
cal_distance is  tensor(276.0389, device='cuda:2')
cal_distance is  tensor(103.6616, device='cuda:2')
________________________________
test distance is  tensor(103.6616, device='cuda:2')
test similarity is  tensor(0.9465, device='cuda:2')
test acc is  0.8731500001563224
test loss is 0.3941591175030798
test entropy is  0.2153444186583765
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2153444186583765
avg test loss is  0.3941591175030798
avg accuracy is  0.8731500001563224
compute_distance is  tensor(103.6616, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3477089445092785
avg test loss is  3.2718974209543483
avg accuracy is  0.42026666682300795
compute_distance is  tensor(73.8106, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(73.8106, device='cuda:2')
test similarity is  tensor(0.9734, device='cuda:2')
test acc is  0.42026666682300795
test loss is 3.2718974209543483
test entropy is  0.3477089445092785
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 77.17% 

Test Accuracy: 76.05% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.5648, device='cuda:2')
diff2 is tensor(-1.5648, device='cuda:2')
diff1 is tensor(-0.2842, device='cuda:2')
diff2 is tensor(-0.2842, device='cuda:2')
diff1 is tensor(-6.1557, device='cuda:2')
diff2 is tensor(-6.1557, device='cuda:2')
diff1 is tensor(-0.2776, device='cuda:2')
diff2 is tensor(-0.2776, device='cuda:2')
diff1 is tensor(0.0059, device='cuda:2')
diff2 is tensor(0.0059, device='cuda:2')
diff1 is tensor(9.7398e-06, device='cuda:2')
diff2 is tensor(9.7398e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(113.5710, device='cuda:2')
compute similarity is  tensor(0.9073, device='cuda:2')
compute distance is  tensor(117.9996, device='cuda:2')
compute similarity is  tensor(0.9014, device='cuda:2')
compute distance is  tensor(115.6051, device='cuda:2')
compute similarity is  tensor(0.9021, device='cuda:2')
compute distance is  tensor(120.7686, device='cuda:2')
compute similarity is  tensor(0.8956, device='cuda:2')
compute distance is  tensor(117.0697, device='cuda:2')
compute similarity is  tensor(0.9017, device='cuda:2')
compute distance is  tensor(117.4326, device='cuda:2')
compute similarity is  tensor(0.9002, device='cuda:2')
compute distance is  tensor(113.7800, device='cuda:2')
compute similarity is  tensor(0.9070, device='cuda:2')
compute distance is  tensor(114.7554, device='cuda:2')
compute similarity is  tensor(0.9056, device='cuda:2')
compute distance is  tensor(110.3256, device='cuda:2')
compute similarity is  tensor(0.9127, device='cuda:2')
compute distance is  tensor(121.1519, device='cuda:2')
compute similarity is  tensor(0.8984, device='cuda:2')
compute distance is  tensor(116.2250, device='cuda:2')
compute similarity is  tensor(0.9031, device='cuda:2')
compute distance is  tensor(113.1741, device='cuda:2')
compute similarity is  tensor(0.9080, device='cuda:2')
calculated distance threshold is  tensor(121.1519, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5032333334896754
inner product is  tensor(7.5973, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5531500001563416
inner product is  tensor(7.0943, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.6204833334896692
inner product is  tensor(7.5214, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5082333334896755
inner product is  tensor(7.6040, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.535216666823009
inner product is  tensor(7.3569, device='cuda:2')
====================
________________________________
test distance is  tensor(366.6817, device='cuda:2')
test similarity is  tensor(0.6484, device='cuda:2')
test acc is  0.5032333334896754
test loss is 2.9498252770793973
test entropy is  0.26872666988736277
________________________________
cal_distance is  tensor(208.6631, device='cuda:2')
cal_distance is  tensor(118.7415, device='cuda:2')
________________________________
test distance is  tensor(118.7415, device='cuda:2')
test similarity is  tensor(0.9344, device='cuda:2')
test acc is  0.7237833334896625
test loss is 0.9791353353178069
test entropy is  0.3025624705021824
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3025624705021824
avg test loss is  0.9791353353178069
avg accuracy is  0.7237833334896625
compute_distance is  tensor(118.7415, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.24006976180874717
avg test loss is  3.1512525079092746
avg accuracy is  0.5037500001563421
compute_distance is  tensor(79.7301, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(79.7301, device='cuda:2')
test similarity is  tensor(0.9705, device='cuda:2')
test acc is  0.5037500001563421
test loss is 3.1512525079092746
test entropy is  0.24006976180874717
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 86.59% 

Test Accuracy: 85.50% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.5083, device='cuda:2')
diff2 is tensor(2.5083, device='cuda:2')
diff1 is tensor(-0.2420, device='cuda:2')
diff2 is tensor(-0.2420, device='cuda:2')
diff1 is tensor(12.8943, device='cuda:2')
diff2 is tensor(12.8943, device='cuda:2')
diff1 is tensor(0.2424, device='cuda:2')
diff2 is tensor(0.2424, device='cuda:2')
diff1 is tensor(-0.0043, device='cuda:2')
diff2 is tensor(-0.0043, device='cuda:2')
diff1 is tensor(3.9116e-06, device='cuda:2')
diff2 is tensor(3.9116e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(111.8230, device='cuda:2')
compute similarity is  tensor(0.9127, device='cuda:2')
compute distance is  tensor(116.4814, device='cuda:2')
compute similarity is  tensor(0.9078, device='cuda:2')
compute distance is  tensor(117.0721, device='cuda:2')
compute similarity is  tensor(0.9051, device='cuda:2')
compute distance is  tensor(119.2884, device='cuda:2')
compute similarity is  tensor(0.9016, device='cuda:2')
compute distance is  tensor(114.4014, device='cuda:2')
compute similarity is  tensor(0.9093, device='cuda:2')
compute distance is  tensor(115.7103, device='cuda:2')
compute similarity is  tensor(0.9056, device='cuda:2')
compute distance is  tensor(114.2578, device='cuda:2')
compute similarity is  tensor(0.9127, device='cuda:2')
compute distance is  tensor(111.6651, device='cuda:2')
compute similarity is  tensor(0.9139, device='cuda:2')
compute distance is  tensor(111.7462, device='cuda:2')
compute similarity is  tensor(0.9147, device='cuda:2')
compute distance is  tensor(117.9894, device='cuda:2')
compute similarity is  tensor(0.9055, device='cuda:2')
compute distance is  tensor(117.1095, device='cuda:2')
compute similarity is  tensor(0.9080, device='cuda:2')
compute distance is  tensor(113.6106, device='cuda:2')
compute similarity is  tensor(0.9119, device='cuda:2')
calculated distance threshold is  tensor(119.2884, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7317833334896622
inner product is  tensor(6.6128, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7364833334896618
inner product is  tensor(6.8806, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7009500001563305
inner product is  tensor(6.8416, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.32413333348967327
inner product is  tensor(6.6148, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.29590000015633944
inner product is  tensor(6.2744, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.345216666823007
inner product is  tensor(6.9620, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.4937666668230087
inner product is  tensor(7.2485, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.45435000015634164
inner product is  tensor(7.6844, device='cuda:2')
====================
________________________________
test distance is  tensor(736.9071, device='cuda:2')
test similarity is  tensor(0.3997, device='cuda:2')
test acc is  0.29590000015633944
test loss is 10.338106747629292
test entropy is  0.13877547462024034
________________________________
cal_distance is  tensor(293.5225, device='cuda:2')
cal_distance is  tensor(116.9153, device='cuda:2')
________________________________
test distance is  tensor(116.9153, device='cuda:2')
test similarity is  tensor(0.9377, device='cuda:2')
test acc is  0.8481500001563234
test loss is 0.5379410140645275
test entropy is  0.19690688739993426
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19690688739993426
avg test loss is  0.5379410140645275
avg accuracy is  0.8481500001563234
compute_distance is  tensor(116.9153, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2190692975783526
avg test loss is  5.57946033264274
avg accuracy is  0.30173333348967285
compute_distance is  tensor(80.5051, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(80.5051, device='cuda:2')
test similarity is  tensor(0.9706, device='cuda:2')
test acc is  0.30173333348967285
test loss is 5.57946033264274
test entropy is  0.2190692975783526
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 85.26% 

Test Accuracy: 84.03% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.7200, device='cuda:2')
diff2 is tensor(-1.7200, device='cuda:2')
diff1 is tensor(-0.0638, device='cuda:2')
diff2 is tensor(-0.0638, device='cuda:2')
diff1 is tensor(-4.6018, device='cuda:2')
diff2 is tensor(-4.6018, device='cuda:2')
diff1 is tensor(0.0182, device='cuda:2')
diff2 is tensor(0.0182, device='cuda:2')
diff1 is tensor(-0.0098, device='cuda:2')
diff2 is tensor(-0.0098, device='cuda:2')
diff1 is tensor(3.5949e-06, device='cuda:2')
diff2 is tensor(3.5949e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(114.6353, device='cuda:2')
compute similarity is  tensor(0.9090, device='cuda:2')
compute distance is  tensor(117.5674, device='cuda:2')
compute similarity is  tensor(0.9075, device='cuda:2')
compute distance is  tensor(115.6113, device='cuda:2')
compute similarity is  tensor(0.9116, device='cuda:2')
compute distance is  tensor(119.9409, device='cuda:2')
compute similarity is  tensor(0.9037, device='cuda:2')
compute distance is  tensor(114.7318, device='cuda:2')
compute similarity is  tensor(0.9123, device='cuda:2')
compute distance is  tensor(113.9579, device='cuda:2')
compute similarity is  tensor(0.9111, device='cuda:2')
compute distance is  tensor(112.4663, device='cuda:2')
compute similarity is  tensor(0.9182, device='cuda:2')
compute distance is  tensor(112.3480, device='cuda:2')
compute similarity is  tensor(0.9151, device='cuda:2')
compute distance is  tensor(112.6280, device='cuda:2')
compute similarity is  tensor(0.9157, device='cuda:2')
compute distance is  tensor(115.7743, device='cuda:2')
compute similarity is  tensor(0.9123, device='cuda:2')
compute distance is  tensor(115.2719, device='cuda:2')
compute similarity is  tensor(0.9123, device='cuda:2')
compute distance is  tensor(112.2361, device='cuda:2')
compute similarity is  tensor(0.9163, device='cuda:2')
calculated distance threshold is  tensor(119.9409, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6820166668229982
inner product is  tensor(7.8743, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7447666668229947
inner product is  tensor(7.4633, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.6452666668230007
inner product is  tensor(7.5748, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.46496666682300847
inner product is  tensor(7.4705, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.27128333348967215
inner product is  tensor(6.8362, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.33445000015634013
inner product is  tensor(6.7427, device='cuda:2')
====================
________________________________
test distance is  tensor(733.0438, device='cuda:2')
test similarity is  tensor(0.4016, device='cuda:2')
test acc is  0.27128333348967215
test loss is 9.214305782114772
test entropy is  0.15276825829133042
________________________________
cal_distance is  tensor(293.5517, device='cuda:2')
cal_distance is  tensor(117.5548, device='cuda:2')
________________________________
test distance is  tensor(117.5547, device='cuda:2')
test similarity is  tensor(0.9380, device='cuda:2')
test acc is  0.8455166668229901
test loss is 0.5343058311672353
test entropy is  0.2155726109184563
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2155726109184563
avg test loss is  0.5343058311672353
avg accuracy is  0.8455166668229901
compute_distance is  tensor(117.5547, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23732745480626377
avg test loss is  5.066784967999977
avg accuracy is  0.26595000015633874
compute_distance is  tensor(80.6418, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(80.6418, device='cuda:2')
test similarity is  tensor(0.9711, device='cuda:2')
test acc is  0.26595000015633874
test loss is 5.066784967999977
test entropy is  0.23732745480626377
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 87.43% 

Test Accuracy: 86.48% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.0342, device='cuda:2')
diff2 is tensor(-1.0342, device='cuda:2')
diff1 is tensor(0.2805, device='cuda:2')
diff2 is tensor(0.2805, device='cuda:2')
diff1 is tensor(0.5971, device='cuda:2')
diff2 is tensor(0.5971, device='cuda:2')
diff1 is tensor(0.0008, device='cuda:2')
diff2 is tensor(0.0008, device='cuda:2')
diff1 is tensor(0.0161, device='cuda:2')
diff2 is tensor(0.0161, device='cuda:2')
diff1 is tensor(2.1197e-06, device='cuda:2')
diff2 is tensor(2.1197e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(107.9370, device='cuda:2')
compute similarity is  tensor(0.9226, device='cuda:2')
compute distance is  tensor(114.3646, device='cuda:2')
compute similarity is  tensor(0.9164, device='cuda:2')
compute distance is  tensor(111.3499, device='cuda:2')
compute similarity is  tensor(0.9195, device='cuda:2')
compute distance is  tensor(115.1185, device='cuda:2')
compute similarity is  tensor(0.9145, device='cuda:2')
compute distance is  tensor(110.6795, device='cuda:2')
compute similarity is  tensor(0.9225, device='cuda:2')
compute distance is  tensor(111.4916, device='cuda:2')
compute similarity is  tensor(0.9187, device='cuda:2')
compute distance is  tensor(109.5087, device='cuda:2')
compute similarity is  tensor(0.9230, device='cuda:2')
compute distance is  tensor(108.4313, device='cuda:2')
compute similarity is  tensor(0.9238, device='cuda:2')
compute distance is  tensor(104.5663, device='cuda:2')
compute similarity is  tensor(0.9289, device='cuda:2')
compute distance is  tensor(111.3338, device='cuda:2')
compute similarity is  tensor(0.9230, device='cuda:2')
compute distance is  tensor(114.1434, device='cuda:2')
compute similarity is  tensor(0.9181, device='cuda:2')
compute distance is  tensor(108.4444, device='cuda:2')
compute similarity is  tensor(0.9227, device='cuda:2')
calculated distance threshold is  tensor(115.1185, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7025000001563305
inner product is  tensor(8.3031, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6264500001563355
inner product is  tensor(7.5653, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.6874000001563313
inner product is  tensor(7.7876, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.42105000015634136
inner product is  tensor(8.7214, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3256333334896733
inner product is  tensor(7.9748, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.2588500001563385
inner product is  tensor(8.2882, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(734.4067, device='cuda:2')
test similarity is  tensor(0.3957, device='cuda:2')
test acc is  0.2588500001563385
test loss is 11.508798758358335
test entropy is  0.12261760257470455
________________________________
cal_distance is  tensor(287.8570, device='cuda:2')
cal_distance is  tensor(112.8283, device='cuda:2')
________________________________
test distance is  tensor(112.8283, device='cuda:2')
test similarity is  tensor(0.9427, device='cuda:2')
test acc is  0.8600333334896562
test loss is 0.45458088492724436
test entropy is  0.22896251034762052
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22896251034762052
avg test loss is  0.45458088492724436
avg accuracy is  0.8600333334896562
compute_distance is  tensor(112.8283, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.19639552731726215
avg test loss is  5.631457298803431
avg accuracy is  0.24380000015633807
compute_distance is  tensor(77.2268, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(77.2268, device='cuda:2')
test similarity is  tensor(0.9734, device='cuda:2')
test acc is  0.24380000015633807
test loss is 5.631457298803431
test entropy is  0.19639552731726215
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 73.26% 

Test Accuracy: 72.84% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.9491, device='cuda:2')
diff2 is tensor(0.9491, device='cuda:2')
diff1 is tensor(-0.4644, device='cuda:2')
diff2 is tensor(-0.4644, device='cuda:2')
diff1 is tensor(-6.5361, device='cuda:2')
diff2 is tensor(-6.5361, device='cuda:2')
diff1 is tensor(0.1207, device='cuda:2')
diff2 is tensor(0.1207, device='cuda:2')
diff1 is tensor(0.0198, device='cuda:2')
diff2 is tensor(0.0198, device='cuda:2')
diff1 is tensor(1.0171e-05, device='cuda:2')
diff2 is tensor(1.0171e-05, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(121.0896, device='cuda:2')
compute similarity is  tensor(0.9132, device='cuda:2')
compute distance is  tensor(125.9733, device='cuda:2')
compute similarity is  tensor(0.9103, device='cuda:2')
compute distance is  tensor(123.9050, device='cuda:2')
compute similarity is  tensor(0.9106, device='cuda:2')
compute distance is  tensor(126.8671, device='cuda:2')
compute similarity is  tensor(0.9078, device='cuda:2')
compute distance is  tensor(123.6492, device='cuda:2')
compute similarity is  tensor(0.9131, device='cuda:2')
compute distance is  tensor(121.2185, device='cuda:2')
compute similarity is  tensor(0.9161, device='cuda:2')
compute distance is  tensor(123.0294, device='cuda:2')
compute similarity is  tensor(0.9128, device='cuda:2')
compute distance is  tensor(122.8060, device='cuda:2')
compute similarity is  tensor(0.9129, device='cuda:2')
compute distance is  tensor(117.8028, device='cuda:2')
compute similarity is  tensor(0.9207, device='cuda:2')
compute distance is  tensor(125.7580, device='cuda:2')
compute similarity is  tensor(0.9116, device='cuda:2')
compute distance is  tensor(125.6274, device='cuda:2')
compute similarity is  tensor(0.9118, device='cuda:2')
compute distance is  tensor(121.0878, device='cuda:2')
compute similarity is  tensor(0.9155, device='cuda:2')
calculated distance threshold is  tensor(126.8671, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.27963333348967245
inner product is  tensor(7.0754, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.30066666682300613
inner product is  tensor(7.2826, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.3647000001563406
inner product is  tensor(7.4006, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.24498333348967144
inner product is  tensor(6.6945, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.39176666682300765
inner product is  tensor(7.2650, device='cuda:2')
====================
________________________________
test distance is  tensor(367.1638, device='cuda:2')
test similarity is  tensor(0.6636, device='cuda:2')
test acc is  0.24498333348967144
test loss is 6.61411496266119
test entropy is  0.17541668364710644
________________________________
cal_distance is  tensor(213.6684, device='cuda:2')
cal_distance is  tensor(124.3430, device='cuda:2')
________________________________
test distance is  tensor(124.3430, device='cuda:2')
test similarity is  tensor(0.9344, device='cuda:2')
test acc is  0.6057333334896704
test loss is 1.4666669173027151
test entropy is  0.3585929143498701
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.54% 

Test Accuracy: 87.67% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.6311, device='cuda:2')
diff2 is tensor(1.6311, device='cuda:2')
diff1 is tensor(0.4529, device='cuda:2')
diff2 is tensor(0.4529, device='cuda:2')
diff1 is tensor(1.1066, device='cuda:2')
diff2 is tensor(1.1066, device='cuda:2')
diff1 is tensor(-0.2909, device='cuda:2')
diff2 is tensor(-0.2909, device='cuda:2')
diff1 is tensor(-0.0238, device='cuda:2')
diff2 is tensor(-0.0238, device='cuda:2')
diff1 is tensor(-5.6764e-06, device='cuda:2')
diff2 is tensor(-5.6764e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(126.2259, device='cuda:2')
compute similarity is  tensor(0.9170, device='cuda:2')
compute distance is  tensor(129.5552, device='cuda:2')
compute similarity is  tensor(0.9140, device='cuda:2')
compute distance is  tensor(128.4196, device='cuda:2')
compute similarity is  tensor(0.9168, device='cuda:2')
compute distance is  tensor(133.3641, device='cuda:2')
compute similarity is  tensor(0.9071, device='cuda:2')
compute distance is  tensor(126.9213, device='cuda:2')
compute similarity is  tensor(0.9188, device='cuda:2')
compute distance is  tensor(126.3495, device='cuda:2')
compute similarity is  tensor(0.9176, device='cuda:2')
compute distance is  tensor(129.0486, device='cuda:2')
compute similarity is  tensor(0.9160, device='cuda:2')
compute distance is  tensor(123.5270, device='cuda:2')
compute similarity is  tensor(0.9223, device='cuda:2')
compute distance is  tensor(126.5651, device='cuda:2')
compute similarity is  tensor(0.9180, device='cuda:2')
compute distance is  tensor(128.3269, device='cuda:2')
compute similarity is  tensor(0.9183, device='cuda:2')
compute distance is  tensor(126.6885, device='cuda:2')
compute similarity is  tensor(0.9196, device='cuda:2')
compute distance is  tensor(124.9669, device='cuda:2')
compute similarity is  tensor(0.9194, device='cuda:2')
calculated distance threshold is  tensor(133.3641, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7681666668229935
inner product is  tensor(9.1988, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7928166668229925
inner product is  tensor(10.1486, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8038500001563251
inner product is  tensor(9.7523, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2856666668230059
inner product is  tensor(9.8796, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5256000001563422
inner product is  tensor(10.6692, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.38416666682300754
inner product is  tensor(9.2934, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.457583333489675
inner product is  tensor(9.0623, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.5045166668230087
inner product is  tensor(10.5200, device='cuda:2')
====================
________________________________
test distance is  tensor(735.5336, device='cuda:2')
test similarity is  tensor(0.4048, device='cuda:2')
test acc is  0.2856666668230059
test loss is 8.20453823299042
test entropy is  0.1684737505752649
________________________________
cal_distance is  tensor(310.0678, device='cuda:2')
cal_distance is  tensor(130.7108, device='cuda:2')
________________________________
test distance is  tensor(130.7108, device='cuda:2')
test similarity is  tensor(0.9304, device='cuda:2')
test acc is  0.8871666668229885
test loss is 0.37367188540507734
test entropy is  0.17829186423246796
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17829186423246796
avg test loss is  0.37367188540507734
avg accuracy is  0.8871666668229885
compute_distance is  tensor(130.7108, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.26489813109514304
avg test loss is  4.539670063996875
avg accuracy is  0.2840666668230058
compute_distance is  tensor(91.7497, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(91.7497, device='cuda:2')
test similarity is  tensor(0.9661, device='cuda:2')
test acc is  0.2840666668230058
test loss is 4.539670063996875
test entropy is  0.26489813109514304
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 77.62% 

Test Accuracy: 76.32% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.9534, device='cuda:2')
diff2 is tensor(-2.9534, device='cuda:2')
diff1 is tensor(-0.4458, device='cuda:2')
diff2 is tensor(-0.4458, device='cuda:2')
diff1 is tensor(-1.3470, device='cuda:2')
diff2 is tensor(-1.3470, device='cuda:2')
diff1 is tensor(-0.0864, device='cuda:2')
diff2 is tensor(-0.0864, device='cuda:2')
diff1 is tensor(0.0103, device='cuda:2')
diff2 is tensor(0.0103, device='cuda:2')
diff1 is tensor(1.0133e-05, device='cuda:2')
diff2 is tensor(1.0133e-05, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(138.5282, device='cuda:2')
compute similarity is  tensor(0.9065, device='cuda:2')
compute distance is  tensor(139.1912, device='cuda:2')
compute similarity is  tensor(0.9061, device='cuda:2')
compute distance is  tensor(138.6286, device='cuda:2')
compute similarity is  tensor(0.9047, device='cuda:2')
compute distance is  tensor(144.1457, device='cuda:2')
compute similarity is  tensor(0.8969, device='cuda:2')
compute distance is  tensor(140.4192, device='cuda:2')
compute similarity is  tensor(0.9032, device='cuda:2')
compute distance is  tensor(140.5548, device='cuda:2')
compute similarity is  tensor(0.9037, device='cuda:2')
compute distance is  tensor(138.7899, device='cuda:2')
compute similarity is  tensor(0.9078, device='cuda:2')
compute distance is  tensor(134.2808, device='cuda:2')
compute similarity is  tensor(0.9142, device='cuda:2')
compute distance is  tensor(137.8067, device='cuda:2')
compute similarity is  tensor(0.9083, device='cuda:2')
compute distance is  tensor(142.3302, device='cuda:2')
compute similarity is  tensor(0.9057, device='cuda:2')
compute distance is  tensor(144.8560, device='cuda:2')
compute similarity is  tensor(0.8986, device='cuda:2')
compute distance is  tensor(139.0316, device='cuda:2')
compute similarity is  tensor(0.9064, device='cuda:2')
calculated distance threshold is  tensor(144.8560, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.17691666682300186
inner product is  tensor(9.3133, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5701166668230069
inner product is  tensor(9.3833, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.40003333348967446
inner product is  tensor(9.1952, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.3186833334896732
inner product is  tensor(8.9820, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.43690000015634145
inner product is  tensor(9.4634, device='cuda:2')
====================
________________________________
test distance is  tensor(368.2834, device='cuda:2')
test similarity is  tensor(0.6782, device='cuda:2')
test acc is  0.17691666682300186
test loss is 6.431238779889495
test entropy is  0.15714946294676013
________________________________
cal_distance is  tensor(228.6626, device='cuda:2')
cal_distance is  tensor(141.9739, device='cuda:2')
________________________________
test distance is  tensor(141.9739, device='cuda:2')
test similarity is  tensor(0.9227, device='cuda:2')
test acc is  0.594900000156338
test loss is 1.4408898098128182
test entropy is  0.39952569256332127
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.65% 

Test Accuracy: 87.68% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.5753, device='cuda:2')
diff2 is tensor(0.5753, device='cuda:2')
diff1 is tensor(-0.4788, device='cuda:2')
diff2 is tensor(-0.4788, device='cuda:2')
diff1 is tensor(-2.4140, device='cuda:2')
diff2 is tensor(-2.4140, device='cuda:2')
diff1 is tensor(-0.0410, device='cuda:2')
diff2 is tensor(-0.0410, device='cuda:2')
diff1 is tensor(-0.0122, device='cuda:2')
diff2 is tensor(-0.0122, device='cuda:2')
diff1 is tensor(-5.2135e-06, device='cuda:2')
diff2 is tensor(-5.2135e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(140.6216, device='cuda:2')
compute similarity is  tensor(0.9076, device='cuda:2')
compute distance is  tensor(143.4307, device='cuda:2')
compute similarity is  tensor(0.9061, device='cuda:2')
compute distance is  tensor(145.6470, device='cuda:2')
compute similarity is  tensor(0.9018, device='cuda:2')
compute distance is  tensor(144.9162, device='cuda:2')
compute similarity is  tensor(0.9015, device='cuda:2')
compute distance is  tensor(147.2117, device='cuda:2')
compute similarity is  tensor(0.8984, device='cuda:2')
compute distance is  tensor(145.6191, device='cuda:2')
compute similarity is  tensor(0.8999, device='cuda:2')
compute distance is  tensor(142.5138, device='cuda:2')
compute similarity is  tensor(0.9069, device='cuda:2')
compute distance is  tensor(138.6360, device='cuda:2')
compute similarity is  tensor(0.9105, device='cuda:2')
compute distance is  tensor(139.2260, device='cuda:2')
compute similarity is  tensor(0.9107, device='cuda:2')
compute distance is  tensor(144.5842, device='cuda:2')
compute similarity is  tensor(0.9066, device='cuda:2')
compute distance is  tensor(144.4559, device='cuda:2')
compute similarity is  tensor(0.9061, device='cuda:2')
compute distance is  tensor(138.2842, device='cuda:2')
compute similarity is  tensor(0.9136, device='cuda:2')
calculated distance threshold is  tensor(147.2117, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.801966666822992
inner product is  tensor(10.5404, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.747550000156328
inner product is  tensor(10.1490, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8181166668229912
inner product is  tensor(10.8837, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3931166668230077
inner product is  tensor(11.4295, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.41898333348967465
inner product is  tensor(10.5656, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.31855000015633983
inner product is  tensor(11.3642, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.5043666668230088
inner product is  tensor(9.0821, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.5078666668230088
inner product is  tensor(10.0554, device='cuda:2')
====================
________________________________
test distance is  tensor(736.4646, device='cuda:2')
test similarity is  tensor(0.4221, device='cuda:2')
test acc is  0.31855000015633983
test loss is 8.24102340730777
test entropy is  0.15803084167431414
________________________________
cal_distance is  tensor(325.9739, device='cuda:2')
cal_distance is  tensor(144.2828, device='cuda:2')
________________________________
test distance is  tensor(144.2828, device='cuda:2')
test similarity is  tensor(0.9224, device='cuda:2')
test acc is  0.8822000001563222
test loss is 0.3982280903597122
test entropy is  0.1818943614723967
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1818943614723967
avg test loss is  0.3982280903597122
avg accuracy is  0.8822000001563222
compute_distance is  tensor(144.2828, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2670776459422193
avg test loss is  4.3967648919965665
avg accuracy is  0.3178833334896732
compute_distance is  tensor(98.5180, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(98.5180, device='cuda:2')
test similarity is  tensor(0.9633, device='cuda:2')
test acc is  0.3178833334896732
test loss is 4.3967648919965665
test entropy is  0.2670776459422193
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.19% 

Test Accuracy: 87.53% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.0938, device='cuda:2')
diff2 is tensor(-0.0938, device='cuda:2')
diff1 is tensor(0.1559, device='cuda:2')
diff2 is tensor(0.1559, device='cuda:2')
diff1 is tensor(-15.4035, device='cuda:2')
diff2 is tensor(-15.4035, device='cuda:2')
diff1 is tensor(-0.1074, device='cuda:2')
diff2 is tensor(-0.1074, device='cuda:2')
diff1 is tensor(0.0044, device='cuda:2')
diff2 is tensor(0.0044, device='cuda:2')
diff1 is tensor(2.6636e-06, device='cuda:2')
diff2 is tensor(2.6636e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(133.6118, device='cuda:2')
compute similarity is  tensor(0.9159, device='cuda:2')
compute distance is  tensor(131.1145, device='cuda:2')
compute similarity is  tensor(0.9205, device='cuda:2')
compute distance is  tensor(135.0226, device='cuda:2')
compute similarity is  tensor(0.9152, device='cuda:2')
compute distance is  tensor(138.4427, device='cuda:2')
compute similarity is  tensor(0.9065, device='cuda:2')
compute distance is  tensor(140.8774, device='cuda:2')
compute similarity is  tensor(0.9084, device='cuda:2')
compute distance is  tensor(135.1815, device='cuda:2')
compute similarity is  tensor(0.9129, device='cuda:2')
compute distance is  tensor(132.9409, device='cuda:2')
compute similarity is  tensor(0.9170, device='cuda:2')
compute distance is  tensor(129.7671, device='cuda:2')
compute similarity is  tensor(0.9204, device='cuda:2')
compute distance is  tensor(129.9837, device='cuda:2')
compute similarity is  tensor(0.9188, device='cuda:2')
compute distance is  tensor(137.8402, device='cuda:2')
compute similarity is  tensor(0.9127, device='cuda:2')
compute distance is  tensor(133.3967, device='cuda:2')
compute similarity is  tensor(0.9171, device='cuda:2')
compute distance is  tensor(129.8181, device='cuda:2')
compute similarity is  tensor(0.9205, device='cuda:2')
calculated distance threshold is  tensor(140.8774, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6682500001563325
inner product is  tensor(6.6119, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.779766666822993
inner product is  tensor(6.4696, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7626500001563272
inner product is  tensor(6.0595, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2821666668230058
inner product is  tensor(6.0343, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2824000001563391
inner product is  tensor(6.2204, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.32283333348967336
inner product is  tensor(6.8067, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.3932833334896743
inner product is  tensor(7.4129, device='cuda:2')
====================
________________________________
test distance is  tensor(734.2310, device='cuda:2')
test similarity is  tensor(0.4231, device='cuda:2')
test acc is  0.2821666668230058
test loss is 9.109860277379246
test entropy is  0.12317530939907534
________________________________
cal_distance is  tensor(318.3998, device='cuda:2')
cal_distance is  tensor(138.0746, device='cuda:2')
________________________________
test distance is  tensor(138.0746, device='cuda:2')
test similarity is  tensor(0.9281, device='cuda:2')
test acc is  0.8801166668229888
test loss is 0.4096325292690858
test entropy is  0.18868611655287396
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18868611655287396
avg test loss is  0.4096325292690858
avg accuracy is  0.8801166668229888
compute_distance is  tensor(138.0746, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2075831104538588
avg test loss is  4.552315499482633
avg accuracy is  0.2887333334896726
compute_distance is  tensor(94.5133, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(94.5133, device='cuda:2')
test similarity is  tensor(0.9664, device='cuda:2')
test acc is  0.2887333334896726
test loss is 4.552315499482633
test entropy is  0.2075831104538588
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 87.74% 

Test Accuracy: 86.88% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.8398, device='cuda:2')
diff2 is tensor(-2.8398, device='cuda:2')
diff1 is tensor(-0.0463, device='cuda:2')
diff2 is tensor(-0.0463, device='cuda:2')
diff1 is tensor(18.0494, device='cuda:2')
diff2 is tensor(18.0494, device='cuda:2')
diff1 is tensor(0.1516, device='cuda:2')
diff2 is tensor(0.1516, device='cuda:2')
diff1 is tensor(0.0067, device='cuda:2')
diff2 is tensor(0.0067, device='cuda:2')
diff1 is tensor(3.8613e-06, device='cuda:2')
diff2 is tensor(3.8613e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(132.2875, device='cuda:2')
compute similarity is  tensor(0.9174, device='cuda:2')
compute distance is  tensor(140.5996, device='cuda:2')
compute similarity is  tensor(0.9084, device='cuda:2')
compute distance is  tensor(136.6277, device='cuda:2')
compute similarity is  tensor(0.9127, device='cuda:2')
compute distance is  tensor(139.1645, device='cuda:2')
compute similarity is  tensor(0.9102, device='cuda:2')
compute distance is  tensor(136.4088, device='cuda:2')
compute similarity is  tensor(0.9123, device='cuda:2')
compute distance is  tensor(133.6394, device='cuda:2')
compute similarity is  tensor(0.9165, device='cuda:2')
compute distance is  tensor(135.2903, device='cuda:2')
compute similarity is  tensor(0.9177, device='cuda:2')
compute distance is  tensor(131.4393, device='cuda:2')
compute similarity is  tensor(0.9201, device='cuda:2')
compute distance is  tensor(128.7140, device='cuda:2')
compute similarity is  tensor(0.9231, device='cuda:2')
compute distance is  tensor(134.7952, device='cuda:2')
compute similarity is  tensor(0.9172, device='cuda:2')
compute distance is  tensor(134.8132, device='cuda:2')
compute similarity is  tensor(0.9155, device='cuda:2')
compute distance is  tensor(135.6008, device='cuda:2')
compute similarity is  tensor(0.9144, device='cuda:2')
calculated distance threshold is  tensor(140.5996, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5998833334896708
inner product is  tensor(7.2905, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.6350500001563347
inner product is  tensor(7.4802, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7257166668229957
inner product is  tensor(8.0483, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.34303333348967363
inner product is  tensor(7.5277, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.26565000015633866
inner product is  tensor(8.7875, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.1857500001563356
inner product is  tensor(6.2424, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(733.1136, device='cuda:2')
test similarity is  tensor(0.4240, device='cuda:2')
test acc is  0.1857500001563356
test loss is 11.155375594523415
test entropy is  0.10539800866937904
________________________________
cal_distance is  tensor(317.8436, device='cuda:2')
cal_distance is  tensor(137.8023, device='cuda:2')
________________________________
test distance is  tensor(137.8023, device='cuda:2')
test similarity is  tensor(0.9293, device='cuda:2')
test acc is  0.8682500001563226
test loss is 0.42737757401870513
test entropy is  0.2426979060270893
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2426979060270893
avg test loss is  0.42737757401870513
avg accuracy is  0.8682500001563226
compute_distance is  tensor(137.8023, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15640422197451978
avg test loss is  5.878152475174048
avg accuracy is  0.17206666682300145
compute_distance is  tensor(92.9387, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(92.9387, device='cuda:2')
test similarity is  tensor(0.9678, device='cuda:2')
test acc is  0.17206666682300145
test loss is 5.878152475174048
test entropy is  0.15640422197451978
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 86.32% 

Test Accuracy: 84.92% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.3593, device='cuda:2')
diff2 is tensor(2.3593, device='cuda:2')
diff1 is tensor(-0.0972, device='cuda:2')
diff2 is tensor(-0.0972, device='cuda:2')
diff1 is tensor(-14.6782, device='cuda:2')
diff2 is tensor(-14.6782, device='cuda:2')
diff1 is tensor(-0.0646, device='cuda:2')
diff2 is tensor(-0.0646, device='cuda:2')
diff1 is tensor(0.0059, device='cuda:2')
diff2 is tensor(0.0059, device='cuda:2')
diff1 is tensor(5.1279e-06, device='cuda:2')
diff2 is tensor(5.1279e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(129.9963, device='cuda:2')
compute similarity is  tensor(0.9218, device='cuda:2')
compute distance is  tensor(135.6040, device='cuda:2')
compute similarity is  tensor(0.9159, device='cuda:2')
compute distance is  tensor(137.9555, device='cuda:2')
compute similarity is  tensor(0.9110, device='cuda:2')
compute distance is  tensor(137.9443, device='cuda:2')
compute similarity is  tensor(0.9117, device='cuda:2')
compute distance is  tensor(136.7679, device='cuda:2')
compute similarity is  tensor(0.9131, device='cuda:2')
compute distance is  tensor(133.0864, device='cuda:2')
compute similarity is  tensor(0.9183, device='cuda:2')
compute distance is  tensor(133.6452, device='cuda:2')
compute similarity is  tensor(0.9188, device='cuda:2')
compute distance is  tensor(132.6697, device='cuda:2')
compute similarity is  tensor(0.9201, device='cuda:2')
compute distance is  tensor(127.6556, device='cuda:2')
compute similarity is  tensor(0.9246, device='cuda:2')
compute distance is  tensor(137.7917, device='cuda:2')
compute similarity is  tensor(0.9150, device='cuda:2')
compute distance is  tensor(132.8290, device='cuda:2')
compute similarity is  tensor(0.9182, device='cuda:2')
compute distance is  tensor(134.3998, device='cuda:2')
compute similarity is  tensor(0.9150, device='cuda:2')
calculated distance threshold is  tensor(137.9555, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.544366666823009
inner product is  tensor(6.3650, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3646666668230073
inner product is  tensor(6.0603, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5921333334896716
inner product is  tensor(6.0703, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.577966666823006
inner product is  tensor(6.3104, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5510333334896752
inner product is  tensor(6.1054, device='cuda:2')
====================
________________________________
test distance is  tensor(368.7539, device='cuda:2')
test similarity is  tensor(0.6882, device='cuda:2')
test acc is  0.3646666668230073
test loss is 3.8562980549676076
test entropy is  0.2560554261305439
________________________________
cal_distance is  tensor(223.2922, device='cuda:2')
cal_distance is  tensor(135.2107, device='cuda:2')
________________________________
test distance is  tensor(135.2106, device='cuda:2')
test similarity is  tensor(0.9327, device='cuda:2')
test acc is  0.7984166668229922
test loss is 0.6825535327736248
test entropy is  0.3137205238503688
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3137205238503688
avg test loss is  0.6825535327736248
avg accuracy is  0.7984166668229922
compute_distance is  tensor(135.2106, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22245682117495455
avg test loss is  4.142529210302113
avg accuracy is  0.3570500001563405
compute_distance is  tensor(89.4746, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(89.4746, device='cuda:2')
test similarity is  tensor(0.9702, device='cuda:2')
test acc is  0.3570500001563405
test loss is 4.142529210302113
test entropy is  0.22245682117495455
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.13% 

Test Accuracy: 87.16% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.2416, device='cuda:2')
diff2 is tensor(-1.2416, device='cuda:2')
diff1 is tensor(0.1316, device='cuda:2')
diff2 is tensor(0.1316, device='cuda:2')
diff1 is tensor(9.8075, device='cuda:2')
diff2 is tensor(9.8075, device='cuda:2')
diff1 is tensor(-0.0377, device='cuda:2')
diff2 is tensor(-0.0377, device='cuda:2')
diff1 is tensor(-0.0018, device='cuda:2')
diff2 is tensor(-0.0018, device='cuda:2')
diff1 is tensor(-1.5646e-07, device='cuda:2')
diff2 is tensor(-1.5646e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(129.4650, device='cuda:2')
compute similarity is  tensor(0.9241, device='cuda:2')
compute distance is  tensor(130.5883, device='cuda:2')
compute similarity is  tensor(0.9226, device='cuda:2')
compute distance is  tensor(133.5126, device='cuda:2')
compute similarity is  tensor(0.9227, device='cuda:2')
compute distance is  tensor(135.9379, device='cuda:2')
compute similarity is  tensor(0.9157, device='cuda:2')
compute distance is  tensor(132.1084, device='cuda:2')
compute similarity is  tensor(0.9222, device='cuda:2')
compute distance is  tensor(128.4242, device='cuda:2')
compute similarity is  tensor(0.9253, device='cuda:2')
compute distance is  tensor(131.8054, device='cuda:2')
compute similarity is  tensor(0.9224, device='cuda:2')
compute distance is  tensor(129.3515, device='cuda:2')
compute similarity is  tensor(0.9242, device='cuda:2')
compute distance is  tensor(124.0374, device='cuda:2')
compute similarity is  tensor(0.9301, device='cuda:2')
compute distance is  tensor(133.9514, device='cuda:2')
compute similarity is  tensor(0.9198, device='cuda:2')
compute distance is  tensor(129.8327, device='cuda:2')
compute similarity is  tensor(0.9245, device='cuda:2')
compute distance is  tensor(130.9770, device='cuda:2')
compute similarity is  tensor(0.9211, device='cuda:2')
calculated distance threshold is  tensor(135.9379, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6643333334896662
inner product is  tensor(7.5792, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7226000001563292
inner product is  tensor(7.3089, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7355000001563285
inner product is  tensor(7.1003, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3585000001563405
inner product is  tensor(7.3089, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.27990000015633903
inner product is  tensor(7.2326, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.19421666682300281
inner product is  tensor(7.6096, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.23716666682300452
inner product is  tensor(6.8178, device='cuda:2')
====================
________________________________
test distance is  tensor(738.0215, device='cuda:2')
test similarity is  tensor(0.4292, device='cuda:2')
test acc is  0.19421666682300281
test loss is 11.07757701650103
test entropy is  0.10349748801114335
________________________________
cal_distance is  tensor(313.5744, device='cuda:2')
cal_distance is  tensor(133.2334, device='cuda:2')
________________________________
test distance is  tensor(133.2334, device='cuda:2')
test similarity is  tensor(0.9349, device='cuda:2')
test acc is  0.873316666822989
test loss is 0.4381998003736488
test entropy is  0.2042413270438531
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2042413270438531
avg test loss is  0.4381998003736488
avg accuracy is  0.873316666822989
compute_distance is  tensor(133.2334, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1996385437895113
avg test loss is  4.863160104385571
avg accuracy is  0.20260000015633647
compute_distance is  tensor(90.4557, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(90.4557, device='cuda:2')
test similarity is  tensor(0.9705, device='cuda:2')
test acc is  0.20260000015633647
test loss is 4.863160104385571
test entropy is  0.1996385437895113
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 87.76% 

Test Accuracy: 86.62% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.0255, device='cuda:2')
diff2 is tensor(1.0255, device='cuda:2')
diff1 is tensor(0.0308, device='cuda:2')
diff2 is tensor(0.0308, device='cuda:2')
diff1 is tensor(-3.2271, device='cuda:2')
diff2 is tensor(-3.2271, device='cuda:2')
diff1 is tensor(-0.0383, device='cuda:2')
diff2 is tensor(-0.0383, device='cuda:2')
diff1 is tensor(-0.0099, device='cuda:2')
diff2 is tensor(-0.0099, device='cuda:2')
diff1 is tensor(3.6098e-06, device='cuda:2')
diff2 is tensor(3.6098e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(119.1050, device='cuda:2')
compute similarity is  tensor(0.9334, device='cuda:2')
compute distance is  tensor(123.1927, device='cuda:2')
compute similarity is  tensor(0.9307, device='cuda:2')
compute distance is  tensor(125.6005, device='cuda:2')
compute similarity is  tensor(0.9264, device='cuda:2')
compute distance is  tensor(126.6179, device='cuda:2')
compute similarity is  tensor(0.9266, device='cuda:2')
compute distance is  tensor(126.2605, device='cuda:2')
compute similarity is  tensor(0.9270, device='cuda:2')
compute distance is  tensor(120.7095, device='cuda:2')
compute similarity is  tensor(0.9336, device='cuda:2')
compute distance is  tensor(124.1130, device='cuda:2')
compute similarity is  tensor(0.9301, device='cuda:2')
compute distance is  tensor(119.1954, device='cuda:2')
compute similarity is  tensor(0.9363, device='cuda:2')
compute distance is  tensor(120.0817, device='cuda:2')
compute similarity is  tensor(0.9336, device='cuda:2')
compute distance is  tensor(124.9801, device='cuda:2')
compute similarity is  tensor(0.9323, device='cuda:2')
compute distance is  tensor(126.9867, device='cuda:2')
compute similarity is  tensor(0.9275, device='cuda:2')
compute distance is  tensor(116.5341, device='cuda:2')
compute similarity is  tensor(0.9385, device='cuda:2')
calculated distance threshold is  tensor(126.9867, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6259000001563355
inner product is  tensor(4.8325, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.6200666668230025
inner product is  tensor(5.2557, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.715383333489663
inner product is  tensor(4.4893, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.16391666682300096
inner product is  tensor(4.6301, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4998333334896754
inner product is  tensor(5.0774, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.26541666682300535
inner product is  tensor(5.1309, device='cuda:2')
====================
________________________________
test distance is  tensor(734.6661, device='cuda:2')
test similarity is  tensor(0.4347, device='cuda:2')
test acc is  0.16391666682300096
test loss is 11.821488426184095
test entropy is  0.06541939890449013
________________________________
cal_distance is  tensor(302.3849, device='cuda:2')
cal_distance is  tensor(124.4604, device='cuda:2')
________________________________
test distance is  tensor(124.4604, device='cuda:2')
test similarity is  tensor(0.9431, device='cuda:2')
test acc is  0.8647500001563228
test loss is 0.4441515187115303
test entropy is  0.245295585361498
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.245295585361498
avg test loss is  0.4441515187115303
avg accuracy is  0.8647500001563228
compute_distance is  tensor(124.4604, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11280579653296516
avg test loss is  5.93848669757721
avg accuracy is  0.15818333348966723
compute_distance is  tensor(82.9862, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(82.9862, device='cuda:2')
test similarity is  tensor(0.9749, device='cuda:2')
test acc is  0.15818333348966723
test loss is 5.93848669757721
test entropy is  0.11280579653296516
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 87.32% 

Test Accuracy: 86.25% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.2809, device='cuda:2')
diff2 is tensor(-2.2809, device='cuda:2')
diff1 is tensor(0.0505, device='cuda:2')
diff2 is tensor(0.0505, device='cuda:2')
diff1 is tensor(-3.7987, device='cuda:2')
diff2 is tensor(-3.7987, device='cuda:2')
diff1 is tensor(-0.0690, device='cuda:2')
diff2 is tensor(-0.0690, device='cuda:2')
diff1 is tensor(0.0055, device='cuda:2')
diff2 is tensor(0.0055, device='cuda:2')
diff1 is tensor(3.8482e-06, device='cuda:2')
diff2 is tensor(3.8482e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(120.1739, device='cuda:2')
compute similarity is  tensor(0.9354, device='cuda:2')
compute distance is  tensor(128.6743, device='cuda:2')
compute similarity is  tensor(0.9261, device='cuda:2')
compute distance is  tensor(123.5609, device='cuda:2')
compute similarity is  tensor(0.9328, device='cuda:2')
compute distance is  tensor(128.0132, device='cuda:2')
compute similarity is  tensor(0.9282, device='cuda:2')
compute distance is  tensor(127.6393, device='cuda:2')
compute similarity is  tensor(0.9286, device='cuda:2')
compute distance is  tensor(125.5194, device='cuda:2')
compute similarity is  tensor(0.9307, device='cuda:2')
compute distance is  tensor(128.4805, device='cuda:2')
compute similarity is  tensor(0.9287, device='cuda:2')
compute distance is  tensor(125.1277, device='cuda:2')
compute similarity is  tensor(0.9315, device='cuda:2')
compute distance is  tensor(124.7947, device='cuda:2')
compute similarity is  tensor(0.9313, device='cuda:2')
compute distance is  tensor(127.1582, device='cuda:2')
compute similarity is  tensor(0.9306, device='cuda:2')
compute distance is  tensor(127.2592, device='cuda:2')
compute similarity is  tensor(0.9296, device='cuda:2')
compute distance is  tensor(128.4660, device='cuda:2')
compute similarity is  tensor(0.9270, device='cuda:2')
calculated distance threshold is  tensor(128.6743, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6619166668229995
inner product is  tensor(4.5857, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.5939666668230047
inner product is  tensor(5.4486, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.49025000015634196
inner product is  tensor(5.3870, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.6088333334896702
inner product is  tensor(4.8867, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5978500001563376
inner product is  tensor(5.0448, device='cuda:2')
====================
________________________________
test distance is  tensor(369.2433, device='cuda:2')
test similarity is  tensor(0.6912, device='cuda:2')
test acc is  0.49025000015634196
test loss is 2.461663936246941
test entropy is  0.2817111183553616
________________________________
cal_distance is  tensor(215.7934, device='cuda:2')
cal_distance is  tensor(126.1143, device='cuda:2')
________________________________
test distance is  tensor(126.1143, device='cuda:2')
test similarity is  tensor(0.9422, device='cuda:2')
test acc is  0.8597500001563229
test loss is 0.4779439991248696
test entropy is  0.23933817133275684
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.23933817133275684
avg test loss is  0.4779439991248696
avg accuracy is  0.8597500001563229
compute_distance is  tensor(126.1143, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2559806666553402
avg test loss is  2.3865690979876244
avg accuracy is  0.5057000001563421
compute_distance is  tensor(84.5495, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5495, device='cuda:2')
test similarity is  tensor(0.9742, device='cuda:2')
test acc is  0.5057000001563421
test loss is 2.3865690979876244
test entropy is  0.2559806666553402
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 87.90% 

Test Accuracy: 86.73% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.9657, device='cuda:2')
diff2 is tensor(1.9657, device='cuda:2')
diff1 is tensor(-0.2657, device='cuda:2')
diff2 is tensor(-0.2657, device='cuda:2')
diff1 is tensor(-7.6285, device='cuda:2')
diff2 is tensor(-7.6285, device='cuda:2')
diff1 is tensor(0.0639, device='cuda:2')
diff2 is tensor(0.0639, device='cuda:2')
diff1 is tensor(0.0098, device='cuda:2')
diff2 is tensor(0.0098, device='cuda:2')
diff1 is tensor(3.5800e-06, device='cuda:2')
diff2 is tensor(3.5800e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(107.0112, device='cuda:2')
compute similarity is  tensor(0.9463, device='cuda:2')
compute distance is  tensor(113.4817, device='cuda:2')
compute similarity is  tensor(0.9403, device='cuda:2')
compute distance is  tensor(108.9654, device='cuda:2')
compute similarity is  tensor(0.9455, device='cuda:2')
compute distance is  tensor(114.3304, device='cuda:2')
compute similarity is  tensor(0.9388, device='cuda:2')
compute distance is  tensor(107.5649, device='cuda:2')
compute similarity is  tensor(0.9462, device='cuda:2')
compute distance is  tensor(110.9654, device='cuda:2')
compute similarity is  tensor(0.9428, device='cuda:2')
compute distance is  tensor(111.8338, device='cuda:2')
compute similarity is  tensor(0.9427, device='cuda:2')
compute distance is  tensor(102.9615, device='cuda:2')
compute similarity is  tensor(0.9504, device='cuda:2')
compute distance is  tensor(101.0735, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(110.7185, device='cuda:2')
compute similarity is  tensor(0.9430, device='cuda:2')
compute distance is  tensor(111.6911, device='cuda:2')
compute similarity is  tensor(0.9412, device='cuda:2')
compute distance is  tensor(105.6394, device='cuda:2')
compute similarity is  tensor(0.9471, device='cuda:2')
calculated distance threshold is  tensor(114.3304, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7076000001563302
inner product is  tensor(5.9650, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.39058333348967433
inner product is  tensor(5.5225, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.4563500001563417
inner product is  tensor(6.5679, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2965500001563395
inner product is  tensor(6.3279, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.1400833334896656
inner product is  tensor(5.5143, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.21511666682300365
inner product is  tensor(6.2282, device='cuda:2')
====================
________________________________
test distance is  tensor(736.7339, device='cuda:2')
test similarity is  tensor(0.4365, device='cuda:2')
test acc is  0.1400833334896656
test loss is 13.497126002809894
test entropy is  0.04512400373812519
________________________________
cal_distance is  tensor(287.3242, device='cuda:2')
cal_distance is  tensor(112.0559, device='cuda:2')
________________________________
test distance is  tensor(112.0559, device='cuda:2')
test similarity is  tensor(0.9543, device='cuda:2')
test acc is  0.8691500001563226
test loss is 0.46917591228096217
test entropy is  0.1987889267122949
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1987889267122949
avg test loss is  0.46917591228096217
avg accuracy is  0.8691500001563226
compute_distance is  tensor(112.0559, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0882135782716498
avg test loss is  6.39571949261338
avg accuracy is  0.12988333348966524
compute_distance is  tensor(75.7813, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(75.7813, device='cuda:2')
test similarity is  tensor(0.9797, device='cuda:2')
test acc is  0.12988333348966524
test loss is 6.39571949261338
test entropy is  0.0882135782716498
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 88.33% 

Test Accuracy: 87.00% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.4490, device='cuda:2')
diff2 is tensor(0.4490, device='cuda:2')
diff1 is tensor(-0.2151, device='cuda:2')
diff2 is tensor(-0.2151, device='cuda:2')
diff1 is tensor(0.6850, device='cuda:2')
diff2 is tensor(0.6850, device='cuda:2')
diff1 is tensor(-0.0329, device='cuda:2')
diff2 is tensor(-0.0329, device='cuda:2')
diff1 is tensor(-0.0051, device='cuda:2')
diff2 is tensor(-0.0051, device='cuda:2')
diff1 is tensor(1.2405e-06, device='cuda:2')
diff2 is tensor(1.2405e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(102.5576, device='cuda:2')
compute similarity is  tensor(0.9465, device='cuda:2')
compute distance is  tensor(111.4251, device='cuda:2')
compute similarity is  tensor(0.9412, device='cuda:2')
compute distance is  tensor(107.1673, device='cuda:2')
compute similarity is  tensor(0.9449, device='cuda:2')
compute distance is  tensor(111.3212, device='cuda:2')
compute similarity is  tensor(0.9412, device='cuda:2')
compute distance is  tensor(110.4127, device='cuda:2')
compute similarity is  tensor(0.9427, device='cuda:2')
compute distance is  tensor(104.4806, device='cuda:2')
compute similarity is  tensor(0.9467, device='cuda:2')
compute distance is  tensor(104.0727, device='cuda:2')
compute similarity is  tensor(0.9490, device='cuda:2')
compute distance is  tensor(101.2485, device='cuda:2')
compute similarity is  tensor(0.9508, device='cuda:2')
compute distance is  tensor(93.7119, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(105.8357, device='cuda:2')
compute similarity is  tensor(0.9481, device='cuda:2')
compute distance is  tensor(107.5577, device='cuda:2')
compute similarity is  tensor(0.9456, device='cuda:2')
compute distance is  tensor(100.5924, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
calculated distance threshold is  tensor(111.4251, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4058166668230078
inner product is  tensor(5.9161, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.6670166668229992
inner product is  tensor(5.9597, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.6350500001563348
inner product is  tensor(5.5363, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.7801333334896597
inner product is  tensor(6.6424, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.6501000001563337
inner product is  tensor(5.8590, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.5511166668230085
inner product is  tensor(5.9304, device='cuda:2')
====================
________________________________
test distance is  tensor(369.0215, device='cuda:2')
test similarity is  tensor(0.7001, device='cuda:2')
test acc is  0.4058166668230078
test loss is 3.5612207762976444
test entropy is  0.2054019251516633
________________________________
cal_distance is  tensor(200.7490, device='cuda:2')
cal_distance is  tensor(109.2083, device='cuda:2')
________________________________
test distance is  tensor(109.2083, device='cuda:2')
test similarity is  tensor(0.9569, device='cuda:2')
test acc is  0.864183333489656
test loss is 0.4863829643948119
test entropy is  0.20151943494198418
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.20151943494198418
avg test loss is  0.4863829643948119
avg accuracy is  0.864183333489656
compute_distance is  tensor(109.2083, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1986101363608832
avg test loss is  3.450536672240381
avg accuracy is  0.40403333348967446
compute_distance is  tensor(73.7478, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(73.7478, device='cuda:2')
test similarity is  tensor(0.9808, device='cuda:2')
test acc is  0.40403333348967446
test loss is 3.450536672240381
test entropy is  0.1986101363608832
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 86.84% 

Test Accuracy: 85.68% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.5956, device='cuda:2')
diff2 is tensor(0.5956, device='cuda:2')
diff1 is tensor(0.2300, device='cuda:2')
diff2 is tensor(0.2300, device='cuda:2')
diff1 is tensor(6.1257, device='cuda:2')
diff2 is tensor(6.1257, device='cuda:2')
diff1 is tensor(-0.1182, device='cuda:2')
diff2 is tensor(-0.1182, device='cuda:2')
diff1 is tensor(0.0048, device='cuda:2')
diff2 is tensor(0.0048, device='cuda:2')
diff1 is tensor(5.3085e-06, device='cuda:2')
diff2 is tensor(5.3085e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(102.0814, device='cuda:2')
compute similarity is  tensor(0.9494, device='cuda:2')
compute distance is  tensor(107.7796, device='cuda:2')
compute similarity is  tensor(0.9453, device='cuda:2')
compute distance is  tensor(110.3825, device='cuda:2')
compute similarity is  tensor(0.9429, device='cuda:2')
compute distance is  tensor(118.9622, device='cuda:2')
compute similarity is  tensor(0.9336, device='cuda:2')
compute distance is  tensor(108.3956, device='cuda:2')
compute similarity is  tensor(0.9443, device='cuda:2')
compute distance is  tensor(108.5654, device='cuda:2')
compute similarity is  tensor(0.9465, device='cuda:2')
compute distance is  tensor(109.7126, device='cuda:2')
compute similarity is  tensor(0.9437, device='cuda:2')
compute distance is  tensor(104.8399, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(104.8683, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(107.1683, device='cuda:2')
compute similarity is  tensor(0.9466, device='cuda:2')
compute distance is  tensor(108.6435, device='cuda:2')
compute similarity is  tensor(0.9439, device='cuda:2')
compute distance is  tensor(105.4797, device='cuda:2')
compute similarity is  tensor(0.9471, device='cuda:2')
calculated distance threshold is  tensor(118.9622, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5739500001563398
inner product is  tensor(6.0931, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.660650000156333
inner product is  tensor(6.3158, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5734666668230065
inner product is  tensor(6.2825, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.5829666668230057
inner product is  tensor(6.0464, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.6210166668230025
inner product is  tensor(6.0927, device='cuda:2')
====================
________________________________
test distance is  tensor(366.2632, device='cuda:2')
test similarity is  tensor(0.7013, device='cuda:2')
test acc is  0.5734666668230065
test loss is 2.414961659577864
test entropy is  0.23386903234255085
________________________________
cal_distance is  tensor(206.6508, device='cuda:2')
cal_distance is  tensor(116.5954, device='cuda:2')
________________________________
test distance is  tensor(116.5954, device='cuda:2')
test similarity is  tensor(0.9517, device='cuda:2')
test acc is  0.8588166668229896
test loss is 0.5493997563399485
test entropy is  0.18823340235710906
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18823340235710906
avg test loss is  0.5493997563399485
avg accuracy is  0.8588166668229896
compute_distance is  tensor(116.5954, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.22793798723708847
avg test loss is  2.171390160187475
avg accuracy is  0.5924000001563383
compute_distance is  tensor(78.3567, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(78.3567, device='cuda:2')
test similarity is  tensor(0.9783, device='cuda:2')
test acc is  0.5924000001563383
test loss is 2.171390160187475
test entropy is  0.22793798723708847
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 87.50% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.4359, device='cuda:2')
diff2 is tensor(-1.4359, device='cuda:2')
diff1 is tensor(-0.2327, device='cuda:2')
diff2 is tensor(-0.2327, device='cuda:2')
diff1 is tensor(-5.8362, device='cuda:2')
diff2 is tensor(-5.8362, device='cuda:2')
diff1 is tensor(-0.0483, device='cuda:2')
diff2 is tensor(-0.0483, device='cuda:2')
diff1 is tensor(-0.0063, device='cuda:2')
diff2 is tensor(-0.0063, device='cuda:2')
diff1 is tensor(9.6858e-07, device='cuda:2')
diff2 is tensor(9.6858e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(100.7921, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
compute distance is  tensor(106.0322, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
compute distance is  tensor(105.3659, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
compute distance is  tensor(107.3885, device='cuda:2')
compute similarity is  tensor(0.9447, device='cuda:2')
compute distance is  tensor(108.4918, device='cuda:2')
compute similarity is  tensor(0.9462, device='cuda:2')
compute distance is  tensor(103.0145, device='cuda:2')
compute similarity is  tensor(0.9490, device='cuda:2')
compute distance is  tensor(110.1079, device='cuda:2')
compute similarity is  tensor(0.9432, device='cuda:2')
compute distance is  tensor(98.3508, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(97.0999, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(104.7645, device='cuda:2')
compute similarity is  tensor(0.9492, device='cuda:2')
compute distance is  tensor(104.4249, device='cuda:2')
compute similarity is  tensor(0.9484, device='cuda:2')
compute distance is  tensor(100.0434, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
calculated distance threshold is  tensor(110.1079, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7518833334896611
inner product is  tensor(4.9758, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6735333334896655
inner product is  tensor(4.7853, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.7067833334896636
inner product is  tensor(4.5538, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.1833666668230022
inner product is  tensor(4.8883, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3513000001563404
inner product is  tensor(4.5989, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.2430333334896714
inner product is  tensor(5.3024, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.19963333348966963
inner product is  tensor(4.6979, device='cuda:2')
====================
________________________________
test distance is  tensor(734.1763, device='cuda:2')
test similarity is  tensor(0.4312, device='cuda:2')
test acc is  0.1833666668230022
test loss is 14.496393699890007
test entropy is  0.05302970471388813
________________________________
cal_distance is  tensor(281.4786, device='cuda:2')
cal_distance is  tensor(107.9175, device='cuda:2')
________________________________
test distance is  tensor(107.9175, device='cuda:2')
test similarity is  tensor(0.9583, device='cuda:2')
test acc is  0.8803500001563221
test loss is 0.4649127056675234
test entropy is  0.15151160941925892
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15151160941925892
avg test loss is  0.4649127056675234
avg accuracy is  0.8803500001563221
compute_distance is  tensor(107.9175, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.09377298555743974
avg test loss is  7.087871032483034
avg accuracy is  0.17100000015633476
compute_distance is  tensor(74.6755, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(74.6755, device='cuda:2')
test similarity is  tensor(0.9808, device='cuda:2')
test acc is  0.17100000015633476
test loss is 7.087871032483034
test entropy is  0.09377298555743974
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 86.02% 

Test Accuracy: 84.79% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
