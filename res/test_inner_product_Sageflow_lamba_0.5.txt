
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0
 benign empirical indicaor res is  0.0
 benign loss is  0.7314803823828697
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 82.69% 

Test Accuracy: 82.03% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.5661843419075012
 benign empirical indicaor res is  0.5661843419075012
 benign loss is  0.8702821284532547
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 86.29% 

Test Accuracy: 85.15% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.15714937448501587
 benign empirical indicaor res is  0.15714937448501587
 benign loss is  0.49570537731051445
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 87.21% 

Test Accuracy: 85.97% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.08051171898841858
 benign empirical indicaor res is  0.08051171898841858
 benign loss is  0.5665562432259321
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.44% 

Test Accuracy: 86.03% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.010171965695917606
 benign empirical indicaor res is  0.010171965695917606
 benign loss is  0.5744102708995342
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.28% 

Test Accuracy: 85.99% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.0014110436895862222
 benign empirical indicaor res is  0.0014110436895862222
 benign loss is  0.5583123862743378
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.92% 

Test Accuracy: 86.69% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.046897582709789276
 benign empirical indicaor res is  0.046897582709789276
 benign loss is  0.56385912373662
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.58% 

Test Accuracy: 86.49% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.009601417928934097
 benign empirical indicaor res is  0.009601417928934097
 benign loss is  0.5585996937006712
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 88.10% 

Test Accuracy: 86.91% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.04106290638446808
 benign empirical indicaor res is  0.04106290638446808
 benign loss is  0.563028359785676
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 88.54% 

Test Accuracy: 87.30% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.07854151725769043
 benign empirical indicaor res is  0.07854151725769043
 benign loss is  0.5258998638018966
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.56% 

Test Accuracy: 87.33% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
compare_res is  0.022306697443127632
 benign empirical indicaor res is  0.022306697443127632
 benign loss is  0.5677748075686395
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.60% 

Test Accuracy: 87.27% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.2592, device='cuda:2')
diff2 is tensor(-0.2592, device='cuda:2')
diff1 is tensor(-0.2703, device='cuda:2')
diff2 is tensor(-0.2703, device='cuda:2')
diff1 is tensor(-12.5437, device='cuda:2')
diff2 is tensor(-12.5437, device='cuda:2')
diff1 is tensor(-0.0357, device='cuda:2')
diff2 is tensor(-0.0357, device='cuda:2')
diff1 is tensor(-0.0066, device='cuda:2')
diff2 is tensor(-0.0066, device='cuda:2')
diff1 is tensor(-2.0210e-07, device='cuda:2')
diff2 is tensor(-2.0210e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(102.3804, device='cuda:2')
compute similarity is  tensor(0.9044, device='cuda:2')
compute distance is  tensor(111.2753, device='cuda:2')
compute similarity is  tensor(0.8941, device='cuda:2')
compute distance is  tensor(107.5838, device='cuda:2')
compute similarity is  tensor(0.8961, device='cuda:2')
compute distance is  tensor(111.7407, device='cuda:2')
compute similarity is  tensor(0.8934, device='cuda:2')
compute distance is  tensor(108.3306, device='cuda:2')
compute similarity is  tensor(0.8988, device='cuda:2')
compute distance is  tensor(106.0903, device='cuda:2')
compute similarity is  tensor(0.8988, device='cuda:2')
compute distance is  tensor(106.5300, device='cuda:2')
compute similarity is  tensor(0.9019, device='cuda:2')
compute distance is  tensor(104.5668, device='cuda:2')
compute similarity is  tensor(0.9049, device='cuda:2')
compute distance is  tensor(103.9361, device='cuda:2')
compute similarity is  tensor(0.9064, device='cuda:2')
compute distance is  tensor(107.9266, device='cuda:2')
compute similarity is  tensor(0.8999, device='cuda:2')
compute distance is  tensor(106.9549, device='cuda:2')
compute similarity is  tensor(0.9025, device='cuda:2')
compute distance is  tensor(105.3726, device='cuda:2')
compute similarity is  tensor(0.9027, device='cuda:2')
calculated distance threshold is  tensor(111.7407, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8241833334896577
inner product is  tensor(6.3198, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8321333334896575
inner product is  tensor(6.6972, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8276500001563242
inner product is  tensor(6.6950, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6254333334896689
inner product is  tensor(6.2123, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5766833334896729
inner product is  tensor(7.6007, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5852500001563388
inner product is  tensor(5.7506, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.6495500001563338
inner product is  tensor(6.1134, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.6533333334896668
inner product is  tensor(6.6917, device='cuda:2')
====================
________________________________
test distance is  tensor(735.6187, device='cuda:2')
test similarity is  tensor(0.3956, device='cuda:2')
test acc is  0.5766833334896729
test loss is 2.7291884886176345
test entropy is  0.22482724735604676
________________________________
cal_distance is  tensor(286.7034, device='cuda:2')
cal_distance is  tensor(111.7414, device='cuda:2')
cal_distance is  tensor(43.5510, device='cuda:2')
________________________________
test distance is  tensor(43.5510, device='cuda:2')
test similarity is  tensor(0.9902, device='cuda:2')
test acc is  0.8866500001563219
test loss is 0.3963917667455256
test entropy is  0.15589983195765442
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.15589983195765442
avg test loss is  0.3963917667455256
avg accuracy is  0.8866500001563219
compute_distance is  tensor(43.5510, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4416546042222204
avg test loss is  1.0899604712722144
avg accuracy is  0.6454666668230007
compute_distance is  tensor(19.2019, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(19.2019, device='cuda:2')
test similarity is  tensor(0.9973, device='cuda:2')
test acc is  0.6454666668230007
test loss is 1.0899604712722144
test entropy is  0.4416546042222204
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 88.49% 

Test Accuracy: 87.23% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(3.4934, device='cuda:2')
diff2 is tensor(3.4934, device='cuda:2')
diff1 is tensor(0.1879, device='cuda:2')
diff2 is tensor(0.1879, device='cuda:2')
diff1 is tensor(-1.8195, device='cuda:2')
diff2 is tensor(-1.8195, device='cuda:2')
diff1 is tensor(-0.0654, device='cuda:2')
diff2 is tensor(-0.0654, device='cuda:2')
diff1 is tensor(-0.0003, device='cuda:2')
diff2 is tensor(-0.0003, device='cuda:2')
diff1 is tensor(2.7753e-06, device='cuda:2')
diff2 is tensor(2.7753e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(93.0040, device='cuda:2')
compute similarity is  tensor(0.9188, device='cuda:2')
compute distance is  tensor(99.0243, device='cuda:2')
compute similarity is  tensor(0.9139, device='cuda:2')
compute distance is  tensor(97.7444, device='cuda:2')
compute similarity is  tensor(0.9147, device='cuda:2')
compute distance is  tensor(102.2272, device='cuda:2')
compute similarity is  tensor(0.9058, device='cuda:2')
compute distance is  tensor(97.2133, device='cuda:2')
compute similarity is  tensor(0.9158, device='cuda:2')
compute distance is  tensor(96.3780, device='cuda:2')
compute similarity is  tensor(0.9147, device='cuda:2')
compute distance is  tensor(95.3688, device='cuda:2')
compute similarity is  tensor(0.9178, device='cuda:2')
compute distance is  tensor(94.8205, device='cuda:2')
compute similarity is  tensor(0.9180, device='cuda:2')
compute distance is  tensor(90.7990, device='cuda:2')
compute similarity is  tensor(0.9233, device='cuda:2')
compute distance is  tensor(99.6038, device='cuda:2')
compute similarity is  tensor(0.9125, device='cuda:2')
compute distance is  tensor(96.7564, device='cuda:2')
compute similarity is  tensor(0.9177, device='cuda:2')
compute distance is  tensor(96.4948, device='cuda:2')
compute similarity is  tensor(0.9178, device='cuda:2')
calculated distance threshold is  tensor(102.2272, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8376833334896571
inner product is  tensor(5.8327, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7862166668229926
inner product is  tensor(6.2253, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8145666668229914
inner product is  tensor(6.0850, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6090833334896701
inner product is  tensor(6.9790, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4590666668230084
inner product is  tensor(5.2838, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5105500001563421
inner product is  tensor(5.9798, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.6135333334896699
inner product is  tensor(6.8514, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.4586500001563417
inner product is  tensor(6.2772, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(732.9542, device='cuda:2')
test similarity is  tensor(0.3876, device='cuda:2')
test acc is  0.4586500001563417
test loss is 4.81386518427558
test entropy is  0.19850781512285856
________________________________
cal_distance is  tensor(273.7301, device='cuda:2')
cal_distance is  tensor(102.2279, device='cuda:2')
cal_distance is  tensor(38.1786, device='cuda:2')
________________________________
test distance is  tensor(38.1786, device='cuda:2')
test similarity is  tensor(0.9921, device='cuda:2')
test acc is  0.8874500001563218
test loss is 0.35160615626396907
test entropy is  0.20409300023399946
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.20409300023399946
avg test loss is  0.35160615626396907
avg accuracy is  0.8874500001563218
compute_distance is  tensor(38.1786, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3813404920957744
avg test loss is  2.18531676383415
avg accuracy is  0.4947666668230087
compute_distance is  tensor(17.2107, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(17.2107, device='cuda:2')
test similarity is  tensor(0.9976, device='cuda:2')
test acc is  0.4947666668230087
test loss is 2.18531676383415
test entropy is  0.3813404920957744
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 83.23% 

Test Accuracy: 82.23% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-4.1081, device='cuda:2')
diff2 is tensor(-4.1081, device='cuda:2')
diff1 is tensor(-0.3428, device='cuda:2')
diff2 is tensor(-0.3428, device='cuda:2')
diff1 is tensor(-10.0301, device='cuda:2')
diff2 is tensor(-10.0301, device='cuda:2')
diff1 is tensor(-0.2258, device='cuda:2')
diff2 is tensor(-0.2258, device='cuda:2')
diff1 is tensor(0.0039, device='cuda:2')
diff2 is tensor(0.0039, device='cuda:2')
diff1 is tensor(4.7833e-06, device='cuda:2')
diff2 is tensor(4.7833e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(92.7163, device='cuda:2')
compute similarity is  tensor(0.9224, device='cuda:2')
compute distance is  tensor(98.9607, device='cuda:2')
compute similarity is  tensor(0.9152, device='cuda:2')
compute distance is  tensor(99.9468, device='cuda:2')
compute similarity is  tensor(0.9107, device='cuda:2')
compute distance is  tensor(102.9667, device='cuda:2')
compute similarity is  tensor(0.9085, device='cuda:2')
compute distance is  tensor(97.5067, device='cuda:2')
compute similarity is  tensor(0.9159, device='cuda:2')
compute distance is  tensor(99.7901, device='cuda:2')
compute similarity is  tensor(0.9129, device='cuda:2')
compute distance is  tensor(96.0426, device='cuda:2')
compute similarity is  tensor(0.9192, device='cuda:2')
compute distance is  tensor(95.9792, device='cuda:2')
compute similarity is  tensor(0.9191, device='cuda:2')
compute distance is  tensor(92.9124, device='cuda:2')
compute similarity is  tensor(0.9234, device='cuda:2')
compute distance is  tensor(101.5266, device='cuda:2')
compute similarity is  tensor(0.9131, device='cuda:2')
compute distance is  tensor(97.1004, device='cuda:2')
compute similarity is  tensor(0.9180, device='cuda:2')
compute distance is  tensor(93.1724, device='cuda:2')
compute similarity is  tensor(0.9238, device='cuda:2')
calculated distance threshold is  tensor(102.9667, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6693000001563324
inner product is  tensor(5.4338, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.57225000015634
inner product is  tensor(5.5857, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5271000001563423
inner product is  tensor(5.0617, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.6322333334896684
inner product is  tensor(5.3744, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5621333334896741
inner product is  tensor(5.2233, device='cuda:2')
====================
________________________________
test distance is  tensor(367.4589, device='cuda:2')
test similarity is  tensor(0.6393, device='cuda:2')
test acc is  0.5271000001563423
test loss is 2.4860126840026138
test entropy is  0.26085071815356514
________________________________
cal_distance is  tensor(194.5152, device='cuda:2')
cal_distance is  tensor(102.9673, device='cuda:2')
cal_distance is  tensor(54.5063, device='cuda:2')
________________________________
test distance is  tensor(54.5063, device='cuda:2')
test similarity is  tensor(0.9846, device='cuda:2')
test acc is  0.8279833334896576
test loss is 0.5535909853605573
test entropy is  0.3063728280667303
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3063728280667303
avg test loss is  0.5535909853605573
avg accuracy is  0.8279833334896576
compute_distance is  tensor(54.5063, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2854829902238429
avg test loss is  2.065320440065632
avg accuracy is  0.535216666823009
compute_distance is  tensor(10.9697, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(10.9697, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.535216666823009
test loss is 2.065320440065632
test entropy is  0.2854829902238429
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 88.06% 

Test Accuracy: 87.24% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.1798, device='cuda:2')
diff2 is tensor(2.1798, device='cuda:2')
diff1 is tensor(-0.0612, device='cuda:2')
diff2 is tensor(-0.0612, device='cuda:2')
diff1 is tensor(-1.4549, device='cuda:2')
diff2 is tensor(-1.4549, device='cuda:2')
diff1 is tensor(0.1231, device='cuda:2')
diff2 is tensor(0.1231, device='cuda:2')
diff1 is tensor(0.0153, device='cuda:2')
diff2 is tensor(0.0153, device='cuda:2')
diff1 is tensor(1.9595e-06, device='cuda:2')
diff2 is tensor(1.9595e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(92.2266, device='cuda:2')
compute similarity is  tensor(0.9238, device='cuda:2')
compute distance is  tensor(97.2828, device='cuda:2')
compute similarity is  tensor(0.9206, device='cuda:2')
compute distance is  tensor(99.0695, device='cuda:2')
compute similarity is  tensor(0.9179, device='cuda:2')
compute distance is  tensor(99.8019, device='cuda:2')
compute similarity is  tensor(0.9144, device='cuda:2')
compute distance is  tensor(95.1395, device='cuda:2')
compute similarity is  tensor(0.9215, device='cuda:2')
compute distance is  tensor(93.6855, device='cuda:2')
compute similarity is  tensor(0.9223, device='cuda:2')
compute distance is  tensor(92.8784, device='cuda:2')
compute similarity is  tensor(0.9267, device='cuda:2')
compute distance is  tensor(92.6194, device='cuda:2')
compute similarity is  tensor(0.9257, device='cuda:2')
compute distance is  tensor(90.2249, device='cuda:2')
compute similarity is  tensor(0.9288, device='cuda:2')
compute distance is  tensor(97.3206, device='cuda:2')
compute similarity is  tensor(0.9207, device='cuda:2')
compute distance is  tensor(96.6456, device='cuda:2')
compute similarity is  tensor(0.9224, device='cuda:2')
compute distance is  tensor(91.3847, device='cuda:2')
compute similarity is  tensor(0.9285, device='cuda:2')
calculated distance threshold is  tensor(99.8019, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7423166668229949
inner product is  tensor(5.2363, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7899333334896591
inner product is  tensor(5.5355, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7790666668229931
inner product is  tensor(5.2169, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3471000001563403
inner product is  tensor(5.3940, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.3730166668230073
inner product is  tensor(4.9744, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.37886666682300746
inner product is  tensor(4.5658, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.5151166668230088
inner product is  tensor(5.1021, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.4485666668230083
inner product is  tensor(6.0077, device='cuda:2')
====================
________________________________
test distance is  tensor(737.5073, device='cuda:2')
test similarity is  tensor(0.3855, device='cuda:2')
test acc is  0.3471000001563403
test loss is 6.649189766536135
test entropy is  0.1537253614157629
________________________________
cal_distance is  tensor(271.3023, device='cuda:2')
cal_distance is  tensor(99.8026, device='cuda:2')
cal_distance is  tensor(36.7142, device='cuda:2')
________________________________
test distance is  tensor(36.7142, device='cuda:2')
test similarity is  tensor(0.9930, device='cuda:2')
test acc is  0.8855166668229886
test loss is 0.3873364984163089
test entropy is  0.17906476002035618
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17906476002035618
avg test loss is  0.3873364984163089
avg accuracy is  0.8855166668229886
compute_distance is  tensor(36.7142, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23834378678979143
avg test loss is  3.758154123068364
avg accuracy is  0.3512833334896738
compute_distance is  tensor(12.7957, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.7957, device='cuda:2')
test similarity is  tensor(0.9986, device='cuda:2')
test acc is  0.3512833334896738
test loss is 3.758154123068364
test entropy is  0.23834378678979143
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 87.64% 

Test Accuracy: 86.50% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-3.5202, device='cuda:2')
diff2 is tensor(-3.5202, device='cuda:2')
diff1 is tensor(-0.2559, device='cuda:2')
diff2 is tensor(-0.2559, device='cuda:2')
diff1 is tensor(10.3235, device='cuda:2')
diff2 is tensor(10.3235, device='cuda:2')
diff1 is tensor(0.0112, device='cuda:2')
diff2 is tensor(0.0112, device='cuda:2')
diff1 is tensor(-0.0192, device='cuda:2')
diff2 is tensor(-0.0192, device='cuda:2')
diff1 is tensor(1.9893e-06, device='cuda:2')
diff2 is tensor(1.9893e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(92.7797, device='cuda:2')
compute similarity is  tensor(0.9221, device='cuda:2')
compute distance is  tensor(98.2260, device='cuda:2')
compute similarity is  tensor(0.9215, device='cuda:2')
compute distance is  tensor(95.4297, device='cuda:2')
compute similarity is  tensor(0.9249, device='cuda:2')
compute distance is  tensor(98.4254, device='cuda:2')
compute similarity is  tensor(0.9189, device='cuda:2')
compute distance is  tensor(95.3997, device='cuda:2')
compute similarity is  tensor(0.9245, device='cuda:2')
compute distance is  tensor(92.6185, device='cuda:2')
compute similarity is  tensor(0.9258, device='cuda:2')
compute distance is  tensor(91.5988, device='cuda:2')
compute similarity is  tensor(0.9299, device='cuda:2')
compute distance is  tensor(90.8674, device='cuda:2')
compute similarity is  tensor(0.9294, device='cuda:2')
compute distance is  tensor(88.6951, device='cuda:2')
compute similarity is  tensor(0.9337, device='cuda:2')
compute distance is  tensor(95.4980, device='cuda:2')
compute similarity is  tensor(0.9254, device='cuda:2')
compute distance is  tensor(94.6276, device='cuda:2')
compute similarity is  tensor(0.9265, device='cuda:2')
compute distance is  tensor(90.7331, device='cuda:2')
compute similarity is  tensor(0.9305, device='cuda:2')
calculated distance threshold is  tensor(98.4254, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7972833334896589
inner product is  tensor(6.0978, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7902000001563259
inner product is  tensor(5.9113, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7358666668229952
inner product is  tensor(5.3650, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.5139500001563422
inner product is  tensor(5.2946, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.32265000015633993
inner product is  tensor(5.3747, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.3579000001563405
inner product is  tensor(4.7145, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.41140000015634115
inner product is  tensor(5.5363, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.20108333348966978
inner product is  tensor(5.3954, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(735.7377, device='cuda:2')
test similarity is  tensor(0.3903, device='cuda:2')
test acc is  0.20108333348966978
test loss is 11.584318318600848
test entropy is  0.08246314458088326
________________________________
cal_distance is  tensor(269.1013, device='cuda:2')
cal_distance is  tensor(98.4261, device='cuda:2')
cal_distance is  tensor(36.0005, device='cuda:2')
________________________________
test distance is  tensor(36.0005, device='cuda:2')
test similarity is  tensor(0.9934, device='cuda:2')
test acc is  0.8771166668229889
test loss is 0.400464177798869
test entropy is  0.21423679780064106
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21423679780064106
avg test loss is  0.400464177798869
avg accuracy is  0.8771166668229889
compute_distance is  tensor(36.0005, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.16894079690803088
avg test loss is  5.074391823587641
avg accuracy is  0.2057666668230033
compute_distance is  tensor(12.2632, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.2632, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.2057666668230033
test loss is 5.074391823587641
test entropy is  0.16894079690803088
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 88.08% 

Test Accuracy: 87.03% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(4.3945, device='cuda:2')
diff2 is tensor(4.3945, device='cuda:2')
diff1 is tensor(0.3287, device='cuda:2')
diff2 is tensor(0.3287, device='cuda:2')
diff1 is tensor(-3.1438, device='cuda:2')
diff2 is tensor(-3.1438, device='cuda:2')
diff1 is tensor(0.1217, device='cuda:2')
diff2 is tensor(0.1217, device='cuda:2')
diff1 is tensor(0.0109, device='cuda:2')
diff2 is tensor(0.0109, device='cuda:2')
diff1 is tensor(7.5996e-07, device='cuda:2')
diff2 is tensor(7.5996e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(83.4090, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(91.3471, device='cuda:2')
compute similarity is  tensor(0.9343, device='cuda:2')
compute distance is  tensor(93.6453, device='cuda:2')
compute similarity is  tensor(0.9298, device='cuda:2')
compute distance is  tensor(95.3485, device='cuda:2')
compute similarity is  tensor(0.9267, device='cuda:2')
compute distance is  tensor(90.9501, device='cuda:2')
compute similarity is  tensor(0.9351, device='cuda:2')
compute distance is  tensor(88.5342, device='cuda:2')
compute similarity is  tensor(0.9340, device='cuda:2')
compute distance is  tensor(87.9303, device='cuda:2')
compute similarity is  tensor(0.9377, device='cuda:2')
compute distance is  tensor(87.2550, device='cuda:2')
compute similarity is  tensor(0.9364, device='cuda:2')
compute distance is  tensor(84.3746, device='cuda:2')
compute similarity is  tensor(0.9413, device='cuda:2')
compute distance is  tensor(91.1378, device='cuda:2')
compute similarity is  tensor(0.9363, device='cuda:2')
compute distance is  tensor(90.7815, device='cuda:2')
compute similarity is  tensor(0.9359, device='cuda:2')
compute distance is  tensor(88.4352, device='cuda:2')
compute similarity is  tensor(0.9364, device='cuda:2')
calculated distance threshold is  tensor(95.3485, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7752000001563265
inner product is  tensor(5.5446, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7418833334896616
inner product is  tensor(6.0355, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7345666668229952
inner product is  tensor(5.6423, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2985500001563395
inner product is  tensor(6.5962, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2490833334896716
inner product is  tensor(6.4595, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.3024333334896729
inner product is  tensor(5.2638, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.305933333489673
inner product is  tensor(4.9616, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.21715000015633715
inner product is  tensor(5.4748, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(734.3269, device='cuda:2')
test similarity is  tensor(0.3913, device='cuda:2')
test acc is  0.21715000015633715
test loss is 11.423132646312592
test entropy is  0.09919107258955298
________________________________
cal_distance is  tensor(264.6078, device='cuda:2')
cal_distance is  tensor(95.3493, device='cuda:2')
cal_distance is  tensor(34.3587, device='cuda:2')
________________________________
test distance is  tensor(34.3587, device='cuda:2')
test similarity is  tensor(0.9941, device='cuda:2')
test acc is  0.8817166668229887
test loss is 0.37084291064377023
test entropy is  0.2236867136856132
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2236867136856132
avg test loss is  0.37084291064377023
avg accuracy is  0.8817166668229887
compute_distance is  tensor(34.3587, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2084639413016183
avg test loss is  4.329766683741165
avg accuracy is  0.22173333348967061
compute_distance is  tensor(12.0194, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.0194, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.22173333348967061
test loss is 4.329766683741165
test entropy is  0.2084639413016183
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 80.96% 

Test Accuracy: 79.96% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.0696, device='cuda:2')
diff2 is tensor(-1.0696, device='cuda:2')
diff1 is tensor(-0.2567, device='cuda:2')
diff2 is tensor(-0.2567, device='cuda:2')
diff1 is tensor(-6.1670, device='cuda:2')
diff2 is tensor(-6.1670, device='cuda:2')
diff1 is tensor(-0.1890, device='cuda:2')
diff2 is tensor(-0.1890, device='cuda:2')
diff1 is tensor(-0.0055, device='cuda:2')
diff2 is tensor(-0.0055, device='cuda:2')
diff1 is tensor(4.4284e-06, device='cuda:2')
diff2 is tensor(4.4284e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(88.7560, device='cuda:2')
compute similarity is  tensor(0.9358, device='cuda:2')
compute distance is  tensor(91.2253, device='cuda:2')
compute similarity is  tensor(0.9351, device='cuda:2')
compute distance is  tensor(94.2990, device='cuda:2')
compute similarity is  tensor(0.9305, device='cuda:2')
compute distance is  tensor(93.4105, device='cuda:2')
compute similarity is  tensor(0.9319, device='cuda:2')
compute distance is  tensor(88.6416, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(87.3430, device='cuda:2')
compute similarity is  tensor(0.9398, device='cuda:2')
compute distance is  tensor(90.3437, device='cuda:2')
compute similarity is  tensor(0.9353, device='cuda:2')
compute distance is  tensor(91.7385, device='cuda:2')
compute similarity is  tensor(0.9329, device='cuda:2')
compute distance is  tensor(84.4120, device='cuda:2')
compute similarity is  tensor(0.9441, device='cuda:2')
compute distance is  tensor(94.5154, device='cuda:2')
compute similarity is  tensor(0.9342, device='cuda:2')
compute distance is  tensor(89.4175, device='cuda:2')
compute similarity is  tensor(0.9381, device='cuda:2')
compute distance is  tensor(86.2387, device='cuda:2')
compute similarity is  tensor(0.9399, device='cuda:2')
calculated distance threshold is  tensor(94.5154, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.464483333489675
inner product is  tensor(4.9655, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.3615500001563406
inner product is  tensor(4.9074, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5324333334896757
inner product is  tensor(4.6745, device='cuda:2')
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.549350000156342
inner product is  tensor(4.8343, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5408666668230091
inner product is  tensor(5.0603, device='cuda:2')
====================
________________________________
test distance is  tensor(369.0489, device='cuda:2')
test similarity is  tensor(0.6541, device='cuda:2')
test acc is  0.3615500001563406
test loss is 3.792254759812914
test entropy is  0.23568658999352057
________________________________
cal_distance is  tensor(186.7644, device='cuda:2')
cal_distance is  tensor(94.5160, device='cuda:2')
cal_distance is  tensor(47.8319, device='cuda:2')
________________________________
test distance is  tensor(47.8319, device='cuda:2')
test similarity is  tensor(0.9890, device='cuda:2')
test acc is  0.795933333489659
test loss is 0.6333093681315115
test entropy is  0.34565051872211733
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.34565051872211733
avg test loss is  0.6333093681315115
avg accuracy is  0.795933333489659
compute_distance is  tensor(47.8319, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2663250855291322
avg test loss is  3.03200757033281
avg accuracy is  0.37976666682300747
compute_distance is  tensor(11.0223, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.0223, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.37976666682300747
test loss is 3.03200757033281
test entropy is  0.2663250855291322
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.66% 

Test Accuracy: 87.71% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.7261, device='cuda:2')
diff2 is tensor(-1.7261, device='cuda:2')
diff1 is tensor(-0.0772, device='cuda:2')
diff2 is tensor(-0.0772, device='cuda:2')
diff1 is tensor(7.8698, device='cuda:2')
diff2 is tensor(7.8698, device='cuda:2')
diff1 is tensor(0.0670, device='cuda:2')
diff2 is tensor(0.0670, device='cuda:2')
diff1 is tensor(0.0068, device='cuda:2')
diff2 is tensor(0.0068, device='cuda:2')
diff1 is tensor(4.9733e-07, device='cuda:2')
diff2 is tensor(4.9733e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(85.0926, device='cuda:2')
compute similarity is  tensor(0.9462, device='cuda:2')
compute distance is  tensor(90.2359, device='cuda:2')
compute similarity is  tensor(0.9441, device='cuda:2')
compute distance is  tensor(93.5029, device='cuda:2')
compute similarity is  tensor(0.9418, device='cuda:2')
compute distance is  tensor(100.5241, device='cuda:2')
compute similarity is  tensor(0.9295, device='cuda:2')
compute distance is  tensor(91.8562, device='cuda:2')
compute similarity is  tensor(0.9435, device='cuda:2')
compute distance is  tensor(88.1917, device='cuda:2')
compute similarity is  tensor(0.9458, device='cuda:2')
compute distance is  tensor(89.0251, device='cuda:2')
compute similarity is  tensor(0.9457, device='cuda:2')
compute distance is  tensor(88.3927, device='cuda:2')
compute similarity is  tensor(0.9459, device='cuda:2')
compute distance is  tensor(85.3823, device='cuda:2')
compute similarity is  tensor(0.9469, device='cuda:2')
compute distance is  tensor(87.3418, device='cuda:2')
compute similarity is  tensor(0.9472, device='cuda:2')
compute distance is  tensor(86.7404, device='cuda:2')
compute similarity is  tensor(0.9469, device='cuda:2')
compute distance is  tensor(88.1196, device='cuda:2')
compute similarity is  tensor(0.9446, device='cuda:2')
calculated distance threshold is  tensor(100.5241, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8111500001563249
inner product is  tensor(5.6709, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7223833334896627
inner product is  tensor(5.8536, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.758966666822994
inner product is  tensor(5.7582, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.461083333489675
inner product is  tensor(6.1000, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.27730000015633904
inner product is  tensor(5.3713, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5776000001563395
inner product is  tensor(6.4110, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.5577833334896745
inner product is  tensor(6.4012, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.23735000015633798
inner product is  tensor(6.2677, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(733.5559, device='cuda:2')
test similarity is  tensor(0.4072, device='cuda:2')
test acc is  0.23735000015633798
test loss is 9.060230752806675
test entropy is  0.1261199646111109
________________________________
cal_distance is  tensor(271.5517, device='cuda:2')
cal_distance is  tensor(100.5248, device='cuda:2')
cal_distance is  tensor(37.2132, device='cuda:2')
________________________________
test distance is  tensor(37.2132, device='cuda:2')
test similarity is  tensor(0.9935, device='cuda:2')
test acc is  0.8895500001563218
test loss is 0.3685725097939658
test entropy is  0.17294118834584
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.17294118834584
avg test loss is  0.3685725097939658
avg accuracy is  0.8895500001563218
compute_distance is  tensor(37.2132, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.21753446790359932
avg test loss is  4.73792148221022
avg accuracy is  0.22216666682300398
compute_distance is  tensor(15.5286, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(15.5286, device='cuda:2')
test similarity is  tensor(0.9984, device='cuda:2')
test acc is  0.22216666682300398
test loss is 4.73792148221022
test entropy is  0.21753446790359932
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 80.54% 

Test Accuracy: 79.24% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.4491, device='cuda:2')
diff2 is tensor(1.4491, device='cuda:2')
diff1 is tensor(-0.5277, device='cuda:2')
diff2 is tensor(-0.5277, device='cuda:2')
diff1 is tensor(-22.8295, device='cuda:2')
diff2 is tensor(-22.8295, device='cuda:2')
diff1 is tensor(-0.3793, device='cuda:2')
diff2 is tensor(-0.3793, device='cuda:2')
diff1 is tensor(-0.0069, device='cuda:2')
diff2 is tensor(-0.0069, device='cuda:2')
diff1 is tensor(4.8131e-06, device='cuda:2')
diff2 is tensor(4.8131e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(88.8432, device='cuda:2')
compute similarity is  tensor(0.9433, device='cuda:2')
compute distance is  tensor(90.2055, device='cuda:2')
compute similarity is  tensor(0.9413, device='cuda:2')
compute distance is  tensor(89.5854, device='cuda:2')
compute similarity is  tensor(0.9432, device='cuda:2')
compute distance is  tensor(95.6050, device='cuda:2')
compute similarity is  tensor(0.9322, device='cuda:2')
compute distance is  tensor(91.9476, device='cuda:2')
compute similarity is  tensor(0.9409, device='cuda:2')
compute distance is  tensor(88.4210, device='cuda:2')
compute similarity is  tensor(0.9440, device='cuda:2')
compute distance is  tensor(85.8852, device='cuda:2')
compute similarity is  tensor(0.9471, device='cuda:2')
compute distance is  tensor(82.5576, device='cuda:2')
compute similarity is  tensor(0.9493, device='cuda:2')
compute distance is  tensor(83.3937, device='cuda:2')
compute similarity is  tensor(0.9506, device='cuda:2')
compute distance is  tensor(93.3143, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(92.2853, device='cuda:2')
compute similarity is  tensor(0.9404, device='cuda:2')
compute distance is  tensor(89.1450, device='cuda:2')
compute similarity is  tensor(0.9427, device='cuda:2')
calculated distance threshold is  tensor(95.6050, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6089333334896703
inner product is  tensor(4.3958, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.652033333489667
inner product is  tensor(4.6453, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.3326833334896733
inner product is  tensor(4.3017, device='cuda:2')
====================
succ_min + 1
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.583550000156339
inner product is  tensor(4.0936, device='cuda:2')
====================
====================
iteration is  1
round is  1
accuracy is  0.5949333334896713
inner product is  tensor(4.0866, device='cuda:2')
====================
________________________________
test distance is  tensor(370.1275, device='cuda:2')
test similarity is  tensor(0.6639, device='cuda:2')
test acc is  0.3326833334896733
test loss is 4.01182805627648
test entropy is  0.257070851589698
________________________________
cal_distance is  tensor(188.1122, device='cuda:2')
cal_distance is  tensor(95.6056, device='cuda:2')
cal_distance is  tensor(48.5905, device='cuda:2')
________________________________
test distance is  tensor(48.5905, device='cuda:2')
test similarity is  tensor(0.9893, device='cuda:2')
test acc is  0.7978166668229923
test loss is 0.6235165086382234
test entropy is  0.36591862205630427
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.36591862205630427
avg test loss is  0.6235165086382234
avg accuracy is  0.7978166668229923
compute_distance is  tensor(48.5905, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3072911756220403
avg test loss is  3.067140509706062
avg accuracy is  0.3239333334896733
compute_distance is  tensor(11.2392, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.2392, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.3239333334896733
test loss is 3.067140509706062
test entropy is  0.3072911756220403
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.78% 

Test Accuracy: 87.68% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.0729, device='cuda:2')
diff2 is tensor(-0.0729, device='cuda:2')
diff1 is tensor(0.2094, device='cuda:2')
diff2 is tensor(0.2094, device='cuda:2')
diff1 is tensor(10.6232, device='cuda:2')
diff2 is tensor(10.6232, device='cuda:2')
diff1 is tensor(0.1765, device='cuda:2')
diff2 is tensor(0.1765, device='cuda:2')
diff1 is tensor(0.0004, device='cuda:2')
diff2 is tensor(0.0004, device='cuda:2')
diff1 is tensor(2.9709e-07, device='cuda:2')
diff2 is tensor(2.9709e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(86.7391, device='cuda:2')
compute similarity is  tensor(0.9444, device='cuda:2')
compute distance is  tensor(87.6191, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(94.5147, device='cuda:2')
compute similarity is  tensor(0.9392, device='cuda:2')
compute distance is  tensor(95.8651, device='cuda:2')
compute similarity is  tensor(0.9370, device='cuda:2')
compute distance is  tensor(94.9400, device='cuda:2')
compute similarity is  tensor(0.9393, device='cuda:2')
compute distance is  tensor(88.4422, device='cuda:2')
compute similarity is  tensor(0.9433, device='cuda:2')
compute distance is  tensor(88.9533, device='cuda:2')
compute similarity is  tensor(0.9470, device='cuda:2')
compute distance is  tensor(86.7331, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(83.0066, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(92.4521, device='cuda:2')
compute similarity is  tensor(0.9443, device='cuda:2')
compute distance is  tensor(88.2112, device='cuda:2')
compute similarity is  tensor(0.9451, device='cuda:2')
compute distance is  tensor(83.0684, device='cuda:2')
compute similarity is  tensor(0.9511, device='cuda:2')
calculated distance threshold is  tensor(95.8651, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8071666668229919
inner product is  tensor(6.6121, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7546833334896609
inner product is  tensor(6.1075, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8027166668229919
inner product is  tensor(5.6976, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4725166668230085
inner product is  tensor(6.4348, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2079166668230034
inner product is  tensor(5.5858, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.5216666668230089
inner product is  tensor(6.0519, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.4246500001563414
inner product is  tensor(6.9964, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.3540000001563405
inner product is  tensor(6.7113, device='cuda:2')
====================
________________________________
test distance is  tensor(738.6390, device='cuda:2')
test similarity is  tensor(0.4094, device='cuda:2')
test acc is  0.2079166668230034
test loss is 13.749927025614008
test entropy is  0.06595260724187024
________________________________
cal_distance is  tensor(266.1015, device='cuda:2')
cal_distance is  tensor(95.8658, device='cuda:2')
cal_distance is  tensor(34.5370, device='cuda:2')
________________________________
test distance is  tensor(34.5370, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8919166668229884
test loss is 0.3648930582712327
test entropy is  0.16844912968687156
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.16844912968687156
avg test loss is  0.3648930582712327
avg accuracy is  0.8919166668229884
compute_distance is  tensor(34.5370, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.14597434927818617
avg test loss is  5.222111101597865
avg accuracy is  0.19700000015633623
compute_distance is  tensor(13.4386, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(13.4386, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.19700000015633623
test loss is 5.222111101597865
test entropy is  0.14597434927818617
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.54% 

Test Accuracy: 87.39% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.7965, device='cuda:2')
diff2 is tensor(-1.7965, device='cuda:2')
diff1 is tensor(0.1531, device='cuda:2')
diff2 is tensor(0.1531, device='cuda:2')
diff1 is tensor(-14.9751, device='cuda:2')
diff2 is tensor(-14.9751, device='cuda:2')
diff1 is tensor(-0.1589, device='cuda:2')
diff2 is tensor(-0.1589, device='cuda:2')
diff1 is tensor(-0.0057, device='cuda:2')
diff2 is tensor(-0.0057, device='cuda:2')
diff1 is tensor(4.1910e-07, device='cuda:2')
diff2 is tensor(4.1910e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(86.7118, device='cuda:2')
compute similarity is  tensor(0.9466, device='cuda:2')
compute distance is  tensor(90.5148, device='cuda:2')
compute similarity is  tensor(0.9439, device='cuda:2')
compute distance is  tensor(92.7431, device='cuda:2')
compute similarity is  tensor(0.9412, device='cuda:2')
compute distance is  tensor(95.8062, device='cuda:2')
compute similarity is  tensor(0.9370, device='cuda:2')
compute distance is  tensor(91.3396, device='cuda:2')
compute similarity is  tensor(0.9443, device='cuda:2')
compute distance is  tensor(87.4340, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(87.9775, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
compute distance is  tensor(86.9990, device='cuda:2')
compute similarity is  tensor(0.9470, device='cuda:2')
compute distance is  tensor(79.1415, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(95.2016, device='cuda:2')
compute similarity is  tensor(0.9410, device='cuda:2')
compute distance is  tensor(86.2159, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(85.9019, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
calculated distance threshold is  tensor(95.8062, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7549666668229942
inner product is  tensor(5.3339, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8085333334896584
inner product is  tensor(5.2037, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7903500001563258
inner product is  tensor(5.2561, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2509500001563383
inner product is  tensor(5.3202, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.38151666682300756
inner product is  tensor(3.9446, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.37550000015634083
inner product is  tensor(4.9947, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.4162833334896746
inner product is  tensor(5.1355, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.2942333334896727
inner product is  tensor(4.7905, device='cuda:2')
====================
________________________________
test distance is  tensor(735.8952, device='cuda:2')
test similarity is  tensor(0.4158, device='cuda:2')
test acc is  0.2509500001563383
test loss is 12.47306844369689
test entropy is  0.0817597156255516
________________________________
cal_distance is  tensor(265.5251, device='cuda:2')
cal_distance is  tensor(95.8068, device='cuda:2')
cal_distance is  tensor(34.5694, device='cuda:2')
________________________________
test distance is  tensor(34.5694, device='cuda:2')
test similarity is  tensor(0.9947, device='cuda:2')
test acc is  0.8877666668229884
test loss is 0.37259414522394313
test entropy is  0.1887149843595811
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1887149843595811
avg test loss is  0.37259414522394313
avg accuracy is  0.8877666668229884
compute_distance is  tensor(34.5694, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18203425779938698
avg test loss is  5.041140086869441
avg accuracy is  0.2427666668230047
compute_distance is  tensor(13.5395, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(13.5395, device='cuda:2')
test similarity is  tensor(0.9987, device='cuda:2')
test acc is  0.2427666668230047
test loss is 5.041140086869441
test entropy is  0.18203425779938698
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 87.92% 

Test Accuracy: 86.73% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.2183, device='cuda:2')
diff2 is tensor(0.2183, device='cuda:2')
diff1 is tensor(-0.5060, device='cuda:2')
diff2 is tensor(-0.5060, device='cuda:2')
diff1 is tensor(-8.2698, device='cuda:2')
diff2 is tensor(-8.2698, device='cuda:2')
diff1 is tensor(-0.0206, device='cuda:2')
diff2 is tensor(-0.0206, device='cuda:2')
diff1 is tensor(0.0220, device='cuda:2')
diff2 is tensor(0.0220, device='cuda:2')
diff1 is tensor(2.0175e-06, device='cuda:2')
diff2 is tensor(2.0175e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(85.3596, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
compute distance is  tensor(97.8673, device='cuda:2')
compute similarity is  tensor(0.9374, device='cuda:2')
compute distance is  tensor(93.1386, device='cuda:2')
compute similarity is  tensor(0.9414, device='cuda:2')
compute distance is  tensor(95.8485, device='cuda:2')
compute similarity is  tensor(0.9371, device='cuda:2')
compute distance is  tensor(90.6132, device='cuda:2')
compute similarity is  tensor(0.9453, device='cuda:2')
compute distance is  tensor(88.1213, device='cuda:2')
compute similarity is  tensor(0.9465, device='cuda:2')
compute distance is  tensor(89.6263, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(87.9530, device='cuda:2')
compute similarity is  tensor(0.9486, device='cuda:2')
compute distance is  tensor(78.1593, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(94.7839, device='cuda:2')
compute similarity is  tensor(0.9431, device='cuda:2')
compute distance is  tensor(90.2434, device='cuda:2')
compute similarity is  tensor(0.9450, device='cuda:2')
compute distance is  tensor(90.7489, device='cuda:2')
compute similarity is  tensor(0.9452, device='cuda:2')
calculated distance threshold is  tensor(97.8673, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7525666668229943
inner product is  tensor(5.5334, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.679833333489665
inner product is  tensor(5.8842, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5671166668230071
inner product is  tensor(5.3686, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.36781666682300734
inner product is  tensor(4.4884, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.20975000015633682
inner product is  tensor(5.4532, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.46008333348967506
inner product is  tensor(5.8670, device='cuda:2')
====================
________________________________
test distance is  tensor(730.8599, device='cuda:2')
test similarity is  tensor(0.4258, device='cuda:2')
test acc is  0.20975000015633682
test loss is 11.976394666537548
test entropy is  0.0691373690323376
________________________________
cal_distance is  tensor(267.4463, device='cuda:2')
cal_distance is  tensor(97.8680, device='cuda:2')
cal_distance is  tensor(35.8136, device='cuda:2')
________________________________
test distance is  tensor(35.8136, device='cuda:2')
test similarity is  tensor(0.9944, device='cuda:2')
test acc is  0.8809000001563221
test loss is 0.39263356397591676
test entropy is  0.2074594697368933
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2074594697368933
avg test loss is  0.39263356397591676
avg accuracy is  0.8809000001563221
compute_distance is  tensor(35.8136, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1395670130118124
avg test loss is  5.791726690873917
avg accuracy is  0.21350000015633697
compute_distance is  tensor(10.3649, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(10.3649, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.21350000015633697
test loss is 5.791726690873917
test entropy is  0.1395670130118124
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 85.69% 

Test Accuracy: 84.30% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.0974, device='cuda:2')
diff2 is tensor(0.0974, device='cuda:2')
diff1 is tensor(0.0472, device='cuda:2')
diff2 is tensor(0.0472, device='cuda:2')
diff1 is tensor(5.3239, device='cuda:2')
diff2 is tensor(5.3239, device='cuda:2')
diff1 is tensor(0.0816, device='cuda:2')
diff2 is tensor(0.0816, device='cuda:2')
diff1 is tensor(-0.0108, device='cuda:2')
diff2 is tensor(-0.0108, device='cuda:2')
diff1 is tensor(2.1253e-06, device='cuda:2')
diff2 is tensor(2.1253e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(85.1099, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(96.4338, device='cuda:2')
compute similarity is  tensor(0.9398, device='cuda:2')
compute distance is  tensor(90.3225, device='cuda:2')
compute similarity is  tensor(0.9463, device='cuda:2')
compute distance is  tensor(93.9903, device='cuda:2')
compute similarity is  tensor(0.9406, device='cuda:2')
compute distance is  tensor(92.0784, device='cuda:2')
compute similarity is  tensor(0.9453, device='cuda:2')
compute distance is  tensor(87.0267, device='cuda:2')
compute similarity is  tensor(0.9485, device='cuda:2')
compute distance is  tensor(89.4060, device='cuda:2')
compute similarity is  tensor(0.9479, device='cuda:2')
compute distance is  tensor(87.9497, device='cuda:2')
compute similarity is  tensor(0.9472, device='cuda:2')
compute distance is  tensor(76.1189, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(89.5999, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
compute distance is  tensor(90.8237, device='cuda:2')
compute similarity is  tensor(0.9463, device='cuda:2')
compute distance is  tensor(87.5160, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
calculated distance threshold is  tensor(96.4338, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6716500001563324
inner product is  tensor(6.6868, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7237333334896625
inner product is  tensor(7.1164, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7510666668229944
inner product is  tensor(6.2127, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.29643333348967277
inner product is  tensor(4.7738, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.23913333348967128
inner product is  tensor(7.0570, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.20946666682300347
inner product is  tensor(6.5064, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.28611666682300585
inner product is  tensor(7.1466, device='cuda:2')
====================
________________________________
test distance is  tensor(738.0215, device='cuda:2')
test similarity is  tensor(0.4175, device='cuda:2')
test acc is  0.20946666682300347
test loss is 10.106032022280989
test entropy is  0.09594086143992413
________________________________
cal_distance is  tensor(266.7780, device='cuda:2')
cal_distance is  tensor(96.4345, device='cuda:2')
cal_distance is  tensor(34.8594, device='cuda:2')
________________________________
test distance is  tensor(34.8594, device='cuda:2')
test similarity is  tensor(0.9947, device='cuda:2')
test acc is  0.8629666668229894
test loss is 0.4540347419758595
test entropy is  0.24047388999002067
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.24047388999002067
avg test loss is  0.4540347419758595
avg accuracy is  0.8629666668229894
compute_distance is  tensor(34.8594, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1891919510292092
avg test loss is  4.405250135769468
avg accuracy is  0.21160000015633693
compute_distance is  tensor(10.9773, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(10.9773, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.21160000015633693
test loss is 4.405250135769468
test entropy is  0.1891919510292092
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.57% 

Test Accuracy: 87.41% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.4899, device='cuda:2')
diff2 is tensor(-0.4899, device='cuda:2')
diff1 is tensor(0.1915, device='cuda:2')
diff2 is tensor(0.1915, device='cuda:2')
diff1 is tensor(13.5280, device='cuda:2')
diff2 is tensor(13.5280, device='cuda:2')
diff1 is tensor(-0.0166, device='cuda:2')
diff2 is tensor(-0.0166, device='cuda:2')
diff1 is tensor(-0.0022, device='cuda:2')
diff2 is tensor(-0.0022, device='cuda:2')
diff1 is tensor(2.0117e-07, device='cuda:2')
diff2 is tensor(2.0117e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(84.6150, device='cuda:2')
compute similarity is  tensor(0.9507, device='cuda:2')
compute distance is  tensor(96.7296, device='cuda:2')
compute similarity is  tensor(0.9416, device='cuda:2')
compute distance is  tensor(92.0236, device='cuda:2')
compute similarity is  tensor(0.9456, device='cuda:2')
compute distance is  tensor(94.8618, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(91.9300, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(88.9767, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(85.0742, device='cuda:2')
compute similarity is  tensor(0.9529, device='cuda:2')
compute distance is  tensor(87.5183, device='cuda:2')
compute similarity is  tensor(0.9479, device='cuda:2')
compute distance is  tensor(75.7880, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(92.7107, device='cuda:2')
compute similarity is  tensor(0.9453, device='cuda:2')
compute distance is  tensor(88.9468, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(90.2245, device='cuda:2')
compute similarity is  tensor(0.9466, device='cuda:2')
calculated distance threshold is  tensor(96.7296, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6673666668229994
inner product is  tensor(5.5688, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8123833334896581
inner product is  tensor(5.5558, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8410000001563236
inner product is  tensor(6.1071, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.24108333348967134
inner product is  tensor(5.7679, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.6078833334896703
inner product is  tensor(5.5488, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.39750000015634107
inner product is  tensor(5.7814, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.5045333334896754
inner product is  tensor(6.1184, device='cuda:2')
====================
________________________________
test distance is  tensor(734.6661, device='cuda:2')
test similarity is  tensor(0.4199, device='cuda:2')
test acc is  0.24108333348967134
test loss is 9.927926526649166
test entropy is  0.10045384510017152
________________________________
cal_distance is  tensor(266.5788, device='cuda:2')
cal_distance is  tensor(96.7303, device='cuda:2')
cal_distance is  tensor(35.0997, device='cuda:2')
________________________________
test distance is  tensor(35.0997, device='cuda:2')
test similarity is  tensor(0.9947, device='cuda:2')
test acc is  0.8875000001563219
test loss is 0.36427444989270746
test entropy is  0.19884123541970752
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19884123541970752
avg test loss is  0.36427444989270746
avg accuracy is  0.8875000001563219
compute_distance is  tensor(35.0997, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20019049527071942
avg test loss is  4.490421645422734
avg accuracy is  0.24873333348967153
compute_distance is  tensor(12.0169, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.0169, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.24873333348967153
test loss is 4.490421645422734
test entropy is  0.20019049527071942
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.05% 

Test Accuracy: 86.75% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.0340, device='cuda:2')
diff2 is tensor(-0.0340, device='cuda:2')
diff1 is tensor(-0.2809, device='cuda:2')
diff2 is tensor(-0.2809, device='cuda:2')
diff1 is tensor(-15.0646, device='cuda:2')
diff2 is tensor(-15.0646, device='cuda:2')
diff1 is tensor(-0.0650, device='cuda:2')
diff2 is tensor(-0.0650, device='cuda:2')
diff1 is tensor(0.0106, device='cuda:2')
diff2 is tensor(0.0106, device='cuda:2')
diff1 is tensor(1.5944e-06, device='cuda:2')
diff2 is tensor(1.5944e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(81.4342, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(93.9552, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(84.8713, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(96.4236, device='cuda:2')
compute similarity is  tensor(0.9405, device='cuda:2')
compute distance is  tensor(97.7972, device='cuda:2')
compute similarity is  tensor(0.9443, device='cuda:2')
compute distance is  tensor(84.9949, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(90.1665, device='cuda:2')
compute similarity is  tensor(0.9489, device='cuda:2')
compute distance is  tensor(87.7298, device='cuda:2')
compute similarity is  tensor(0.9512, device='cuda:2')
compute distance is  tensor(82.2685, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(93.4550, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(87.0189, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(82.8952, device='cuda:2')
compute similarity is  tensor(0.9542, device='cuda:2')
calculated distance threshold is  tensor(97.7972, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7176833334896628
inner product is  tensor(3.9462, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6763500001563322
inner product is  tensor(4.0930, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.5293166668230089
inner product is  tensor(4.1891, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2913833334896726
inner product is  tensor(3.5538, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4043833334896745
inner product is  tensor(3.7818, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.22455000015633741
inner product is  tensor(3.8264, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(740.5463, device='cuda:2')
test similarity is  tensor(0.4157, device='cuda:2')
test acc is  0.22455000015633741
test loss is 11.146899111997852
test entropy is  0.09512889915024803
________________________________
cal_distance is  tensor(269.1164, device='cuda:2')
cal_distance is  tensor(97.7979, device='cuda:2')
cal_distance is  tensor(35.5405, device='cuda:2')
________________________________
test distance is  tensor(35.5405, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8835833334896553
test loss is 0.38045248374152285
test entropy is  0.21140668915310648
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21140668915310648
avg test loss is  0.38045248374152285
avg accuracy is  0.8835833334896553
compute_distance is  tensor(35.5405, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15843298626162095
avg test loss is  5.622707817854403
avg accuracy is  0.21251666682300363
compute_distance is  tensor(11.4190, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.4190, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.21251666682300363
test loss is 5.622707817854403
test entropy is  0.15843298626162095
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.08% 

Test Accuracy: 86.66% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.2585, device='cuda:2')
diff2 is tensor(-1.2585, device='cuda:2')
diff1 is tensor(0.2367, device='cuda:2')
diff2 is tensor(0.2367, device='cuda:2')
diff1 is tensor(6.1748, device='cuda:2')
diff2 is tensor(6.1748, device='cuda:2')
diff1 is tensor(0.0528, device='cuda:2')
diff2 is tensor(0.0528, device='cuda:2')
diff1 is tensor(-0.0119, device='cuda:2')
diff2 is tensor(-0.0119, device='cuda:2')
diff1 is tensor(1.6913e-06, device='cuda:2')
diff2 is tensor(1.6913e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(89.7483, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(92.9207, device='cuda:2')
compute similarity is  tensor(0.9489, device='cuda:2')
compute distance is  tensor(92.3106, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(93.8064, device='cuda:2')
compute similarity is  tensor(0.9436, device='cuda:2')
compute distance is  tensor(92.9444, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(93.1852, device='cuda:2')
compute similarity is  tensor(0.9482, device='cuda:2')
compute distance is  tensor(87.7492, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(88.3252, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
compute distance is  tensor(75.2190, device='cuda:2')
compute similarity is  tensor(0.9639, device='cuda:2')
compute distance is  tensor(91.6271, device='cuda:2')
compute similarity is  tensor(0.9498, device='cuda:2')
compute distance is  tensor(88.7185, device='cuda:2')
compute similarity is  tensor(0.9523, device='cuda:2')
compute distance is  tensor(89.9042, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
calculated distance threshold is  tensor(93.8064, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.4848333334896752
inner product is  tensor(5.8720, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7148333334896632
inner product is  tensor(5.9196, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.46023333348967504
inner product is  tensor(5.4014, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3974166668230077
inner product is  tensor(6.2440, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.15231666682300005
inner product is  tensor(5.8275, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.3793166668230075
inner product is  tensor(5.2357, device='cuda:2')
====================
________________________________
test distance is  tensor(738.0423, device='cuda:2')
test similarity is  tensor(0.4258, device='cuda:2')
test acc is  0.15231666682300005
test loss is 16.713223216376072
test entropy is  0.0318257536546492
________________________________
cal_distance is  tensor(263.1224, device='cuda:2')
cal_distance is  tensor(93.8071, device='cuda:2')
cal_distance is  tensor(33.4440, device='cuda:2')
________________________________
test distance is  tensor(33.4440, device='cuda:2')
test similarity is  tensor(0.9953, device='cuda:2')
test acc is  0.8819333334896553
test loss is 0.38562699728238303
test entropy is  0.2137366459409057
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2137366459409057
avg test loss is  0.38562699728238303
avg accuracy is  0.8819333334896553
compute_distance is  tensor(33.4440, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.07755282490865699
avg test loss is  6.603720771732615
avg accuracy is  0.1513500001563333
compute_distance is  tensor(9.8403, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(9.8403, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.1513500001563333
test loss is 6.603720771732615
test entropy is  0.07755282490865699
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 87.65% 

Test Accuracy: 86.29% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.2751, device='cuda:2')
diff2 is tensor(0.2751, device='cuda:2')
diff1 is tensor(0.0394, device='cuda:2')
diff2 is tensor(0.0394, device='cuda:2')
diff1 is tensor(-3.7084, device='cuda:2')
diff2 is tensor(-3.7084, device='cuda:2')
diff1 is tensor(-0.0378, device='cuda:2')
diff2 is tensor(-0.0378, device='cuda:2')
diff1 is tensor(-0.0023, device='cuda:2')
diff2 is tensor(-0.0023, device='cuda:2')
diff1 is tensor(1.6093e-06, device='cuda:2')
diff2 is tensor(1.6093e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(82.4565, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(94.5684, device='cuda:2')
compute similarity is  tensor(0.9455, device='cuda:2')
compute distance is  tensor(95.6314, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(98.5600, device='cuda:2')
compute similarity is  tensor(0.9422, device='cuda:2')
compute distance is  tensor(96.8043, device='cuda:2')
compute similarity is  tensor(0.9455, device='cuda:2')
compute distance is  tensor(84.5413, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(88.7605, device='cuda:2')
compute similarity is  tensor(0.9531, device='cuda:2')
compute distance is  tensor(80.2895, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(80.6119, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(89.6019, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(91.1670, device='cuda:2')
compute similarity is  tensor(0.9513, device='cuda:2')
compute distance is  tensor(86.2430, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
calculated distance threshold is  tensor(98.5600, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7609166668229939
inner product is  tensor(5.3751, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6031000001563374
inner product is  tensor(5.1475, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.6986666668229973
inner product is  tensor(5.5853, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3327500001563401
inner product is  tensor(5.3186, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.23678333348967115
inner product is  tensor(5.7398, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.27686666682300565
inner product is  tensor(5.4828, device='cuda:2')
====================
________________________________
test distance is  tensor(735.2001, device='cuda:2')
test similarity is  tensor(0.4191, device='cuda:2')
test acc is  0.23678333348967115
test loss is 12.592526104404474
test entropy is  0.06770694903683847
________________________________
cal_distance is  tensor(269.1870, device='cuda:2')
cal_distance is  tensor(98.5607, device='cuda:2')
cal_distance is  tensor(36.0876, device='cuda:2')
________________________________
test distance is  tensor(36.0876, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.876916666822989
test loss is 0.40377195569466173
test entropy is  0.22728834115365928
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22728834115365928
avg test loss is  0.40377195569466173
avg accuracy is  0.876916666822989
compute_distance is  tensor(36.0876, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.15811284482161372
avg test loss is  5.0239260369526555
avg accuracy is  0.255366666823005
compute_distance is  tensor(10.8254, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(10.8254, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.255366666823005
test loss is 5.0239260369526555
test entropy is  0.15811284482161372
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 88.61% 

Test Accuracy: 87.53% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.7614, device='cuda:2')
diff2 is tensor(0.7614, device='cuda:2')
diff1 is tensor(-0.2215, device='cuda:2')
diff2 is tensor(-0.2215, device='cuda:2')
diff1 is tensor(-0.5711, device='cuda:2')
diff2 is tensor(-0.5711, device='cuda:2')
diff1 is tensor(0.0996, device='cuda:2')
diff2 is tensor(0.0996, device='cuda:2')
diff1 is tensor(0.0163, device='cuda:2')
diff2 is tensor(0.0163, device='cuda:2')
diff1 is tensor(7.8790e-07, device='cuda:2')
diff2 is tensor(7.8790e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(83.7524, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(84.4414, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(95.4783, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(91.8867, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(95.6419, device='cuda:2')
compute similarity is  tensor(0.9469, device='cuda:2')
compute distance is  tensor(85.5875, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(90.2090, device='cuda:2')
compute similarity is  tensor(0.9504, device='cuda:2')
compute distance is  tensor(82.7630, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(79.4633, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(88.7506, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(86.6497, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(84.1616, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
calculated distance threshold is  tensor(95.6419, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7857666668229927
inner product is  tensor(5.7411, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8100500001563249
inner product is  tensor(5.6383, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8538666668229897
inner product is  tensor(5.7677, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4672000001563418
inner product is  tensor(5.2777, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.292066666823006
inner product is  tensor(5.7110, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.42530000015634134
inner product is  tensor(5.9320, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.4076833334896745
inner product is  tensor(6.2170, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.4770000001563419
inner product is  tensor(5.5999, device='cuda:2')
====================
________________________________
test distance is  tensor(737.7247, device='cuda:2')
test similarity is  tensor(0.4169, device='cuda:2')
test acc is  0.292066666823006
test loss is 8.462719941190057
test entropy is  0.17389997007496066
________________________________
cal_distance is  tensor(265.6270, device='cuda:2')
cal_distance is  tensor(95.6427, device='cuda:2')
cal_distance is  tensor(34.4378, device='cuda:2')
________________________________
test distance is  tensor(34.4378, device='cuda:2')
test similarity is  tensor(0.9951, device='cuda:2')
test acc is  0.8914000001563216
test loss is 0.357602582541483
test entropy is  0.19042706243328447
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19042706243328447
avg test loss is  0.357602582541483
avg accuracy is  0.8914000001563216
compute_distance is  tensor(34.4378, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.39773857962093884
avg test loss is  3.091044306755066
avg accuracy is  0.2765166668230056
compute_distance is  tensor(17.3835, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(17.3835, device='cuda:2')
test similarity is  tensor(0.9982, device='cuda:2')
test acc is  0.2765166668230056
test loss is 3.091044306755066
test entropy is  0.39773857962093884
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 87.21% 

Test Accuracy: 86.14% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.6293, device='cuda:2')
diff2 is tensor(2.6293, device='cuda:2')
diff1 is tensor(-0.0802, device='cuda:2')
diff2 is tensor(-0.0802, device='cuda:2')
diff1 is tensor(0.9213, device='cuda:2')
diff2 is tensor(0.9213, device='cuda:2')
diff1 is tensor(-0.0374, device='cuda:2')
diff2 is tensor(-0.0374, device='cuda:2')
diff1 is tensor(-0.0122, device='cuda:2')
diff2 is tensor(-0.0122, device='cuda:2')
diff1 is tensor(2.3842e-06, device='cuda:2')
diff2 is tensor(2.3842e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(90.5840, device='cuda:2')
compute similarity is  tensor(0.9488, device='cuda:2')
compute distance is  tensor(87.8562, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(88.6763, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(94.2946, device='cuda:2')
compute similarity is  tensor(0.9453, device='cuda:2')
compute distance is  tensor(92.4218, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
compute distance is  tensor(87.0621, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(86.8579, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(86.3945, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(80.9814, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(96.1714, device='cuda:2')
compute similarity is  tensor(0.9489, device='cuda:2')
compute distance is  tensor(93.1206, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(88.7566, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
calculated distance threshold is  tensor(96.1714, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7418000001563282
inner product is  tensor(5.3413, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7260333334896624
inner product is  tensor(5.7454, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7628500001563272
inner product is  tensor(5.4193, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.10965000015633196
inner product is  tensor(4.7364, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2892333334896726
inner product is  tensor(5.8048, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.32295000015633996
inner product is  tensor(6.3760, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.2644666668230053
inner product is  tensor(4.1831, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.3374500001563402
inner product is  tensor(5.3899, device='cuda:2')
====================
________________________________
test distance is  tensor(730.9586, device='cuda:2')
test similarity is  tensor(0.4275, device='cuda:2')
test acc is  0.10965000015633196
test loss is 15.822086207139721
test entropy is  0.02024775977115651
________________________________
cal_distance is  tensor(265.1369, device='cuda:2')
cal_distance is  tensor(96.1721, device='cuda:2')
cal_distance is  tensor(34.8844, device='cuda:2')
________________________________
test distance is  tensor(34.8844, device='cuda:2')
test similarity is  tensor(0.9950, device='cuda:2')
test acc is  0.8729166668229891
test loss is 0.4026789002454103
test entropy is  0.2569615342564929
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2569615342564929
avg test loss is  0.4026789002454103
avg accuracy is  0.8729166668229891
compute_distance is  tensor(34.8844, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.03501212986301321
avg test loss is  7.6134577514266155
avg accuracy is  0.10596666682299863
compute_distance is  tensor(9.1161, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(9.1161, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10596666682299863
test loss is 7.6134577514266155
test entropy is  0.03501212986301321
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 88.49% 

Test Accuracy: 87.40% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-6.4491, device='cuda:2')
diff2 is tensor(-6.4491, device='cuda:2')
diff1 is tensor(0.0367, device='cuda:2')
diff2 is tensor(0.0367, device='cuda:2')
diff1 is tensor(-5.5118, device='cuda:2')
diff2 is tensor(-5.5118, device='cuda:2')
diff1 is tensor(-0.1230, device='cuda:2')
diff2 is tensor(-0.1230, device='cuda:2')
diff1 is tensor(0.0088, device='cuda:2')
diff2 is tensor(0.0088, device='cuda:2')
diff1 is tensor(-4.6566e-09, device='cuda:2')
diff2 is tensor(-4.6566e-09, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(84.4070, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(88.8689, device='cuda:2')
compute similarity is  tensor(0.9531, device='cuda:2')
compute distance is  tensor(95.5682, device='cuda:2')
compute similarity is  tensor(0.9462, device='cuda:2')
compute distance is  tensor(96.7897, device='cuda:2')
compute similarity is  tensor(0.9459, device='cuda:2')
compute distance is  tensor(94.8314, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(87.1025, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(92.1848, device='cuda:2')
compute similarity is  tensor(0.9511, device='cuda:2')
compute distance is  tensor(88.8866, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(82.9003, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(92.4903, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(86.6998, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(89.3735, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
calculated distance threshold is  tensor(96.7897, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6447333334896673
inner product is  tensor(6.1881, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.6351000001563348
inner product is  tensor(5.7578, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.7353833334896619
inner product is  tensor(5.9631, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.25231666682300496
inner product is  tensor(7.2203, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4591500001563417
inner product is  tensor(5.9147, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.6476666668230006
inner product is  tensor(5.5236, device='cuda:2')
====================
________________________________
test distance is  tensor(738.8206, device='cuda:2')
test similarity is  tensor(0.4290, device='cuda:2')
test acc is  0.25231666682300496
test loss is 9.933046974861291
test entropy is  0.10563973230577862
________________________________
cal_distance is  tensor(267.4145, device='cuda:2')
cal_distance is  tensor(96.7905, device='cuda:2')
cal_distance is  tensor(35.0336, device='cuda:2')
________________________________
test distance is  tensor(35.0336, device='cuda:2')
test similarity is  tensor(0.9950, device='cuda:2')
test acc is  0.8914666668229885
test loss is 0.35087294669261876
test entropy is  0.19261163782113905
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19261163782113905
avg test loss is  0.35087294669261876
avg accuracy is  0.8914666668229885
compute_distance is  tensor(35.0336, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23893985496972925
avg test loss is  3.8595821135588038
avg accuracy is  0.23545000015633777
compute_distance is  tensor(12.8632, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.8632, device='cuda:2')
test similarity is  tensor(0.9991, device='cuda:2')
test acc is  0.23545000015633777
test loss is 3.8595821135588038
test entropy is  0.23893985496972925
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 87.24% 

Test Accuracy: 85.90% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.1483, device='cuda:2')
diff2 is tensor(2.1483, device='cuda:2')
diff1 is tensor(-0.4673, device='cuda:2')
diff2 is tensor(-0.4673, device='cuda:2')
diff1 is tensor(0.7569, device='cuda:2')
diff2 is tensor(0.7569, device='cuda:2')
diff1 is tensor(-0.0291, device='cuda:2')
diff2 is tensor(-0.0291, device='cuda:2')
diff1 is tensor(-0.0101, device='cuda:2')
diff2 is tensor(-0.0101, device='cuda:2')
diff1 is tensor(2.4326e-06, device='cuda:2')
diff2 is tensor(2.4326e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(80.8735, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(96.2432, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(93.2383, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
compute distance is  tensor(99.6673, device='cuda:2')
compute similarity is  tensor(0.9448, device='cuda:2')
compute distance is  tensor(95.2073, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(91.0416, device='cuda:2')
compute similarity is  tensor(0.9529, device='cuda:2')
compute distance is  tensor(89.1293, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(83.5609, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(81.9813, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
compute distance is  tensor(87.4128, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
compute distance is  tensor(88.3774, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(85.4754, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
calculated distance threshold is  tensor(99.6673, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6489500001563339
inner product is  tensor(5.9975, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7463833334896615
inner product is  tensor(6.2426, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7222166668229959
inner product is  tensor(6.3305, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.458433333489675
inner product is  tensor(5.2923, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5745500001563398
inner product is  tensor(6.8065, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.3664000001563406
inner product is  tensor(5.9303, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.15986666682300074
inner product is  tensor(5.4913, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(736.5135, device='cuda:2')
test similarity is  tensor(0.4266, device='cuda:2')
test acc is  0.15986666682300074
test loss is 13.493723461622876
test entropy is  0.05467305363995879
________________________________
cal_distance is  tensor(270.9365, device='cuda:2')
cal_distance is  tensor(99.6680, device='cuda:2')
cal_distance is  tensor(36.6647, device='cuda:2')
________________________________
test distance is  tensor(36.6647, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8767166668229889
test loss is 0.40002556311995235
test entropy is  0.22819683397375445
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22819683397375445
avg test loss is  0.40002556311995235
avg accuracy is  0.8767166668229889
compute_distance is  tensor(36.6647, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1355044491080714
avg test loss is  5.234102475363563
avg accuracy is  0.15680000015633375
compute_distance is  tensor(9.4744, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(9.4744, device='cuda:2')
test similarity is  tensor(0.9995, device='cuda:2')
test acc is  0.15680000015633375
test loss is 5.234102475363563
test entropy is  0.1355044491080714
________________________________
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 88.25% 

Test Accuracy: 87.05% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.5837, device='cuda:2')
diff2 is tensor(-0.5837, device='cuda:2')
diff1 is tensor(0.2461, device='cuda:2')
diff2 is tensor(0.2461, device='cuda:2')
diff1 is tensor(-3.8710, device='cuda:2')
diff2 is tensor(-3.8710, device='cuda:2')
diff1 is tensor(-0.0996, device='cuda:2')
diff2 is tensor(-0.0996, device='cuda:2')
diff1 is tensor(0.0133, device='cuda:2')
diff2 is tensor(0.0133, device='cuda:2')
diff1 is tensor(8.9034e-07, device='cuda:2')
diff2 is tensor(8.9034e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(87.0647, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(90.0854, device='cuda:2')
compute similarity is  tensor(0.9517, device='cuda:2')
compute distance is  tensor(91.5177, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(100.9570, device='cuda:2')
compute similarity is  tensor(0.9430, device='cuda:2')
compute distance is  tensor(93.0434, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
compute distance is  tensor(87.8666, device='cuda:2')
compute similarity is  tensor(0.9556, device='cuda:2')
compute distance is  tensor(86.3577, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
compute distance is  tensor(90.0229, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(89.7698, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(90.7436, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(92.4168, device='cuda:2')
compute similarity is  tensor(0.9523, device='cuda:2')
compute distance is  tensor(86.7335, device='cuda:2')
compute similarity is  tensor(0.9560, device='cuda:2')
calculated distance threshold is  tensor(100.9570, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8009500001563254
inner product is  tensor(6.8138, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.681583333489665
inner product is  tensor(7.0145, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.7537333334896609
inner product is  tensor(7.0381, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3686000001563407
inner product is  tensor(6.0803, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2089333334896701
inner product is  tensor(6.0776, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.36498333348967393
inner product is  tensor(6.6915, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.29196666682300604
inner product is  tensor(7.5224, device='cuda:2')
====================
________________________________
test distance is  tensor(738.1136, device='cuda:2')
test similarity is  tensor(0.4324, device='cuda:2')
test acc is  0.2089333334896701
test loss is 11.209413878190746
test entropy is  0.10965325042748375
________________________________
cal_distance is  tensor(272.9799, device='cuda:2')
cal_distance is  tensor(100.9577, device='cuda:2')
cal_distance is  tensor(37.3381, device='cuda:2')
________________________________
test distance is  tensor(37.3381, device='cuda:2')
test similarity is  tensor(0.9945, device='cuda:2')
test acc is  0.8859833334896552
test loss is 0.3653896553501455
test entropy is  0.20650108292031644
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.20650108292031644
avg test loss is  0.3653896553501455
avg accuracy is  0.8859833334896552
compute_distance is  tensor(37.3381, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17762384744785997
avg test loss is  4.78694684546131
avg accuracy is  0.1660333334896678
compute_distance is  tensor(13.7789, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(13.7789, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.1660333334896678
test loss is 4.78694684546131
test entropy is  0.17762384744785997
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 87.61% 

Test Accuracy: 86.64% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.1036, device='cuda:2')
diff2 is tensor(2.1036, device='cuda:2')
diff1 is tensor(0.0259, device='cuda:2')
diff2 is tensor(0.0259, device='cuda:2')
diff1 is tensor(14.3761, device='cuda:2')
diff2 is tensor(14.3761, device='cuda:2')
diff1 is tensor(0.2435, device='cuda:2')
diff2 is tensor(0.2435, device='cuda:2')
diff1 is tensor(-0.0025, device='cuda:2')
diff2 is tensor(-0.0025, device='cuda:2')
diff1 is tensor(1.6401e-06, device='cuda:2')
diff2 is tensor(1.6401e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(84.3013, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(91.8058, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(89.2569, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(93.7109, device='cuda:2')
compute similarity is  tensor(0.9499, device='cuda:2')
compute distance is  tensor(93.3850, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(86.4077, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(90.7075, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(89.6319, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(81.7595, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
compute distance is  tensor(92.4947, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
compute distance is  tensor(92.7692, device='cuda:2')
compute similarity is  tensor(0.9535, device='cuda:2')
compute distance is  tensor(86.5829, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
calculated distance threshold is  tensor(93.7109, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7479000001563278
inner product is  tensor(6.6934, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6660333334896659
inner product is  tensor(6.4018, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.826016666822991
inner product is  tensor(6.2187, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2446666668230048
inner product is  tensor(6.3324, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.36045000015634054
inner product is  tensor(6.6130, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.22668333348967076
inner product is  tensor(6.4181, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.20228333348966987
inner product is  tensor(6.2185, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(736.0670, device='cuda:2')
test similarity is  tensor(0.4343, device='cuda:2')
test acc is  0.20228333348966987
test loss is 12.35909891026869
test entropy is  0.08809798696775363
________________________________
cal_distance is  tensor(262.6361, device='cuda:2')
cal_distance is  tensor(93.7116, device='cuda:2')
cal_distance is  tensor(33.4377, device='cuda:2')
________________________________
test distance is  tensor(33.4377, device='cuda:2')
test similarity is  tensor(0.9956, device='cuda:2')
test acc is  0.8827833334896553
test loss is 0.38028521251989833
test entropy is  0.2077577056597545
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2077577056597545
avg test loss is  0.38028521251989833
avg accuracy is  0.8827833334896553
compute_distance is  tensor(33.4377, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.18378267534919132
avg test loss is  5.449497414041938
avg accuracy is  0.18281666682300213
compute_distance is  tensor(13.5857, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(13.5857, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.18281666682300213
test loss is 5.449497414041938
test entropy is  0.18378267534919132
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 87.80% 

Test Accuracy: 86.84% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.5198, device='cuda:2')
diff2 is tensor(0.5198, device='cuda:2')
diff1 is tensor(-0.2043, device='cuda:2')
diff2 is tensor(-0.2043, device='cuda:2')
diff1 is tensor(-13.6139, device='cuda:2')
diff2 is tensor(-13.6139, device='cuda:2')
diff1 is tensor(-0.1230, device='cuda:2')
diff2 is tensor(-0.1230, device='cuda:2')
diff1 is tensor(-0.0007, device='cuda:2')
diff2 is tensor(-0.0007, device='cuda:2')
diff1 is tensor(1.8207e-06, device='cuda:2')
diff2 is tensor(1.8207e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(85.6712, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(93.2823, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(90.7052, device='cuda:2')
compute similarity is  tensor(0.9543, device='cuda:2')
compute distance is  tensor(101.2547, device='cuda:2')
compute similarity is  tensor(0.9439, device='cuda:2')
compute distance is  tensor(94.9629, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(91.0762, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(89.9143, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(83.3211, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(88.4488, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(94.8215, device='cuda:2')
compute similarity is  tensor(0.9507, device='cuda:2')
compute distance is  tensor(89.2979, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(85.4557, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
calculated distance threshold is  tensor(101.2547, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7446166668229948
inner product is  tensor(3.7639, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7620666668229938
inner product is  tensor(3.7424, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5154000001563421
inner product is  tensor(4.4761, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3126500001563397
inner product is  tensor(3.1601, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.23165000015633763
inner product is  tensor(4.3620, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.307983333489673
inner product is  tensor(3.6533, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.21848333348967047
inner product is  tensor(3.8363, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(739.7625, device='cuda:2')
test similarity is  tensor(0.4383, device='cuda:2')
test acc is  0.21848333348967047
test loss is 9.381337941582522
test entropy is  0.12427006812015576
________________________________
cal_distance is  tensor(273.6872, device='cuda:2')
cal_distance is  tensor(101.2554, device='cuda:2')
cal_distance is  tensor(37.4615, device='cuda:2')
________________________________
test distance is  tensor(37.4615, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8828333334896553
test loss is 0.376446031868013
test entropy is  0.22226772627342484
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.22226772627342484
avg test loss is  0.376446031868013
avg accuracy is  0.8828333334896553
compute_distance is  tensor(37.4615, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2260539733222934
avg test loss is  4.20233325129633
avg accuracy is  0.19165000015633593
compute_distance is  tensor(13.7770, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(13.7770, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.19165000015633593
test loss is 4.20233325129633
test entropy is  0.2260539733222934
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 87.83% 

Test Accuracy: 86.83% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-2.0868, device='cuda:2')
diff2 is tensor(-2.0868, device='cuda:2')
diff1 is tensor(0.1098, device='cuda:2')
diff2 is tensor(0.1098, device='cuda:2')
diff1 is tensor(-6.7522, device='cuda:2')
diff2 is tensor(-6.7522, device='cuda:2')
diff1 is tensor(-0.1966, device='cuda:2')
diff2 is tensor(-0.1966, device='cuda:2')
diff1 is tensor(0.0091, device='cuda:2')
diff2 is tensor(0.0091, device='cuda:2')
diff1 is tensor(1.0729e-06, device='cuda:2')
diff2 is tensor(1.0729e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(87.0071, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(92.2284, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(101.3892, device='cuda:2')
compute similarity is  tensor(0.9439, device='cuda:2')
compute distance is  tensor(101.5602, device='cuda:2')
compute similarity is  tensor(0.9439, device='cuda:2')
compute distance is  tensor(95.9653, device='cuda:2')
compute similarity is  tensor(0.9515, device='cuda:2')
compute distance is  tensor(87.1161, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(90.3800, device='cuda:2')
compute similarity is  tensor(0.9532, device='cuda:2')
compute distance is  tensor(91.9959, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(81.2807, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
compute distance is  tensor(98.3270, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(93.1229, device='cuda:2')
compute similarity is  tensor(0.9531, device='cuda:2')
compute distance is  tensor(82.6283, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
calculated distance threshold is  tensor(101.5602, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6822500001563317
inner product is  tensor(5.8291, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7548000001563275
inner product is  tensor(5.8120, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7038000001563304
inner product is  tensor(6.0446, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.2860000001563392
inner product is  tensor(6.5082, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.27703333348967224
inner product is  tensor(6.4735, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.6243666668230022
inner product is  tensor(6.7572, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.16290000015633427
inner product is  tensor(6.5223, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(734.4457, device='cuda:2')
test similarity is  tensor(0.4395, device='cuda:2')
test acc is  0.16290000015633427
test loss is 9.878449093304209
test entropy is  0.07735881169658226
________________________________
cal_distance is  tensor(273.1130, device='cuda:2')
cal_distance is  tensor(101.5609, device='cuda:2')
cal_distance is  tensor(37.7671, device='cuda:2')
________________________________
test distance is  tensor(37.7671, device='cuda:2')
test similarity is  tensor(0.9945, device='cuda:2')
test acc is  0.883450000156322
test loss is 0.3728634898882431
test entropy is  0.21775729690533457
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21775729690533457
avg test loss is  0.3728634898882431
avg accuracy is  0.883450000156322
compute_distance is  tensor(37.7671, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.10288862880073123
avg test loss is  5.534691891944739
avg accuracy is  0.12950000015633192
compute_distance is  tensor(11.6396, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.6396, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.12950000015633192
test loss is 5.534691891944739
test entropy is  0.10288862880073123
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 88.62% 

Test Accuracy: 87.67% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.6550, device='cuda:2')
diff2 is tensor(1.6550, device='cuda:2')
diff1 is tensor(0.1730, device='cuda:2')
diff2 is tensor(0.1730, device='cuda:2')
diff1 is tensor(2.8149, device='cuda:2')
diff2 is tensor(2.8149, device='cuda:2')
diff1 is tensor(0.1245, device='cuda:2')
diff2 is tensor(0.1245, device='cuda:2')
diff1 is tensor(-0.0206, device='cuda:2')
diff2 is tensor(-0.0206, device='cuda:2')
diff1 is tensor(4.2282e-07, device='cuda:2')
diff2 is tensor(4.2282e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(86.0884, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(87.0050, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(90.5445, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(99.6390, device='cuda:2')
compute similarity is  tensor(0.9455, device='cuda:2')
compute distance is  tensor(98.6120, device='cuda:2')
compute similarity is  tensor(0.9495, device='cuda:2')
compute distance is  tensor(93.3322, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(88.4708, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(83.4367, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(84.5818, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(95.3010, device='cuda:2')
compute similarity is  tensor(0.9521, device='cuda:2')
compute distance is  tensor(92.0413, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
compute distance is  tensor(84.3912, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
calculated distance threshold is  tensor(99.6390, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7507666668229945
inner product is  tensor(6.4182, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.5591166668230079
inner product is  tensor(5.8937, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.662150000156333
inner product is  tensor(5.9135, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4453000001563415
inner product is  tensor(5.8715, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.17185000015633484
inner product is  tensor(5.7296, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.24946666682300495
inner product is  tensor(5.8102, device='cuda:2')
====================
________________________________
test distance is  tensor(738.7728, device='cuda:2')
test similarity is  tensor(0.4324, device='cuda:2')
test acc is  0.17185000015633484
test loss is 10.972666578252179
test entropy is  0.07832008495684593
________________________________
cal_distance is  tensor(271.3132, device='cuda:2')
cal_distance is  tensor(99.6397, device='cuda:2')
cal_distance is  tensor(36.5930, device='cuda:2')
________________________________
test distance is  tensor(36.5930, device='cuda:2')
test similarity is  tensor(0.9949, device='cuda:2')
test acc is  0.8939666668229883
test loss is 0.3465206759697847
test entropy is  0.18294516837260108
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18294516837260108
avg test loss is  0.3465206759697847
avg accuracy is  0.8939666668229883
compute_distance is  tensor(36.5930, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1606568648362719
avg test loss is  4.917264240382831
avg accuracy is  0.15321666682300009
compute_distance is  tensor(12.9293, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.9293, device='cuda:2')
test similarity is  tensor(0.9990, device='cuda:2')
test acc is  0.15321666682300009
test loss is 4.917264240382831
test entropy is  0.1606568648362719
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 87.30% 

Test Accuracy: 86.29% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.5944, device='cuda:2')
diff2 is tensor(-0.5944, device='cuda:2')
diff1 is tensor(-0.4650, device='cuda:2')
diff2 is tensor(-0.4650, device='cuda:2')
diff1 is tensor(10.1176, device='cuda:2')
diff2 is tensor(10.1176, device='cuda:2')
diff1 is tensor(0.0461, device='cuda:2')
diff2 is tensor(0.0461, device='cuda:2')
diff1 is tensor(0.0047, device='cuda:2')
diff2 is tensor(0.0047, device='cuda:2')
diff1 is tensor(2.2668e-06, device='cuda:2')
diff2 is tensor(2.2668e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(86.4924, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(95.7871, device='cuda:2')
compute similarity is  tensor(0.9500, device='cuda:2')
compute distance is  tensor(96.8443, device='cuda:2')
compute similarity is  tensor(0.9486, device='cuda:2')
compute distance is  tensor(99.0734, device='cuda:2')
compute similarity is  tensor(0.9460, device='cuda:2')
compute distance is  tensor(91.9063, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(86.4801, device='cuda:2')
compute similarity is  tensor(0.9591, device='cuda:2')
compute distance is  tensor(97.0296, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(91.6558, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(79.5652, device='cuda:2')
compute similarity is  tensor(0.9650, device='cuda:2')
compute distance is  tensor(93.3521, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(96.0514, device='cuda:2')
compute similarity is  tensor(0.9508, device='cuda:2')
compute distance is  tensor(89.6528, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
calculated distance threshold is  tensor(99.0734, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.580216666823006
inner product is  tensor(5.1571, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.6258166668230022
inner product is  tensor(5.6292, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7933833334896591
inner product is  tensor(5.7722, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.40358333348967446
inner product is  tensor(5.7015, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.12395000015633192
inner product is  tensor(5.6461, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.2049166668230033
inner product is  tensor(5.4193, device='cuda:2')
====================
________________________________
test distance is  tensor(734.1546, device='cuda:2')
test similarity is  tensor(0.4445, device='cuda:2')
test acc is  0.12395000015633192
test loss is 18.853167746366978
test entropy is  0.020141741027512566
________________________________
cal_distance is  tensor(269.6951, device='cuda:2')
cal_distance is  tensor(99.0741, device='cuda:2')
cal_distance is  tensor(36.3958, device='cuda:2')
________________________________
test distance is  tensor(36.3958, device='cuda:2')
test similarity is  tensor(0.9950, device='cuda:2')
test acc is  0.8743000001563224
test loss is 0.40560776482163463
test entropy is  0.23984853038465037
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.23984853038465037
avg test loss is  0.40560776482163463
avg accuracy is  0.8743000001563224
compute_distance is  tensor(36.3958, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.06006602434191241
avg test loss is  7.500204714630713
avg accuracy is  0.1237166668229986
compute_distance is  tensor(9.1898, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(9.1898, device='cuda:2')
test similarity is  tensor(0.9995, device='cuda:2')
test acc is  0.1237166668229986
test loss is 7.500204714630713
test entropy is  0.06006602434191241
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 87.78% 

Test Accuracy: 86.55% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.7743, device='cuda:2')
diff2 is tensor(-0.7743, device='cuda:2')
diff1 is tensor(0.1591, device='cuda:2')
diff2 is tensor(0.1591, device='cuda:2')
diff1 is tensor(-20.3043, device='cuda:2')
diff2 is tensor(-20.3043, device='cuda:2')
diff1 is tensor(-0.1897, device='cuda:2')
diff2 is tensor(-0.1897, device='cuda:2')
diff1 is tensor(0.0037, device='cuda:2')
diff2 is tensor(0.0037, device='cuda:2')
diff1 is tensor(1.5739e-06, device='cuda:2')
diff2 is tensor(1.5739e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(91.6915, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
compute distance is  tensor(88.5609, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(94.5831, device='cuda:2')
compute similarity is  tensor(0.9513, device='cuda:2')
compute distance is  tensor(96.1640, device='cuda:2')
compute similarity is  tensor(0.9498, device='cuda:2')
compute distance is  tensor(94.4380, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(91.6618, device='cuda:2')
compute similarity is  tensor(0.9556, device='cuda:2')
compute distance is  tensor(87.8733, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(92.8172, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(80.4581, device='cuda:2')
compute similarity is  tensor(0.9650, device='cuda:2')
compute distance is  tensor(99.5424, device='cuda:2')
compute similarity is  tensor(0.9497, device='cuda:2')
compute distance is  tensor(91.0288, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(83.3790, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
calculated distance threshold is  tensor(99.5424, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.583350000156339
inner product is  tensor(4.4517, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.8295500001563242
inner product is  tensor(4.2875, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7823666668229929
inner product is  tensor(4.5987, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3215833334896733
inner product is  tensor(4.2640, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.2575666668230051
inner product is  tensor(4.2132, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.23115000015633763
inner product is  tensor(4.2334, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.5339833334896756
inner product is  tensor(4.7130, device='cuda:2')
====================
________________________________
test distance is  tensor(738.2557, device='cuda:2')
test similarity is  tensor(0.4421, device='cuda:2')
test acc is  0.23115000015633763
test loss is 8.745650357529044
test entropy is  0.09660288535042612
________________________________
cal_distance is  tensor(271.0867, device='cuda:2')
cal_distance is  tensor(99.5430, device='cuda:2')
cal_distance is  tensor(36.5525, device='cuda:2')
________________________________
test distance is  tensor(36.5525, device='cuda:2')
test similarity is  tensor(0.9950, device='cuda:2')
test acc is  0.8848166668229885
test loss is 0.37401409091344523
test entropy is  0.21383804584871222
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21383804584871222
avg test loss is  0.37401409091344523
avg accuracy is  0.8848166668229885
compute_distance is  tensor(36.5525, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.20404105976636985
avg test loss is  3.920296560472517
avg accuracy is  0.22858333348967086
compute_distance is  tensor(12.1580, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.1580, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.22858333348967086
test loss is 3.920296560472517
test entropy is  0.20404105976636985
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 87.93% 

Test Accuracy: 86.82% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.6204, device='cuda:2')
diff2 is tensor(0.6204, device='cuda:2')
diff1 is tensor(0.1181, device='cuda:2')
diff2 is tensor(0.1181, device='cuda:2')
diff1 is tensor(-1.0872, device='cuda:2')
diff2 is tensor(-1.0872, device='cuda:2')
diff1 is tensor(-0.0904, device='cuda:2')
diff2 is tensor(-0.0904, device='cuda:2')
diff1 is tensor(-0.0090, device='cuda:2')
diff2 is tensor(-0.0090, device='cuda:2')
diff1 is tensor(1.9502e-06, device='cuda:2')
diff2 is tensor(1.9502e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(87.1515, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(98.7314, device='cuda:2')
compute similarity is  tensor(0.9499, device='cuda:2')
compute distance is  tensor(91.2738, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(99.0105, device='cuda:2')
compute similarity is  tensor(0.9501, device='cuda:2')
compute distance is  tensor(92.3242, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(88.7037, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(87.0944, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(90.0111, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(83.0923, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
compute distance is  tensor(92.2865, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(88.6888, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(87.2851, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
calculated distance threshold is  tensor(99.0105, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8260833334896576
inner product is  tensor(6.5519, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7656000001563271
inner product is  tensor(6.4533, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.6818500001563317
inner product is  tensor(6.7284, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3342333334896735
inner product is  tensor(6.3726, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5051833334896754
inner product is  tensor(7.0633, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.10011666682299865
inner product is  tensor(6.6118, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.2054166668230033
inner product is  tensor(6.6885, device='cuda:2')
====================
________________________________
test distance is  tensor(734.9424, device='cuda:2')
test similarity is  tensor(0.4450, device='cuda:2')
test acc is  0.10011666682299865
test loss is 26.67765201536069
test entropy is  0.0004836138904007205
________________________________
cal_distance is  tensor(269.7542, device='cuda:2')
cal_distance is  tensor(99.0112, device='cuda:2')
cal_distance is  tensor(36.3417, device='cuda:2')
________________________________
test distance is  tensor(36.3417, device='cuda:2')
test similarity is  tensor(0.9951, device='cuda:2')
test acc is  0.8748666668229891
test loss is 0.40530164560465926
test entropy is  0.23169230428268153
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.23169230428268153
avg test loss is  0.40530164560465926
avg accuracy is  0.8748666668229891
compute_distance is  tensor(36.3417, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0180455276713784
avg test loss is  8.304173385664852
avg accuracy is  0.10106666682299865
compute_distance is  tensor(8.9985, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(8.9985, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.10106666682299865
test loss is 8.304173385664852
test entropy is  0.0180455276713784
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 88.44% 

Test Accuracy: 87.47% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(0.8475, device='cuda:2')
diff2 is tensor(0.8475, device='cuda:2')
diff1 is tensor(-0.2998, device='cuda:2')
diff2 is tensor(-0.2998, device='cuda:2')
diff1 is tensor(3.4075, device='cuda:2')
diff2 is tensor(3.4075, device='cuda:2')
diff1 is tensor(0.0767, device='cuda:2')
diff2 is tensor(0.0767, device='cuda:2')
diff1 is tensor(-0.0021, device='cuda:2')
diff2 is tensor(-0.0021, device='cuda:2')
diff1 is tensor(7.9162e-08, device='cuda:2')
diff2 is tensor(7.9162e-08, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(78.8980, device='cuda:2')
compute similarity is  tensor(0.9651, device='cuda:2')
compute distance is  tensor(87.1724, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(91.7031, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(101.4545, device='cuda:2')
compute similarity is  tensor(0.9456, device='cuda:2')
compute distance is  tensor(94.4659, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(88.8227, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(84.1904, device='cuda:2')
compute similarity is  tensor(0.9626, device='cuda:2')
compute distance is  tensor(86.6232, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(91.0793, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(94.4832, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(87.0070, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(88.2593, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
calculated distance threshold is  tensor(101.4545, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.5769166668230061
inner product is  tensor(6.2692, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7579833334896606
inner product is  tensor(6.1426, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8397000001563237
inner product is  tensor(5.7994, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.32675000015634004
inner product is  tensor(5.6598, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.5066666668230088
inner product is  tensor(6.0209, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.25091666682300495
inner product is  tensor(5.6954, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.18951666682300258
inner product is  tensor(5.9864, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(736.7935, device='cuda:2')
test similarity is  tensor(0.4487, device='cuda:2')
test acc is  0.18951666682300258
test loss is 10.67869371391817
test entropy is  0.0701554247013319
________________________________
cal_distance is  tensor(273.4069, device='cuda:2')
cal_distance is  tensor(101.4552, device='cuda:2')
cal_distance is  tensor(37.6481, device='cuda:2')
________________________________
test distance is  tensor(37.6481, device='cuda:2')
test similarity is  tensor(0.9948, device='cuda:2')
test acc is  0.890283333489655
test loss is 0.3587934359757186
test entropy is  0.1964228753643885
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.1964228753643885
avg test loss is  0.3587934359757186
avg accuracy is  0.890283333489655
compute_distance is  tensor(37.6481, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.1531784722704623
avg test loss is  4.760971359860923
avg accuracy is  0.16818333348966794
compute_distance is  tensor(11.1579, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.1579, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.16818333348966794
test loss is 4.760971359860923
test entropy is  0.1531784722704623
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.10% 

Test Accuracy: 87.06% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.6506, device='cuda:2')
diff2 is tensor(-0.6506, device='cuda:2')
diff1 is tensor(0.0152, device='cuda:2')
diff2 is tensor(0.0152, device='cuda:2')
diff1 is tensor(1.7859, device='cuda:2')
diff2 is tensor(1.7859, device='cuda:2')
diff1 is tensor(-0.0606, device='cuda:2')
diff2 is tensor(-0.0606, device='cuda:2')
diff1 is tensor(0.0240, device='cuda:2')
diff2 is tensor(0.0240, device='cuda:2')
diff1 is tensor(1.2200e-06, device='cuda:2')
diff2 is tensor(1.2200e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(88.7837, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(96.3379, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(89.3559, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(94.6382, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(96.4730, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(91.9870, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
compute distance is  tensor(96.5104, device='cuda:2')
compute similarity is  tensor(0.9529, device='cuda:2')
compute distance is  tensor(90.6244, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(86.9316, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(97.9755, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(86.0552, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(87.9079, device='cuda:2')
compute similarity is  tensor(0.9597, device='cuda:2')
calculated distance threshold is  tensor(97.9755, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7550000001563276
inner product is  tensor(5.7417, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8243500001563244
inner product is  tensor(5.8334, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7925500001563258
inner product is  tensor(6.4040, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.47845000015634187
inner product is  tensor(5.4959, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.47215000015634184
inner product is  tensor(5.2486, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.12291666682299861
inner product is  tensor(5.5078, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.17470000015633505
inner product is  tensor(5.6834, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.4071500001563412
inner product is  tensor(6.2468, device='cuda:2')
====================
________________________________
test distance is  tensor(730.3291, device='cuda:2')
test similarity is  tensor(0.4515, device='cuda:2')
test acc is  0.12291666682299861
test loss is 16.311475709048924
test entropy is  0.0357049613681459
________________________________
cal_distance is  tensor(267.4970, device='cuda:2')
cal_distance is  tensor(97.9762, device='cuda:2')
cal_distance is  tensor(35.8861, device='cuda:2')
________________________________
test distance is  tensor(35.8861, device='cuda:2')
test similarity is  tensor(0.9953, device='cuda:2')
test acc is  0.8856666668229886
test loss is 0.3719218698169377
test entropy is  0.21151463344280144
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21151463344280144
avg test loss is  0.3719218698169377
avg accuracy is  0.8856666668229886
compute_distance is  tensor(35.8861, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.06957989113171027
avg test loss is  6.800441665181728
avg accuracy is  0.11398333348966529
compute_distance is  tensor(10.6381, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(10.6381, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.11398333348966529
test loss is 6.800441665181728
test entropy is  0.06957989113171027
________________________________
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.38% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.8674, device='cuda:2')
diff2 is tensor(-0.8674, device='cuda:2')
diff1 is tensor(-0.0338, device='cuda:2')
diff2 is tensor(-0.0338, device='cuda:2')
diff1 is tensor(5.3667, device='cuda:2')
diff2 is tensor(5.3667, device='cuda:2')
diff1 is tensor(0.1760, device='cuda:2')
diff2 is tensor(0.1760, device='cuda:2')
diff1 is tensor(-0.0149, device='cuda:2')
diff2 is tensor(-0.0149, device='cuda:2')
diff1 is tensor(3.1292e-07, device='cuda:2')
diff2 is tensor(3.1292e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(89.0359, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(91.0767, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(92.7795, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(97.4271, device='cuda:2')
compute similarity is  tensor(0.9486, device='cuda:2')
compute distance is  tensor(102.5979, device='cuda:2')
compute similarity is  tensor(0.9491, device='cuda:2')
compute distance is  tensor(89.0391, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(88.0902, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(90.3478, device='cuda:2')
compute similarity is  tensor(0.9578, device='cuda:2')
compute distance is  tensor(82.5913, device='cuda:2')
compute similarity is  tensor(0.9645, device='cuda:2')
compute distance is  tensor(99.7290, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
compute distance is  tensor(94.6840, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(91.7269, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
calculated distance threshold is  tensor(102.5979, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.795033333489659
inner product is  tensor(4.8935, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.6404500001563345
inner product is  tensor(4.8309, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.6499166668230005
inner product is  tensor(5.7121, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.28633333348967255
inner product is  tensor(4.5111, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.18753333348966916
inner product is  tensor(4.6666, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.1764833334896684
inner product is  tensor(5.0720, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(734.2399, device='cuda:2')
test similarity is  tensor(0.4488, device='cuda:2')
test acc is  0.1764833334896684
test loss is 13.40185648851049
test entropy is  0.04478841473602616
________________________________
cal_distance is  tensor(274.4664, device='cuda:2')
cal_distance is  tensor(102.5986, device='cuda:2')
cal_distance is  tensor(38.3528, device='cuda:2')
________________________________
test distance is  tensor(38.3528, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8889333334896551
test loss is 0.36618085252816107
test entropy is  0.2013970050793975
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2013970050793975
avg test loss is  0.36618085252816107
avg accuracy is  0.8889333334896551
compute_distance is  tensor(38.3528, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.11353041217334743
avg test loss is  5.535804148167689
avg accuracy is  0.1645833334896677
compute_distance is  tensor(11.3676, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.3676, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.1645833334896677
test loss is 5.535804148167689
test entropy is  0.11353041217334743
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 87.95% 

Test Accuracy: 86.82% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-1.4680, device='cuda:2')
diff2 is tensor(-1.4680, device='cuda:2')
diff1 is tensor(-0.2583, device='cuda:2')
diff2 is tensor(-0.2583, device='cuda:2')
diff1 is tensor(-2.5447, device='cuda:2')
diff2 is tensor(-2.5447, device='cuda:2')
diff1 is tensor(-0.1540, device='cuda:2')
diff2 is tensor(-0.1540, device='cuda:2')
diff1 is tensor(0.0003, device='cuda:2')
diff2 is tensor(0.0003, device='cuda:2')
diff1 is tensor(1.3225e-06, device='cuda:2')
diff2 is tensor(1.3225e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(84.2666, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(92.5361, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(92.9096, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(101.9597, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(97.5282, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(97.1847, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(88.1714, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(88.9934, device='cuda:2')
compute similarity is  tensor(0.9596, device='cuda:2')
compute distance is  tensor(79.7663, device='cuda:2')
compute similarity is  tensor(0.9659, device='cuda:2')
compute distance is  tensor(88.7407, device='cuda:2')
compute similarity is  tensor(0.9616, device='cuda:2')
compute distance is  tensor(87.8392, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(83.9549, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
calculated distance threshold is  tensor(101.9597, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8307333334896574
inner product is  tensor(5.2428, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8224333334896577
inner product is  tensor(4.9208, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.7654500001563271
inner product is  tensor(5.1816, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.17681666682300176
inner product is  tensor(5.1286, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.32655000015634
inner product is  tensor(5.4824, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.22605000015633744
inner product is  tensor(4.9642, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.233483333489671
inner product is  tensor(4.9398, device='cuda:2')
====================
====================
iteration is  2
round is  1
accuracy is  0.23520000015633777
inner product is  tensor(5.5158, device='cuda:2')
====================
________________________________
test distance is  tensor(736.4675, device='cuda:2')
test similarity is  tensor(0.4448, device='cuda:2')
test acc is  0.17681666682300176
test loss is 11.678666374068271
test entropy is  0.06547634163772119
________________________________
cal_distance is  tensor(274.0261, device='cuda:2')
cal_distance is  tensor(101.9604, device='cuda:2')
cal_distance is  tensor(37.9380, device='cuda:2')
________________________________
test distance is  tensor(37.9380, device='cuda:2')
test similarity is  tensor(0.9948, device='cuda:2')
test acc is  0.883700000156322
test loss is 0.38367098262473975
test entropy is  0.2121899524159523
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2121899524159523
avg test loss is  0.38367098262473975
avg accuracy is  0.883700000156322
compute_distance is  tensor(37.9380, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12941149544360034
avg test loss is  5.298181510683316
avg accuracy is  0.15305000015633344
compute_distance is  tensor(10.8684, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(10.8684, device='cuda:2')
test similarity is  tensor(0.9994, device='cuda:2')
test acc is  0.15305000015633344
test loss is 5.298181510683316
test entropy is  0.12941149544360034
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 88.27% 

Test Accuracy: 87.19% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(2.5306, device='cuda:2')
diff2 is tensor(2.5306, device='cuda:2')
diff1 is tensor(0.3090, device='cuda:2')
diff2 is tensor(0.3090, device='cuda:2')
diff1 is tensor(-2.7246, device='cuda:2')
diff2 is tensor(-2.7246, device='cuda:2')
diff1 is tensor(0.1240, device='cuda:2')
diff2 is tensor(0.1240, device='cuda:2')
diff1 is tensor(0.0063, device='cuda:2')
diff2 is tensor(0.0063, device='cuda:2')
diff1 is tensor(6.3237e-07, device='cuda:2')
diff2 is tensor(6.3237e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(84.2456, device='cuda:2')
compute similarity is  tensor(0.9626, device='cuda:2')
compute distance is  tensor(95.1684, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(90.6158, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(95.6269, device='cuda:2')
compute similarity is  tensor(0.9523, device='cuda:2')
compute distance is  tensor(95.7042, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(93.6699, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(90.5000, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(86.3484, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
compute distance is  tensor(81.8896, device='cuda:2')
compute similarity is  tensor(0.9661, device='cuda:2')
compute distance is  tensor(88.2706, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(88.4886, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(93.3162, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
calculated distance threshold is  tensor(95.7042, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7897833334896592
inner product is  tensor(6.7507, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.7126666668229965
inner product is  tensor(6.1936, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5777666668230061
inner product is  tensor(5.9049, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.4109666668230079
inner product is  tensor(5.8330, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.541766666823009
inner product is  tensor(5.6886, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.294916666823006
inner product is  tensor(7.1227, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.3207666668230066
inner product is  tensor(6.5978, device='cuda:2')
====================
________________________________
test distance is  tensor(738.1532, device='cuda:2')
test similarity is  tensor(0.4541, device='cuda:2')
test acc is  0.294916666823006
test loss is 6.8997695995037995
test entropy is  0.1639207173019711
________________________________
cal_distance is  tensor(265.7906, device='cuda:2')
cal_distance is  tensor(95.7049, device='cuda:2')
cal_distance is  tensor(34.4614, device='cuda:2')
________________________________
test distance is  tensor(34.4614, device='cuda:2')
test similarity is  tensor(0.9957, device='cuda:2')
test acc is  0.8888166668229884
test loss is 0.3662715623024176
test entropy is  0.19640562377536475
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19640562377536475
avg test loss is  0.3662715623024176
avg accuracy is  0.8888166668229884
compute_distance is  tensor(34.4614, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.33144718117868976
avg test loss is  3.258933325312031
avg accuracy is  0.2715333334896722
compute_distance is  tensor(14.6802, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(14.6802, device='cuda:2')
test similarity is  tensor(0.9989, device='cuda:2')
test acc is  0.2715333334896722
test loss is 3.258933325312031
test entropy is  0.33144718117868976
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.32% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.2007, device='cuda:2')
diff2 is tensor(-0.2007, device='cuda:2')
diff1 is tensor(-0.0206, device='cuda:2')
diff2 is tensor(-0.0206, device='cuda:2')
diff1 is tensor(-4.1369, device='cuda:2')
diff2 is tensor(-4.1369, device='cuda:2')
diff1 is tensor(-0.0604, device='cuda:2')
diff2 is tensor(-0.0604, device='cuda:2')
diff1 is tensor(-0.0010, device='cuda:2')
diff2 is tensor(-0.0010, device='cuda:2')
diff1 is tensor(4.6240e-07, device='cuda:2')
diff2 is tensor(4.6240e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(92.4237, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
compute distance is  tensor(90.9891, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(98.9874, device='cuda:2')
compute similarity is  tensor(0.9513, device='cuda:2')
compute distance is  tensor(100.4009, device='cuda:2')
compute similarity is  tensor(0.9493, device='cuda:2')
compute distance is  tensor(93.7840, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(87.9580, device='cuda:2')
compute similarity is  tensor(0.9621, device='cuda:2')
compute distance is  tensor(95.2324, device='cuda:2')
compute similarity is  tensor(0.9539, device='cuda:2')
compute distance is  tensor(81.1186, device='cuda:2')
compute similarity is  tensor(0.9659, device='cuda:2')
compute distance is  tensor(87.8778, device='cuda:2')
compute similarity is  tensor(0.9608, device='cuda:2')
compute distance is  tensor(94.9093, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(86.2247, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(89.7722, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
calculated distance threshold is  tensor(100.4009, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7640833334896604
inner product is  tensor(4.8576, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.557316666823008
inner product is  tensor(5.2528, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.8341000001563239
inner product is  tensor(4.8879, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.21856666682300382
inner product is  tensor(5.1002, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.371783333489674
inner product is  tensor(5.0282, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.24843333348967153
inner product is  tensor(6.1583, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.4127166668230079
inner product is  tensor(4.8563, device='cuda:2')
====================
________________________________
test distance is  tensor(735.0081, device='cuda:2')
test similarity is  tensor(0.4484, device='cuda:2')
test acc is  0.21856666682300382
test loss is 11.35914982407332
test entropy is  0.09380775456553075
________________________________
cal_distance is  tensor(271.6538, device='cuda:2')
cal_distance is  tensor(100.4016, device='cuda:2')
cal_distance is  tensor(37.1082, device='cuda:2')
________________________________
test distance is  tensor(37.1082, device='cuda:2')
test similarity is  tensor(0.9950, device='cuda:2')
test acc is  0.8894000001563218
test loss is 0.3677520720141211
test entropy is  0.19264282118568796
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19264282118568796
avg test loss is  0.3677520720141211
avg accuracy is  0.8894000001563218
compute_distance is  tensor(37.1082, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.29298585724792503
avg test loss is  3.158692549286621
avg accuracy is  0.2718000001563388
compute_distance is  tensor(11.6778, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.6778, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.2718000001563388
test loss is 3.158692549286621
test entropy is  0.29298585724792503
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 88.33% 

Test Accuracy: 87.30% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.8065, device='cuda:2')
diff2 is tensor(-0.8065, device='cuda:2')
diff1 is tensor(-0.3574, device='cuda:2')
diff2 is tensor(-0.3574, device='cuda:2')
diff1 is tensor(6.8448, device='cuda:2')
diff2 is tensor(6.8448, device='cuda:2')
diff1 is tensor(-0.0625, device='cuda:2')
diff2 is tensor(-0.0625, device='cuda:2')
diff1 is tensor(0.0039, device='cuda:2')
diff2 is tensor(0.0039, device='cuda:2')
diff1 is tensor(1.2890e-06, device='cuda:2')
diff2 is tensor(1.2890e-06, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(87.0750, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(95.8587, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(96.1288, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(99.8508, device='cuda:2')
compute similarity is  tensor(0.9512, device='cuda:2')
compute distance is  tensor(96.5781, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(90.3825, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(90.5421, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(92.9592, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(83.6856, device='cuda:2')
compute similarity is  tensor(0.9645, device='cuda:2')
compute distance is  tensor(95.6533, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(92.2541, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(86.6944, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
calculated distance threshold is  tensor(99.8508, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7790000001563264
inner product is  tensor(5.2488, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.8239666668229911
inner product is  tensor(5.4754, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.8148500001563247
inner product is  tensor(4.7239, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.30233333348967295
inner product is  tensor(5.2452, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.16136666682300083
inner product is  tensor(4.8237, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.3956833334896744
inner product is  tensor(5.3810, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  2
round is  0
accuracy is  0.1536166668230002
inner product is  tensor(5.5955, device='cuda:2')
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.20413333348966983
inner product is  tensor(5.6169, device='cuda:2')
====================
________________________________
test distance is  tensor(739.7207, device='cuda:2')
test similarity is  tensor(0.4494, device='cuda:2')
test acc is  0.1536166668230002
test loss is 13.70262923677847
test entropy is  0.060738261014636134
________________________________
cal_distance is  tensor(271.7756, device='cuda:2')
cal_distance is  tensor(99.8515, device='cuda:2')
cal_distance is  tensor(36.6862, device='cuda:2')
________________________________
test distance is  tensor(36.6862, device='cuda:2')
test similarity is  tensor(0.9952, device='cuda:2')
test acc is  0.8890666668229884
test loss is 0.3660714667060101
test entropy is  0.19463702364326285
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19463702364326285
avg test loss is  0.3660714667060101
avg accuracy is  0.8890666668229884
compute_distance is  tensor(36.6862, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.12114477855389688
avg test loss is  5.544800348119186
avg accuracy is  0.13636666682299858
compute_distance is  tensor(10.9270, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(10.9270, device='cuda:2')
test similarity is  tensor(0.9993, device='cuda:2')
test acc is  0.13636666682299858
test loss is 5.544800348119186
test entropy is  0.12114477855389688
________________________________
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 87.67% 

Test Accuracy: 86.48% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.7038, device='cuda:2')
diff2 is tensor(-0.7038, device='cuda:2')
diff1 is tensor(0.0869, device='cuda:2')
diff2 is tensor(0.0869, device='cuda:2')
diff1 is tensor(-11.4180, device='cuda:2')
diff2 is tensor(-11.4180, device='cuda:2')
diff1 is tensor(-0.2052, device='cuda:2')
diff2 is tensor(-0.2052, device='cuda:2')
diff1 is tensor(-0.0091, device='cuda:2')
diff2 is tensor(-0.0091, device='cuda:2')
diff1 is tensor(9.6671e-07, device='cuda:2')
diff2 is tensor(9.6671e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(89.2427, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(95.9709, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(95.7375, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(98.1363, device='cuda:2')
compute similarity is  tensor(0.9521, device='cuda:2')
compute distance is  tensor(99.2356, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(91.9672, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(90.5069, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(93.1519, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(83.6365, device='cuda:2')
compute similarity is  tensor(0.9648, device='cuda:2')
compute distance is  tensor(97.8514, device='cuda:2')
compute similarity is  tensor(0.9546, device='cuda:2')
compute distance is  tensor(87.9561, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
compute distance is  tensor(91.8466, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
calculated distance threshold is  tensor(99.2356, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.6971500001563308
inner product is  tensor(7.3048, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7985500001563255
inner product is  tensor(7.3693, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.5343333334896756
inner product is  tensor(7.6241, device='cuda:2')
====================
succ_min + 1
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3354666668230068
inner product is  tensor(7.8698, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.21078333348967015
inner product is  tensor(8.1039, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  2
accuracy is  0.2701000001563388
inner product is  tensor(7.4316, device='cuda:2')
====================
________________________________
test distance is  tensor(733.5948, device='cuda:2')
test similarity is  tensor(0.4453, device='cuda:2')
test acc is  0.21078333348967015
test loss is 10.095894473447983
test entropy is  0.10359032351229745
________________________________
cal_distance is  tensor(269.8129, device='cuda:2')
cal_distance is  tensor(99.2363, device='cuda:2')
cal_distance is  tensor(36.4991, device='cuda:2')
________________________________
test distance is  tensor(36.4991, device='cuda:2')
test similarity is  tensor(0.9952, device='cuda:2')
test acc is  0.883600000156322
test loss is 0.3822889027676221
test entropy is  0.21025337336827188
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.21025337336827188
avg test loss is  0.3822889027676221
avg accuracy is  0.883600000156322
compute_distance is  tensor(36.4991, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17489926964997737
avg test loss is  5.155654102246136
avg accuracy is  0.18126666682300208
compute_distance is  tensor(11.9741, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(11.9741, device='cuda:2')
test similarity is  tensor(0.9992, device='cuda:2')
test acc is  0.18126666682300208
test loss is 5.155654102246136
test entropy is  0.17489926964997737
________________________________
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 88.38% 

Test Accuracy: 87.38% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(-0.2934, device='cuda:2')
diff2 is tensor(-0.2934, device='cuda:2')
diff1 is tensor(-0.1139, device='cuda:2')
diff2 is tensor(-0.1139, device='cuda:2')
diff1 is tensor(1.1471, device='cuda:2')
diff2 is tensor(1.1471, device='cuda:2')
diff1 is tensor(0.2166, device='cuda:2')
diff2 is tensor(0.2166, device='cuda:2')
diff1 is tensor(0.0027, device='cuda:2')
diff2 is tensor(0.0027, device='cuda:2')
diff1 is tensor(5.1595e-07, device='cuda:2')
diff2 is tensor(5.1595e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(86.4839, device='cuda:2')
compute similarity is  tensor(0.9622, device='cuda:2')
compute distance is  tensor(99.2588, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(101.3979, device='cuda:2')
compute similarity is  tensor(0.9504, device='cuda:2')
compute distance is  tensor(103.5253, device='cuda:2')
compute similarity is  tensor(0.9467, device='cuda:2')
compute distance is  tensor(95.5604, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(86.3546, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(89.1160, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(85.7854, device='cuda:2')
compute similarity is  tensor(0.9636, device='cuda:2')
compute distance is  tensor(85.2312, device='cuda:2')
compute similarity is  tensor(0.9638, device='cuda:2')
compute distance is  tensor(97.8341, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(92.5584, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(86.6256, device='cuda:2')
compute similarity is  tensor(0.9631, device='cuda:2')
calculated distance threshold is  tensor(103.5253, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.45130000015634164
inner product is  tensor(7.0259, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.7653000001563272
inner product is  tensor(6.7755, device='cuda:2')
====================
====================
iteration is  0
round is  2
accuracy is  0.6405333334896677
inner product is  tensor(6.8445, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.34005000015634024
inner product is  tensor(7.5944, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.41740000015634127
inner product is  tensor(6.9273, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.29563333348967274
inner product is  tensor(6.2181, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(733.5953, device='cuda:2')
test similarity is  tensor(0.4550, device='cuda:2')
test acc is  0.29563333348967274
test loss is 7.893918366828707
test entropy is  0.14044744136141563
________________________________
cal_distance is  tensor(275.5829, device='cuda:2')
cal_distance is  tensor(103.5260, device='cuda:2')
cal_distance is  tensor(38.8911, device='cuda:2')
________________________________
test distance is  tensor(38.8911, device='cuda:2')
test similarity is  tensor(0.9946, device='cuda:2')
test acc is  0.8926500001563217
test loss is 0.35280296166759056
test entropy is  0.18362377430679702
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.18362377430679702
avg test loss is  0.35280296166759056
avg accuracy is  0.8926500001563217
compute_distance is  tensor(38.8911, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3054610668564402
avg test loss is  3.3438666771724024
avg accuracy is  0.28078333348967244
compute_distance is  tensor(13.8729, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(13.8729, device='cuda:2')
test similarity is  tensor(0.9991, device='cuda:2')
test acc is  0.28078333348967244
test loss is 3.3438666771724024
test entropy is  0.3054610668564402
________________________________
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.09% 

Test Accuracy: 87.13% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
len of malicious models is 12
diff1 is tensor(1.0513, device='cuda:2')
diff2 is tensor(1.0513, device='cuda:2')
diff1 is tensor(-0.3172, device='cuda:2')
diff2 is tensor(-0.3172, device='cuda:2')
diff1 is tensor(-8.7562, device='cuda:2')
diff2 is tensor(-8.7562, device='cuda:2')
diff1 is tensor(-0.2075, device='cuda:2')
diff2 is tensor(-0.2075, device='cuda:2')
diff1 is tensor(0.0053, device='cuda:2')
diff2 is tensor(0.0053, device='cuda:2')
diff1 is tensor(7.5437e-07, device='cuda:2')
diff2 is tensor(7.5437e-07, device='cuda:2')
len of model dicts is  12
compute distance is  tensor(84.2194, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(94.2916, device='cuda:2')
compute similarity is  tensor(0.9574, device='cuda:2')
compute distance is  tensor(91.3594, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(95.8185, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(92.6010, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
compute distance is  tensor(86.6352, device='cuda:2')
compute similarity is  tensor(0.9636, device='cuda:2')
compute distance is  tensor(88.8690, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(84.7763, device='cuda:2')
compute similarity is  tensor(0.9647, device='cuda:2')
compute distance is  tensor(80.0001, device='cuda:2')
compute similarity is  tensor(0.9683, device='cuda:2')
compute distance is  tensor(94.1344, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(92.4907, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(86.7523, device='cuda:2')
compute similarity is  tensor(0.9636, device='cuda:2')
calculated distance threshold is  tensor(95.8185, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.7798000001563263
inner product is  tensor(5.7913, device='cuda:2')
====================
====================
iteration is  0
round is  1
accuracy is  0.44315000015634154
inner product is  tensor(5.5667, device='cuda:2')
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.6980833334896641
inner product is  tensor(5.6292, device='cuda:2')
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.3009833334896729
inner product is  tensor(4.1821, device='cuda:2')
====================
succ_min + 1
====================
iteration is  1
round is  1
accuracy is  0.4039666668230078
inner product is  tensor(5.1685, device='cuda:2')
====================
====================
iteration is  1
round is  2
accuracy is  0.23908333348967123
inner product is  tensor(5.6559, device='cuda:2')
====================
succ_min + 1
________________________________
test distance is  tensor(736.5194, device='cuda:2')
test similarity is  tensor(0.4545, device='cuda:2')
test acc is  0.23908333348967123
test loss is 12.628992749683892
test entropy is  0.07423492937461972
________________________________
cal_distance is  tensor(265.6548, device='cuda:2')
cal_distance is  tensor(95.8193, device='cuda:2')
cal_distance is  tensor(34.5615, device='cuda:2')
________________________________
test distance is  tensor(34.5615, device='cuda:2')
test similarity is  tensor(0.9958, device='cuda:2')
test acc is  0.8887000001563218
test loss is 0.36771738167796564
test entropy is  0.19182223504953294
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.19182223504953294
avg test loss is  0.36771738167796564
avg accuracy is  0.8887000001563218
compute_distance is  tensor(34.5615, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2066613922257032
avg test loss is  4.412261415646275
avg accuracy is  0.23910000015633784
compute_distance is  tensor(12.7721, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(12.7721, device='cuda:2')
test similarity is  tensor(0.9991, device='cuda:2')
test acc is  0.23910000015633784
test loss is 4.412261415646275
test entropy is  0.2066613922257032
________________________________
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 87.24% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 88.32%
|----0th round Training Accuracy : 82.69%
|----1th round Training Accuracy : 86.29%
|----2th round Training Accuracy : 87.21%
|----3th round Training Accuracy : 87.44%
|----4th round Training Accuracy : 87.28%
|----5th round Training Accuracy : 87.92%
|----6th round Training Accuracy : 87.58%
|----7th round Training Accuracy : 88.10%
|----8th round Training Accuracy : 88.54%
|----9th round Training Accuracy : 88.56%
|----10th round Training Accuracy : 88.60%
|----11th round Training Accuracy : 88.49%
|----12th round Training Accuracy : 83.23%
|----13th round Training Accuracy : 88.06%
|----14th round Training Accuracy : 87.64%
|----15th round Training Accuracy : 88.08%
|----16th round Training Accuracy : 80.96%
|----17th round Training Accuracy : 88.66%
|----18th round Training Accuracy : 80.54%
|----19th round Training Accuracy : 88.78%
|----20th round Training Accuracy : 88.54%
|----21th round Training Accuracy : 87.92%
|----22th round Training Accuracy : 85.69%
|----23th round Training Accuracy : 88.57%
|----24th round Training Accuracy : 88.05%
|----25th round Training Accuracy : 88.08%
|----26th round Training Accuracy : 87.65%
|----27th round Training Accuracy : 88.61%
|----28th round Training Accuracy : 87.21%
|----29th round Training Accuracy : 88.49%
|----30th round Training Accuracy : 87.24%
|----31th round Training Accuracy : 88.25%
|----32th round Training Accuracy : 87.61%
|----33th round Training Accuracy : 87.80%
|----34th round Training Accuracy : 87.83%
|----35th round Training Accuracy : 88.62%
|----36th round Training Accuracy : 87.30%
|----37th round Training Accuracy : 87.78%
|----38th round Training Accuracy : 87.93%
|----39th round Training Accuracy : 88.44%
|----40th round Training Accuracy : 88.10%
|----41th round Training Accuracy : 88.43%
|----42th round Training Accuracy : 87.95%
|----43th round Training Accuracy : 88.27%
|----44th round Training Accuracy : 88.34%
|----45th round Training Accuracy : 88.33%
|----46th round Training Accuracy : 87.67%
|----47th round Training Accuracy : 88.38%
|----48th round Training Accuracy : 88.09%
|----49th round Training Accuracy : 88.32%
|----Final Test Accuracy: 87.24%
|----0th round Final Test Accuracy : 82.03%
|----1th round Final Test Accuracy : 85.15%
|----2th round Final Test Accuracy : 85.97%
|----3th round Final Test Accuracy : 86.03%
|----4th round Final Test Accuracy : 85.99%
|----5th round Final Test Accuracy : 86.69%
|----6th round Final Test Accuracy : 86.49%
|----7th round Final Test Accuracy : 86.91%
|----8th round Final Test Accuracy : 87.30%
|----9th round Final Test Accuracy : 87.33%
|----10th round Final Test Accuracy : 87.27%
|----11th round Final Test Accuracy : 87.23%
|----12th round Final Test Accuracy : 82.23%
|----13th round Final Test Accuracy : 87.24%
|----14th round Final Test Accuracy : 86.50%
|----15th round Final Test Accuracy : 87.03%
|----16th round Final Test Accuracy : 79.96%
|----17th round Final Test Accuracy : 87.71%
|----18th round Final Test Accuracy : 79.24%
|----19th round Final Test Accuracy : 87.68%
|----20th round Final Test Accuracy : 87.39%
|----21th round Final Test Accuracy : 86.73%
|----22th round Final Test Accuracy : 84.30%
|----23th round Final Test Accuracy : 87.41%
|----24th round Final Test Accuracy : 86.75%
|----25th round Final Test Accuracy : 86.66%
|----26th round Final Test Accuracy : 86.29%
|----27th round Final Test Accuracy : 87.53%
|----28th round Final Test Accuracy : 86.14%
|----29th round Final Test Accuracy : 87.40%
|----30th round Final Test Accuracy : 85.90%
|----31th round Final Test Accuracy : 87.05%
|----32th round Final Test Accuracy : 86.64%
|----33th round Final Test Accuracy : 86.84%
|----34th round Final Test Accuracy : 86.83%
|----35th round Final Test Accuracy : 87.67%
|----36th round Final Test Accuracy : 86.29%
|----37th round Final Test Accuracy : 86.55%
|----38th round Final Test Accuracy : 86.82%
|----39th round Final Test Accuracy : 87.47%
|----40th round Final Test Accuracy : 87.06%
|----41th round Final Test Accuracy : 87.38%
|----42th round Final Test Accuracy : 86.82%
|----43th round Final Test Accuracy : 87.19%
|----44th round Final Test Accuracy : 87.32%
|----45th round Final Test Accuracy : 87.30%
|----46th round Final Test Accuracy : 86.48%
|----47th round Final Test Accuracy : 87.38%
|----48th round Final Test Accuracy : 87.13%
|----49th round Final Test Accuracy : 87.24%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 9556.4255
