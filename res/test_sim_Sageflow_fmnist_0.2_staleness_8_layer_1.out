
Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!
attack user num is  12
 t is  6
attack_user is [48 49 50 51 52 53 54 55 56 57 58 59]

 | Global Training Round : 1 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
poisoned accuracy threshold is  0.4
distance ratio is <class 'float'>
len of model dicts is  12
compute distance is  tensor(130.6547, device='cuda:2')
compute similarity is  tensor(0.6003, device='cuda:2')
compute distance is  tensor(125.1308, device='cuda:2')
compute similarity is  tensor(0.6082, device='cuda:2')
compute distance is  tensor(134.9191, device='cuda:2')
compute similarity is  tensor(0.6049, device='cuda:2')
compute distance is  tensor(120.5313, device='cuda:2')
compute similarity is  tensor(0.6164, device='cuda:2')
compute distance is  tensor(133.4075, device='cuda:2')
compute similarity is  tensor(0.6000, device='cuda:2')
compute distance is  tensor(121.8649, device='cuda:2')
compute similarity is  tensor(0.6229, device='cuda:2')
compute distance is  tensor(119.1314, device='cuda:2')
compute similarity is  tensor(0.6354, device='cuda:2')
compute distance is  tensor(136.0830, device='cuda:2')
compute similarity is  tensor(0.5984, device='cuda:2')
compute distance is  tensor(126.3464, device='cuda:2')
compute similarity is  tensor(0.6150, device='cuda:2')
compute distance is  tensor(124.3791, device='cuda:2')
compute similarity is  tensor(0.6169, device='cuda:2')
compute distance is  tensor(123.7853, device='cuda:2')
compute similarity is  tensor(0.6179, device='cuda:2')
compute distance is  tensor(132.6669, device='cuda:2')
compute similarity is  tensor(0.6024, device='cuda:2')
calculated distance threshold is  tensor(135.9135, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.12963333348966524
====================
succ_min + 1
====================
iteration is  0
round is  1
accuracy is  0.10318333348966531
====================
succ_min + 1
====================
iteration is  0
round is  2
accuracy is  0.14225000015633246
====================
mid_min is -0.2
====================
iteration is  1
round is  0
accuracy is  0.11466666682299861
====================
====================
iteration is  1
round is  1
accuracy is  0.13210000015633191
====================
________________________________
test distance is  tensor(40.1209, device='cuda:2')
test similarity is  tensor(0.8824, device='cuda:2')
test acc is  0.10318333348966531
test loss is 2.285555047267027
test entropy is  2.259825042824247
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  2.259825042824247
avg test loss is  2.285555047267027
avg accuracy is  0.10318333348966531
compute_distance is  tensor(40.1209, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.6270824458235617
avg test loss is  7.420015302039921
avg accuracy is  0.0874666668229987
compute_distance is  tensor(54.7217, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(54.7217, device='cuda:2')
test similarity is  tensor(0.8691, device='cuda:2')
test acc is  0.0874666668229987
test loss is 7.420015302039921
test entropy is  0.6270824458235617
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 1 global rounds:
Train Accuracy: 83.15% 

Test Accuracy: 81.69% 


 | Global Training Round : 2 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.4782686233520508
attack res is True
len of model dicts is  12
compute distance is  tensor(92.9609, device='cuda:2')
compute similarity is  tensor(0.8814, device='cuda:2')
compute distance is  tensor(91.4699, device='cuda:2')
compute similarity is  tensor(0.8853, device='cuda:2')
compute distance is  tensor(94.1001, device='cuda:2')
compute similarity is  tensor(0.8799, device='cuda:2')
compute distance is  tensor(88.2080, device='cuda:2')
compute similarity is  tensor(0.8829, device='cuda:2')
compute distance is  tensor(88.7668, device='cuda:2')
compute similarity is  tensor(0.8889, device='cuda:2')
compute distance is  tensor(94.3781, device='cuda:2')
compute similarity is  tensor(0.8768, device='cuda:2')
compute distance is  tensor(87.4386, device='cuda:2')
compute similarity is  tensor(0.8893, device='cuda:2')
compute distance is  tensor(92.9154, device='cuda:2')
compute similarity is  tensor(0.8763, device='cuda:2')
compute distance is  tensor(91.7738, device='cuda:2')
compute similarity is  tensor(0.8844, device='cuda:2')
compute distance is  tensor(87.6682, device='cuda:2')
compute similarity is  tensor(0.8886, device='cuda:2')
compute distance is  tensor(89.3835, device='cuda:2')
compute similarity is  tensor(0.8873, device='cuda:2')
compute distance is  tensor(94.6178, device='cuda:2')
compute similarity is  tensor(0.8821, device='cuda:2')
calculated distance threshold is  tensor(95.2568, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8127666668229915
====================
====================
iteration is  0
round is  1
accuracy is  0.8140833334896581
====================
====================
iteration is  0
round is  2
accuracy is  0.7906000001563259
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.6884500001563312
====================
====================
iteration is  1
round is  1
accuracy is  0.7022000001563303
====================
====================
iteration is  1
round is  2
accuracy is  0.47941666682300854
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.557316666823008
====================
====================
iteration is  2
round is  1
accuracy is  0.6397500001563345
====================
====================
iteration is  2
round is  2
accuracy is  0.49223333348967535
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.22658333348967086
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.24353333348967146
====================
====================
iteration is  3
round is  2
accuracy is  0.493850000156342
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.284966666823006
====================
====================
iteration is  4
round is  1
accuracy is  0.11571666682299861
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.21863333348967057
====================
________________________________
test distance is  tensor(664.3229, device='cuda:2')
test similarity is  tensor(0.1937, device='cuda:2')
test acc is  0.11571666682299861
test loss is 10.945281644874036
test entropy is  0.1787369858894521
________________________________
cal_distance is  tensor(251.5599, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(95.2598, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(36.0741, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(36.0741, device='cuda:2')
test similarity is  tensor(0.9536, device='cuda:2')
test acc is  0.8242000001563243
test loss is 0.5782731593544803
test entropy is  0.8888143879264149
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.8888143879264149
avg test loss is  0.5782731593544803
avg accuracy is  0.8242000001563243
compute_distance is  tensor(36.0741, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17680788718100424
avg test loss is  7.57472681745029
avg accuracy is  0.11370000015633196
compute_distance is  tensor(47.2640, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(47.2640, device='cuda:2')
test similarity is  tensor(0.9474, device='cuda:2')
test acc is  0.11370000015633196
test loss is 7.57472681745029
test entropy is  0.17680788718100424
________________________________
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 2 global rounds:
Train Accuracy: 85.69% 

Test Accuracy: 84.38% 


 | Global Training Round : 3 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.7504016757011414
attack res is True
len of model dicts is  12
compute distance is  tensor(85.3036, device='cuda:2')
compute similarity is  tensor(0.9112, device='cuda:2')
compute distance is  tensor(92.1897, device='cuda:2')
compute similarity is  tensor(0.9082, device='cuda:2')
compute distance is  tensor(86.1861, device='cuda:2')
compute similarity is  tensor(0.9096, device='cuda:2')
compute distance is  tensor(84.0153, device='cuda:2')
compute similarity is  tensor(0.9095, device='cuda:2')
compute distance is  tensor(83.3287, device='cuda:2')
compute similarity is  tensor(0.9156, device='cuda:2')
compute distance is  tensor(84.7788, device='cuda:2')
compute similarity is  tensor(0.9090, device='cuda:2')
compute distance is  tensor(81.4587, device='cuda:2')
compute similarity is  tensor(0.9158, device='cuda:2')
compute distance is  tensor(84.4086, device='cuda:2')
compute similarity is  tensor(0.9161, device='cuda:2')
compute distance is  tensor(87.2402, device='cuda:2')
compute similarity is  tensor(0.9109, device='cuda:2')
compute distance is  tensor(84.8322, device='cuda:2')
compute similarity is  tensor(0.9121, device='cuda:2')
compute distance is  tensor(81.3839, device='cuda:2')
compute similarity is  tensor(0.9152, device='cuda:2')
compute distance is  tensor(83.9086, device='cuda:2')
compute similarity is  tensor(0.9176, device='cuda:2')
calculated distance threshold is  tensor(94.3282, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8453666668229901
====================
====================
iteration is  0
round is  1
accuracy is  0.8419833334896569
====================
====================
iteration is  0
round is  2
accuracy is  0.8332000001563241
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7742833334896599
====================
====================
iteration is  1
round is  1
accuracy is  0.7548666668229943
====================
====================
iteration is  1
round is  2
accuracy is  0.7630500001563271
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.343716666823007
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.10301666682299865
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.5762666668230063
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.18055000015633532
====================
====================
iteration is  3
round is  1
accuracy is  0.21571666682300375
====================
====================
iteration is  3
round is  2
accuracy is  0.46645000015634175
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.444133333489675
====================
====================
iteration is  4
round is  1
accuracy is  0.03308333348966596
====================
succ_min + 1
________________________________
test distance is  tensor(677.8188, device='cuda:2')
test similarity is  tensor(0.1840, device='cuda:2')
test acc is  0.03308333348966596
test loss is 7.851588403746518
test entropy is  0.7865111115517647
________________________________
cal_distance is  tensor(252.8608, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(94.3313, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(35.1923, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(35.1923, device='cuda:2')
test similarity is  tensor(0.9667, device='cuda:2')
test acc is  0.8482500001563233
test loss is 0.4645685683181291
test entropy is  0.631187168297483
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.631187168297483
avg test loss is  0.4645685683181291
avg accuracy is  0.8482500001563233
compute_distance is  tensor(35.1923, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5204816712245249
avg test loss is  7.8084847576328436
avg accuracy is  0.026566666822999498
compute_distance is  tensor(55.3675, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(55.3675, device='cuda:2')
test similarity is  tensor(0.9529, device='cuda:2')
test acc is  0.026566666822999498
test loss is 7.8084847576328436
test entropy is  0.5204816712245249
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 3 global rounds:
Train Accuracy: 86.92% 

Test Accuracy: 85.64% 


 | Global Training Round : 4 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  0.9064449071884155
attack res is True
len of model dicts is  12
compute distance is  tensor(83.4361, device='cuda:2')
compute similarity is  tensor(0.9226, device='cuda:2')
compute distance is  tensor(87.2406, device='cuda:2')
compute similarity is  tensor(0.9193, device='cuda:2')
compute distance is  tensor(86.4717, device='cuda:2')
compute similarity is  tensor(0.9207, device='cuda:2')
compute distance is  tensor(86.3174, device='cuda:2')
compute similarity is  tensor(0.9169, device='cuda:2')
compute distance is  tensor(86.5991, device='cuda:2')
compute similarity is  tensor(0.9217, device='cuda:2')
compute distance is  tensor(83.1072, device='cuda:2')
compute similarity is  tensor(0.9209, device='cuda:2')
compute distance is  tensor(84.3686, device='cuda:2')
compute similarity is  tensor(0.9239, device='cuda:2')
compute distance is  tensor(81.4417, device='cuda:2')
compute similarity is  tensor(0.9268, device='cuda:2')
compute distance is  tensor(80.5688, device='cuda:2')
compute similarity is  tensor(0.9284, device='cuda:2')
compute distance is  tensor(83.8499, device='cuda:2')
compute similarity is  tensor(0.9248, device='cuda:2')
compute distance is  tensor(84.8612, device='cuda:2')
compute similarity is  tensor(0.9228, device='cuda:2')
compute distance is  tensor(81.8707, device='cuda:2')
compute similarity is  tensor(0.9258, device='cuda:2')
calculated distance threshold is  tensor(89.3602, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8577833334896563
====================
====================
iteration is  0
round is  1
accuracy is  0.8593166668229896
====================
====================
iteration is  0
round is  2
accuracy is  0.8581333334896563
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7033333334896638
====================
====================
iteration is  1
round is  1
accuracy is  0.7756333334896599
====================
====================
iteration is  1
round is  2
accuracy is  0.690850000156331
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.43013333348967475
====================
====================
iteration is  2
round is  1
accuracy is  0.630566666823002
====================
====================
iteration is  2
round is  2
accuracy is  0.5779666668230061
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.22983333348967103
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.34566666682300706
====================
====================
iteration is  3
round is  2
accuracy is  0.17555000015633507
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.561150000156341
====================
====================
iteration is  4
round is  1
accuracy is  0.1727500001563349
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.10008333348966532
====================
succ_min + 1
________________________________
test distance is  tensor(319.5083, device='cuda:2')
test similarity is  tensor(0.4119, device='cuda:2')
test acc is  0.10008333348966532
test loss is 21.271387851568683
test entropy is  0.13450592598006098
________________________________
cal_distance is  tensor(168.9731, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(89.3628, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(47.2610, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(47.2610, device='cuda:2')
test similarity is  tensor(0.9497, device='cuda:2')
test acc is  0.8517166668229899
test loss is 0.45132260575795224
test entropy is  0.5379183906227795
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.5379183906227795
avg test loss is  0.45132260575795224
avg accuracy is  0.8517166668229899
compute_distance is  tensor(47.2610, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.0845620774828803
avg test loss is  16.821674768858628
avg accuracy is  0.10423333348966532
compute_distance is  tensor(56.3919, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(56.3919, device='cuda:2')
test similarity is  tensor(0.9480, device='cuda:2')
test acc is  0.10423333348966532
test loss is 16.821674768858628
test entropy is  0.0845620774828803
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
 
Avg Training Stats after 4 global rounds:
Train Accuracy: 87.50% 

Test Accuracy: 85.94% 


 | Global Training Round : 5 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.0309326648712158
attack res is True
len of model dicts is  12
compute distance is  tensor(79.9084, device='cuda:2')
compute similarity is  tensor(0.9327, device='cuda:2')
compute distance is  tensor(86.8149, device='cuda:2')
compute similarity is  tensor(0.9292, device='cuda:2')
compute distance is  tensor(87.3742, device='cuda:2')
compute similarity is  tensor(0.9253, device='cuda:2')
compute distance is  tensor(86.9689, device='cuda:2')
compute similarity is  tensor(0.9231, device='cuda:2')
compute distance is  tensor(87.5346, device='cuda:2')
compute similarity is  tensor(0.9288, device='cuda:2')
compute distance is  tensor(82.3316, device='cuda:2')
compute similarity is  tensor(0.9269, device='cuda:2')
compute distance is  tensor(79.6860, device='cuda:2')
compute similarity is  tensor(0.9355, device='cuda:2')
compute distance is  tensor(85.0824, device='cuda:2')
compute similarity is  tensor(0.9291, device='cuda:2')
compute distance is  tensor(82.6724, device='cuda:2')
compute similarity is  tensor(0.9324, device='cuda:2')
compute distance is  tensor(85.8326, device='cuda:2')
compute similarity is  tensor(0.9292, device='cuda:2')
compute distance is  tensor(86.5700, device='cuda:2')
compute similarity is  tensor(0.9274, device='cuda:2')
compute distance is  tensor(81.8260, device='cuda:2')
compute similarity is  tensor(0.9338, device='cuda:2')
calculated distance threshold is  tensor(91.0622, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8575666668229897
====================
====================
iteration is  0
round is  1
accuracy is  0.866333333489656
====================
====================
iteration is  0
round is  2
accuracy is  0.8613666668229896
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7614333334896606
====================
====================
iteration is  1
round is  1
accuracy is  0.8322666668229908
====================
====================
iteration is  1
round is  2
accuracy is  0.8165333334896581
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6289666668230021
====================
====================
iteration is  2
round is  1
accuracy is  0.5063500001563421
====================
====================
iteration is  2
round is  2
accuracy is  0.5913166668230049
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.6274833334896688
====================
====================
iteration is  3
round is  1
accuracy is  0.173750000156335
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.33563333348967356
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.30515000015633964
====================
====================
iteration is  4
round is  1
accuracy is  0.3483000001563404
====================
====================
iteration is  4
round is  2
accuracy is  0.452233333489675
====================
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.16235000015633413
====================
succ_min + 1
________________________________
test distance is  tensor(1305.3197, device='cuda:2')
test similarity is  tensor(0.1497, device='cuda:2')
test acc is  0.16235000015633413
test loss is 15.008142147999582
test entropy is  0.20017156928682378
________________________________
cal_distance is  tensor(344.7712, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(91.0656, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(24.0554, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(24.0554, device='cuda:2')
test similarity is  tensor(0.9879, device='cuda:2')
test acc is  0.8671333334896559
test loss is 0.3831073994766166
test entropy is  0.362008854667388
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.362008854667388
avg test loss is  0.3831073994766166
avg accuracy is  0.8671333334896559
compute_distance is  tensor(24.0554, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5297242404301283
avg test loss is  6.20250910685769
avg accuracy is  0.18055000015633535
compute_distance is  tensor(46.2621, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(46.2621, device='cuda:2')
test similarity is  tensor(0.9763, device='cuda:2')
test acc is  0.18055000015633535
test loss is 6.20250910685769
test entropy is  0.5297242404301283
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 5 global rounds:
Train Accuracy: 87.75% 

Test Accuracy: 86.26% 


 | Global Training Round : 6 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.111818552017212
attack res is True
len of model dicts is  12
compute distance is  tensor(84.8729, device='cuda:2')
compute similarity is  tensor(0.9313, device='cuda:2')
compute distance is  tensor(93.2950, device='cuda:2')
compute similarity is  tensor(0.9244, device='cuda:2')
compute distance is  tensor(90.6805, device='cuda:2')
compute similarity is  tensor(0.9257, device='cuda:2')
compute distance is  tensor(89.3891, device='cuda:2')
compute similarity is  tensor(0.9240, device='cuda:2')
compute distance is  tensor(88.2802, device='cuda:2')
compute similarity is  tensor(0.9308, device='cuda:2')
compute distance is  tensor(83.6021, device='cuda:2')
compute similarity is  tensor(0.9318, device='cuda:2')
compute distance is  tensor(87.3327, device='cuda:2')
compute similarity is  tensor(0.9311, device='cuda:2')
compute distance is  tensor(83.1387, device='cuda:2')
compute similarity is  tensor(0.9351, device='cuda:2')
compute distance is  tensor(80.0324, device='cuda:2')
compute similarity is  tensor(0.9407, device='cuda:2')
compute distance is  tensor(88.7158, device='cuda:2')
compute similarity is  tensor(0.9306, device='cuda:2')
compute distance is  tensor(88.3715, device='cuda:2')
compute similarity is  tensor(0.9291, device='cuda:2')
compute distance is  tensor(87.1743, device='cuda:2')
compute similarity is  tensor(0.9324, device='cuda:2')
calculated distance threshold is  tensor(101.1784, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.858200000156323
====================
====================
iteration is  0
round is  1
accuracy is  0.8642666668229894
====================
====================
iteration is  0
round is  2
accuracy is  0.8621500001563228
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.777766666822993
====================
====================
iteration is  1
round is  1
accuracy is  0.47936666682300855
====================
====================
iteration is  1
round is  2
accuracy is  0.8152666668229913
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7194333334896628
====================
====================
iteration is  2
round is  1
accuracy is  0.6652000001563328
====================
====================
iteration is  2
round is  2
accuracy is  0.5569833334896747
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3015833334896729
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.19628333348966956
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.28500000015633925
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.40433333348967443
====================
====================
iteration is  4
round is  1
accuracy is  0.3847166668230076
====================
====================
iteration is  4
round is  2
accuracy is  0.5821833334896724
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.2173166668230038
====================
________________________________
test distance is  tensor(328.3812, device='cuda:2')
test similarity is  tensor(0.4455, device='cuda:2')
test acc is  0.19628333348966956
test loss is 3.1307722546144334
test entropy is  1.2162027670376336
________________________________
cal_distance is  tensor(182.2791, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(101.1809, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(56.1650, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(56.1650, device='cuda:2')
test similarity is  tensor(0.9425, device='cuda:2')
test acc is  0.8538333334896564
test loss is 0.42535607175214457
test entropy is  0.5166704939372504
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.5166704939372504
avg test loss is  0.42535607175214457
avg accuracy is  0.8538333334896564
compute_distance is  tensor(56.1650, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.669994590919155
avg test loss is  4.1156637378847165
avg accuracy is  0.19495000015633618
compute_distance is  tensor(76.3197, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(76.3197, device='cuda:2')
test similarity is  tensor(0.9341, device='cuda:2')
test acc is  0.19495000015633618
test loss is 4.1156637378847165
test entropy is  0.669994590919155
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 6 global rounds:
Train Accuracy: 87.95% 

Test Accuracy: 86.59% 


 | Global Training Round : 7 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.1697759628295898
attack res is True
len of model dicts is  12
compute distance is  tensor(84.0323, device='cuda:2')
compute similarity is  tensor(0.9356, device='cuda:2')
compute distance is  tensor(91.0906, device='cuda:2')
compute similarity is  tensor(0.9306, device='cuda:2')
compute distance is  tensor(88.9374, device='cuda:2')
compute similarity is  tensor(0.9304, device='cuda:2')
compute distance is  tensor(87.2739, device='cuda:2')
compute similarity is  tensor(0.9290, device='cuda:2')
compute distance is  tensor(88.8021, device='cuda:2')
compute similarity is  tensor(0.9338, device='cuda:2')
compute distance is  tensor(86.0882, device='cuda:2')
compute similarity is  tensor(0.9319, device='cuda:2')
compute distance is  tensor(89.9437, device='cuda:2')
compute similarity is  tensor(0.9309, device='cuda:2')
compute distance is  tensor(86.5871, device='cuda:2')
compute similarity is  tensor(0.9349, device='cuda:2')
compute distance is  tensor(80.2017, device='cuda:2')
compute similarity is  tensor(0.9421, device='cuda:2')
compute distance is  tensor(89.2781, device='cuda:2')
compute similarity is  tensor(0.9329, device='cuda:2')
compute distance is  tensor(86.4706, device='cuda:2')
compute similarity is  tensor(0.9354, device='cuda:2')
compute distance is  tensor(87.4543, device='cuda:2')
compute similarity is  tensor(0.9339, device='cuda:2')
calculated distance threshold is  tensor(99.2991, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8754333334896556
====================
====================
iteration is  0
round is  1
accuracy is  0.8599166668229895
====================
====================
iteration is  0
round is  2
accuracy is  0.8692166668229891
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8112000001563249
====================
====================
iteration is  1
round is  1
accuracy is  0.8392666668229903
====================
====================
iteration is  1
round is  2
accuracy is  0.7780333334896599
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5470833334896756
====================
====================
iteration is  2
round is  1
accuracy is  0.4301000001563415
====================
====================
iteration is  2
round is  2
accuracy is  0.3808166668230075
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.14901666682299974
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.35461666682300724
====================
====================
iteration is  3
round is  2
accuracy is  0.5629333334896741
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.05005000015633227
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.3642500001563407
====================
________________________________
test distance is  tensor(656.0417, device='cuda:2')
test similarity is  tensor(0.2457, device='cuda:2')
test acc is  0.05005000015633227
test loss is 46.708159033931906
test entropy is  0.10065011248024287
________________________________
cal_distance is  tensor(255.2362, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(99.3022, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(38.6358, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(38.6358, device='cuda:2')
test similarity is  tensor(0.9728, device='cuda:2')
test acc is  0.8536000001563231
test loss is 0.42158019039104744
test entropy is  0.40740359998715203
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.40740359998715203
avg test loss is  0.42158019039104744
avg accuracy is  0.8536000001563231
compute_distance is  tensor(38.6358, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.17834788151005945
avg test loss is  17.35623439898623
avg accuracy is  0.05220000015633225
compute_distance is  tensor(56.6490, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(56.6490, device='cuda:2')
test similarity is  tensor(0.9653, device='cuda:2')
test acc is  0.05220000015633225
test loss is 17.35623439898623
test entropy is  0.17834788151005945
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
 
Avg Training Stats after 7 global rounds:
Train Accuracy: 87.89% 

Test Accuracy: 86.54% 


 | Global Training Round : 8 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.2535603046417236
attack res is True
len of model dicts is  12
compute distance is  tensor(91.8021, device='cuda:2')
compute similarity is  tensor(0.9277, device='cuda:2')
compute distance is  tensor(95.1677, device='cuda:2')
compute similarity is  tensor(0.9306, device='cuda:2')
compute distance is  tensor(91.3824, device='cuda:2')
compute similarity is  tensor(0.9301, device='cuda:2')
compute distance is  tensor(90.8649, device='cuda:2')
compute similarity is  tensor(0.9294, device='cuda:2')
compute distance is  tensor(92.1363, device='cuda:2')
compute similarity is  tensor(0.9337, device='cuda:2')
compute distance is  tensor(91.3340, device='cuda:2')
compute similarity is  tensor(0.9292, device='cuda:2')
compute distance is  tensor(88.9582, device='cuda:2')
compute similarity is  tensor(0.9341, device='cuda:2')
compute distance is  tensor(83.5869, device='cuda:2')
compute similarity is  tensor(0.9417, device='cuda:2')
compute distance is  tensor(80.3776, device='cuda:2')
compute similarity is  tensor(0.9449, device='cuda:2')
compute distance is  tensor(90.8620, device='cuda:2')
compute similarity is  tensor(0.9350, device='cuda:2')
compute distance is  tensor(85.9910, device='cuda:2')
compute similarity is  tensor(0.9376, device='cuda:2')
compute distance is  tensor(83.8115, device='cuda:2')
compute similarity is  tensor(0.9403, device='cuda:2')
calculated distance threshold is  tensor(108.9111, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8714166668229891
====================
====================
iteration is  0
round is  1
accuracy is  0.8649333334896561
====================
====================
iteration is  0
round is  2
accuracy is  0.8715833334896558
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8364333334896572
====================
====================
iteration is  1
round is  1
accuracy is  0.8327333334896573
====================
====================
iteration is  1
round is  2
accuracy is  0.8355666668229905
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.1568833334896671
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.6009833334896707
====================
====================
iteration is  2
round is  2
accuracy is  0.6743500001563321
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.14918333348966642
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.23883333348967128
====================
====================
iteration is  3
round is  2
accuracy is  0.45013333348967505
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.2962666668230061
====================
====================
iteration is  4
round is  1
accuracy is  0.5063333334896755
====================
====================
iteration is  4
round is  2
accuracy is  0.3065000001563397
====================
________________________________
test distance is  tensor(324.6500, device='cuda:2')
test similarity is  tensor(0.4814, device='cuda:2')
test acc is  0.14918333348966642
test loss is 6.426738060867863
test entropy is  0.3701267694391167
________________________________
cal_distance is  tensor(188.0387, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(108.9135, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(63.0842, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(63.0842, device='cuda:2')
test similarity is  tensor(0.9376, device='cuda:2')
test acc is  0.8618833334896561
test loss is 0.39893130149477835
test entropy is  0.35197868770055935
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.35197868770055935
avg test loss is  0.39893130149477835
avg accuracy is  0.8618833334896561
compute_distance is  tensor(63.0842, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3217742494555679
avg test loss is  6.186790192813508
avg accuracy is  0.14713333348966623
compute_distance is  tensor(79.6801, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(79.6801, device='cuda:2')
test similarity is  tensor(0.9320, device='cuda:2')
test acc is  0.14713333348966623
test loss is 6.186790192813508
test entropy is  0.3217742494555679
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
 
Avg Training Stats after 8 global rounds:
Train Accuracy: 88.05% 

Test Accuracy: 87.07% 


 | Global Training Round : 9 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.307149052619934
attack res is True
len of model dicts is  12
compute distance is  tensor(86.7461, device='cuda:2')
compute similarity is  tensor(0.9383, device='cuda:2')
compute distance is  tensor(84.8492, device='cuda:2')
compute similarity is  tensor(0.9432, device='cuda:2')
compute distance is  tensor(91.0540, device='cuda:2')
compute similarity is  tensor(0.9345, device='cuda:2')
compute distance is  tensor(91.3447, device='cuda:2')
compute similarity is  tensor(0.9295, device='cuda:2')
compute distance is  tensor(90.2829, device='cuda:2')
compute similarity is  tensor(0.9368, device='cuda:2')
compute distance is  tensor(89.0242, device='cuda:2')
compute similarity is  tensor(0.9344, device='cuda:2')
compute distance is  tensor(86.1452, device='cuda:2')
compute similarity is  tensor(0.9429, device='cuda:2')
compute distance is  tensor(86.5378, device='cuda:2')
compute similarity is  tensor(0.9400, device='cuda:2')
compute distance is  tensor(85.8210, device='cuda:2')
compute similarity is  tensor(0.9412, device='cuda:2')
compute distance is  tensor(88.7684, device='cuda:2')
compute similarity is  tensor(0.9382, device='cuda:2')
compute distance is  tensor(88.2470, device='cuda:2')
compute similarity is  tensor(0.9379, device='cuda:2')
compute distance is  tensor(82.8009, device='cuda:2')
compute similarity is  tensor(0.9416, device='cuda:2')
calculated distance threshold is  tensor(100.9321, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.875516666822989
====================
====================
iteration is  0
round is  1
accuracy is  0.8708333334896559
====================
====================
iteration is  0
round is  2
accuracy is  0.8770500001563223
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8160500001563247
====================
====================
iteration is  1
round is  1
accuracy is  0.8341666668229906
====================
====================
iteration is  1
round is  2
accuracy is  0.8095000001563251
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7493500001563278
====================
====================
iteration is  2
round is  1
accuracy is  0.43790000015634145
====================
====================
iteration is  2
round is  2
accuracy is  0.24001666682300468
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5630500001563408
====================
====================
iteration is  3
round is  1
accuracy is  0.47255000015634185
====================
====================
iteration is  3
round is  2
accuracy is  0.3424333334896737
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.244600000156338
====================
====================
iteration is  4
round is  1
accuracy is  0.18246666682300214
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.21495000015633703
====================
________________________________
test distance is  tensor(654.1769, device='cuda:2')
test similarity is  tensor(0.2646, device='cuda:2')
test acc is  0.18246666682300214
test loss is 4.371467226858078
test entropy is  0.9683967450661446
________________________________
cal_distance is  tensor(256.9602, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(100.9351, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(39.6491, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(39.6491, device='cuda:2')
test similarity is  tensor(0.9746, device='cuda:2')
test acc is  0.8719333334896558
test loss is 0.36883518571602003
test entropy is  0.3463165324761161
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3463165324761161
avg test loss is  0.36883518571602003
avg accuracy is  0.8719333334896558
compute_distance is  tensor(39.6491, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.8058968012266831
avg test loss is  4.378413737709843
avg accuracy is  0.2185833334896704
compute_distance is  tensor(64.6842, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(64.6842, device='cuda:2')
test similarity is  tensor(0.9626, device='cuda:2')
test acc is  0.2185833334896704
test loss is 4.378413737709843
test entropy is  0.8058968012266831
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 9 global rounds:
Train Accuracy: 88.03% 

Test Accuracy: 87.15% 


 | Global Training Round : 10 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.4346791505813599
attack res is True
len of model dicts is  12
compute distance is  tensor(86.2090, device='cuda:2')
compute similarity is  tensor(0.9435, device='cuda:2')
compute distance is  tensor(95.3078, device='cuda:2')
compute similarity is  tensor(0.9340, device='cuda:2')
compute distance is  tensor(89.7222, device='cuda:2')
compute similarity is  tensor(0.9401, device='cuda:2')
compute distance is  tensor(95.7176, device='cuda:2')
compute similarity is  tensor(0.9320, device='cuda:2')
compute distance is  tensor(94.0354, device='cuda:2')
compute similarity is  tensor(0.9383, device='cuda:2')
compute distance is  tensor(88.3613, device='cuda:2')
compute similarity is  tensor(0.9411, device='cuda:2')
compute distance is  tensor(91.1532, device='cuda:2')
compute similarity is  tensor(0.9417, device='cuda:2')
compute distance is  tensor(89.2873, device='cuda:2')
compute similarity is  tensor(0.9428, device='cuda:2')
compute distance is  tensor(84.5875, device='cuda:2')
compute similarity is  tensor(0.9454, device='cuda:2')
compute distance is  tensor(90.6393, device='cuda:2')
compute similarity is  tensor(0.9442, device='cuda:2')
compute distance is  tensor(88.3793, device='cuda:2')
compute similarity is  tensor(0.9428, device='cuda:2')
compute distance is  tensor(83.2574, device='cuda:2')
compute similarity is  tensor(0.9482, device='cuda:2')
calculated distance threshold is  tensor(112.3440, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8749000001563224
====================
====================
iteration is  0
round is  1
accuracy is  0.8759000001563223
====================
====================
iteration is  0
round is  2
accuracy is  0.8586000001563229
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.45876666682300843
====================
====================
iteration is  1
round is  1
accuracy is  0.8394833334896571
====================
====================
iteration is  1
round is  2
accuracy is  0.8317333334896574
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5419166668230091
====================
====================
iteration is  2
round is  1
accuracy is  0.44561666682300827
====================
====================
iteration is  2
round is  2
accuracy is  0.7888000001563259
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.38760000015634094
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2692500001563388
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.020366666822999802
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.4146166668230079
====================
====================
iteration is  4
round is  1
accuracy is  0.4004833334896745
====================
====================
iteration is  4
round is  2
accuracy is  0.5909666668230049
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.43665000015634153
====================
====================
iteration is  5
round is  1
accuracy is  0.14628333348966616
====================
====================
iteration is  5
round is  2
accuracy is  0.12103333348966527
====================
________________________________
test distance is  tensor(318.2039, device='cuda:2')
test similarity is  tensor(0.5051, device='cuda:2')
test acc is  0.020366666822999802
test loss is 7.746727718727421
test entropy is  0.6741736307899072
________________________________
cal_distance is  tensor(189.0737, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(112.3463, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(66.7561, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(66.7561, device='cuda:2')
test similarity is  tensor(0.9390, device='cuda:2')
test acc is  0.732283333489662
test loss is 0.8108912123672998
test entropy is  1.067155209240883
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.067155209240883
avg test loss is  0.8108912123672998
avg accuracy is  0.732283333489662
compute_distance is  tensor(66.7561, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.3974939963615525
avg test loss is  9.476062224109544
avg accuracy is  0.0168666668230001
compute_distance is  tensor(84.5336, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(84.5336, device='cuda:2')
test similarity is  tensor(0.9330, device='cuda:2')
test acc is  0.0168666668230001
test loss is 9.476062224109544
test entropy is  0.3974939963615525
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 10 global rounds:
Train Accuracy: 88.23% 

Test Accuracy: 87.25% 


 | Global Training Round : 11 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.5252084732055664
attack res is True
len of model dicts is  12
compute distance is  tensor(86.2596, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(93.9191, device='cuda:2')
compute similarity is  tensor(0.9413, device='cuda:2')
compute distance is  tensor(94.2862, device='cuda:2')
compute similarity is  tensor(0.9399, device='cuda:2')
compute distance is  tensor(95.8358, device='cuda:2')
compute similarity is  tensor(0.9351, device='cuda:2')
compute distance is  tensor(93.5759, device='cuda:2')
compute similarity is  tensor(0.9432, device='cuda:2')
compute distance is  tensor(88.7400, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(92.8709, device='cuda:2')
compute similarity is  tensor(0.9430, device='cuda:2')
compute distance is  tensor(93.4368, device='cuda:2')
compute similarity is  tensor(0.9410, device='cuda:2')
compute distance is  tensor(91.2438, device='cuda:2')
compute similarity is  tensor(0.9435, device='cuda:2')
compute distance is  tensor(94.1807, device='cuda:2')
compute similarity is  tensor(0.9424, device='cuda:2')
compute distance is  tensor(97.1684, device='cuda:2')
compute similarity is  tensor(0.9367, device='cuda:2')
compute distance is  tensor(89.2544, device='cuda:2')
compute similarity is  tensor(0.9429, device='cuda:2')
calculated distance threshold is  tensor(114.2712, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8731500001563224
====================
====================
iteration is  0
round is  1
accuracy is  0.872666666822989
====================
====================
iteration is  0
round is  2
accuracy is  0.8709000001563225
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7819500001563262
====================
====================
iteration is  1
round is  1
accuracy is  0.7848000001563261
====================
====================
iteration is  1
round is  2
accuracy is  0.8420333334896569
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6036166668230041
====================
====================
iteration is  2
round is  1
accuracy is  0.4880333334896753
====================
====================
iteration is  2
round is  2
accuracy is  0.693550000156331
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.16413333348966755
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.21646666682300378
====================
====================
iteration is  3
round is  2
accuracy is  0.42500000015634143
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.10466666682299865
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.20701666682300335
====================
====================
iteration is  4
round is  2
accuracy is  0.2054166668230033
====================
________________________________
test distance is  tensor(662.5538, device='cuda:2')
test similarity is  tensor(0.2624, device='cuda:2')
test acc is  0.10466666682299865
test loss is 24.50710921297704
test entropy is  0.12966352654720292
________________________________
cal_distance is  tensor(275.1582, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(114.2743, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(47.4598, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(47.4598, device='cuda:2')
test similarity is  tensor(0.9697, device='cuda:2')
test acc is  0.8647333334896561
test loss is 0.4100022663249136
test entropy is  0.2604571341483324
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.2604571341483324
avg test loss is  0.4100022663249136
avg accuracy is  0.8647333334896561
compute_distance is  tensor(47.4598, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.2154660845981605
avg test loss is  12.080549662047103
avg accuracy is  0.10940000015633197
compute_distance is  tensor(67.6883, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(67.6883, device='cuda:2')
test similarity is  tensor(0.9636, device='cuda:2')
test acc is  0.10940000015633197
test loss is 12.080549662047103
test entropy is  0.2154660845981605
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 11 global rounds:
Train Accuracy: 88.26% 

Test Accuracy: 87.17% 


 | Global Training Round : 12 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.6606415510177612
attack res is True
len of model dicts is  12
compute distance is  tensor(92.0324, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
compute distance is  tensor(97.0838, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(99.1536, device='cuda:2')
compute similarity is  tensor(0.9400, device='cuda:2')
compute distance is  tensor(99.7163, device='cuda:2')
compute similarity is  tensor(0.9363, device='cuda:2')
compute distance is  tensor(100.7224, device='cuda:2')
compute similarity is  tensor(0.9391, device='cuda:2')
compute distance is  tensor(96.7557, device='cuda:2')
compute similarity is  tensor(0.9437, device='cuda:2')
compute distance is  tensor(103.2402, device='cuda:2')
compute similarity is  tensor(0.9374, device='cuda:2')
compute distance is  tensor(93.5564, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(85.4705, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(103.3626, device='cuda:2')
compute similarity is  tensor(0.9390, device='cuda:2')
compute distance is  tensor(95.5902, device='cuda:2')
compute similarity is  tensor(0.9438, device='cuda:2')
compute distance is  tensor(92.3055, device='cuda:2')
compute similarity is  tensor(0.9465, device='cuda:2')
calculated distance threshold is  tensor(136.0083, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8787166668229888
====================
====================
iteration is  0
round is  1
accuracy is  0.8733000001563224
====================
====================
iteration is  0
round is  2
accuracy is  0.8676500001563227
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8314500001563241
====================
====================
iteration is  1
round is  1
accuracy is  0.8134333334896582
====================
====================
iteration is  1
round is  2
accuracy is  0.8243333334896578
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.46406666682300846
====================
====================
iteration is  2
round is  1
accuracy is  0.7006000001563306
====================
====================
iteration is  2
round is  2
accuracy is  0.7131333334896631
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.16313333348966752
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.339716666823007
====================
====================
iteration is  3
round is  2
accuracy is  0.5694833334896735
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.30040000015633966
====================
====================
iteration is  4
round is  1
accuracy is  0.32506666682300667
====================
====================
iteration is  4
round is  2
accuracy is  0.12400000015633193
====================
succ_min + 1
________________________________
test distance is  tensor(660.9116, device='cuda:2')
test similarity is  tensor(0.2637, device='cuda:2')
test acc is  0.12400000015633193
test loss is 6.256032814095015
test entropy is  0.8639416750560183
________________________________
cal_distance is  tensor(299.8177, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(136.0112, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(61.7020, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(61.7020, device='cuda:2')
test similarity is  tensor(0.9547, device='cuda:2')
test acc is  0.8188333334896579
test loss is 0.584643766760572
test entropy is  0.7494245911203722
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.7494245911203722
avg test loss is  0.584643766760572
avg accuracy is  0.8188333334896579
compute_distance is  tensor(61.7020, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.8005355092635287
avg test loss is  6.305271574683281
avg accuracy is  0.144583333489666
compute_distance is  tensor(83.7276, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(83.7276, device='cuda:2')
test similarity is  tensor(0.9478, device='cuda:2')
test acc is  0.144583333489666
test loss is 6.305271574683281
test entropy is  0.8005355092635287
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 12 global rounds:
Train Accuracy: 88.56% 

Test Accuracy: 87.46% 


 | Global Training Round : 13 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.6598875522613525
attack res is True
len of model dicts is  12
compute distance is  tensor(83.7489, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(99.0239, device='cuda:2')
compute similarity is  tensor(0.9417, device='cuda:2')
compute distance is  tensor(92.6845, device='cuda:2')
compute similarity is  tensor(0.9473, device='cuda:2')
compute distance is  tensor(92.4932, device='cuda:2')
compute similarity is  tensor(0.9447, device='cuda:2')
compute distance is  tensor(95.3179, device='cuda:2')
compute similarity is  tensor(0.9446, device='cuda:2')
compute distance is  tensor(90.2798, device='cuda:2')
compute similarity is  tensor(0.9478, device='cuda:2')
compute distance is  tensor(88.7182, device='cuda:2')
compute similarity is  tensor(0.9519, device='cuda:2')
compute distance is  tensor(88.9035, device='cuda:2')
compute similarity is  tensor(0.9506, device='cuda:2')
compute distance is  tensor(85.3514, device='cuda:2')
compute similarity is  tensor(0.9540, device='cuda:2')
compute distance is  tensor(92.7332, device='cuda:2')
compute similarity is  tensor(0.9495, device='cuda:2')
compute distance is  tensor(93.7384, device='cuda:2')
compute similarity is  tensor(0.9456, device='cuda:2')
compute distance is  tensor(84.9781, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
calculated distance threshold is  tensor(131.2089, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8795000001563221
====================
====================
iteration is  0
round is  1
accuracy is  0.8757500001563224
====================
====================
iteration is  0
round is  2
accuracy is  0.8705666668229891
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8711500001563225
====================
====================
iteration is  1
round is  1
accuracy is  0.8467333334896568
====================
====================
iteration is  1
round is  2
accuracy is  0.8508166668229901
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5074833334896754
====================
====================
iteration is  2
round is  1
accuracy is  0.6918333334896644
====================
====================
iteration is  2
round is  2
accuracy is  0.7013666668229971
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.027433333489666117
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2747666668230056
====================
====================
iteration is  3
round is  2
accuracy is  0.2502833334896717
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.18693333348966906
====================
====================
iteration is  4
round is  1
accuracy is  0.05853333348966553
====================
________________________________
test distance is  tensor(314.3094, device='cuda:2')
test similarity is  tensor(0.5252, device='cuda:2')
test acc is  0.027433333489666117
test loss is 15.799826876186867
test entropy is  0.31103878808237595
________________________________
cal_distance is  tensor(203.0781, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(131.2110, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(84.7773, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(84.7773, device='cuda:2')
test similarity is  tensor(0.9181, device='cuda:2')
test acc is  0.8317000001563241
test loss is 0.5196065336052798
test entropy is  0.539377131600624
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.539377131600624
avg test loss is  0.5196065336052798
avg accuracy is  0.8317000001563241
compute_distance is  tensor(84.7773, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.23271334272171898
avg test loss is  16.939835857480826
avg accuracy is  0.029750000156332706
compute_distance is  tensor(96.3415, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(96.3415, device='cuda:2')
test similarity is  tensor(0.9161, device='cuda:2')
test acc is  0.029750000156332706
test loss is 16.939835857480826
test entropy is  0.23271334272171898
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 13 global rounds:
Train Accuracy: 88.16% 

Test Accuracy: 87.12% 


 | Global Training Round : 14 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.782067060470581
attack res is True
len of model dicts is  12
compute distance is  tensor(88.7773, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(104.9195, device='cuda:2')
compute similarity is  tensor(0.9388, device='cuda:2')
compute distance is  tensor(97.9842, device='cuda:2')
compute similarity is  tensor(0.9460, device='cuda:2')
compute distance is  tensor(103.8555, device='cuda:2')
compute similarity is  tensor(0.9391, device='cuda:2')
compute distance is  tensor(101.6394, device='cuda:2')
compute similarity is  tensor(0.9448, device='cuda:2')
compute distance is  tensor(99.9177, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(103.4746, device='cuda:2')
compute similarity is  tensor(0.9401, device='cuda:2')
compute distance is  tensor(95.0080, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(89.1700, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(101.7838, device='cuda:2')
compute similarity is  tensor(0.9468, device='cuda:2')
compute distance is  tensor(104.8551, device='cuda:2')
compute similarity is  tensor(0.9399, device='cuda:2')
compute distance is  tensor(94.6571, device='cuda:2')
compute similarity is  tensor(0.9481, device='cuda:2')
calculated distance threshold is  tensor(143.9474, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8767666668229889
====================
====================
iteration is  0
round is  1
accuracy is  0.8748166668229891
====================
====================
iteration is  0
round is  2
accuracy is  0.8772833334896556
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8013000001563254
====================
====================
iteration is  1
round is  1
accuracy is  0.8546500001563231
====================
====================
iteration is  1
round is  2
accuracy is  0.827016666822991
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.722716666822996
====================
====================
iteration is  2
round is  1
accuracy is  0.39886666682300775
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.4404666668230083
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.45828333348967504
====================
====================
iteration is  3
round is  1
accuracy is  0.6593000001563332
====================
====================
iteration is  3
round is  2
accuracy is  0.6073666668230037
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.030733333489665993
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.48643333348967527
====================
====================
iteration is  4
round is  2
accuracy is  0.4139333334896747
====================
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.33550000015634024
====================
====================
iteration is  5
round is  1
accuracy is  0.17616666682300172
====================
====================
iteration is  5
round is  2
accuracy is  0.47076666682300844
====================
mid_min is -12.8
====================
iteration is  6
round is  0
accuracy is  0.08455000015633204
====================
________________________________
test distance is  tensor(675.8669, device='cuda:2')
test similarity is  tensor(0.3227, device='cuda:2')
test acc is  0.030733333489665993
test loss is 10.660122142417599
test entropy is  0.5597858034344371
________________________________
cal_distance is  tensor(311.9142, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(143.9502, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(66.4349, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(66.4349, device='cuda:2')
test similarity is  tensor(0.9541, device='cuda:2')
test acc is  0.8538333334896564
test loss is 0.4396087984794747
test entropy is  0.3759397216188882
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3759397216188882
avg test loss is  0.4396087984794747
avg accuracy is  0.8538333334896564
compute_distance is  tensor(66.4349, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.7475071374033051
avg test loss is  7.4154048581113186
avg accuracy is  0.024416666822999568
compute_distance is  tensor(89.3196, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(89.3196, device='cuda:2')
test similarity is  tensor(0.9465, device='cuda:2')
test acc is  0.024416666822999568
test loss is 7.4154048581113186
test entropy is  0.7475071374033051
________________________________
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 14 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.60% 


 | Global Training Round : 15 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.8192275762557983
attack res is True
len of model dicts is  12
compute distance is  tensor(91.7699, device='cuda:2')
compute similarity is  tensor(0.9529, device='cuda:2')
compute distance is  tensor(104.0556, device='cuda:2')
compute similarity is  tensor(0.9427, device='cuda:2')
compute distance is  tensor(96.9672, device='cuda:2')
compute similarity is  tensor(0.9475, device='cuda:2')
compute distance is  tensor(99.8262, device='cuda:2')
compute similarity is  tensor(0.9410, device='cuda:2')
compute distance is  tensor(104.5943, device='cuda:2')
compute similarity is  tensor(0.9432, device='cuda:2')
compute distance is  tensor(91.7562, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(93.7086, device='cuda:2')
compute similarity is  tensor(0.9525, device='cuda:2')
compute distance is  tensor(96.5696, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
compute distance is  tensor(87.6535, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(98.0448, device='cuda:2')
compute similarity is  tensor(0.9509, device='cuda:2')
compute distance is  tensor(96.7201, device='cuda:2')
compute similarity is  tensor(0.9490, device='cuda:2')
compute distance is  tensor(90.1767, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
calculated distance threshold is  tensor(151.3427, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8812333334896555
====================
====================
iteration is  0
round is  1
accuracy is  0.8851166668229885
====================
====================
iteration is  0
round is  2
accuracy is  0.8780500001563223
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8604166668229896
====================
====================
iteration is  1
round is  1
accuracy is  0.8256333334896575
====================
====================
iteration is  1
round is  2
accuracy is  0.826416666822991
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.48770000015634196
====================
====================
iteration is  2
round is  1
accuracy is  0.7200833334896629
====================
====================
iteration is  2
round is  2
accuracy is  0.6308333334896685
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5200166668230088
====================
====================
iteration is  3
round is  1
accuracy is  0.5023166668230088
====================
====================
iteration is  3
round is  2
accuracy is  0.6968000001563307
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.28941666682300593
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.2477333334896716
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.25610000015633855
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.2834000001563392
====================
====================
iteration is  5
round is  1
accuracy is  0.38513333348967427
====================
________________________________
test distance is  tensor(647.1406, device='cuda:2')
test similarity is  tensor(0.2853, device='cuda:2')
test acc is  0.2477333334896716
test loss is 7.3910771387218155
test entropy is  0.33989980996354047
________________________________
cal_distance is  tensor(312.9556, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(151.3455, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(73.1917, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(73.1917, device='cuda:2')
test similarity is  tensor(0.9427, device='cuda:2')
test acc is  0.8302833334896574
test loss is 0.48735584923898234
test entropy is  0.48571272054587855
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.48571272054587855
avg test loss is  0.48735584923898234
avg accuracy is  0.8302833334896574
compute_distance is  tensor(73.1917, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5769035904837061
avg test loss is  4.092057063889656
avg accuracy is  0.26478333348967203
compute_distance is  tensor(95.4009, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(95.4009, device='cuda:2')
test similarity is  tensor(0.9360, device='cuda:2')
test acc is  0.26478333348967203
test loss is 4.092057063889656
test entropy is  0.5769035904837061
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 15 global rounds:
Train Accuracy: 88.46% 

Test Accuracy: 87.21% 


 | Global Training Round : 16 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.856353759765625
attack res is True
len of model dicts is  12
compute distance is  tensor(92.1256, device='cuda:2')
compute similarity is  tensor(0.9536, device='cuda:2')
compute distance is  tensor(95.8196, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(95.2619, device='cuda:2')
compute similarity is  tensor(0.9518, device='cuda:2')
compute distance is  tensor(99.0807, device='cuda:2')
compute similarity is  tensor(0.9445, device='cuda:2')
compute distance is  tensor(104.0042, device='cuda:2')
compute similarity is  tensor(0.9461, device='cuda:2')
compute distance is  tensor(97.9591, device='cuda:2')
compute similarity is  tensor(0.9499, device='cuda:2')
compute distance is  tensor(99.5702, device='cuda:2')
compute similarity is  tensor(0.9493, device='cuda:2')
compute distance is  tensor(93.1057, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(90.1998, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(100.2627, device='cuda:2')
compute similarity is  tensor(0.9492, device='cuda:2')
compute distance is  tensor(98.9888, device='cuda:2')
compute similarity is  tensor(0.9477, device='cuda:2')
compute distance is  tensor(94.2762, device='cuda:2')
compute similarity is  tensor(0.9505, device='cuda:2')
calculated distance threshold is  tensor(147.2874, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8719333334896558
====================
====================
iteration is  0
round is  1
accuracy is  0.8699333334896558
====================
====================
iteration is  0
round is  2
accuracy is  0.8656500001563228
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8140166668229915
====================
====================
iteration is  1
round is  1
accuracy is  0.8565333334896563
====================
====================
iteration is  1
round is  2
accuracy is  0.7951000001563256
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5148000001563422
====================
====================
iteration is  2
round is  1
accuracy is  0.6496000001563338
====================
====================
iteration is  2
round is  2
accuracy is  0.6609833334896662
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.49173333348967535
====================
====================
iteration is  3
round is  1
accuracy is  0.48490000015634194
====================
====================
iteration is  3
round is  2
accuracy is  0.22826666682300423
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.17013333348966805
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.3230500001563399
====================
====================
iteration is  4
round is  2
accuracy is  0.1516333334896667
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.36153333348967387
====================
________________________________
test distance is  tensor(642.6246, device='cuda:2')
test similarity is  tensor(0.3148, device='cuda:2')
test acc is  0.1516333334896667
test loss is 31.030723939826494
test entropy is  0.2110241186072323
________________________________
cal_distance is  tensor(307.6552, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(147.2902, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(70.5163, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(70.5163, device='cuda:2')
test similarity is  tensor(0.9486, device='cuda:2')
test acc is  0.85061666682299
test loss is 0.48765685808048576
test entropy is  0.3027743433298333
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.3027743433298333
avg test loss is  0.48765685808048576
avg accuracy is  0.85061666682299
compute_distance is  tensor(70.5163, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.40534636989903094
avg test loss is  9.934064117830191
avg accuracy is  0.16016666682300068
compute_distance is  tensor(90.9861, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(90.9861, device='cuda:2')
test similarity is  tensor(0.9431, device='cuda:2')
test acc is  0.16016666682300068
test loss is 9.934064117830191
test entropy is  0.40534636989903094
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 16 global rounds:
Train Accuracy: 88.50% 

Test Accuracy: 87.61% 


 | Global Training Round : 17 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.8893650770187378
attack res is True
len of model dicts is  12
compute distance is  tensor(100.7497, device='cuda:2')
compute similarity is  tensor(0.9476, device='cuda:2')
compute distance is  tensor(98.5197, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(98.5114, device='cuda:2')
compute similarity is  tensor(0.9489, device='cuda:2')
compute distance is  tensor(102.4382, device='cuda:2')
compute similarity is  tensor(0.9447, device='cuda:2')
compute distance is  tensor(96.4931, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(95.0947, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
compute distance is  tensor(90.9914, device='cuda:2')
compute similarity is  tensor(0.9568, device='cuda:2')
compute distance is  tensor(90.2211, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(82.9861, device='cuda:2')
compute similarity is  tensor(0.9638, device='cuda:2')
compute distance is  tensor(101.1472, device='cuda:2')
compute similarity is  tensor(0.9503, device='cuda:2')
compute distance is  tensor(101.2191, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
compute distance is  tensor(90.8953, device='cuda:2')
compute similarity is  tensor(0.9560, device='cuda:2')
calculated distance threshold is  tensor(171.4738, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8798166668229888
====================
====================
iteration is  0
round is  1
accuracy is  0.8837166668229887
====================
====================
iteration is  0
round is  2
accuracy is  0.8744000001563224
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.84866666682299
====================
====================
iteration is  1
round is  1
accuracy is  0.8440000001563235
====================
====================
iteration is  1
round is  2
accuracy is  0.8509500001563233
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6483000001563339
====================
====================
iteration is  2
round is  1
accuracy is  0.395050000156341
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6838333334896649
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.44481666682300824
====================
====================
iteration is  3
round is  1
accuracy is  0.2261500001563375
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.388950000156341
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.3647500001563407
====================
====================
iteration is  4
round is  1
accuracy is  0.19973333348966968
====================
succ_min + 1
________________________________
test distance is  tensor(667.2231, device='cuda:2')
test similarity is  tensor(0.3198, device='cuda:2')
test acc is  0.19973333348966968
test loss is 5.599763304439943
test entropy is  0.5832186593874685
________________________________
cal_distance is  tensor(338.2492, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(171.4766, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(86.9315, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(86.9315, device='cuda:2')
test similarity is  tensor(0.9287, device='cuda:2')
test acc is  0.8065000001563251
test loss is 0.5815807426852713
test entropy is  0.7391499593568001
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.7391499593568001
avg test loss is  0.5815807426852713
avg accuracy is  0.8065000001563251
compute_distance is  tensor(86.9315, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.6675654574434386
avg test loss is  4.229281355068882
avg accuracy is  0.2231000001563374
compute_distance is  tensor(109.6605, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(109.6605, device='cuda:2')
test similarity is  tensor(0.9236, device='cuda:2')
test acc is  0.2231000001563374
test loss is 4.229281355068882
test entropy is  0.6675654574434386
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 17 global rounds:
Train Accuracy: 88.06% 

Test Accuracy: 87.11% 


 | Global Training Round : 18 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  1.9872740507125854
attack res is True
len of model dicts is  12
compute distance is  tensor(92.5457, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(104.3005, device='cuda:2')
compute similarity is  tensor(0.9487, device='cuda:2')
compute distance is  tensor(106.7968, device='cuda:2')
compute similarity is  tensor(0.9431, device='cuda:2')
compute distance is  tensor(103.5148, device='cuda:2')
compute similarity is  tensor(0.9454, device='cuda:2')
compute distance is  tensor(104.6267, device='cuda:2')
compute similarity is  tensor(0.9506, device='cuda:2')
compute distance is  tensor(95.1872, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(102.7111, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(92.9773, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(97.1320, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(104.8304, device='cuda:2')
compute similarity is  tensor(0.9492, device='cuda:2')
compute distance is  tensor(100.4965, device='cuda:2')
compute similarity is  tensor(0.9513, device='cuda:2')
compute distance is  tensor(107.0323, device='cuda:2')
compute similarity is  tensor(0.9448, device='cuda:2')
calculated distance threshold is  tensor(165.0355, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8717500001563225
====================
====================
iteration is  0
round is  1
accuracy is  0.8766333334896556
====================
====================
iteration is  0
round is  2
accuracy is  0.8817000001563221
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8170166668229913
====================
====================
iteration is  1
round is  1
accuracy is  0.8230500001563245
====================
====================
iteration is  1
round is  2
accuracy is  0.7582000001563274
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6122166668230034
====================
====================
iteration is  2
round is  1
accuracy is  0.5121833334896755
====================
====================
iteration is  2
round is  2
accuracy is  0.6502833334896672
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.4325500001563415
====================
====================
iteration is  3
round is  1
accuracy is  0.535066666823009
====================
====================
iteration is  3
round is  2
accuracy is  0.34536666682300704
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.13945000015633222
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.16188333348966752
====================
====================
iteration is  4
round is  2
accuracy is  0.39781666682300776
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.302783333489673
====================
________________________________
test distance is  tensor(640.9853, device='cuda:2')
test similarity is  tensor(0.3307, device='cuda:2')
test acc is  0.13945000015633222
test loss is 7.715140937487962
test entropy is  0.569849210221376
________________________________
cal_distance is  tensor(325.2483, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(165.0382, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(83.7449, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(83.7449, device='cuda:2')
test similarity is  tensor(0.9343, device='cuda:2')
test acc is  0.8037500001563253
test loss is 0.6025356736137415
test entropy is  0.5645005415751736
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.5645005415751736
avg test loss is  0.6025356736137415
avg accuracy is  0.8037500001563253
compute_distance is  tensor(83.7449, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.7685580505872331
avg test loss is  5.658218821482872
avg accuracy is  0.1401833334896656
compute_distance is  tensor(108.7966, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(108.7966, device='cuda:2')
test similarity is  tensor(0.9279, device='cuda:2')
test acc is  0.1401833334896656
test loss is 5.658218821482872
test entropy is  0.7685580505872331
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 18 global rounds:
Train Accuracy: 88.59% 

Test Accuracy: 87.87% 


 | Global Training Round : 19 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.015883684158325
attack res is True
len of model dicts is  12
compute distance is  tensor(91.7982, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(102.9016, device='cuda:2')
compute similarity is  tensor(0.9479, device='cuda:2')
compute distance is  tensor(97.6733, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(103.4763, device='cuda:2')
compute similarity is  tensor(0.9495, device='cuda:2')
compute distance is  tensor(108.2807, device='cuda:2')
compute similarity is  tensor(0.9460, device='cuda:2')
compute distance is  tensor(97.8258, device='cuda:2')
compute similarity is  tensor(0.9541, device='cuda:2')
compute distance is  tensor(104.4067, device='cuda:2')
compute similarity is  tensor(0.9496, device='cuda:2')
compute distance is  tensor(95.9819, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(94.5002, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(100.5705, device='cuda:2')
compute similarity is  tensor(0.9549, device='cuda:2')
compute distance is  tensor(104.7665, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(87.2038, device='cuda:2')
compute similarity is  tensor(0.9625, device='cuda:2')
calculated distance threshold is  tensor(203.2177, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8843333334896554
====================
====================
iteration is  0
round is  1
accuracy is  0.8793833334896555
====================
====================
iteration is  0
round is  2
accuracy is  0.8847666668229885
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8389500001563237
====================
====================
iteration is  1
round is  1
accuracy is  0.8167666668229914
====================
====================
iteration is  1
round is  2
accuracy is  0.8473500001563233
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.18108333348966874
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.7296166668229956
====================
====================
iteration is  2
round is  2
accuracy is  0.6574166668229998
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.2448500001563382
====================
====================
iteration is  3
round is  1
accuracy is  0.11715000015633194
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.22895000015633762
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.1978333334896697
====================
________________________________
test distance is  tensor(337.1945, device='cuda:2')
test similarity is  tensor(0.5554, device='cuda:2')
test acc is  0.11715000015633194
test loss is 9.380621724545575
test entropy is  0.5769271809599801
________________________________
cal_distance is  tensor(261.7715, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(203.2192, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(157.7639, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(157.7639, device='cuda:2')
test similarity is  tensor(0.8191, device='cuda:2')
test acc is  0.47903333348967525
test loss is 2.019132335557104
test entropy is  0.8784951481864904
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.8784951481864904
avg test loss is  2.019132335557104
avg accuracy is  0.47903333348967525
compute_distance is  tensor(157.7639, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.5263591880864426
avg test loss is  8.486631338021903
avg accuracy is  0.13556666682299856
compute_distance is  tensor(167.5959, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(167.5959, device='cuda:2')
test similarity is  tensor(0.8254, device='cuda:2')
test acc is  0.13556666682299856
test loss is 8.486631338021903
test entropy is  0.5263591880864426
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 19 global rounds:
Train Accuracy: 88.34% 

Test Accuracy: 87.19% 


 | Global Training Round : 20 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.122803211212158
attack res is True
len of model dicts is  12
compute distance is  tensor(100.7446, device='cuda:2')
compute similarity is  tensor(0.9527, device='cuda:2')
compute distance is  tensor(100.9335, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(107.6133, device='cuda:2')
compute similarity is  tensor(0.9483, device='cuda:2')
compute distance is  tensor(108.8179, device='cuda:2')
compute similarity is  tensor(0.9480, device='cuda:2')
compute distance is  tensor(111.2791, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(102.0974, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(103.5809, device='cuda:2')
compute similarity is  tensor(0.9532, device='cuda:2')
compute distance is  tensor(98.0745, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(98.6384, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(108.3764, device='cuda:2')
compute similarity is  tensor(0.9507, device='cuda:2')
compute distance is  tensor(101.3055, device='cuda:2')
compute similarity is  tensor(0.9529, device='cuda:2')
compute distance is  tensor(95.1039, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
calculated distance threshold is  tensor(193.0409, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8767833334896555
====================
====================
iteration is  0
round is  1
accuracy is  0.8747000001563223
====================
====================
iteration is  0
round is  2
accuracy is  0.8786000001563222
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8278166668229908
====================
====================
iteration is  1
round is  1
accuracy is  0.8513833334896566
====================
====================
iteration is  1
round is  2
accuracy is  0.839283333489657
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7382833334896618
====================
====================
iteration is  2
round is  1
accuracy is  0.6717000001563322
====================
====================
iteration is  2
round is  2
accuracy is  0.6461833334896674
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.4362500001563415
====================
====================
iteration is  3
round is  1
accuracy is  0.3566000001563406
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.29653333348967276
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.416566666823008
====================
====================
iteration is  4
round is  1
accuracy is  0.30935000015633973
====================
====================
iteration is  4
round is  2
accuracy is  0.1165166668229986
====================
succ_min + 1
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.30671666682300647
====================
________________________________
test distance is  tensor(643.0478, device='cuda:2')
test similarity is  tensor(0.3427, device='cuda:2')
test acc is  0.1165166668229986
test loss is 5.935660044521665
test entropy is  0.8219186448847561
________________________________
cal_distance is  tensor(352.3290, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(193.0435, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(105.7706, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(105.7706, device='cuda:2')
test similarity is  tensor(0.9102, device='cuda:2')
test acc is  0.7854666668229928
test loss is 0.6461840374573969
test entropy is  0.6111424942133523
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.6111424942133523
avg test loss is  0.6461840374573969
avg accuracy is  0.7854666668229928
compute_distance is  tensor(105.7706, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.7343507285819633
avg test loss is  5.926487934360626
avg accuracy is  0.12343333348966527
compute_distance is  tensor(128.0746, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(128.0746, device='cuda:2')
test similarity is  tensor(0.9064, device='cuda:2')
test acc is  0.12343333348966527
test loss is 5.926487934360626
test entropy is  0.7343507285819633
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 20 global rounds:
Train Accuracy: 88.62% 

Test Accuracy: 87.70% 


 | Global Training Round : 21 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.1355810165405273
attack res is True
len of model dicts is  12
compute distance is  tensor(93.0916, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(96.0024, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(97.5376, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(109.4002, device='cuda:2')
compute similarity is  tensor(0.9446, device='cuda:2')
compute distance is  tensor(102.2753, device='cuda:2')
compute similarity is  tensor(0.9559, device='cuda:2')
compute distance is  tensor(93.7214, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(100.3515, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(97.2828, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(96.4959, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(105.2934, device='cuda:2')
compute similarity is  tensor(0.9526, device='cuda:2')
compute distance is  tensor(101.6304, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(96.8322, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
calculated distance threshold is  tensor(201.7107, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8859500001563219
====================
====================
iteration is  0
round is  1
accuracy is  0.8808333334896554
====================
====================
iteration is  0
round is  2
accuracy is  0.8847833334896553
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.7589833334896606
====================
====================
iteration is  1
round is  1
accuracy is  0.8573833334896563
====================
====================
iteration is  1
round is  2
accuracy is  0.7934833334896589
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6752000001563321
====================
====================
iteration is  2
round is  1
accuracy is  0.5881833334896719
====================
====================
iteration is  2
round is  2
accuracy is  0.57225000015634
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3504500001563404
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.14770000015633294
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.2982500001563395
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.3435333334896737
====================
====================
iteration is  4
round is  1
accuracy is  0.3993500001563411
====================
________________________________
test distance is  tensor(305.2086, device='cuda:2')
test similarity is  tensor(0.5818, device='cuda:2')
test acc is  0.14770000015633294
test loss is 3.233528003509619
test entropy is  1.559777535482256
________________________________
cal_distance is  tensor(248.1213, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(201.7119, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(163.9832, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(163.9832, device='cuda:2')
test similarity is  tensor(0.8062, device='cuda:2')
test acc is  0.28826666682300595
test loss is 2.1571367178390277
test entropy is  1.7225262872191633
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 21 global rounds:
Train Accuracy: 88.75% 

Test Accuracy: 87.92% 


 | Global Training Round : 22 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.1271443367004395
attack res is True
len of model dicts is  12
compute distance is  tensor(93.4383, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(93.6769, device='cuda:2')
compute similarity is  tensor(0.9603, device='cuda:2')
compute distance is  tensor(102.0954, device='cuda:2')
compute similarity is  tensor(0.9533, device='cuda:2')
compute distance is  tensor(99.6980, device='cuda:2')
compute similarity is  tensor(0.9556, device='cuda:2')
compute distance is  tensor(97.8268, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(96.3660, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(100.3779, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(94.3145, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(91.9471, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(105.9279, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(102.8531, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(98.8492, device='cuda:2')
compute similarity is  tensor(0.9542, device='cuda:2')
calculated distance threshold is  tensor(194.3743, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8796500001563221
====================
====================
iteration is  0
round is  1
accuracy is  0.881700000156322
====================
====================
iteration is  0
round is  2
accuracy is  0.8843666668229886
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.858900000156323
====================
====================
iteration is  1
round is  1
accuracy is  0.8540166668229897
====================
====================
iteration is  1
round is  2
accuracy is  0.8126500001563248
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3817000001563409
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.5733833334896732
====================
====================
iteration is  2
round is  2
accuracy is  0.6044500001563373
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.1820166668230021
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3940333334896744
====================
====================
iteration is  3
round is  2
accuracy is  0.20431666682300328
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.20758333348967004
====================
________________________________
test distance is  tensor(317.0257, device='cuda:2')
test similarity is  tensor(0.5943, device='cuda:2')
test acc is  0.1820166668230021
test loss is 5.928971513756303
test entropy is  0.5690180551904097
________________________________
cal_distance is  tensor(248.2379, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(194.3757, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(152.2006, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(152.2006, device='cuda:2')
test similarity is  tensor(0.8360, device='cuda:2')
test acc is  0.3739333334896741
test loss is 2.4181568397641944
test entropy is  0.7749397976439136
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 22 global rounds:
Train Accuracy: 88.32% 

Test Accuracy: 87.60% 


 | Global Training Round : 23 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.186408281326294
attack res is True
len of model dicts is  12
compute distance is  tensor(100.8597, device='cuda:2')
compute similarity is  tensor(0.9522, device='cuda:2')
compute distance is  tensor(101.9125, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(96.3848, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(102.7437, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(114.6160, device='cuda:2')
compute similarity is  tensor(0.9474, device='cuda:2')
compute distance is  tensor(100.7053, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(99.9423, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(101.6288, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(92.2309, device='cuda:2')
compute similarity is  tensor(0.9635, device='cuda:2')
compute distance is  tensor(101.5303, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(102.9538, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(99.6838, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
calculated distance threshold is  tensor(272.6295, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.883700000156322
====================
====================
iteration is  0
round is  1
accuracy is  0.884250000156322
====================
====================
iteration is  0
round is  2
accuracy is  0.8818166668229888
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8744833334896557
====================
====================
iteration is  1
round is  1
accuracy is  0.8717833334896559
====================
====================
iteration is  1
round is  2
accuracy is  0.7596500001563272
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5165500001563421
====================
====================
iteration is  2
round is  1
accuracy is  0.44591666682300823
====================
====================
iteration is  2
round is  2
accuracy is  0.5451000001563424
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5201500001563423
====================
====================
iteration is  3
round is  1
accuracy is  0.49205000015634204
====================
====================
iteration is  3
round is  2
accuracy is  0.24026666682300468
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.06080000015633219
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.3190166668230066
====================
====================
iteration is  4
round is  2
accuracy is  0.18238333348966881
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.16506666682300106
====================
________________________________
test distance is  tensor(637.2783, device='cuda:2')
test similarity is  tensor(0.3742, device='cuda:2')
test acc is  0.06080000015633219
test loss is 14.414270851403666
test entropy is  0.44648527549401024
________________________________
cal_distance is  tensor(416.8236, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(272.6316, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(178.3204, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(178.3204, device='cuda:2')
test similarity is  tensor(0.8027, device='cuda:2')
test acc is  0.48266666682300857
test loss is 1.7453193552712643
test entropy is  1.024420258078748
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  1.024420258078748
avg test loss is  1.7453193552712643
avg accuracy is  0.48266666682300857
compute_distance is  tensor(178.3204, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.4167861425196692
avg test loss is  10.551395350173593
avg accuracy is  0.05926666682299887
compute_distance is  tensor(185.0760, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(185.0760, device='cuda:2')
test similarity is  tensor(0.8112, device='cuda:2')
test acc is  0.05926666682299887
test loss is 10.551395350173593
test entropy is  0.4167861425196692
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 23 global rounds:
Train Accuracy: 88.38% 

Test Accuracy: 87.90% 


 | Global Training Round : 24 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.2263169288635254
attack res is True
len of model dicts is  12
compute distance is  tensor(100.2908, device='cuda:2')
compute similarity is  tensor(0.9558, device='cuda:2')
compute distance is  tensor(104.5282, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(96.8473, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
compute distance is  tensor(115.0472, device='cuda:2')
compute similarity is  tensor(0.9432, device='cuda:2')
compute distance is  tensor(110.7123, device='cuda:2')
compute similarity is  tensor(0.9528, device='cuda:2')
compute distance is  tensor(99.7627, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(103.8052, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(102.9276, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(99.7749, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
compute distance is  tensor(105.0555, device='cuda:2')
compute similarity is  tensor(0.9563, device='cuda:2')
compute distance is  tensor(106.5539, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(98.1027, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
calculated distance threshold is  tensor(258.1854, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.883950000156322
====================
====================
iteration is  0
round is  1
accuracy is  0.883850000156322
====================
====================
iteration is  0
round is  2
accuracy is  0.8821833334896554
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.868733333489656
====================
====================
iteration is  1
round is  1
accuracy is  0.8483500001563233
====================
====================
iteration is  1
round is  2
accuracy is  0.7713166668229934
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.717033333489663
====================
====================
iteration is  2
round is  1
accuracy is  0.6266000001563354
====================
====================
iteration is  2
round is  2
accuracy is  0.5137833334896754
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.29695000015633954
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3284666668230068
====================
====================
iteration is  3
round is  2
accuracy is  0.4484000001563416
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.11775000015633195
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.17478333348966843
====================
====================
iteration is  4
round is  2
accuracy is  0.23015000015633763
====================
________________________________
test distance is  tensor(670.4734, device='cuda:2')
test similarity is  tensor(0.3619, device='cuda:2')
test acc is  0.11775000015633195
test loss is 17.47854774084681
test entropy is  0.26629400129384323
________________________________
cal_distance is  tensor(416.0620, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(258.1877, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(160.2191, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(160.2191, device='cuda:2')
test similarity is  tensor(0.8383, device='cuda:2')
test acc is  0.533716666823009
test loss is 1.7806771358828555
test entropy is  0.6475650922321816
________________________________
++++++++++++++++++++
after training  0
avg test entropy is  0.6475650922321816
avg test loss is  1.7806771358828555
avg accuracy is  0.533716666823009
compute_distance is  tensor(160.2191, device='cuda:2')
++++++++++++++++++++
++++++++++++++++++++
after training  1
avg test entropy is  0.461064083489782
avg test loss is  10.109712159455713
avg accuracy is  0.1141833334896653
compute_distance is  tensor(171.8643, device='cuda:2')
++++++++++++++++++++
________________________________
test distance is  tensor(171.8643, device='cuda:2')
test similarity is  tensor(0.8439, device='cuda:2')
test acc is  0.1141833334896653
test loss is 10.109712159455713
test entropy is  0.461064083489782
________________________________
num2 of attacker is  0
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 24 global rounds:
Train Accuracy: 88.50% 

Test Accuracy: 87.89% 


 | Global Training Round : 25 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.2319576740264893
attack res is True
len of model dicts is  12
compute distance is  tensor(86.8420, device='cuda:2')
compute similarity is  tensor(0.9656, device='cuda:2')
compute distance is  tensor(106.2787, device='cuda:2')
compute similarity is  tensor(0.9529, device='cuda:2')
compute distance is  tensor(97.6997, device='cuda:2')
compute similarity is  tensor(0.9591, device='cuda:2')
compute distance is  tensor(112.1931, device='cuda:2')
compute similarity is  tensor(0.9458, device='cuda:2')
compute distance is  tensor(104.1996, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(101.2166, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(103.8217, device='cuda:2')
compute similarity is  tensor(0.9556, device='cuda:2')
compute distance is  tensor(99.7134, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(93.6173, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
compute distance is  tensor(103.0121, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(105.9717, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(102.5182, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
calculated distance threshold is  tensor(334.0464, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8833666668229887
====================
====================
iteration is  0
round is  1
accuracy is  0.8850333334896552
====================
====================
iteration is  0
round is  2
accuracy is  0.881900000156322
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8566166668229898
====================
====================
iteration is  1
round is  1
accuracy is  0.8207500001563245
====================
====================
iteration is  1
round is  2
accuracy is  0.8048000001563251
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6811666668229984
====================
====================
iteration is  2
round is  1
accuracy is  0.5991000001563376
====================
====================
iteration is  2
round is  2
accuracy is  0.5302833334896756
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.1651166668230011
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.32168333348967326
====================
====================
iteration is  3
round is  2
accuracy is  0.3402500001563403
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.35561666682300724
====================
====================
iteration is  4
round is  1
accuracy is  0.3483333334896738
====================
________________________________
test distance is  tensor(313.5803, device='cuda:2')
test similarity is  tensor(0.6071, device='cuda:2')
test acc is  0.1651166668230011
test loss is 8.455769403656916
test entropy is  0.3680692723533238
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 25 global rounds:
Train Accuracy: 88.49% 

Test Accuracy: 87.52% 


 | Global Training Round : 26 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.2844271659851074
attack res is True
len of model dicts is  12
compute distance is  tensor(103.5012, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(108.1703, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(103.8356, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(114.7542, device='cuda:2')
compute similarity is  tensor(0.9470, device='cuda:2')
compute distance is  tensor(109.4300, device='cuda:2')
compute similarity is  tensor(0.9530, device='cuda:2')
compute distance is  tensor(110.0497, device='cuda:2')
compute similarity is  tensor(0.9512, device='cuda:2')
compute distance is  tensor(103.9592, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(102.0800, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(108.6742, device='cuda:2')
compute similarity is  tensor(0.9524, device='cuda:2')
compute distance is  tensor(111.9618, device='cuda:2')
compute similarity is  tensor(0.9514, device='cuda:2')
compute distance is  tensor(104.4953, device='cuda:2')
compute similarity is  tensor(0.9548, device='cuda:2')
compute distance is  tensor(101.9410, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
calculated distance threshold is  tensor(239.3792, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8861333334896552
====================
====================
iteration is  0
round is  1
accuracy is  0.8868833334896552
====================
====================
iteration is  0
round is  2
accuracy is  0.8863500001563219
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8275833334896575
====================
====================
iteration is  1
round is  1
accuracy is  0.8581833334896564
====================
====================
iteration is  1
round is  2
accuracy is  0.8655833334896561
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7957666668229922
====================
====================
iteration is  2
round is  1
accuracy is  0.7121333334896632
====================
====================
iteration is  2
round is  2
accuracy is  0.6894333334896645
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3321833334896735
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.5552500001563415
====================
====================
iteration is  3
round is  2
accuracy is  0.14215000015633245
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.17398333348966832
====================
====================
iteration is  4
round is  1
accuracy is  0.3148333334896732
====================
====================
iteration is  4
round is  2
accuracy is  0.16126666682300078
====================
________________________________
test distance is  tensor(322.5838, device='cuda:2')
test similarity is  tensor(0.6011, device='cuda:2')
test acc is  0.14215000015633245
test loss is 6.583044646391228
test entropy is  0.5832864932858868
________________________________
cal_distance is  tensor(277.8851, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(239.3801, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(206.2106, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(206.2106, device='cuda:2')
test similarity is  tensor(0.7613, device='cuda:2')
test acc is  0.3520500001563404
test loss is 2.887339404651097
test entropy is  0.7179926574103105
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 26 global rounds:
Train Accuracy: 88.01% 

Test Accuracy: 87.39% 


 | Global Training Round : 27 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.3375937938690186
attack res is True
len of model dicts is  12
compute distance is  tensor(98.0734, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(105.5372, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(103.4180, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(110.5921, device='cuda:2')
compute similarity is  tensor(0.9508, device='cuda:2')
compute distance is  tensor(106.2517, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(106.2026, device='cuda:2')
compute similarity is  tensor(0.9561, device='cuda:2')
compute distance is  tensor(102.9195, device='cuda:2')
compute similarity is  tensor(0.9596, device='cuda:2')
compute distance is  tensor(100.8046, device='cuda:2')
compute similarity is  tensor(0.9605, device='cuda:2')
compute distance is  tensor(99.6448, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(109.2847, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(106.2900, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(94.5305, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
calculated distance threshold is  tensor(284.0412, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8840166668229886
====================
====================
iteration is  0
round is  1
accuracy is  0.8805166668229888
====================
====================
iteration is  0
round is  2
accuracy is  0.8783666668229889
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.84836666682299
====================
====================
iteration is  1
round is  1
accuracy is  0.8283166668229909
====================
====================
iteration is  1
round is  2
accuracy is  0.8652166668229894
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6260666668230023
====================
====================
iteration is  2
round is  1
accuracy is  0.7107333334896633
====================
====================
iteration is  2
round is  2
accuracy is  0.7602666668229939
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.37065000015634075
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2980333334896728
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.48170000015634196
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.4027000001563411
====================
====================
iteration is  4
round is  1
accuracy is  0.22331666682300405
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.07953333348966539
====================
succ_min + 1
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.39425000015634104
====================
________________________________
test distance is  tensor(616.3577, device='cuda:2')
test similarity is  tensor(0.3463, device='cuda:2')
test acc is  0.07953333348966539
test loss is 25.874323015274015
test entropy is  0.37301379723398925
________________________________
cal_distance is  tensor(418.4160, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(284.0432, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(192.8241, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(192.8241, device='cuda:2')
test similarity is  tensor(0.7750, device='cuda:2')
test acc is  0.2266833334896709
test loss is 4.373896928992607
test entropy is  0.7877024795327868
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 27 global rounds:
Train Accuracy: 88.04% 

Test Accuracy: 87.48% 


 | Global Training Round : 28 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.358032703399658
attack res is True
len of model dicts is  12
compute distance is  tensor(94.9720, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(105.7961, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(103.0449, device='cuda:2')
compute similarity is  tensor(0.9578, device='cuda:2')
compute distance is  tensor(111.1312, device='cuda:2')
compute similarity is  tensor(0.9499, device='cuda:2')
compute distance is  tensor(105.8298, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(106.3432, device='cuda:2')
compute similarity is  tensor(0.9552, device='cuda:2')
compute distance is  tensor(104.0172, device='cuda:2')
compute similarity is  tensor(0.9586, device='cuda:2')
compute distance is  tensor(113.5805, device='cuda:2')
compute similarity is  tensor(0.9509, device='cuda:2')
compute distance is  tensor(105.2328, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(104.8126, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(102.5667, device='cuda:2')
compute similarity is  tensor(0.9591, device='cuda:2')
compute distance is  tensor(100.2112, device='cuda:2')
compute similarity is  tensor(0.9601, device='cuda:2')
calculated distance threshold is  tensor(336.4889, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8832833334896554
====================
====================
iteration is  0
round is  1
accuracy is  0.881550000156322
====================
====================
iteration is  0
round is  2
accuracy is  0.8714833334896558
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8694333334896559
====================
====================
iteration is  1
round is  1
accuracy is  0.8474833334896568
====================
====================
iteration is  1
round is  2
accuracy is  0.84721666682299
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6428833334896674
====================
====================
iteration is  2
round is  1
accuracy is  0.42943333348967483
====================
====================
iteration is  2
round is  2
accuracy is  0.6099500001563367
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5674500001563403
====================
====================
iteration is  3
round is  1
accuracy is  0.41156666682300797
====================
====================
iteration is  3
round is  2
accuracy is  0.5771500001563394
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.038383333489665813
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.2777166668230057
====================
====================
iteration is  4
round is  2
accuracy is  0.28783333348967255
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.05186666682299896
====================
====================
iteration is  5
round is  1
accuracy is  0.08711666682299869
====================
________________________________
test distance is  tensor(658.2270, device='cuda:2')
test similarity is  tensor(0.3306, device='cuda:2')
test acc is  0.038383333489665813
test loss is 25.59372094241795
test entropy is  0.2966770903229205
________________________________
cal_distance is  tensor(470.6241, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(336.4907, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(240.5871, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(240.5871, device='cuda:2')
test similarity is  tensor(0.7060, device='cuda:2')
test acc is  0.12660000015633194
test loss is 6.3046639728139455
test entropy is  0.9326729177793206
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 28 global rounds:
Train Accuracy: 88.30% 

Test Accuracy: 87.54% 


 | Global Training Round : 29 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.3692896366119385
attack res is True
len of model dicts is  12
compute distance is  tensor(90.5885, device='cuda:2')
compute similarity is  tensor(0.9661, device='cuda:2')
compute distance is  tensor(105.1955, device='cuda:2')
compute similarity is  tensor(0.9587, device='cuda:2')
compute distance is  tensor(104.9780, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(109.7907, device='cuda:2')
compute similarity is  tensor(0.9527, device='cuda:2')
compute distance is  tensor(109.8651, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(102.4262, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(101.0948, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(107.7570, device='cuda:2')
compute similarity is  tensor(0.9562, device='cuda:2')
compute distance is  tensor(92.1553, device='cuda:2')
compute similarity is  tensor(0.9668, device='cuda:2')
compute distance is  tensor(107.0064, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(103.4249, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(105.2809, device='cuda:2')
compute similarity is  tensor(0.9566, device='cuda:2')
calculated distance threshold is  tensor(365.7964, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8863000001563219
====================
====================
iteration is  0
round is  1
accuracy is  0.8860666668229885
====================
====================
iteration is  0
round is  2
accuracy is  0.8844666668229887
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8553333334896565
====================
====================
iteration is  1
round is  1
accuracy is  0.8547166668229897
====================
====================
iteration is  1
round is  2
accuracy is  0.84821666682299
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.574733333489673
====================
====================
iteration is  2
round is  1
accuracy is  0.3195666668230066
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.4300666668230081
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.24748333348967158
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3264666668230067
====================
====================
iteration is  3
round is  2
accuracy is  0.2121833334896703
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.3164000001563399
====================
________________________________
test distance is  tensor(311.3350, device='cuda:2')
test similarity is  tensor(0.6246, device='cuda:2')
test acc is  0.2121833334896703
test loss is 2.6696341042833795
test entropy is  1.5550183407279219
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  0
 
Avg Training Stats after 29 global rounds:
Train Accuracy: 88.52% 

Test Accuracy: 87.51% 


 | Global Training Round : 30 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.40582013130188
attack res is True
len of model dicts is  12
compute distance is  tensor(107.0083, device='cuda:2')
compute similarity is  tensor(0.9570, device='cuda:2')
compute distance is  tensor(114.8342, device='cuda:2')
compute similarity is  tensor(0.9510, device='cuda:2')
compute distance is  tensor(101.4385, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(115.1843, device='cuda:2')
compute similarity is  tensor(0.9484, device='cuda:2')
compute distance is  tensor(107.3857, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(105.9133, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(117.6901, device='cuda:2')
compute similarity is  tensor(0.9491, device='cuda:2')
compute distance is  tensor(103.4695, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(101.7832, device='cuda:2')
compute similarity is  tensor(0.9606, device='cuda:2')
compute distance is  tensor(112.9761, device='cuda:2')
compute similarity is  tensor(0.9537, device='cuda:2')
compute distance is  tensor(102.3236, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
compute distance is  tensor(105.1433, device='cuda:2')
compute similarity is  tensor(0.9591, device='cuda:2')
calculated distance threshold is  tensor(356.6603, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8839333334896553
====================
====================
iteration is  0
round is  1
accuracy is  0.8787833334896555
====================
====================
iteration is  0
round is  2
accuracy is  0.8882833334896553
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8139166668229915
====================
====================
iteration is  1
round is  1
accuracy is  0.8511666668229899
====================
====================
iteration is  1
round is  2
accuracy is  0.8609333334896562
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7046500001563304
====================
====================
iteration is  2
round is  1
accuracy is  0.6181666668230029
====================
====================
iteration is  2
round is  2
accuracy is  0.6997000001563306
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.17993333348966872
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.1585500001563339
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.4623166668230084
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.2510166668230051
====================
====================
iteration is  4
round is  1
accuracy is  0.3698666668230074
====================
====================
iteration is  4
round is  2
accuracy is  0.3816833334896742
====================
________________________________
test distance is  tensor(315.0814, device='cuda:2')
test similarity is  tensor(0.6137, device='cuda:2')
test acc is  0.1585500001563339
test loss is 4.881629583932189
test entropy is  0.9475464885041658
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 30 global rounds:
Train Accuracy: 88.50% 

Test Accuracy: 87.71% 


 | Global Training Round : 31 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.425804615020752
attack res is True
len of model dicts is  12
compute distance is  tensor(94.6378, device='cuda:2')
compute similarity is  tensor(0.9648, device='cuda:2')
compute distance is  tensor(106.9491, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(98.8051, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(114.4220, device='cuda:2')
compute similarity is  tensor(0.9502, device='cuda:2')
compute distance is  tensor(111.9842, device='cuda:2')
compute similarity is  tensor(0.9551, device='cuda:2')
compute distance is  tensor(103.8309, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(106.2717, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(102.2988, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(99.0941, device='cuda:2')
compute similarity is  tensor(0.9639, device='cuda:2')
compute distance is  tensor(101.0017, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(105.9904, device='cuda:2')
compute similarity is  tensor(0.9579, device='cuda:2')
compute distance is  tensor(96.9278, device='cuda:2')
compute similarity is  tensor(0.9636, device='cuda:2')
calculated distance threshold is  tensor(436.4071, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8874500001563219
====================
====================
iteration is  0
round is  1
accuracy is  0.8858333334896552
====================
====================
iteration is  0
round is  2
accuracy is  0.874116666822989
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.867783333489656
====================
====================
iteration is  1
round is  1
accuracy is  0.8395666668229904
====================
====================
iteration is  1
round is  2
accuracy is  0.8447500001563236
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7292833334896623
====================
====================
iteration is  2
round is  1
accuracy is  0.7308500001563288
====================
====================
iteration is  2
round is  2
accuracy is  0.7304833334896622
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.32041666682300657
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.20513333348966994
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.22760000015633758
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.4469500001563417
====================
====================
iteration is  4
round is  1
accuracy is  0.1327000001563319
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.20596666682300332
====================
________________________________
test distance is  tensor(331.3003, device='cuda:2')
test similarity is  tensor(0.6080, device='cuda:2')
test acc is  0.1327000001563319
test loss is 2.9171348543309454
test entropy is  1.7507985531648338
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  0
 
Avg Training Stats after 31 global rounds:
Train Accuracy: 88.54% 

Test Accuracy: 87.79% 


 | Global Training Round : 32 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.4644808769226074
attack res is True
len of model dicts is  12
compute distance is  tensor(96.4641, device='cuda:2')
compute similarity is  tensor(0.9640, device='cuda:2')
compute distance is  tensor(104.9834, device='cuda:2')
compute similarity is  tensor(0.9590, device='cuda:2')
compute distance is  tensor(107.5761, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(106.5440, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(107.7326, device='cuda:2')
compute similarity is  tensor(0.9584, device='cuda:2')
compute distance is  tensor(102.3980, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(107.9677, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(109.3079, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(105.9284, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(104.4909, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
compute distance is  tensor(106.0707, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(105.7126, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
calculated distance threshold is  tensor(340.5254, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8805000001563221
====================
====================
iteration is  0
round is  1
accuracy is  0.8885833334896551
====================
====================
iteration is  0
round is  2
accuracy is  0.8863333334896553
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8667000001563228
====================
====================
iteration is  1
round is  1
accuracy is  0.8701833334896558
====================
====================
iteration is  1
round is  2
accuracy is  0.8616166668229895
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7361000001563286
====================
====================
iteration is  2
round is  1
accuracy is  0.6621666668229996
====================
====================
iteration is  2
round is  2
accuracy is  0.456233333489675
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.14970000015633317
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.22465000015633754
====================
====================
iteration is  3
round is  2
accuracy is  0.20926666682300354
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.11393333348966529
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.4637000001563418
====================
====================
iteration is  4
round is  2
accuracy is  0.42188333348967466
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.3501500001563405
====================
________________________________
test distance is  tensor(319.3594, device='cuda:2')
test similarity is  tensor(0.5961, device='cuda:2')
test acc is  0.11393333348966529
test loss is 6.720899875738473
test entropy is  0.5675163061570511
________________________________
num2 of attacker is  0
the length of epoch_weights is  3
the length of weights_d is  3
 
Avg Training Stats after 32 global rounds:
Train Accuracy: 88.44% 

Test Accuracy: 87.71% 


 | Global Training Round : 33 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.475891590118408
attack res is True
len of model dicts is  12
compute distance is  tensor(93.9369, device='cuda:2')
compute similarity is  tensor(0.9665, device='cuda:2')
compute distance is  tensor(109.2206, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(104.6494, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(112.0122, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(104.5621, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
compute distance is  tensor(103.6179, device='cuda:2')
compute similarity is  tensor(0.9603, device='cuda:2')
compute distance is  tensor(97.0032, device='cuda:2')
compute similarity is  tensor(0.9651, device='cuda:2')
compute distance is  tensor(105.9291, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(101.9167, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(106.7168, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(104.9209, device='cuda:2')
compute similarity is  tensor(0.9598, device='cuda:2')
compute distance is  tensor(97.8889, device='cuda:2')
compute similarity is  tensor(0.9643, device='cuda:2')
calculated distance threshold is  tensor(471.7593, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8846333334896553
====================
====================
iteration is  0
round is  1
accuracy is  0.8794666668229888
====================
====================
iteration is  0
round is  2
accuracy is  0.8857833334896552
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8498166668229901
====================
====================
iteration is  1
round is  1
accuracy is  0.8310666668229907
====================
====================
iteration is  1
round is  2
accuracy is  0.8534166668229899
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6549500001563334
====================
====================
iteration is  2
round is  1
accuracy is  0.6883500001563312
====================
====================
iteration is  2
round is  2
accuracy is  0.6855000001563316
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.2210000001563373
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.5621666668230076
====================
====================
iteration is  3
round is  2
accuracy is  0.4875666668230087
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.20405000015633656
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.13033333348966525
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.2000666668230031
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.2259500001563374
====================
________________________________
test distance is  tensor(666.6377, device='cuda:2')
test similarity is  tensor(0.3543, device='cuda:2')
test acc is  0.13033333348966525
test loss is 6.652741052448622
test entropy is  0.7428588672741644
________________________________
cal_distance is  tensor(560.7970, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(471.7604, device='cuda:2', dtype=torch.float64)
cal_distance is  tensor(396.8601, device='cuda:2', dtype=torch.float64)
________________________________
test distance is  tensor(396.8601, device='cuda:2')
test similarity is  tensor(0.5382, device='cuda:2')
test acc is  0.2026833334896698
test loss is 3.725646197922957
test entropy is  1.0723384806215128
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 33 global rounds:
Train Accuracy: 88.52% 

Test Accuracy: 87.99% 


 | Global Training Round : 34 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.496025323867798
attack res is True
len of model dicts is  12
compute distance is  tensor(100.9163, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
compute distance is  tensor(114.3149, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(100.0585, device='cuda:2')
compute similarity is  tensor(0.9632, device='cuda:2')
compute distance is  tensor(111.7291, device='cuda:2')
compute similarity is  tensor(0.9545, device='cuda:2')
compute distance is  tensor(108.1003, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(98.7725, device='cuda:2')
compute similarity is  tensor(0.9635, device='cuda:2')
compute distance is  tensor(102.0068, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
compute distance is  tensor(95.9282, device='cuda:2')
compute similarity is  tensor(0.9669, device='cuda:2')
compute distance is  tensor(95.1370, device='cuda:2')
compute similarity is  tensor(0.9674, device='cuda:2')
compute distance is  tensor(103.8655, device='cuda:2')
compute similarity is  tensor(0.9617, device='cuda:2')
compute distance is  tensor(103.3462, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(95.8171, device='cuda:2')
compute similarity is  tensor(0.9667, device='cuda:2')
calculated distance threshold is  tensor(536.0914, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8840666668229886
====================
====================
iteration is  0
round is  1
accuracy is  0.8896500001563218
====================
====================
iteration is  0
round is  2
accuracy is  0.8894500001563218
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8736333334896557
====================
====================
iteration is  1
round is  1
accuracy is  0.8623666668229896
====================
====================
iteration is  1
round is  2
accuracy is  0.8423333334896569
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.8041166668229919
====================
====================
iteration is  2
round is  1
accuracy is  0.7663000001563268
====================
====================
iteration is  2
round is  2
accuracy is  0.6227833334896691
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.35273333348967384
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3178166668230066
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.21525000015633705
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.21698333348967044
====================
====================
iteration is  4
round is  1
accuracy is  0.27375000015633894
====================
________________________________
test distance is  tensor(336.5797, device='cuda:2')
test similarity is  tensor(0.6055, device='cuda:2')
test acc is  0.21525000015633705
test loss is 5.495296073874939
test entropy is  0.6464136052233324
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 34 global rounds:
Train Accuracy: 88.30% 

Test Accuracy: 87.51% 


 | Global Training Round : 35 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.538970708847046
attack res is True
len of model dicts is  12
compute distance is  tensor(102.4128, device='cuda:2')
compute similarity is  tensor(0.9626, device='cuda:2')
compute distance is  tensor(108.8207, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(112.1932, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(109.6135, device='cuda:2')
compute similarity is  tensor(0.9569, device='cuda:2')
compute distance is  tensor(114.9173, device='cuda:2')
compute similarity is  tensor(0.9577, device='cuda:2')
compute distance is  tensor(107.3843, device='cuda:2')
compute similarity is  tensor(0.9602, device='cuda:2')
compute distance is  tensor(118.3604, device='cuda:2')
compute similarity is  tensor(0.9509, device='cuda:2')
compute distance is  tensor(105.5083, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(106.4813, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(108.0606, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(108.5714, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(102.7467, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
calculated distance threshold is  tensor(505.7639, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8822166668229887
====================
====================
iteration is  0
round is  1
accuracy is  0.8814666668229887
====================
====================
iteration is  0
round is  2
accuracy is  0.8805833334896555
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8513000001563232
====================
====================
iteration is  1
round is  1
accuracy is  0.8356166668229905
====================
====================
iteration is  1
round is  2
accuracy is  0.8264000001563243
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6024666668230041
====================
====================
iteration is  2
round is  1
accuracy is  0.6872666668229979
====================
====================
iteration is  2
round is  2
accuracy is  0.6374166668230014
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.13595000015633193
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.38618333348967426
====================
====================
iteration is  3
round is  2
accuracy is  0.3800833334896742
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.42498333348967476
====================
====================
iteration is  4
round is  1
accuracy is  0.4340500001563415
====================
====================
iteration is  4
round is  2
accuracy is  0.34413333348967373
====================
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.2744666668230056
====================
________________________________
test distance is  tensor(328.9983, device='cuda:2')
test similarity is  tensor(0.6164, device='cuda:2')
test acc is  0.13595000015633193
test loss is 3.8444458640206345
test entropy is  1.3651369347501157
________________________________
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 35 global rounds:
Train Accuracy: 88.62% 

Test Accuracy: 87.87% 


 | Global Training Round : 36 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.532801628112793
attack res is True
len of model dicts is  12
compute distance is  tensor(103.5113, device='cuda:2')
compute similarity is  tensor(0.9607, device='cuda:2')
compute distance is  tensor(98.7001, device='cuda:2')
compute similarity is  tensor(0.9653, device='cuda:2')
compute distance is  tensor(102.0665, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
compute distance is  tensor(115.3196, device='cuda:2')
compute similarity is  tensor(0.9516, device='cuda:2')
compute distance is  tensor(108.8742, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(96.7710, device='cuda:2')
compute similarity is  tensor(0.9661, device='cuda:2')
compute distance is  tensor(109.7533, device='cuda:2')
compute similarity is  tensor(0.9588, device='cuda:2')
compute distance is  tensor(98.8970, device='cuda:2')
compute similarity is  tensor(0.9660, device='cuda:2')
compute distance is  tensor(99.5452, device='cuda:2')
compute similarity is  tensor(0.9649, device='cuda:2')
compute distance is  tensor(105.0583, device='cuda:2')
compute similarity is  tensor(0.9621, device='cuda:2')
compute distance is  tensor(102.6221, device='cuda:2')
compute similarity is  tensor(0.9632, device='cuda:2')
compute distance is  tensor(100.2564, device='cuda:2')
compute similarity is  tensor(0.9646, device='cuda:2')
calculated distance threshold is  tensor(612.8192, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8871833334896552
====================
====================
iteration is  0
round is  1
accuracy is  0.884200000156322
====================
====================
iteration is  0
round is  2
accuracy is  0.8856833334896552
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8636666668229894
====================
====================
iteration is  1
round is  1
accuracy is  0.8669666668229894
====================
====================
iteration is  1
round is  2
accuracy is  0.8617833334896562
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.4755666668230086
====================
====================
iteration is  2
round is  1
accuracy is  0.672616666822999
====================
====================
iteration is  2
round is  2
accuracy is  0.5197166668230089
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.20433333348966992
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.28640000015633915
====================
====================
iteration is  3
round is  2
accuracy is  0.14001666682299896
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.5056500001563421
====================
====================
iteration is  4
round is  1
accuracy is  0.3565333334896739
====================
====================
iteration is  4
round is  2
accuracy is  0.30793333348967306
====================
________________________________
test distance is  tensor(329.7033, device='cuda:2')
test similarity is  tensor(0.6231, device='cuda:2')
test acc is  0.14001666682299896
test loss is 2.7651833516956645
test entropy is  1.6954654220070666
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 36 global rounds:
Train Accuracy: 88.82% 

Test Accuracy: 88.07% 


 | Global Training Round : 37 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.5463571548461914
attack res is True
len of model dicts is  12
compute distance is  tensor(93.0387, device='cuda:2')
compute similarity is  tensor(0.9679, device='cuda:2')
compute distance is  tensor(102.3201, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(97.1445, device='cuda:2')
compute similarity is  tensor(0.9658, device='cuda:2')
compute distance is  tensor(108.1374, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(107.9439, device='cuda:2')
compute similarity is  tensor(0.9594, device='cuda:2')
compute distance is  tensor(97.7157, device='cuda:2')
compute similarity is  tensor(0.9649, device='cuda:2')
compute distance is  tensor(107.3447, device='cuda:2')
compute similarity is  tensor(0.9597, device='cuda:2')
compute distance is  tensor(97.1891, device='cuda:2')
compute similarity is  tensor(0.9665, device='cuda:2')
compute distance is  tensor(86.3094, device='cuda:2')
compute similarity is  tensor(0.9730, device='cuda:2')
compute distance is  tensor(104.9851, device='cuda:2')
compute similarity is  tensor(0.9612, device='cuda:2')
compute distance is  tensor(99.0758, device='cuda:2')
compute similarity is  tensor(0.9653, device='cuda:2')
compute distance is  tensor(95.4921, device='cuda:2')
compute similarity is  tensor(0.9669, device='cuda:2')
calculated distance threshold is  tensor(754.3232, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8896666668229885
====================
====================
iteration is  0
round is  1
accuracy is  0.8907166668229884
====================
====================
iteration is  0
round is  2
accuracy is  0.8876333334896552
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8396166668229904
====================
====================
iteration is  1
round is  1
accuracy is  0.8145500001563248
====================
====================
iteration is  1
round is  2
accuracy is  0.8616000001563229
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3864500001563409
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.70845000015633
====================
====================
iteration is  2
round is  2
accuracy is  0.7388833334896617
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.21531666682300368
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2272666668230042
====================
====================
iteration is  3
round is  2
accuracy is  0.10171666682299867
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.26580000015633876
====================
________________________________
test distance is  tensor(328.6060, device='cuda:2')
test similarity is  tensor(0.6197, device='cuda:2')
test acc is  0.10171666682299867
test loss is 5.667789494813378
test entropy is  0.8783958019224057
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 37 global rounds:
Train Accuracy: 88.65% 

Test Accuracy: 87.53% 


 | Global Training Round : 38 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.5964620113372803
attack res is True
len of model dicts is  12
compute distance is  tensor(104.1238, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
compute distance is  tensor(103.8413, device='cuda:2')
compute similarity is  tensor(0.9623, device='cuda:2')
compute distance is  tensor(102.9998, device='cuda:2')
compute similarity is  tensor(0.9640, device='cuda:2')
compute distance is  tensor(111.8437, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(104.9161, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(111.2287, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(101.1655, device='cuda:2')
compute similarity is  tensor(0.9653, device='cuda:2')
compute distance is  tensor(109.2313, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
compute distance is  tensor(104.8510, device='cuda:2')
compute similarity is  tensor(0.9625, device='cuda:2')
compute distance is  tensor(105.6388, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(107.4957, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
compute distance is  tensor(106.2228, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
calculated distance threshold is  tensor(460.6327, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8869666668229885
====================
====================
iteration is  0
round is  1
accuracy is  0.8874166668229886
====================
====================
iteration is  0
round is  2
accuracy is  0.8763000001563223
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8263833334896576
====================
====================
iteration is  1
round is  1
accuracy is  0.8236833334896576
====================
====================
iteration is  1
round is  2
accuracy is  0.8235000001563243
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6512166668230004
====================
====================
iteration is  2
round is  1
accuracy is  0.7587500001563273
====================
====================
iteration is  2
round is  2
accuracy is  0.6053166668230038
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.2690333334896722
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.2540500001563385
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.3419333334896737
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.20721666682300338
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.3154666668230065
====================
________________________________
test distance is  tensor(326.3941, device='cuda:2')
test similarity is  tensor(0.6074, device='cuda:2')
test acc is  0.20721666682300338
test loss is 2.9301663595221954
test entropy is  1.3831065208164615
________________________________
num2 of attacker is  12
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 38 global rounds:
Train Accuracy: 88.63% 

Test Accuracy: 87.84% 


 | Global Training Round : 39 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.6159284114837646
attack res is True
len of model dicts is  12
compute distance is  tensor(94.8556, device='cuda:2')
compute similarity is  tensor(0.9683, device='cuda:2')
compute distance is  tensor(106.7576, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(108.1032, device='cuda:2')
compute similarity is  tensor(0.9613, device='cuda:2')
compute distance is  tensor(114.7902, device='cuda:2')
compute similarity is  tensor(0.9534, device='cuda:2')
compute distance is  tensor(106.9656, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(106.6085, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
compute distance is  tensor(101.8427, device='cuda:2')
compute similarity is  tensor(0.9651, device='cuda:2')
compute distance is  tensor(105.7989, device='cuda:2')
compute similarity is  tensor(0.9622, device='cuda:2')
compute distance is  tensor(103.2718, device='cuda:2')
compute similarity is  tensor(0.9643, device='cuda:2')
compute distance is  tensor(104.2291, device='cuda:2')
compute similarity is  tensor(0.9648, device='cuda:2')
compute distance is  tensor(108.2682, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
compute distance is  tensor(98.0369, device='cuda:2')
compute similarity is  tensor(0.9658, device='cuda:2')
calculated distance threshold is  tensor(833.0394, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8906333334896551
====================
====================
iteration is  0
round is  1
accuracy is  0.8885000001563219
====================
====================
iteration is  0
round is  2
accuracy is  0.8871833334896552
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8373000001563238
====================
====================
iteration is  1
round is  1
accuracy is  0.8677000001563226
====================
====================
iteration is  1
round is  2
accuracy is  0.8473500001563234
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5708666668230068
====================
====================
iteration is  2
round is  1
accuracy is  0.654516666823
====================
====================
iteration is  2
round is  2
accuracy is  0.7102166668229967
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.30198333348967293
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.4905833334896753
====================
====================
iteration is  3
round is  2
accuracy is  0.3774333334896741
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.4400833334896749
====================
====================
iteration is  4
round is  1
accuracy is  0.10436666682299865
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.051833333489665595
====================
succ_min + 1
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.11748333348966528
====================
________________________________
test distance is  tensor(658.5416, device='cuda:2')
test similarity is  tensor(0.3689, device='cuda:2')
test acc is  0.051833333489665595
test loss is 16.741311696546674
test entropy is  0.2752657425143063
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 39 global rounds:
Train Accuracy: 88.50% 

Test Accuracy: 87.77% 


 | Global Training Round : 40 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.6501121520996094
attack res is True
len of model dicts is  12
compute distance is  tensor(101.7617, device='cuda:2')
compute similarity is  tensor(0.9656, device='cuda:2')
compute distance is  tensor(103.9750, device='cuda:2')
compute similarity is  tensor(0.9642, device='cuda:2')
compute distance is  tensor(111.4823, device='cuda:2')
compute similarity is  tensor(0.9585, device='cuda:2')
compute distance is  tensor(119.8605, device='cuda:2')
compute similarity is  tensor(0.9538, device='cuda:2')
compute distance is  tensor(111.4461, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(110.4014, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(111.8925, device='cuda:2')
compute similarity is  tensor(0.9589, device='cuda:2')
compute distance is  tensor(105.8244, device='cuda:2')
compute similarity is  tensor(0.9636, device='cuda:2')
compute distance is  tensor(102.5814, device='cuda:2')
compute similarity is  tensor(0.9641, device='cuda:2')
compute distance is  tensor(105.8234, device='cuda:2')
compute similarity is  tensor(0.9639, device='cuda:2')
compute distance is  tensor(113.3471, device='cuda:2')
compute similarity is  tensor(0.9573, device='cuda:2')
compute distance is  tensor(115.6754, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
calculated distance threshold is  tensor(838.9848, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8861166668229887
====================
====================
iteration is  0
round is  1
accuracy is  0.8837666668229887
====================
====================
iteration is  0
round is  2
accuracy is  0.8847833334896553
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8591500001563228
====================
====================
iteration is  1
round is  1
accuracy is  0.8536000001563231
====================
====================
iteration is  1
round is  2
accuracy is  0.8633166668229896
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6520500001563336
====================
====================
iteration is  2
round is  1
accuracy is  0.5998166668230042
====================
====================
iteration is  2
round is  2
accuracy is  0.5130833334896755
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.2075333334896701
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.10471666682299866
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.3776000001563408
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.27550000015633896
====================
====================
iteration is  4
round is  1
accuracy is  0.24886666682300496
====================
________________________________
test distance is  tensor(327.5513, device='cuda:2')
test similarity is  tensor(0.6471, device='cuda:2')
test acc is  0.10471666682299866
test loss is 10.420320637444698
test entropy is  0.5132056774932947
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 40 global rounds:
Train Accuracy: 88.68% 

Test Accuracy: 87.92% 


 | Global Training Round : 41 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.6687936782836914
attack res is True
len of model dicts is  12
compute distance is  tensor(96.4222, device='cuda:2')
compute similarity is  tensor(0.9673, device='cuda:2')
compute distance is  tensor(108.2450, device='cuda:2')
compute similarity is  tensor(0.9614, device='cuda:2')
compute distance is  tensor(104.1175, device='cuda:2')
compute similarity is  tensor(0.9637, device='cuda:2')
compute distance is  tensor(114.7617, device='cuda:2')
compute similarity is  tensor(0.9572, device='cuda:2')
compute distance is  tensor(107.7554, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(106.8997, device='cuda:2')
compute similarity is  tensor(0.9627, device='cuda:2')
compute distance is  tensor(108.1487, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(102.9292, device='cuda:2')
compute similarity is  tensor(0.9655, device='cuda:2')
compute distance is  tensor(95.5708, device='cuda:2')
compute similarity is  tensor(0.9695, device='cuda:2')
compute distance is  tensor(110.6066, device='cuda:2')
compute similarity is  tensor(0.9610, device='cuda:2')
compute distance is  tensor(104.0014, device='cuda:2')
compute similarity is  tensor(0.9651, device='cuda:2')
compute distance is  tensor(96.0858, device='cuda:2')
compute similarity is  tensor(0.9679, device='cuda:2')
calculated distance threshold is  tensor(955.4528, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8899333334896552
====================
====================
iteration is  0
round is  1
accuracy is  0.8886666668229884
====================
====================
iteration is  0
round is  2
accuracy is  0.8890666668229884
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8633500001563227
====================
====================
iteration is  1
round is  1
accuracy is  0.8200166668229912
====================
====================
iteration is  1
round is  2
accuracy is  0.7458166668229947
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5489166668230087
====================
====================
iteration is  2
round is  1
accuracy is  0.5932333334896714
====================
====================
iteration is  2
round is  2
accuracy is  0.752333333489661
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.4909333334896753
====================
====================
iteration is  3
round is  1
accuracy is  0.2617000001563387
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.22425000015633734
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.361283333489674
====================
====================
iteration is  4
round is  1
accuracy is  0.3993000001563411
====================
====================
iteration is  4
round is  2
accuracy is  0.05590000015633223
====================
succ_min + 1
________________________________
test distance is  tensor(611.5894, device='cuda:2')
test similarity is  tensor(0.3615, device='cuda:2')
test acc is  0.05590000015633223
test loss is 22.413049209855004
test entropy is  0.33173627973492464
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 41 global rounds:
Train Accuracy: 88.65% 

Test Accuracy: 87.78% 


 | Global Training Round : 42 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.6761868000030518
attack res is True
len of model dicts is  12
compute distance is  tensor(106.7810, device='cuda:2')
compute similarity is  tensor(0.9609, device='cuda:2')
compute distance is  tensor(107.0663, device='cuda:2')
compute similarity is  tensor(0.9617, device='cuda:2')
compute distance is  tensor(106.5435, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(107.4463, device='cuda:2')
compute similarity is  tensor(0.9622, device='cuda:2')
compute distance is  tensor(115.6125, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(109.6480, device='cuda:2')
compute similarity is  tensor(0.9617, device='cuda:2')
compute distance is  tensor(104.5565, device='cuda:2')
compute similarity is  tensor(0.9639, device='cuda:2')
compute distance is  tensor(98.5838, device='cuda:2')
compute similarity is  tensor(0.9682, device='cuda:2')
compute distance is  tensor(101.3922, device='cuda:2')
compute similarity is  tensor(0.9665, device='cuda:2')
compute distance is  tensor(110.5464, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
compute distance is  tensor(115.3921, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(103.0755, device='cuda:2')
compute similarity is  tensor(0.9646, device='cuda:2')
calculated distance threshold is  tensor(937.8823, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8880000001563217
====================
====================
iteration is  0
round is  1
accuracy is  0.8871166668229885
====================
====================
iteration is  0
round is  2
accuracy is  0.8869500001563219
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8417166668229904
====================
====================
iteration is  1
round is  1
accuracy is  0.8411166668229902
====================
====================
iteration is  1
round is  2
accuracy is  0.8514833334896567
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7564333334896608
====================
====================
iteration is  2
round is  1
accuracy is  0.7110333334896634
====================
====================
iteration is  2
round is  2
accuracy is  0.6990833334896641
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3147833334896732
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.3180333334896732
====================
====================
iteration is  3
round is  2
accuracy is  0.4341166668230082
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.33365000015634017
====================
====================
iteration is  4
round is  1
accuracy is  0.10690000015633197
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.1606833334896675
====================
________________________________
test distance is  tensor(631.6783, device='cuda:2')
test similarity is  tensor(0.3809, device='cuda:2')
test acc is  0.10690000015633197
test loss is 14.778057509139657
test entropy is  0.4502157981016997
________________________________
num2 of attacker is  0
the length of epoch_weights is  4
the length of weights_d is  4
 
Avg Training Stats after 42 global rounds:
Train Accuracy: 88.67% 

Test Accuracy: 88.08% 


 | Global Training Round : 43 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.6804137229919434
attack res is True
len of model dicts is  12
compute distance is  tensor(102.7653, device='cuda:2')
compute similarity is  tensor(0.9635, device='cuda:2')
compute distance is  tensor(106.5907, device='cuda:2')
compute similarity is  tensor(0.9634, device='cuda:2')
compute distance is  tensor(102.8601, device='cuda:2')
compute similarity is  tensor(0.9651, device='cuda:2')
compute distance is  tensor(117.5085, device='cuda:2')
compute similarity is  tensor(0.9555, device='cuda:2')
compute distance is  tensor(104.0983, device='cuda:2')
compute similarity is  tensor(0.9647, device='cuda:2')
compute distance is  tensor(99.5858, device='cuda:2')
compute similarity is  tensor(0.9676, device='cuda:2')
compute distance is  tensor(99.7220, device='cuda:2')
compute similarity is  tensor(0.9671, device='cuda:2')
compute distance is  tensor(96.2938, device='cuda:2')
compute similarity is  tensor(0.9703, device='cuda:2')
compute distance is  tensor(99.3441, device='cuda:2')
compute similarity is  tensor(0.9676, device='cuda:2')
compute distance is  tensor(110.6472, device='cuda:2')
compute similarity is  tensor(0.9611, device='cuda:2')
compute distance is  tensor(104.4973, device='cuda:2')
compute similarity is  tensor(0.9649, device='cuda:2')
compute distance is  tensor(100.5270, device='cuda:2')
compute similarity is  tensor(0.9668, device='cuda:2')
calculated distance threshold is  tensor(1246.4703, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8857333334896553
====================
====================
iteration is  0
round is  1
accuracy is  0.8888000001563219
====================
====================
iteration is  0
round is  2
accuracy is  0.8890833334896551
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8610333334896562
====================
====================
iteration is  1
round is  1
accuracy is  0.8682166668229893
====================
====================
iteration is  1
round is  2
accuracy is  0.8245833334896576
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7040500001563303
====================
====================
iteration is  2
round is  1
accuracy is  0.46798333348967514
====================
====================
iteration is  2
round is  2
accuracy is  0.5787333334896727
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5006333334896754
====================
====================
iteration is  3
round is  1
accuracy is  0.49558333348967537
====================
====================
iteration is  3
round is  2
accuracy is  0.4076666668230079
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.29841666682300616
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.2758666668230057
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.19013333348966924
====================
succ_min + 1
mid_min is -3.2
====================
iteration is  5
round is  0
accuracy is  0.23045000015633774
====================
====================
iteration is  5
round is  1
accuracy is  0.10760000015633196
====================
succ_min + 1
________________________________
test distance is  tensor(640.0273, device='cuda:2')
test similarity is  tensor(0.3637, device='cuda:2')
test acc is  0.10760000015633196
test loss is 5.695832669099511
test entropy is  0.9383068377021025
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 43 global rounds:
Train Accuracy: 88.43% 

Test Accuracy: 87.70% 


 | Global Training Round : 44 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.7025320529937744
attack res is True
len of model dicts is  12
compute distance is  tensor(106.4271, device='cuda:2')
compute similarity is  tensor(0.9635, device='cuda:2')
compute distance is  tensor(109.7689, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(104.3219, device='cuda:2')
compute similarity is  tensor(0.9648, device='cuda:2')
compute distance is  tensor(116.9912, device='cuda:2')
compute similarity is  tensor(0.9554, device='cuda:2')
compute distance is  tensor(111.7599, device='cuda:2')
compute similarity is  tensor(0.9616, device='cuda:2')
compute distance is  tensor(107.9508, device='cuda:2')
compute similarity is  tensor(0.9626, device='cuda:2')
compute distance is  tensor(104.8609, device='cuda:2')
compute similarity is  tensor(0.9648, device='cuda:2')
compute distance is  tensor(103.9015, device='cuda:2')
compute similarity is  tensor(0.9666, device='cuda:2')
compute distance is  tensor(111.1223, device='cuda:2')
compute similarity is  tensor(0.9620, device='cuda:2')
compute distance is  tensor(104.4105, device='cuda:2')
compute similarity is  tensor(0.9675, device='cuda:2')
compute distance is  tensor(112.0578, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(106.6480, device='cuda:2')
compute similarity is  tensor(0.9639, device='cuda:2')
calculated distance threshold is  tensor(884.5406, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8867333334896553
====================
====================
iteration is  0
round is  1
accuracy is  0.8806333334896554
====================
====================
iteration is  0
round is  2
accuracy is  0.8862166668229886
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8542833334896565
====================
====================
iteration is  1
round is  1
accuracy is  0.85141666682299
====================
====================
iteration is  1
round is  2
accuracy is  0.831000000156324
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6113500001563367
====================
====================
iteration is  2
round is  1
accuracy is  0.6091500001563367
====================
====================
iteration is  2
round is  2
accuracy is  0.696883333489664
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.48701666682300865
====================
====================
iteration is  3
round is  1
accuracy is  0.11226666682299861
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.1654333334896677
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.2733333334896723
====================
====================
iteration is  4
round is  1
accuracy is  0.07500000015633207
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.23398333348967112
====================
________________________________
test distance is  tensor(660.2302, device='cuda:2')
test similarity is  tensor(0.3501, device='cuda:2')
test acc is  0.07500000015633207
test loss is 3.588064732073721
test entropy is  1.5491215357902461
________________________________
num2 of attacker is  12
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 44 global rounds:
Train Accuracy: 88.65% 

Test Accuracy: 87.83% 


 | Global Training Round : 45 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.708630323410034
attack res is True
len of model dicts is  12
compute distance is  tensor(103.2010, device='cuda:2')
compute similarity is  tensor(0.9645, device='cuda:2')
compute distance is  tensor(114.7118, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(100.5828, device='cuda:2')
compute similarity is  tensor(0.9676, device='cuda:2')
compute distance is  tensor(113.9493, device='cuda:2')
compute similarity is  tensor(0.9565, device='cuda:2')
compute distance is  tensor(117.6504, device='cuda:2')
compute similarity is  tensor(0.9567, device='cuda:2')
compute distance is  tensor(106.5866, device='cuda:2')
compute similarity is  tensor(0.9641, device='cuda:2')
compute distance is  tensor(101.4097, device='cuda:2')
compute similarity is  tensor(0.9670, device='cuda:2')
compute distance is  tensor(100.6308, device='cuda:2')
compute similarity is  tensor(0.9678, device='cuda:2')
compute distance is  tensor(105.5773, device='cuda:2')
compute similarity is  tensor(0.9649, device='cuda:2')
compute distance is  tensor(105.5910, device='cuda:2')
compute similarity is  tensor(0.9658, device='cuda:2')
compute distance is  tensor(107.0260, device='cuda:2')
compute similarity is  tensor(0.9629, device='cuda:2')
compute distance is  tensor(102.3991, device='cuda:2')
compute similarity is  tensor(0.9659, device='cuda:2')
calculated distance threshold is  tensor(1220.2426, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8849166668229886
====================
====================
iteration is  0
round is  1
accuracy is  0.8883166668229886
====================
====================
iteration is  0
round is  2
accuracy is  0.8843333334896554
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8580666668229896
====================
====================
iteration is  1
round is  1
accuracy is  0.8082666668229918
====================
====================
iteration is  1
round is  2
accuracy is  0.865333333489656
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.7212666668229961
====================
====================
iteration is  2
round is  1
accuracy is  0.2969333334896728
====================
succ_min + 1
====================
iteration is  2
round is  2
accuracy is  0.6868500001563314
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.4481666668230083
====================
====================
iteration is  3
round is  1
accuracy is  0.49296666682300866
====================
====================
iteration is  3
round is  2
accuracy is  0.38926666682300765
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.28356666682300585
====================
succ_min + 1
====================
iteration is  4
round is  1
accuracy is  0.40768333348967456
====================
====================
iteration is  4
round is  2
accuracy is  0.24526666682300483
====================
succ_min + 1
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.30510000015633965
====================
________________________________
test distance is  tensor(678.4453, device='cuda:2')
test similarity is  tensor(0.3575, device='cuda:2')
test acc is  0.24526666682300483
test loss is 5.383930506228384
test entropy is  0.6676891598937862
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 45 global rounds:
Train Accuracy: 88.60% 

Test Accuracy: 87.82% 


 | Global Training Round : 46 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  24 5
current submit client idx and staleness is  25 5
current submit client idx and staleness is  26 5
current submit client idx and staleness is  27 5
current submit client idx and staleness is  28 5
current submit client idx and staleness is  29 5
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.717785596847534
attack res is True
len of model dicts is  12
compute distance is  tensor(97.8291, device='cuda:2')
compute similarity is  tensor(0.9685, device='cuda:2')
compute distance is  tensor(106.2766, device='cuda:2')
compute similarity is  tensor(0.9642, device='cuda:2')
compute distance is  tensor(110.9341, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(113.6435, device='cuda:2')
compute similarity is  tensor(0.9592, device='cuda:2')
compute distance is  tensor(109.3705, device='cuda:2')
compute similarity is  tensor(0.9641, device='cuda:2')
compute distance is  tensor(117.8241, device='cuda:2')
compute similarity is  tensor(0.9575, device='cuda:2')
compute distance is  tensor(106.0562, device='cuda:2')
compute similarity is  tensor(0.9641, device='cuda:2')
compute distance is  tensor(101.9753, device='cuda:2')
compute similarity is  tensor(0.9673, device='cuda:2')
compute distance is  tensor(96.2388, device='cuda:2')
compute similarity is  tensor(0.9708, device='cuda:2')
compute distance is  tensor(109.2883, device='cuda:2')
compute similarity is  tensor(0.9637, device='cuda:2')
compute distance is  tensor(106.0394, device='cuda:2')
compute similarity is  tensor(0.9640, device='cuda:2')
compute distance is  tensor(109.0215, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
calculated distance threshold is  tensor(1653.8683, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8896666668229885
====================
====================
iteration is  0
round is  1
accuracy is  0.8903166668229884
====================
====================
iteration is  0
round is  2
accuracy is  0.8890166668229884
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8396833334896571
====================
====================
iteration is  1
round is  1
accuracy is  0.8511666668229899
====================
====================
iteration is  1
round is  2
accuracy is  0.8647000001563228
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.3990666668230078
====================
succ_min + 1
====================
iteration is  2
round is  1
accuracy is  0.7442833334896616
====================
====================
iteration is  2
round is  2
accuracy is  0.4953833334896753
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5305000001563422
====================
====================
iteration is  3
round is  1
accuracy is  0.2811000001563392
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.33290000015634014
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.4333166668230081
====================
====================
iteration is  4
round is  1
accuracy is  0.14933333348966643
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.554783333489675
====================
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.11575000015633194
====================
succ_min + 1
________________________________
test distance is  tensor(1241.0178, device='cuda:2')
test similarity is  tensor(0.1664, device='cuda:2')
test acc is  0.11575000015633194
test loss is 10.104920329315576
test entropy is  0.5723821745752525
________________________________
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 46 global rounds:
Train Accuracy: 88.55% 

Test Accuracy: 87.67% 


 | Global Training Round : 47 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.7215662002563477
attack res is True
len of model dicts is  12
compute distance is  tensor(105.4165, device='cuda:2')
compute similarity is  tensor(0.9650, device='cuda:2')
compute distance is  tensor(117.4242, device='cuda:2')
compute similarity is  tensor(0.9564, device='cuda:2')
compute distance is  tensor(120.6153, device='cuda:2')
compute similarity is  tensor(0.9550, device='cuda:2')
compute distance is  tensor(122.8966, device='cuda:2')
compute similarity is  tensor(0.9520, device='cuda:2')
compute distance is  tensor(119.7432, device='cuda:2')
compute similarity is  tensor(0.9571, device='cuda:2')
compute distance is  tensor(115.6825, device='cuda:2')
compute similarity is  tensor(0.9581, device='cuda:2')
compute distance is  tensor(106.7650, device='cuda:2')
compute similarity is  tensor(0.9637, device='cuda:2')
compute distance is  tensor(114.0407, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
compute distance is  tensor(102.7597, device='cuda:2')
compute similarity is  tensor(0.9673, device='cuda:2')
compute distance is  tensor(118.3641, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(118.1578, device='cuda:2')
compute similarity is  tensor(0.9557, device='cuda:2')
compute distance is  tensor(102.6142, device='cuda:2')
compute similarity is  tensor(0.9667, device='cuda:2')
calculated distance threshold is  tensor(1712.5854, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8847333334896553
====================
====================
iteration is  0
round is  1
accuracy is  0.8850333334896553
====================
====================
iteration is  0
round is  2
accuracy is  0.8859000001563219
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8682833334896559
====================
====================
iteration is  1
round is  1
accuracy is  0.867783333489656
====================
====================
iteration is  1
round is  2
accuracy is  0.8505000001563233
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.5488833334896753
====================
====================
iteration is  2
round is  1
accuracy is  0.41298333348967464
====================
====================
iteration is  2
round is  2
accuracy is  0.4985000001563421
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5530000001563418
====================
====================
iteration is  3
round is  1
accuracy is  0.05205000015633227
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.15173333348966664
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.14713333348966623
====================
====================
iteration is  4
round is  1
accuracy is  0.07963333348966539
====================
====================
iteration is  4
round is  2
accuracy is  0.07215000015633212
====================
________________________________
test distance is  tensor(323.6183, device='cuda:2')
test similarity is  tensor(0.6284, device='cuda:2')
test acc is  0.05205000015633227
test loss is 8.440817284939895
test entropy is  0.6345487616336676
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  0
 
Avg Training Stats after 47 global rounds:
Train Accuracy: 88.49% 

Test Accuracy: 87.50% 


 | Global Training Round : 48 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.7330334186553955
attack res is True
len of model dicts is  12
compute distance is  tensor(107.7054, device='cuda:2')
compute similarity is  tensor(0.9624, device='cuda:2')
compute distance is  tensor(114.0251, device='cuda:2')
compute similarity is  tensor(0.9583, device='cuda:2')
compute distance is  tensor(109.0782, device='cuda:2')
compute similarity is  tensor(0.9625, device='cuda:2')
compute distance is  tensor(122.6523, device='cuda:2')
compute similarity is  tensor(0.9533, device='cuda:2')
compute distance is  tensor(111.2284, device='cuda:2')
compute similarity is  tensor(0.9604, device='cuda:2')
compute distance is  tensor(111.0879, device='cuda:2')
compute similarity is  tensor(0.9615, device='cuda:2')
compute distance is  tensor(114.8216, device='cuda:2')
compute similarity is  tensor(0.9582, device='cuda:2')
compute distance is  tensor(113.6588, device='cuda:2')
compute similarity is  tensor(0.9600, device='cuda:2')
compute distance is  tensor(101.9023, device='cuda:2')
compute similarity is  tensor(0.9670, device='cuda:2')
compute distance is  tensor(122.2141, device='cuda:2')
compute similarity is  tensor(0.9553, device='cuda:2')
compute distance is  tensor(98.8549, device='cuda:2')
compute similarity is  tensor(0.9696, device='cuda:2')
compute distance is  tensor(111.5694, device='cuda:2')
compute similarity is  tensor(0.9599, device='cuda:2')
calculated distance threshold is  tensor(2176.7380, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8851833334896554
====================
====================
iteration is  0
round is  1
accuracy is  0.8846666668229887
====================
====================
iteration is  0
round is  2
accuracy is  0.8859333334896552
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8565333334896563
====================
====================
iteration is  1
round is  1
accuracy is  0.8307333334896574
====================
====================
iteration is  1
round is  2
accuracy is  0.8523833334896566
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6678500001563326
====================
====================
iteration is  2
round is  1
accuracy is  0.4958833334896754
====================
====================
iteration is  2
round is  2
accuracy is  0.39301666682300773
====================
succ_min + 1
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.3301833334896735
====================
succ_min + 1
====================
iteration is  3
round is  1
accuracy is  0.051883333489665596
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.22975000015633765
====================
mid_min is -1.6
====================
iteration is  4
round is  0
accuracy is  0.4336333334896748
====================
====================
iteration is  4
round is  1
accuracy is  0.17888333348966862
====================
________________________________
test distance is  tensor(331.2242, device='cuda:2')
test similarity is  tensor(0.6386, device='cuda:2')
test acc is  0.051883333489665596
test loss is 6.141988972865188
test entropy is  1.0951421567117736
________________________________
num2 of attacker is  12
the length of epoch_weights is  5
the length of weights_d is  5
 
Avg Training Stats after 48 global rounds:
Train Accuracy: 88.65% 

Test Accuracy: 87.64% 


 | Global Training Round : 49 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  6 2
current submit client idx and staleness is  7 2
current submit client idx and staleness is  8 2
current submit client idx and staleness is  9 2
current submit client idx and staleness is  10 2
current submit client idx and staleness is  11 2
current submit client idx and staleness is  12 3
current submit client idx and staleness is  13 3
current submit client idx and staleness is  14 3
current submit client idx and staleness is  15 3
current submit client idx and staleness is  16 3
current submit client idx and staleness is  17 3
current submit client idx and staleness is  18 4
current submit client idx and staleness is  19 4
current submit client idx and staleness is  20 4
current submit client idx and staleness is  21 4
current submit client idx and staleness is  22 4
current submit client idx and staleness is  23 4
current submit client idx and staleness is  30 6
current submit client idx and staleness is  31 6
current submit client idx and staleness is  32 6
current submit client idx and staleness is  33 6
current submit client idx and staleness is  34 6
current submit client idx and staleness is  35 6
current submit client idx and staleness is  42 8
current submit client idx and staleness is  43 8
current submit client idx and staleness is  44 8
current submit client idx and staleness is  45 8
current submit client idx and staleness is  46 8
current submit client idx and staleness is  47 8
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.7359066009521484
attack res is True
len of model dicts is  12
compute distance is  tensor(99.8777, device='cuda:2')
compute similarity is  tensor(0.9678, device='cuda:2')
compute distance is  tensor(119.4705, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(98.8666, device='cuda:2')
compute similarity is  tensor(0.9685, device='cuda:2')
compute distance is  tensor(118.9228, device='cuda:2')
compute similarity is  tensor(0.9544, device='cuda:2')
compute distance is  tensor(114.1100, device='cuda:2')
compute similarity is  tensor(0.9595, device='cuda:2')
compute distance is  tensor(111.0517, device='cuda:2')
compute similarity is  tensor(0.9623, device='cuda:2')
compute distance is  tensor(96.6481, device='cuda:2')
compute similarity is  tensor(0.9713, device='cuda:2')
compute distance is  tensor(103.3243, device='cuda:2')
compute similarity is  tensor(0.9666, device='cuda:2')
compute distance is  tensor(97.0446, device='cuda:2')
compute similarity is  tensor(0.9694, device='cuda:2')
compute distance is  tensor(112.0316, device='cuda:2')
compute similarity is  tensor(0.9621, device='cuda:2')
compute distance is  tensor(98.4354, device='cuda:2')
compute similarity is  tensor(0.9682, device='cuda:2')
compute distance is  tensor(112.0149, device='cuda:2')
compute similarity is  tensor(0.9596, device='cuda:2')
calculated distance threshold is  tensor(2288.6729, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8858833334896553
====================
====================
iteration is  0
round is  1
accuracy is  0.8925166668229884
====================
====================
iteration is  0
round is  2
accuracy is  0.8872500001563219
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.8529166668229898
====================
====================
iteration is  1
round is  1
accuracy is  0.8447166668229903
====================
====================
iteration is  1
round is  2
accuracy is  0.8413166668229902
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6167333334896695
====================
====================
iteration is  2
round is  1
accuracy is  0.5143666668230088
====================
====================
iteration is  2
round is  2
accuracy is  0.5335166668230089
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.45240000015634174
====================
====================
iteration is  3
round is  1
accuracy is  0.22406666682300402
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.23638333348967117
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.38580000015634097
====================
====================
iteration is  4
round is  1
accuracy is  0.37326666682300746
====================
====================
iteration is  4
round is  2
accuracy is  0.14375000015633263
====================
succ_min + 1
________________________________
test distance is  tensor(650.6358, device='cuda:2')
test similarity is  tensor(0.3765, device='cuda:2')
test acc is  0.14375000015633263
test loss is 3.301248534401851
test entropy is  1.236996913134162
________________________________
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num1 of attacker is  0
num2 of attacker is  12
the length of epoch_weights is  1
the length of weights_d is  1
 
Avg Training Stats after 49 global rounds:
Train Accuracy: 88.62% 

Test Accuracy: 87.94% 


 | Global Training Round : 50 | 

current submit client idx and staleness is  0 1
current submit client idx and staleness is  1 1
current submit client idx and staleness is  2 1
current submit client idx and staleness is  3 1
current submit client idx and staleness is  4 1
current submit client idx and staleness is  5 1
current submit client idx and staleness is  36 7
current submit client idx and staleness is  37 7
current submit client idx and staleness is  38 7
current submit client idx and staleness is  39 7
current submit client idx and staleness is  40 7
current submit client idx and staleness is  41 7
current submit client idx and staleness is  48 1
current submit client idx and staleness is  49 1
current submit client idx and staleness is  50 1
current submit client idx and staleness is  51 1
current submit client idx and staleness is  52 1
current submit client idx and staleness is  53 1
current submit client idx and staleness is  54 1
current submit client idx and staleness is  55 1
current submit client idx and staleness is  56 1
current submit client idx and staleness is  57 1
current submit client idx and staleness is  58 1
current submit client idx and staleness is  59 1
distance ratio is <class 'float'>
compare_res is  2.740623712539673
attack res is True
len of model dicts is  12
compute distance is  tensor(106.9749, device='cuda:2')
compute similarity is  tensor(0.9630, device='cuda:2')
compute distance is  tensor(108.9800, device='cuda:2')
compute similarity is  tensor(0.9638, device='cuda:2')
compute distance is  tensor(108.1812, device='cuda:2')
compute similarity is  tensor(0.9619, device='cuda:2')
compute distance is  tensor(119.0036, device='cuda:2')
compute similarity is  tensor(0.9547, device='cuda:2')
compute distance is  tensor(108.4781, device='cuda:2')
compute similarity is  tensor(0.9631, device='cuda:2')
compute distance is  tensor(105.8977, device='cuda:2')
compute similarity is  tensor(0.9641, device='cuda:2')
compute distance is  tensor(108.3011, device='cuda:2')
compute similarity is  tensor(0.9637, device='cuda:2')
compute distance is  tensor(102.1008, device='cuda:2')
compute similarity is  tensor(0.9668, device='cuda:2')
compute distance is  tensor(104.5420, device='cuda:2')
compute similarity is  tensor(0.9645, device='cuda:2')
compute distance is  tensor(118.1328, device='cuda:2')
compute similarity is  tensor(0.9580, device='cuda:2')
compute distance is  tensor(99.8148, device='cuda:2')
compute similarity is  tensor(0.9675, device='cuda:2')
compute distance is  tensor(107.3370, device='cuda:2')
compute similarity is  tensor(0.9639, device='cuda:2')
calculated distance threshold is  tensor(2127.1387, device='cuda:2')
mid_min is -0.2
====================
iteration is  0
round is  0
accuracy is  0.8871166668229885
====================
====================
iteration is  0
round is  1
accuracy is  0.8915500001563217
====================
====================
iteration is  0
round is  2
accuracy is  0.8852500001563219
====================
mid_min is -0.4
====================
iteration is  1
round is  0
accuracy is  0.873166666822989
====================
====================
iteration is  1
round is  1
accuracy is  0.8708500001563225
====================
====================
iteration is  1
round is  2
accuracy is  0.8683666668229892
====================
mid_min is -0.8
====================
iteration is  2
round is  0
accuracy is  0.6280500001563354
====================
====================
iteration is  2
round is  1
accuracy is  0.7491000001563279
====================
====================
iteration is  2
round is  2
accuracy is  0.6013666668230041
====================
mid_min is -1.6
====================
iteration is  3
round is  0
accuracy is  0.5906500001563383
====================
====================
iteration is  3
round is  1
accuracy is  0.15926666682300059
====================
succ_min + 1
====================
iteration is  3
round is  2
accuracy is  0.2979000001563395
====================
mid_min is -3.2
====================
iteration is  4
round is  0
accuracy is  0.5377000001563423
====================
====================
iteration is  4
round is  1
accuracy is  0.10256666682299866
====================
succ_min + 1
====================
iteration is  4
round is  2
accuracy is  0.15500000015633364
====================
mid_min is -6.4
====================
iteration is  5
round is  0
accuracy is  0.14418333348966594
====================
________________________________
test distance is  tensor(631.5287, device='cuda:2')
test similarity is  tensor(0.4163, device='cuda:2')
test acc is  0.10256666682299866
test loss is 10.034521149165595
test entropy is  0.4936505468733021
________________________________
num1 of attacker is  0
num2 of attacker is  0
the length of epoch_weights is  2
the length of weights_d is  2
 
Avg Training Stats after 50 global rounds:
Train Accuracy: 88.57% 

Test Accuracy: 87.86% 

 
 Results after 50 global rounds of training:
|---- Avg testing Accuracy across each device's data: 88.57%
|----0th round Training Accuracy : 83.15%
|----1th round Training Accuracy : 85.69%
|----2th round Training Accuracy : 86.92%
|----3th round Training Accuracy : 87.50%
|----4th round Training Accuracy : 87.75%
|----5th round Training Accuracy : 87.95%
|----6th round Training Accuracy : 87.89%
|----7th round Training Accuracy : 88.05%
|----8th round Training Accuracy : 88.03%
|----9th round Training Accuracy : 88.23%
|----10th round Training Accuracy : 88.26%
|----11th round Training Accuracy : 88.56%
|----12th round Training Accuracy : 88.16%
|----13th round Training Accuracy : 88.43%
|----14th round Training Accuracy : 88.46%
|----15th round Training Accuracy : 88.50%
|----16th round Training Accuracy : 88.06%
|----17th round Training Accuracy : 88.59%
|----18th round Training Accuracy : 88.34%
|----19th round Training Accuracy : 88.62%
|----20th round Training Accuracy : 88.75%
|----21th round Training Accuracy : 88.32%
|----22th round Training Accuracy : 88.38%
|----23th round Training Accuracy : 88.50%
|----24th round Training Accuracy : 88.49%
|----25th round Training Accuracy : 88.01%
|----26th round Training Accuracy : 88.04%
|----27th round Training Accuracy : 88.30%
|----28th round Training Accuracy : 88.52%
|----29th round Training Accuracy : 88.50%
|----30th round Training Accuracy : 88.54%
|----31th round Training Accuracy : 88.44%
|----32th round Training Accuracy : 88.52%
|----33th round Training Accuracy : 88.30%
|----34th round Training Accuracy : 88.62%
|----35th round Training Accuracy : 88.82%
|----36th round Training Accuracy : 88.65%
|----37th round Training Accuracy : 88.63%
|----38th round Training Accuracy : 88.50%
|----39th round Training Accuracy : 88.68%
|----40th round Training Accuracy : 88.65%
|----41th round Training Accuracy : 88.67%
|----42th round Training Accuracy : 88.43%
|----43th round Training Accuracy : 88.65%
|----44th round Training Accuracy : 88.60%
|----45th round Training Accuracy : 88.55%
|----46th round Training Accuracy : 88.49%
|----47th round Training Accuracy : 88.65%
|----48th round Training Accuracy : 88.62%
|----49th round Training Accuracy : 88.57%
|----Final Test Accuracy: 87.86%
|----0th round Final Test Accuracy : 81.69%
|----1th round Final Test Accuracy : 84.38%
|----2th round Final Test Accuracy : 85.64%
|----3th round Final Test Accuracy : 85.94%
|----4th round Final Test Accuracy : 86.26%
|----5th round Final Test Accuracy : 86.59%
|----6th round Final Test Accuracy : 86.54%
|----7th round Final Test Accuracy : 87.07%
|----8th round Final Test Accuracy : 87.15%
|----9th round Final Test Accuracy : 87.25%
|----10th round Final Test Accuracy : 87.17%
|----11th round Final Test Accuracy : 87.46%
|----12th round Final Test Accuracy : 87.12%
|----13th round Final Test Accuracy : 87.60%
|----14th round Final Test Accuracy : 87.21%
|----15th round Final Test Accuracy : 87.61%
|----16th round Final Test Accuracy : 87.11%
|----17th round Final Test Accuracy : 87.87%
|----18th round Final Test Accuracy : 87.19%
|----19th round Final Test Accuracy : 87.70%
|----20th round Final Test Accuracy : 87.92%
|----21th round Final Test Accuracy : 87.60%
|----22th round Final Test Accuracy : 87.90%
|----23th round Final Test Accuracy : 87.89%
|----24th round Final Test Accuracy : 87.52%
|----25th round Final Test Accuracy : 87.39%
|----26th round Final Test Accuracy : 87.48%
|----27th round Final Test Accuracy : 87.54%
|----28th round Final Test Accuracy : 87.51%
|----29th round Final Test Accuracy : 87.71%
|----30th round Final Test Accuracy : 87.79%
|----31th round Final Test Accuracy : 87.71%
|----32th round Final Test Accuracy : 87.99%
|----33th round Final Test Accuracy : 87.51%
|----34th round Final Test Accuracy : 87.87%
|----35th round Final Test Accuracy : 88.07%
|----36th round Final Test Accuracy : 87.53%
|----37th round Final Test Accuracy : 87.84%
|----38th round Final Test Accuracy : 87.77%
|----39th round Final Test Accuracy : 87.92%
|----40th round Final Test Accuracy : 87.78%
|----41th round Final Test Accuracy : 88.08%
|----42th round Final Test Accuracy : 87.70%
|----43th round Final Test Accuracy : 87.83%
|----44th round Final Test Accuracy : 87.82%
|----45th round Final Test Accuracy : 87.67%
|----46th round Final Test Accuracy : 87.50%
|----47th round Final Test Accuracy : 87.64%
|----48th round Final Test Accuracy : 87.94%
|----49th round Final Test Accuracy : 87.86%

Experimental details:
    Dataset     : fmnist
    Model     : cnn
    detailed Model     : vgg
    Optimizer : sgd
    Learning  : 0.01
    Global Rounds   : 50

    Federated parameters:
    IID
    balanced
    Fraction of users  : 0.2
    Local Batch size   : 10
    Local Epochs       : 5

    Attack ratio : 0.2
     Model attack is done!

 Total Run Time: 9999.4895
